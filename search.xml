<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>çƒ½ç«é¡¹ç›®åˆ†ç±»ä»»åŠ¡æ€»ç»“</title>
      <link href="/2021/12/05/feng-huo-xiang-mu-fen-lei-ren-wu-zong-jie/"/>
      <url>/2021/12/05/feng-huo-xiang-mu-fen-lei-ren-wu-zong-jie/</url>
      
        <content type="html"><![CDATA[<blockquote><p>é¡¹ç›®GitHubä»“åº“åœ°å€ï¼š<a href="https://github.com/LRY89757/mmdet-for-fenghuo" target="_blank" rel="noopener">https://github.com/LRY89757/mmdet-for-fenghuo</a></p></blockquote><h1 id="2021-11-29æ—¥æ™šæ›´æ–°"><a href="#2021-11-29æ—¥æ™šæ›´æ–°" class="headerlink" title="2021.11.29æ—¥æ™šæ›´æ–°"></a>2021.11.29æ—¥æ™šæ›´æ–°</h1><p>è¿œç¨‹ä»“åº“åˆ›å»ºæˆåŠŸï¼Œä»“åº“åœ°å€ï¼š<a href="https://github.com/LRY89757/mmdet-for-fenghuo" target="_blank" rel="noopener">çƒ½ç«æ£€æµ‹</a></p><p>ç›®å‰éœ€è¦åšçš„äº‹æƒ…ï¼š</p><ul><li>å†™ä¸€ä¸ªå…³äºè¿™ç±»Labelmeæ–‡æ¡£éœ€è¦çš„dataloaderï¼Œå†™ä¸€ä¸ªå°½é‡æ¯”è¾ƒå…¨é¢é€‚é…æ€§æ¯”è¾ƒå¼ºã€å¯è¿ç§»æ€§æ¯”è¾ƒå¥½çš„dataloader</li><li>å¯¹äºè¿è¡Œå‡ºæ¥çš„ç»“æœçš„å›¾åƒåšä¸€ä¸ªç®€å•çš„åˆ‡åˆ†ï¼Œå¹³å‡åˆ†ä¸º19ä»½ç„¶åå°†æ¯ä¸€ä¸ªå•ç‹¬çš„ç›˜éƒ½cropå‡ºæ¥ç„¶åå°†éç›˜åŒºåŸŸæ ‡é»‘æ”¾åˆ°resnet101ç­‰å„ç±»åˆ†ç±»ç½‘ç»œä¸­è¿›è¡Œç›¸å…³çš„åˆ†ç±»ä»»åŠ¡ã€‚</li><li>åˆ’åˆ†æµ‹è¯•é›†å’Œè®­ç»ƒé›†çš„æ—¶å€™é€‰æ‹©ä½¿ç”¨ç”Ÿæˆval.txtè¿˜æœ‰train.txtæ–‡ä»¶çš„æ ¼å¼ï¼Œæ¯ä¸ª.txtæ–‡ä»¶å†…é˜²æ­¢ç›¸å…³æ•°æ®çš„è·¯å¾„ã€‚è€Œä¸æ˜¯å°†å…¶å¤åˆ¶åˆ°ä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ä¸­è¿›è¡Œåˆ†ç±»ï¼Œä¸‡ä¸€ç¡¬ç›˜æ²¡æœ‰é‚£ä¹ˆå¤§çš„ç©ºé—´æ€ä¹ˆåŠï¼Œä¸è¦æ»¥ç”¨ç¡¬ç›˜èµ„æºã€‚</li></ul><h1 id="2021-11-30æ—¥æ™šæ›´æ–°"><a href="#2021-11-30æ—¥æ™šæ›´æ–°" class="headerlink" title="2021.11.30æ—¥æ™šæ›´æ–°"></a>2021.11.30æ—¥æ™šæ›´æ–°</h1><p>ç›®å‰å·²ç»ç¡®å®šæœ¬å‘¨ç°åšç¬¬äºŒé¡¹ï¼Œå°±æ˜¯åšä¸€ä¸‹ç›®å‰ç›˜ç¬¦çš„åˆ†ç±»æ“ä½œã€‚</p><p>ç›®å‰ç¬¬ä¸€æ­¥é‡åˆ°çš„å›°éš¾å°±æ˜¯æš‚æ—¶ä¸çŸ¥é“æˆ‘ä»¬<code>inference_detector()</code>è¿™ä¸ªå‡½æ•°å¾—åˆ°çš„ç»“æœçš„å¤§è‡´å½¢å¼ã€‚å› ä¸ºä¹‹å‰åšåˆ†å‰²çš„æ—¶å€™ç›´æ¥å°†ç»“æœæ”¾åˆ°å‡½æ•°çš„å‚æ•°ä¸­<code>model.show_result(img, result, out_file=f&#39;/home/lry/projects/mmdetection/lry/demo{i}.jpg&#39;)</code>æ¥æ˜¾ç¤ºç»“æœäº†ï¼Œå†åŠ ä¸Šæˆ‘æœ¬æ¥å¯¹è¿™ä¸ªä¹Ÿä¸å¤ªç†Ÿæ‚‰ï¼Œæ‰€ä»¥ç›®å‰æ‰“ç®—æ·±å…¥ç†è§£ä¸‹å…³äºå‡½æ•°<code>inference_detector()</code>ï¼Œé¡ºä¾¿å°†è¿™ä¸€ç³»åˆ—æœ‰å…³çš„éƒ½äº†è§£ä¸€ä¸‹ï¼š<code>init_detector,inference_detector, show_result_pyplot</code>,è¿™äº›éƒ½æ˜¯æºäºåº“<code>mmdet.apis</code>,æ‰€ä»¥æˆ‘ä»¬æ¥æ‰¾ä¸€ä¸‹<a href="https://mmdetection.readthedocs.io/en/latest/api.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>å…³äºmmdet.apisçš„æœ‰å…³è§£é‡Šï¼š<br>å®é™…ä¸Šæœ‰å…³<code>inference_detector</code>çš„<a href="https://mmdetection.readthedocs.io/en/latest/api.html#mmdet.apis.inference_detector" target="_blank" rel="noopener">å†…å®¹</a>ååˆ†æœ‰é™ï¼š</p><blockquote><p>mmdet.apis.inference_detector(<em>model</em>, <em>imgs</em>)<a href="https://mmdetection.readthedocs.io/en/latest/_modules/mmdet/apis/inference.html#inference_detector" target="_blank" rel="noopener">[SOURCE]</a></p><p>Inference image(s) with the detector.</p><ul><li><p>Parameters</p><p><strong>model</strong> (<em>nn.Module</em>) â€“ The loaded detector.<strong>imgs</strong> (<em>str/ndarray</em> <em>or</em> <em>list<strong>[</strong>str/ndarray**] or</em> <em>tuple<strong>[</strong>str/ndarray**]</em>) â€“ Either image files or loaded images.</p></li><li><p>Returns</p><p>If imgs is a list or tuple, the same length list type results will be returned, otherwise return the detection results directly.</p></li></ul></blockquote><p>å½“ç„¶æ„Ÿå…´è¶£å¯ä»¥å»é€‰æ‹©çœ‹ä¸€ä¸‹æœ‰å…³æºç .è¿™é‡Œæˆ‘é€‰æ‹©ç”¨ä»£ç æ¥æ¢ç´¢ä¸‹æœ‰å…³çš„ç»“æœ:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> mmdet<span class="token punctuation">.</span>apis <span class="token keyword">import</span> init_detector<span class="token punctuation">,</span>inference_detector<span class="token punctuation">,</span> show_result_pyplot<span class="token keyword">import</span> mmcv<span class="token keyword">import</span> os<span class="token keyword">import</span> glob<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image<span class="token keyword">from</span> torchvision<span class="token punctuation">.</span>transforms <span class="token keyword">import</span> ToTensorconfig_file <span class="token operator">=</span> <span class="token string">"/home/lry/projects/mmdetection/configs/fenghuo/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_fenghuo.py"</span>checkpoint_file <span class="token operator">=</span> <span class="token string">"/home/lry/projects/mmdetection/work_dirs/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_fenghuo/latest.pth"</span>model <span class="token operator">=</span> init_detector<span class="token punctuation">(</span>config_file<span class="token punctuation">,</span> checkpoint_file<span class="token punctuation">,</span>device<span class="token operator">=</span><span class="token string">"cuda:3"</span><span class="token punctuation">)</span>img <span class="token operator">=</span> <span class="token string">'/home/lry/projects/mmdetection/data/780b_std/IMG_20211021_153945.jpg'</span>result <span class="token operator">=</span> inference_detector<span class="token punctuation">(</span>model<span class="token punctuation">,</span> img<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token string">'\n\n'</span><span class="token punctuation">,</span> result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'\n\n'</span><span class="token punctuation">,</span> result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shape<span class="token punctuation">)</span>img <span class="token operator">=</span> Image<span class="token punctuation">.</span>open<span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ‰å…³è¿™éƒ¨åˆ†ä¸»è¦å°±çœ‹resultçš„è¾“å‡ºåˆ°åº•æ˜¯ä»€ä¹ˆä¸œè¥¿,å¦‚æœæˆ‘ä»¬æƒ³è¦ä¿å­˜ç»“æœåˆ°æŸåœ°æˆ–æ˜¯å±•ç¤ºç»“æœå¯ä»¥ç”¨<code>model.show_result(img, result, out_file=f&#39;/home/lry/projects/mmdetection/lry/demo{i}.jpg&#39;)</code>æ¥æ˜¾ç¤º.</p><p>ç®€å•æ¥çœ‹ä¸‹ä»£ç è¿è¡Œç»“æœ:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token punctuation">(</span><span class="token punctuation">[</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3.6979218e+02</span><span class="token punctuation">,</span> <span class="token number">2.3255410e+03</span><span class="token punctuation">,</span> <span class="token number">2.7979324e+03</span><span class="token punctuation">,</span> <span class="token number">4.2280156e+03</span><span class="token punctuation">,</span>        <span class="token number">9.9831665e-01</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>float32<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token punctuation">[</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3.6979218e+02</span><span class="token punctuation">,</span> <span class="token number">2.3255410e+03</span><span class="token punctuation">,</span> <span class="token number">2.7979324e+03</span><span class="token punctuation">,</span> <span class="token number">4.2280156e+03</span><span class="token punctuation">,</span>        <span class="token number">9.9831665e-01</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>float32<span class="token punctuation">)</span><span class="token punctuation">]</span>  <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3.6979218e+02</span> <span class="token number">2.3255410e+03</span> <span class="token number">2.7979324e+03</span> <span class="token number">4.2280156e+03</span> <span class="token number">9.9831665e-01</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">4608</span><span class="token punctuation">,</span> <span class="token number">3456</span><span class="token punctuation">)</span>torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4608</span><span class="token punctuation">,</span> <span class="token number">3456</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°,resultæ˜¯ä¸€ä¸ªå…ƒç»„,å…ƒç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªnp.array,å«æœ‰5ä¸ªå…ƒç´ ,5ä¸ªå…ƒç´ ä¸­ç¬¬ä¸€ä¸ªä»£è¡¨çš„æ˜¯æ£€æµ‹æ¡†çš„å‡†ç¡®åº¦,ç„¶åå››ä¸ªå‚æ•°ä»£è¡¨çš„æ˜¯å›¾ç‰‡çš„æ£€æµ‹æ¡†çš„å·¦ä¸Šå³ä¸‹ç›¸å…³å‚æ•°,ç„¶åç¬¬äºŒä¸ªå…ƒç´ å°±æ˜¯å›¾ç‰‡åˆ†å‰²æ•°æ®é›†çš„åˆ†å‰²ç»“æœäº†.è¿™ä¸ªç»“æœæ˜¯ç”±Trueå’ŒFalseç»„æˆçš„å’Œå›¾åƒæœ¬èº«Tensorå¤§å°ç›¸åŒçš„ä¸€ä¸ªçŸ©é˜µ.(Trueä»£è¡¨è¯¥åƒç´ æ˜¯å«æœ‰ç‰©ä½“çš„)</p><h2 id="Code-Trace-of-mmdet-apis-inference-detector"><a href="#Code-Trace-of-mmdet-apis-inference-detector" class="headerlink" title="Code Trace of mmdet.apis.inference_detector()"></a>Code Trace of <code>mmdet.apis.inference_detector()</code></h2><p>çš„ç¡®åˆšæ‰æˆ‘ä»¬å°†è¿™ä¸ªæ¥å£å½“ä½œé»‘ç›’æ¥æ¢ç´¢åˆ°äº†ä»–çš„ä¸€äº›å…·ä½“åŠŸèƒ½ã€‚è¿™æ ·å¯¹äºåšé¡¹ç›®æ¥è¯´éå¸¸è¶³å¤Ÿäº†ï¼Œä½†æ˜¯æˆ‘ä»¬è¿™é‡Œæ·±å…¥ä¸€ä¸‹æ¥æ¢ç´¢ä¸€ä¸‹ä»–çš„æºç æ˜¯æ€ä¹ˆæ ·çš„ï¼ˆ<del>æ„Ÿè°¢è’‹å“¥å¸¦æˆ‘é£</del>ï¼‰ã€‚</p><p>é¦–å…ˆæ¥çœ‹æˆ‘ä»¬çš„inference_detector()æºç <code>mmdet/apis/inference.py</code>:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">inference_detector</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> imgs<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Inference image(s) with the detector.    Args:        model (nn.Module): The loaded detector.        imgs (str/ndarray or list[str/ndarray] or tuple[str/ndarray]):           Either image files or loaded images.    Returns:        If imgs is a list or tuple, the same length list type results        will be returned, otherwise return the detection results directly.    """</span>    <span class="token keyword">if</span> isinstance<span class="token punctuation">(</span>imgs<span class="token punctuation">,</span> <span class="token punctuation">(</span>list<span class="token punctuation">,</span> tuple<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        is_batch <span class="token operator">=</span> <span class="token boolean">True</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        imgs <span class="token operator">=</span> <span class="token punctuation">[</span>imgs<span class="token punctuation">]</span>        is_batch <span class="token operator">=</span> <span class="token boolean">False</span>    cfg <span class="token operator">=</span> model<span class="token punctuation">.</span>cfg    device <span class="token operator">=</span> next<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>device  <span class="token comment" spellcheck="true"># model device</span>    <span class="token keyword">if</span> isinstance<span class="token punctuation">(</span>imgs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>        cfg <span class="token operator">=</span> cfg<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># set loading pipeline type</span>        cfg<span class="token punctuation">.</span>data<span class="token punctuation">.</span>test<span class="token punctuation">.</span>pipeline<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'LoadImageFromWebcam'</span>    cfg<span class="token punctuation">.</span>data<span class="token punctuation">.</span>test<span class="token punctuation">.</span>pipeline <span class="token operator">=</span> replace_ImageToTensor<span class="token punctuation">(</span>cfg<span class="token punctuation">.</span>data<span class="token punctuation">.</span>test<span class="token punctuation">.</span>pipeline<span class="token punctuation">)</span>    test_pipeline <span class="token operator">=</span> Compose<span class="token punctuation">(</span>cfg<span class="token punctuation">.</span>data<span class="token punctuation">.</span>test<span class="token punctuation">.</span>pipeline<span class="token punctuation">)</span>    datas <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> img <span class="token keyword">in</span> imgs<span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># prepare data</span>        <span class="token keyword">if</span> isinstance<span class="token punctuation">(</span>img<span class="token punctuation">,</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token comment" spellcheck="true"># directly add img</span>            data <span class="token operator">=</span> dict<span class="token punctuation">(</span>img<span class="token operator">=</span>img<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token comment" spellcheck="true"># add information into dict</span>            data <span class="token operator">=</span> dict<span class="token punctuation">(</span>img_info<span class="token operator">=</span>dict<span class="token punctuation">(</span>filename<span class="token operator">=</span>img<span class="token punctuation">)</span><span class="token punctuation">,</span> img_prefix<span class="token operator">=</span>None<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># build the data pipeline</span>        data <span class="token operator">=</span> test_pipeline<span class="token punctuation">(</span>data<span class="token punctuation">)</span>        datas<span class="token punctuation">.</span>append<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    data <span class="token operator">=</span> collate<span class="token punctuation">(</span>datas<span class="token punctuation">,</span> samples_per_gpu<span class="token operator">=</span>len<span class="token punctuation">(</span>imgs<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># just get the actual data from DataContainer</span>    data<span class="token punctuation">[</span><span class="token string">'img_metas'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>img_metas<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">for</span> img_metas <span class="token keyword">in</span> data<span class="token punctuation">[</span><span class="token string">'img_metas'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>    data<span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>img<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">for</span> img <span class="token keyword">in</span> data<span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> next<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>is_cuda<span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># scatter to specified GPU</span>        data <span class="token operator">=</span> scatter<span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">[</span>device<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> m <span class="token keyword">in</span> model<span class="token punctuation">.</span>modules<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">assert</span> <span class="token operator">not</span> isinstance<span class="token punctuation">(</span>                m<span class="token punctuation">,</span> RoIPool            <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'CPU inference with RoIPool is not supported currently.'</span>    <span class="token comment" spellcheck="true"># forward the model</span>    <span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        results <span class="token operator">=</span> model<span class="token punctuation">(</span>return_loss<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> rescale<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token operator">**</span>data<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token operator">not</span> is_batch<span class="token punctuation">:</span>        <span class="token keyword">return</span> results<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> results<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®é™…ä¸Šè¿™ä¹ˆé•¿çš„æºç ï¼ŒçœŸæ­£å…³é”®çš„å°±å€’æ•°ç¬¬å…­è¡Œçš„ä»£ç <code>results = model(return_loss=False, rescale=True, **data)</code>è¿™è¡Œä»£ç è°ƒç”¨äº†modelæ¥è¿›è¡Œæ¨ç†ç„¶åè¿”å›äº†ç»“æœresultsã€‚æˆ‘ä»¬è¦çœ‹modelçš„è€Œmodelæ˜¯æˆ‘ä»¬ä¼ è¿›æ¥çš„å‚æ•°ï¼Œæ˜¯æˆ‘ä»¬ä½¿ç”¨<code>init_detector</code>è¿™ä¸ªæ¥å£æ¥è°ƒç”¨çš„ï¼Œè¿™ä¸ªæ¥å£ä½¿ç”¨äº†æˆ‘ä»¬çš„configæ–‡ä»¶ä»¥åŠç›¸å…³çš„checkpointæ–‡ä»¶ã€‚è¿™é‡Œconfigæ–‡ä»¶å·²ç»éå¸¸ç†Ÿæ‚‰äº†ï¼Œå°±æ˜¯åˆ©ç”¨è¿™ä¸ªæ­å»ºçš„æ¨¡å‹ã€‚æˆ‘ä»¬éœ€è¦çœ‹çš„æ˜¯å…³äºconfigæ–‡ä»¶é‡Œé¢æ‰€ç”¨çš„æ¨¡å‹ã€‚è€Œè¦æœ€åçš„è¾“å‡ºæ˜¯ç”±<code>roi_heads</code>ï¼Œä¹Ÿå°±æ˜¯maskrcnnæœ€åä¸€ä¸ªæ¨¡å—æ¥è¾“å‡ºçš„ã€‚æˆ‘ä»¬å…ˆè¿½è¸ªä¸€ä¸‹æœ‰å…³çš„configæ–‡ä»¶ï¼š<br>é¦–å…ˆæ˜¯æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ä¸Šå±‚çš„configæ–‡ä»¶<code>configs/fenghuo/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_fenghuo.py</code>, ä»è¿™é‡Œæ‰¾å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ç»§æ‰¿çš„æ˜¯<code>_base_ = &#39;../mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_coco.py&#39;</code>é‚£ä¹ˆæˆ‘ä»¬ç»§ç»­æ‰¾åˆ°è¿™ä¸ªæ¨¡å—å°±<code>configs/mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_coco.py</code>,å¯ä»¥çœ‹åˆ°ä»–ç»§æ‰¿çš„æ˜¯<code>_base_ = &#39;./mask_rcnn_r50_fpn_1x_coco.py&#39;</code>,æˆ‘ä»¬ç»§ç»­æ‰¾è¿™ä¸ªæ–‡ä»¶<code>configs/mask_rcnn/mask_rcnn_r50_fpn_1x_coco.py</code>,è¿™ä¸ªæ–‡ä»¶æœ‰ç‚¹åƒæ˜¯ä¸€ä¸ªpackageçš„<code>__init__.py</code>ï¼Œå°±æ˜¯ä»£ç åªæœ‰æ‰€æœ‰éœ€è¦ç»§æ‰¿çš„åŸºæœ¬ç±»å‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">_base_ <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token string">'../_base_/models/mask_rcnn_r50_fpn.py'</span><span class="token punctuation">,</span>    <span class="token string">'../_base_/datasets/coco_instance.py'</span><span class="token punctuation">,</span>    <span class="token string">'../_base_/schedules/schedule_1x.py'</span><span class="token punctuation">,</span> <span class="token string">'../_base_/default_runtime.py'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œå°±æ˜¯ä¸€äº›æ¨¡å‹å…·ä½“é…ç½®çš„ç»§æ‰¿åŸºç±»æ–‡ä»¶ï¼Œæˆ‘ä»¬æƒ³è¦çœ‹æ¨¡å‹çš„<code>roi_heads</code>éƒ¨åˆ†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å»æ‰¾<code>&#39;../_base_/models/mask_rcnn_r50_fpn.py&#39;</code>æ–‡ä»¶ã€‚æˆ‘ä»¬å¯ä»¥åœ¨<code>configs/_base_/models/mask_rcnn_r50_fpn.py</code>é‡Œæ‰¾åˆ°<code>roi_heads</code>çš„å®šä¹‰:</p><pre class="line-numbers language-python"><code class="language-python">    roi_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>        type<span class="token operator">=</span><span class="token string">'StandardRoIHead'</span><span class="token punctuation">,</span>        bbox_roi_extractor<span class="token operator">=</span>dict<span class="token punctuation">(</span>            type<span class="token operator">=</span><span class="token string">'SingleRoIExtractor'</span><span class="token punctuation">,</span>            roi_layer<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'RoIAlign'</span><span class="token punctuation">,</span> output_size<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span> sampling_ratio<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>            featmap_strides<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        bbox_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>            type<span class="token operator">=</span><span class="token string">'Shared2FCBBoxHead'</span><span class="token punctuation">,</span>            in_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>            fc_out_channels<span class="token operator">=</span><span class="token number">1024</span><span class="token punctuation">,</span>            roi_feat_size<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span>            num_classes<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">,</span>            bbox_coder<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'DeltaXYWHBBoxCoder'</span><span class="token punctuation">,</span>                target_means<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                target_stds<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            reg_class_agnostic<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>            loss_cls<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'CrossEntropyLoss'</span><span class="token punctuation">,</span> use_sigmoid<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> loss_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            loss_bbox<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'L1Loss'</span><span class="token punctuation">,</span> loss_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        mask_roi_extractor<span class="token operator">=</span>dict<span class="token punctuation">(</span>            type<span class="token operator">=</span><span class="token string">'SingleRoIExtractor'</span><span class="token punctuation">,</span>            roi_layer<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'RoIAlign'</span><span class="token punctuation">,</span> output_size<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">,</span> sampling_ratio<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>            featmap_strides<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        mask_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>            type<span class="token operator">=</span><span class="token string">'FCNMaskHead'</span><span class="token punctuation">,</span>            num_convs<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>            in_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>            conv_out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>            num_classes<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">,</span>            loss_mask<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'CrossEntropyLoss'</span><span class="token punctuation">,</span> use_mask<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> loss_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œé¢å¯ä»¥çœ‹åˆ°æ•´ä¸ª<code>roi_head</code>éƒ½æ˜¯å±äº<code>type=&#39;StandardRoIHead&#39;</code>, ç”±äºMMDetectionçš„æ³¨å†Œå™¨Registryæœºåˆ¶ï¼Œæˆ‘ä»¬çŸ¥é“æˆ‘ä»¬éœ€è¦å»åˆ°<code>mmdet</code>æ–‡ä»¶å¤¹ä¸­å»æ‰¾è¿™äº›ä¸œè¥¿ï¼Œåœ¨<code>mmdet/models/roi_heads</code>ä¸­æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°<code>mmdet/models/roi_heads/standard_roi_head.py</code>è¿™ä¸ªæ–‡ä»¶ã€‚<br>ç„¶åæˆ‘ä»¬éœ€è¦ä»ç±»ä¸­å¯»æ‰¾å…³äºforwardçš„æœ‰å…³å‡½æ•°ï¼Œåˆšå¼€å§‹æ‰¾çš„æ˜¯<code>forward_dummy()</code>è¿™ä¸ªå‡½æ•°ï¼Œä½†æ˜¯ä»è¿™ä¸ªå‡½æ•°ä¸­çœ‹ä¸åˆ°å…³äºcls_scoreå’Œbbox_predä»¥åŠmask_predçš„åˆå¹¶æœ‰å…³æ­¥éª¤ï¼Œæˆ–è€…è¯´ä¸å¤ªèƒ½å¯¹åº”ä¸Šï¼Œåæ¥æ‰“äº†ä¸€äº›æ–­ç‚¹å‘ç°ä¼¼ä¹ç¨‹åºæ ¹æœ¬ä¸ä¼šç»è¿‡è¿™ä¸ªå‡½æ•°ã€‚æ‰€ä»¥åº”è¯¥ä¸æ˜¯ç»è¿‡è¿™ä¸ªforwardå‡½æ•°ï¼Œè€Œå¦å¤–çš„forwardå‡½æ•°ï¼Œé¦–å…ˆå¯ä»¥æ’é™¤<code>forward_train</code>è¿™ä¸ªå‡½æ•°ï¼Œæˆ–è€…æ˜¯æ’é™¤æ‰€æœ‰å’Œtrainæœ‰å…³çš„å‡½æ•°ï¼Œå› ä¸ºæˆ‘ä»¬æ¯•ç«Ÿè¿™ä¸ªæ˜¯åšçš„æ¨æ–­ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦çš„ä¸æ˜¯å»trainï¼Œè‡³å°‘ä¹Ÿåœ¨testé‡Œé¢ã€‚</p><p>åæ¥ç»è¿‡æ‰“æ–­ç‚¹å‘ç°ç¨‹åºè¿è¡Œåœ¨<code>simple_test()</code>è¿™ä¸ªå‡½æ•°é‡Œé¢ï¼š</p><pre class="line-numbers language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">simple_test</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>                    x<span class="token punctuation">,</span>                    proposal_list<span class="token punctuation">,</span>                    img_metas<span class="token punctuation">,</span>                    proposals<span class="token operator">=</span>None<span class="token punctuation">,</span>                    rescale<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Test without augmentation.        Args:            x (tuple[Tensor]): Features from upstream network. Each                has shape (batch_size, c, h, w).            proposal_list (list(Tensor)): Proposals from rpn head.                Each has shape (num_proposals, 5), last dimension                5 represent (x1, y1, x2, y2, score).            img_metas (list[dict]): Meta information of images.            rescale (bool): Whether to rescale the results to                the original image. Default: True.        Returns:            list[list[np.ndarray]] or list[tuple]: When no mask branch,            it is bbox results of each image and classes with type            `list[list[np.ndarray]]`. The outer list            corresponds to each image. The inner list            corresponds to each class. When the model has mask branch,            it contains bbox results and mask results.            The outer list corresponds to each image, and first element            of tuple is bbox results, second element is mask results.        """</span>        <span class="token keyword">assert</span> self<span class="token punctuation">.</span>with_bbox<span class="token punctuation">,</span> <span class="token string">'Bbox head must be implemented.'</span>        det_bboxes<span class="token punctuation">,</span> det_labels <span class="token operator">=</span> self<span class="token punctuation">.</span>simple_test_bboxes<span class="token punctuation">(</span>            x<span class="token punctuation">,</span> img_metas<span class="token punctuation">,</span> proposal_list<span class="token punctuation">,</span> self<span class="token punctuation">.</span>test_cfg<span class="token punctuation">,</span> rescale<span class="token operator">=</span>rescale<span class="token punctuation">)</span>        bbox_results <span class="token operator">=</span> <span class="token punctuation">[</span>            bbox2result<span class="token punctuation">(</span>det_bboxes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> det_labels<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>                        self<span class="token punctuation">.</span>bbox_head<span class="token punctuation">.</span>num_classes<span class="token punctuation">)</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>det_bboxes<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">]</span>        <span class="token keyword">if</span> <span class="token operator">not</span> self<span class="token punctuation">.</span>with_mask<span class="token punctuation">:</span>            <span class="token keyword">return</span> bbox_results        <span class="token keyword">else</span><span class="token punctuation">:</span>            segm_results <span class="token operator">=</span> self<span class="token punctuation">.</span>simple_test_mask<span class="token punctuation">(</span>                x<span class="token punctuation">,</span> img_metas<span class="token punctuation">,</span> det_bboxes<span class="token punctuation">,</span> det_labels<span class="token punctuation">,</span> rescale<span class="token operator">=</span>rescale<span class="token punctuation">)</span>            <span class="token keyword">return</span> list<span class="token punctuation">(</span>zip<span class="token punctuation">(</span>bbox_results<span class="token punctuation">,</span> segm_results<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ç€è°ƒè¯•å‘ç°è¿™é‡Œè°ƒç”¨äº†å‡½æ•°bbox2result()æ¥å®ç°äº†å…³äºè½¬åŒ–çš„ä¸€äº›é—®é¢˜ã€‚</p><p>å®é™…ä¸Šåˆ°æ­¤å°±ç»“æŸäº†ï¼Œå½“ç„¶<code>forward_dummy()</code>è¿™ä¸ªå‡½æ•°æ˜¯éå¸¸æœ‰ç ”ç©¶æ„ä¹‰çš„ï¼Œåœ¨<code>mmdet/models/detectors/two_stage.py</code>é‡Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªæ˜¯ä¸ºäº†ï¼Œç‰¹åˆ«æ˜¯è¿™é‡Œè°ƒç”¨äº†<code>_bbox_forward()</code>è¿™ä¸ªå‡½æ•°,å€¼å¾—æ³¨æ„ä¸€ä¸‹ã€‚</p><p>å¦å¤–æˆ‘ä»¬ä»¥ä¸Šä»…ä»…æ˜¯è®²äº†ä¸€ä¸ªmask_rcnnçš„ä¸€ä¸ªå¾ˆå°çš„<code>roi_head</code>éƒ¨åˆ†ï¼Œå¦‚æœè¦æ€»ä½“çœ‹å…¨ä½“çš„ä¸€ä¸ªæ¦‚å†µçš„è¯ï¼Œå¯ä»¥é€‰æ‹©å»çœ‹ä¸€ä¸‹<code>mmdet/models/detectors/two_stage.py</code>è™½ç„¶ä¹Ÿä¸ç®—æ˜¯æ€»ä½“ï¼Œä½†æ˜¯ä¹Ÿé«˜äº†ä¸€çº§ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹å…·ä½“çš„è¿™ä¸ª<code>TwoStageDetector</code>æ˜¯æ€ä¹ˆè°ƒåº¦çš„ï¼Œæ˜¯å¦‚ä½•è¿è¡Œèµ·æ¥çš„ã€‚</p><h2 id="dataloader-in-mmdetection"><a href="#dataloader-in-mmdetection" class="headerlink" title="dataloader in mmdetection"></a><strong>dataloader in mmdetection</strong></h2><p>å…¶æ¬¡æ˜¯å…³äºè¿™å‘¨è¦åšçš„ç¬¬ä¸€ä¸ªä»»åŠ¡ï¼Œè¿™ä¸ªä»»åŠ¡å®é™…ä¸Šå°±æ˜¯æ¥åšä¸€ä¸ªLabelmeæ•°æ®çš„dataloader,å½“ç„¶è¯´èµ·æ¥å®¹æ˜“ï¼Œè¿™ä¸ªè¦æŠŠdataloaderèåˆ°MMDetectioné‡Œé¢è¿˜æ˜¯éœ€è¦æ·±å…¥ç†è§£ä»–çš„Rigistryæœºåˆ¶çš„ï¼Œè€Œä¸”å…‰å†™ä»£ç è¿™ä¸€æ­¥å¦‚æœå®Œå…¨ä¸çœ‹ä»–çš„å…³äºCOCODatasetçš„ä»£ç é è‡ªå·±å†™ææ€•æ˜¯éå¸¸éš¾åŠçš„ã€‚æ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä¸€æ­¥ä¸€æ­¥çš„æ¥æ¢ç´¢ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬æ¥æ‰¾åˆ°COCOçš„dataloaderåˆ°åº•åœ¨å“ªé‡Œã€‚</p><p>è¿˜æ˜¯ä»configæ–‡ä»¶å¼€å§‹æ‰¾ï¼Œç”±äºä¸Šæ–‡å·²ç»æ‰¾è¿‡äº†ï¼Œè¿™é‡Œç›´æ¥å¼•ç”¨ä¸Šæ–‡çš„å¯»æ‰¾è¿‡ç¨‹ï¼š</p><p>â€œâ€â€â€</p><p>é¦–å…ˆæ˜¯æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ä¸Šå±‚çš„configæ–‡ä»¶<code>configs/fenghuo/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_fenghuo.py</code>, ä»è¿™é‡Œæ‰¾å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ç»§æ‰¿çš„æ˜¯<code>_base_ = &#39;../mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_coco.py&#39;</code>é‚£ä¹ˆæˆ‘ä»¬ç»§ç»­æ‰¾åˆ°è¿™ä¸ªæ¨¡å—å°±<code>configs/mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_coco.py</code>,å¯ä»¥çœ‹åˆ°ä»–ç»§æ‰¿çš„æ˜¯<code>_base_ = &#39;./mask_rcnn_r50_fpn_1x_coco.py&#39;</code>,æˆ‘ä»¬ç»§ç»­æ‰¾è¿™ä¸ªæ–‡ä»¶<code>configs/mask_rcnn/mask_rcnn_r50_fpn_1x_coco.py</code>,è¿™ä¸ªæ–‡ä»¶æœ‰ç‚¹åƒæ˜¯ä¸€ä¸ªpackageçš„<code>__init__.py</code>ï¼Œå°±æ˜¯ä»£ç åªæœ‰æ‰€æœ‰éœ€è¦ç»§æ‰¿çš„åŸºæœ¬ç±»å‹ï¼š</p><p>```python</p><p><em>base</em> = [</p><p>  â€˜../<em>base</em>/models/mask_rcnn_r50_fpn.pyâ€™,</p><p>  â€˜../<em>base</em>/datasets/coco_instance.pyâ€™,</p><p>  â€˜../<em>base</em>/schedules/schedule_1x.pyâ€™, â€˜../<em>base</em>/default_runtime.pyâ€™</p><p>]</p><p>```</p><p>â€œâ€â€</p><p>ç„¶åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨<code>&#39;../_base_/datasets/coco_instance.py&#39;</code>é‡Œé¢ï¼Œå‰å‡ è¡Œä»£ç å°±æœ‰<code>dataset_type = &#39;CocoDataset&#39;</code>å’Œä¸Šæ–‡ç›¸åŒçš„Registryæœºåˆ¶ï¼Œæˆ‘ä»¬åˆ°<code>mmdet</code>æ–‡ä»¶å¤¹ä¸­å»å¯»æ‰¾ï¼Œå¯ä»¥å‘ç°åœ¨<code>mmdet/datasets/coco.py</code>é‡Œé¢æœ‰<code>CocoDataset</code>è¿™ä¸ªç±»ã€‚è¿™ä¸ªå°±æ˜¯å…³äºCocoDatasetçš„dataloader.ç»ˆäºæ‰¾åˆ°äº†ï¼</p><p>ä½†æ˜¯æœ‰574è¡Œä»£ç â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦èšŒåŸ ä½äº†ğŸ˜¥ã€‚</p><h1 id="2021-12-1æ—¥ä¸Šåˆæ›´æ–°"><a href="#2021-12-1æ—¥ä¸Šåˆæ›´æ–°" class="headerlink" title="2021.12.1æ—¥ä¸Šåˆæ›´æ–°"></a>2021.12.1æ—¥ä¸Šåˆæ›´æ–°</h1><h2 id="dataloader-in-mmdet"><a href="#dataloader-in-mmdet" class="headerlink" title="dataloader in mmdet"></a>dataloader in mmdet</h2><p>å†ç¨å¾®è¯´ä¸€ä¸‹å…³äºRigistryè¿˜æœ‰ç»§æ‰¿ç±»éœ€è¦åšçš„ä¸€äº›ä¸œè¥¿ã€‚</p><p>æˆ‘ä»¬ç»§ç»­ä»ä¸Šæ–‡ä¸­å¾—åˆ°çš„åœ¨<code>mmdet/datasets/coco.py</code>ä¸­çœ‹åˆ°çš„CocoDatasetç±»çš„å†…å®¹ï¼ˆä»…ä»…é€‰æ‹©äº†ä¸€éƒ¨åˆ†ï¼Œå®Œæ•´ç‰ˆçœ‹<a href="https://github.com/open-mmlab/mmdetection/blob/master/mmdet/datasets/coco.py" target="_blank" rel="noopener">è¿™é‡Œ</a>ï¼‰ï¼š</p><p>```python</p><p># Copyright (c) OpenMMLab. All rights reserved.</p><p>@DATASETS.register_module()</p><p>class CocoDataset(CustomDataset):</p><p>  CLASSES = (â€˜personâ€™, â€˜bicycleâ€™, â€˜carâ€™, â€˜motorcycleâ€™, â€˜airplaneâ€™, â€˜busâ€™,</p><p>â€‹        â€˜trainâ€™, â€˜truckâ€™, â€˜boatâ€™, â€˜traffic lightâ€™, â€˜fire hydrantâ€™,</p><p>â€‹        â€˜stop signâ€™, â€˜parking meterâ€™, â€˜benchâ€™, â€˜birdâ€™, â€˜catâ€™, â€˜dogâ€™,</p><p>â€‹        â€˜horseâ€™, â€˜sheepâ€™, â€˜cowâ€™, â€˜elephantâ€™, â€˜bearâ€™, â€˜zebraâ€™, â€˜giraffeâ€™,</p><p>â€‹        â€˜backpackâ€™, â€˜umbrellaâ€™, â€˜handbagâ€™, â€˜tieâ€™, â€˜suitcaseâ€™, â€˜frisbeeâ€™,</p><p>â€‹        â€˜skisâ€™, â€˜snowboardâ€™, â€˜sports ballâ€™, â€˜kiteâ€™, â€˜baseball batâ€™,</p><p>â€‹        â€˜baseball gloveâ€™, â€˜skateboardâ€™, â€˜surfboardâ€™, â€˜tennis racketâ€™,</p><p>â€‹        â€˜bottleâ€™, â€˜wine glassâ€™, â€˜cupâ€™, â€˜forkâ€™, â€˜knifeâ€™, â€˜spoonâ€™, â€˜bowlâ€™,</p><p>â€‹        â€˜bananaâ€™, â€˜appleâ€™, â€˜sandwichâ€™, â€˜orangeâ€™, â€˜broccoliâ€™, â€˜carrotâ€™,</p><p>â€‹        â€˜hot dogâ€™, â€˜pizzaâ€™, â€˜donutâ€™, â€˜cakeâ€™, â€˜chairâ€™, â€˜couchâ€™,</p><p>â€‹        â€˜potted plantâ€™, â€˜bedâ€™, â€˜dining tableâ€™, â€˜toiletâ€™, â€˜tvâ€™, â€˜laptopâ€™,</p><p>â€‹        â€˜mouseâ€™, â€˜remoteâ€™, â€˜keyboardâ€™, â€˜cell phoneâ€™, â€˜microwaveâ€™,</p><p>â€‹        â€˜ovenâ€™, â€˜toasterâ€™, â€˜sinkâ€™, â€˜refrigeratorâ€™, â€˜bookâ€™, â€˜clockâ€™,</p><p>â€‹        â€˜vaseâ€™, â€˜scissorsâ€™, â€˜teddy bearâ€™, â€˜hair drierâ€™, â€˜toothbrushâ€™)</p><p>  def load_annotations(self, ann_file):</p><p>â€‹    â€œâ€â€Load annotation from COCO style annotation file.</p><p>â€‹    Args:</p><p>â€‹      ann_file (str): Path of annotation file.</p><p>â€‹    Returns:</p><p>```</p><p>ä¸»è¦æ˜¯çœ‹ä¸€ä¸‹<code>@DATASETS.register_module()</code>è¿™ä¸ªè£…é¥°å™¨ï¼Œå…³äºè£…é¥°å™¨çš„è¯­æ³•æ·±å…¥çš„éƒ¨åˆ†ä¸å†è¯´ï¼Œæˆ‘ä»¬è¿™é‡Œåªéœ€è¦çŸ¥é“è¿™ä¸ªå°±ç›¸å½“äºæˆ‘ä»¬æ³¨å†Œäº†æœ‰å…³çš„<code>Rigistry</code>,ä»è¿™ä¸ªå®šä¹‰ä¹‹åï¼Œæˆ‘ä»¬åªéœ€è¦å°±åƒå‰é¢ä¸€æ ·<code>dataset_type = &#39;CocoDataset&#39;</code>å°±å¯ä»¥å°†è¿™ä¸ªdataloaderæ”¾åˆ°MMdetä¸­ã€‚</p><p>å¦å¤–å¦‚æœè‡ªå·±è¦å†™dataloaderçš„è¯ï¼Œç±»éœ€è¦ç»§æ‰¿çš„å°±æ˜¯<code>from .custom import CustomDataset</code>ä¸­çš„<code>CustomDataset</code>.</p><p>å¦å¤–æˆ‘ä»¬è¿˜è¦æ³¨æ„çš„æ˜¯</p><h2 id="å›¾åƒåˆ†å‰²ç›˜ç¬¦åˆ‡ç‰‡æ•°æ®é¢„å¤„ç†æ“ä½œ"><a href="#å›¾åƒåˆ†å‰²ç›˜ç¬¦åˆ‡ç‰‡æ•°æ®é¢„å¤„ç†æ“ä½œ" class="headerlink" title="å›¾åƒåˆ†å‰²ç›˜ç¬¦åˆ‡ç‰‡æ•°æ®é¢„å¤„ç†æ“ä½œ"></a>å›¾åƒåˆ†å‰²ç›˜ç¬¦åˆ‡ç‰‡æ•°æ®é¢„å¤„ç†æ“ä½œ</h2><h3 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h3><p>æ˜¨å¤©æœ¬æ¥æ‰“ç®—è®¤çœŸåšä¸€ä¸‹å…³äºç›˜ç¬¦åˆ†ç±»çš„ä»»åŠ¡çš„ï¼Œæ²¡æƒ³åˆ°è¿˜æ˜¯æœ€ç»ˆæ²¡æœ‰å¼„ï¼Œå…‰é¡¾ç€æMMdetectionçš„æºç è¿™äº›ä¸œè¥¿äº†æ²¡æœ‰æ¥å¾—åŠæï¼Œç›®å‰å·²çŸ¥æ¥å£<code>inference_detector</code>è¿”å›çš„resultçš„ç»“æœäº†ï¼Œå°±æ˜¯ä¸€ä¸ªå…ƒç»„tupleï¼Œç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯æ£€æµ‹æ¡†çš„ä½ç½®å’Œç½®ä¿¡åº¦ï¼Œç„¶åç¬¬äºŒä¸ªå…ƒç´ å°±æ˜¯åˆ†å‰²çš„ç»“æœï¼Œæ˜¯ä¸€ä¸ªä¸å›¾ç‰‡å¤§å°ç›¸åŒçš„ä¸€ä¸ªäºŒç»´çŸ©é˜µï¼Œç”±Trueå’ŒFalseç»„æˆã€‚</p><p>æˆ‘ä»¬æ¥ä¸‹æ¥å¼€å§‹å°è¯•åšå›¾åƒçš„å¤„ç†ã€‚</p><p>é¦–å…ˆæ„å»ºdetectorå¾—åˆ°ä¸€äº›å…·ä½“ç»“æœï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/12/01/LqL6m6.png" alt></p><h3 id="å›¾åƒå¤„ç†ç®—æ³•åˆ†æä¸ç®—æ³•æ­¥éª¤å®ç°"><a href="#å›¾åƒå¤„ç†ç®—æ³•åˆ†æä¸ç®—æ³•æ­¥éª¤å®ç°" class="headerlink" title="å›¾åƒå¤„ç†ç®—æ³•åˆ†æä¸ç®—æ³•æ­¥éª¤å®ç°"></a>å›¾åƒå¤„ç†ç®—æ³•åˆ†æä¸ç®—æ³•æ­¥éª¤å®ç°</h3><h4 id="å¯¹äºåˆ†å‰²çš„ç»“æœé¢„å¤„ç†"><a href="#å¯¹äºåˆ†å‰²çš„ç»“æœé¢„å¤„ç†" class="headerlink" title="å¯¹äºåˆ†å‰²çš„ç»“æœé¢„å¤„ç†"></a>å¯¹äºåˆ†å‰²çš„ç»“æœé¢„å¤„ç†</h4><p>é¦–å…ˆï¼Œè¿™ä¸ªæ£€æµ‹æ¡†çš„ç»“æœå¹¶ä¸æ˜¯éå¸¸é è°±,å¾ˆæ˜æ˜¾å¦‚æœæˆ‘ä»¬é€‰æ‹©å¯¹å¾—åˆ°çš„bboxæ¥è¿›è¡Œå‡ç­‰åˆ†å‰²æ˜¯å®Œå…¨ä¸è¡Œçš„ï¼Œåˆ†å‰²çš„ç»“æœè¿˜è¦å¥½ä¸€äº›ç›¸å¯¹è€Œè¨€ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œå¯ä»¥é€‰æ‹©è€ƒè™‘ä¸€ä¸‹ä½¿ç”¨åˆ†å‰²æ•°æ®ä½†æ˜¯è¦å¯¹åˆ†å‰²æ•°æ®è¿›è¡Œä¸€äº›è½¬æ¢æˆ–è€…æ˜¯è¯´ä¿®è¡¥ã€‚</p><p>ç›®å‰ä¸€ä¸ªæƒ³æ³•æ˜¯å¯¹äºåˆ†å‰²ç»“æœçš„è¾¹ç•Œå–å¹³å‡å€¼æ¥å¾—åˆ°4æ¡å¯ä»¥ç”¨çš„è¾¹ç»„æˆä¸€ä¸ªæ–°çš„bboxã€‚ç„¶åæˆ‘ä»¬å†å¯¹å¾—åˆ°çš„æ–°çš„bboxè¿›è¡Œå¹³å‡åˆ‡åˆ†æˆ19ç­‰ä»½ï¼Œå½“ç„¶è¿™é‡Œæ²¡æœ‰è€ƒè™‘æ˜¯å¦æ˜¯å€¾æ–œçš„ï¼Œå› ä¸ºæˆ‘ä»¬è¦åˆ‡å‡ºçš„å›¾ç‰‡è¦éƒ½æ˜¯æ°´å¹³çŸ©å½¢ï¼Œç„¶åæ ¹æ®åæ ‡å…³ç³»å°†æˆ‘ä»¬åˆ‡é™¤çŸ©å½¢éƒ¨åˆ†ä¸åŒ…å«ç›˜ç¬¦çš„éƒ¨åˆ†æ¶‚é»‘ï¼ˆæ‰€ä»¥å†™ä»£ç æ—¶ä¸å¦¨å…ˆå°†éç›˜ç¬¦éƒ¨åˆ†æ¶‚é»‘ã€‚ï¼‰</p><p>ç›®å‰è€ƒè™‘çš„ç®—æ³•æ­¥éª¤æ˜¯ï¼š</p><ul><li><p>æ ¹æ®æ„å»ºdetectorå¾—åˆ°çš„åˆ†å‰²ç»“æœçŸ©é˜µï¼Œæ ¹æ®è¾¹ç•Œå¹³å‡æ€æƒ³å¾—åˆ°ä¸€ä¸ª bbox</p></li><li><p>å¾—åˆ°bboxçš„å››ä¸ªé¡¶ç‚¹ï¼ˆä¸€å®šæ˜¯bboxçŸ©é˜µæœ€é å·¦ï¼Œæœ€é å³ï¼Œæœ€é ä¸Šï¼Œæœ€é ä¸‹çš„å››ä¸ªé¡¶ç‚¹ï¼‰ã€‚</p></li><li><p>æ ¹æ®å››ä¸ªé¡¶ç‚¹çš„å…³ç³»å¾—åˆ°å·¦å³çš„ä¸¤ç»„è¾¹çš„ç‚¹ï¼Œç„¶åæ ¹æ®å·¦å³ç­‰æ¯”ä¾‹å…³ç³»æ ‡æ³¨å¥½ä¸­é—´è¦åˆ‡åˆ†çš„18ä¸ªç‚¹ï¼Œè¿åŒç€å·¦å³ä¸¤ç«¯ç‚¹éƒ½æ”¾åˆ°ä¸€ä¸ªåˆ—è¡¨é‡Œï¼Œä¸Šä¸‹éƒ½è¦æœ‰ï¼Œï¼ˆå…¶å®ä¹Ÿå°±é€šè¿‡ç»™bboxçš„çŸ©é˜µä¸Šä¸‹ä¸¤æ¡è¾¹ç­‰åˆ†æˆ19ä»½ï¼Œä»¥åˆ©äºåç»­ç”»å›¾åˆ‡å‰²ã€‚ï¼‰</p></li><li><p>å¼€å§‹åˆ‡å‰²ï¼Œå¹¶é€‰æ‹©å°†å›¾ç‰‡ä¸­éç›˜ç¬¦çš„éƒ¨åˆ†æ¶‚é»‘ï¼ˆè¿™ä¸ªå¯ä»¥åœ¨åˆ‡å‰²ä¹‹å‰å°±æ¶‚é»‘äº†ï¼‰</p></li><li><p>å¯¹ä¸€å¼ å›¾ç‰‡å¾—åˆ°çš„19ä¸ªç›˜ç¬¦æ ‡ä¸Šç§ç±»ï¼Œè‡³äºç§ç±»å¯ä»¥é€‰æ‹©åˆ©ç”¨å½“æ—¶çš„jsonæ–‡ä»¶æ¥æ ‡ç§ç±»ã€‚</p></li></ul><p>ç»†èŠ‚è¡¥å……ï¼š</p><ul><li><p>é¦–å…ˆé€šè¿‡å››ä¸ªé¡¶ç‚¹å¾—åˆ°ä¸€ä¸ªæ°´å¹³bboxå¯ä»¥å†™ä¸€ä¸ªå‡½æ•°å¤ç”¨</p></li><li><p>ç»™å®šä¸¤ä¸ªé¡¶ç‚¹å°†å…¶è¿çº¿ç­‰åˆ†å‰²æˆ19ä»½å¹¶è¿”å›è¯¥ç›´çº¿æ‰€åˆ†åæ ‡åˆ—è¡¨ï¼Œæˆ–è€…è¯´ç»™å®šå››ä¸ªé¡¶ç‚¹è¿”å›åˆ‡åˆ†å¥½çš„å„ä¸ªå°ç›˜ç¬¦é¡¶ç‚¹åæ ‡åˆ—è¡¨ï¼ˆæ„æ€å°±æ˜¯åˆ—è¡¨ä¸­æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªåˆ†å¥½çš„å°æ¡†çš„å››ä¸ªé¡¶ç‚¹åæ ‡ï¼‰ã€‚</p></li><li><p>æ¶‚é»‘æ“ä½œå®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥ä¸º</p></li><li><p><strong>ä»¥ä¸Šæ‰€æœ‰çš„æ“ä½œéƒ½æ”¾åˆ°ä¸€ä¸ªç±»é‡Œç»Ÿä¸€å¤„ç†ï¼Œç„¶ååˆ°æ—¶å€™è°ƒç”¨ç›´æ¥æ„å»ºç±»çš„æ—¶å€™å°±è°ƒç”¨äº†è¿›è¡Œå®Œé¢„å¤„ç†æ“ä½œã€‚</strong></p></li></ul><h3 id="å¯¹äºæ™®é€šæ ‡æ³¨labelmeæ–‡ä»¶çš„ç»“æœé¢„å¤„ç†"><a href="#å¯¹äºæ™®é€šæ ‡æ³¨labelmeæ–‡ä»¶çš„ç»“æœé¢„å¤„ç†" class="headerlink" title="å¯¹äºæ™®é€šæ ‡æ³¨labelmeæ–‡ä»¶çš„ç»“æœé¢„å¤„ç†"></a><strong>å¯¹äºæ™®é€šæ ‡æ³¨labelmeæ–‡ä»¶çš„ç»“æœé¢„å¤„ç†</strong></h3><p>å› ä¸ºLabelmeæ–‡ä»¶æ˜¯å¯¹äºæ¯ä¸€ä¸ªå›¾ç‰‡éƒ½æœ‰ä¸€ä¸ªå•ç‹¬çš„jsonæ–‡ä»¶ï¼Œç„¶åæ¯ä¸€ä¸ªjsonæ–‡ä»¶éƒ½ä¼šæœ‰å„ä¸ªç›˜ç¬¦çš„ä½ç½®ä¿¡æ¯è¿˜æœ‰å…·ä½“çš„åæ ‡ç§ç±»ï¼Œæ‰€ä»¥è¿™æ ·ä¸€æ¥ç›¸æ¯”äºåˆ†å‰²çš„ç»“æœè¦å¥½å¾ˆå¤šï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œæ€è·¯ç®€å•å¾ˆå¤šï¼š</p><ul><li><p>è¯»å–<code>.json</code>æ–‡ä»¶</p></li><li><p>å¯¹äºå°†æ¯ä¸ªå°ç›˜ç¬¦å››ä¸ªé¡¶ç‚¹è½¬åŒ–ä¸ºä¸€ä¸ªè¾ƒå¤§çš„bbox</p></li><li><p>å¤§æ¡†bboxå†…éç›˜ç¬¦éƒ¨åˆ†æ¶‚é»‘</p></li><li><p>ä¿å­˜ï¼Œæ³¨æ„å›¾ç‰‡æ ‡ç­¾çš„ä¿å­˜</p></li></ul><h3 id="æ™®é€šlabelmeæ–‡ä»¶è¯»å–åˆ†æ"><a href="#æ™®é€šlabelmeæ–‡ä»¶è¯»å–åˆ†æ" class="headerlink" title="æ™®é€šlabelmeæ–‡ä»¶è¯»å–åˆ†æ"></a>æ™®é€šlabelmeæ–‡ä»¶è¯»å–åˆ†æ</h3><h1 id="2021-12-2æ—¥ä¸‹åˆæ›´æ–°"><a href="#2021-12-2æ—¥ä¸‹åˆæ›´æ–°" class="headerlink" title="2021.12.2æ—¥ä¸‹åˆæ›´æ–°"></a>2021.12.2æ—¥ä¸‹åˆæ›´æ–°</h1><p>æ˜¨å¤©åšäº†å…³äºæ•°æ®é›†çš„æ•´ç†æ“ä½œä»¥åŠå…³äºæ•°æ®çš„è½¬åŒ–æ“ä½œï¼Œç›®å‰ä¸€ä¸ªæˆç†Ÿçš„æ•°æ®é›†å·²ç»è½¬åŒ–å®Œæˆï¼Œä¸è¿‡<strong>ç›¸å…³è®°å½•æ–‡æ¡£æ²¡æœ‰å®Œæˆ</strong>ï¼Œç¡®å®æ²¡æœ‰æ—¶é—´è®°å½•äº†ï¼Œç­‰è¿™ä¸¤å¤©è®°å½•ä¸€ä¸‹ã€‚<br>åŒæ—¶æ˜¨å¤©ä¹Ÿå†™äº†å…³äºæ–‡ä»¶çš„dataloaderçš„è¯»å–ï¼Œè¿™æ–¹é¢è¿˜æ˜¯èŠ±äº†ä¸€äº›å¿ƒæ€çš„ï¼Œç›®å‰æ¥ä¸‹æ¥çš„ä»»åŠ¡å°±æ˜¯æ„å»ºç›¸å…³æ¨¡å‹ç„¶åè¿›è¡Œæœ‰å…³çš„è®­ç»ƒï¼Œå½“ç„¶è¿™é‡Œè€ƒè™‘ä½¿ç”¨ä¸åŒçš„æœ‰å…³æ¨¡å‹æ¯”å¦‚è¯´resnet101, regnetè¿™ç±»éƒ½å°è¯•ä¸€ä¸‹ï¼Œå½“ç„¶å¯ä»¥ç›´æ¥ä»torchvision.modelsç›´æ¥å¯¼å…¥æœ‰å…³çš„æ¨¡å‹ã€‚</p><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯æ­£å¥½æˆ‘ä»¬å¯ä»¥å°†æ•´ä¸ªçš„æ¨¡å‹çš„è®­ç»ƒï¼Œæ•°æ®å¯è§†åŒ–ï¼Œè°ƒæ•´å¯è§†åŒ–ç­‰ç­‰è¿™ä¸€ç³»åˆ—çš„æ“ä½œéƒ½å°è¯•å­¦ä¹ æ“ä½œä¸€éï¼Œè™½ç„¶ä¹‹å‰ä¹Ÿæ•´è¿‡å¥½å¤šéï¼Œä½†æ˜¯è‡ªä»å­¦äº†mmdetectionä¹‹åå°±å¾ˆå°‘å¼„äº†ï¼Œå¯ä»¥å†æ·±å…¥æ¢ç´¢ä¸€ä¸‹ã€‚</p><p>å¦å¤–</p><p>ä¸€äº›å‚è€ƒæ–‡æ¡£ï¼š</p><ul><li><a href="https://blog.csdn.net/weixin_36670529/article/details/105910572" target="_blank" rel="noopener">https://blog.csdn.net/weixin_36670529/article/details/105910572</a></li><li></li></ul><h1 id="2021-12-3æ—¥-amp-amp-4æ—¥-amp-amp-5æ—¥æ›´æ–°"><a href="#2021-12-3æ—¥-amp-amp-4æ—¥-amp-amp-5æ—¥æ›´æ–°" class="headerlink" title="2021.12.3æ—¥&amp;&amp;4æ—¥&amp;&amp;5æ—¥æ›´æ–°"></a>2021.12.3æ—¥&amp;&amp;4æ—¥&amp;&amp;5æ—¥æ›´æ–°</h1><h2 id="Preface-1"><a href="#Preface-1" class="headerlink" title="Preface"></a>Preface</h2><p>æ•°æ®å¤„ç†æœ‰å…³çš„è®°å½•æ–‡æ¡£æ˜¨å¤©å·²ç»æ•´ç†å®Œæ¯•ã€‚ä¸ºäº†å¸å–æ•™è®­ï¼Œä»¥åè¿˜æ˜¯è¾¹å†™è¾¹æ•´ç†æ–‡æ¡£æ¯”è¾ƒå¥½ï¼Œé™¤éæ˜¯æ—¶é—´è¿‡äºç´§æ€¥ã€‚</p><p>ä»Šå¤©å°±å†™ä¸€ä¸‹æœ‰å…³æ¨¡å‹ï¼Œæ ¹æ®ç›®å‰çš„è¿›å±•ï¼Œä»»åŠ¡ä¸»è¦å¦‚ä¸‹ï¼š</p><ul><li>å…³äºéªŒè¯é›†ã€è®­ç»ƒé›†çš„åˆ’åˆ†</li><li>train_one_epochå‡½æ•°</li><li>è®¡ç®—éªŒè¯é›†å‡†ç¡®ç‡çš„å‡½æ•°</li><li>ä½¿ç”¨è‡ªå·±çš„æ•°æ®é›†</li><li>ä½¿ç”¨tqdm</li></ul><h2 id="éªŒè¯é›†ã€è®­ç»ƒé›†çš„åˆ’åˆ†"><a href="#éªŒè¯é›†ã€è®­ç»ƒé›†çš„åˆ’åˆ†" class="headerlink" title="éªŒè¯é›†ã€è®­ç»ƒé›†çš„åˆ’åˆ†"></a>éªŒè¯é›†ã€è®­ç»ƒé›†çš„åˆ’åˆ†</h2><p>å¤§æ¦‚8ï¼š2åˆ’åˆ†ï¼Œå…·ä½“éš¾åº¦å¹¶ä¸é«˜ã€‚ä»…ä»…æ˜¯è®°å¾—ä½¿ç”¨å‡½æ•°shutilå°±OKäº†ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token triple-quoted-string string">"""æœ¬æ¨¡å—ç”¨äºåˆ’åˆ†éªŒè¯é›†å’Œæµ‹è¯•é›†ï¼Œå¤§æ¦‚æ¯”ä¾‹ä¸º8ï¼š2"""</span><span class="token keyword">import</span> shutil<span class="token keyword">import</span> os<span class="token keyword">import</span> random<span class="token keyword">import</span> glob<span class="token keyword">def</span> <span class="token function">move_file</span><span class="token punctuation">(</span>imgs<span class="token punctuation">,</span>  new_path<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">'''è¿™ä¸ªå‡½æ•°æ˜¯ç”¨æ¥ç§»åŠ¨å›¾ç‰‡ä»æ—§è·¯å¾„ç§»åˆ°æ–°è·¯å¾„'''</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>new_path<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># filelist = os.listdir(old_path) # åˆ—å‡ºè¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶,listdirè¿”å›çš„æ–‡ä»¶åˆ—è¡¨æ˜¯ä¸åŒ…å«è·¯å¾„çš„ã€‚</span>    filelist <span class="token operator">=</span> imgs    <span class="token keyword">print</span><span class="token punctuation">(</span>filelist<span class="token punctuation">)</span>    <span class="token keyword">for</span> file <span class="token keyword">in</span> filelist<span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># file = file - "/home/lry/data/780b_std/"</span>        src <span class="token operator">=</span> file        dst <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>new_path<span class="token punctuation">,</span> file<span class="token punctuation">[</span>len<span class="token punctuation">(</span><span class="token string">'/home/lry/data/780b_singe_padded/'</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'src:'</span><span class="token punctuation">,</span> src<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'dst:'</span><span class="token punctuation">,</span> dst<span class="token punctuation">)</span>        shutil<span class="token punctuation">.</span>move<span class="token punctuation">(</span>src<span class="token punctuation">,</span> dst<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># old_path = "/home/lry/data/780b_std"</span>new_val <span class="token operator">=</span> <span class="token string">"/home/lry/data/780b_singe_padded_std/val"</span>new_train <span class="token operator">=</span> <span class="token string">"/home/lry/data/780b_singe_padded_std/train"</span>pics <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">"/home/lry/data/780b_singe_padded/*.jpg"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># print(pics)</span><span class="token keyword">print</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>pics<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># print(pics[0][-30:])</span><span class="token comment" spellcheck="true"># print(len(pics))</span><span class="token comment" spellcheck="true"># print(pics[0][len("/home/lry/data/780b_std/"):-5] + ".jpg")</span><span class="token comment" spellcheck="true"># print(pics[0][:-4])</span><span class="token comment" spellcheck="true"># print(pics)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"moving...."</span><span class="token punctuation">)</span>move_file<span class="token punctuation">(</span>pics<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">702</span><span class="token punctuation">]</span><span class="token punctuation">,</span> new_train<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"train end!"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"moving..."</span><span class="token punctuation">)</span>move_file<span class="token punctuation">(</span>pics<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">702</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> new_val<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"val end!"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># if __name__ == '__main__':</span><span class="token comment" spellcheck="true">#     pics = glob.glob("/home/lry/data/780b_singe_padded_std/train/*.jpg")</span><span class="token comment" spellcheck="true">#     print(len(pics))</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="train-one-epochå‡½æ•°"><a href="#train-one-epochå‡½æ•°" class="headerlink" title="train_one_epochå‡½æ•°"></a>train_one_epochå‡½æ•°</h2><p>è¿™ä¸ªå…·ä½“çš„ä¸å¤šè¯´ï¼Œè¿™é‡Œå°±å†™ä¸€ä¸‹å¤§è‡´çš„æµç¨‹ï¼š</p><ol><li>åˆ©ç”¨dataloaderåŠ è½½æ•°æ®</li><li>æ•°æ®ã€æ¨¡å‹éƒ¨ç½²åˆ°cudaGPUä¸­</li><li>å‰å‘ä¼ æ’­</li><li>è®¡ç®—loss</li><li>åå‘ä¼ æ’­è®¡ç®—æ¢¯åº¦</li><li>è°ƒç”¨ä¼˜åŒ–å™¨ä¼˜åŒ–æ›´æ–°æƒé‡</li><li>åœ¨torch.no_gradæ¡ä»¶ä¸‹è®¡ç®—valå‡†ç¡®ç‡ã€‚</li></ol><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">train_one_epoch</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> trainloader<span class="token punctuation">,</span> valloader<span class="token punctuation">,</span> optimizer<span class="token punctuation">,</span> criterion<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">'''    è®­ç»ƒä¸€ä¸ªepochï¼Œè¿”å›è¯¥epochçš„train_loss, train_acc, val_accå‡†ç¡®ç‡    '''</span>    device <span class="token operator">=</span> torch<span class="token punctuation">.</span>device<span class="token punctuation">(</span><span class="token string">"cuda"</span> <span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">"cpu"</span><span class="token punctuation">)</span>    model<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># train</span>    correct <span class="token operator">=</span> <span class="token number">0</span>    total <span class="token operator">=</span> <span class="token number">0</span>    train_loss <span class="token operator">=</span> <span class="token number">0.0</span>    <span class="token keyword">for</span> i<span class="token punctuation">,</span> data <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>trainloader<span class="token punctuation">)</span><span class="token punctuation">:</span>        labels<span class="token punctuation">,</span> inputs <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>        optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>        output <span class="token operator">=</span> model<span class="token punctuation">(</span>inputs<span class="token punctuation">)</span>        _<span class="token punctuation">,</span> predicted <span class="token operator">=</span> torch<span class="token punctuation">.</span>max<span class="token punctuation">(</span>output<span class="token punctuation">.</span>data<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>        total <span class="token operator">+=</span> labels<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>        correct <span class="token operator">+=</span> <span class="token punctuation">(</span>predicted <span class="token operator">==</span> labels<span class="token punctuation">)</span><span class="token punctuation">.</span>sum<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>        loss <span class="token operator">=</span> criterion<span class="token punctuation">(</span>output<span class="token punctuation">,</span> labels<span class="token punctuation">)</span>        train_loss <span class="token operator">+=</span> loss        loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>        optimizer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>    train_loss <span class="token operator">=</span> train_loss <span class="token operator">/</span> <span class="token number">2808</span>    train_acc <span class="token operator">=</span> correct <span class="token operator">/</span> total    <span class="token comment" spellcheck="true"># valå‡†ç¡®ç‡</span>    correct <span class="token operator">=</span> <span class="token number">0</span>    total <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> data <span class="token keyword">in</span> valloader<span class="token punctuation">:</span>            labels<span class="token punctuation">,</span> images <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>            outputs <span class="token operator">=</span> model<span class="token punctuation">(</span>images<span class="token punctuation">)</span>            _<span class="token punctuation">,</span> predicted <span class="token operator">=</span> torch<span class="token punctuation">.</span>max<span class="token punctuation">(</span>outputs<span class="token punctuation">.</span>data<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            total <span class="token operator">+=</span> labels<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>            correct <span class="token operator">+=</span> <span class="token punctuation">(</span>predicted <span class="token operator">==</span> labels<span class="token punctuation">)</span><span class="token punctuation">.</span>sum<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>    val_acc <span class="token operator">=</span> correct <span class="token operator">/</span> total    <span class="token keyword">return</span> train_loss<span class="token punctuation">,</span> train_acc<span class="token punctuation">,</span> val_acc<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å…³äºå¯¼å…¥æ¨¡å‹"><a href="#å…³äºå¯¼å…¥æ¨¡å‹" class="headerlink" title="å…³äºå¯¼å…¥æ¨¡å‹"></a>å…³äºå¯¼å…¥æ¨¡å‹</h2><blockquote><p>2021.12.4æ›´æ–°ã€‚<br>æ‰€æœ‰æ¨¡å‹éƒ½åœ¨torchvisionåº“é‡Œé¢ï¼Œå…¶ä¸­torchvision.modelsä¿å­˜å®šä¹‰äº†è®¸è®¸å¤šå¤šæˆ‘ä»¬éœ€è¦çš„æ¨¡å‹ã€‚å…·ä½“å¯¼å…¥æ–¹å¼ä¹Ÿéå¸¸ç®€å•ï¼šç›´æ¥<code>torchivision.models.resnet50(pretrained=True)</code>åƒè¿™ç±»å°±è¡Œ,å½“ç„¶å¦‚æœæˆ‘ä»¬æƒ³è¦æ”¹ä¸€äº›ä¸œè¥¿ï¼Œæ¯”å¦‚resnet50æœ€åæœ‰ä¸€ä¸ªä¸€å±‚çš„å…¨è¿æ¥å±‚ï¼Œæˆ‘ä»¬æƒ³è¦æ”¹ä¸€ä¸‹è¿™ä¸ªæœ€åå…¨è¿æ¥å±‚çš„è¾“å‡º,æ¯”æ–¹è¯´ç›®å‰æˆ‘æœ‰14ç±»è¾“å‡ºä½†æ˜¯torchvisionå®˜æ–¹çš„resnet50çš„modelé»˜è®¤æœ€åçš„å…¨è¿æ¥å±‚æ˜¯<code>nn.Linear(2048, 1000)</code>,å› ä¸ºè¿™ä¸ªæ˜¯åŸºäº<code>Imagenet</code>æ•°æ®é›†çš„ã€‚é‚£ä¹ˆå¦‚æœæˆ‘ä»¬è¦æ›´æ”¹ï¼Œä¸€ä¸ªæ–¹æ³•æ˜¯å¯ä»¥æŸ¥çœ‹è¯¥æ¨¡å‹pytorchå®šä¹‰çš„æºä»£ç ï¼Œå› ä¸º<br><code>torchivision.models.resnet50(pretrained=True)</code>è¿™ä¸ªæˆ–è€…è¯´è¿™ç±»å‡½æ•°æ˜¯æœ‰ç›¸å…³çš„å‚æ•°ç”¨æ¥æ”¹æœ€åå…¨è¿æ¥å±‚çš„outputçš„ï¼Œæˆ–è€…å¯ä»¥é€‰æ‹© ç›´æ¥æ›´æ”¹ï¼Œå°±åƒæˆ‘è¿™é‡Œä¸€æ ·ï¼š</p></blockquote><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># å¯¼å…¥æ¨¡å‹</span>model <span class="token operator">=</span> models<span class="token punctuation">.</span>resnet50<span class="token punctuation">(</span>pretrained<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># print(model)</span><span class="token keyword">print</span><span class="token punctuation">(</span>model<span class="token punctuation">.</span>fc<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># æŸ¥çœ‹é»˜è®¤æœ€åä¸€å±‚å…¨è¿æ¥å±‚çš„ç»“æ„</span><span class="token comment" spellcheck="true"># print(type(model.fc))</span><span class="token comment" spellcheck="true"># print(dict(model.fc.named_parameters()).keys())</span>model<span class="token punctuation">.</span>fc <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">,</span> num_classes<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>model<span class="token punctuation">.</span>fc<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°±æ˜¯åˆ©ç”¨<code>model.fc = nn.Linear(2048, num_classes)</code>æ¥å®šä¹‰æœ€åä¸€å±‚çš„å‚æ•°ï¼Œè¿™ä¸ªå¾ˆå·§å¦™å®é™…ä¸Šï¼Œå°±ç›¸å½“äºé‡æ–°å®šä¹‰äº†ä¸€éï¼Œæ”¹äº†ç›¸å…³çš„ç»“æ„ã€‚</p><h2 id="å…³äºéƒ¨ç½²åˆ°cudaä¸Š"><a href="#å…³äºéƒ¨ç½²åˆ°cudaä¸Š" class="headerlink" title="å…³äºéƒ¨ç½²åˆ°cudaä¸Š"></a>å…³äºéƒ¨ç½²åˆ°cudaä¸Š</h2><blockquote><p>2021.12.4æ›´æ–°ã€‚</p></blockquote><p>è¿™ä¸ªæˆ‘ä¹‹å‰ä¸€ç›´ä½¿ç”¨çš„æ˜¯å…³äº<code>device = torch.device(&quot;cuda:0&quot; if torch.cuda.is_available() else &quot;cpu&quot;)</code>æ¥æŒ‡å®šgpuè®­ç»ƒï¼Œä½†æ˜¯ç»“æœå´å¹¶ä¸æ˜¯æˆ‘æƒ³çš„é‚£æ ·åœ¨ç‰¹å®šçš„gpuä¸Šè®­ç»ƒ. è¿™é‡Œç”¨åˆ°äº†ä¹‹å‰ç»„é•¿å»ºè®®çš„ä¸€ç§ç”¨æ³•ï¼Œä¹Ÿæ˜¯ä»–ä»¬å¸¸ç”¨çš„åšæ³•,ç”šè‡³å½“æ—¶æˆ‘è¿˜åœ¨åˆ†å‰²ä»»åŠ¡ä¸­åšäº†çš„ï¼Œè¿™æ˜¯æˆ‘å½“æ—¶åˆ†å‰²ä»»åŠ¡çš„è¿è¡Œä»£ç ï¼š</p><pre class="line-numbers language-python"><code class="language-python">CUDA_VISIBLE_DEVICES<span class="token operator">=</span><span class="token number">1</span> python tools<span class="token operator">/</span>test<span class="token punctuation">.</span>py configs<span class="token operator">/</span>fenghuo<span class="token operator">/</span>mask_rcnn_r50_caffe_fpn_mstrain<span class="token operator">-</span>poly_1x_fenghuo<span class="token punctuation">.</span>py work_dirs<span class="token operator">/</span>mask_rcnn_r50_caffe_fpn_mstrain<span class="token operator">-</span>poly_1x_fenghuo<span class="token operator">/</span>latest<span class="token punctuation">.</span>pth  <span class="token operator">-</span><span class="token operator">-</span>eval bbox segm<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å®é™…ä¸Šä¹Ÿå°±æ˜¯åœ¨ç›¸å…³è¿è¡Œpythonå‘½ä»¤å‰åŠ äº†<code>CUDA_VISIBLE_DEVICES=1</code>,CUDAï¼š1ï¼Œæœ‰æ—¶å€™è¦ä½¿ç”¨å¤šå¼ å¡å¹¶è¡Œå¯ä»¥é€‰æ‹©ä½¿ç”¨é€—å·åˆ†å¼€ä¸¤å¼ å¡ï¼Œä¾‹å¦‚ï¼šCUDA_VISIBLE_DEVICES=1, 2ã€‚<br>è¿™æ ·åšä¹‹åæ¨¡å‹ä¼šè¿›è¡Œå•å¡è®­ç»ƒï¼Œå¦å¤–å½“æˆ‘ä»¬è¦è¿›è¡Œå®æ—¶ç›‘æ§æ˜¾å­˜å’Œè¿›ç¨‹ç›¸å…³ä½¿ç”¨çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨<code>watch</code>å‘½ä»¤ï¼Œæ¯”å¦‚è¯´ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p><pre class="line-numbers language-python"><code class="language-python">watch <span class="token operator">-</span>n <span class="token number">1</span> nvidia<span class="token operator">-</span>smi<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™ä¸ªä»£è¡¨æ¯ä¸€ç§’åˆ·æ–°ä¸€æ¬¡æ˜¾å¡ä½¿ç”¨æƒ…å†µã€‚<br>å…³äºå¤šå¡è¿™æ–¹é¢ï¼Œæ˜¯ä¸€é—¨å¤§å­¦é—®ï¼Œæš‚æ—¶å…ˆä¸åœ¨è¿™é‡Œå±•å¼€è¯´ã€‚</p><h2 id="å…³äºbatch-size"><a href="#å…³äºbatch-size" class="headerlink" title="å…³äºbatch_size"></a>å…³äºbatch_size</h2><blockquote><p>2021.12.4æ›´æ–°ã€‚<br>æœ€ä¸€å¼€å§‹çš„æ—¶å€™è°ƒçš„batch_size=128ï¼Œä½†æ˜¯ç»“æœä¸€ä¸‹å­æ˜¾å­˜ä¸è¶³å¯¼è‡´ç¨‹åºç»ˆæ­¢äº†ã€‚æœ¬æ¥æˆ‘ä»¥ä¸ºè¿™ä¹ˆå¥½çš„æ˜¾å¡ï¼Œå®³ã€‚è¿˜æ˜¯æˆ‘å¤ªè‚¤æµ…äº†ï¼Œæœ¬èº«å›¾ç‰‡å¤§å°å°±ä¸å°ï¼Œä¸€å¼ å›¾ç‰‡<code>1800Ã—180</code>è¿™ä¹ˆå¤§çš„å›¾ç‰‡ç¡®å®(ä¸€èˆ¬ç§‘ç ”æˆ–æ˜¯ä¸€äº›ç»å…¸æ•°æ®é›†è®­ç»ƒéƒ½æ˜¯<code>224Ã—224</code>è¿™ç±»å¤§å°),å†åŠ ä¸Šè¿™äº›æ˜¾å­˜ä»€ä¹ˆçš„å’Œå¡æœ¬èº«æ˜¯2080tiè¿˜æ˜¯3090æ²¡æœ‰å…³ç³»ï¼Œè¿™ä¸ªå’Œæ˜¾å­˜æœ‰å…³ç³»ã€‚è€Œè¿™ä¸ªæœåŠ¡å™¨çš„æ˜¾å­˜æ˜¯12Gï¼Œä¹Ÿä¸æ˜¯å¾ˆå¤§ï¼Œæ‰€ä»¥è¯´æœ€å¥½è¿˜æ˜¯ä¸è¦ç”¨åˆ°è¿™ä¹ˆå¤§çš„batch_sizeäº†ï¼Œåæ¥æ”¹æˆ<code>batch_size=4</code>,ç»“æœå‘ç°ä»…ä»…4ä¸ªbatch_sizeå°±æ¶ˆè€—äº†å‡ ä¹4ä¸ªGçš„æ˜¾å­˜ï¼Œåæ¥è¯•äº†è¯•å°†batch_sizeè°ƒè‡³10ï¼Œç»“æœå·®ä¸å¤šå äº†8ä¸ªGçš„æ˜¾å­˜ï¼Œé¢„è®¡batch_size=16èƒ½å®Œå…¨å æ»¡ï¼Œä¸è¿‡è¿™é‡Œæ²¡æœ‰ç»§ç»­å®éªŒã€‚</p></blockquote><h2 id="å…³äºå¹¶è¡ŒGPUè®¡ç®—"><a href="#å…³äºå¹¶è¡ŒGPUè®¡ç®—" class="headerlink" title="å…³äºå¹¶è¡ŒGPUè®¡ç®—"></a>å…³äºå¹¶è¡ŒGPUè®¡ç®—</h2><blockquote><p>2021.12.4æ›´æ–°ã€‚</p></blockquote><h2 id="è¿›åº¦æ¡tqdm"><a href="#è¿›åº¦æ¡tqdm" class="headerlink" title="è¿›åº¦æ¡tqdm"></a>è¿›åº¦æ¡tqdm</h2><blockquote><p>2021.12.4æ›´æ–°ã€‚<br>è¿›åº¦æ¡æ€ä¹ˆç”¨ï¼Œç›®å‰æˆ‘åªä¼šç”¨éå¸¸åŸºæœ¬çš„ï¼Œå°±æ˜¯ç”¨ä¸€ä¸ª<code>tqdm.tqdm()</code>å†…å«ä¸€ä¸ªiterableçš„å‚æ•°æ¯”å¦‚åˆ—è¡¨è¿™ç±»ã€‚ç„¶åæ”¾åˆ°foré‡Œé¢è¿›è¡Œå¾ªç¯ã€‚å½“ç„¶è¿™ä¼¼ä¹å¯¹æˆ‘ç›®å‰æ¥è¯´ç®—æ˜¯å¤Ÿäº†ï¼Œä½†æ˜¯å¦‚æœæƒ³è¦æ›´è¿›ä¸€æ­¥çš„è¯å¯ä»¥çœ‹çœ‹<a href="https://github.com/tqdm/tqdm" target="_blank" rel="noopener">GitHubæºç åœ°å€</a>ï¼Œä¹Ÿæœ‰ä¸€ä¸ªè¾ƒä¸ºè¯¦ç»†çš„introduction.</p></blockquote><h2 id="ä»»åŠ¡å®Œæˆå¯ç¤ºä¸ä¸è¶³"><a href="#ä»»åŠ¡å®Œæˆå¯ç¤ºä¸ä¸è¶³" class="headerlink" title="ä»»åŠ¡å®Œæˆå¯ç¤ºä¸ä¸è¶³"></a>ä»»åŠ¡å®Œæˆå¯ç¤ºä¸ä¸è¶³</h2><p>ä»¥ä¸Šçš„ä»»åŠ¡æˆåŠŸå†™å®Œï¼Œæ¨¡å‹ä¹ŸæˆåŠŸè·‘å®Œï¼Œç»“æœå¦‚ä¸‹(ä¸€ä¸ªç®€å•çš„ç»“æœ)ï¼š<br><a href="https://imagelol.com/image/LnBiyC" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/12/03/LnBiyC.png" alt></a><br>ç›®å‰åªæ˜¯å®Œæˆäº†ä¸€ä¸ªå°çš„demoè€Œå·²ï¼Œæ•´ä¸ªé¡¹ç›®æœ‰ç€éå¸¸å¤šçš„ä»»åŠ¡éœ€è¦ç»§ç»­åšï¼Œè¿˜æœ‰å¥½å¤šä»£ç ç»§ç»­å†™ã€‚<br>æ¥ä¸‹æ¥è¦å®Œæˆçš„ä»¥åŠç›®å‰å·¥ä½œçš„ä¸è¶³åœ¨äºï¼š</p><ul><li>æ ‡ç­¾æ²¡æœ‰åˆå¹¶æ¥è®­ç»ƒï¼Œç›®å‰å„ä¸ªå°ç±»æ²¡æœ‰åˆå¹¶ï¼Œä»…ä»…æ˜¯æŠŠæ¯ä¸€ä¸ªå°ç±»éƒ½åˆ†å¼€è®­ç»ƒäº†ã€‚</li><li>batch_sizeå¯ä»¥ç»§ç»­è°ƒé«˜ï¼Œå› ä¸ºç›®å‰çš„ä»»åŠ¡å°è¯•batch_size=4å¯ä»¥å‘ç°æ˜¾å­˜å ç”¨äº†4000å¤šå…†ï¼Œç„¶è€ŒæœåŠ¡å™¨å•å¡2080tiå¯ä»¥ä½¿ç”¨è¶…è¿‡11000å…†çš„æ˜¾å­˜ï¼Œæ‰€ä»¥å¯ä»¥å°è¯•è·‘æ»¡ã€‚å½“ç„¶ç›®å‰4å¼ å¡æœ‰2å¼ æ˜¯ç©ºé—²çš„ï¼Œå¦‚æœè¦è¿›ä¸€æ­¥ä½¿ç”¨2å¼ å¡å¹¶è¡Œçš„è¯ï¼Œå¯ä»¥è¯•è¯•<a href="https://pytorch.org/tutorials/intermediate/ddp_tutorial.html" target="_blank" rel="noopener">DISTRIBUTED DATA PARALLEL</a>,å½“ç„¶è¿™ä¸ªå¯èƒ½ç›®å‰æ¯”è¾ƒéš¾ï¼Œä¸è¿‡å¯ä»¥é€‚å½“çœ‹ä¸€çœ‹ï¼Œè¿™æ ·çš„è¯batch_sizeç”šè‡³å¯ä»¥è°ƒåˆ°20ã€‚</li><li>ç›®å‰ä»…ä»…å¯¼å…¥ä½¿ç”¨äº†å®˜æ–¹çš„resnet101ï¼Œè¿˜å¯ä»¥è¯•è¯•å…¶ä»–æ¨¡å‹</li><li>epochå¯ä»¥å¾€ä¸Šè°ƒè°ƒè¯•è¯•</li><li><strong>æ¨¡å‹ã€è®­ç»ƒlogè®°å¾—ä¿å­˜</strong>ï¼ŒåŒ…æ‹¬ä¸€äº›å…³é”®çš„æ•°æ®å¯ä»¥æ”¾åˆ°ä¸€ä¸ªtxtæ–‡æ¡£é‡Œé¢ï¼Œå†™ä»£ç å®ç°logçš„è®°å½•ï¼Œå¯ä»¥å‚è€ƒmmdetectionï¼Œå®ƒçš„è®°å½•å°±éå¸¸è¯¦ç»†ã€‚</li></ul><h2 id="ä¿å­˜è®­ç»ƒæƒé‡ï¼Œæ¨¡å‹æ–¹æ³•"><a href="#ä¿å­˜è®­ç»ƒæƒé‡ï¼Œæ¨¡å‹æ–¹æ³•" class="headerlink" title="ä¿å­˜è®­ç»ƒæƒé‡ï¼Œæ¨¡å‹æ–¹æ³•"></a>ä¿å­˜è®­ç»ƒæƒé‡ï¼Œæ¨¡å‹æ–¹æ³•</h2><blockquote><p>2021.12.4æ›´æ–°ã€‚</p></blockquote><p>ä¸»è¦å‚è€ƒçš„å°±æ˜¯ä»¥ä¸‹æ–‡æ¡£ä»¬ï¼š</p><ul><li><a href="https://zhuanlan.zhihu.com/p/38056115" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/38056115</a></li><li><a href="https://blog.csdn.net/weixin_40522801/article/details/106563354" target="_blank" rel="noopener">https://blog.csdn.net/weixin_40522801/article/details/106563354</a></li><li><a href="https://pytorch.org/tutorials/beginner/saving_loading_models.html" target="_blank" rel="noopener">https://pytorch.org/tutorials/beginner/saving_loading_models.html</a></li></ul><p>å½“ç„¶ä»£ç å†™å¾—å‚è€ƒçš„æœ€å¼€å§‹é‚£ç¯‡çŸ¥ä¹æ–‡æ¡£ï¼Œæ¨¡å‹ä¿å­˜ä»£ç ä¸ºï¼š</p><pre class="line-numbers language-python"><code class="language-python">launchTimestamp <span class="token operator">=</span> str<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        torch<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'epoch'</span><span class="token punctuation">:</span> epoch <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'state_dict'</span><span class="token punctuation">:</span> model<span class="token punctuation">.</span>state_dict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'best_loss'</span><span class="token punctuation">:</span> best_loss<span class="token punctuation">,</span>                            <span class="token string">'optimizer'</span><span class="token punctuation">:</span> optimizer<span class="token punctuation">.</span>state_dict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>                           <span class="token string">'/home/lry/projects/mmdetection/lry/model_classification/checkpoints'</span> <span class="token operator">+</span> <span class="token string">'/resnet50-m-'</span> <span class="token operator">+</span> launchTimestamp <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> str<span class="token punctuation">(</span><span class="token string">"%.4f"</span> <span class="token operator">%</span> best_loss<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.pth.tar'</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>f<span class="token string">'model {launchTimestamp} saved!'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç›®å‰è¿˜æ²¡å°è¯•è¿‡åŠ è½½æ¨¡å‹ï¼Œå…ˆä¸è€ƒè™‘äº†ï¼Œä»¥åå†è¯´å§ã€‚</p><h2 id="æ¨¡å‹çš„ç±»åˆ«åˆå¹¶"><a href="#æ¨¡å‹çš„ç±»åˆ«åˆå¹¶" class="headerlink" title="æ¨¡å‹çš„ç±»åˆ«åˆå¹¶"></a>æ¨¡å‹çš„ç±»åˆ«åˆå¹¶</h2><blockquote><p>2021.12.4æ›´æ–°ã€‚<br>è¿™æ–¹é¢å®é™…ä¸Šå¤§å¤šéƒ½æ˜¯è„æ´»ç´¯æ´»ï¼Œéœ€è¦ä»‹ç»çš„æ°æ°ä¸å¤ªå¤š.<br>ä¸è¿‡ç¡®å®æ¯”è¾ƒè€ƒéªŒä»£ç èƒ½åŠ›ã€‚</p></blockquote><h2 id="å…³äºlr-scheduler"><a href="#å…³äºlr-scheduler" class="headerlink" title="å…³äºlr_scheduler"></a>å…³äºlr_scheduler</h2><blockquote><p>2021.12.4æ›´æ–°ã€‚<br>å‚è€ƒæ–‡æ¡£ï¼š<a href="https://www.kaggle.com/isbhargav/guide-to-pytorch-learning-rate-scheduling" target="_blank" rel="noopener">https://www.kaggle.com/isbhargav/guide-to-pytorch-learning-rate-scheduling</a></p></blockquote><h2 id="åˆ†ç±»ä»»åŠ¡å®Œæˆå¯ç¤ºä¸ä¸è¶³"><a href="#åˆ†ç±»ä»»åŠ¡å®Œæˆå¯ç¤ºä¸ä¸è¶³" class="headerlink" title="åˆ†ç±»ä»»åŠ¡å®Œæˆå¯ç¤ºä¸ä¸è¶³"></a>åˆ†ç±»ä»»åŠ¡å®Œæˆå¯ç¤ºä¸ä¸è¶³</h2><p>æœ¬äººä»»åŠ¡æ¥è¿‘æ”¶å°¾ï¼Œç›®å‰è¿˜æ˜¯éå¸¸æ»¡æ„çš„ï¼Œè‡³å°‘å¯¹äºç»“æœæ¥è¯´ï¼š<br><a href="https://imagelol.com/image/LnTsAT" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/12/03/LnTsAT.png" alt></a></p><p>æœ¬æ¥æˆ‘è¿˜æƒ³è¿›ä¸€æ­¥å°è¯•ä¸€ä¸‹ä¸åŒçš„å­¦ä¹ ç‡å’Œä¸€äº›å…¶ä»–çš„æ¨¡å‹ï¼Œä½†æ˜¯ç”±äºæœ¬æ¬¡å®éªŒå®é™…ä¸Šå¯¹äºä»»åŠ¡æœ¬èº«å·²ç»å®Œæˆäº†ï¼Œå¦‚æœæƒ³è¦æ·±å…¥ç ”ç©¶å¯ä»¥ä¹‹ååšç ”ç©¶æ—¶æˆ–æ˜¯æƒ³è¦æ¢ç´¢å†è¯´äº†ã€‚<br>è€Œå¯¹äºæœ¬æ¬¡æ¥çœ‹ï¼Œå®é™…ä¸Šå®Œå…¨å¤Ÿäº†ã€‚æ¥ä¸‹æ¥å°±æˆ‘ä¸ªäººè€Œè¨€ï¼Œæˆ‘æƒ³åšçš„ä¸€äº›ä¸œè¥¿å°±æ˜¯ï¼š</p><ul><li><a href="https://pytorch.org/tutorials/intermediate/ddp_tutorial.html" target="_blank" rel="noopener">DISTRIBUTED DATA PARALLEL</a>å¤šå¡è®­ç»ƒï¼Œå¯ä»¥é—®ä¸€ä¸‹å¼ ç»´å¤©å­¦å§å¥¹çš„å¤šå¡è®­ç»ƒæ˜¯æ€ä¹ˆå¼„çš„ã€‚</li><li>å¤šçœ‹çœ‹åˆ«äººå†™çš„pytorchä»£ç ï¼Œä¸ç®¡æ˜¯å“ªä¸€ç±»çš„ä»£ç éƒ½è¡Œ</li><li>å…³äºåˆ†å‰²ä»»åŠ¡çš„iouè°ƒèŠ‚æ¢ç´¢</li><li>transformerè®ºæ–‡çš„é˜…è¯»ä¸å­¦ä¹ ï¼Œå°¤å…¶æ˜¯å…³äº</li><li>å†™å®Œä¸Šé¢çš„æ–‡æ¡£(<del>å”‰å¥½å¤šæ–‡æ¡£è¦å†™ï¼Œå¯ä»¥å…ˆå†™å¤šå¡è®­ç»ƒéƒ¨åˆ†ï¼šè¾¹å­¦å¤šå¡è®­ç»ƒè¾¹å†™</del>)</li><li>å¯¼å…¥æ¨¡å‹æ–¹å¼ä¹Ÿå¯ä»¥çœ‹çœ‹<code>hello-dian-ai</code>ä¸­çš„lab2å¯¼å…¥é¢„è®­ç»ƒbackboneçš„æ–¹å¼ã€‚</li></ul><p>è¿™æ˜¯æˆªæ­¢åˆ°æœ¬å‘¨äº”æˆ‘çš„è¿™äº”å¤©ç›¸å…³ä»»åŠ¡ä»£ç å’Œæ—¶é—´çš„ç»Ÿè®¡ï¼Œpythonä»£ç æ•²äº†16ä¸ªå°æ—¶ï¼Œmarkdownç¬”è®°è®°äº†5ä¸ªå°æ—¶ã€‚æ€»ä½“æ¥çœ‹æœ¬å‘¨ä¸‰ï¼ˆ12.1æ—¥ï¼‰æ•²å¾—æœ€å¤šï¼Œæ•²äº†7ä¸ªå¤šå°æ—¶pythonä»£ç ã€‚å¯¹äºå·¥ä½œè¿˜æ˜¯éå¸¸æ»¡æ„çš„ï¼<br><a href="https://imagelol.com/image/LnT0pO" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/12/03/LnT0pO.png" alt></a></p><h2 id="DISTRIBUTED-DATA-PARALLEL"><a href="#DISTRIBUTED-DATA-PARALLEL" class="headerlink" title="DISTRIBUTED DATA PARALLEL"></a>DISTRIBUTED DATA PARALLEL</h2><p>Reference:</p><ul><li><a href="https://pytorch.org/tutorials/intermediate/ddp_tutorial.html" target="_blank" rel="noopener">https://pytorch.org/tutorials/intermediate/ddp_tutorial.html</a></li><li><a href="https://github.com/tczhangzhi/pytorch-distributed" target="_blank" rel="noopener">https://github.com/tczhangzhi/pytorch-distributed</a></li><li><a href="https://zhuanlan.zhihu.com/p/31558973" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/31558973</a></li><li><a href="https://www.cnblogs.com/jiangkejie/p/14603479.html" target="_blank" rel="noopener">https://www.cnblogs.com/jiangkejie/p/14603479.html</a></li><li><a href="https://zhuanlan.zhihu.com/p/86441879" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/86441879</a></li></ul><h2 id="ä¿®æ”¹åˆ†å‰²ä»»åŠ¡çš„IOU"><a href="#ä¿®æ”¹åˆ†å‰²ä»»åŠ¡çš„IOU" class="headerlink" title="ä¿®æ”¹åˆ†å‰²ä»»åŠ¡çš„IOU"></a>ä¿®æ”¹åˆ†å‰²ä»»åŠ¡çš„IOU</h2><p>mmlabæœ€åˆé»˜è®¤çš„é…ç½®ä¸ºï¼š</p><pre class="line-numbers language-python"><code class="language-python">    <span class="token comment" spellcheck="true"># model training and testing settings</span>    train_cfg<span class="token operator">=</span>dict<span class="token punctuation">(</span>        rpn<span class="token operator">=</span>dict<span class="token punctuation">(</span>            assigner<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'MaxIoUAssigner'</span><span class="token punctuation">,</span>                pos_iou_thr<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">,</span>                neg_iou_thr<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span>                min_pos_iou<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span>                match_low_quality<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                ignore_iof_thr<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            sampler<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'RandomSampler'</span><span class="token punctuation">,</span>                num<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>                pos_fraction<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                neg_pos_ub<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>                add_gt_as_proposals<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            allowed_border<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>            pos_weight<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>            debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        rpn_proposal<span class="token operator">=</span>dict<span class="token punctuation">(</span>            nms_pre<span class="token operator">=</span><span class="token number">2000</span><span class="token punctuation">,</span>            max_per_img<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>            nms<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'nms'</span><span class="token punctuation">,</span> iou_threshold<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            min_bbox_size<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        rcnn<span class="token operator">=</span>dict<span class="token punctuation">(</span>            assigner<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'MaxIoUAssigner'</span><span class="token punctuation">,</span>                pos_iou_thr<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                neg_iou_thr<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                min_pos_iou<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                match_low_quality<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                ignore_iof_thr<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            sampler<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'RandomSampler'</span><span class="token punctuation">,</span>                num<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span>                pos_fraction<span class="token operator">=</span><span class="token number">0.25</span><span class="token punctuation">,</span>                neg_pos_ub<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>                add_gt_as_proposals<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            mask_size<span class="token operator">=</span><span class="token number">28</span><span class="token punctuation">,</span>            pos_weight<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>            debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    test_cfg<span class="token operator">=</span>dict<span class="token punctuation">(</span>        rpn<span class="token operator">=</span>dict<span class="token punctuation">(</span>            nms_pre<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>            max_per_img<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>            nms<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'nms'</span><span class="token punctuation">,</span> iou_threshold<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            min_bbox_size<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        rcnn<span class="token operator">=</span>dict<span class="token punctuation">(</span>            score_thr<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">,</span>            nms<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'nms'</span><span class="token punctuation">,</span> iou_threshold<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            max_per_img<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>            mask_thr_binary<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬è¿™é‡Œè°ƒæ•´äº†ç›¸å…³çš„<code>pos_iou_thread=0.9 or 0.8</code>,å½“ç„¶rpnå’Œrcnnä»¥åŠnmséƒ¨åˆ†éƒ½è°ƒäº†ã€‚è°ƒæ•´åä¸ºï¼š</p><pre class="line-numbers language-python"><code class="language-python">    <span class="token comment" spellcheck="true"># model training and testing settings</span>    train_cfg<span class="token operator">=</span>dict<span class="token punctuation">(</span>        rpn<span class="token operator">=</span>dict<span class="token punctuation">(</span>            assigner<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'MaxIoUAssigner'</span><span class="token punctuation">,</span>                pos_iou_thr<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>                neg_iou_thr<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                min_pos_iou<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span>                match_low_quality<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                ignore_iof_thr<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            sampler<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'RandomSampler'</span><span class="token punctuation">,</span>                num<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>                pos_fraction<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                neg_pos_ub<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>                add_gt_as_proposals<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            allowed_border<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>            pos_weight<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>            debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        rpn_proposal<span class="token operator">=</span>dict<span class="token punctuation">(</span>            nms_pre<span class="token operator">=</span><span class="token number">2000</span><span class="token punctuation">,</span>            max_per_img<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>            nms<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'nms'</span><span class="token punctuation">,</span> iou_threshold<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            min_bbox_size<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        rcnn<span class="token operator">=</span>dict<span class="token punctuation">(</span>            assigner<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'MaxIoUAssigner'</span><span class="token punctuation">,</span>                pos_iou_thr<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span>                neg_iou_thr<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                min_pos_iou<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                match_low_quality<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                ignore_iof_thr<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            sampler<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'RandomSampler'</span><span class="token punctuation">,</span>                num<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span>                pos_fraction<span class="token operator">=</span><span class="token number">0.25</span><span class="token punctuation">,</span>                neg_pos_ub<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>                add_gt_as_proposals<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            mask_size<span class="token operator">=</span><span class="token number">28</span><span class="token punctuation">,</span>            pos_weight<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>            debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    test_cfg<span class="token operator">=</span>dict<span class="token punctuation">(</span>        rpn<span class="token operator">=</span>dict<span class="token punctuation">(</span>            nms_pre<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>            max_per_img<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>            nms<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'nms'</span><span class="token punctuation">,</span> iou_threshold<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            min_bbox_size<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        rcnn<span class="token operator">=</span>dict<span class="token punctuation">(</span>            score_thr<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">,</span>            nms<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'nms'</span><span class="token punctuation">,</span> iou_threshold<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            max_per_img<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>            mask_thr_binary<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªæ–‡æ¡£æ˜¯æˆ‘æ‰¾configæ¥å›æ‰¾æœ€åå›æº¯åˆ°çš„ï¼Œç”±äºå›æº¯è¿‡ç¨‹æ¯”è¾ƒéº»çƒ¦ï¼Œæ–‡ä»¶åä»€ä¹ˆçš„å‘½åï¼Œæœ€åä¹Ÿæ˜¯æ‰¾äº†æŒºé•¿æ—¶é—´æ‰¾<strong>å‡†</strong>äº†ã€‚ç²¾ç¡®ä½ç½®åœ¨<code>/home/lry/projects/mmdetection/configs/_base_/models/mask_rcnn_r50_fpn.py</code>è¿™é‡Œã€‚</p><p>åˆ«çš„æ²¡æœ‰å¤ªå¤šæ”¹å˜ï¼Œå°±è®­ç»ƒå®Œäº†ä¹‹åæœ‰äº›äº†ä¸€ä¸ªæ–°çš„inferenceçš„pythonä»£ç ï¼Œåœ¨<code>/home/lry/projects/mmdetection/lry/compare_sege.py</code>,ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token triple-quoted-string string">"""æœ¬æ¨¡å—æ˜¯ä¸€ä¸ªå°demoï¼Œç”¨æ¥å¯¹æ¯”å•å¼ å›¾ç‰‡ç»“æœæ€ä¹ˆæ ·"""</span><span class="token keyword">from</span> mmdet<span class="token punctuation">.</span>apis <span class="token keyword">import</span> init_detector<span class="token punctuation">,</span>inference_detector<span class="token punctuation">,</span> show_result_pyplot<span class="token keyword">import</span> mmcv<span class="token keyword">import</span> os<span class="token keyword">import</span> glob<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image<span class="token keyword">from</span> torchvision<span class="token punctuation">.</span>transforms <span class="token keyword">import</span> ToTensor<span class="token keyword">import</span> torch <span class="token keyword">as</span> t<span class="token comment" spellcheck="true"># å®šä¹‰model</span>config_file <span class="token operator">=</span> <span class="token string">"/home/lry/projects/mmdetection/configs/fenghuo/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_fenghuo.py"</span>checkpoint_file_before <span class="token operator">=</span> <span class="token string">"/home/lry/projects/mmdetection/work_dirs/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_fenghuo/latest.pth"</span>checkpoint_file_after <span class="token operator">=</span> <span class="token string">"/home/lry/checkpoints/fenghuo/model_segementation_maskrcnn_10/latest.pth"</span>model_before <span class="token operator">=</span> init_detector<span class="token punctuation">(</span>config_file<span class="token punctuation">,</span> checkpoint_file_before<span class="token punctuation">,</span>device<span class="token operator">=</span><span class="token string">"cuda:3"</span><span class="token punctuation">)</span>model_after <span class="token operator">=</span> init_detector<span class="token punctuation">(</span>config_file<span class="token punctuation">,</span> checkpoint_file_after<span class="token punctuation">,</span>device<span class="token operator">=</span><span class="token string">"cuda:2"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># é€‰å–éªŒè¯é›†çš„å‰10å¼ å›¾ç‰‡è¿›è¡ŒéªŒè¯</span>imgs <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">'/home/lry/data/780b_std/val/*.jpg'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token keyword">for</span> i<span class="token punctuation">,</span> img <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>imgs<span class="token punctuation">)</span><span class="token punctuation">:</span>    result_b <span class="token operator">=</span> inference_detector<span class="token punctuation">(</span>model_before<span class="token punctuation">,</span> img<span class="token punctuation">)</span>    model_before<span class="token punctuation">.</span>show_result<span class="token punctuation">(</span>img<span class="token punctuation">,</span> result_b<span class="token punctuation">,</span> out_file<span class="token operator">=</span>f<span class="token string">'/home/lry/checkpoints/fenghuo/compare/before/demo_val{i}.jpg'</span><span class="token punctuation">)</span>    result_a <span class="token operator">=</span> inference_detector<span class="token punctuation">(</span>model_after<span class="token punctuation">,</span> img<span class="token punctuation">)</span>    model_after<span class="token punctuation">.</span>show_result<span class="token punctuation">(</span>img<span class="token punctuation">,</span> result_a<span class="token punctuation">,</span> out_file<span class="token operator">=</span>f<span class="token string">'/home/lry/checkpoints/fenghuo/compare/after/demo_val{i}.jpg'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è®­ç»ƒæ³¨æ„"><a href="#è®­ç»ƒæ³¨æ„" class="headerlink" title="è®­ç»ƒæ³¨æ„"></a>è®­ç»ƒæ³¨æ„</h2><p>è¿™é‡Œè®­ç»ƒçš„æ—¶å€™ä¸ç»„é•¿äº¤æµçš„æ—¶å€™å‘ç°æœ‰è¿™ä¹ˆä¸€äº›é—®é¢˜ï¼š</p>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> çƒ½ç«é›†å›¢ </tag>
            
            <tag> é¡¹ç›® </tag>
            
            <tag> å›¾åƒå¤„ç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çƒ½ç«é¡¹ç›®åˆ†å‰²ä»»åŠ¡æ€»ç»“</title>
      <link href="/2021/12/05/feng-huo-xiang-mu-fen-ge-ren-wu-zong-jie/"/>
      <url>/2021/12/05/feng-huo-xiang-mu-fen-ge-ren-wu-zong-jie/</url>
      
        <content type="html"><![CDATA[<blockquote><p>é¡¹ç›®GitHubä»“åº“åœ°å€ï¼š<a href="https://github.com/LRY89757/mmdet-for-fenghuo" target="_blank" rel="noopener">https://github.com/LRY89757/mmdet-for-fenghuo</a></p></blockquote><h1 id="2021-11-9æ—¥æ™šæ›´æ–°"><a href="#2021-11-9æ—¥æ™šæ›´æ–°" class="headerlink" title="2021.11.9æ—¥æ™šæ›´æ–°"></a>2021.11.9æ—¥æ™šæ›´æ–°</h1><p>å·®ä¸å¤šç¡®å®šè®¡åˆ’ä¹‹åï¼Œè¿™ä¸€æ™šä¸Šè¿˜æ˜¯å…ˆçœ‹çœ‹æˆ‘ä¹‹å‰çš„æ‰€æœ‰å…³äºMMDetectionçš„åšå®¢ï¼Œå¯¹äºè®­ç»ƒå’Œæµ‹è¯•ä»¥åŠæ•°æ®é›†é‡æ–°ç†Ÿæ‚‰æ•´åˆä¸€ä¸‹ã€‚</p><p><strong>Note</strong>: MMDetection only supports evaluating mask AP of dataset in COCO format for now. So for instance segmentation task users should convert the data into coco format.</p><h2 id="Config"><a href="#Config" class="headerlink" title="Config"></a>Config</h2><h3 id="dataset-prepare"><a href="#dataset-prepare" class="headerlink" title="dataset prepare"></a>dataset prepare</h3><p>è¿™é‡Œæˆ‘åˆæ­¥æ‰“ç®—æ ¹æ®æˆ‘ä»¬çš„jsonæ–‡ä»¶å†™ä¸€ä¸ªè½¬åŒ–ä¸ºCOCOæ•°æ®é›†çš„<code>.py</code>æ–‡ä»¶ï¼Œå› ä¸ºç»„é•¿æ¨èçš„å†™ä¸€ä¸ªdataloaderè¿™ç§æ–¹å¼æˆ‘ç›®å‰æ²¡æœ‰å¤ªæ˜ç™½ï¼Œåæ­£ä¸ç®¡é»‘çŒ«ç™½çŒ«,å…ˆå†™å‡ºæ¥èƒ½è·‘å°±è¡ŒğŸ˜ã€‚</p><p>COCOæ•°æ®é›†å¤§æ¦‚é•¿è¿™ä¸ªæ ·å­ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token punctuation">{</span>    <span class="token string">"images"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>image<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">"annotations"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>annotation<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">"categories"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>category<span class="token punctuation">]</span><span class="token punctuation">}</span>image <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">"id"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"width"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"height"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"file_name"</span><span class="token punctuation">:</span> str<span class="token punctuation">,</span><span class="token punctuation">}</span>annotation <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">"id"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"image_id"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"category_id"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"segmentation"</span><span class="token punctuation">:</span> RLE <span class="token operator">or</span> <span class="token punctuation">[</span>polygon<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">"area"</span><span class="token punctuation">:</span> float<span class="token punctuation">,</span>    <span class="token string">"bbox"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>width<span class="token punctuation">,</span>height<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">"iscrowd"</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token operator">or</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">}</span>categories <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>    <span class="token string">"id"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"name"</span><span class="token punctuation">:</span> str<span class="token punctuation">,</span>    <span class="token string">"supercategory"</span><span class="token punctuation">:</span> str<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å½“æ—¶çœ‹å®˜ç½‘åå†™çš„åšå®¢å½“æ—¶ç¬¬ä¸€æ­¥å°±æ˜¯è½¬åŒ–ä¸€ä¸‹æ•°æ®é›†ï¼Œå½“æ—¶å®˜ç½‘ä¸“é—¨æä¾›äº†ä¸€ä¸ªBallonæ•°æ®é›†ï¼Œä¹Ÿæ˜¯äºŒåˆ†ç±»çš„æ•°æ®é›†ï¼Œå½“æ—¶æ•°æ®é›†çš„æ ¼å¼ç¡®å®ä¸æ˜¯éå¸¸åˆç†çœ‹ç€ï¼Œåé˜¿é‡Œç»è¿‡è½¬åŒ–ä¹‹åå˜æˆäº†COCOçš„æ ‡å‡†æ ¼å¼ï¼Œæˆ‘ä»¬è¿™é‡Œé‡æ–°æ¥çœ‹ä¸€ä¸‹,å¸å–ä¸Šæ¬¡çš„æ•™è®­ï¼Œè¿™é‡Œé€‰æ‹©åˆ†å±‚æ¥çœ‹ç»“æ„ï¼š</p><ul><li>ç¬¬ä¸€å±‚ç»“æ„ï¼š<br><a href="https://imagelol.com/image/I967LC" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/11/09/I967LC.png" alt></a><br>å¤§ç»“æ„å°±æ˜¯å›¾åƒéƒ½æœ‰ä»€ä¹ˆï¼Œç„¶åæ ‡è®°éƒ½æ˜¯ä»€ä¹ˆï¼Œç„¶åæ˜¯åˆ†ç±»çš„ç±»åˆ«éƒ½æœ‰ä»€ä¹ˆ.æ¥ä¸‹æ¥æ·±å…¥çœ‹ï¼š</li><li>ç¬¬äºŒå±‚ç»“æ„ä¹‹<code>images</code><br><a href="https://imagelol.com/image/I96d4R" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/11/09/I96d4R.png" alt></a></li></ul><p><code>images</code>ä¸»è¦è®°å½•çš„å°±æ˜¯å›¾ç‰‡çš„ä¸€ä¸ªidsè¿˜æœ‰é«˜å®½ï¼Œè¿™ä¸ªé«˜å®½è¿˜æ˜¯è›®é‡è¦çš„ï¼Œä»¥åŠæ–‡ä»¶åã€‚</p><ul><li><p>ç¬¬äºŒå±‚ç»“æ„ä¹‹<code>annotations</code><br><a href="https://imagelol.com/image/I96eDz" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/11/09/I96eDz.png" alt></a><br>è¯¥å±‚å°±æ˜¯æˆ‘ä»¬çš„åˆ†ç±»category_idå’Œæ¡†bboxè¿˜æœ‰åˆ†å‰²æ•°æ®segmentationçš„ç»“æ„äº†ã€‚category_idæ˜¯ç±»åˆ«çš„ç§ç±»æ•°ï¼Œbboxæ˜¯æ£€æµ‹æ¡†ï¼Œsegmentationæ˜¯åˆ†å‰²çš„æ•°æ®æ ‡æ³¨ã€‚å…¶ä»–çš„æ˜¯å’Œä¸Šé¢çš„ä¸€ä¸€å¯¹åº”çš„ï¼ˆ<del>æ¯”å¦‚è¯´image_idè¡¨ç¤ºè¯¥æ ‡æ³¨å±äºé‚£ä¸€å¼ å›¾ç‰‡â€¦â€¦</del>ï¼‰ï¼Œè¿˜æœ‰ä¸€äº›ä¸è¯´äº†ï¼Œä¸æ˜¯éå¸¸é‡è¦ã€‚<br>çœ‹ä¸‹å®Œæ•´çš„åŒ…å«å…·ä½“bboxå’Œsegmentationæ•°æ®çš„å›¾ï¼š<br><a href="https://imagelol.com/image/I96U2p" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/11/09/I96U2p.png" alt></a></p></li><li><p>ç¬¬äºŒå±‚ç»“æ„ä¹‹<code>categories</code>:<br><a href="https://imagelol.com/image/I96Y9W" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/11/09/I96Y9W.png" alt></a></p></li></ul><p>ç”±äºè¿™ä¸ªæ•°æ®é›†éå¸¸ç®€å•,å°±æ˜¯ä¸€ä¸ªå…³äºballoonçš„æ£€æµ‹åˆ†å‰²ä»»åŠ¡,æ‰€ä»¥ç±»åˆ«åªæœ‰ä¸€ä¸ª,ç›¸å¯¹è€Œè¨€è¿˜æŒºå¥½.<br><del>æˆ‘çªç„¶èœœæ±è‡ªä¿¡,æˆ‘ä»¬çš„æ•°æ®ä¹Ÿæ˜¯åˆæ­¥åªæœ‰ä¸€ä¸ªæ¡†è®©æˆ‘ä»¬æ£€æµ‹,æˆ‘æ€ä¹ˆè§‰å¾—æˆ‘åˆè¡Œäº†</del></p><p>å¥½æ»´,æ•°æ®é›†å¤§æ¦‚å°±æ˜¯è¿™æ ·!æˆ‘ä»¬ç»ˆäºå¯ä»¥æ¥çœ‹ä¸€ä¸‹å…³äºConfigç›¸å…³çš„æ–‡ä»¶äº†.</p><h3 id="config"><a href="#config" class="headerlink" title="config"></a>config</h3><p>æˆ‘è‡ªè®¤ä¸ºæˆ‘å½“æ—¶å†™å¾—å…³äºConfigçš„è§£é‡Šå·²ç»å¤Ÿè¯¦ç»†äº†ç›´åˆ°æˆ‘åˆçœ‹äº†ä¸€éç›¸å…³çš„<a href="https://mmdetection.readthedocs.io/en/latest/tutorials/config.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>,å‘ç°å½“æ—¶è§£é‡Šçš„æ¼æ´è¿˜æ˜¯éå¸¸å¤š,æ‰€ä»¥åœ¨è¿™é‡Œå¤šå†™ä¸€ç‚¹.</p><blockquote><p>We incorporate modular and inheritance design into our config system, which is convenient to conduct various experiments. If you wish to inspect the config file, you may run <code>python tools/misc/print_config.py /PATH/TO/CONFIG</code> to see the complete config.</p></blockquote><p>æ­£å¦‚ä¸Šé¢æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>python tools/misc/print_config.py /PATH/TO/CONFIG</code> å‘½ä»¤æ¥å¯¹æˆ‘ä»¬æƒ³è¦äº†è§£çš„configæ–‡ä»¶æ¥çœ‹ä»–ä»¬ç›¸å…³çš„å…·ä½“é…ç½®.<del>äºæˆ‘å½“æ—¶è¿˜ä¸“é—¨å†™äº†ä¸ªç›¸å…³çš„æ‰“å°é…ç½®ä»£ç â€¦</del></p><p>æŠ„ä¸€ä¸‹æˆ‘è‡ªå·±çš„blog:</p><blockquote><p>æˆ‘ä»¬çš„configéœ€è¦æ”¾åˆ°<code>configs/balloon/</code>ç›®å½•ä¸‹å¹¶ä¸”å‘½åä¸ºï¼š<code>mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_balloon.py</code></p><p>å…³äºè¿™ä¹ˆä¸€ä¸ªåå­—ï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆå¤æ‚æ˜¯æœ‰åŸå› çš„ï¼Œå‚è§è¿™é‡Œ:<a href="https://mmdetection.readthedocs.io/zh_CN/v2.18.0/tutorials/config.html#id4" target="_blank" rel="noopener">https://mmdetection.readthedocs.io/zh_CN/v2.18.0/tutorials/config.html#id4</a></p></blockquote><p>å½“æ—¶çš„æˆ‘ä¹ŸçœŸæ˜¯å¤Ÿè¾›è‹¦,å®˜ç½‘ç»™çš„æŒºå¤šä¸œè¥¿éƒ½æœ‰é—®é¢˜,æˆ‘å½“æ—¶å°±è‡ªå·±ä¿®æ”¹äº†è®¸å¤šä¸œè¥¿,æ€»ç®—è®©æˆ‘ä»¬çš„balloon.pyæˆåŠŸè¿è¡Œäº†:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># The new config inherits a base config to highlight the necessary modification</span>_base_ <span class="token operator">=</span> <span class="token string">'../mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_coco.py'</span><span class="token comment" spellcheck="true"># We also need to change the num_classes in head to match the dataset's annotation</span>model <span class="token operator">=</span> dict<span class="token punctuation">(</span>    roi_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>        bbox_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>num_classes<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        mask_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>num_classes<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># Modify dataset related settings</span>dataset_type <span class="token operator">=</span> <span class="token string">'COCODataset'</span>classes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'balloon'</span><span class="token punctuation">,</span><span class="token punctuation">)</span>data <span class="token operator">=</span> dict<span class="token punctuation">(</span>    train<span class="token operator">=</span>dict<span class="token punctuation">(</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/train/'</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/train/annotation_coco.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    val<span class="token operator">=</span>dict<span class="token punctuation">(</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/val/'</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/val/annotation_coco.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    test<span class="token operator">=</span>dict<span class="token punctuation">(</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/val/'</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/val/annotation_coco.json'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># We can use the pre-trained Mask RCNN model to obtain higher performance</span><span class="token comment" spellcheck="true"># load_from = 'checkpoints/mask_rcnn_r50_caffe_fpn_mstrain-poly_3x_coco_bbox_mAP-0.408__segm_mAP-0.37_20200504_163245-42aa3d00.pth'</span>load_from <span class="token operator">=</span> <span class="token string">'https://download.openmmlab.com/mmdetection/v2.0/mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_3x_coco/mask_rcnn_r50_caffe_fpn_mstrain-poly_3x_coco_bbox_mAP-0.408__segm_mAP-0.37_20200504_163245-42aa3d00.pth'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å½“æ—¶å†™é‚£ç¯‡åšæ–‡<a href="https://lry89757.github.io/2021/10/12/practice-mmdet-customized-datasets/">practice mmdet(Customized datasets)</a>çš„æ—¶å€™,è¿˜æ²¡æœ‰å½»åº•è¯»æºç è¿›è¡Œç›¸å…³çš„æº¯æº,è€Œåœ¨æˆ‘æº¯æºä»£ç <a href="https://lry89757.github.io/2021/10/16/code-trace-of-mmdetection/">Code Trace of mmdetection</a>ä¹‹å,å¯¹æ•´ä¸ªå·¥ç¨‹çš„ç†è§£ä¸Šå‡äº†ä¸€ä¸ªå±‚æ¬¡,ä¸å¾—ä¸è¯´è¿˜çœŸæ˜¯å¤Ÿå¯ä»¥çš„,è¿˜æ˜¯å­¦å¥½ç›¸å…³çš„æ–‡ä»¶ã€è¯»æ‡‚æºç æ‰ç®—çœŸæ­£ç†è§£äº†å¾ˆå¤šä¸œè¥¿. è€Œå°½ç®¡è¯»äº†éƒ¨åˆ†æºç ä½†è¿˜æ˜¯ä¸çŸ¥å…¨å±€,æ­£æ˜¯å½“æˆ‘çœ‹äº†çŸ¥ä¹å®˜æ–¹å†™å¾—æ•´ä½“æ¡†æ¶åæ‰æ›´åŠ å…¨å±€äº†è§£äº†æœ‰å…³çš„ç»“æ„.å¯¹äºCVæ•´ä½“çš„æµç¨‹ç›®å‰ä¹Ÿæœ‰äº†æ›´å¥½çš„æŠŠæ¡.</p><p>ä¸Šé¢ä¸€æ®µæ‰¯äº†é‚£ä¹ˆå¤š,æˆ‘ä»¬æ¥è¿è¡Œå‘½ä»¤<code>python tools/misc/print_config.py /home/lry/projects/mmdetection/configs/balloon/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_balloon.py</code>æ¥çœ‹çœ‹configåˆ°åº•æ˜¯ä»€ä¹ˆä¸œè¥¿:<br>æˆ‘å…ˆæŠŠå¾—åˆ°çš„æ•´ä¸ªçš„ç»“æœå¤åˆ¶ä¸‹æ¥ä»¥ä¾¿å„ä½ç ”ç©¶:</p><pre class="line-numbers language-python"><code class="language-python">Config<span class="token punctuation">:</span>model <span class="token operator">=</span> dict<span class="token punctuation">(</span>    type<span class="token operator">=</span><span class="token string">'MaskRCNN'</span><span class="token punctuation">,</span>    backbone<span class="token operator">=</span>dict<span class="token punctuation">(</span>        type<span class="token operator">=</span><span class="token string">'ResNet'</span><span class="token punctuation">,</span>        depth<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span>        num_stages<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>        out_indices<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        frozen_stages<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>        norm_cfg<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'BN'</span><span class="token punctuation">,</span> requires_grad<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        norm_eval<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>        style<span class="token operator">=</span><span class="token string">'caffe'</span><span class="token punctuation">,</span>        init_cfg<span class="token operator">=</span>dict<span class="token punctuation">(</span>            type<span class="token operator">=</span><span class="token string">'Pretrained'</span><span class="token punctuation">,</span>            checkpoint<span class="token operator">=</span><span class="token string">'open-mmlab://detectron2/resnet50_caffe'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    neck<span class="token operator">=</span>dict<span class="token punctuation">(</span>        type<span class="token operator">=</span><span class="token string">'FPN'</span><span class="token punctuation">,</span>        in_channels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token number">2048</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>        num_outs<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    rpn_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>        type<span class="token operator">=</span><span class="token string">'RPNHead'</span><span class="token punctuation">,</span>        in_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>        feat_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>        anchor_generator<span class="token operator">=</span>dict<span class="token punctuation">(</span>            type<span class="token operator">=</span><span class="token string">'AnchorGenerator'</span><span class="token punctuation">,</span>            scales<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            ratios<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            strides<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        bbox_coder<span class="token operator">=</span>dict<span class="token punctuation">(</span>            type<span class="token operator">=</span><span class="token string">'DeltaXYWHBBoxCoder'</span><span class="token punctuation">,</span>            target_means<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            target_stds<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        loss_cls<span class="token operator">=</span>dict<span class="token punctuation">(</span>            type<span class="token operator">=</span><span class="token string">'CrossEntropyLoss'</span><span class="token punctuation">,</span> use_sigmoid<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> loss_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        loss_bbox<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'L1Loss'</span><span class="token punctuation">,</span> loss_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    roi_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>        type<span class="token operator">=</span><span class="token string">'StandardRoIHead'</span><span class="token punctuation">,</span>        bbox_roi_extractor<span class="token operator">=</span>dict<span class="token punctuation">(</span>            type<span class="token operator">=</span><span class="token string">'SingleRoIExtractor'</span><span class="token punctuation">,</span>            roi_layer<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'RoIAlign'</span><span class="token punctuation">,</span> output_size<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span> sampling_ratio<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>            featmap_strides<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        bbox_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>            type<span class="token operator">=</span><span class="token string">'Shared2FCBBoxHead'</span><span class="token punctuation">,</span>            in_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>            fc_out_channels<span class="token operator">=</span><span class="token number">1024</span><span class="token punctuation">,</span>            roi_feat_size<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span>            num_classes<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>            bbox_coder<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'DeltaXYWHBBoxCoder'</span><span class="token punctuation">,</span>                target_means<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                target_stds<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            reg_class_agnostic<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>            loss_cls<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'CrossEntropyLoss'</span><span class="token punctuation">,</span> use_sigmoid<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> loss_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            loss_bbox<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'L1Loss'</span><span class="token punctuation">,</span> loss_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        mask_roi_extractor<span class="token operator">=</span>dict<span class="token punctuation">(</span>            type<span class="token operator">=</span><span class="token string">'SingleRoIExtractor'</span><span class="token punctuation">,</span>            roi_layer<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'RoIAlign'</span><span class="token punctuation">,</span> output_size<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">,</span> sampling_ratio<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>            featmap_strides<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        mask_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>            type<span class="token operator">=</span><span class="token string">'FCNMaskHead'</span><span class="token punctuation">,</span>            num_convs<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>            in_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>            conv_out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>            num_classes<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>            loss_mask<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'CrossEntropyLoss'</span><span class="token punctuation">,</span> use_mask<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> loss_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    train_cfg<span class="token operator">=</span>dict<span class="token punctuation">(</span>        rpn<span class="token operator">=</span>dict<span class="token punctuation">(</span>            assigner<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'MaxIoUAssigner'</span><span class="token punctuation">,</span>                pos_iou_thr<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">,</span>                neg_iou_thr<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span>                min_pos_iou<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span>                match_low_quality<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                ignore_iof_thr<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            sampler<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'RandomSampler'</span><span class="token punctuation">,</span>                num<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>                pos_fraction<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                neg_pos_ub<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>                add_gt_as_proposals<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            allowed_border<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>            pos_weight<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>            debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        rpn_proposal<span class="token operator">=</span>dict<span class="token punctuation">(</span>            nms_pre<span class="token operator">=</span><span class="token number">2000</span><span class="token punctuation">,</span>            max_per_img<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>            nms<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'nms'</span><span class="token punctuation">,</span> iou_threshold<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            min_bbox_size<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        rcnn<span class="token operator">=</span>dict<span class="token punctuation">(</span>            assigner<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'MaxIoUAssigner'</span><span class="token punctuation">,</span>                pos_iou_thr<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                neg_iou_thr<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                min_pos_iou<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                match_low_quality<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                ignore_iof_thr<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            sampler<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'RandomSampler'</span><span class="token punctuation">,</span>                num<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span>                pos_fraction<span class="token operator">=</span><span class="token number">0.25</span><span class="token punctuation">,</span>                neg_pos_ub<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>                add_gt_as_proposals<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            mask_size<span class="token operator">=</span><span class="token number">28</span><span class="token punctuation">,</span>            pos_weight<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>            debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    test_cfg<span class="token operator">=</span>dict<span class="token punctuation">(</span>        rpn<span class="token operator">=</span>dict<span class="token punctuation">(</span>            nms_pre<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>            max_per_img<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>            nms<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'nms'</span><span class="token punctuation">,</span> iou_threshold<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            min_bbox_size<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        rcnn<span class="token operator">=</span>dict<span class="token punctuation">(</span>            score_thr<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">,</span>            nms<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'nms'</span><span class="token punctuation">,</span> iou_threshold<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            max_per_img<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>            mask_thr_binary<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>dataset_type <span class="token operator">=</span> <span class="token string">'COCODataset'</span>data_root <span class="token operator">=</span> <span class="token string">'data/coco/'</span>img_norm_cfg <span class="token operator">=</span> dict<span class="token punctuation">(</span>    mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">103.53</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">123.675</span><span class="token punctuation">]</span><span class="token punctuation">,</span> std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> to_rgb<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>train_pipeline <span class="token operator">=</span> <span class="token punctuation">[</span>    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'LoadImageFromFile'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    dict<span class="token punctuation">(</span>        type<span class="token operator">=</span><span class="token string">'LoadAnnotations'</span><span class="token punctuation">,</span>        with_bbox<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>        with_mask<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>        poly2mask<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    dict<span class="token punctuation">(</span>        type<span class="token operator">=</span><span class="token string">'Resize'</span><span class="token punctuation">,</span>        img_scale<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">640</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">672</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">704</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">736</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                   <span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">768</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        multiscale_mode<span class="token operator">=</span><span class="token string">'value'</span><span class="token punctuation">,</span>        keep_ratio<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'RandomFlip'</span><span class="token punctuation">,</span> flip_ratio<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    dict<span class="token punctuation">(</span>        type<span class="token operator">=</span><span class="token string">'Normalize'</span><span class="token punctuation">,</span>        mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">103.53</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">123.675</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        to_rgb<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'Pad'</span><span class="token punctuation">,</span> size_divisor<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'DefaultFormatBundle'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'Collect'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">,</span> <span class="token string">'gt_bboxes'</span><span class="token punctuation">,</span> <span class="token string">'gt_labels'</span><span class="token punctuation">,</span> <span class="token string">'gt_masks'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>test_pipeline <span class="token operator">=</span> <span class="token punctuation">[</span>    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'LoadImageFromFile'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    dict<span class="token punctuation">(</span>        type<span class="token operator">=</span><span class="token string">'MultiScaleFlipAug'</span><span class="token punctuation">,</span>        img_scale<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        flip<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>        transforms<span class="token operator">=</span><span class="token punctuation">[</span>            dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'Resize'</span><span class="token punctuation">,</span> keep_ratio<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'RandomFlip'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'Normalize'</span><span class="token punctuation">,</span>                mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">103.53</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">123.675</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                to_rgb<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'Pad'</span><span class="token punctuation">,</span> size_divisor<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'ImageToTensor'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'Collect'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>data <span class="token operator">=</span> dict<span class="token punctuation">(</span>    samples_per_gpu<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>    workers_per_gpu<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>    train<span class="token operator">=</span>dict<span class="token punctuation">(</span>        type<span class="token operator">=</span><span class="token string">'CocoDataset'</span><span class="token punctuation">,</span>        ann_file<span class="token operator">=</span>        <span class="token string">'/home/lry/projects/mmdetection/data/balloon/train/annotation_coco.json'</span><span class="token punctuation">,</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/train/'</span><span class="token punctuation">,</span>        pipeline<span class="token operator">=</span><span class="token punctuation">[</span>            dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'LoadImageFromFile'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'LoadAnnotations'</span><span class="token punctuation">,</span>                with_bbox<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                with_mask<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                poly2mask<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'Resize'</span><span class="token punctuation">,</span>                img_scale<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">640</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">672</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">704</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">736</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                           <span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">768</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                multiscale_mode<span class="token operator">=</span><span class="token string">'value'</span><span class="token punctuation">,</span>                keep_ratio<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'RandomFlip'</span><span class="token punctuation">,</span> flip_ratio<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'Normalize'</span><span class="token punctuation">,</span>                mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">103.53</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">123.675</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                to_rgb<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'Pad'</span><span class="token punctuation">,</span> size_divisor<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'DefaultFormatBundle'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'Collect'</span><span class="token punctuation">,</span>                keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">,</span> <span class="token string">'gt_bboxes'</span><span class="token punctuation">,</span> <span class="token string">'gt_labels'</span><span class="token punctuation">,</span> <span class="token string">'gt_masks'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'balloon'</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    val<span class="token operator">=</span>dict<span class="token punctuation">(</span>        type<span class="token operator">=</span><span class="token string">'CocoDataset'</span><span class="token punctuation">,</span>        ann_file<span class="token operator">=</span>        <span class="token string">'/home/lry/projects/mmdetection/data/balloon/val/annotation_coco.json'</span><span class="token punctuation">,</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/val/'</span><span class="token punctuation">,</span>        pipeline<span class="token operator">=</span><span class="token punctuation">[</span>            dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'LoadImageFromFile'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'MultiScaleFlipAug'</span><span class="token punctuation">,</span>                img_scale<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                flip<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>                transforms<span class="token operator">=</span><span class="token punctuation">[</span>                    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'Resize'</span><span class="token punctuation">,</span> keep_ratio<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'RandomFlip'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    dict<span class="token punctuation">(</span>                        type<span class="token operator">=</span><span class="token string">'Normalize'</span><span class="token punctuation">,</span>                        mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">103.53</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">123.675</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                        std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                        to_rgb<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'Pad'</span><span class="token punctuation">,</span> size_divisor<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'ImageToTensor'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'Collect'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'balloon'</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    test<span class="token operator">=</span>dict<span class="token punctuation">(</span>        type<span class="token operator">=</span><span class="token string">'CocoDataset'</span><span class="token punctuation">,</span>        ann_file<span class="token operator">=</span>        <span class="token string">'/home/lry/projects/mmdetection/data/balloon/val/annotation_coco.json'</span><span class="token punctuation">,</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/val/'</span><span class="token punctuation">,</span>        pipeline<span class="token operator">=</span><span class="token punctuation">[</span>            dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'LoadImageFromFile'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'MultiScaleFlipAug'</span><span class="token punctuation">,</span>                img_scale<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                flip<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>                transforms<span class="token operator">=</span><span class="token punctuation">[</span>                    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'Resize'</span><span class="token punctuation">,</span> keep_ratio<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'RandomFlip'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    dict<span class="token punctuation">(</span>                        type<span class="token operator">=</span><span class="token string">'Normalize'</span><span class="token punctuation">,</span>                        mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">103.53</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">123.675</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                        std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                        to_rgb<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'Pad'</span><span class="token punctuation">,</span> size_divisor<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'ImageToTensor'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'Collect'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'balloon'</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>evaluation <span class="token operator">=</span> dict<span class="token punctuation">(</span>metric<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'bbox'</span><span class="token punctuation">,</span> <span class="token string">'segm'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>optimizer <span class="token operator">=</span> dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'SGD'</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.02</span><span class="token punctuation">,</span> momentum<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span> weight_decay<span class="token operator">=</span><span class="token number">0.0001</span><span class="token punctuation">)</span>optimizer_config <span class="token operator">=</span> dict<span class="token punctuation">(</span>grad_clip<span class="token operator">=</span>None<span class="token punctuation">)</span>lr_config <span class="token operator">=</span> dict<span class="token punctuation">(</span>    policy<span class="token operator">=</span><span class="token string">'step'</span><span class="token punctuation">,</span>    warmup<span class="token operator">=</span><span class="token string">'linear'</span><span class="token punctuation">,</span>    warmup_iters<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span>    warmup_ratio<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">,</span>    step<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">)</span>runner <span class="token operator">=</span> dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'EpochBasedRunner'</span><span class="token punctuation">,</span> max_epochs<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>checkpoint_config <span class="token operator">=</span> dict<span class="token punctuation">(</span>interval<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>log_config <span class="token operator">=</span> dict<span class="token punctuation">(</span>interval<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> hooks<span class="token operator">=</span><span class="token punctuation">[</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'TextLoggerHook'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>custom_hooks <span class="token operator">=</span> <span class="token punctuation">[</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'NumClassCheckHook'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>dist_params <span class="token operator">=</span> dict<span class="token punctuation">(</span>backend<span class="token operator">=</span><span class="token string">'nccl'</span><span class="token punctuation">)</span>log_level <span class="token operator">=</span> <span class="token string">'INFO'</span>load_from <span class="token operator">=</span> <span class="token string">'https://download.openmmlab.com/mmdetection/v2.0/mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_3x_coco/mask_rcnn_r50_caffe_fpn_mstrain-poly_3x_coco_bbox_mAP-0.408__segm_mAP-0.37_20200504_163245-42aa3d00.pth'</span>resume_from <span class="token operator">=</span> Noneworkflow <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'train'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>classes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'balloon'</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬ä¸€ä¸ªä¸€ä¸ªæ…¢æ…¢çœ‹,å®é™…ä¸Šå°±æ˜¯æ£€æµ‹åˆ†å‰²çš„å„ä¸ªç»“æ„æµç¨‹(backbone, neck, rpn_head, roi_head)ä»¥åŠæˆ‘ä»¬è®­ç»ƒéªŒè¯æ•°æ®çš„æ ¼å¼é¢„è®­ç»ƒæ–¹æ³•(train_cfg, data_type, data_root, train_pipeline, testâ€¦)ä»¥åŠå„ç±»å…³äºæƒé‡ä½ç½®ã€å­¦ä¹ ç‡ã€ä¼˜åŒ–å‡½æ•°ç­‰ç­‰â€¦:</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211109210515.png" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211109210526.png" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211109210532.png" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211109210556.png" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211109210539.png" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211109210544.png" alt></p><p>é™¤äº†ä»¥ä¸Šç»“æ„ä¹‹å¤–,å‰©ä¸‹çš„å°±æ˜¯ä¸€äº›æˆ‘ä»¬çš„å…¶ä½™é…ç½®:</p><pre class="line-numbers language-python"><code class="language-python">evaluation <span class="token operator">=</span> dict<span class="token punctuation">(</span>metric<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'bbox'</span><span class="token punctuation">,</span> <span class="token string">'segm'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>optimizer <span class="token operator">=</span> dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'SGD'</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.02</span><span class="token punctuation">,</span> momentum<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span> weight_decay<span class="token operator">=</span><span class="token number">0.0001</span><span class="token punctuation">)</span>optimizer_config <span class="token operator">=</span> dict<span class="token punctuation">(</span>grad_clip<span class="token operator">=</span>None<span class="token punctuation">)</span>lr_config <span class="token operator">=</span> dict<span class="token punctuation">(</span>    policy<span class="token operator">=</span><span class="token string">'step'</span><span class="token punctuation">,</span>    warmup<span class="token operator">=</span><span class="token string">'linear'</span><span class="token punctuation">,</span>    warmup_iters<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span>    warmup_ratio<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">,</span>    step<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">)</span>runner <span class="token operator">=</span> dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'EpochBasedRunner'</span><span class="token punctuation">,</span> max_epochs<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>checkpoint_config <span class="token operator">=</span> dict<span class="token punctuation">(</span>interval<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>log_config <span class="token operator">=</span> dict<span class="token punctuation">(</span>interval<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> hooks<span class="token operator">=</span><span class="token punctuation">[</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'TextLoggerHook'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>custom_hooks <span class="token operator">=</span> <span class="token punctuation">[</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'NumClassCheckHook'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>dist_params <span class="token operator">=</span> dict<span class="token punctuation">(</span>backend<span class="token operator">=</span><span class="token string">'nccl'</span><span class="token punctuation">)</span>log_level <span class="token operator">=</span> <span class="token string">'INFO'</span>load_from <span class="token operator">=</span> <span class="token string">'https://download.openmmlab.com/mmdetection/v2.0/mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_3x_coco/mask_rcnn_r50_caffe_fpn_mstrain-poly_3x_coco_bbox_mAP-0.408__segm_mAP-0.37_20200504_163245-42aa3d00.pth'</span>resume_from <span class="token operator">=</span> Noneworkflow <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'train'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>classes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'balloon'</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="2021-11-10æ™šæ›´æ–°"><a href="#2021-11-10æ™šæ›´æ–°" class="headerlink" title="2021.11.10æ™šæ›´æ–°"></a>2021.11.10æ™šæ›´æ–°</h1><h2 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h2><p>æŒ‰ç…§æ˜¨å¤©çœ‹çš„è‡ªå·±ä¹‹å‰åšå®¢å’Œæ€»ç»“çš„æ€è·¯ï¼Œç›®å‰å½“åŠ¡ä¹‹æ€¥å°±æ˜¯æ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„ä»£ç æ¥è½¬æ¢labelmeæ ‡æ³¨çš„æ•°æ®é›†å˜ä¸ºCOCOæ ¼å¼çš„ï¼Œç›®å‰åœ¨GitHubæˆ‘æ‰¾åˆ°äº†ä¸€äº›ç›¸å…³çš„å¼€æºå°é¡¹ç›®ï¼Œæ‰“ç®—æ ¹æ®è¿™ä¸ªä»“åº“<a href="https://github.com/veraposeidon/labelme2Datasets" target="_blank" rel="noopener">https://github.com/veraposeidon/labelme2Datasets</a> æ¥è½¬æ¢æˆ‘ä»¬çš„æ•°æ®ï¼Œå½“ç„¶è¿™é‡Œè‚¯å®šéœ€è¦æ›´æ”¹ä¸€äº›ä»£ç ã€‚å¦å¤–è¿™é‡Œç”±äºåˆ†å‰²å¹¶æ²¡æœ‰åšæ•°æ®æ ‡æ³¨ï¼Œæ‰€ä»¥æˆ‘è‡ªå·±å¾—é‡æ–°å†™ä¸€éåˆ†å‰²çš„ç›¸å…³æ ‡æ³¨ã€‚</p><blockquote><p>çœŸæ˜¯æ‡’å¾—å¤Ÿå¯ä»¥ï¼Œ11.10æ•´å®Œçš„ï¼Œè¦ç­‰åˆ°11.13å·æ¥å†™ï¼Œåäº†ã€‚</p></blockquote><h2 id="COCO-jsonå’ŒLabelme-jsonåŒºåˆ«"><a href="#COCO-jsonå’ŒLabelme-jsonåŒºåˆ«" class="headerlink" title="COCO.jsonå’ŒLabelme.jsonåŒºåˆ«"></a>COCO.jsonå’ŒLabelme.jsonåŒºåˆ«</h2><p><del>å¾…æ›´</del><br>2021.11.13å·²æ›´æ–°ã€‚</p><p>ä¸Šé¢æœ‰æåˆ°Labelme.jsonæ–‡ä»¶ä¸»è¦æ ¼å¼ï¼ŒCOCOæ•°æ®é›†å¤§æ¦‚é•¿è¿™ä¸ªæ ·å­ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token punctuation">{</span>    <span class="token string">"images"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>image<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">"annotations"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>annotation<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">"categories"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>category<span class="token punctuation">]</span><span class="token punctuation">}</span>image <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">"id"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"width"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"height"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"file_name"</span><span class="token punctuation">:</span> str<span class="token punctuation">,</span><span class="token punctuation">}</span>annotation <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">"id"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"image_id"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"category_id"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"segmentation"</span><span class="token punctuation">:</span> RLE <span class="token operator">or</span> <span class="token punctuation">[</span>polygon<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">"area"</span><span class="token punctuation">:</span> float<span class="token punctuation">,</span>    <span class="token string">"bbox"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>width<span class="token punctuation">,</span>height<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">"iscrowd"</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token operator">or</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">}</span>categories <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>    <span class="token string">"id"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"name"</span><span class="token punctuation">:</span> str<span class="token punctuation">,</span>    <span class="token string">"supercategory"</span><span class="token punctuation">:</span> str<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>COCOçš„jsonæ–‡ä»¶æ˜¯æ‰€æœ‰å›¾ç‰‡éƒ½æ”¾åˆ°ä¸€ä¸ªjsonæ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”ç±»åˆ«ã€å›¾ç‰‡æå‰éƒ½ç”¨ç¼–å·idå®šä¹‰å¥½ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç»§ç»­çœ‹ä¸€ä¸‹Labelme.jsonæ–‡ä»¶åŒ…å«ä»€ä¹ˆï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token punctuation">{</span>  <span class="token string">"version"</span><span class="token punctuation">:</span> <span class="token string">"4.5.13"</span><span class="token punctuation">,</span>  <span class="token string">"flags"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token string">"shapes"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>    <span class="token punctuation">{</span>      <span class="token string">"label"</span><span class="token punctuation">:</span> <span class="token string">"780B"</span><span class="token punctuation">,</span>      <span class="token string">"points"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">[</span>          <span class="token number">734.0</span><span class="token punctuation">,</span>          <span class="token number">2425.0</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span>          <span class="token number">2779.0</span><span class="token punctuation">,</span>          <span class="token number">2355.0</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span>          <span class="token number">2584.0</span><span class="token punctuation">,</span>          <span class="token number">3580.0</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span>          <span class="token number">819.0</span><span class="token punctuation">,</span>          <span class="token number">3770.0</span>        <span class="token punctuation">]</span>      <span class="token punctuation">]</span><span class="token punctuation">,</span>      <span class="token string">"group_id"</span><span class="token punctuation">:</span> null<span class="token punctuation">,</span>      <span class="token string">"shape_type"</span><span class="token punctuation">:</span> <span class="token string">"polygon"</span><span class="token punctuation">,</span>      <span class="token string">"flags"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>    <span class="token punctuation">{</span>    <span class="token string">"label"</span><span class="token punctuation">:</span><span class="token string">"780B"</span><span class="token punctuation">,</span>    <span class="token string">"points"</span><span class="token punctuation">:</span><span class="token punctuation">[</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>    <span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">"group_id"</span><span class="token punctuation">:</span> null<span class="token punctuation">,</span>      <span class="token string">"shape_type"</span><span class="token punctuation">:</span> <span class="token string">"polygon"</span><span class="token punctuation">,</span>      <span class="token string">"flags"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token punctuation">}</span>  <span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token string">"imagePath"</span><span class="token punctuation">:</span> <span class="token string">"IMG_20211021_154043.jpg"</span><span class="token punctuation">,</span>  <span class="token string">"imageData"</span><span class="token punctuation">:</span> null<span class="token punctuation">,</span>  <span class="token string">"imageHeight"</span><span class="token punctuation">:</span> <span class="token number">4608</span><span class="token punctuation">,</span>  <span class="token string">"imageWidth"</span><span class="token punctuation">:</span> <span class="token number">3456</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>labelmeæ–‡ä»¶æ˜¯æ¯ä¸€ä¸ªå›¾ç‰‡éƒ½æœ‰è‡ªå·±çš„jsonæ–‡ä»¶è´Ÿè´£å­˜å‚¨å„ä¸ªå›¾ç‰‡ã€‚</p><p>å¦å¤–è¿™é‡Œä»‹ç»ä¸€ä¸‹COCOæ•°æ®é›†ä¸­çš„segmentationç±»å‹çš„labelæ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Œå®é™…ä¸Šå°±æ˜¯ç±»ä¼¼äºå¤šè¾¹å½¢çš„æ¯ä¸€ä¸ªé¡¶ç‚¹è¿™ä¸ªæ ·å¼ï¼Œè¿™å¯¹æˆ‘ä»¬ç›®å‰çš„æ•°æ®é›†éå¸¸æ–¹ä¾¿ï¼Œå› ä¸ºæˆ‘ä»¬ç›®å‰æ•°æ®é›†å¹¶æ²¡æœ‰æ ‡æ³¨æ¯ä¸€ä¸ªç‰©ä½“çš„åˆ†å‰²æ•°æ®é›†ï¼Œä½†æ˜¯æˆ‘ä»¬çš„ç›®æ ‡æœ¬èº«å°±æ˜¯çŸ©å½¢æ¡†ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥ç”¨æ£€æµ‹çš„labelå°±å¯ä»¥ç›´æ¥è½¬åŒ–ä¸ºCOCOæ ¼å¼çš„åˆ†å‰²çš„labelã€‚å› ä¸ºéƒ½æ˜¯åªæœ‰4ä¸ªç‚¹å°±å¯ä»¥ã€‚</p><h2 id="è½¬æ¢æºç åˆå§‹ç‰ˆ"><a href="#è½¬æ¢æºç åˆå§‹ç‰ˆ" class="headerlink" title="è½¬æ¢æºç åˆå§‹ç‰ˆ"></a>è½¬æ¢æºç åˆå§‹ç‰ˆ</h2><p>ç›®å‰æ‰“ç®—è½¬æ¢çš„æºç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token triple-quoted-string string">"""æœ¬æ¨¡å—ç”¨äºæ‰¹é‡è½¬æ¢labelmeæ ‡è®°çš„æ ¼å¼ï¼Œä½¿ä¹‹å˜æˆcocoæ•°æ®é›†æ ¼å¼"""</span><span class="token comment" spellcheck="true"># -*- coding:utf-8 -*-</span><span class="token comment" spellcheck="true"># !/usr/bin/env python</span><span class="token keyword">import</span> argparse<span class="token keyword">import</span> json<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">import</span> skimage<span class="token punctuation">.</span>io <span class="token keyword">as</span> io<span class="token keyword">import</span> cv2<span class="token keyword">from</span> labelme <span class="token keyword">import</span> utils<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> glob<span class="token keyword">import</span> PIL<span class="token punctuation">.</span>Image<span class="token keyword">class</span> <span class="token class-name">MyEncoder</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span>JSONEncoder<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">default</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> isinstance<span class="token punctuation">(</span>obj<span class="token punctuation">,</span> np<span class="token punctuation">.</span>integer<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> int<span class="token punctuation">(</span>obj<span class="token punctuation">)</span>        <span class="token keyword">elif</span> isinstance<span class="token punctuation">(</span>obj<span class="token punctuation">,</span> np<span class="token punctuation">.</span>floating<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> float<span class="token punctuation">(</span>obj<span class="token punctuation">)</span>        <span class="token keyword">elif</span> isinstance<span class="token punctuation">(</span>obj<span class="token punctuation">,</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> obj<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> super<span class="token punctuation">(</span>MyEncoder<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">labelme2coco</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> labelme_json<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> save_json_path<span class="token operator">=</span><span class="token string">'./tran.json'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">'''        labelme_json: æ‰€æœ‰labelmeçš„jsonæ–‡ä»¶è·¯å¾„ç»„æˆçš„åˆ—è¡¨        save_json_path: jsonä¿å­˜ä½ç½®        '''</span>        self<span class="token punctuation">.</span>labelme_json <span class="token operator">=</span> labelme_json        self<span class="token punctuation">.</span>save_json_path <span class="token operator">=</span> save_json_path        self<span class="token punctuation">.</span>images <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>categories <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>annotations <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># self.data_coco = {}</span>        self<span class="token punctuation">.</span>label <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>annID <span class="token operator">=</span> <span class="token number">1</span>        self<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">0</span>        self<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">0</span>        self<span class="token punctuation">.</span>save_json<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">data_transfer</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> num<span class="token punctuation">,</span> json_file <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>self<span class="token punctuation">.</span>labelme_json<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"num:"</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>num <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'    '</span> <span class="token operator">+</span> json_file<span class="token punctuation">)</span>            <span class="token keyword">with</span> open<span class="token punctuation">(</span>json_file<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>                data <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>fp<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># åŠ è½½jsonæ–‡ä»¶</span>                self<span class="token punctuation">.</span>images<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>image<span class="token punctuation">(</span>data<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">for</span> shapes <span class="token keyword">in</span> data<span class="token punctuation">[</span><span class="token string">'shapes'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                    label <span class="token operator">=</span> shapes<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span>                    <span class="token keyword">if</span> label <span class="token operator">not</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>label<span class="token punctuation">:</span>                        self<span class="token punctuation">.</span>categories<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>categorie<span class="token punctuation">(</span>label<span class="token punctuation">)</span><span class="token punctuation">)</span>                        self<span class="token punctuation">.</span>label<span class="token punctuation">.</span>append<span class="token punctuation">(</span>label<span class="token punctuation">)</span>                    points <span class="token operator">=</span> shapes<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># è¿™é‡Œçš„pointæ˜¯ç”¨rectangleæ ‡æ³¨å¾—åˆ°çš„ï¼Œåªæœ‰ä¸¤ä¸ªç‚¹ï¼Œéœ€è¦è½¬æˆå››ä¸ªç‚¹</span>                    <span class="token comment" spellcheck="true">#points.append([points[0][0], points[1][1]])</span>                    <span class="token comment" spellcheck="true">#points.append([points[1][0], points[0][1]])</span>                    self<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>annotation<span class="token punctuation">(</span>points<span class="token punctuation">,</span> label<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">)</span>                    self<span class="token punctuation">.</span>annID <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token keyword">def</span> <span class="token function">image</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">:</span>        image <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        img <span class="token operator">=</span> utils<span class="token punctuation">.</span>img_b64_to_arr<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'imageData'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># è§£æåŸå›¾ç‰‡æ•°æ®</span>        <span class="token comment" spellcheck="true"># img=io.imread(data['imagePath']) # é€šè¿‡å›¾ç‰‡è·¯å¾„æ‰“å¼€å›¾ç‰‡</span>        <span class="token comment" spellcheck="true"># img = cv2.imread(data['imagePath'], 0)</span>        height<span class="token punctuation">,</span> width <span class="token operator">=</span> img<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>        img <span class="token operator">=</span> None        image<span class="token punctuation">[</span><span class="token string">'height'</span><span class="token punctuation">]</span> <span class="token operator">=</span> height        image<span class="token punctuation">[</span><span class="token string">'width'</span><span class="token punctuation">]</span> <span class="token operator">=</span> width        image<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> num <span class="token operator">+</span> <span class="token number">1</span>        <span class="token comment" spellcheck="true">#image['file_name'] = data['imagePath'].split("\\")[-1] #æ­¤è¡Œä¸é€‚åˆæˆ‘çš„æ•°æ®é›†</span>        image<span class="token punctuation">[</span><span class="token string">'file_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'imagePath'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\\"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>height <span class="token operator">=</span> height        self<span class="token punctuation">.</span>width <span class="token operator">=</span> width        <span class="token keyword">return</span> image    <span class="token keyword">def</span> <span class="token function">categorie</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> label<span class="token punctuation">)</span><span class="token punctuation">:</span>        categorie <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        categorie<span class="token punctuation">[</span><span class="token string">'supercategory'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Cancer'</span>        categorie<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> len<span class="token punctuation">(</span>self<span class="token punctuation">.</span>label<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>  <span class="token comment" spellcheck="true"># 0 é»˜è®¤ä¸ºèƒŒæ™¯</span>        categorie<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> label        <span class="token keyword">return</span> categorie    <span class="token keyword">def</span> <span class="token function">annotation</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> points<span class="token punctuation">,</span> label<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">:</span>        annotation <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        annotation<span class="token punctuation">[</span><span class="token string">'segmentation'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>list<span class="token punctuation">(</span>np<span class="token punctuation">.</span>asarray<span class="token punctuation">(</span>points<span class="token punctuation">)</span><span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>        annotation<span class="token punctuation">[</span><span class="token string">'iscrowd'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>        annotation<span class="token punctuation">[</span><span class="token string">'image_id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> num <span class="token operator">+</span> <span class="token number">1</span>        <span class="token comment" spellcheck="true"># annotation['bbox'] = str(self.getbbox(points)) # ä½¿ç”¨listä¿å­˜jsonæ–‡ä»¶æ—¶æŠ¥é”™ï¼ˆä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼‰</span>        <span class="token comment" spellcheck="true"># list(map(int,a[1:-1].split(','))) a=annotation['bbox'] ä½¿ç”¨è¯¥æ–¹å¼è½¬æˆlist</span>        annotation<span class="token punctuation">[</span><span class="token string">'bbox'</span><span class="token punctuation">]</span> <span class="token operator">=</span> list<span class="token punctuation">(</span>map<span class="token punctuation">(</span>float<span class="token punctuation">,</span> self<span class="token punctuation">.</span>getbbox<span class="token punctuation">(</span>points<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        annotation<span class="token punctuation">[</span><span class="token string">'area'</span><span class="token punctuation">]</span> <span class="token operator">=</span> annotation<span class="token punctuation">[</span><span class="token string">'bbox'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> annotation<span class="token punctuation">[</span><span class="token string">'bbox'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># annotation['category_id'] = self.getcatid(label)</span>        annotation<span class="token punctuation">[</span><span class="token string">'category_id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>getcatid<span class="token punctuation">(</span>label<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># æ³¨æ„ï¼Œæºä»£ç é»˜è®¤ä¸º1</span>        annotation<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>annID        <span class="token keyword">return</span> annotation    <span class="token keyword">def</span> <span class="token function">getcatid</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> label<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> categorie <span class="token keyword">in</span> self<span class="token punctuation">.</span>categories<span class="token punctuation">:</span>            <span class="token keyword">if</span> label <span class="token operator">==</span> categorie<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                <span class="token keyword">return</span> categorie<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span>        <span class="token keyword">return</span> <span class="token number">1</span>    <span class="token keyword">def</span> <span class="token function">getbbox</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> points<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># img = np.zeros([self.height,self.width],np.uint8)</span>        <span class="token comment" spellcheck="true"># cv2.polylines(img, [np.asarray(points)], True, 1, lineType=cv2.LINE_AA)  # ç”»è¾¹ç•Œçº¿</span>        <span class="token comment" spellcheck="true"># cv2.fillPoly(img, [np.asarray(points)], 1)  # ç”»å¤šè¾¹å½¢ å†…éƒ¨åƒç´ å€¼ä¸º1</span>        polygons <span class="token operator">=</span> points        mask <span class="token operator">=</span> self<span class="token punctuation">.</span>polygons_to_mask<span class="token punctuation">(</span><span class="token punctuation">[</span>self<span class="token punctuation">.</span>height<span class="token punctuation">,</span> self<span class="token punctuation">.</span>width<span class="token punctuation">]</span><span class="token punctuation">,</span> polygons<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#print(polygons)</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>mask2box<span class="token punctuation">(</span>mask<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">mask2box</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> mask<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">'''ä»maskåç®—å‡ºå…¶è¾¹æ¡†        maskï¼š[h,w]  0ã€1ç»„æˆçš„å›¾ç‰‡        1å¯¹åº”å¯¹è±¡ï¼Œåªéœ€è®¡ç®—1å¯¹åº”çš„è¡Œåˆ—å·ï¼ˆå·¦ä¸Šè§’è¡Œåˆ—å·ï¼Œå³ä¸‹è§’è¡Œåˆ—å·ï¼Œå°±å¯ä»¥ç®—å‡ºå…¶è¾¹æ¡†ï¼‰        '''</span>        <span class="token comment" spellcheck="true"># np.where(mask==1)</span>        index <span class="token operator">=</span> np<span class="token punctuation">.</span>argwhere<span class="token punctuation">(</span>mask <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#print(index)</span>        rows <span class="token operator">=</span> index<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>        clos <span class="token operator">=</span> index<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># è§£æå·¦ä¸Šè§’è¡Œåˆ—å·</span>        <span class="token comment" spellcheck="true">#print(rows)</span>        left_top_r <span class="token operator">=</span> np<span class="token punctuation">.</span>min<span class="token punctuation">(</span>rows<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># y</span>        left_top_c <span class="token operator">=</span> np<span class="token punctuation">.</span>min<span class="token punctuation">(</span>clos<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># x</span>        <span class="token comment" spellcheck="true"># è§£æå³ä¸‹è§’è¡Œåˆ—å·</span>        right_bottom_r <span class="token operator">=</span> np<span class="token punctuation">.</span>max<span class="token punctuation">(</span>rows<span class="token punctuation">)</span>        right_bottom_c <span class="token operator">=</span> np<span class="token punctuation">.</span>max<span class="token punctuation">(</span>clos<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># return [(left_top_r,left_top_c),(right_bottom_r,right_bottom_c)]</span>        <span class="token comment" spellcheck="true"># return [(left_top_c, left_top_r), (right_bottom_c, right_bottom_r)]</span>        <span class="token comment" spellcheck="true"># return [left_top_c, left_top_r, right_bottom_c, right_bottom_r]  # [x1,y1,x2,y2]</span>        <span class="token keyword">return</span> <span class="token punctuation">[</span>left_top_c<span class="token punctuation">,</span> left_top_r<span class="token punctuation">,</span> right_bottom_c <span class="token operator">-</span> left_top_c<span class="token punctuation">,</span>                right_bottom_r <span class="token operator">-</span> left_top_r<span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># [x1,y1,w,h] å¯¹åº”COCOçš„bboxæ ¼å¼</span>    <span class="token keyword">def</span> <span class="token function">polygons_to_mask</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> img_shape<span class="token punctuation">,</span> polygons<span class="token punctuation">)</span><span class="token punctuation">:</span>        mask <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>img_shape<span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>        mask <span class="token operator">=</span> PIL<span class="token punctuation">.</span>Image<span class="token punctuation">.</span>fromarray<span class="token punctuation">(</span>mask<span class="token punctuation">)</span>        xy <span class="token operator">=</span> list<span class="token punctuation">(</span>map<span class="token punctuation">(</span>tuple<span class="token punctuation">,</span> polygons<span class="token punctuation">)</span><span class="token punctuation">)</span>        PIL<span class="token punctuation">.</span>ImageDraw<span class="token punctuation">.</span>Draw<span class="token punctuation">(</span>mask<span class="token punctuation">)</span><span class="token punctuation">.</span>polygon<span class="token punctuation">(</span>xy<span class="token operator">=</span>xy<span class="token punctuation">,</span> outline<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> fill<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>        mask <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>mask<span class="token punctuation">,</span> dtype<span class="token operator">=</span>bool<span class="token punctuation">)</span>        <span class="token keyword">return</span> mask    <span class="token keyword">def</span> <span class="token function">data2coco</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        data_coco <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        data_coco<span class="token punctuation">[</span><span class="token string">'images'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>images        data_coco<span class="token punctuation">[</span><span class="token string">'categories'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>categories        data_coco<span class="token punctuation">[</span><span class="token string">'annotations'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>annotations        <span class="token keyword">return</span> data_coco    <span class="token keyword">def</span> <span class="token function">save_json</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>data_transfer<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>data_coco <span class="token operator">=</span> self<span class="token punctuation">.</span>data2coco<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># ä¿å­˜jsonæ–‡ä»¶</span>        json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>self<span class="token punctuation">.</span>data_coco<span class="token punctuation">,</span> open<span class="token punctuation">(</span>self<span class="token punctuation">.</span>save_json_path<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> indent<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> cls<span class="token operator">=</span>MyEncoder<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># indent=4 æ›´åŠ ç¾è§‚æ˜¾ç¤º</span>labelme_json <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">'H:/camellia/Aug/è®­ç»ƒ/val_json/*.json'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>labelme_json<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># labelme_json=['./Annotations/*.json']</span><span class="token comment" spellcheck="true"># labelme_json=glob.glob('./Annotations/*.json')</span>saveme_json <span class="token operator">=</span> <span class="token string">'H:/camellia/Aug/è®­ç»ƒ/annotations/val.json'</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Start."</span><span class="token punctuation">)</span>labelme2coco<span class="token punctuation">(</span>labelme_json<span class="token punctuation">,</span> saveme_json<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Finished."</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ä»£ç è¯¦è§£"><a href="#ä»£ç è¯¦è§£" class="headerlink" title="ä»£ç è¯¦è§£"></a>ä»£ç è¯¦è§£</h2><p>æŒ‰ç…§è¿è¡Œé¡ºåºæ¥è§£é‡Šä»£ç ï¼š</p><h3 id="main"><a href="#main" class="headerlink" title="main()"></a>main()</h3><p>å…³äºä»¥ä¸Šä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è¿è¡Œçš„é¡ºåºæ¥å®šä¹‰ï¼Œé¦–å…ˆæ˜¯globäº†æ‰€æœ‰.jsonå‰ç¼€çš„æ–‡ä»¶ï¼Œå› ä¸ºæˆ‘ä»¬labelmeçš„æ–‡ä»¶éƒ½æ˜¯ä¸€ä¸ªå›¾ç‰‡ä¸“é—¨ç”Ÿæˆä¸€ä¸ª.jsonæ–‡ä»¶ï¼Œè€Œæˆ‘ä»¬çš„COCOæ•°æ®é›†æ ¼å¼æ˜¯æ‰€æœ‰çš„å›¾ç‰‡çš„ä¿¡æ¯éƒ½æ”¾åˆ°äº†ä¸€ä¸ª.jsonå›¾ç‰‡ä¸­ï¼Œæ¥ç€æˆ‘ä»¬å®šä¹‰ä¿å­˜åˆ°çš„jsonæ–‡ä»¶ï¼Œç„¶åç›´æ¥è°ƒç”¨ç±»labelme2coco,ç„¶åç›´æ¥å¾—åˆ°çš„ç»“æœã€‚</p><h3 id="labelme2coco"><a href="#labelme2coco" class="headerlink" title="labelme2coco"></a>labelme2coco</h3><p>labelme2cocoæ˜¯æ•´ä¸ªæ–‡ä»¶çš„å…³é”®ã€‚</p><h3 id="init"><a href="#init" class="headerlink" title="__init__"></a><code>__init__</code></h3><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">labelme2coco</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> labelme_json<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> save_json_path<span class="token operator">=</span><span class="token string">'./tran.json'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># è¿™é‡Œå®šä¹‰äº†é»˜è®¤çš„å­˜å‚¨è·¯å¾„</span>        <span class="token triple-quoted-string string">'''        labelme_json: æ‰€æœ‰labelmeçš„jsonæ–‡ä»¶è·¯å¾„ç»„æˆçš„åˆ—è¡¨        save_json_path: jsonä¿å­˜ä½ç½®        '''</span>        self<span class="token punctuation">.</span>labelme_json <span class="token operator">=</span> labelme_json     <span class="token comment" spellcheck="true"># labelme_jsonçš„æ–‡ä»¶è·¯å¾„ï¼Œæ˜¯ä¸€ä¸ªåˆ—è¡¨å­˜å‚¨ç€æ‰€æœ‰çš„å¾…è½¬åŒ–jsonæ–‡ä»¶è·¯å¾„</span>        self<span class="token punctuation">.</span>save_json_path <span class="token operator">=</span> save_json_path  <span class="token comment" spellcheck="true"># ä¿å­˜çš„è·¯å¾„</span>        self<span class="token punctuation">.</span>images <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># å¯¹åº”ç”ŸæˆCOCOå½¢å¼jsonæ–‡ä»¶çš„imageçš„ç±»å‹ã€‚</span>        self<span class="token punctuation">.</span>categories <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># åŒä¸Š</span>        self<span class="token punctuation">.</span>annotations <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># åŒä¸Š</span>        <span class="token comment" spellcheck="true"># self.data_coco = {}</span>        self<span class="token punctuation">.</span>label <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>annID <span class="token operator">=</span> <span class="token number">1</span>        self<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">0</span>        self<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">0</span>        self<span class="token punctuation">.</span>save_json<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># æ³¨æ„è¿™é‡Œä¸€è°ƒç”¨è¯¥ç±»å°±ç›´æ¥è¿è¡Œç›¸å…³çš„æ‰€æœ‰ä»£ç äº†ï¼Œè¿™ä¸ªæŠ€å·§å¾ˆæœ‰ç”¨ã€‚</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬æ¥ä¸‹æ¥åº”è¯¥çœ‹<code>save_json()</code>ï¼š</p><h3 id="save-json"><a href="#save-json" class="headerlink" title="save_json()"></a>save_json()</h3><pre class="line-numbers language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">save_json</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>data_transfer<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>data_coco <span class="token operator">=</span> self<span class="token punctuation">.</span>data2coco<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># ä¿å­˜jsonæ–‡ä»¶</span>        json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>self<span class="token punctuation">.</span>data_coco<span class="token punctuation">,</span> open<span class="token punctuation">(</span>self<span class="token punctuation">.</span>save_json_path<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> indent<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> cls<span class="token operator">=</span>MyEncoder<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># indent=4 æ›´åŠ ç¾è§‚æ˜¾ç¤º</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªå¯ä»¥çœ‹åˆ°å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªè°ƒç”¨çš„ç±»å†…çš„å‡½æ•°æ¥æ€»ä½“è°ƒç”¨ã€‚æˆ‘ä»¬ç»§ç»­æ¥çœ‹data_transfer()</p><h3 id="data-transfer"><a href="#data-transfer" class="headerlink" title="data_transfer()"></a>data_transfer()</h3><pre class="line-numbers language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">data_transfer</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> num<span class="token punctuation">,</span> json_file <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>self<span class="token punctuation">.</span>labelme_json<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"num:"</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>num <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'    '</span> <span class="token operator">+</span> json_file<span class="token punctuation">)</span>            <span class="token keyword">with</span> open<span class="token punctuation">(</span>json_file<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>                data <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>fp<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># åŠ è½½jsonæ–‡ä»¶</span>                self<span class="token punctuation">.</span>images<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>image<span class="token punctuation">(</span>data<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># æ³¨æ„è¿™ä¸ªimageæ˜¯ä¸ªå‡½æ•°ï¼ å°†è¯¥å›¾ç‰‡çš„æ‰€æœ‰ç›¸åº”çš„ä¿¡æ¯è½¬åŒ–ä¸ºCOCOçš„imageæ ¼å¼</span>                <span class="token keyword">for</span> shapes <span class="token keyword">in</span> data<span class="token punctuation">[</span><span class="token string">'shapes'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>   <span class="token comment" spellcheck="true"># shapesæ˜¯ä¸»è¦çš„æ ‡æ³¨ä¿¡æ¯ï¼Œæˆ‘ä»¬é‡ç‚¹å°±æ˜¯è¯»å–è¿™ä¸ªï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰å¿…è¦è¯»å–æ‰€æœ‰ï¼Œå¯èƒ½åªéœ€è¦è¯»å–ç¬¬ä¸€ä¸ª780bå°±å¯ä»¥</span>                    label <span class="token operator">=</span> shapes<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># æ³¨æ„è¿™é‡Œæ˜¯ä¸€ä¸ªå¾ªç¯ï¼Œè¿™ä¸ªå¾ªç¯å°†æ‰€æœ‰çš„labelæœ‰å…³æ–‡ä»¶éƒ½å¾ªç¯äº†ä¸€é</span>                    <span class="token keyword">if</span> label <span class="token operator">not</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>label<span class="token punctuation">:</span>                        self<span class="token punctuation">.</span>categories<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>categorie<span class="token punctuation">(</span>label<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># æ³¨æ„è¿™ä¸ªself.categorieä¹Ÿæ˜¯ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªä»£ç æ®µå°±æ˜¯è¦ç”ŸæˆCOCOçš„categoriesæ ¼å¼</span>                        self<span class="token punctuation">.</span>label<span class="token punctuation">.</span>append<span class="token punctuation">(</span>label<span class="token punctuation">)</span>                    points <span class="token operator">=</span> shapes<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># è¿™é‡Œçš„pointæ˜¯ç”¨rectangleæ ‡æ³¨å¾—åˆ°çš„ï¼Œåªæœ‰ä¸¤ä¸ªç‚¹ï¼Œéœ€è¦è½¬æˆå››ä¸ªç‚¹</span>                    <span class="token comment" spellcheck="true">#points.append([points[0][0], points[1][1]])</span>                    <span class="token comment" spellcheck="true">#points.append([points[1][0], points[0][1]])</span>                    self<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>annotation<span class="token punctuation">(</span>points<span class="token punctuation">,</span> label<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># åŒæ ·çš„ï¼Œself.annotationä¹Ÿæ˜¯ä¸€ä¸ªç›¸åº”çš„å‡½æ•°è¦å°†æ‰€ç»™çš„pointsæ–‡ä»¶è½¬åŒ–ä¸ºannotationå’Œsegmentationæ–‡ä»¶</span>                    self<span class="token punctuation">.</span>annID <span class="token operator">+=</span> <span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œä¸€æ­¥ä¸€æ­¥è¯´ï¼Œé¦–å…ˆå°±æ˜¯è¦å°†æ‰€æœ‰çš„jsonæ–‡ä»¶å¾ªç¯éå†ä¸€éï¼Œä¹‹åæ‰“å¼€æ¯ä¸ªæ–‡ä»¶ï¼Œé¦–å…ˆåŠ è½½æ–‡ä»¶ï¼Œä¹‹åè°ƒç”¨ç±»ä¸­å®šä¹‰å¥½çš„self.image()å‡½æ•°,è¿™ä¸ªå‡½æ•°å°†è¯¥å›¾ç‰‡æ‰€æœ‰ç›¸åº”çš„ä¿¡æ¯è½¬åŒ–æˆCOCOçš„imageçš„æ ¼å¼ç„¶åè¿”å›COCOæ ¼å¼çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬å°†è¿™ä¸ªä¿¡æ¯åŠ åˆ°self.imagesä¸­å»ã€‚æˆ‘ä»¬å…ˆè§£æä¸€ä¸‹ç›¸å…³çš„self.image()å‡½æ•°ã€‚</p><h3 id="image"><a href="#image" class="headerlink" title="image()"></a>image()</h3><p>å®é™…ä¸Šimage()éœ€è¦çš„ä¿¡æ¯ä¹Ÿå°±æ˜¯ä¸€ä¸ªå›¾ç‰‡çš„é«˜å®½ã€å°†å›¾ç‰‡æ•´ç†æˆç¼–å·ï¼Œå›¾ç‰‡åã€‚</p><pre class="line-numbers language-python"><code class="language-python">image <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">"id"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"width"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"height"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"file_name"</span><span class="token punctuation">:</span> str<span class="token punctuation">,</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>imageå‡½æ•°å®é™…ä¸Šå°±æ˜¯è¯»å–äº†ä»¥ä¸Šçš„æä¾›çš„ä¿¡æ¯ç„¶åè½¬åŒ–è¿‡å»ï¼š</p><pre class="line-numbers language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">image</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">:</span>        image <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        img <span class="token operator">=</span> utils<span class="token punctuation">.</span>img_b64_to_arr<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'imageData'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># è§£æåŸå›¾ç‰‡æ•°æ®ï¼Œæ³¨æ„æˆ‘ä»¬å¹¶ä¸æ˜¯æ‰€æœ‰æ–‡ä»¶éƒ½æœ‰,æ€ªä¸å¾—æ‰€æœ‰æ–‡ä»¶éƒ½æ‰“å¼€è¿è¡Œä¼šæŠ¥é”™ï¼ŒçœŸæ˜¯å¥½å¥‡æ€ªï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡æ–‡ä»¶è·¯å¾„æ‰“å¼€ï¼Œå‚è§ä¸‹ä¸€è¡Œä»£ç </span>        <span class="token comment" spellcheck="true"># img=io.imread(os.path.join(root, data['imagePath'])) # é€šè¿‡å›¾ç‰‡è·¯å¾„æ‰“å¼€å›¾ç‰‡ï¼Œ ä¸è¿‡è¿™ä¸ªå°±éœ€è¦è®¾ä¸€ä¸ªå…¨å±€çš„root</span>        <span class="token comment" spellcheck="true"># img = cv2.imread(data['imagePath'], 0)</span>        height<span class="token punctuation">,</span> width <span class="token operator">=</span> img<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>        img <span class="token operator">=</span> None        image<span class="token punctuation">[</span><span class="token string">'height'</span><span class="token punctuation">]</span> <span class="token operator">=</span> height        image<span class="token punctuation">[</span><span class="token string">'width'</span><span class="token punctuation">]</span> <span class="token operator">=</span> width        image<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> num <span class="token operator">+</span> <span class="token number">1</span>        <span class="token comment" spellcheck="true">#image['file_name'] = data['imagePath'].split("\\")[-1] #æ­¤è¡Œä¸é€‚åˆæˆ‘çš„æ•°æ®é›†</span>        image<span class="token punctuation">[</span><span class="token string">'file_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'imagePath'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\\"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>height <span class="token operator">=</span> height        self<span class="token punctuation">.</span>width <span class="token operator">=</span> width        <span class="token keyword">return</span> image<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„åˆ°æˆ‘ä»¬æœ€ç»ˆè¿”å›çš„æ˜¯ä¸€ä¸ªå­—å…¸ã€‚<br>è¿™é‡Œæˆ‘ä»¬å‘ç°ç”¨åˆ°äº†ä¸€ä¸ªå‡½æ•°utils.img_b64_to_arr()ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯ç”¨æ¥å°†æˆ‘ä»¬çš„å›¾ç‰‡è¯»å–æˆcv2çš„imgæ ¼å¼çŸ©é˜µï¼Œè¿™ä¸ªutilså®é™…ä¸Šæ˜¯labelmeè¿™ä¸ªåº“ä¸­çš„ä¸€ä¸ªæ¨¡å—ã€‚ç›®å‰æˆ‘çš„ç†è§£æ˜¯ï¼Œlabelmeç”Ÿæˆçš„.jsonæ–‡ä»¶é‡Œé¢çš„imageDataæ˜¯ä¸€å †æˆ‘çœ‹ä¸æ‡‚çš„ç¼–ç ï¼Œè¿™äº›ç¼–ç å®é™…ä¸Šå­˜å‚¨çš„å°±æ˜¯å›¾ç‰‡çš„ä¿¡æ¯ï¼Œç„¶åæˆ‘ä»¬é€šè¿‡<code>img_b64_to_arr()</code>å‡½æ•°æ¥â€œç¿»è¯‘â€ä¸ºæˆ‘ä»¬èƒ½çœ‹æ‡‚çš„å›¾ç‰‡RGBçŸ©é˜µå½¢å¼å­˜å‚¨ã€‚<br>å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„æ³¨é‡Šä¹Ÿç»™å‡ºäº†ä¸€äº›å…¶ä»–æ–¹å¼çš„æ‰“å¼€å›¾ç‰‡å½¢å¼ï¼Œæœ‰ç”¨cv2è¯»å–ï¼Œæœ‰ç”¨skimage.ioè¯»å–çš„ï¼Œå› ä¸ºæœ‰å¯èƒ½æˆ‘ä»¬data[â€˜imageDataâ€™]çš„å€¼ä¸ºnull(<del>æˆ‘ç›®å‰é¡¹ç›®çš„æ•°æ®é›†å°±æ˜¯è¿™æ ·</del>)ã€‚å…¶ä»–çš„æ ¼å¼éƒ½æ˜¯å¾ˆç®€å•çš„å¤åˆ¶äº†ï¼Œç›¸å¯¹è€Œè¨€ä¸ç”¨å¤šè¯´ã€‚</p><h3 id="data-transfer-1"><a href="#data-transfer-1" class="headerlink" title="data_transfer()"></a>data_transfer()</h3><p>å¥½äº†æˆ‘ä»¬æ¥ä¸‹æ¥ç»§ç»­è¯´æˆ‘ä»¬çš„data_transfer()å‡½æ•°ã€‚æ¥ä¸‹æ¥æ˜¯å¯¹data[â€˜shapesâ€™]æ‰€æœ‰æ–‡ä»¶è¿›è¡Œä¸€ä¸ªéå†ï¼Œshapesæ˜¯ä¸»è¦çš„æ ‡æ³¨ä¿¡æ¯ï¼Œæˆ‘ä»¬é‡ç‚¹å°±æ˜¯è¯»å–è¿™ä¸ªï¼Œshapesé‡Œé¢åŒ…å«ç€æ‰€æœ‰çš„æ ‡æ³¨æ¡†ground truthä¿¡æ¯ï¼Œå½“ç„¶æˆ‘ä»¬è¿™é‡Œå› ä¸ºä»…ä»…å¯¹ä¸€ä¸ªå¤§æ¡†åšåˆ†å‰²æ‰€ä»¥åªéœ€è¦ä¸€ä¸ª780Bçš„labelå°±å¯ä»¥ï¼Œè¿™é‡Œå®ƒå°†æ‰€æœ‰éƒ½éå†äº†ä¸€éï¼Œç„¶åè°ƒç”¨äº†self.categorieå‡½æ•°æ¥è®©æˆ‘ä»¬çš„labelé‡Œé¢çš„ä¿¡æ¯è½¬åŒ–ä¸ºCOCOæ ¼å¼çš„ã€‚å®é™…ä¸Šå°±æ˜¯å˜ä¸ºCOCOæ ¼å¼jsonæ–‡ä»¶ä¸­é‚£ä¸ªcategoriesç±»å‹ï¼Œæˆ‘ä»¬ç»§ç»­æ¥çœ‹self.categorie()</p><h3 id="categorie"><a href="#categorie" class="headerlink" title="categorie()"></a>categorie()</h3><pre class="line-numbers language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">categorie</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> label<span class="token punctuation">)</span><span class="token punctuation">:</span>        categorie <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        categorie<span class="token punctuation">[</span><span class="token string">'supercategory'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Cancer'</span>        categorie<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> len<span class="token punctuation">(</span>self<span class="token punctuation">.</span>label<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>  <span class="token comment" spellcheck="true"># 0 é»˜è®¤ä¸ºèƒŒæ™¯</span>        categorie<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> label        <span class="token keyword">return</span> categorie<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®é™…ä¸Šéå¸¸ç®€å•ï¼Œå› ä¸ºCOCOé‡Œé¢çš„categoriesåªéœ€è¦çŸ¥é“æ•´ä¸ªæ•°æ®é›†æœ‰å“ªäº›ç±»ï¼Œæ¯ä¸ªç±»éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„idå°±OKäº†ã€‚</p><h3 id="data-transfer-2"><a href="#data-transfer-2" class="headerlink" title="data_transfer()"></a>data_transfer()</h3><p>å®é™…ä¸Šåé¢éƒ½æ˜¯ç±»ä¼¼çš„ï¼Œå¯¹åº”çš„åŠŸèƒ½è°ƒç”¨ç›¸åº”çš„å‡½æ•°å°±OKã€‚è¿™é‡Œä¸è¯¦ç»†è°ˆäº†ï¼Œæ²¡æœ‰å¿…è¦è¯¦ç»†è§£é‡Šã€‚</p><h3 id="data2coco"><a href="#data2coco" class="headerlink" title="data2coco()"></a>data2coco()</h3><p>éšåæˆ‘ä»¬çœ‹åˆ°è¿™é‡Œè°ƒç”¨äº†ç›¸å…³çš„å‡½æ•°è½¬åŒ–ä¸ºjsonæ–‡ä»¶éœ€è¦çš„å­—å…¸æ ¼å¼ï¼š</p><pre class="line-numbers language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">data2coco</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        data_coco <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        data_coco<span class="token punctuation">[</span><span class="token string">'images'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>images        data_coco<span class="token punctuation">[</span><span class="token string">'categories'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>categories        data_coco<span class="token punctuation">[</span><span class="token string">'annotations'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>annotations        <span class="token keyword">return</span> data_coco<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€åè¿›è¡Œä¸€ä¸‹json.dumpå°±æˆåŠŸä¿å­˜å¥½jsonæ–‡ä»¶äº†ã€‚</p><h2 id="è½¬åŒ–ä»£ç æœ€ç»ˆæ”¹è‰¯ç‰ˆ"><a href="#è½¬åŒ–ä»£ç æœ€ç»ˆæ”¹è‰¯ç‰ˆ" class="headerlink" title="è½¬åŒ–ä»£ç æœ€ç»ˆæ”¹è‰¯ç‰ˆ"></a>è½¬åŒ–ä»£ç æœ€ç»ˆæ”¹è‰¯ç‰ˆ</h2><p>ç»è¿‡ä¸Šè¿°æè¿°ï¼Œæœ€ç»ˆåšä¸€ä¸ªæ”¹è‰¯ï¼Œå¾—åˆ°ç›¸åº”çš„ç»“æœï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token triple-quoted-string string">"""æœ¬æ¨¡å—ç”¨äºæ‰¹é‡è½¬æ¢labelmeæ ‡è®°çš„æ ¼å¼ï¼Œä½¿ä¹‹å˜æˆcocoæ•°æ®é›†æ ¼å¼"""</span><span class="token comment" spellcheck="true"># -*- coding:utf-8 -*-</span><span class="token comment" spellcheck="true"># !/usr/bin/env python</span><span class="token keyword">import</span> argparse<span class="token keyword">import</span> json<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">import</span> skimage<span class="token punctuation">.</span>io <span class="token keyword">as</span> io<span class="token keyword">import</span> cv2<span class="token keyword">from</span> labelme <span class="token keyword">import</span> utils<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> glob<span class="token keyword">import</span> PIL<span class="token punctuation">.</span>Image<span class="token keyword">import</span> os<span class="token keyword">class</span> <span class="token class-name">MyEncoder</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span>JSONEncoder<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">default</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> isinstance<span class="token punctuation">(</span>obj<span class="token punctuation">,</span> np<span class="token punctuation">.</span>integer<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> int<span class="token punctuation">(</span>obj<span class="token punctuation">)</span>        <span class="token keyword">elif</span> isinstance<span class="token punctuation">(</span>obj<span class="token punctuation">,</span> np<span class="token punctuation">.</span>floating<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> float<span class="token punctuation">(</span>obj<span class="token punctuation">)</span>        <span class="token keyword">elif</span> isinstance<span class="token punctuation">(</span>obj<span class="token punctuation">,</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> obj<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> super<span class="token punctuation">(</span>MyEncoder<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">labelme2coco</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> labelme_json<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> save_json_path<span class="token operator">=</span><span class="token string">'./tran.json'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># è¿™é‡Œå®šä¹‰äº†é»˜è®¤çš„å­˜å‚¨è·¯å¾„</span>        <span class="token triple-quoted-string string">'''        labelme_json: æ‰€æœ‰labelmeçš„jsonæ–‡ä»¶è·¯å¾„ç»„æˆçš„åˆ—è¡¨        save_json_path: jsonä¿å­˜ä½ç½®        '''</span>        self<span class="token punctuation">.</span>labelme_json <span class="token operator">=</span> labelme_json     <span class="token comment" spellcheck="true"># labelme_jsonçš„æ–‡ä»¶è·¯å¾„ï¼Œæ˜¯ä¸€ä¸ªåˆ—è¡¨å­˜å‚¨ç€æ‰€æœ‰çš„å¾…è½¬åŒ–jsonæ–‡ä»¶è·¯å¾„</span>        self<span class="token punctuation">.</span>save_json_path <span class="token operator">=</span> save_json_path  <span class="token comment" spellcheck="true"># ä¿å­˜çš„è·¯å¾„</span>        self<span class="token punctuation">.</span>images <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># å¯¹åº”ç”ŸæˆCOCOå½¢å¼jsonæ–‡ä»¶çš„imageçš„ç±»å‹ã€‚</span>        self<span class="token punctuation">.</span>categories <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># åŒä¸Š</span>        self<span class="token punctuation">.</span>annotations <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># åŒä¸Š</span>        <span class="token comment" spellcheck="true"># self.data_coco = {}</span>        self<span class="token punctuation">.</span>label <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>annID <span class="token operator">=</span> <span class="token number">1</span>        self<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">0</span>        self<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">0</span>        self<span class="token punctuation">.</span>root <span class="token operator">=</span> <span class="token string">'/home/lry/projects/mmdetection/data/780b/'</span>        self<span class="token punctuation">.</span>save_json<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># æ³¨æ„è¿™é‡Œä¸€è°ƒç”¨è¯¥ç±»å°±ç›´æ¥è¿è¡Œç›¸å…³çš„æ‰€æœ‰ä»£ç äº†ï¼Œè¿™ä¸ªæŠ€å·§å¾ˆæœ‰ç”¨ã€‚</span>    <span class="token keyword">def</span> <span class="token function">data_transfer</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> num<span class="token punctuation">,</span> json_file <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>self<span class="token punctuation">.</span>labelme_json<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"num:"</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>num <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'    '</span> <span class="token operator">+</span> json_file<span class="token punctuation">)</span>            <span class="token keyword">with</span> open<span class="token punctuation">(</span>json_file<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>                data <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>fp<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># åŠ è½½jsonæ–‡ä»¶</span>                <span class="token comment" spellcheck="true"># æ³¨æ„è¿™ä¸ªimageæ˜¯ä¸ªå‡½æ•°ï¼ å°†è¯¥å›¾ç‰‡çš„æ‰€æœ‰ç›¸åº”çš„ä¿¡æ¯è½¬åŒ–ä¸ºCOCOçš„imageæ ¼å¼</span>                self<span class="token punctuation">.</span>images<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>image<span class="token punctuation">(</span>data<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># shapesæ˜¯ä¸»è¦çš„æ ‡æ³¨ä¿¡æ¯ï¼Œæˆ‘ä»¬é‡ç‚¹å°±æ˜¯è¯»å–è¿™ä¸ªï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰å¿…è¦è¯»å–æ‰€æœ‰ï¼Œå¯èƒ½åªéœ€è¦è¯»å–ç¬¬ä¸€ä¸ª780bå°±å¯ä»¥</span>                <span class="token keyword">for</span> shapes <span class="token keyword">in</span> data<span class="token punctuation">[</span><span class="token string">'shapes'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                    <span class="token comment" spellcheck="true"># é¦–å…ˆæˆ‘ä»¬ä¼šåˆ¤æ–­æ˜¯å¦è¿™ä¸ªlabelæ˜¯å¦æ˜¯"780B"</span>                    <span class="token keyword">if</span> shapes<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"780B"</span><span class="token punctuation">:</span>                        <span class="token keyword">continue</span>                    <span class="token comment" spellcheck="true"># æ³¨æ„è¿™é‡Œæ˜¯ä¸€ä¸ªå¾ªç¯ï¼Œè¿™ä¸ªå¾ªç¯å°†æ‰€æœ‰çš„labelæœ‰å…³æ–‡ä»¶éƒ½å¾ªç¯äº†ä¸€é</span>                    label <span class="token operator">=</span> shapes<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span>                    <span class="token keyword">if</span> label <span class="token operator">not</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>label<span class="token punctuation">:</span>                        <span class="token comment" spellcheck="true"># æ³¨æ„è¿™ä¸ªself.categorieä¹Ÿæ˜¯ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªä»£ç æ®µå°±æ˜¯è¦ç”ŸæˆCOCOçš„categoriesæ ¼å¼</span>                        self<span class="token punctuation">.</span>categories<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>categorie<span class="token punctuation">(</span>label<span class="token punctuation">)</span><span class="token punctuation">)</span>                        self<span class="token punctuation">.</span>label<span class="token punctuation">.</span>append<span class="token punctuation">(</span>label<span class="token punctuation">)</span>                    <span class="token comment" spellcheck="true"># è¿™é‡Œçš„pointæ˜¯ç”¨rectangleæ ‡æ³¨å¾—åˆ°çš„ï¼Œåªæœ‰ä¸¤ä¸ªç‚¹ï¼Œéœ€è¦è½¬æˆå››ä¸ªç‚¹</span>                    points <span class="token operator">=</span> shapes<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span>                    <span class="token comment" spellcheck="true">#points.append([points[0][0], points[1][1]])</span>                    <span class="token comment" spellcheck="true">#points.append([points[1][0], points[0][1]])</span>                    <span class="token comment" spellcheck="true"># åŒæ ·çš„ï¼Œself.annotationä¹Ÿæ˜¯ä¸€ä¸ªç›¸åº”çš„å‡½æ•°è¦å°†æ‰€ç»™çš„pointsæ–‡ä»¶è½¬åŒ–ä¸ºannotationå’Œsegmentationæ–‡ä»¶</span>                    self<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span>append<span class="token punctuation">(</span>                        self<span class="token punctuation">.</span>annotation<span class="token punctuation">(</span>points<span class="token punctuation">,</span> label<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">)</span>                    self<span class="token punctuation">.</span>annID <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token keyword">def</span> <span class="token function">image</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">:</span>        image <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        <span class="token comment" spellcheck="true"># è§£æåŸå›¾ç‰‡æ•°æ®ï¼Œæ³¨æ„æˆ‘ä»¬å¹¶ä¸æ˜¯æ‰€æœ‰æ–‡ä»¶éƒ½æœ‰,æ€ªä¸å¾—æ‰€æœ‰æ–‡ä»¶éƒ½æ‰“å¼€è¿è¡Œä¼šæŠ¥é”™ï¼ŒçœŸæ˜¯å¥½å¥‡æ€ªï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡æ–‡ä»¶è·¯å¾„æ‰“å¼€ï¼Œå‚è§ä¸‹ä¸€è¡Œä»£ç </span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            img <span class="token operator">=</span> utils<span class="token punctuation">.</span>img_b64_to_arr<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'imageData'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            img<span class="token operator">=</span>io<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>self<span class="token punctuation">.</span>root<span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token string">'imagePath'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># é€šè¿‡å›¾ç‰‡è·¯å¾„æ‰“å¼€å›¾ç‰‡ï¼Œ ä¸è¿‡è¿™ä¸ªå°±éœ€è¦è®¾ä¸€ä¸ªå…¨å±€çš„root</span>        <span class="token comment" spellcheck="true"># img = cv2.imread(data['imagePath'], 0)</span>        height<span class="token punctuation">,</span> width <span class="token operator">=</span> img<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>        img <span class="token operator">=</span> None        image<span class="token punctuation">[</span><span class="token string">'height'</span><span class="token punctuation">]</span> <span class="token operator">=</span> height        image<span class="token punctuation">[</span><span class="token string">'width'</span><span class="token punctuation">]</span> <span class="token operator">=</span> width        image<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> num <span class="token operator">+</span> <span class="token number">1</span>        <span class="token comment" spellcheck="true"># image['file_name'] = data['imagePath'].split("\\")[-1] #æ­¤è¡Œä¸é€‚åˆæˆ‘çš„æ•°æ®é›†</span>        image<span class="token punctuation">[</span><span class="token string">'file_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'imagePath'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\\"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>height <span class="token operator">=</span> height        self<span class="token punctuation">.</span>width <span class="token operator">=</span> width        <span class="token keyword">return</span> image    <span class="token keyword">def</span> <span class="token function">categorie</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> label<span class="token punctuation">)</span><span class="token punctuation">:</span>        categorie <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        <span class="token comment" spellcheck="true"># categorie['supercategory'] = 'Cancer'  # è¿™ä¸ªæ— ç”¨</span>        categorie<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> len<span class="token punctuation">(</span>self<span class="token punctuation">.</span>label<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>  <span class="token comment" spellcheck="true"># 0 é»˜è®¤ä¸ºèƒŒæ™¯</span>        categorie<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> label        <span class="token keyword">return</span> categorie    <span class="token keyword">def</span> <span class="token function">annotation</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> points<span class="token punctuation">,</span> label<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">:</span>        annotation <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        annotation<span class="token punctuation">[</span><span class="token string">'segmentation'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>list<span class="token punctuation">(</span>np<span class="token punctuation">.</span>asarray<span class="token punctuation">(</span>points<span class="token punctuation">)</span><span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>        annotation<span class="token punctuation">[</span><span class="token string">'iscrowd'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>        annotation<span class="token punctuation">[</span><span class="token string">'image_id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> num <span class="token operator">+</span> <span class="token number">1</span>        <span class="token comment" spellcheck="true"># annotation['bbox'] = str(self.getbbox(points)) # ä½¿ç”¨listä¿å­˜jsonæ–‡ä»¶æ—¶æŠ¥é”™ï¼ˆä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼‰</span>        <span class="token comment" spellcheck="true"># list(map(int,a[1:-1].split(','))) a=annotation['bbox'] ä½¿ç”¨è¯¥æ–¹å¼è½¬æˆlist</span>        annotation<span class="token punctuation">[</span><span class="token string">'bbox'</span><span class="token punctuation">]</span> <span class="token operator">=</span> list<span class="token punctuation">(</span>map<span class="token punctuation">(</span>float<span class="token punctuation">,</span> self<span class="token punctuation">.</span>getbbox<span class="token punctuation">(</span>points<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        annotation<span class="token punctuation">[</span><span class="token string">'area'</span><span class="token punctuation">]</span> <span class="token operator">=</span> annotation<span class="token punctuation">[</span><span class="token string">'bbox'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> annotation<span class="token punctuation">[</span><span class="token string">'bbox'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># annotation['category_id'] = self.getcatid(label)</span>        annotation<span class="token punctuation">[</span><span class="token string">'category_id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>getcatid<span class="token punctuation">(</span>label<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># æ³¨æ„ï¼Œæºä»£ç é»˜è®¤ä¸º1</span>        annotation<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>annID        <span class="token keyword">return</span> annotation    <span class="token keyword">def</span> <span class="token function">getcatid</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> label<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> categorie <span class="token keyword">in</span> self<span class="token punctuation">.</span>categories<span class="token punctuation">:</span>            <span class="token keyword">if</span> label <span class="token operator">==</span> categorie<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                <span class="token keyword">return</span> categorie<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span>        <span class="token keyword">return</span> <span class="token number">1</span>    <span class="token keyword">def</span> <span class="token function">getbbox</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> points<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># img = np.zeros([self.height,self.width],np.uint8)</span>        <span class="token comment" spellcheck="true"># cv2.polylines(img, [np.asarray(points)], True, 1, lineType=cv2.LINE_AA)  # ç”»è¾¹ç•Œçº¿</span>        <span class="token comment" spellcheck="true"># cv2.fillPoly(img, [np.asarray(points)], 1)  # ç”»å¤šè¾¹å½¢ å†…éƒ¨åƒç´ å€¼ä¸º1</span>        polygons <span class="token operator">=</span> points        mask <span class="token operator">=</span> self<span class="token punctuation">.</span>polygons_to_mask<span class="token punctuation">(</span><span class="token punctuation">[</span>self<span class="token punctuation">.</span>height<span class="token punctuation">,</span> self<span class="token punctuation">.</span>width<span class="token punctuation">]</span><span class="token punctuation">,</span> polygons<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># print(polygons)</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>mask2box<span class="token punctuation">(</span>mask<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">mask2box</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> mask<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">'''ä»maskåç®—å‡ºå…¶è¾¹æ¡†        maskï¼š[h,w]  0ã€1ç»„æˆçš„å›¾ç‰‡        1å¯¹åº”å¯¹è±¡ï¼Œåªéœ€è®¡ç®—1å¯¹åº”çš„è¡Œåˆ—å·ï¼ˆå·¦ä¸Šè§’è¡Œåˆ—å·ï¼Œå³ä¸‹è§’è¡Œåˆ—å·ï¼Œå°±å¯ä»¥ç®—å‡ºå…¶è¾¹æ¡†ï¼‰        '''</span>        <span class="token comment" spellcheck="true"># np.where(mask==1)</span>        index <span class="token operator">=</span> np<span class="token punctuation">.</span>argwhere<span class="token punctuation">(</span>mask <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># print(index)</span>        rows <span class="token operator">=</span> index<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>        clos <span class="token operator">=</span> index<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># è§£æå·¦ä¸Šè§’è¡Œåˆ—å·</span>        <span class="token comment" spellcheck="true"># print(rows)</span>        left_top_r <span class="token operator">=</span> np<span class="token punctuation">.</span>min<span class="token punctuation">(</span>rows<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># y</span>        left_top_c <span class="token operator">=</span> np<span class="token punctuation">.</span>min<span class="token punctuation">(</span>clos<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># x</span>        <span class="token comment" spellcheck="true"># è§£æå³ä¸‹è§’è¡Œåˆ—å·</span>        right_bottom_r <span class="token operator">=</span> np<span class="token punctuation">.</span>max<span class="token punctuation">(</span>rows<span class="token punctuation">)</span>        right_bottom_c <span class="token operator">=</span> np<span class="token punctuation">.</span>max<span class="token punctuation">(</span>clos<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># return [(left_top_r,left_top_c),(right_bottom_r,right_bottom_c)]</span>        <span class="token comment" spellcheck="true"># return [(left_top_c, left_top_r), (right_bottom_c, right_bottom_r)]</span>        <span class="token comment" spellcheck="true"># return [left_top_c, left_top_r, right_bottom_c, right_bottom_r]  # [x1,y1,x2,y2]</span>        <span class="token keyword">return</span> <span class="token punctuation">[</span>left_top_c<span class="token punctuation">,</span> left_top_r<span class="token punctuation">,</span> right_bottom_c <span class="token operator">-</span> left_top_c<span class="token punctuation">,</span>                right_bottom_r <span class="token operator">-</span> left_top_r<span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># [x1,y1,w,h] å¯¹åº”COCOçš„bboxæ ¼å¼</span>    <span class="token keyword">def</span> <span class="token function">polygons_to_mask</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> img_shape<span class="token punctuation">,</span> polygons<span class="token punctuation">)</span><span class="token punctuation">:</span>        mask <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>img_shape<span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>        mask <span class="token operator">=</span> PIL<span class="token punctuation">.</span>Image<span class="token punctuation">.</span>fromarray<span class="token punctuation">(</span>mask<span class="token punctuation">)</span>        xy <span class="token operator">=</span> list<span class="token punctuation">(</span>map<span class="token punctuation">(</span>tuple<span class="token punctuation">,</span> polygons<span class="token punctuation">)</span><span class="token punctuation">)</span>        PIL<span class="token punctuation">.</span>ImageDraw<span class="token punctuation">.</span>Draw<span class="token punctuation">(</span>mask<span class="token punctuation">)</span><span class="token punctuation">.</span>polygon<span class="token punctuation">(</span>xy<span class="token operator">=</span>xy<span class="token punctuation">,</span> outline<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> fill<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>        mask <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>mask<span class="token punctuation">,</span> dtype<span class="token operator">=</span>bool<span class="token punctuation">)</span>        <span class="token keyword">return</span> mask    <span class="token keyword">def</span> <span class="token function">data2coco</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        data_coco <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        data_coco<span class="token punctuation">[</span><span class="token string">'images'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>images        data_coco<span class="token punctuation">[</span><span class="token string">'categories'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>categories        data_coco<span class="token punctuation">[</span><span class="token string">'annotations'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>annotations        <span class="token keyword">return</span> data_coco    <span class="token keyword">def</span> <span class="token function">save_json</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>data_transfer<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>data_coco <span class="token operator">=</span> self<span class="token punctuation">.</span>data2coco<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># ä¿å­˜jsonæ–‡ä»¶</span>        json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>self<span class="token punctuation">.</span>data_coco<span class="token punctuation">,</span> open<span class="token punctuation">(</span>self<span class="token punctuation">.</span>save_json_path<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                  indent<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> cls<span class="token operator">=</span>MyEncoder<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># indent=4 æ›´åŠ ç¾è§‚æ˜¾ç¤º</span><span class="token comment" spellcheck="true"># labelme_json = glob.glob(</span><span class="token comment" spellcheck="true">#     '/home/lry/projects/mmdetection/data/780b/*.json')</span><span class="token comment" spellcheck="true"># print(labelme_json)</span><span class="token comment" spellcheck="true"># # labelme_json=['./Annotations/*.json']</span><span class="token comment" spellcheck="true"># # labelme_json=glob.glob('./Annotations/*.json')</span><span class="token comment" spellcheck="true"># saveme_json = '/home/lry/projects/mmdetection/lry/draft.json'</span><span class="token comment" spellcheck="true"># print("Start.")</span><span class="token comment" spellcheck="true"># labelme2coco(labelme_json, saveme_json)</span><span class="token comment" spellcheck="true"># print("Finished.")</span>val_json <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">'/home/lry/data/780b_std/val/*.json'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>val_json<span class="token punctuation">)</span>saveme_json <span class="token operator">=</span> <span class="token string">'/home/lry/data/780b_std/val/annotation_coco.json'</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Start."</span><span class="token punctuation">)</span>labelme2coco<span class="token punctuation">(</span>val_json<span class="token punctuation">,</span> saveme_json<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Finished."</span><span class="token punctuation">)</span>train_json <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">'/home/lry/data/780b_std/train/*.json'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>train_json<span class="token punctuation">)</span>saveme_json <span class="token operator">=</span> <span class="token string">'/home/lry/data/780b_std/train/annotation_coco.json'</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Start."</span><span class="token punctuation">)</span>labelme2coco<span class="token punctuation">(</span>train_json<span class="token punctuation">,</span> saveme_json<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Finished."</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="åˆ’åˆ†è®­ç»ƒé›†å’ŒéªŒè¯é›†"><a href="#åˆ’åˆ†è®­ç»ƒé›†å’ŒéªŒè¯é›†" class="headerlink" title="åˆ’åˆ†è®­ç»ƒé›†å’ŒéªŒè¯é›†"></a>åˆ’åˆ†è®­ç»ƒé›†å’ŒéªŒè¯é›†</h2><p>è¿™é‡ŒæŒ‰ç…§7ï¼š3æ¥åˆ’åˆ†è®­ç»ƒé›†å’ŒéªŒè¯é›†:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token triple-quoted-string string">"""æœ¬æ¨¡å—ç”¨äºåˆ’åˆ†éªŒè¯é›†å’Œæµ‹è¯•é›†ï¼Œå¤§æ¦‚æ¯”ä¾‹ä¸º7ï¼š3"""</span><span class="token keyword">import</span> shutil<span class="token keyword">import</span> os<span class="token keyword">import</span> random<span class="token keyword">import</span> glob<span class="token keyword">def</span> <span class="token function">move_file</span><span class="token punctuation">(</span>old_path<span class="token punctuation">,</span> imgs<span class="token punctuation">,</span>  new_path<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">'''è¿™ä¸ªå‡½æ•°æ˜¯ç”¨æ¥ç§»åŠ¨å›¾ç‰‡å’Œç›¸åº”çš„jsonæ–‡ä»¶'''</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>old_path<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>new_path<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># filelist = os.listdir(old_path) #åˆ—å‡ºè¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶,listdirè¿”å›çš„æ–‡ä»¶åˆ—è¡¨æ˜¯ä¸åŒ…å«è·¯å¾„çš„ã€‚</span>    filelist <span class="token operator">=</span> imgs    <span class="token keyword">print</span><span class="token punctuation">(</span>filelist<span class="token punctuation">)</span>    <span class="token keyword">for</span> file <span class="token keyword">in</span> filelist<span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># file = file - "/home/lry/data/780b_std/"</span>        src <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>old_path<span class="token punctuation">,</span> file<span class="token punctuation">[</span>len<span class="token punctuation">(</span><span class="token string">"/home/lry/data/780b_std/"</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        dst <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>new_path<span class="token punctuation">,</span> file<span class="token punctuation">[</span>len<span class="token punctuation">(</span><span class="token string">"/home/lry/data/780b_std/"</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        src_json <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>old_path<span class="token punctuation">,</span> file<span class="token punctuation">[</span>len<span class="token punctuation">(</span><span class="token string">"/home/lry/data/780b_std/"</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'.jpg'</span><span class="token punctuation">)</span>        dst_json <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>new_path<span class="token punctuation">,</span> file<span class="token punctuation">[</span>len<span class="token punctuation">(</span><span class="token string">"/home/lry/data/780b_std/"</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'.jpg'</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'src:'</span><span class="token punctuation">,</span> src<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'dst:'</span><span class="token punctuation">,</span> dst<span class="token punctuation">)</span>        shutil<span class="token punctuation">.</span>move<span class="token punctuation">(</span>src<span class="token punctuation">,</span> dst<span class="token punctuation">)</span>        shutil<span class="token punctuation">.</span>move<span class="token punctuation">(</span>src_json<span class="token punctuation">,</span> dst_json<span class="token punctuation">)</span>old_path <span class="token operator">=</span> <span class="token string">"/home/lry/data/780b_std"</span>new_val <span class="token operator">=</span> <span class="token string">"/home/lry/data/780b_std/val"</span>new_train <span class="token operator">=</span> <span class="token string">"/home/lry/data/780b_std/train"</span>pics <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">"/home/lry/data/780b_std/*.json"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># print(len(pics))</span><span class="token comment" spellcheck="true"># print(pics[0][len("/home/lry/data/780b_std/"):-5] + ".jpg")</span><span class="token comment" spellcheck="true"># print(pics[0][:-4])</span><span class="token comment" spellcheck="true"># print(pics)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"moving...."</span><span class="token punctuation">)</span>move_file<span class="token punctuation">(</span>old_path<span class="token punctuation">,</span> pics<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">140</span><span class="token punctuation">]</span><span class="token punctuation">,</span> new_train<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"train end!"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"moving..."</span><span class="token punctuation">)</span>move_file<span class="token punctuation">(</span>old_path<span class="token punctuation">,</span> pics<span class="token punctuation">[</span><span class="token number">140</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> new_val<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"val end!"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è®¾å®šconfigæ–‡ä»¶"><a href="#è®¾å®šconfigæ–‡ä»¶" class="headerlink" title="è®¾å®šconfigæ–‡ä»¶"></a>è®¾å®šconfigæ–‡ä»¶</h2><p>æˆ‘ä»¬å†³å®šç”¨mask_rcnnï¼Œè¿™é‡Œç›´æ¥åœ¨<code>configs</code>ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹å«åšfenghuoï¼Œç„¶ååŠ å…¥ä¸€ä¸ª<code>mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_fenghuo.py</code>æ–‡ä»¶å°±OKã€‚æ–‡ä»¶å†…å®¹ä¸ºï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token triple-quoted-string string">"""æœ¬æ¨¡å—ç”¨äºæ”¾ç½®configsï¼Œå®šä¹‰æ¨¡å‹ç»“æ„,è¯¥é…ç½®æ–‡ä»¶å°†æ”¾åˆ°`/home/lry/projects/mmdetection/configs/fenghuo/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_balloon.py`"""</span><span class="token comment" spellcheck="true"># The new config inherits a base config to highlight the necessary modification</span>_base_ <span class="token operator">=</span> <span class="token string">'../mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_coco.py'</span><span class="token comment" spellcheck="true"># We also need to change the num_classes in head to match the dataset's annotation</span>model <span class="token operator">=</span> dict<span class="token punctuation">(</span>    roi_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>        bbox_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>num_classes<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        mask_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>num_classes<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># Modify dataset related settings</span>dataset_type <span class="token operator">=</span> <span class="token string">'COCODataset'</span>classes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'780B'</span><span class="token punctuation">,</span><span class="token punctuation">)</span>data <span class="token operator">=</span> dict<span class="token punctuation">(</span>    train<span class="token operator">=</span>dict<span class="token punctuation">(</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/780b_std/train/'</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/780b_std/train/annotation_coco.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    val<span class="token operator">=</span>dict<span class="token punctuation">(</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/780b_std/val/'</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/780b_std/val/annotation_coco.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    test<span class="token operator">=</span>dict<span class="token punctuation">(</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/780b_std/val/'</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/780b_std/val/annotation_coco.json'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># We can use the pre-trained Mask RCNN model to obtain higher performance</span>load_from <span class="token operator">=</span> <span class="token string">'checkpoints/mask_rcnn_r50_caffe_fpn_mstrain-poly_3x_coco_bbox_mAP-0.408__segm_mAP-0.37_20200504_163245-42aa3d00.pth'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è®­ç»ƒæ¨¡å‹"><a href="#è®­ç»ƒæ¨¡å‹" class="headerlink" title="è®­ç»ƒæ¨¡å‹"></a>è®­ç»ƒæ¨¡å‹</h2><pre class="line-numbers language-python"><code class="language-python">python tools<span class="token operator">/</span>train<span class="token punctuation">.</span>py configs<span class="token operator">/</span>fenghuo<span class="token operator">/</span>mask_rcnn_r50_caffe_fpn_mstrain<span class="token operator">-</span>poly_1x_fenghuo<span class="token punctuation">.</span>py<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="æµ‹è¯•æ¨¡å‹"><a href="#æµ‹è¯•æ¨¡å‹" class="headerlink" title="æµ‹è¯•æ¨¡å‹"></a>æµ‹è¯•æ¨¡å‹</h2><pre class="line-numbers language-python"><code class="language-python">CUDA_VISIBLE<span class="token operator">=</span><span class="token number">1</span> python tools<span class="token operator">/</span>test<span class="token punctuation">.</span>py configs<span class="token operator">/</span>fenghuo<span class="token operator">/</span>mask_rcnn_r50_caffe_fpn_mstrain<span class="token operator">-</span>poly_1x_fenghuo<span class="token punctuation">.</span>py work_dirs<span class="token operator">/</span>mask_rcnn_r50_caffe_fpn_mstrain<span class="token operator">-</span>poly_1x_fenghuo<span class="token operator">/</span>latest<span class="token punctuation">.</span>pth  <span class="token operator">-</span><span class="token operator">-</span>eval bbox segm<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="2021-11-14æ—¥æ—©æ›´æ–°"><a href="#2021-11-14æ—¥æ—©æ›´æ–°" class="headerlink" title="2021.11.14æ—¥æ—©æ›´æ–°"></a>2021.11.14æ—¥æ—©æ›´æ–°</h1><ul><li>è¿œç¨‹ä»“åº“ï¼š<a href="https://www.jianshu.com/p/e4bb2ac7e770" target="_blank" rel="noopener">https://www.jianshu.com/p/e4bb2ac7e770</a></li></ul><p>ç›®å‰éœ€è¦æ–°å»ºè¿œç¨‹GitHubä»“åº“æ–¹ä¾¿æˆ‘ä¸åˆ«äººåä½œ</p><p>ç›®å‰æ•´ä¸ªå¤§æ¡†çš„æ£€æµ‹è¿˜æ¯”è¾ƒæˆåŠŸï¼Œæ¥ç€å°±æ˜¯æ£€æµ‹æ¯ä¸ªå°æ¡†çš„åˆ†ç±»ä»»åŠ¡ã€‚</p><h1 id="2021-11-29æ—¥æ™šæ›´æ–°"><a href="#2021-11-29æ—¥æ™šæ›´æ–°" class="headerlink" title="2021.11.29æ—¥æ™šæ›´æ–°"></a>2021.11.29æ—¥æ™šæ›´æ–°</h1><p>è¿œç¨‹ä»“åº“åˆ›å»ºæˆåŠŸï¼Œä»“åº“åœ°å€ï¼š<a href="https://github.com/LRY89757/mmdet-for-fenghuo" target="_blank" rel="noopener">çƒ½ç«æ£€æµ‹</a></p><p>ç›®å‰éœ€è¦åšçš„äº‹æƒ…ï¼š</p><ul><li>å†™ä¸€ä¸ªå…³äºè¿™ç±»Labelmeæ–‡æ¡£éœ€è¦çš„dataloaderï¼Œå†™ä¸€ä¸ªå°½é‡æ¯”è¾ƒå…¨é¢é€‚é…æ€§æ¯”è¾ƒå¼ºã€å¯è¿ç§»æ€§æ¯”è¾ƒå¥½çš„dataloader</li><li>å¯¹äºè¿è¡Œå‡ºæ¥çš„ç»“æœçš„å›¾åƒåšä¸€ä¸ªç®€å•çš„åˆ‡åˆ†ï¼Œå¹³å‡åˆ†ä¸º19ä»½ç„¶åå°†æ¯ä¸€ä¸ªå•ç‹¬çš„ç›˜éƒ½cropå‡ºæ¥ç„¶åå°†éç›˜åŒºåŸŸæ ‡é»‘æ”¾åˆ°resnet101ç­‰å„ç±»åˆ†ç±»ç½‘ç»œä¸­è¿›è¡Œç›¸å…³çš„åˆ†ç±»ä»»åŠ¡ã€‚</li><li>åˆ’åˆ†æµ‹è¯•é›†å’Œè®­ç»ƒé›†çš„æ—¶å€™é€‰æ‹©ä½¿ç”¨ç”Ÿæˆval.txtè¿˜æœ‰train.txtæ–‡ä»¶çš„æ ¼å¼ï¼Œæ¯ä¸ª.txtæ–‡ä»¶å†…é˜²æ­¢ç›¸å…³æ•°æ®çš„è·¯å¾„ã€‚è€Œä¸æ˜¯å°†å…¶å¤åˆ¶åˆ°ä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ä¸­è¿›è¡Œåˆ†ç±»ï¼Œä¸‡ä¸€ç¡¬ç›˜æ²¡æœ‰é‚£ä¹ˆå¤§çš„ç©ºé—´æ€ä¹ˆåŠï¼Œä¸è¦æ»¥ç”¨ç¡¬ç›˜èµ„æºã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> çƒ½ç«é›†å›¢ </tag>
            
            <tag> é¡¹ç›® </tag>
            
            <tag> å›¾åƒå¤„ç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Intro to QT</title>
      <link href="/2021/11/23/intro-to-qt/"/>
      <url>/2021/11/23/intro-to-qt/</url>
      
        <content type="html"><![CDATA[<h2 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h2><p>ç®€å•ä»‹ç»ä¸€ä¸‹å…³äºQTçš„ä¸€äº›äº†è§£ï¼Œç”¨æ¥åº”ä»˜æˆ‘çš„C++ä½œä¸šã€‚</p><h2 id="ä¸‰ç§åŸºç±»"><a href="#ä¸‰ç§åŸºç±»" class="headerlink" title="ä¸‰ç§åŸºç±»"></a>ä¸‰ç§åŸºç±»</h2><p><code>QMainWindow</code>, <code>QWidget</code>, <code>QDialog</code>.<br><code>QWidget</code>æ˜¯ä»¥ä¸Šä¸¤ç§çš„åŸºç±»ï¼Œå…¶ä»–ä¸¤ç§ä¸ºå­ç±»ã€‚è€Œ<code>QWidget</code>æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„çª—å£ï¼Œä¸€åˆ›å»ºå‡ºæ¥ä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚è€ŒQMainWindowæ˜¯å¤šäº†çŠ¶æ€æ ï¼Œè€ŒQDialogæ˜¯å¯¹è¯æ¡†ï¼Œå°±æ˜¯ç‚¹ä¸€ä¸ªä¸œè¥¿ä¼šç®€å•å¼¹å‡ºæ¥ä¸€ä¸ªæ¡†ï¼Œä¸€èˆ¬æ²¡æœ‰æœ€å°åŒ–æœ€å¤§åŒ–é‚£ç§ï¼ˆ<del>æ¯”å¦‚MVSC2019ä¸­çš„è¿è¡Œä¸­é—´çªç„¶å¼¹å‡ºä¸€ä¸ªæ¡†å‘Šè¯‰ä½ ç¨‹åºå†™é”™äº†ï¼ï¼</del>ï¼‰ã€‚<br>æˆ‘ä»¬åˆ›å»ºå·¥ç¨‹ååŸºç±»è®¾å®šå¥½ä¹‹åè®¾å®šå­ç±»åç§°ä¸€èˆ¬QTä¼šè‡ªåŠ¨ç»™ä½ å®‰æ’å¥½ä¸€ä¸ªåŒåçš„<code>.h, .cpp</code>æ–‡ä»¶ã€‚</p><p>å¯ä»¥çœ‹ä¸€ä¸‹æœ€åç”Ÿæˆçš„æ–‡ä»¶éƒ½æœ‰ä»€ä¹ˆï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/11/23/IZcbNf.png" alt></p><h2 id="main-cpp"><a href="#main-cpp" class="headerlink" title="main.cpp"></a>main.cpp</h2><pre class="line-numbers language-c++"><code class="language-c++">#include "QtWidgetsApplication1.h"#include <QtWidgets/QApplication>int main(int argc, char *argv[]){    QApplication a(argc, argv);    QtWidgetsApplication1 w;    w.show();    return a.exec();}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°ç¨‹åºè‡ªåŠ¨ä¼šæœ‰ä¸€äº›åŸºæœ¬çš„ä»£ç ã€‚ç¬¬ä¸€ä¸ªå¼•ç”¨çš„æ˜¯æœ€åˆç”Ÿæˆçš„<code>.h</code>æ–‡ä»¶ã€‚è€Œç¬¬äºŒä¸ªæ˜¯åŒ…å«ä¸€ä¸ªåº”ç”¨ç¨‹åºç±»çš„å¤´æ–‡ä»¶ã€‚<br>è€Œåmainå‡½æ•°å°±æ˜¯ç¨‹åºçš„å…¥å£äº†ã€‚argcæ˜¯å‘½ä»¤è¡Œå˜é‡çš„æ•°é‡ï¼Œargvæ˜¯å‘½ä»¤è¡Œå˜é‡çš„æ•°ç»„ã€‚<br>è€Œå…³äºè¿™ä¸ª<code>QApplication a(argc, argv)</code>è¿™é‡Œaå°±æ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºå¯¹è±¡ï¼Œè€Œä¸”åœ¨ç¨‹åºä¸­æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªï¼Œå¿…é¡»è¦æœ‰ä½†åªèƒ½æœ‰ä¸€ä¸ªã€‚<br>è€Œåè¿™ä¸ª<code>QtWidgetsApplication1 w;</code>å°±æ˜¯ä¸ªçª—å£å¯¹è±¡ã€‚<code>QtWidgetsApplication1</code>çš„çˆ¶ç±»æ˜¯<code>QWidget</code>,å°±æ˜¯ä¸ªç©ºçª—å£è€Œå·²ã€‚è¿™ä¸ª<code>w.show()</code>å°±æ˜¯ä¸ªæ–¹æ³•ï¼Œé»˜è®¤çª—å£ä¸ä¼šæ˜¾ç¤ºï¼Œåªæœ‰è°ƒç”¨äº†show()æ–¹æ³•ç¨‹åºçª—å£æ‰ä¼šæ˜¾ç¤ºã€‚<br>è€Œå…³äºè¿™ä¸ª<code>a.exec()</code>å°±æ˜¯è®©ç¨‹åºè¿›å…¥æ¶ˆæ¯å¾ªç¯æœºåˆ¶ã€‚å°±ç›¸å½“äºä¸€ä¸ªæ­»å¾ªç¯æœºåˆ¶ã€‚æœ‰ç‚¹åƒï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">while(true){    if(ç‚¹å‡»`x`)        break;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°±æ˜¯è®©çª—å£ä¿æŒåœ¨é‚£é‡Œï¼Œä¸ä¼šä¸€é—ªè€Œè¿‡ã€‚<br>ç¨‹åºè¿è¡Œç»“æœå°±æ˜¯ä¸€ä¸ªæ¡†ï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/11/23/IZcf8G.png" alt><br>æ¯•ç«Ÿçˆ¶ç±»ä»…ä»…æ˜¯<code>QWidget</code>ä»…ä»…ä¸€ä¸ªçª—å£ã€‚</p><h2 id><a href="#" class="headerlink" title></a></h2>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag> QT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Write A Dataloader</title>
      <link href="/2021/11/17/write-a-dataloader/"/>
      <url>/2021/11/17/write-a-dataloader/</url>
      
        <content type="html"><![CDATA[<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>å¦‚ä½•å†™dataloader?å¥½å¤šæ¬¡æ‰“ç®—å†™æ·±åº¦å­¦ä¹ ä»£ç éƒ½æ˜¯ä»dataloaderå¼€å§‹åˆç»“æŸçš„â€¦â€¦å®é™…ä¸Šä»å¼€å§‹æ¥è§¦æ·±åº¦å­¦ä¹ åˆ°ç°åœ¨æ•°æ®éƒ½è¯»äº†å¥½å¤šæ¬¡äº†ï¼Œä¹Ÿå†™è¿‡å¥½å¤šå¥½å¤šçš„æ•°æ®è¯»å–äº†ï¼Œä½†æ˜¯ç°åœ¨è¦é—®æˆ‘å¦‚ä½•è¯»å–ä¸€ä¸ªæ•°æ®ï¼Œå®é™…ä¸Šæˆ‘è¿˜æ˜¯å¤§è„‘ä¸€ç¯‡ç©ºç™½ã€‚è¯´å®è¯ï¼Œè¿™ä¸ªéå¸¸æœ‰å¿…è¦æ€»ç»“ä¸€ä¸‹ï¼Œç®—æ˜¯è‡ªå·±ä¸€ä¸ªä»£ç ä»“åº“æˆ–è€…æ˜¯ä¸€ä¸ªä»£ç çš„æ¨¡æ¿æ–‡ä»¶ã€‚è‡ªå·±æ€»ç»“çš„è¿˜æ˜¯æ¯”åˆ°æ—¶å€™æ‰‹å¿™è„šä¹±çš„å»æŠ„åˆ«äººçš„è¦å¥½å¤ªå¤šäº†ã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul><li>pytorchè¯»å–ç›®æ ‡æ£€æµ‹æ•°æ®é›†ï¼š<a href="https://zhuanlan.zhihu.com/p/159450823" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/159450823</a></li><li>VOCæ•°æ®é›†è¯»å–ï¼š<a href="https://daimajiaoliu.com/daima/7b7436a63805402" target="_blank" rel="noopener">https://daimajiaoliu.com/daima/7b7436a63805402</a></li><li>é™ˆäº‘çš„<a href="https://github1s.com/LRY89757/pytorch_explore/tree/main/chapter05-utilities" target="_blank" rel="noopener">pytorch_tutorial chapter 05</a></li><li>å®˜æ–¹tutorial:<a href="https://pytorch.org/tutorials/beginner/data_loading_tutorial.html" target="_blank" rel="noopener">https://pytorch.org/tutorials/beginner/data_loading_tutorial.html</a></li><li>å®˜æ–¹tutorial:<a href="https://pytorch.org/tutorials/recipes/recipes/custom_dataset_transforms_loader.html" target="_blank" rel="noopener">https://pytorch.org/tutorials/recipes/recipes/custom_dataset_transforms_loader.html</a></li><li>å®˜æ–¹tutorial:<a href="https://pytorch.org/tutorials/beginner/basics/data_tutorial.html" target="_blank" rel="noopener">https://pytorch.org/tutorials/beginner/basics/data_tutorial.html</a></li><li><a href="https://towardsdatascience.com/how-to-use-datasets-and-dataloader-in-pytorch-for-custom-text-data-270eed7f7c00" target="_blank" rel="noopener">https://towardsdatascience.com/how-to-use-datasets-and-dataloader-in-pytorch-for-custom-text-data-270eed7f7c00</a></li><li>ç®€å•ä»‹ç»ï¼š<a href="https://sparrow.dev/pytorch-dataloader/" target="_blank" rel="noopener">https://sparrow.dev/pytorch-dataloader/</a></li></ul><h1 id="åŸºç¡€è¯»å–åŠTorchvision"><a href="#åŸºç¡€è¯»å–åŠTorchvision" class="headerlink" title="åŸºç¡€è¯»å–åŠTorchvision"></a>åŸºç¡€è¯»å–åŠTorchvision</h1><h2 id="åŸºç¡€è¯»å–"><a href="#åŸºç¡€è¯»å–" class="headerlink" title="åŸºç¡€è¯»å–"></a>åŸºç¡€è¯»å–</h2><p>æœ€åŸºç¡€çš„pytorchæ•°æ®è¯»å–ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ç§æ“ä½œï¼š</p><ul><li>å¯¹äºç‰¹å®šçš„æ•°æ®å†™ä¸€ä¸ªdataloader</li><li>å¯¹äºç»å…¸çš„æ•°æ®é›†pytorchå®˜æ–¹æä¾›æœ‰ç®€å•çš„ç›´æ¥</li><li>åˆ©ç”¨pytorchæä¾›çš„ImageFloaderæ¥è¿›è¡Œç›¸å…³çš„è¯»å–ã€‚</li></ul><p>ä¸‹é¢ä¸€ä¸ªä¸€ä¸ªä»‹ç»</p><h3 id="å†™ä¸€ä¸ªdataset"><a href="#å†™ä¸€ä¸ªdataset" class="headerlink" title="å†™ä¸€ä¸ªdataset"></a>å†™ä¸€ä¸ªdataset</h3><h4 id="a-simple-intro-of-torch-utils-data-Dataset"><a href="#a-simple-intro-of-torch-utils-data-Dataset" class="headerlink" title="a simple intro of torch.utils.data.Dataset"></a>a simple intro of <code>torch.utils.data.Dataset</code></h4><p>åœ¨Pytorchä¸­ï¼Œæ•°æ®åŠ è½½å¯ä»¥é€šè¿‡è‡ªå®šä¹‰çš„æ•°æ®é›†å¯¹è±¡ã€‚æ•°æ®é›†å¯¹è±¡è¢«æŠ½è±¡æˆ<code>Dataset</code>ç±»ï¼Œ è¯¥ç±»å­˜åœ¨äº<code>torch.utils.data.Dataset</code>ä¸­ã€‚æˆ‘ä»¬è¿™é‡Œæ³¨æ„å®ç°è¿™æ ·çš„ç±»ç»§æ‰¿<code>Dataset</code>åŒæ—¶éœ€è¦å®ç°å®ƒçš„ä¸¤ä¸ªPythoné­”æœ¯æ–¹æ³•ï¼š<code>__getitem__</code>å’Œ<code>__len__</code>.</p><ul><li><code>__getitem__</code>ï¼šè¿”å›ä¸€æ¡æ•°æ®ï¼Œæˆ–ä¸€ä¸ªæ ·æœ¬ã€‚<code>obj[index]</code>ç­‰ä»·äº<code>obj.__getitem__(index)</code></li><li><code>__len__</code>ï¼šè¿”å›æ ·æœ¬çš„æ•°é‡ã€‚<code>len(obj)</code>ç­‰ä»·äº<code>obj.__len__()</code></li></ul><p>è¿™é‡Œå¯ä»¥ç®€å•çœ‹ä¸€ä¸ªéå¸¸ç®€å•çš„å°ä¾‹å­ï¼Œè¿™é‡Œè¯»å–çš„æ˜¯åˆ†ç±»æ•°æ®é›†çš„ï¼Œè€Œä¸”æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„äºŒåˆ†ç±»æ•°æ®é›†ï¼Œæ¥è‡ª<a href="https://www.kaggle.com/c/dogs-vs-cats/" target="_blank" rel="noopener">kaggleçŒ«ç‹—åˆ†ç±»</a>ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> os<span class="token keyword">from</span> PIL <span class="token keyword">import</span>  Image<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">class</span> <span class="token class-name">DogCat</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>Dataset<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> root<span class="token punctuation">)</span><span class="token punctuation">:</span>        imgs <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>root<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># æ‰€æœ‰å›¾ç‰‡çš„ç»å¯¹è·¯å¾„</span>        <span class="token comment" spellcheck="true"># è¿™é‡Œä¸å®é™…åŠ è½½å›¾ç‰‡ï¼Œåªæ˜¯æŒ‡å®šè·¯å¾„ï¼Œå½“è°ƒç”¨__getitem__æ—¶æ‰ä¼šçœŸæ­£è¯»å›¾ç‰‡</span>        self<span class="token punctuation">.</span>imgs <span class="token operator">=</span> <span class="token punctuation">[</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>root<span class="token punctuation">,</span> img<span class="token punctuation">)</span> <span class="token keyword">for</span> img <span class="token keyword">in</span> imgs<span class="token punctuation">]</span>    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">:</span>        img_path <span class="token operator">=</span> self<span class="token punctuation">.</span>imgs<span class="token punctuation">[</span>index<span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># dog->1ï¼Œ cat->0</span>        label <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">if</span> <span class="token string">'dog'</span> <span class="token keyword">in</span> img_path<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">else</span> <span class="token number">0</span>        pil_img <span class="token operator">=</span> Image<span class="token punctuation">.</span>open<span class="token punctuation">(</span>img_path<span class="token punctuation">)</span>        array <span class="token operator">=</span> np<span class="token punctuation">.</span>asarray<span class="token punctuation">(</span>pil_img<span class="token punctuation">)</span>        data <span class="token operator">=</span> t<span class="token punctuation">.</span>from_numpy<span class="token punctuation">(</span>array<span class="token punctuation">)</span>        <span class="token keyword">return</span> data<span class="token punctuation">,</span> label    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> len<span class="token punctuation">(</span>self<span class="token punctuation">.</span>imgs<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»£ç é‡Œé¢å€¼å¾—æ³¨æ„çš„æ˜¯è¿™é‡Œé¢çš„<code>__init__()</code>å‡½æ•°å¹¶ä¸å®é™…åŠ è½½å›¾ç‰‡ï¼Œåªæ˜¯åˆ’åˆ†äº†å›¾ç‰‡çš„è·¯å¾„ï¼Œç„¶åä¸€æ¬¡è°ƒç”¨<code>__getitem__()</code>åªè¿”å›ä¸€ä¸ªæ ·æœ¬ã€‚</p><p>å¦‚æœæˆ‘ä»¬è°ƒç”¨ç±»çš„ç›¸å…³å®ä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç±»å¤§æ¦‚æ˜¯è¿™ä¸ªæ ·å­ï¼š<br>è°ƒç”¨ä»£ç ï¼š</p><pre class="line-numbers language-python"><code class="language-python">dataset <span class="token operator">=</span> DogCat<span class="token punctuation">(</span><span class="token string">'./data/dogcat/'</span><span class="token punctuation">)</span>img<span class="token punctuation">,</span> label <span class="token operator">=</span> dataset<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># ç›¸å½“äºè°ƒç”¨dataset.__getitem__(0)</span><span class="token keyword">for</span> img<span class="token punctuation">,</span> label <span class="token keyword">in</span> dataset<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>img<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> img<span class="token punctuation">.</span>float<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> label<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¿è¡Œç»“æœï¼š</p><pre class="line-numbers language-python"><code class="language-python">torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">375</span><span class="token punctuation">,</span> <span class="token number">499</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> tensor<span class="token punctuation">(</span><span class="token number">116.8187</span><span class="token punctuation">)</span> <span class="token number">1</span>torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">499</span><span class="token punctuation">,</span> <span class="token number">379</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> tensor<span class="token punctuation">(</span><span class="token number">171.8088</span><span class="token punctuation">)</span> <span class="token number">0</span>torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">236</span><span class="token punctuation">,</span> <span class="token number">289</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> tensor<span class="token punctuation">(</span><span class="token number">130.3022</span><span class="token punctuation">)</span> <span class="token number">0</span>torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">377</span><span class="token punctuation">,</span> <span class="token number">499</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> tensor<span class="token punctuation">(</span><span class="token number">151.7141</span><span class="token punctuation">)</span> <span class="token number">1</span>torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">374</span><span class="token punctuation">,</span> <span class="token number">499</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> tensor<span class="token punctuation">(</span><span class="token number">115.5157</span><span class="token punctuation">)</span> <span class="token number">0</span>torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">375</span><span class="token punctuation">,</span> <span class="token number">499</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> tensor<span class="token punctuation">(</span><span class="token number">150.5086</span><span class="token punctuation">)</span> <span class="token number">1</span>torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> tensor<span class="token punctuation">(</span><span class="token number">128.1548</span><span class="token punctuation">)</span> <span class="token number">1</span>torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">497</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> tensor<span class="token punctuation">(</span><span class="token number">106.4917</span><span class="token punctuation">)</span> <span class="token number">0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="dataloader-of-classic-data"><a href="#dataloader-of-classic-data" class="headerlink" title="dataloader of classic data"></a>dataloader of classic data</h4><p>torchvisionå®é™…ä¸Šå¯¹äºéå¸¸å¤šçš„ç»å…¸æ•°æ®é›†éƒ½æœ‰é¢„å…ˆçš„å®šä¹‰å¥½çš„dataset,æ¯”å¦‚CIFAR-10, ImageNet, COCO, LSUNç­‰æ•°æ®é›†ã€‚å¯ä»¥åˆ©ç”¨torchvisionæ¨¡å—çš„<code>torchvision.datasets.CIFAR10</code>æ¥è°ƒç”¨ã€‚</p><p>å‘½ä»¤ä¸€èˆ¬å°±éå¸¸ç®€å•äº†ï¼Œè¿™é‡Œæ˜¯<a href="https://pytorch.org/vision/stable/datasets.html" target="_blank" rel="noopener">å®˜ç½‘</a>ç»™å‡ºçš„ä¸€ä¸ªå°ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">imagenet_data <span class="token operator">=</span> torchvision<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>ImageNet<span class="token punctuation">(</span><span class="token string">'path/to/imagenet_root/'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯¹çš„ï¼Œå°±è¿™ä¹ˆç®€å•ï¼Œè¿”å›çš„ä¹Ÿç›¸å½“äºæ˜¯torch.utils.data.Datasetçš„ä¸€ä¸ªå­ç±»ã€‚<br>å®˜ç½‘åŸè¯æ˜¯ï¼š<br><em>All the datasets have almost similar API. They all have two common arguments: transform and target_transform to transform the input and target respectively. You can also create your own datasets using the provided <code>base classes</code>.</em></p><p>å†çœ‹ä¸€ä¸‹å®˜ç½‘çš„CIFAR-100æœ‰å…³å‚æ•°è§£é‡Šï¼š</p><pre class="line-numbers language-python"><code class="language-python">torchvision<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>CIFAR100<span class="token punctuation">(</span>root<span class="token punctuation">:</span> str<span class="token punctuation">,</span> train<span class="token punctuation">:</span> bool <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> transform<span class="token punctuation">:</span> Optional<span class="token punctuation">[</span>Callable<span class="token punctuation">]</span> <span class="token operator">=</span> None<span class="token punctuation">,</span> target_transform<span class="token punctuation">:</span> Optional<span class="token punctuation">[</span>Callable<span class="token punctuation">]</span> <span class="token operator">=</span> None<span class="token punctuation">,</span> download<span class="token punctuation">:</span> bool <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¹Ÿå°±æ˜¯ï¼Œå®é™…ä¸Šé™¤äº†è·¯å¾„ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è‡ªå®šä¹‰æ•°æ®é›†çš„transformsçš„æ“ä½œ,è¿˜å¯ä»¥å®šä¹‰æ˜¯å¦ä¸‹è½½æ•°æ®ï¼ã€‚å¦å¤–æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†æˆ‘ä»¬è‡ªå·±çš„æ•°æ®é›†è½¬åŒ–ä¸ºå¯¹åº”ç»å…¸æ•°æ®é›†çš„æ ¼å¼ååˆ©ç”¨è¿™äº›ç»å…¸çš„æ•°æ®é›†è¯»å–dataloaderæ¥è¿›ä¸€æ­¥è¿›è¡Œç›¸å…³çš„è¯»å–æ“ä½œã€‚ï¼ˆ<del>æ¯”å¦‚æˆ‘å†™çš„çƒ½ç«é¡¹ç›®çš„æ•°æ®å°±æ˜¯å†™äº†ä¸ªè„šæœ¬å°†å…¶è½¬åŒ–ä¸ºCOCOæ•°æ®é›†æ ¼å¼ã€‚</del>ï¼‰<br>å¯ä»¥çœ‹çœ‹<a href="https://pytorch.org/vision/stable/datasets.html" target="_blank" rel="noopener">å®˜ç½‘</a>å®é™…ä¸Šæ”¯æŒéå¸¸å¤šçš„æ•°æ®é›†çš„ã€‚</p><p>å¦å¤–è¿™é‡Œå†åŠ ä¸€ä¸ªå½“æ—¶è‡ªå·±æ ‡å‡†çš„è¯»å–CIFAR-10çš„æºç ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># æ•°æ®é¢„å¤„ç†ï¼Œç›¸å½“äºæå‰å®šä¹‰äº†æ€ä¹ˆå¤„ç†æ•°æ®ï¼š</span><span class="token comment" spellcheck="true"># å› ä¸ºè¯»å…¥çš„æ•°æ®ä¸ºnumpyæ ¼å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å…ˆå°†å…¶è½¬æ¢ä¸ºtensoræ ¼å¼ï¼Œ</span><span class="token comment" spellcheck="true"># ç„¶åå¯¹å…¶è¿›è¡Œå½’ä¸€åŒ–ï¼Œæœ‰ä¸‰ä¸ªé€šé“éœ€è¦å½’ä¸€åŒ–ï¼Œè€Œç¬¬ä¸€ä¸ªä¸ºå‡å€¼ï¼Œç¬¬äºŒä¸ªä¸ºæ ‡å‡†å·®</span>transform <span class="token operator">=</span> transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span><span class="token punctuation">[</span>    transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># è½¬ä¸ºTensor</span>    transforms<span class="token punctuation">.</span>Normalize<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># è®­ç»ƒé›†</span>trainset <span class="token operator">=</span> tv<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>CIFAR10<span class="token punctuation">(</span>    root<span class="token operator">=</span><span class="token string">'/kaggle/input/cifar10-python'</span><span class="token punctuation">,</span>    train<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>    download<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>    transform<span class="token operator">=</span>transform<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># è¿­ä»£å™¨</span>trainloader <span class="token operator">=</span> t<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>    trainset<span class="token punctuation">,</span>    batch_size<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>    shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>    num_workers<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span>    pin_memory<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># æµ‹è¯•é›†</span>testset <span class="token operator">=</span> tv<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>CIFAR10<span class="token punctuation">(</span>    root<span class="token operator">=</span><span class="token string">'/kaggle/input/cifar10-python'</span><span class="token punctuation">,</span>    train<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>    download<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>    transform<span class="token operator">=</span>transform<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># è¿­ä»£å™¨</span>testloader <span class="token operator">=</span> t<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>    trainset<span class="token punctuation">,</span>    batch_size<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>    shuffle<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>    num_workers<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span>    pin_memory<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>classes <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'plane'</span><span class="token punctuation">,</span> <span class="token string">'car'</span><span class="token punctuation">,</span> <span class="token string">'bird'</span><span class="token punctuation">,</span> <span class="token string">'cat'</span><span class="token punctuation">,</span> <span class="token string">'deer'</span><span class="token punctuation">,</span> <span class="token string">'dog'</span><span class="token punctuation">,</span> <span class="token string">'frog'</span><span class="token punctuation">,</span> <span class="token string">'horse'</span><span class="token punctuation">,</span> <span class="token string">'ship'</span><span class="token punctuation">,</span> <span class="token string">'truck'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="about-the-torchvision-datasets-ImageFolader"><a href="#about-the-torchvision-datasets-ImageFolader" class="headerlink" title="about the torchvision.datasets.ImageFolader"></a>about the torchvision.datasets.ImageFolader</h4><p>åœ¨è¿™é‡Œä»‹ç»ä¸€ä¸ªä¼šç»å¸¸ä½¿ç”¨åˆ°çš„Datasetâ€”â€”<code>ImageFolder</code>ï¼Œå®ƒçš„å®ç°å’Œä¸Šè¿°çš„<code>DogCat</code>å¾ˆç›¸ä¼¼ã€‚<code>ImageFolder</code>å‡è®¾æ‰€æœ‰çš„æ–‡ä»¶æŒ‰æ–‡ä»¶å¤¹ä¿å­˜ï¼Œæ¯ä¸ªæ–‡ä»¶å¤¹ä¸‹å­˜å‚¨åŒä¸€ä¸ªç±»åˆ«çš„å›¾ç‰‡ï¼Œæ–‡ä»¶å¤¹åä¸ºç±»åï¼Œå…¶æ„é€ å‡½æ•°å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">ImageFolder<span class="token punctuation">(</span>root<span class="token punctuation">,</span> transform<span class="token operator">=</span>None<span class="token punctuation">,</span> target_transform<span class="token operator">=</span>None<span class="token punctuation">,</span> loader<span class="token operator">=</span>default_loader<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å®ƒä¸»è¦æœ‰å››ä¸ªå‚æ•°ï¼š</p><ul><li><code>root</code>ï¼šåœ¨rootæŒ‡å®šçš„è·¯å¾„ä¸‹å¯»æ‰¾å›¾ç‰‡</li><li><code>transform</code>ï¼šå¯¹PIL Imageè¿›è¡Œçš„è½¬æ¢æ“ä½œï¼Œtransformçš„è¾“å…¥æ˜¯ä½¿ç”¨loaderè¯»å–å›¾ç‰‡çš„è¿”å›å¯¹è±¡</li><li><code>target_transform</code>ï¼šå¯¹labelçš„è½¬æ¢</li><li><code>loader</code>ï¼šç»™å®šè·¯å¾„åå¦‚ä½•è¯»å–å›¾ç‰‡ï¼Œé»˜è®¤è¯»å–ä¸ºRGBæ ¼å¼çš„PIL Imageå¯¹è±¡</li></ul><p>labelæ˜¯æŒ‰ç…§æ–‡ä»¶å¤¹åé¡ºåºæ’åºåå­˜æˆå­—å…¸ï¼Œå³{ç±»å:ç±»åºå·(ä»0å¼€å§‹)}ï¼Œä¸€èˆ¬æ¥è¯´æœ€å¥½ç›´æ¥å°†æ–‡ä»¶å¤¹å‘½åä¸ºä»0å¼€å§‹çš„æ•°å­—ï¼Œè¿™æ ·ä¼šå’ŒImageFolderå®é™…çš„labelä¸€è‡´ï¼Œå¦‚æœä¸æ˜¯è¿™ç§å‘½åè§„èŒƒï¼Œå»ºè®®çœ‹çœ‹<code>self.class_to_idx</code>å±æ€§ä»¥äº†è§£labelå’Œæ–‡ä»¶å¤¹åçš„æ˜ å°„å…³ç³»ã€‚å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªå…³äºlabelçš„åå­—å’Œæ–‡ä»¶å¤¹çš„æ˜ å°„ã€‚åˆ°ä¸‹é¢æˆ‘ä»¬å°±çŸ¥é“äº†ã€‚</p><p>æˆ‘ä»¬ä»ç„¶ç”¨ä¸Šæ–‡çš„çŒ«ç‹—å¤§æˆ˜çš„æ•°æ®é›†ä¸¾ä¾‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">!tree <span class="token operator">-</span><span class="token operator">-</span>charset ASCII  data<span class="token operator">/</span>dogcat_2<span class="token operator">/</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°æ•°æ®é›†å¤§æ¦‚ç»„æˆï¼š</p><pre class="line-numbers language-python"><code class="language-python">data<span class="token operator">/</span>dogcat_2<span class="token operator">/</span><span class="token operator">|</span><span class="token operator">-</span><span class="token operator">-</span> cat<span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">-</span><span class="token operator">-</span> cat<span class="token number">.12484</span><span class="token punctuation">.</span>jpg<span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">-</span><span class="token operator">-</span> cat<span class="token number">.12485</span><span class="token punctuation">.</span>jpg<span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">-</span><span class="token operator">-</span> cat<span class="token number">.12486</span><span class="token punctuation">.</span>jpg<span class="token operator">|</span>   `<span class="token operator">-</span><span class="token operator">-</span> cat<span class="token number">.12487</span><span class="token punctuation">.</span>jpg`<span class="token operator">-</span><span class="token operator">-</span> dog    <span class="token operator">|</span><span class="token operator">-</span><span class="token operator">-</span> dog<span class="token number">.12496</span><span class="token punctuation">.</span>jpg    <span class="token operator">|</span><span class="token operator">-</span><span class="token operator">-</span> dog<span class="token number">.12497</span><span class="token punctuation">.</span>jpg    <span class="token operator">|</span><span class="token operator">-</span><span class="token operator">-</span> dog<span class="token number">.12498</span><span class="token punctuation">.</span>jpg    `<span class="token operator">-</span><span class="token operator">-</span> dog<span class="token number">.12499</span><span class="token punctuation">.</span>jpg<span class="token number">2</span> directories<span class="token punctuation">,</span> <span class="token number">8</span> files<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬çš„è¯»å–ä»£ç å°±ä¸º:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> torchvision<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> ImageFolderdataset <span class="token operator">=</span> ImageFolder<span class="token punctuation">(</span><span class="token string">'data/dogcat_2/'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç„¶åæˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬çš„ç±»åˆ«å¯¹åº”å…³ç³»ä»¥åŠè¯»å–çš„ç›¸å…³å›¾ç‰‡ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># catæ–‡ä»¶å¤¹çš„å›¾ç‰‡å¯¹åº”label 0ï¼Œdogå¯¹åº”1</span><span class="token keyword">print</span><span class="token punctuation">(</span>dataset<span class="token punctuation">.</span>class_to_idx<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># æ‰€æœ‰å›¾ç‰‡çš„è·¯å¾„å’Œå¯¹åº”çš„label</span><span class="token keyword">print</span><span class="token punctuation">(</span>dataset<span class="token punctuation">.</span>imgs<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥å¾—åˆ°ç»“æœï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token punctuation">{</span><span class="token string">'cat'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'dog'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'data/dogcat_2/cat/cat.12484.jpg'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'data/dogcat_2/cat/cat.12485.jpg'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'data/dogcat_2/cat/cat.12486.jpg'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'data/dogcat_2/cat/cat.12487.jpg'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'data/dogcat_2/dog/dog.12496.jpg'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'data/dogcat_2/dog/dog.12497.jpg'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'data/dogcat_2/dog/dog.12498.jpg'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'data/dogcat_2/dog/dog.12499.jpg'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ç›¸å…³çš„å›¾ç‰‡ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># æ²¡æœ‰ä»»ä½•çš„transformï¼Œæ‰€ä»¥è¿”å›çš„è¿˜æ˜¯PIL Imageå¯¹è±¡</span><span class="token keyword">print</span><span class="token punctuation">(</span>dataset<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># ç¬¬ä¸€ç»´æ˜¯ç¬¬å‡ å¼ å›¾ï¼Œç¬¬äºŒç»´ä¸º1è¿”å›label</span><span class="token keyword">print</span><span class="token punctuation">(</span>dataset<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># ä¸º0è¿”å›å›¾ç‰‡æ•°æ®</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°è¿è¡Œç»“æœï¼Œå°±æ˜¯ä¸€å¼ å›¾ç‰‡ï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211118130305.png" alt></p><p>è€Œæˆ‘ä»¬åŠ ä¸Štransformåï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># åŠ ä¸Štransform</span>normalize <span class="token operator">=</span> T<span class="token punctuation">.</span>Normalize<span class="token punctuation">(</span>mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>transform  <span class="token operator">=</span> T<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span><span class="token punctuation">[</span>         T<span class="token punctuation">.</span>RandomResizedCrop<span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">,</span>         T<span class="token punctuation">.</span>RandomHorizontalFlip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>         T<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>         normalize<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">)</span>dataset <span class="token operator">=</span> ImageFolder<span class="token punctuation">(</span><span class="token string">'data/dogcat_2/'</span><span class="token punctuation">,</span> transform<span class="token operator">=</span>transform<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># æ·±åº¦å­¦ä¹ ä¸­å›¾ç‰‡æ•°æ®ä¸€èˆ¬ä¿å­˜æˆCxHxWï¼Œå³é€šé“æ•°xå›¾ç‰‡é«˜xå›¾ç‰‡å®½</span><span class="token comment" spellcheck="true"># print(dataset[0][0].size())  # torch.Size([3, 224, 224])</span>to_img <span class="token operator">=</span> T<span class="token punctuation">.</span>ToPILImage<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 0.2å’Œ0.4æ˜¯æ ‡å‡†å·®å’Œå‡å€¼çš„è¿‘ä¼¼</span>to_img<span class="token punctuation">(</span>dataset<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">0.2</span><span class="token operator">+</span><span class="token number">0.4</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„è¿™é‡Œé¢ç»è¿‡transformåå·²ç»æ˜¯tensoräº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ˜¾ç¤ºå‡ºå›¾ç‰‡çš„è¯å¿…é¡»è¦ç”¨ç±»ToPILImageï¼Œç„¶åè¿™é‡Œå¦å¤–è¦æ³¨æ„ä¸€ç‚¹æ˜¯è¿™é‡Œé¢ç”±äºtransformåˆNormalizeçš„æ“ä½œæ‰€ä»¥æˆ‘ä»¬è¦å±•ç¤ºå‡ºåŸå›¾è¦åç€æ“ä½œå›æ¥ä¹Ÿå°±æ˜¯æ‰€è°“çš„ä¹˜ä»¥0.2åŠ ä¸Š0.4.</p><h3 id="about-some-transform"><a href="#about-some-transform" class="headerlink" title="about some transform"></a>about some transform</h3><p>é€šè¿‡ä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•è‡ªå®šä¹‰è‡ªå·±çš„æ•°æ®é›†ï¼Œå¹¶å¯ä»¥ä¾æ¬¡è·å–ã€‚ä½†è¿™é‡Œè¿”å›çš„æ•°æ®ä¸é€‚åˆå®é™…ä½¿ç”¨ï¼Œå› å…¶å…·æœ‰å¦‚ä¸‹ä¸¤æ–¹é¢é—®é¢˜ï¼š</p><ul><li>è¿”å›æ ·æœ¬çš„å½¢çŠ¶ä¸ä¸€ï¼Œå› æ¯å¼ å›¾ç‰‡çš„å¤§å°ä¸ä¸€æ ·ï¼Œè¿™å¯¹äºéœ€è¦å–batchè®­ç»ƒçš„ç¥ç»ç½‘ç»œæ¥è¯´å¾ˆä¸å‹å¥½</li><li>è¿”å›æ ·æœ¬çš„æ•°å€¼è¾ƒå¤§ï¼Œæœªå½’ä¸€åŒ–è‡³[-1, 1]</li></ul><p>é‚£ä¹ˆå®é™…ä¸Šæˆ‘ä»¬æ¥ä¸‹æ¥å°±torchvisionåº“æ’ä¸Šç”¨åœºäº†ï¼š<br>é’ˆå¯¹ä¸Šè¿°é—®é¢˜ï¼ŒPyTorchæä¾›äº†torchvision[^1]ã€‚å®ƒæ˜¯ä¸€ä¸ªè§†è§‰å·¥å…·åŒ…ï¼Œæä¾›äº†å¾ˆå¤šè§†è§‰å›¾åƒå¤„ç†çš„å·¥å…·ï¼Œå…¶ä¸­<code>transforms</code>æ¨¡å—æä¾›äº†å¯¹PIL <code>Image</code>å¯¹è±¡å’Œ<code>Tensor</code>å¯¹è±¡çš„å¸¸ç”¨æ“ä½œã€‚</p><p>æ³¨æ„è¿™é‡Œé¢å¯¹äºImage å’Œ PILçš„å¤„ç†æ–¹å¼åŒºåˆ«å’Œå¤§è‡´æ–¹å¼éœ€è¦å°½é‡ç†Ÿç»ƒæŒæ¡ï¼š</p><p>å¯¹PIL Imageçš„æ“ä½œåŒ…æ‹¬ï¼š</p><ul><li><code>Scale</code>ï¼šè°ƒæ•´å›¾ç‰‡å°ºå¯¸ï¼Œé•¿å®½æ¯”ä¿æŒä¸å˜</li><li><code>CenterCrop</code>ã€<code>RandomCrop</code>ã€<code>RandomResizedCrop</code>ï¼š è£å‰ªå›¾ç‰‡</li><li><code>Pad</code>ï¼šå¡«å……</li><li><code>ToTensor</code>ï¼šå°†PIL Imageå¯¹è±¡è½¬æˆTensorï¼Œä¼šè‡ªåŠ¨å°†[0, 255]å½’ä¸€åŒ–è‡³[0, 1]</li></ul><p>å¯¹Tensorçš„æ“ä½œåŒ…æ‹¬ï¼š</p><ul><li>Normalizeï¼šæ ‡å‡†åŒ–ï¼Œå³å‡å‡å€¼ï¼Œé™¤ä»¥æ ‡å‡†å·®</li><li>ToPILImageï¼šå°†Tensorè½¬ä¸ºPIL Imageå¯¹è±¡</li></ul><p>å¦‚æœè¦å¯¹å›¾ç‰‡è¿›è¡Œå¤šä¸ªæ“ä½œï¼Œå¯é€šè¿‡<code>Compose</code>å‡½æ•°å°†è¿™äº›æ“ä½œæ‹¼æ¥èµ·æ¥ï¼Œç±»ä¼¼äº<code>nn.Sequential</code>ã€‚æ³¨æ„ï¼Œè¿™äº›æ“ä½œå®šä¹‰åæ˜¯ä»¥å‡½æ•°çš„å½¢å¼å­˜åœ¨ï¼ŒçœŸæ­£ä½¿ç”¨æ—¶éœ€è°ƒç”¨å®ƒçš„<code>__call__</code>æ–¹æ³•ï¼Œè¿™ç‚¹ç±»ä¼¼äº<code>nn.Module</code>ã€‚ä¾‹å¦‚è¦å°†å›¾ç‰‡è°ƒæ•´ä¸º$224\times 224$ï¼Œé¦–å…ˆåº”æ„å»ºè¿™ä¸ªæ“ä½œ<code>trans = Resize((224, 224))</code>ï¼Œç„¶åè°ƒç”¨<code>trans(img)</code>ã€‚ä¸‹é¢æˆ‘ä»¬å°±ç”¨transformsçš„è¿™äº›æ“ä½œæ¥ä¼˜åŒ–ä¸Šé¢å®ç°çš„datasetã€‚<br>[^1]: <a href="https://github.com/pytorch/vision/" target="_blank" rel="noopener">https://github.com/pytorch/vision/</a></p><p>ç®€å•ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> os<span class="token keyword">from</span> PIL <span class="token keyword">import</span>  Image<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">from</span> torchvision <span class="token keyword">import</span> transforms <span class="token keyword">as</span> Ttransform <span class="token operator">=</span> T<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span><span class="token punctuation">[</span>    T<span class="token punctuation">.</span>Resize<span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># ç¼©æ”¾å›¾ç‰‡(Image)ï¼Œä¿æŒé•¿å®½æ¯”ä¸å˜ï¼Œæœ€çŸ­è¾¹ä¸º224åƒç´ </span>    T<span class="token punctuation">.</span>CenterCrop<span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># ä»å›¾ç‰‡ä¸­é—´åˆ‡å‡º224*224çš„å›¾ç‰‡</span>    T<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># å°†å›¾ç‰‡(Image)è½¬æˆTensorï¼Œå½’ä¸€åŒ–è‡³[0, 1]</span>    T<span class="token punctuation">.</span>Normalize<span class="token punctuation">(</span>mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># æ ‡å‡†åŒ–è‡³[-1, 1]ï¼Œè§„å®šå‡å€¼å’Œæ ‡å‡†å·®</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">DogCat</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>Dataset<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> root<span class="token punctuation">,</span> transforms<span class="token operator">=</span>None<span class="token punctuation">)</span><span class="token punctuation">:</span>        imgs <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>root<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>imgs <span class="token operator">=</span> <span class="token punctuation">[</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>root<span class="token punctuation">,</span> img<span class="token punctuation">)</span> <span class="token keyword">for</span> img <span class="token keyword">in</span> imgs<span class="token punctuation">]</span>        self<span class="token punctuation">.</span>transforms<span class="token operator">=</span>transforms    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">:</span>        img_path <span class="token operator">=</span> self<span class="token punctuation">.</span>imgs<span class="token punctuation">[</span>index<span class="token punctuation">]</span>        label <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">if</span> <span class="token string">'dog'</span> <span class="token keyword">in</span> img_path<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">else</span> <span class="token number">1</span>        data <span class="token operator">=</span> Image<span class="token punctuation">.</span>open<span class="token punctuation">(</span>img_path<span class="token punctuation">)</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>transforms<span class="token punctuation">:</span>            data <span class="token operator">=</span> self<span class="token punctuation">.</span>transforms<span class="token punctuation">(</span>data<span class="token punctuation">)</span>        <span class="token keyword">return</span> data<span class="token punctuation">,</span> label    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> len<span class="token punctuation">(</span>self<span class="token punctuation">.</span>imgs<span class="token punctuation">)</span>dataset <span class="token operator">=</span> DogCat<span class="token punctuation">(</span><span class="token string">'./data/dogcat/'</span><span class="token punctuation">,</span> transforms<span class="token operator">=</span>transform<span class="token punctuation">)</span>img<span class="token punctuation">,</span> label <span class="token operator">=</span> dataset<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">for</span> img<span class="token punctuation">,</span> label <span class="token keyword">in</span> dataset<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>img<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> label<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæ³¨æ„<code>ToTensor()</code>æ“ä½œå°±ç›´æ¥å°†å›¾ç‰‡Tensorå½’ä¸€åŒ–ä¸º[0, 1]ä¹‹é—´çš„å¤§å°ï¼Œå°±æ›´åŠ æ–¹ä¾¿æˆ‘ä»¬å¤„ç†ã€‚å¦å¤–å¯¹äºTensorè¿›è¡Œä¸€ä¸ªNormalizeè°ƒæ•´ä¸€ä¸‹åˆ†å¸ƒæ–¹ä¾¿è®­ç»ƒã€‚æ³¨æ„å¼ é‡è½¬ä¸ºå›¾ç‰‡åªéœ€è¦<code>ToPILImage()</code>æ“ä½œã€‚ä¹Ÿéå¸¸ç®€å•ã€‚</p><p>é™¤äº†ä¸Šè¿°æ“ä½œä¹‹å¤–ï¼Œtransformsè¿˜å¯é€šè¿‡<code>Lambda</code>å°è£…è‡ªå®šä¹‰çš„è½¬æ¢ç­–ç•¥ã€‚ä¾‹å¦‚æƒ³å¯¹PIL Imageè¿›è¡Œéšæœºæ—‹è½¬ï¼Œåˆ™å¯å†™æˆè¿™æ ·<code>trans=T.Lambda(lambda img: img.rotate(random()*360))</code>ã€‚</p><p>è¿™é‡Œä¸ä¼šç»§ç»­å±•å¼€è®²äº†ï¼Œæ€»ä¹‹è®°å¾—pytorchçš„torchvision.transformsè¿™ä¸ªæ¨¡å—æœ‰ç€éå¸¸å¤šçš„å›¾ç‰‡é¢„å¤„ç†æ“ä½œå³å¯ã€‚</p><p>å¦å¤–å¦‚æœæƒ³è¦å¾—åˆ°æ›´å¤šå…³äºtransformçš„æ“ä½œï¼Œæœ€å¥½çœ‹ä¾‹å­ï¼Œå¯ä»¥åˆ°è¿™ä¸ªç½‘ç«™<a href="https://www.programcreek.com/python/example/104832/torchvision.transforms.Compose" target="_blank" rel="noopener">^2</a>æ¥æ‰¾ã€‚</p><h3 id="the-intro-of-torch-utils-data-DataLoader"><a href="#the-intro-of-torch-utils-data-DataLoader" class="headerlink" title="the intro of torch.utils.data.DataLoader"></a>the intro of torch.utils.data.DataLoader</h3><h4 id="write-a-demo-of-DataLoader"><a href="#write-a-demo-of-DataLoader" class="headerlink" title="write a demo of DataLoader"></a>write a demo of DataLoader</h4><p><code>Dataset</code>åªè´Ÿè´£æ•°æ®çš„æŠ½è±¡ï¼Œä¸€æ¬¡è°ƒç”¨<code>__getitem__</code>åªè¿”å›ä¸€ä¸ªæ ·æœ¬ã€‚å‰é¢æåˆ°è¿‡ï¼Œåœ¨è®­ç»ƒç¥ç»ç½‘ç»œæ—¶ï¼Œæœ€å¥½æ˜¯å¯¹ä¸€ä¸ªbatchçš„æ•°æ®è¿›è¡Œæ“ä½œï¼ŒåŒæ—¶è¿˜éœ€è¦å¯¹æ•°æ®è¿›è¡Œshuffleå’Œå¹¶è¡ŒåŠ é€Ÿç­‰ã€‚å¯¹æ­¤ï¼ŒPyTorchæä¾›äº†<code>DataLoader</code>å¸®åŠ©æˆ‘ä»¬å®ç°è¿™äº›åŠŸèƒ½ã€‚</p><p>DataLoaderçš„å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š<br><code>DataLoader(dataset, batch_size=1, shuffle=False, sampler=None, num_workers=0, collate_fn=default_collate, pin_memory=False, drop_last=False)</code></p><ul><li>datasetï¼šåŠ è½½çš„æ•°æ®é›†(Datasetå¯¹è±¡)</li><li>batch_sizeï¼šbatch size</li><li>shuffle:ï¼šæ˜¯å¦å°†æ•°æ®æ‰“ä¹±</li><li>samplerï¼š æ ·æœ¬æŠ½æ ·ï¼Œåç»­ä¼šè¯¦ç»†ä»‹ç»</li><li>num_workersï¼šä½¿ç”¨å¤šè¿›ç¨‹åŠ è½½çš„è¿›ç¨‹æ•°ï¼Œ0ä»£è¡¨ä¸ä½¿ç”¨å¤šè¿›ç¨‹</li><li>collate_fnï¼š å¦‚ä½•å°†å¤šä¸ªæ ·æœ¬æ•°æ®æ‹¼æ¥æˆä¸€ä¸ªbatchï¼Œä¸€èˆ¬ä½¿ç”¨é»˜è®¤çš„æ‹¼æ¥æ–¹å¼å³å¯</li><li>pin_memoryï¼šæ˜¯å¦å°†æ•°æ®ä¿å­˜åœ¨pin memoryåŒºï¼Œpin memoryä¸­çš„æ•°æ®è½¬åˆ°GPUä¼šå¿«ä¸€äº›</li><li>drop_lastï¼šdatasetä¸­çš„æ•°æ®ä¸ªæ•°å¯èƒ½ä¸æ˜¯batch_sizeçš„æ•´æ•°å€ï¼Œdrop_lastä¸ºTrueä¼šå°†å¤šå‡ºæ¥ä¸è¶³ä¸€ä¸ªbatchçš„æ•°æ®ä¸¢å¼ƒ</li></ul><p>æˆ‘ä»¬åŠ è½½æ•°æ®é å¾—å…¶å®æ˜¯DataLoaderï¼Œå®é™…ä¸ŠDatasetä»…ä»…æ˜¯ä¸€ä¸ªæ•´ä½“çš„æ•°æ®æŠ½è±¡ï¼ŒçœŸæ­£è¯»å–åŠ è½½è¿˜æ˜¯DataLoaderï¼Œè¿™é‡Œå®é™…ä¸Špytorchåˆ†å·¥è®¾è®¡çš„è¿˜æ˜¯éå¸¸ä¸¥æ ¼å’Œç²¾ç»†ã€‚</p><p>æˆ‘ä»¬æ•°æ®çš„è¯»å–ä¸ºï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data <span class="token keyword">import</span> DataLoaderdataloader <span class="token operator">=</span> DataLoader<span class="token punctuation">(</span>dataset<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> num_workers<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> drop_last<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>dataiter <span class="token operator">=</span> iter<span class="token punctuation">(</span>dataloader<span class="token punctuation">)</span>imgs<span class="token punctuation">,</span> labels <span class="token operator">=</span> next<span class="token punctuation">(</span>dataiter<span class="token punctuation">)</span>imgs<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># batch_size, channel, height, weight # torch.Size([3, 3, 224, 224])</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>dataloaderæ˜¯ä¸€ä¸ªå¯è¿­ä»£çš„å¯¹è±¡ï¼Œæ„å‘³ç€æˆ‘ä»¬å¯ä»¥åƒä½¿ç”¨è¿­ä»£å™¨ä¸€æ ·ä½¿ç”¨å®ƒï¼Œä¾‹å¦‚ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">for</span> batch_datas<span class="token punctuation">,</span> batch_labels <span class="token keyword">in</span> dataloader<span class="token punctuation">:</span>    train<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æˆ–</p><pre class="line-numbers language-python"><code class="language-python">dataiter <span class="token operator">=</span> iter<span class="token punctuation">(</span>dataloader<span class="token punctuation">)</span>batch_datas<span class="token punctuation">,</span> batch_labesl <span class="token operator">=</span> next<span class="token punctuation">(</span>dataiter<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h5 id="collate-fn-make-the-fake-data-out"><a href="#collate-fn-make-the-fake-data-out" class="headerlink" title="collate_fn: make the fake data out."></a>collate_fn: make the fake data out.</h5><p>åœ¨æ•°æ®å¤„ç†ä¸­ï¼Œæœ‰æ—¶ä¼šå‡ºç°æŸä¸ªæ ·æœ¬æ— æ³•è¯»å–ç­‰é—®é¢˜ï¼Œæ¯”å¦‚æŸå¼ å›¾ç‰‡æŸåã€‚è¿™æ—¶åœ¨<code>__getitem__</code>å‡½æ•°ä¸­å°†å‡ºç°å¼‚å¸¸ï¼Œæ­¤æ—¶æœ€å¥½çš„è§£å†³æ–¹æ¡ˆå³æ˜¯å°†å‡ºé”™çš„æ ·æœ¬å‰”é™¤ã€‚å¦‚æœå®åœ¨æ˜¯é‡åˆ°è¿™ç§æƒ…å†µæ— æ³•å¤„ç†ï¼Œåˆ™å¯ä»¥è¿”å›Noneå¯¹è±¡ï¼Œç„¶ååœ¨<code>Dataloader</code>ä¸­å®ç°è‡ªå®šä¹‰çš„<code>collate_fn</code>ï¼Œå°†ç©ºå¯¹è±¡è¿‡æ»¤æ‰ã€‚<strong>ä½†è¦æ³¨æ„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹dataloaderè¿”å›çš„batchæ•°ç›®ä¼šå°‘äºbatch_size</strong>ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">NewDogCat</span><span class="token punctuation">(</span>DogCat<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># ç»§æ‰¿å‰é¢å®ç°çš„DogCatæ•°æ®é›†</span>    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            <span class="token comment" spellcheck="true"># è°ƒç”¨çˆ¶ç±»çš„è·å–å‡½æ•°ï¼Œå³ DogCat.__getitem__(self, index)</span>            <span class="token keyword">return</span> super<span class="token punctuation">(</span>NewDogCat<span class="token punctuation">,</span>self<span class="token punctuation">)</span><span class="token punctuation">.</span>__getitem__<span class="token punctuation">(</span>index<span class="token punctuation">)</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> None<span class="token punctuation">,</span> None<span class="token keyword">from</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>dataloader <span class="token keyword">import</span> default_collate <span class="token comment" spellcheck="true"># å¯¼å…¥é»˜è®¤çš„æ‹¼æ¥æ–¹å¼</span><span class="token keyword">def</span> <span class="token function">my_collate_fn</span><span class="token punctuation">(</span>batch<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">'''    batchä¸­æ¯ä¸ªå…ƒç´ å½¢å¦‚(data, label)    '''</span>    <span class="token comment" spellcheck="true"># è¿‡æ»¤ä¸ºNoneçš„æ•°æ®</span>    batch <span class="token operator">=</span> list<span class="token punctuation">(</span>filter<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">is</span> <span class="token operator">not</span> None<span class="token punctuation">,</span> batch<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> len<span class="token punctuation">(</span>batch<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token keyword">return</span> t<span class="token punctuation">.</span>Tensor<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> default_collate<span class="token punctuation">(</span>batch<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># ç”¨é»˜è®¤æ–¹å¼æ‹¼æ¥è¿‡æ»¤åçš„batchæ•°æ®</span>dataset <span class="token operator">=</span> NewDogCat<span class="token punctuation">(</span><span class="token string">'data/dogcat_wrong/'</span><span class="token punctuation">,</span> transforms<span class="token operator">=</span>transform<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>dataset<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»“æœä¸ºï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token punctuation">(</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">3.0000</span><span class="token punctuation">,</span>  <span class="token number">3.0000</span><span class="token punctuation">,</span>  <span class="token number">3.0000</span><span class="token punctuation">,</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">2.5490</span><span class="token punctuation">,</span>  <span class="token number">2.6471</span><span class="token punctuation">,</span>  <span class="token number">2.7059</span><span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token punctuation">[</span> <span class="token number">3.0000</span><span class="token punctuation">,</span>  <span class="token number">3.0000</span><span class="token punctuation">,</span>  <span class="token number">3.0000</span><span class="token punctuation">,</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">2.5686</span><span class="token punctuation">,</span>  <span class="token number">2.6471</span><span class="token punctuation">,</span>  <span class="token number">2.7059</span><span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token punctuation">[</span> <span class="token number">2.9804</span><span class="token punctuation">,</span>  <span class="token number">3.0000</span><span class="token punctuation">,</span>  <span class="token number">3.0000</span><span class="token punctuation">,</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">2.5686</span><span class="token punctuation">,</span>  <span class="token number">2.6471</span><span class="token punctuation">,</span>  <span class="token number">2.6863</span><span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>          <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.9020</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.8627</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.8235</span><span class="token punctuation">,</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">0.0392</span><span class="token punctuation">,</span>  <span class="token number">0.2745</span><span class="token punctuation">,</span>  <span class="token number">0.4314</span><span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.9216</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.8824</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.8235</span><span class="token punctuation">,</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">0.0588</span><span class="token punctuation">,</span>  <span class="token number">0.2745</span><span class="token punctuation">,</span>  <span class="token number">0.4314</span><span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.9412</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.9020</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.8431</span><span class="token punctuation">,</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">0.0980</span><span class="token punctuation">,</span>  <span class="token number">0.3137</span><span class="token punctuation">,</span>  <span class="token number">0.4510</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>         <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">3.0000</span><span class="token punctuation">,</span>  <span class="token number">2.9608</span><span class="token punctuation">,</span>  <span class="token number">2.8824</span><span class="token punctuation">,</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">2.5294</span><span class="token punctuation">,</span>  <span class="token number">2.6275</span><span class="token punctuation">,</span>  <span class="token number">2.6863</span><span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token punctuation">[</span> <span class="token number">3.0000</span><span class="token punctuation">,</span>  <span class="token number">2.9804</span><span class="token punctuation">,</span>  <span class="token number">2.9216</span><span class="token punctuation">,</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">2.5098</span><span class="token punctuation">,</span>  <span class="token number">2.6275</span><span class="token punctuation">,</span>  <span class="token number">2.6863</span><span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token punctuation">[</span> <span class="token number">3.0000</span><span class="token punctuation">,</span>  <span class="token number">2.9804</span><span class="token punctuation">,</span>  <span class="token number">2.9608</span><span class="token punctuation">,</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">2.5098</span><span class="token punctuation">,</span>  <span class="token number">2.6078</span><span class="token punctuation">,</span>  <span class="token number">2.6667</span><span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>          <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1.0392</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0000</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.9608</span><span class="token punctuation">,</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.0196</span><span class="token punctuation">,</span>  <span class="token number">0.1961</span><span class="token punctuation">,</span>  <span class="token number">0.3333</span><span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1.0392</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0000</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.9608</span><span class="token punctuation">,</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">0.0000</span><span class="token punctuation">,</span>  <span class="token number">0.1961</span><span class="token punctuation">,</span>  <span class="token number">0.3333</span><span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1.0392</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0196</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.9804</span><span class="token punctuation">,</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">0.0392</span><span class="token punctuation">,</span>  <span class="token number">0.2353</span><span class="token punctuation">,</span>  <span class="token number">0.3529</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>         <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">2.1765</span><span class="token punctuation">,</span>  <span class="token number">2.1961</span><span class="token punctuation">,</span>  <span class="token number">2.2157</span><span class="token punctuation">,</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">1.5882</span><span class="token punctuation">,</span>  <span class="token number">1.6863</span><span class="token punctuation">,</span>  <span class="token number">1.7451</span><span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token punctuation">[</span> <span class="token number">2.2157</span><span class="token punctuation">,</span>  <span class="token number">2.2157</span><span class="token punctuation">,</span>  <span class="token number">2.2353</span><span class="token punctuation">,</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">1.6078</span><span class="token punctuation">,</span>  <span class="token number">1.7255</span><span class="token punctuation">,</span>  <span class="token number">1.7843</span><span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token punctuation">[</span> <span class="token number">2.2157</span><span class="token punctuation">,</span>  <span class="token number">2.2353</span><span class="token punctuation">,</span>  <span class="token number">2.2549</span><span class="token punctuation">,</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">1.6667</span><span class="token punctuation">,</span>  <span class="token number">1.7647</span><span class="token punctuation">,</span>  <span class="token number">1.8235</span><span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>          <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1.4118</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.3725</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.3333</span><span class="token punctuation">,</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5098</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.3922</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.2941</span><span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1.4118</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.3725</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.3333</span><span class="token punctuation">,</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.4902</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.3725</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.2941</span><span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1.4314</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.3922</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.3529</span><span class="token punctuation">,</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.4510</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.3333</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.2745</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬ç»§ç»­è¿è¡Œï¼š</p><pre class="line-numbers language-python"><code class="language-python">dataloader <span class="token operator">=</span> DataLoader<span class="token punctuation">(</span>dataset<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> collate_fn<span class="token operator">=</span>my_collate_fn<span class="token punctuation">,</span> num_workers<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token keyword">for</span> batch_datas<span class="token punctuation">,</span> batch_labels <span class="token keyword">in</span> dataloader<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>batch_datas<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>batch_labels<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥å¾—åˆ°ï¼š</p><pre class="line-numbers language-python"><code class="language-python">torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">]</span><span class="token punctuation">)</span> torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">]</span><span class="token punctuation">)</span> torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">]</span><span class="token punctuation">)</span> torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">]</span><span class="token punctuation">)</span> torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">]</span><span class="token punctuation">)</span> torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹å‡ºå…¶ä¸­åˆçš„batch_size=1,æ¥çœ‹ä¸€ä¸‹ä¸Šè¿°batch_sizeçš„å¤§å°ã€‚å…¶ä¸­ç¬¬2ä¸ªçš„batch_sizeä¸º1ï¼Œè¿™æ˜¯å› ä¸ºæœ‰ä¸€å¼ å›¾ç‰‡æŸåï¼Œå¯¼è‡´å…¶æ— æ³•æ­£å¸¸è¿”å›ã€‚è€Œæœ€å1ä¸ªçš„batch_sizeä¹Ÿä¸º1ï¼Œè¿™æ˜¯å› ä¸ºå…±æœ‰9å¼ ï¼ˆåŒ…æ‹¬æŸåçš„æ–‡ä»¶ï¼‰å›¾ç‰‡ï¼Œæ— æ³•æ•´é™¤2ï¼ˆbatch_sizeï¼‰ï¼Œå› æ­¤æœ€åä¸€ä¸ªbatchçš„æ•°æ®ä¼šå°‘äºbatch_szieï¼Œå¯é€šè¿‡æŒ‡å®š<code>drop_last=True</code>æ¥ä¸¢å¼ƒæœ€åä¸€ä¸ªä¸è¶³batch_sizeçš„batchã€‚</p><h4 id="multiprocessing"><a href="#multiprocessing" class="headerlink" title="multiprocessing"></a>multiprocessing</h4><p>DataLoaderé‡Œé¢å¹¶æ²¡æœ‰å¤ªå¤šçš„é­”æ³•æ–¹æ³•ï¼Œå®ƒå°è£…äº†Pythonçš„æ ‡å‡†åº“<code>multiprocessing</code>ï¼Œä½¿å…¶èƒ½å¤Ÿå®ç°å¤šè¿›ç¨‹åŠ é€Ÿã€‚åœ¨æ­¤æå‡ ç‚¹å…³äºDatasetå’ŒDataLoaderä½¿ç”¨æ–¹é¢çš„å»ºè®®ï¼š</p><ol><li>é«˜è´Ÿè½½çš„æ“ä½œæ”¾åœ¨<code>__getitem__</code>ä¸­ï¼Œå¦‚åŠ è½½å›¾ç‰‡ç­‰ã€‚</li><li>datasetä¸­åº”å°½é‡åªåŒ…å«åªè¯»å¯¹è±¡ï¼Œé¿å…ä¿®æ”¹ä»»ä½•å¯å˜å¯¹è±¡ï¼Œåˆ©ç”¨å¤šçº¿ç¨‹è¿›è¡Œæ“ä½œã€‚</li></ol><p>ç¬¬ä¸€ç‚¹æ˜¯å› ä¸ºå¤šè¿›ç¨‹ä¼šå¹¶è¡Œçš„è°ƒç”¨<code>__getitem__</code>å‡½æ•°ï¼Œå°†è´Ÿè½½é«˜çš„æ”¾åœ¨<code>__getitem__</code>å‡½æ•°ä¸­èƒ½å¤Ÿå®ç°å¹¶è¡ŒåŠ é€Ÿã€‚<br>ç¬¬äºŒç‚¹æ˜¯å› ä¸ºdataloaderä½¿ç”¨å¤šè¿›ç¨‹åŠ è½½ï¼Œå¦‚æœåœ¨<code>Dataset</code>å®ç°ä¸­ä½¿ç”¨äº†å¯å˜å¯¹è±¡ï¼Œå¯èƒ½ä¼šæœ‰æ„æƒ³ä¸åˆ°çš„å†²çªã€‚åœ¨å¤šçº¿ç¨‹/å¤šè¿›ç¨‹ä¸­ï¼Œä¿®æ”¹ä¸€ä¸ªå¯å˜å¯¹è±¡ï¼Œéœ€è¦åŠ é”ï¼Œä½†æ˜¯dataloaderçš„è®¾è®¡ä½¿å¾—å…¶å¾ˆéš¾åŠ é”ï¼ˆåœ¨å®é™…ä½¿ç”¨ä¸­ä¹Ÿåº”å°½é‡é¿å…é”çš„å­˜åœ¨ï¼‰ï¼Œå› æ­¤æœ€å¥½é¿å…åœ¨datasetä¸­ä¿®æ”¹å¯å˜å¯¹è±¡ã€‚ä¾‹å¦‚ä¸‹é¢å°±æ˜¯ä¸€ä¸ªä¸å¥½çš„ä¾‹å­ï¼Œåœ¨å¤šè¿›ç¨‹å¤„ç†ä¸­<code>self.num</code>å¯èƒ½ä¸é¢„æœŸä¸ç¬¦ï¼Œè¿™ç§é—®é¢˜ä¸ä¼šæŠ¥é”™ï¼Œå› æ­¤éš¾ä»¥å‘ç°ã€‚å¦‚æœä¸€å®šè¦ä¿®æ”¹å¯å˜å¯¹è±¡ï¼Œå»ºè®®ä½¿ç”¨Pythonæ ‡å‡†åº“<code>Queue</code>ä¸­çš„ç›¸å…³æ•°æ®ç»“æ„ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">BadDataset</span><span class="token punctuation">(</span>Dataset<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>datas <span class="token operator">=</span> range<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>num <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment" spellcheck="true"># å–æ•°æ®çš„æ¬¡æ•°</span>    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>num <span class="token operator">+=</span> <span class="token number">1</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>datas<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨Python <code>multiprocessing</code>åº“çš„å¦ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œåœ¨ä½¿ç”¨å¤šè¿›ç¨‹æ—¶ï¼Œå¦‚æœä¸»ç¨‹åºå¼‚å¸¸ç»ˆæ­¢ï¼ˆæ¯”å¦‚ç”¨Ctrl+Cå¼ºè¡Œé€€å‡ºï¼‰ï¼Œç›¸åº”çš„æ•°æ®åŠ è½½è¿›ç¨‹å¯èƒ½æ— æ³•æ­£å¸¸é€€å‡ºã€‚è¿™æ—¶ä½ å¯èƒ½ä¼šå‘ç°ç¨‹åºå·²ç»é€€å‡ºäº†ï¼Œä½†GPUæ˜¾å­˜å’Œå†…å­˜ä¾æ—§è¢«å ç”¨ç€ï¼Œæˆ–é€šè¿‡<code>top</code>ã€<code>ps aux</code>ä¾æ—§èƒ½å¤Ÿçœ‹åˆ°å·²ç»é€€å‡ºçš„ç¨‹åºï¼Œè¿™æ—¶å°±éœ€è¦æ‰‹åŠ¨å¼ºè¡Œæ€æ‰è¿›ç¨‹ã€‚å»ºè®®ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š</p><pre><code>ps x | grep &lt;cmdline&gt; | awk &#39;{print $1}&#39; | xargs kill</code></pre><ul><li><code>ps x</code>ï¼šè·å–å½“å‰ç”¨æˆ·çš„æ‰€æœ‰è¿›ç¨‹</li><li><code>grep &lt;cmdline&gt;</code>ï¼šæ‰¾åˆ°å·²ç»åœæ­¢çš„PyTorchç¨‹åºçš„è¿›ç¨‹ï¼Œä¾‹å¦‚ä½ æ˜¯é€šè¿‡python train.pyå¯åŠ¨çš„ï¼Œé‚£ä½ å°±éœ€è¦å†™<code>grep &#39;python train.py&#39;</code></li><li><code>awk &#39;{print $1}&#39;</code>ï¼šè·å–è¿›ç¨‹çš„pid</li><li><code>xargs kill</code>ï¼šæ€æ‰è¿›ç¨‹ï¼Œæ ¹æ®éœ€è¦å¯èƒ½è¦å†™æˆ<code>xargs kill -9</code>å¼ºåˆ¶æ€æ‰è¿›ç¨‹</li></ul><p>åœ¨æ‰§è¡Œè¿™å¥å‘½ä»¤ä¹‹å‰ï¼Œå»ºè®®å…ˆæ‰“å°ç¡®è®¤ä¸€ä¸‹æ˜¯å¦ä¼šè¯¯æ€å…¶å®ƒè¿›ç¨‹</p><pre><code>ps x | grep &lt;cmdline&gt; | ps x</code></pre><h3 id="Sampler"><a href="#Sampler" class="headerlink" title="Sampler"></a>Sampler</h3><p>PyTorchä¸­è¿˜å•ç‹¬æä¾›äº†ä¸€ä¸ª<code>sampler</code>æ¨¡å—ï¼Œç”¨æ¥å¯¹æ•°æ®è¿›è¡Œé‡‡æ ·ã€‚å¸¸ç”¨çš„æœ‰éšæœºé‡‡æ ·å™¨ï¼š<code>RandomSampler</code>ï¼Œå½“dataloaderçš„<code>shuffle</code>å‚æ•°ä¸ºTrueæ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è°ƒç”¨è¿™ä¸ªé‡‡æ ·å™¨ï¼Œå®ç°æ‰“ä¹±æ•°æ®ã€‚é»˜è®¤çš„æ˜¯é‡‡ç”¨<code>SequentialSampler</code>ï¼Œå®ƒä¼šæŒ‰é¡ºåºä¸€ä¸ªä¸€ä¸ªè¿›è¡Œé‡‡æ ·ã€‚è¿™é‡Œä»‹ç»å¦å¤–ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„é‡‡æ ·æ–¹æ³•ï¼š<br><code>WeightedRandomSampler</code>ï¼Œå®ƒä¼šæ ¹æ®æ¯ä¸ªæ ·æœ¬çš„æƒé‡é€‰å–æ•°æ®ï¼Œåœ¨æ ·æœ¬æ¯”ä¾‹ä¸å‡è¡¡çš„é—®é¢˜ä¸­ï¼Œå¯ç”¨å®ƒæ¥è¿›è¡Œé‡é‡‡æ ·ã€‚</p><p>æ„å»º<code>WeightedRandomSampler</code>æ—¶éœ€æä¾›ä¸¤ä¸ªå‚æ•°ï¼šæ¯ä¸ªæ ·æœ¬çš„æƒé‡<code>weights</code>ã€å…±é€‰å–çš„æ ·æœ¬æ€»æ•°<code>num_samples</code>ï¼Œä»¥åŠä¸€ä¸ªå¯é€‰å‚æ•°<code>replacement</code>ã€‚æƒé‡è¶Šå¤§çš„æ ·æœ¬è¢«é€‰ä¸­çš„æ¦‚ç‡è¶Šå¤§ï¼Œå¾…é€‰å–çš„æ ·æœ¬æ•°ç›®ä¸€èˆ¬å°äºå…¨éƒ¨çš„æ ·æœ¬æ•°ç›®ã€‚<code>replacement</code>ç”¨äºæŒ‡å®šæ˜¯å¦å¯ä»¥é‡å¤é€‰å–æŸä¸€ä¸ªæ ·æœ¬ï¼Œé»˜è®¤ä¸ºTrueï¼Œå³å…è®¸åœ¨ä¸€ä¸ªepochä¸­é‡å¤é‡‡æ ·æŸä¸€ä¸ªæ•°æ®ã€‚å¦‚æœè®¾ä¸ºFalseï¼Œåˆ™å½“æŸä¸€ç±»çš„æ ·æœ¬è¢«å…¨éƒ¨é€‰å–å®Œï¼Œä½†å…¶æ ·æœ¬æ•°ç›®ä»æœªè¾¾åˆ°num_samplesæ—¶ï¼Œsamplerå°†ä¸ä¼šå†ä»è¯¥ç±»ä¸­é€‰æ‹©æ•°æ®ï¼Œæ­¤æ—¶å¯èƒ½å¯¼è‡´<code>weights</code>å‚æ•°å¤±æ•ˆã€‚ä¸‹é¢ä¸¾ä¾‹è¯´æ˜ã€‚</p><pre class="line-numbers language-python"><code class="language-python">dataset <span class="token operator">=</span> DogCat<span class="token punctuation">(</span><span class="token string">'data/dogcat/'</span><span class="token punctuation">,</span> transforms<span class="token operator">=</span>transform<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># ç‹—çš„å›¾ç‰‡è¢«å–å‡ºçš„æ¦‚ç‡æ˜¯çŒ«çš„æ¦‚ç‡çš„ä¸¤å€</span><span class="token comment" spellcheck="true"># ä¸¤ç±»å›¾ç‰‡è¢«å–å‡ºçš„æ¦‚ç‡ä¸weightsçš„ç»å¯¹å¤§å°æ— å…³ï¼Œåªå’Œæ¯”å€¼æœ‰å…³</span>weights <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span> <span class="token keyword">if</span> label <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token number">1</span> <span class="token keyword">for</span> data<span class="token punctuation">,</span> label <span class="token keyword">in</span> dataset<span class="token punctuation">]</span>weights<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºä¸ºï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ¥ç€ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>sampler <span class="token keyword">import</span>  WeightedRandomSamplersampler <span class="token operator">=</span> WeightedRandomSampler<span class="token punctuation">(</span>weights<span class="token punctuation">,</span>\                                num_samples<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">,</span>\                                replacement<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>dataloader <span class="token operator">=</span> DataLoader<span class="token punctuation">(</span>dataset<span class="token punctuation">,</span>                        batch_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>                        sampler<span class="token operator">=</span>sampler<span class="token punctuation">)</span><span class="token keyword">for</span> datas<span class="token punctuation">,</span> labels <span class="token keyword">in</span> dataloader<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>labels<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬å¾—åˆ°ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¯è§çŒ«ç‹—æ ·æœ¬æ¯”ä¾‹çº¦ä¸º1:2ï¼Œå¦å¤–ä¸€å…±åªæœ‰8ä¸ªæ ·æœ¬ï¼Œä½†æ˜¯å´è¿”å›äº†9ä¸ªï¼Œè¯´æ˜è‚¯å®šæœ‰è¢«é‡å¤è¿”å›çš„ï¼Œè¿™å°±æ˜¯replacementå‚æ•°çš„ä½œç”¨ï¼Œä¸‹é¢å°†replacementè®¾ä¸ºFalseè¯•è¯•ã€‚</p><pre class="line-numbers language-python"><code class="language-python">sampler <span class="token operator">=</span> WeightedRandomSampler<span class="token punctuation">(</span>weights<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> replacement<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>dataloader <span class="token operator">=</span> DataLoader<span class="token punctuation">(</span>dataset<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> sampler<span class="token operator">=</span>sampler<span class="token punctuation">)</span><span class="token keyword">for</span> datas<span class="token punctuation">,</span> labels <span class="token keyword">in</span> dataloader<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>labels<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å°±å¾—åˆ°ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œnum_samplesç­‰äºdatasetçš„æ ·æœ¬æ€»æ•°ï¼Œä¸ºäº†ä¸é‡å¤é€‰å–ï¼Œsamplerä¼šå°†æ¯ä¸ªæ ·æœ¬éƒ½è¿”å›ï¼Œè¿™æ ·å°±å¤±å»weightå‚æ•°çš„æ„ä¹‰äº†ã€‚</p><p>ä»ä¸Šé¢çš„ä¾‹å­å¯è§sampleråœ¨æ ·æœ¬é‡‡æ ·ä¸­çš„ä½œç”¨ï¼šå¦‚æœæŒ‡å®šäº†samplerï¼Œshuffleå°†ä¸å†ç”Ÿæ•ˆï¼Œå¹¶ä¸”sampler.num_samplesä¼šè¦†ç›–datasetçš„å®é™…å¤§å°ï¼Œå³ä¸€ä¸ªepochè¿”å›çš„å›¾ç‰‡æ€»æ•°å–å†³äº<code>sampler.num_samples</code>ã€‚</p><h2 id="Simple-Intro-of-Torchivision"><a href="#Simple-Intro-of-Torchivision" class="headerlink" title="Simple Intro of Torchivision"></a>Simple Intro of Torchivision</h2><h3 id="Preface-1"><a href="#Preface-1" class="headerlink" title="Preface"></a>Preface</h3><p>è®¡ç®—æœºè§†è§‰æ˜¯æ·±åº¦å­¦ä¹ ä¸­æœ€é‡è¦çš„ä¸€ç±»åº”ç”¨ï¼Œä¸ºäº†æ–¹ä¾¿ç ”ç©¶è€…ä½¿ç”¨ï¼ŒPyTorchå›¢é˜Ÿä¸“é—¨å¼€å‘äº†ä¸€ä¸ªè§†è§‰å·¥å…·åŒ…<code>torchvion</code>ï¼Œè¿™ä¸ªåŒ…ç‹¬ç«‹äºPyTorchï¼Œéœ€é€šè¿‡<code>pip instal torchvision</code>å®‰è£…ã€‚åœ¨ä¹‹å‰çš„ä¾‹å­ä¸­æˆ‘ä»¬å·²ç»è§è¯†åˆ°äº†å®ƒçš„éƒ¨åˆ†åŠŸèƒ½ï¼Œè¿™é‡Œå†åšä¸€ä¸ªç³»ç»Ÿæ€§çš„ä»‹ç»ã€‚torchvisionä¸»è¦åŒ…å«ä¸‰éƒ¨åˆ†ï¼š</p><ul><li>modelsï¼šæä¾›æ·±åº¦å­¦ä¹ ä¸­å„ç§ç»å…¸ç½‘ç»œçš„ç½‘ç»œç»“æ„ä»¥åŠé¢„è®­ç»ƒå¥½çš„æ¨¡å‹ï¼ŒåŒ…æ‹¬<code>AlexNet</code>ã€VGGç³»åˆ—ã€ResNetç³»åˆ—ã€Inceptionç³»åˆ—ç­‰ã€‚</li><li>datasetsï¼š æä¾›å¸¸ç”¨çš„æ•°æ®é›†åŠ è½½ï¼Œè®¾è®¡ä¸Šéƒ½æ˜¯ç»§æ‰¿<code>torhc.utils.data.Dataset</code>ï¼Œä¸»è¦åŒ…æ‹¬<code>MNIST</code>ã€<code>CIFAR10/100</code>ã€<code>ImageNet</code>ã€<code>COCO</code>ç­‰ã€‚</li><li>transformsï¼šæä¾›å¸¸ç”¨çš„æ•°æ®é¢„å¤„ç†æ“ä½œï¼Œä¸»è¦åŒ…æ‹¬å¯¹Tensorä»¥åŠPIL Imageå¯¹è±¡çš„æ“ä½œã€‚</li></ul><h3 id="models"><a href="#models" class="headerlink" title="models"></a>models</h3><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> torchvision <span class="token keyword">import</span> models<span class="token keyword">from</span> torch <span class="token keyword">import</span> nn<span class="token comment" spellcheck="true"># åŠ è½½é¢„è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œå¦‚æœä¸å­˜åœ¨ä¼šè¿›è¡Œä¸‹è½½</span><span class="token comment" spellcheck="true"># é¢„è®­ç»ƒå¥½çš„æ¨¡å‹ä¿å­˜åœ¨ ~/.torch/models/ä¸‹é¢</span>resnet34 <span class="token operator">=</span> models<span class="token punctuation">.</span>squeezenet1_1<span class="token punctuation">(</span>pretrained<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> num_classes<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># ä¿®æ”¹æœ€åçš„å…¨è¿æ¥å±‚ä¸º10åˆ†ç±»é—®é¢˜ï¼ˆé»˜è®¤æ˜¯ImageNetä¸Šçš„1000åˆ†ç±»ï¼‰</span>resnet34<span class="token punctuation">.</span>fc<span class="token operator">=</span>nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿è¡Œç»“æœä¸ºï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>python3<span class="token number">.6</span><span class="token operator">/</span>site<span class="token operator">-</span>packages<span class="token operator">/</span>torchvision<span class="token operator">/</span>models<span class="token operator">/</span>squeezenet<span class="token punctuation">.</span>py<span class="token punctuation">:</span><span class="token number">94</span><span class="token punctuation">:</span> UserWarning<span class="token punctuation">:</span> nn<span class="token punctuation">.</span>init<span class="token punctuation">.</span>kaiming_uniform <span class="token keyword">is</span> now deprecated <span class="token keyword">in</span> favor of nn<span class="token punctuation">.</span>init<span class="token punctuation">.</span>kaiming_uniform_<span class="token punctuation">.</span>  init<span class="token punctuation">.</span>kaiming_uniform<span class="token punctuation">(</span>m<span class="token punctuation">.</span>weight<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>python3<span class="token number">.6</span><span class="token operator">/</span>site<span class="token operator">-</span>packages<span class="token operator">/</span>torchvision<span class="token operator">/</span>models<span class="token operator">/</span>squeezenet<span class="token punctuation">.</span>py<span class="token punctuation">:</span><span class="token number">92</span><span class="token punctuation">:</span> UserWarning<span class="token punctuation">:</span> nn<span class="token punctuation">.</span>init<span class="token punctuation">.</span>normal <span class="token keyword">is</span> now deprecated <span class="token keyword">in</span> favor of nn<span class="token punctuation">.</span>init<span class="token punctuation">.</span>normal_<span class="token punctuation">.</span>  init<span class="token punctuation">.</span>normal<span class="token punctuation">(</span>m<span class="token punctuation">.</span>weight<span class="token punctuation">.</span>data<span class="token punctuation">,</span> mean<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span> std<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="datasets"><a href="#datasets" class="headerlink" title="datasets"></a>datasets</h3><p>è€Œæˆ‘ä»¬çš„å…³äºæ•°æ®é›†çš„éƒ¨åˆ†å®é™…ä¸Šå·²ç»ä»‹ç»è¿‡äº†ï¼š</p><pre><code>from torchvision import datasets# æŒ‡å®šæ•°æ®é›†è·¯å¾„ä¸ºdataï¼Œå¦‚æœæ•°æ®é›†ä¸å­˜åœ¨åˆ™è¿›è¡Œä¸‹è½½# é€šè¿‡train=Falseè·å–æµ‹è¯•é›†dataset = datasets.MNIST(&#39;data/&#39;, download=True, train=False, transform=transform)</code></pre><h3 id="Transforms"><a href="#Transforms" class="headerlink" title="Transforms"></a>Transforms</h3><p>Transformsä¸­æ¶µç›–äº†å¤§éƒ¨åˆ†å¯¹Tensorå’ŒPIL Imageçš„å¸¸ç”¨å¤„ç†ï¼Œè¿™äº›å·²åœ¨ä¸Šæ–‡æåˆ°ï¼Œè¿™é‡Œå°±ä¸å†è¯¦ç»†ä»‹ç»ã€‚éœ€è¦æ³¨æ„çš„æ˜¯è½¬æ¢åˆ†ä¸ºä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥ï¼šæ„å»ºè½¬æ¢æ“ä½œï¼Œä¾‹å¦‚<code>transf = transforms.Normalize(mean=x, std=y)</code>ï¼Œç¬¬äºŒæ­¥ï¼šæ‰§è¡Œè½¬æ¢æ“ä½œï¼Œä¾‹å¦‚<code>output = transf(input)</code>ã€‚å¦å¤–è¿˜å¯å°†å¤šä¸ªå¤„ç†æ“ä½œç”¨Composeæ‹¼æ¥èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªå¤„ç†è½¬æ¢æµç¨‹ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> torchvision <span class="token keyword">import</span> transforms to_pil <span class="token operator">=</span> transforms<span class="token punctuation">.</span>ToPILImage<span class="token punctuation">(</span><span class="token punctuation">)</span>to_pil<span class="token punctuation">(</span>t<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h3><p>torchvisionè¿˜æä¾›äº†ä¸¤ä¸ªå¸¸ç”¨çš„å‡½æ•°ã€‚ä¸€ä¸ªæ˜¯<code>make_grid</code>ï¼Œå®ƒèƒ½å°†å¤šå¼ å›¾ç‰‡æ‹¼æ¥æˆä¸€ä¸ªç½‘æ ¼ä¸­ï¼›å¦ä¸€ä¸ªæ˜¯<code>save_img</code>ï¼Œå®ƒèƒ½å°†Tensorä¿å­˜æˆå›¾ç‰‡ã€‚</p><pre class="line-numbers language-python"><code class="language-python">dataloader <span class="token operator">=</span> DataLoader<span class="token punctuation">(</span>dataset<span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token keyword">from</span> torchvision<span class="token punctuation">.</span>utils <span class="token keyword">import</span> make_grid<span class="token punctuation">,</span> save_imagedataiter <span class="token operator">=</span> iter<span class="token punctuation">(</span>dataloader<span class="token punctuation">)</span>img <span class="token operator">=</span> make_grid<span class="token punctuation">(</span>next<span class="token punctuation">(</span>dataiter<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># æ‹¼æˆ4*4ç½‘æ ¼å›¾ç‰‡ï¼Œä¸”ä¼šè½¬æˆï¼“é€šé“</span>to_img<span class="token punctuation">(</span>img<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿è¡Œç»“æœä¸ºï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211118130259.png" alt></p><h1 id="å…³äºåˆ†å‰²æ£€æµ‹æ•°æ®é›†"><a href="#å…³äºåˆ†å‰²æ£€æµ‹æ•°æ®é›†" class="headerlink" title="å…³äºåˆ†å‰²æ£€æµ‹æ•°æ®é›†"></a>å…³äºåˆ†å‰²æ£€æµ‹æ•°æ®é›†</h1><p>ç›¸æ¯”ä¹‹ä¸‹ï¼Œåˆ†å‰²æ£€æµ‹æ•°æ®é›†æ›´åŠ å¤æ‚ä¸€äº›å› ä¸ºåˆ†å‰²æ£€æµ‹æ•°æ®é™¤äº†ç±»åˆ«ï¼Œæ›´é‡è¦çš„æ˜¯æ¯ä¸ªå›¾åƒä¸­çš„ç›®æ ‡çš„æ£€æµ‹æ¡†Ground Truthè¿˜æœ‰åˆ†å‰²æ‰€ç”¨çš„å¤šè¾¹å½¢ç­‰ä¿¡æ¯ã€‚æ‰€ä»¥æˆ‘ä»¬è¿™é‡Œè¯»å–ä¸€èˆ¬ä¸ä¼šæ˜¯ç®€å•çš„å›¾ç‰‡çš„è·¯å¾„ä»¥åŠç›¸å…³çš„æ–‡ä»¶åã€‚ä¸€èˆ¬è¿™äº›å¤šè¾¹å½¢çš„ä¿¡æ¯éƒ½ä¼šå­˜å‚¨åœ¨ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶æ¯”å¦‚è¯´<code>.json</code>æˆ–è€…<code>.txt</code>ã€<code>.xml</code>è¿™ç±»æ–‡ä»¶ä¸­ä¸“é—¨æ¥å­˜å‚¨ç›¸å…³çš„ä¿¡æ¯ã€‚</p><h2 id="txt"><a href="#txt" class="headerlink" title=".txt"></a><code>.txt</code></h2><p>æˆ‘ä»¬ä»¥ä¸€ä¸ªæ–‡ä»¶ä¸ºä¾‹æ¥è¯´æ˜è¿™ä¸€ç§è¯»å–æ–¹å¼ã€‚è¿™æ¬¡çš„è¯»å–çš„æ•°æ®é›†æ˜¯å€Ÿé‰´çš„Dianå›¢é˜Ÿ<a href="https://github.com/npurson/hello-dian.ai" target="_blank" rel="noopener">2021å¤ä»¤è¥ç›®æ ‡æ£€æµ‹</a>Lab02æ‰€ä½¿ç”¨çš„æ•°æ®é›†<a href="http://xinggangw.info/data/tiny_vid.zip" target="_blank" rel="noopener">Tiny-VID</a><br>æ•°æ®é›†ä¸‹è½½ä¸‹æ¥ç»“æœä¸ºï¼š</p><pre class="line-numbers language-python"><code class="language-python">$ lsbird  bird_gt<span class="token punctuation">.</span>txt  car  car_gt<span class="token punctuation">.</span>txt  dog  dog_gt<span class="token punctuation">.</span>txt  lizard  lizard_gt<span class="token punctuation">.</span>txt  README<span class="token punctuation">.</span>md  turtle  turtle_gt<span class="token punctuation">.</span>txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è€Œæ‰“å¼€ç›¸å…³çš„README.mdæ–‡ä»¶æ˜“å¾—ï¼š</p><blockquote><p>All images are sampled from VID.</p><p>tiny_vid:</p><ul><li>target class: [â€˜carâ€™, â€˜birdâ€™, â€˜turtleâ€™, â€˜dogâ€™, â€˜lizardâ€™]</li><li>image size: 128 * 128</li><li>image number per class: 180</li><li>box format in gt_XX.txt(coordinates are 0-index based): image_index, xmin, ymin, xmax, ymax</li></ul><p>NOTE: Only one object of target classes is contained in every generated image.</p></blockquote><p>å¯ä»¥çœ‹å‡ºæ¯å¼ å›¾ç‰‡éƒ½åªæœ‰ä¸€ä¸ªç›®æ ‡ç‰©ä½“ï¼Œå®é™…ä¸Šè¿™ä¸ªæ˜¯éå¸¸ç®€å•çš„æ•°æ®é›†ï¼Œè¿™é‡Œä¸ä¼šè¯¦ç»†è§£é‡Šã€‚ä¸è¿‡è¿™é‡Œçš„GTä¿¡æ¯å­˜åœ¨äºgt_XXX.txtæ–‡ä»¶ä¸­ã€‚<br>ç®€å•çœ‹ä¸€ä¸‹<code>gt_car.txt</code>:<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/11/18/ID6Snu.png" alt></p><p>æˆ‘ä»¬çœ‹ä¸€ä¸‹å½“æ—¶å®˜æ–¹çš„å®ç°æ–¹æ³•ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> os<span class="token keyword">from</span> torch<span class="token punctuation">.</span>utils <span class="token keyword">import</span> data<span class="token keyword">import</span> transforms<span class="token keyword">class</span> <span class="token class-name">TvidDataset</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>Dataset<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># TODO Implement the dataset class inherited</span>    <span class="token comment" spellcheck="true"># from `torch.utils.data.Dataset`.</span>    <span class="token comment" spellcheck="true"># tips: Use `transforms`.</span>    CLASSES <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'bird'</span><span class="token punctuation">,</span> <span class="token string">'car'</span><span class="token punctuation">,</span> <span class="token string">'dog'</span><span class="token punctuation">,</span> <span class="token string">'lizard'</span><span class="token punctuation">,</span> <span class="token string">'turtle'</span><span class="token punctuation">]</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> root<span class="token punctuation">,</span> mode<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">assert</span> mode <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">'train'</span><span class="token punctuation">,</span> <span class="token string">'test'</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> <span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isabs<span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">:</span>            root <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>expanduser<span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token keyword">if</span> root<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'~'</span> <span class="token keyword">else</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>root<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>images <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>transforms <span class="token operator">=</span> transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span><span class="token punctuation">[</span>            transforms<span class="token punctuation">.</span>LoadImage<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token comment" spellcheck="true"># transforms.RandomHorizontalFlip(),</span>            <span class="token comment" spellcheck="true"># transforms.RandomResize(0.8, 1.2),</span>            <span class="token comment" spellcheck="true"># transforms.RandomCrop((128, 128)),</span>            transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            transforms<span class="token punctuation">.</span>Normalize<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0.485</span><span class="token punctuation">,</span> <span class="token number">0.456</span><span class="token punctuation">,</span> <span class="token number">0.406</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0.229</span><span class="token punctuation">,</span> <span class="token number">0.224</span><span class="token punctuation">,</span> <span class="token number">0.225</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">if</span> mode <span class="token operator">==</span> <span class="token string">'train'</span> <span class="token keyword">else</span> \        transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span><span class="token punctuation">[</span>            transforms<span class="token punctuation">.</span>LoadImage<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token comment" spellcheck="true"># transforms.RandomHorizontalFlip(),</span>            <span class="token comment" spellcheck="true"># transforms.RandomResize(0.5, 2.5),</span>            <span class="token comment" spellcheck="true"># transforms.RandomCrop((128, 128)),</span>            transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            transforms<span class="token punctuation">.</span>Normalize<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0.485</span><span class="token punctuation">,</span> <span class="token number">0.456</span><span class="token punctuation">,</span> <span class="token number">0.406</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0.229</span><span class="token punctuation">,</span> <span class="token number">0.224</span><span class="token punctuation">,</span> <span class="token number">0.225</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> c<span class="token punctuation">,</span> cls <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>self<span class="token punctuation">.</span>CLASSES<span class="token punctuation">)</span><span class="token punctuation">:</span>            dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>root<span class="token punctuation">,</span> cls<span class="token punctuation">)</span>            ann <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>root<span class="token punctuation">,</span> cls <span class="token operator">+</span> <span class="token string">'_gt.txt'</span><span class="token punctuation">)</span>            <span class="token keyword">with</span> open<span class="token punctuation">(</span>ann<span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>                <span class="token keyword">for</span> i<span class="token punctuation">,</span> line <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>mode <span class="token operator">==</span> <span class="token string">'train'</span> <span class="token operator">and</span> i <span class="token operator">>=</span> <span class="token number">150</span><span class="token punctuation">)</span> <span class="token operator">or</span> i <span class="token operator">>=</span> <span class="token number">180</span><span class="token punctuation">:</span>                        <span class="token keyword">break</span>                    <span class="token keyword">if</span> mode <span class="token operator">==</span> <span class="token string">'test'</span> <span class="token operator">and</span> i <span class="token operator">&lt;</span> <span class="token number">150</span><span class="token punctuation">:</span>                        <span class="token keyword">continue</span>                    idx<span class="token punctuation">,</span> <span class="token operator">*</span>xyxy <span class="token operator">=</span> line<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span>                    self<span class="token punctuation">.</span>images<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{</span>                        <span class="token string">'path'</span><span class="token punctuation">:</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>root<span class="token punctuation">,</span> cls<span class="token punctuation">,</span> <span class="token string">'%06d.JPEG'</span> <span class="token operator">%</span> int<span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                        <span class="token string">'cls'</span><span class="token punctuation">:</span> c<span class="token punctuation">,</span>                        <span class="token string">'bbox'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>int<span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> xyxy<span class="token punctuation">]</span><span class="token punctuation">,</span>                    <span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> len<span class="token punctuation">(</span>self<span class="token punctuation">.</span>images<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> idx<span class="token punctuation">)</span><span class="token punctuation">:</span>        img_info <span class="token operator">=</span> self<span class="token punctuation">.</span>images<span class="token punctuation">[</span>idx<span class="token punctuation">]</span>        img<span class="token punctuation">,</span> bbox <span class="token operator">=</span> self<span class="token punctuation">.</span>transforms<span class="token punctuation">(</span>img_info<span class="token punctuation">[</span><span class="token string">'path'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> img_info<span class="token punctuation">[</span><span class="token string">'bbox'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> img<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string">'cls'</span><span class="token punctuation">:</span> img_info<span class="token punctuation">[</span><span class="token string">'cls'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'bbox'</span><span class="token punctuation">:</span> bbox <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># End of todo</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    dataset <span class="token operator">=</span> TvidDataset<span class="token punctuation">(</span>root<span class="token operator">=</span><span class="token string">'~/data/tiny_vid'</span><span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">'train'</span><span class="token punctuation">)</span>    <span class="token keyword">import</span> pdb<span class="token punctuation">;</span> pdb<span class="token punctuation">.</span>set_trace<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>è¿™é‡Œæ’æ’­ä¸€ä¸ªç®€å•çš„çŸ¥è¯†ç‚¹å…³äºå˜é‡å‰åŠ <code>*</code>çš„çŸ¥è¯†ï¼ˆè¿™é‡Œæ˜¯<code>*xyxy</code>ï¼‰ã€‚å¯ä»¥å‚è€ƒè¿™ä¸ª<a href="https://blog.csdn.net/weixin_40877427/article/details/82931899" target="_blank" rel="noopener">åšå®¢</a>ï¼Œæ¯•ç«Ÿä¹‹å‰åªåœ¨å®šä¹‰å‡½æ•°å‚æ•°å¯å˜çš„æ—¶å€™è§è¿‡ã€‚</p></blockquote><p>è¿™ä¹ˆçœ‹æ¥å®é™…ä¸Š.txtæ–‡ä»¶è¯»å–è¿˜æ˜¯éå¸¸è½»æ¾çš„ã€‚è¿™ä¸ªæ–‡ä»¶å±äºæ¯ä¸€ä¸ªç›¸åŒçš„ç±»åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ã€‚</p><h2 id="json"><a href="#json" class="headerlink" title=".json"></a><code>.json</code></h2><h1 id="å…³äºMMdetectionçš„Custom-Dataset"><a href="#å…³äºMMdetectionçš„Custom-Dataset" class="headerlink" title="å…³äºMMdetectionçš„Custom Dataset"></a>å…³äºMMdetectionçš„Custom Dataset</h1><p>åˆæ˜¯ä¸€ä¸ªå¤§å‘ã€‚</p><h2 id="2021-12-2æ—¥æ›´æ–°"><a href="#2021-12-2æ—¥æ›´æ–°" class="headerlink" title="2021.12.2æ—¥æ›´æ–°"></a>2021.12.2æ—¥æ›´æ–°</h2><hr><blockquote><p>ä»¥ä¸‹å†…å®¹åŸºäºæœ¬äººæ‰€ä½œçš„çƒ½ç«é¡¹ç›®</p></blockquote><h3 id="dataloader-in-mmdetection"><a href="#dataloader-in-mmdetection" class="headerlink" title="dataloader in mmdetection"></a>dataloader in mmdetection</h3><p>å…¶æ¬¡æ˜¯å…³äºè¿™å‘¨è¦åšçš„ç¬¬ä¸€ä¸ªä»»åŠ¡ï¼Œè¿™ä¸ªä»»åŠ¡å®é™…ä¸Šå°±æ˜¯æ¥åšä¸€ä¸ªLabelmeæ•°æ®çš„dataloader,å½“ç„¶è¯´èµ·æ¥å®¹æ˜“ï¼Œè¿™ä¸ªè¦æŠŠdataloaderèåˆ°MMDetectioné‡Œé¢è¿˜æ˜¯éœ€è¦æ·±å…¥ç†è§£ä»–çš„Rigistryæœºåˆ¶çš„ï¼Œè€Œä¸”å…‰å†™ä»£ç è¿™ä¸€æ­¥å¦‚æœå®Œå…¨ä¸çœ‹ä»–çš„å…³äºCOCODatasetçš„ä»£ç é è‡ªå·±å†™ææ€•æ˜¯éå¸¸éš¾åŠçš„ã€‚æ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä¸€æ­¥ä¸€æ­¥çš„æ¥æ¢ç´¢ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬æ¥æ‰¾åˆ°COCOçš„dataloaderåˆ°åº•åœ¨å“ªé‡Œã€‚</p><p>è¿˜æ˜¯ä»configæ–‡ä»¶å¼€å§‹æ‰¾ï¼Œç”±äºä¸Šæ–‡å·²ç»æ‰¾è¿‡äº†ï¼Œè¿™é‡Œç›´æ¥å¼•ç”¨ä¸Šæ–‡çš„å¯»æ‰¾è¿‡ç¨‹ï¼š</p><p>â€œâ€â€â€<br>é¦–å…ˆæ˜¯æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ä¸Šå±‚çš„configæ–‡ä»¶<code>configs/fenghuo/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_fenghuo.py</code>, ä»è¿™é‡Œæ‰¾å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ç»§æ‰¿çš„æ˜¯<code>_base_ = &#39;../mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_coco.py&#39;</code>é‚£ä¹ˆæˆ‘ä»¬ç»§ç»­æ‰¾åˆ°è¿™ä¸ªæ¨¡å—å°±<code>configs/mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_coco.py</code>,å¯ä»¥çœ‹åˆ°ä»–ç»§æ‰¿çš„æ˜¯<code>_base_ = &#39;./mask_rcnn_r50_fpn_1x_coco.py&#39;</code>,æˆ‘ä»¬ç»§ç»­æ‰¾è¿™ä¸ªæ–‡ä»¶<code>configs/mask_rcnn/mask_rcnn_r50_fpn_1x_coco.py</code>,è¿™ä¸ªæ–‡ä»¶æœ‰ç‚¹åƒæ˜¯ä¸€ä¸ªpackageçš„<code>__init__.py</code>ï¼Œå°±æ˜¯ä»£ç åªæœ‰æ‰€æœ‰éœ€è¦ç»§æ‰¿çš„åŸºæœ¬ç±»å‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">_base_ <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token string">'../_base_/models/mask_rcnn_r50_fpn.py'</span><span class="token punctuation">,</span>    <span class="token string">'../_base_/datasets/coco_instance.py'</span><span class="token punctuation">,</span>    <span class="token string">'../_base_/schedules/schedule_1x.py'</span><span class="token punctuation">,</span> <span class="token string">'../_base_/default_runtime.py'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€œâ€â€</p><p>ç„¶åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨<code>&#39;../_base_/datasets/coco_instance.py&#39;</code>é‡Œé¢ï¼Œå‰å‡ è¡Œä»£ç å°±æœ‰<code>dataset_type = &#39;CocoDataset&#39;</code>å’Œä¸Šæ–‡ç›¸åŒçš„Registryæœºåˆ¶ï¼Œæˆ‘ä»¬åˆ°<code>mmdet</code>æ–‡ä»¶å¤¹ä¸­å»å¯»æ‰¾ï¼Œå¯ä»¥å‘ç°åœ¨<code>mmdet/datasets/coco.py</code>é‡Œé¢æœ‰<code>CocoDataset</code>è¿™ä¸ªç±»ã€‚è¿™ä¸ªå°±æ˜¯å…³äºCocoDatasetçš„dataloader.ç»ˆäºæ‰¾åˆ°äº†ï¼</p><p>ä½†æ˜¯æœ‰574è¡Œä»£ç â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦èšŒåŸ ä½äº†ğŸ˜¥ã€‚</p><h3 id="dataloader-in-mmdet"><a href="#dataloader-in-mmdet" class="headerlink" title="dataloader in mmdet"></a>dataloader in mmdet</h3><p>å†ç¨å¾®è¯´ä¸€ä¸‹å…³äºRigistryè¿˜æœ‰ç»§æ‰¿ç±»éœ€è¦åšçš„ä¸€äº›ä¸œè¥¿ã€‚</p><p>æˆ‘ä»¬ç»§ç»­ä»ä¸Šæ–‡ä¸­å¾—åˆ°çš„åœ¨<code>mmdet/datasets/coco.py</code>ä¸­çœ‹åˆ°çš„CocoDatasetç±»çš„å†…å®¹ï¼ˆä»…ä»…é€‰æ‹©äº†ä¸€éƒ¨åˆ†ï¼Œå®Œæ•´ç‰ˆçœ‹<a href="https://github.com/open-mmlab/mmdetection/blob/master/mmdet/datasets/coco.py" target="_blank" rel="noopener">è¿™é‡Œ</a>ï¼‰ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Copyright (c) OpenMMLab. All rights reserved.</span>@DATASETS<span class="token punctuation">.</span>register_module<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">CocoDataset</span><span class="token punctuation">(</span>CustomDataset<span class="token punctuation">)</span><span class="token punctuation">:</span>    CLASSES <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'person'</span><span class="token punctuation">,</span> <span class="token string">'bicycle'</span><span class="token punctuation">,</span> <span class="token string">'car'</span><span class="token punctuation">,</span> <span class="token string">'motorcycle'</span><span class="token punctuation">,</span> <span class="token string">'airplane'</span><span class="token punctuation">,</span> <span class="token string">'bus'</span><span class="token punctuation">,</span>               <span class="token string">'train'</span><span class="token punctuation">,</span> <span class="token string">'truck'</span><span class="token punctuation">,</span> <span class="token string">'boat'</span><span class="token punctuation">,</span> <span class="token string">'traffic light'</span><span class="token punctuation">,</span> <span class="token string">'fire hydrant'</span><span class="token punctuation">,</span>               <span class="token string">'stop sign'</span><span class="token punctuation">,</span> <span class="token string">'parking meter'</span><span class="token punctuation">,</span> <span class="token string">'bench'</span><span class="token punctuation">,</span> <span class="token string">'bird'</span><span class="token punctuation">,</span> <span class="token string">'cat'</span><span class="token punctuation">,</span> <span class="token string">'dog'</span><span class="token punctuation">,</span>               <span class="token string">'horse'</span><span class="token punctuation">,</span> <span class="token string">'sheep'</span><span class="token punctuation">,</span> <span class="token string">'cow'</span><span class="token punctuation">,</span> <span class="token string">'elephant'</span><span class="token punctuation">,</span> <span class="token string">'bear'</span><span class="token punctuation">,</span> <span class="token string">'zebra'</span><span class="token punctuation">,</span> <span class="token string">'giraffe'</span><span class="token punctuation">,</span>               <span class="token string">'backpack'</span><span class="token punctuation">,</span> <span class="token string">'umbrella'</span><span class="token punctuation">,</span> <span class="token string">'handbag'</span><span class="token punctuation">,</span> <span class="token string">'tie'</span><span class="token punctuation">,</span> <span class="token string">'suitcase'</span><span class="token punctuation">,</span> <span class="token string">'frisbee'</span><span class="token punctuation">,</span>               <span class="token string">'skis'</span><span class="token punctuation">,</span> <span class="token string">'snowboard'</span><span class="token punctuation">,</span> <span class="token string">'sports ball'</span><span class="token punctuation">,</span> <span class="token string">'kite'</span><span class="token punctuation">,</span> <span class="token string">'baseball bat'</span><span class="token punctuation">,</span>               <span class="token string">'baseball glove'</span><span class="token punctuation">,</span> <span class="token string">'skateboard'</span><span class="token punctuation">,</span> <span class="token string">'surfboard'</span><span class="token punctuation">,</span> <span class="token string">'tennis racket'</span><span class="token punctuation">,</span>               <span class="token string">'bottle'</span><span class="token punctuation">,</span> <span class="token string">'wine glass'</span><span class="token punctuation">,</span> <span class="token string">'cup'</span><span class="token punctuation">,</span> <span class="token string">'fork'</span><span class="token punctuation">,</span> <span class="token string">'knife'</span><span class="token punctuation">,</span> <span class="token string">'spoon'</span><span class="token punctuation">,</span> <span class="token string">'bowl'</span><span class="token punctuation">,</span>               <span class="token string">'banana'</span><span class="token punctuation">,</span> <span class="token string">'apple'</span><span class="token punctuation">,</span> <span class="token string">'sandwich'</span><span class="token punctuation">,</span> <span class="token string">'orange'</span><span class="token punctuation">,</span> <span class="token string">'broccoli'</span><span class="token punctuation">,</span> <span class="token string">'carrot'</span><span class="token punctuation">,</span>               <span class="token string">'hot dog'</span><span class="token punctuation">,</span> <span class="token string">'pizza'</span><span class="token punctuation">,</span> <span class="token string">'donut'</span><span class="token punctuation">,</span> <span class="token string">'cake'</span><span class="token punctuation">,</span> <span class="token string">'chair'</span><span class="token punctuation">,</span> <span class="token string">'couch'</span><span class="token punctuation">,</span>               <span class="token string">'potted plant'</span><span class="token punctuation">,</span> <span class="token string">'bed'</span><span class="token punctuation">,</span> <span class="token string">'dining table'</span><span class="token punctuation">,</span> <span class="token string">'toilet'</span><span class="token punctuation">,</span> <span class="token string">'tv'</span><span class="token punctuation">,</span> <span class="token string">'laptop'</span><span class="token punctuation">,</span>               <span class="token string">'mouse'</span><span class="token punctuation">,</span> <span class="token string">'remote'</span><span class="token punctuation">,</span> <span class="token string">'keyboard'</span><span class="token punctuation">,</span> <span class="token string">'cell phone'</span><span class="token punctuation">,</span> <span class="token string">'microwave'</span><span class="token punctuation">,</span>               <span class="token string">'oven'</span><span class="token punctuation">,</span> <span class="token string">'toaster'</span><span class="token punctuation">,</span> <span class="token string">'sink'</span><span class="token punctuation">,</span> <span class="token string">'refrigerator'</span><span class="token punctuation">,</span> <span class="token string">'book'</span><span class="token punctuation">,</span> <span class="token string">'clock'</span><span class="token punctuation">,</span>               <span class="token string">'vase'</span><span class="token punctuation">,</span> <span class="token string">'scissors'</span><span class="token punctuation">,</span> <span class="token string">'teddy bear'</span><span class="token punctuation">,</span> <span class="token string">'hair drier'</span><span class="token punctuation">,</span> <span class="token string">'toothbrush'</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">load_annotations</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ann_file<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token string">""</span>"Load annotation <span class="token keyword">from</span> COCO style annotation file<span class="token punctuation">.</span>        Args<span class="token punctuation">:</span>            ann_file <span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">:</span> Path of annotation file<span class="token punctuation">.</span>        Returns<span class="token punctuation">:</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸»è¦æ˜¯çœ‹ä¸€ä¸‹<code>@DATASETS.register_module()</code>è¿™ä¸ªè£…é¥°å™¨ï¼Œå…³äºè£…é¥°å™¨çš„è¯­æ³•æ·±å…¥çš„éƒ¨åˆ†ä¸å†è¯´ï¼Œæˆ‘ä»¬è¿™é‡Œåªéœ€è¦çŸ¥é“è¿™ä¸ªå°±ç›¸å½“äºæˆ‘ä»¬æ³¨å†Œäº†æœ‰å…³çš„<code>Rigistry</code>,ä»è¿™ä¸ªå®šä¹‰ä¹‹åï¼Œæˆ‘ä»¬åªéœ€è¦å°±åƒå‰é¢ä¸€æ ·<code>dataset_type = &#39;CocoDataset&#39;</code>å°±å¯ä»¥å°†è¿™ä¸ªdataloaderæ”¾åˆ°MMdetä¸­ã€‚</p><p>å¦å¤–å¦‚æœè‡ªå·±è¦å†™dataloaderçš„è¯ï¼Œç±»éœ€è¦ç»§æ‰¿çš„å°±æ˜¯<code>from .custom import CustomDataset</code>ä¸­çš„<code>CustomDataset</code>.</p><p>å¦å¤–æˆ‘ä»¬è¿˜è¦æ³¨æ„çš„æ˜¯</p><hr>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> dataloader </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++ç¬”è®°è¿ç®—ç¬¦é‡è½½</title>
      <link href="/2021/11/16/c-bi-ji-yun-suan-fu-chong-zai/"/>
      <url>/2021/11/16/c-bi-ji-yun-suan-fu-chong-zai/</url>
      
        <content type="html"><![CDATA[<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>æœ€è¿‘äº‹æƒ…ä¸€å¤šèµ·æ¥ï¼Œå‘ç°è‡ªå·±å†™åšå®¢æ²¡æœ‰ä¹‹å‰é‚£ä¹ˆè®¤çœŸäº†ï¼Œå†™å¾—å«é‡‘é‡ä¹Ÿæœ‰æ‰€ä¸‹é™ï¼Œä»¥å¾€ç‚¹å¼€ä¸€çœ‹éƒ½æ˜¯ä¸€äº›è‡ªè®¤ä¸ºéå¸¸æœ‰æŠ€æœ¯å«é‡ã€å†™å¾—éå¸¸ç²¾å½©çš„åšæ–‡ï¼Œä½†æ˜¯ç°åœ¨ç‚¹å¼€ä¸€çœ‹è‡ªå·±æœ€è¿‘å†™çš„åšæ–‡ï¼Œæˆ‘è‡ªå·±éƒ½ä¸æƒ³ç‚¹å¼€å†çœ‹ç¬¬äºŒéæ¯”ä¹‹å‰æ•·è¡äº†å¥½å¤šçœŸæ˜¯ï¼Œæ—¥å¿—æ›´æ˜¯æ—©å°±ä¸æ›´æ–°äº†ï¼Œè¿™äº›éƒ½ä¸æ˜¯ä»€ä¹ˆå¥½ä¹ æƒ¯ã€‚ä»¥åè¦åŠæ—¶æ³¨æ„è‡ªå·±åšæ–‡çš„è´¨é‡ï¼Œåˆ«æ•´çš„è‡ªå·±éƒ½çœ‹ä¸æ‡‚å°±æ›´æ— æ³•æŒ‡æœ›åˆ«äººèƒ½å¤Ÿå­¦åˆ°ä¸œè¥¿äº†ã€‚</p><p>æœ¬åšå®¢ä¸»è¦ä»‹ç»ä¸€äº›å…³äºC++è¿ç®—ç¬¦é‡è½½ä¸€äº›çŸ¥è¯†ã€‚</p><h1 id="è¿ç®—ç¬¦æ¦‚è¿°"><a href="#è¿ç®—ç¬¦æ¦‚è¿°" class="headerlink" title="è¿ç®—ç¬¦æ¦‚è¿°"></a>è¿ç®—ç¬¦æ¦‚è¿°</h1><h2 id="è¿ç®—ç¬¦åˆ†ç±»"><a href="#è¿ç®—ç¬¦åˆ†ç±»" class="headerlink" title="è¿ç®—ç¬¦åˆ†ç±»"></a>è¿ç®—ç¬¦åˆ†ç±»</h2><ul><li>çº¯å•ç›®è¿ç®—ç¬¦ï¼Œåªèƒ½æœ‰ä¸€ä¸ªæ“ä½œæ•°ï¼ŒåŒ…æ‹¬ï¼š!ã€~ã€sizeofã€newã€delete ç­‰</li><li>çº¯åŒç›®è¿ç®—ç¬¦ï¼Œåªèƒ½æœ‰ä¸¤ä¸ªæ“ä½œæ•°ï¼ŒåŒ…æ‹¬ï¼š[ ]ã€-&gt;ã€%ã€= ç­‰</li><li>ä¸‰ç›®è¿ç®—ç¬¦ï¼Œæœ‰ä¸‰ä¸ªæ“ä½œæ•°ï¼Œå¦‚â€œ? :â€<br>æ—¢æ˜¯å•ç›®åˆæ˜¯åŒç›®çš„è¿ç®—ç¬¦ï¼ŒåŒ…æ‹¬ï¼š+ã€-ã€&amp;ã€* ç­‰</li><li>å¤šç›®è¿ç®—ç¬¦ï¼Œå¦‚å‡½æ•°å‚æ•°è¡¨ â€œ( )â€ã€‚</li><li>å·¦å€¼è¿ç®—ç¬¦æ˜¯è¿ç®—ç»“æœä¸ºå·¦å€¼çš„è¿ç®—ç¬¦ï¼Œå…¶è¡¨è¾¾å¼å¯å‡ºç°åœ¨ç­‰å·å·¦è¾¹ï¼Œå¦‚å‰ç½® ++ã€â€“ ä»¥åŠèµ‹å€¼è¿ç®— =ã€+=ã€*= å’Œ &amp;= ç­‰ã€‚å³å€¼è¿ç®—ç¬¦æ˜¯è¿ç®—ç»“æœä¸ºå³å€¼çš„è¿ç®—ç¬¦ï¼Œå¦‚ +ã€-ã€&gt;&gt;ã€ %ã€åç½® ++ã€â€“ ç­‰ã€‚</li><li>æŸäº›è¿ç®—ç¬¦<strong>è¦æ±‚ç¬¬ä¸€ä¸ªæ“ä½œæ•°ä¸ºå·¦å€¼</strong>ï¼Œå¦‚ ++ã€â€“ ã€=ã€+=ã€&amp;=ç­‰ã€‚</li></ul><p>æˆ‘ä»¬å…ˆçœ‹ä¸ªä¾‹å­çœ‹ä¸€ä¸‹ä¼ ç»Ÿå·¦å€¼è¿ç®—ç¬¦çš„ç”¨æ³•ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">#include <stdio.h>int main(int argc, char *argv[]){    int x = 0;    ++x;                     //++x çš„ç»“æœä¸ºå·¦å€¼ï¼ˆå¯å‡ºç°åœ¨ç­‰å·å·¦è¾¹ï¼‰    ++++x;                   //++x ä»ä¸ºå·¦å€¼ï¼Œæ•…å¯è¿ç»­è¿ç®—ï¼Œx=3    --x = 10;                //--x ä»ä¸ºå·¦å€¼ï¼Œæ•…å¯å†æ¬¡èµ‹å€¼ï¼Œx=10    (x = 5) = 12;            //x=5 ä»ä¸ºå·¦å€¼ï¼Œæ•…å¯å†æ¬¡èµ‹å€¼ï¼Œx=12    (x += 5) = 7;            //x+=5 ä»ä¸ºå·¦å€¼ï¼Œæ•…å¯å†æ¬¡èµ‹å€¼ï¼Œx=7    printf("%d %d", x, x++); //( )å¯çœ‹ä½œä»»æ„ç›®è¿ç®—ç¬¦    return 0;} //(x--)++æ˜¯é”™çš„ï¼šx--çš„ç»“æœä¸ºå³å€¼ï¼Œè€Œ++è¦æ±‚ä¸€ä¸ªå·¦å€¼<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å·¦å€¼å³å€¼"><a href="#å·¦å€¼å³å€¼" class="headerlink" title="å·¦å€¼å³å€¼"></a>å·¦å€¼å³å€¼</h2><p>è¿™é‡Œå¯èƒ½å¾ˆå¤šäººéƒ½å¿˜äº†ï¼ˆ<del>æ¯”å¦‚æˆ‘è‡ªå·±</del>ï¼‰ä»€ä¹ˆæ˜¯å·¦å€¼ï¼Œä»€ä¹ˆæ˜¯å³å€¼ã€‚è¿™é‡Œå¯ä»¥å‚è€ƒ<a href="https://nettee.github.io/posts/2018/Understanding-lvalues-and-rvalues-in-C-and-C/" target="_blank" rel="noopener">åšæ–‡</a>ï¼Œ<br>æˆ‘ä»¬è¿™é‡Œå¯ä»¥ç®€å•å±•å¼€è®²ä¸€ä¸‹ï¼š<br>å³å€¼ä»£è¡¨ä¸€ä¸ªä¸´æ—¶çš„å€¼ï¼Œå¯ä»¥ç†è§£ä¸ºä¸´æ—¶å˜é‡ä¹Ÿå°±æ˜¯<strong>å¸¸é‡</strong>ï¼Œæ¯”å¦‚è¯´1, 2, â€œslkjdfâ€åƒè¿™ç§ä¸å¯ä»¥è¢«èµ‹å€¼å¤„ç†çš„ï¼Œè€Œå·¦å€¼æ˜¯å æœ‰ç‰¹å®šå†…å­˜ç©ºé—´å¹¶ä¸”å¯ä»¥è¢«èµ‹å€¼çš„ä¸€ä¸ª<strong>å˜é‡</strong>ã€‚<br>å³å€¼åªå­˜åœ¨äºæ¯ä¸€ä¸ªè®¡ç®—è¿‡ç¨‹ä¸­çš„ä¸´æ—¶å¯„å­˜å™¨ä¸­ã€‚</p><p>æˆ‘ä»¬ç®€å•çœ‹å‡ ä¸ªæ¯”è¾ƒé‡è¦çš„ä¾‹å­ï¼š<br>é¦–å…ˆæˆ‘ä»¬å¦‚æœåœ¨ç¼–è¯‘å™¨ä¸­ç¼–è¯‘è¿™ä¹ˆå‡ è¡Œä»£ç ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">int foo() {return 2;}int main(){    foo() = 2;    return 0;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">test.c: In function 'main':test.c:8:5: error: lvalue required as left operand of assignment<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¿™é‡Œä¼šè¯´ï¼Œå·¦å€¼è¿ç®—ç¬¦éœ€è¦ä¸€ä¸ª<code>lvalue</code>ï¼ˆå·¦å€¼ï¼‰ï¼Œè€Œæˆ‘ä»¬å‡½æ•°è¿”å›äº†å³å€¼æ— æ³•æ¥å—<code>=2</code>è¿™æ ·ä¸€ä¸ªèµ‹å€¼ã€‚<br>å³å€¼ä¸èƒ½æ¥å—èµ‹å€¼æ“ä½œï¼Œèµ‹å€¼è¯­å¥çš„å·¦è¾¹åº”å½“æ˜¯ä¸€ä¸ªå·¦å€¼ï¼ˆè¿™æˆ–è®¸å°±æ˜¯<code>å·¦å€¼</code>åç§°çš„åˆæ¥ï¼‰</p><p>å¦å¤–å¦‚æœæˆ‘ä»¬ç¼–è¯‘è¿”å›å¼•ç”¨çš„è¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">int& foo(){    return 2;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ç¼–è¯‘å™¨ä»ç„¶ä¼šæŠ¥é”™ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">testcpp.cpp: In function 'int& foo()':testcpp.cpp:5:12: error: invalid initialization of non-const reference of type 'int&' from an rvalue of type 'int'<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å› ä¸ºæˆ‘ä»¬è¿™é‡Œå®šä¹‰äº†æœ‰å…³foo()å‡½æ•°è¿”å›ä¸€ä¸ªå¼•ç”¨ï¼Œä½†æ˜¯è¿”å›çš„ç¡®å®ä¸€ä¸ªå³å€¼2ï¼Œ2è¿™æ ·ä¸€ä¸ªä¸´æ—¶å˜é‡å¾ˆæ˜æ˜¾ä¸å¯ä»¥åšä¸ºä¸€ä¸ªå¼•ç”¨ä½¿ç”¨ï¼ˆå®ƒåœ¨å†…å­˜ä¸­æ²¡æœ‰å›ºå®šçš„åœ°å€ï¼‰ï¼Œè¿™è‡ªç„¶æ˜¯ä¸å¯¹çš„ã€‚</p><p>å¦å¤–è¿™ä¹Ÿç»™æˆ‘ä»¬ä¸€ç‚¹å¯å‘ï¼Œå‡½æ•°çš„è¿”å›å€¼æ˜¯å®Œå…¨å¯ä»¥èµ‹å€¼çš„ï¼Œåªè¦è®©å®ƒçš„è¿”å›ç±»å‹ä¸ºå¼•ç”¨ç±»å‹çš„å°±å¯ä»¥(å¥‡æ€ªçš„C++çŸ¥è¯†)ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">int globalvar = 20;int& foo(){    return globalvar;}int main(){    foo() = 10;    return 0;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è¿ç®—ç¬¦é‡è½½"><a href="#è¿ç®—ç¬¦é‡è½½" class="headerlink" title="è¿ç®—ç¬¦é‡è½½"></a>è¿ç®—ç¬¦é‡è½½</h2><p>C++é¢„å®šä¹‰äº†ç®€å•ç±»å‹çš„è¿ç®—ç¬¦é‡è½½ï¼Œå¦‚3+5ã€3.2+5.3åˆ†åˆ«è¡¨ç¤ºæ•´æ•°å’Œæµ®ç‚¹åŠ æ³•ã€‚æ•…C++è§„å®šè¿ç®—ç¬¦é‡è½½å¿…é¡»é’ˆå¯¹<strong>ç±»çš„å¯¹è±¡</strong>ï¼Œå³é‡è½½æ—¶è‡³å°‘æœ‰ä¸€ä¸ªå‚æ•°ä»£è¡¨å¯¹è±¡ (ç±»å‹å¦‚<code>Aã€const Aã€A &amp;ã€const A &amp;ã€volatile A</code>ç­‰) ã€‚</p><p>è¿™é‡Œå†æ¬¡å¼ºè°ƒï¼Œç±»çš„é‡è½½å¿…é¡»é’ˆå¯¹ç±»çš„å¯¹è±¡æ¥è¿›è¡Œï¼Œè€Œå¯¹äºæˆ‘ä»¬æ™®é€šçš„æ•´æ•°çš„åŠ å‡è¿™ç§æ“ä½œï¼Œä¹ŸåŒæ ·æ˜¯é‡è½½ï¼Œæ˜¯C++é¢„å®šä¹‰å¥½çš„ä¸ç”¨æˆ‘ä»¬å†å»å®šä¹‰çš„é‡è½½ç±»å‹ã€‚</p><p>C++ç”¨<strong>operatoråŠ è¿ç®—ç¬¦</strong>è¿›è¡Œè¿ç®—ç¬¦é‡è½½ã€‚<br><strong>å¯¹äºæ™®é€šè¿ç®—ç¬¦æˆå‘˜å‡½æ•°ï¼Œthis éšå«å‚æ•°ä»£è¡¨ç¬¬ä¸€ä¸ªæ“ä½œæ•°å¯¹è±¡ã€‚</strong></p><h2 id="è¿ç®—ç¬¦é‡è½½åˆ†ç±»"><a href="#è¿ç®—ç¬¦é‡è½½åˆ†ç±»" class="headerlink" title="è¿ç®—ç¬¦é‡è½½åˆ†ç±»"></a>è¿ç®—ç¬¦é‡è½½åˆ†ç±»</h2><p>è¿ç®—ç¬¦åˆ†ä¸ºä¸èƒ½é‡è½½çš„ã€åªèƒ½é‡è½½ä¸ºæ™®é€šå‡½æ•°çš„ã€åªèƒ½é‡è½½ä¸ºç±»æ™®é€šå‡½æ•°çš„ã€éƒ½å¯ä»¥è¢«é‡è½½çš„ã€‚<strong>ä½†æ˜¯è¿™ä¸€åˆ‡éƒ½ä¸å¯ä»¥è¢«é‡è½½ä¸ºé™æ€ç±»å‡½æ•°æˆå‘˜ã€‚</strong></p><p>æ ¹æ®èƒ½å¦é‡è½½åŠé‡è½½å‡½æ•°çš„ç±»å‹ï¼Œè¿ç®—ç¬¦åˆ†ä¸ºï¼š</p><ul><li><strong>ä¸èƒ½é‡è½½ï¼šsizeofã€. ã€.*ã€::ã€? :</strong> </li><li><strong>åªèƒ½é‡è½½ä¸ºç±»çš„æ™®é€šæˆå‘˜å‡½æ•°ï¼š=ã€â€“&gt;ã€( )ã€[ ]</strong></li><li><strong>åªèƒ½é‡è½½ä¸ºæ™®é€šå‡½æ•°ï¼šnewã€delete</strong></li><li>å…¶ä»–è¿ç®—ç¬¦ï¼šå¯ä»¥é‡è½½ä¸º<strong>ç±»çš„æ™®é€šæˆå‘˜å‡½æ•°</strong>å’Œ<strong>æ™®é€šå‡½æ•°</strong>ï¼Œä½†ä¸èƒ½é‡è½½ä¸ºç±»çš„é™æ€æˆå‘˜å‡½æ•°ã€‚</li></ul><p>å¯ä»¥å‚è€ƒä¸€ä¸‹å¾®è½¯å‚è€ƒæ–‡æ¡£å…³äº<a href="https://docs.microsoft.com/zh-cn/cpp/cpp/general-rules-for-operator-overloading?view=msvc-170" target="_blank" rel="noopener">è¿ç®—ç¬¦é‡è½½ä¸€èˆ¬è§„åˆ™</a></p><h2 id="ä¸€äº›é‡è½½æ—¶çš„æ³¨æ„ç‚¹"><a href="#ä¸€äº›é‡è½½æ—¶çš„æ³¨æ„ç‚¹" class="headerlink" title="ä¸€äº›é‡è½½æ—¶çš„æ³¨æ„ç‚¹"></a>ä¸€äº›é‡è½½æ—¶çš„æ³¨æ„ç‚¹</h2><p>è‹¥è¿ç®—ç¬¦ä¸ºå·¦å€¼è¿ç®—ç¬¦ï¼Œåˆ™é‡è½½åè¿ç®—ç¬¦å‡½æ•°æœ€å¥½è¿”å›éåªè¯»å¼•ç”¨ç±»å‹(å·¦å€¼)ã€‚å½“è¿ç®—ç¬¦è¦æ±‚ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå·¦å€¼æ—¶ï¼Œä¸èƒ½ä½¿ç”¨ const è¯´æ˜ç¬¬ä¸€ä¸ªå‚æ•° (å«this)ï¼Œä¾‹å¦‚ ++ã€â€“ã€=ã€+= ç­‰çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚ ä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸èƒ½å¯¹äºéœ€è¦å·¦è¾¹å‚æ•°ä¸ºå·¦å€¼çš„è¿ç®—ç¬¦é‡è½½åå·¦è¾¹å‚æ•°ä¸ºconstç±»å‹ï¼Œå› ä¸ºè¿™æ ·ä¼šäº§ç”Ÿå†²çªã€‚<em>ç±»æ™®é€šå‡½æ•°çš„é‡è½½ä¸€èˆ¬ç¬¬ä¸€ä¸ªå‚æ•°éƒ½æ˜¯thisæŒ‡é’ˆï¼Œæ‰€ä»¥é‡è½½å‡½æ•°åé¢æœ‰æ—¶ä¸å¯ä»¥åŠ const</em></p><p>é‡è½½è¿ç®—ç¬¦å‡½æ•°å¯ä»¥å£°æ˜ä¸ºç±»çš„å‹å…ƒï¼›é‡è½½çš„æ™®é€šè¿ç®—ç¬¦æˆå‘˜å‡½æ•°ä¹Ÿå¯å®šä¹‰ä¸ºè™šå‡½æ•°ï¼›é‡è½½çš„éæˆå‘˜å‡½æ•°è¢«è§†ä¸ºæ™®é€šå‡½æ•°ã€‚</p><p>é‡è½½è¿ç®—ç¬¦å‡½æ•°ä¸€èˆ¬ä¸èƒ½ç¼ºçœå‚æ•°ï¼Œåªæœ‰ä»»æ„ç›®çš„è¿ç®—ç¬¦ ( ) çœç•¥å‚æ•°æ‰æœ‰æ„ä¹‰ã€‚</p><p>é‡è½½ä¸æ”¹å˜è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§å’Œç»“åˆæ€§ã€‚</p><p>é‡è½½ä¸€èˆ¬ä¹Ÿä¸æ”¹å˜è¿ç®—ç¬¦çš„æ“ä½œæ•°ä¸ªæ•°ã€‚ç‰¹æ®Šçš„è¿ç®—ç¬¦ -&gt;ã€++ã€â€“é™¤å¤–ã€‚</p><p>å¯ä»¥çœ‹ä¸€äº›ä¾‹å­ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">#include<iostream>using namespace std;class A;int operator = (int, A &);           //é”™è¯¯, ä¸èƒ½é‡è½½ä¸ºæ™®é€šå‡½æ•°A &operator +=(A &, A &);      //æ­£ç¡®ï¼Œé‡è½½ += ä¸ºæ™®é€šå‡½æ•°A &operator ==(A *a, A b[ ]);   //A * å’Œ A[ ] å‚æ•°ä¸ä»£è¡¨å¯¹è±¡class A {        friend int operator=(int, A &);            //é”™è¯¯ï¼Œä¸å­˜åœ¨æ™®é€šå‡½æ•°operator=( )        static int operator( )(A &, int);            //é”™è¯¯ï¼Œä¸èƒ½ä¸ºé™æ€æˆå‘˜        static int operator+(A &, int);             //é”™è¯¯ï¼Œä¸èƒ½ä¸ºé™æ€æˆå‘˜        friend A & operator += (A &, A &);   //æ­£ç¡®ï¼Œ operator += ( ) æ˜¯ä»€ä¹ˆå‡½æ•°ï¼Ÿ        A &operator ++( );    //éšå«å‚æ•°thisä»£è¡¨ä¸€ä¸ªå¯¹è±¡};<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°<code>=</code>æ“ä½œç¬¦æ˜¯ä¸å¯ä»¥è¢«é‡è½½ä¸ºæ™®é€šå‡½æ•°çš„ï¼Œé‡è½½ä¸ºç±»å†…æ™®é€šå‡½æ•°å°±é—®é¢˜ã€‚æ³¨æ„è¿™é‡Œ<code>+=</code>è™½ç„¶åŒæ ·è¦æ±‚ç¬¬ä¸€ä¸ªæ“ä½œæ•°ä¸ºå·¦å€¼ï¼Œä½†æ˜¯å°±å¯ä»¥é‡è½½ä¸ºæ™®é€šå‡½æ•°ï¼<br>å¦å¤–æ³¨æ„æ‰€æœ‰é‡è½½è¿ç®—ç¬¦éƒ½ä¸å¯å®šä¹‰ä¸ºé™æ€å‡½æ•°ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mmdet &amp;&amp; project of fenghuo</title>
      <link href="/2021/11/09/mmdet-project-of-fenghuo/"/>
      <url>/2021/11/09/mmdet-project-of-fenghuo/</url>
      
        <content type="html"><![CDATA[<blockquote><p>é¡¹ç›®GitHubä»“åº“åœ°å€ï¼š<a href="https://github.com/LRY89757/mmdet-for-fenghuo" target="_blank" rel="noopener">https://github.com/LRY89757/mmdet-for-fenghuo</a></p></blockquote><h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><blockquote><p>2021.11.9æ—¥æ›´æ–°ï¼š</p></blockquote><p>æœ¬åšå®¢è®°å½•çƒ½ç«é¡¹ç›®æœ¬äººçš„åšé¡¹ç›®çš„æŠ€æœ¯è¿‡ç¨‹ã€‚é¦–å…ˆâ€”â€”æˆ‘ä¸ä¼šåˆ†å‰²å‘¢è¿˜ğŸ˜£ğŸ˜£ğŸ˜£ï¼Œæˆ‘å°±å¤§æ¦‚çŸ¥é“åˆ†å‰²æ˜¯ä»€ä¹ˆå¦å¤–å°±æ˜¯æ•°æ®é›†å¤§è‡´å½¢å¼â€¦â€¦ï¼ˆ<del>è™½ç„¶ç›®å‰æ¥çœ‹ä¹Ÿå¤Ÿäº†â€¦â€¦</del>ï¼‰</p><p>è¿™å°±æ˜¯â€å¹²ä¸­å­¦â€å˜›ğŸ˜­ğŸ˜­ã€‚</p><p>å¹¸äºçš„æ˜¯ï¼Œä¹‹å‰çœ‹çš„è®¸å¤šå®˜æ–¹æ–‡æ¡£æˆ‘éƒ½è®°å½•äº†ç›¸å…³çš„è¿‡ç¨‹ï¼Œä¸éœ€è¦é‡å¤çœ‹æ–‡æ¡£äº†ï¼Œè€Œä¸”ã€‚ä¸€ä¸ªæ›´å¥½çš„æ¶ˆæ¯å°±æ˜¯æˆ‘å½“æ—¶çœ‹çš„å®˜æ–¹æ–‡æ¡£å‡ ä¹éƒ½æ˜¯å…³äºMaskRCNNçš„ï¼Œæˆ‘å®é™…ä¸Šå¯¹è¿™äº›ä¸œè¥¿çš„æµ‹è¯•è®­ç»ƒçš„å¾ˆå¤šæµç¨‹éå¸¸æ¸…æ¥šäº†ï¼ˆ<del>åªæ˜¯ä¸€éƒ¨åˆ†ï¼Œä¸€å°éƒ¨åˆ†</del>ï¼‰ï¼Œè¿™å°±ä¸ºæˆ‘è™½ç„¶ä¸ç†Ÿæ‚‰ã€ä¸å¤ªä¼šMaskRCNNä½†æ˜¯ä¸ä¼šå¯¹æˆ‘è®­ç»ƒã€å¯¹æˆ‘æ¨ç†ç›¸å…³æ¨¡å‹äº§ç”Ÿä¸€äº›å¾ˆå¤§çš„éšœç¢ï¼Œæˆ‘æˆ–è®¸åªéœ€è¦å°±æƒ³åœ¨åšæ£€æµ‹ä¸€æ ·æ¥åšè¿™ä¸€ä»¶äº‹å°±å¥½äº†ã€‚å½“ç„¶è¾“å…¥å’Œè¾“å‡ºè¿˜æ˜¯è¦æˆ‘è‡ªå·±æ¥æå®šçš„ï¼Œè¿™ä¹Ÿæ˜¯æœ€ä¸å¥½å¼„çš„ä¸€éƒ¨åˆ†ã€‚</p><p>ç”±äºæœ¬æœˆæœˆæœ«ä¼šæœ‰ä¸¤åœºæ¯”è¾ƒé‡è¦çš„è€ƒè¯•ï¼Œæ‰€ä»¥æœ€å¥½æˆ‘èƒ½åœ¨æœ¬å‘¨å¤§è‡´å†™å‡ºä¸€éƒ¨åˆ†ä»£ç ç„¶ådebugä¸€äº›ä¸œè¥¿ï¼Œè¿™ä¸¤å‘¨å¯ä»¥é€‚å½“å¤šå‚åŠ ä¸€ä¸‹é¡¹ç›®ç„¶ååˆ°æœ¬æœˆåä¸€å‘¨å¼€å§‹å‡†å¤‡è€ƒè¯•ã€‚</p><h1 id="2021-11-9æ—¥æ™šæ›´æ–°"><a href="#2021-11-9æ—¥æ™šæ›´æ–°" class="headerlink" title="2021.11.9æ—¥æ™šæ›´æ–°"></a>2021.11.9æ—¥æ™šæ›´æ–°</h1><p>å·®ä¸å¤šç¡®å®šè®¡åˆ’ä¹‹åï¼Œè¿™ä¸€æ™šä¸Šè¿˜æ˜¯å…ˆçœ‹çœ‹æˆ‘ä¹‹å‰çš„æ‰€æœ‰å…³äºMMDetectionçš„åšå®¢ï¼Œå¯¹äºè®­ç»ƒå’Œæµ‹è¯•ä»¥åŠæ•°æ®é›†é‡æ–°ç†Ÿæ‚‰æ•´åˆä¸€ä¸‹ã€‚</p><p><strong>Note</strong>: MMDetection only supports evaluating mask AP of dataset in COCO format for now. So for instance segmentation task users should convert the data into coco format.</p><h2 id="Config"><a href="#Config" class="headerlink" title="Config"></a>Config</h2><h3 id="dataset-prepare"><a href="#dataset-prepare" class="headerlink" title="dataset prepare"></a>dataset prepare</h3><p>è¿™é‡Œæˆ‘åˆæ­¥æ‰“ç®—æ ¹æ®æˆ‘ä»¬çš„jsonæ–‡ä»¶å†™ä¸€ä¸ªè½¬åŒ–ä¸ºCOCOæ•°æ®é›†çš„<code>.py</code>æ–‡ä»¶ï¼Œå› ä¸ºç»„é•¿æ¨èçš„å†™ä¸€ä¸ªdataloaderè¿™ç§æ–¹å¼æˆ‘ç›®å‰æ²¡æœ‰å¤ªæ˜ç™½ï¼Œåæ­£ä¸ç®¡é»‘çŒ«ç™½çŒ«,å…ˆå†™å‡ºæ¥èƒ½è·‘å°±è¡ŒğŸ˜ã€‚</p><p>COCOæ•°æ®é›†å¤§æ¦‚é•¿è¿™ä¸ªæ ·å­ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token punctuation">{</span>    <span class="token string">"images"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>image<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">"annotations"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>annotation<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">"categories"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>category<span class="token punctuation">]</span><span class="token punctuation">}</span>image <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">"id"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"width"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"height"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"file_name"</span><span class="token punctuation">:</span> str<span class="token punctuation">,</span><span class="token punctuation">}</span>annotation <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">"id"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"image_id"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"category_id"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"segmentation"</span><span class="token punctuation">:</span> RLE <span class="token operator">or</span> <span class="token punctuation">[</span>polygon<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">"area"</span><span class="token punctuation">:</span> float<span class="token punctuation">,</span>    <span class="token string">"bbox"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>width<span class="token punctuation">,</span>height<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">"iscrowd"</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token operator">or</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">}</span>categories <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>    <span class="token string">"id"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"name"</span><span class="token punctuation">:</span> str<span class="token punctuation">,</span>    <span class="token string">"supercategory"</span><span class="token punctuation">:</span> str<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å½“æ—¶çœ‹å®˜ç½‘åå†™çš„åšå®¢å½“æ—¶ç¬¬ä¸€æ­¥å°±æ˜¯è½¬åŒ–ä¸€ä¸‹æ•°æ®é›†ï¼Œå½“æ—¶å®˜ç½‘ä¸“é—¨æä¾›äº†ä¸€ä¸ªBallonæ•°æ®é›†ï¼Œä¹Ÿæ˜¯äºŒåˆ†ç±»çš„æ•°æ®é›†ï¼Œå½“æ—¶æ•°æ®é›†çš„æ ¼å¼ç¡®å®ä¸æ˜¯éå¸¸åˆç†çœ‹ç€ï¼Œåé˜¿é‡Œç»è¿‡è½¬åŒ–ä¹‹åå˜æˆäº†COCOçš„æ ‡å‡†æ ¼å¼ï¼Œæˆ‘ä»¬è¿™é‡Œé‡æ–°æ¥çœ‹ä¸€ä¸‹,å¸å–ä¸Šæ¬¡çš„æ•™è®­ï¼Œè¿™é‡Œé€‰æ‹©åˆ†å±‚æ¥çœ‹ç»“æ„ï¼š</p><ul><li>ç¬¬ä¸€å±‚ç»“æ„ï¼š<br><a href="https://imagelol.com/image/I967LC" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/11/09/I967LC.png" alt></a><br>å¤§ç»“æ„å°±æ˜¯å›¾åƒéƒ½æœ‰ä»€ä¹ˆï¼Œç„¶åæ ‡è®°éƒ½æ˜¯ä»€ä¹ˆï¼Œç„¶åæ˜¯åˆ†ç±»çš„ç±»åˆ«éƒ½æœ‰ä»€ä¹ˆ.æ¥ä¸‹æ¥æ·±å…¥çœ‹ï¼š</li><li>ç¬¬äºŒå±‚ç»“æ„ä¹‹<code>images</code><br><a href="https://imagelol.com/image/I96d4R" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/11/09/I96d4R.png" alt></a></li></ul><p><code>images</code>ä¸»è¦è®°å½•çš„å°±æ˜¯å›¾ç‰‡çš„ä¸€ä¸ªidsè¿˜æœ‰é«˜å®½ï¼Œè¿™ä¸ªé«˜å®½è¿˜æ˜¯è›®é‡è¦çš„ï¼Œä»¥åŠæ–‡ä»¶åã€‚</p><ul><li><p>ç¬¬äºŒå±‚ç»“æ„ä¹‹<code>annotations</code><br><a href="https://imagelol.com/image/I96eDz" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/11/09/I96eDz.png" alt></a><br>è¯¥å±‚å°±æ˜¯æˆ‘ä»¬çš„åˆ†ç±»category_idå’Œæ¡†bboxè¿˜æœ‰åˆ†å‰²æ•°æ®segmentationçš„ç»“æ„äº†ã€‚category_idæ˜¯ç±»åˆ«çš„ç§ç±»æ•°ï¼Œbboxæ˜¯æ£€æµ‹æ¡†ï¼Œsegmentationæ˜¯åˆ†å‰²çš„æ•°æ®æ ‡æ³¨ã€‚å…¶ä»–çš„æ˜¯å’Œä¸Šé¢çš„ä¸€ä¸€å¯¹åº”çš„ï¼ˆ<del>æ¯”å¦‚è¯´image_idè¡¨ç¤ºè¯¥æ ‡æ³¨å±äºé‚£ä¸€å¼ å›¾ç‰‡â€¦â€¦</del>ï¼‰ï¼Œè¿˜æœ‰ä¸€äº›ä¸è¯´äº†ï¼Œä¸æ˜¯éå¸¸é‡è¦ã€‚<br>çœ‹ä¸‹å®Œæ•´çš„åŒ…å«å…·ä½“bboxå’Œsegmentationæ•°æ®çš„å›¾ï¼š<br><a href="https://imagelol.com/image/I96U2p" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/11/09/I96U2p.png" alt></a></p></li><li><p>ç¬¬äºŒå±‚ç»“æ„ä¹‹<code>categories</code>:<br><a href="https://imagelol.com/image/I96Y9W" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/11/09/I96Y9W.png" alt></a></p></li></ul><p>ç”±äºè¿™ä¸ªæ•°æ®é›†éå¸¸ç®€å•,å°±æ˜¯ä¸€ä¸ªå…³äºballoonçš„æ£€æµ‹åˆ†å‰²ä»»åŠ¡,æ‰€ä»¥ç±»åˆ«åªæœ‰ä¸€ä¸ª,ç›¸å¯¹è€Œè¨€è¿˜æŒºå¥½.<br><del>æˆ‘çªç„¶èœœæ±è‡ªä¿¡,æˆ‘ä»¬çš„æ•°æ®ä¹Ÿæ˜¯åˆæ­¥åªæœ‰ä¸€ä¸ªæ¡†è®©æˆ‘ä»¬æ£€æµ‹,æˆ‘æ€ä¹ˆè§‰å¾—æˆ‘åˆè¡Œäº†</del></p><p>å¥½æ»´,æ•°æ®é›†å¤§æ¦‚å°±æ˜¯è¿™æ ·!æˆ‘ä»¬ç»ˆäºå¯ä»¥æ¥çœ‹ä¸€ä¸‹å…³äºConfigç›¸å…³çš„æ–‡ä»¶äº†.</p><h3 id="config"><a href="#config" class="headerlink" title="config"></a>config</h3><p>æˆ‘è‡ªè®¤ä¸ºæˆ‘å½“æ—¶å†™å¾—å…³äºConfigçš„è§£é‡Šå·²ç»å¤Ÿè¯¦ç»†äº†ç›´åˆ°æˆ‘åˆçœ‹äº†ä¸€éç›¸å…³çš„<a href="https://mmdetection.readthedocs.io/en/latest/tutorials/config.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>,å‘ç°å½“æ—¶è§£é‡Šçš„æ¼æ´è¿˜æ˜¯éå¸¸å¤š,æ‰€ä»¥åœ¨è¿™é‡Œå¤šå†™ä¸€ç‚¹.</p><blockquote><p>We incorporate modular and inheritance design into our config system, which is convenient to conduct various experiments. If you wish to inspect the config file, you may run <code>python tools/misc/print_config.py /PATH/TO/CONFIG</code> to see the complete config.</p></blockquote><p>æ­£å¦‚ä¸Šé¢æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>python tools/misc/print_config.py /PATH/TO/CONFIG</code> å‘½ä»¤æ¥å¯¹æˆ‘ä»¬æƒ³è¦äº†è§£çš„configæ–‡ä»¶æ¥çœ‹ä»–ä»¬ç›¸å…³çš„å…·ä½“é…ç½®.<del>äºæˆ‘å½“æ—¶è¿˜ä¸“é—¨å†™äº†ä¸ªç›¸å…³çš„æ‰“å°é…ç½®ä»£ç â€¦</del></p><p>æŠ„ä¸€ä¸‹æˆ‘è‡ªå·±çš„blog:</p><blockquote><p>æˆ‘ä»¬çš„configéœ€è¦æ”¾åˆ°<code>configs/balloon/</code>ç›®å½•ä¸‹å¹¶ä¸”å‘½åä¸ºï¼š<code>mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_balloon.py</code></p><p>å…³äºè¿™ä¹ˆä¸€ä¸ªåå­—ï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆå¤æ‚æ˜¯æœ‰åŸå› çš„ï¼Œå‚è§è¿™é‡Œ:<a href="https://mmdetection.readthedocs.io/zh_CN/v2.18.0/tutorials/config.html#id4" target="_blank" rel="noopener">https://mmdetection.readthedocs.io/zh_CN/v2.18.0/tutorials/config.html#id4</a></p></blockquote><p>å½“æ—¶çš„æˆ‘ä¹ŸçœŸæ˜¯å¤Ÿè¾›è‹¦,å®˜ç½‘ç»™çš„æŒºå¤šä¸œè¥¿éƒ½æœ‰é—®é¢˜,æˆ‘å½“æ—¶å°±è‡ªå·±ä¿®æ”¹äº†è®¸å¤šä¸œè¥¿,æ€»ç®—è®©æˆ‘ä»¬çš„balloon.pyæˆåŠŸè¿è¡Œäº†:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># The new config inherits a base config to highlight the necessary modification</span>_base_ <span class="token operator">=</span> <span class="token string">'../mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_coco.py'</span><span class="token comment" spellcheck="true"># We also need to change the num_classes in head to match the dataset's annotation</span>model <span class="token operator">=</span> dict<span class="token punctuation">(</span>    roi_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>        bbox_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>num_classes<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        mask_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>num_classes<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># Modify dataset related settings</span>dataset_type <span class="token operator">=</span> <span class="token string">'COCODataset'</span>classes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'balloon'</span><span class="token punctuation">,</span><span class="token punctuation">)</span>data <span class="token operator">=</span> dict<span class="token punctuation">(</span>    train<span class="token operator">=</span>dict<span class="token punctuation">(</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/train/'</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/train/annotation_coco.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    val<span class="token operator">=</span>dict<span class="token punctuation">(</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/val/'</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/val/annotation_coco.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    test<span class="token operator">=</span>dict<span class="token punctuation">(</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/val/'</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/val/annotation_coco.json'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># We can use the pre-trained Mask RCNN model to obtain higher performance</span><span class="token comment" spellcheck="true"># load_from = 'checkpoints/mask_rcnn_r50_caffe_fpn_mstrain-poly_3x_coco_bbox_mAP-0.408__segm_mAP-0.37_20200504_163245-42aa3d00.pth'</span>load_from <span class="token operator">=</span> <span class="token string">'https://download.openmmlab.com/mmdetection/v2.0/mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_3x_coco/mask_rcnn_r50_caffe_fpn_mstrain-poly_3x_coco_bbox_mAP-0.408__segm_mAP-0.37_20200504_163245-42aa3d00.pth'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å½“æ—¶å†™é‚£ç¯‡åšæ–‡<a href="https://lry89757.github.io/2021/10/12/practice-mmdet-customized-datasets/">practice mmdet(Customized datasets)</a>çš„æ—¶å€™,è¿˜æ²¡æœ‰å½»åº•è¯»æºç è¿›è¡Œç›¸å…³çš„æº¯æº,è€Œåœ¨æˆ‘æº¯æºä»£ç <a href="https://lry89757.github.io/2021/10/16/code-trace-of-mmdetection/">Code Trace of mmdetection</a>ä¹‹å,å¯¹æ•´ä¸ªå·¥ç¨‹çš„ç†è§£ä¸Šå‡äº†ä¸€ä¸ªå±‚æ¬¡,ä¸å¾—ä¸è¯´è¿˜çœŸæ˜¯å¤Ÿå¯ä»¥çš„,è¿˜æ˜¯å­¦å¥½ç›¸å…³çš„æ–‡ä»¶ã€è¯»æ‡‚æºç æ‰ç®—çœŸæ­£ç†è§£äº†å¾ˆå¤šä¸œè¥¿. è€Œå°½ç®¡è¯»äº†éƒ¨åˆ†æºç ä½†è¿˜æ˜¯ä¸çŸ¥å…¨å±€,æ­£æ˜¯å½“æˆ‘çœ‹äº†çŸ¥ä¹å®˜æ–¹å†™å¾—æ•´ä½“æ¡†æ¶åæ‰æ›´åŠ å…¨å±€äº†è§£äº†æœ‰å…³çš„ç»“æ„.å¯¹äºCVæ•´ä½“çš„æµç¨‹ç›®å‰ä¹Ÿæœ‰äº†æ›´å¥½çš„æŠŠæ¡.</p><p>ä¸Šé¢ä¸€æ®µæ‰¯äº†é‚£ä¹ˆå¤š,æˆ‘ä»¬æ¥è¿è¡Œå‘½ä»¤<code>python tools/misc/print_config.py /home/lry/projects/mmdetection/configs/balloon/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_balloon.py</code>æ¥çœ‹çœ‹configåˆ°åº•æ˜¯ä»€ä¹ˆä¸œè¥¿:<br>æˆ‘å…ˆæŠŠå¾—åˆ°çš„æ•´ä¸ªçš„ç»“æœå¤åˆ¶ä¸‹æ¥ä»¥ä¾¿å„ä½ç ”ç©¶:</p><pre class="line-numbers language-python"><code class="language-python">Config<span class="token punctuation">:</span>model <span class="token operator">=</span> dict<span class="token punctuation">(</span>    type<span class="token operator">=</span><span class="token string">'MaskRCNN'</span><span class="token punctuation">,</span>    backbone<span class="token operator">=</span>dict<span class="token punctuation">(</span>        type<span class="token operator">=</span><span class="token string">'ResNet'</span><span class="token punctuation">,</span>        depth<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span>        num_stages<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>        out_indices<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        frozen_stages<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>        norm_cfg<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'BN'</span><span class="token punctuation">,</span> requires_grad<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        norm_eval<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>        style<span class="token operator">=</span><span class="token string">'caffe'</span><span class="token punctuation">,</span>        init_cfg<span class="token operator">=</span>dict<span class="token punctuation">(</span>            type<span class="token operator">=</span><span class="token string">'Pretrained'</span><span class="token punctuation">,</span>            checkpoint<span class="token operator">=</span><span class="token string">'open-mmlab://detectron2/resnet50_caffe'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    neck<span class="token operator">=</span>dict<span class="token punctuation">(</span>        type<span class="token operator">=</span><span class="token string">'FPN'</span><span class="token punctuation">,</span>        in_channels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token number">2048</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>        num_outs<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    rpn_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>        type<span class="token operator">=</span><span class="token string">'RPNHead'</span><span class="token punctuation">,</span>        in_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>        feat_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>        anchor_generator<span class="token operator">=</span>dict<span class="token punctuation">(</span>            type<span class="token operator">=</span><span class="token string">'AnchorGenerator'</span><span class="token punctuation">,</span>            scales<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            ratios<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            strides<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        bbox_coder<span class="token operator">=</span>dict<span class="token punctuation">(</span>            type<span class="token operator">=</span><span class="token string">'DeltaXYWHBBoxCoder'</span><span class="token punctuation">,</span>            target_means<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            target_stds<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        loss_cls<span class="token operator">=</span>dict<span class="token punctuation">(</span>            type<span class="token operator">=</span><span class="token string">'CrossEntropyLoss'</span><span class="token punctuation">,</span> use_sigmoid<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> loss_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        loss_bbox<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'L1Loss'</span><span class="token punctuation">,</span> loss_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    roi_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>        type<span class="token operator">=</span><span class="token string">'StandardRoIHead'</span><span class="token punctuation">,</span>        bbox_roi_extractor<span class="token operator">=</span>dict<span class="token punctuation">(</span>            type<span class="token operator">=</span><span class="token string">'SingleRoIExtractor'</span><span class="token punctuation">,</span>            roi_layer<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'RoIAlign'</span><span class="token punctuation">,</span> output_size<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span> sampling_ratio<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>            featmap_strides<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        bbox_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>            type<span class="token operator">=</span><span class="token string">'Shared2FCBBoxHead'</span><span class="token punctuation">,</span>            in_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>            fc_out_channels<span class="token operator">=</span><span class="token number">1024</span><span class="token punctuation">,</span>            roi_feat_size<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span>            num_classes<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>            bbox_coder<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'DeltaXYWHBBoxCoder'</span><span class="token punctuation">,</span>                target_means<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                target_stds<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            reg_class_agnostic<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>            loss_cls<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'CrossEntropyLoss'</span><span class="token punctuation">,</span> use_sigmoid<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> loss_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            loss_bbox<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'L1Loss'</span><span class="token punctuation">,</span> loss_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        mask_roi_extractor<span class="token operator">=</span>dict<span class="token punctuation">(</span>            type<span class="token operator">=</span><span class="token string">'SingleRoIExtractor'</span><span class="token punctuation">,</span>            roi_layer<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'RoIAlign'</span><span class="token punctuation">,</span> output_size<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">,</span> sampling_ratio<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>            featmap_strides<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        mask_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>            type<span class="token operator">=</span><span class="token string">'FCNMaskHead'</span><span class="token punctuation">,</span>            num_convs<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>            in_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>            conv_out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>            num_classes<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>            loss_mask<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'CrossEntropyLoss'</span><span class="token punctuation">,</span> use_mask<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> loss_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    train_cfg<span class="token operator">=</span>dict<span class="token punctuation">(</span>        rpn<span class="token operator">=</span>dict<span class="token punctuation">(</span>            assigner<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'MaxIoUAssigner'</span><span class="token punctuation">,</span>                pos_iou_thr<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">,</span>                neg_iou_thr<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span>                min_pos_iou<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span>                match_low_quality<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                ignore_iof_thr<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            sampler<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'RandomSampler'</span><span class="token punctuation">,</span>                num<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>                pos_fraction<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                neg_pos_ub<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>                add_gt_as_proposals<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            allowed_border<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>            pos_weight<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>            debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        rpn_proposal<span class="token operator">=</span>dict<span class="token punctuation">(</span>            nms_pre<span class="token operator">=</span><span class="token number">2000</span><span class="token punctuation">,</span>            max_per_img<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>            nms<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'nms'</span><span class="token punctuation">,</span> iou_threshold<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            min_bbox_size<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        rcnn<span class="token operator">=</span>dict<span class="token punctuation">(</span>            assigner<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'MaxIoUAssigner'</span><span class="token punctuation">,</span>                pos_iou_thr<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                neg_iou_thr<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                min_pos_iou<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                match_low_quality<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                ignore_iof_thr<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            sampler<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'RandomSampler'</span><span class="token punctuation">,</span>                num<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span>                pos_fraction<span class="token operator">=</span><span class="token number">0.25</span><span class="token punctuation">,</span>                neg_pos_ub<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>                add_gt_as_proposals<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            mask_size<span class="token operator">=</span><span class="token number">28</span><span class="token punctuation">,</span>            pos_weight<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>            debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    test_cfg<span class="token operator">=</span>dict<span class="token punctuation">(</span>        rpn<span class="token operator">=</span>dict<span class="token punctuation">(</span>            nms_pre<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>            max_per_img<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>            nms<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'nms'</span><span class="token punctuation">,</span> iou_threshold<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            min_bbox_size<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        rcnn<span class="token operator">=</span>dict<span class="token punctuation">(</span>            score_thr<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">,</span>            nms<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'nms'</span><span class="token punctuation">,</span> iou_threshold<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            max_per_img<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>            mask_thr_binary<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>dataset_type <span class="token operator">=</span> <span class="token string">'COCODataset'</span>data_root <span class="token operator">=</span> <span class="token string">'data/coco/'</span>img_norm_cfg <span class="token operator">=</span> dict<span class="token punctuation">(</span>    mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">103.53</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">123.675</span><span class="token punctuation">]</span><span class="token punctuation">,</span> std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> to_rgb<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>train_pipeline <span class="token operator">=</span> <span class="token punctuation">[</span>    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'LoadImageFromFile'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    dict<span class="token punctuation">(</span>        type<span class="token operator">=</span><span class="token string">'LoadAnnotations'</span><span class="token punctuation">,</span>        with_bbox<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>        with_mask<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>        poly2mask<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    dict<span class="token punctuation">(</span>        type<span class="token operator">=</span><span class="token string">'Resize'</span><span class="token punctuation">,</span>        img_scale<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">640</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">672</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">704</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">736</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                   <span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">768</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        multiscale_mode<span class="token operator">=</span><span class="token string">'value'</span><span class="token punctuation">,</span>        keep_ratio<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'RandomFlip'</span><span class="token punctuation">,</span> flip_ratio<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    dict<span class="token punctuation">(</span>        type<span class="token operator">=</span><span class="token string">'Normalize'</span><span class="token punctuation">,</span>        mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">103.53</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">123.675</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        to_rgb<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'Pad'</span><span class="token punctuation">,</span> size_divisor<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'DefaultFormatBundle'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'Collect'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">,</span> <span class="token string">'gt_bboxes'</span><span class="token punctuation">,</span> <span class="token string">'gt_labels'</span><span class="token punctuation">,</span> <span class="token string">'gt_masks'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>test_pipeline <span class="token operator">=</span> <span class="token punctuation">[</span>    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'LoadImageFromFile'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    dict<span class="token punctuation">(</span>        type<span class="token operator">=</span><span class="token string">'MultiScaleFlipAug'</span><span class="token punctuation">,</span>        img_scale<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        flip<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>        transforms<span class="token operator">=</span><span class="token punctuation">[</span>            dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'Resize'</span><span class="token punctuation">,</span> keep_ratio<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'RandomFlip'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'Normalize'</span><span class="token punctuation">,</span>                mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">103.53</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">123.675</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                to_rgb<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'Pad'</span><span class="token punctuation">,</span> size_divisor<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'ImageToTensor'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'Collect'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>data <span class="token operator">=</span> dict<span class="token punctuation">(</span>    samples_per_gpu<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>    workers_per_gpu<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>    train<span class="token operator">=</span>dict<span class="token punctuation">(</span>        type<span class="token operator">=</span><span class="token string">'CocoDataset'</span><span class="token punctuation">,</span>        ann_file<span class="token operator">=</span>        <span class="token string">'/home/lry/projects/mmdetection/data/balloon/train/annotation_coco.json'</span><span class="token punctuation">,</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/train/'</span><span class="token punctuation">,</span>        pipeline<span class="token operator">=</span><span class="token punctuation">[</span>            dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'LoadImageFromFile'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'LoadAnnotations'</span><span class="token punctuation">,</span>                with_bbox<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                with_mask<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                poly2mask<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'Resize'</span><span class="token punctuation">,</span>                img_scale<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">640</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">672</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">704</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">736</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                           <span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">768</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                multiscale_mode<span class="token operator">=</span><span class="token string">'value'</span><span class="token punctuation">,</span>                keep_ratio<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'RandomFlip'</span><span class="token punctuation">,</span> flip_ratio<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'Normalize'</span><span class="token punctuation">,</span>                mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">103.53</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">123.675</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                to_rgb<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'Pad'</span><span class="token punctuation">,</span> size_divisor<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'DefaultFormatBundle'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'Collect'</span><span class="token punctuation">,</span>                keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">,</span> <span class="token string">'gt_bboxes'</span><span class="token punctuation">,</span> <span class="token string">'gt_labels'</span><span class="token punctuation">,</span> <span class="token string">'gt_masks'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'balloon'</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    val<span class="token operator">=</span>dict<span class="token punctuation">(</span>        type<span class="token operator">=</span><span class="token string">'CocoDataset'</span><span class="token punctuation">,</span>        ann_file<span class="token operator">=</span>        <span class="token string">'/home/lry/projects/mmdetection/data/balloon/val/annotation_coco.json'</span><span class="token punctuation">,</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/val/'</span><span class="token punctuation">,</span>        pipeline<span class="token operator">=</span><span class="token punctuation">[</span>            dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'LoadImageFromFile'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'MultiScaleFlipAug'</span><span class="token punctuation">,</span>                img_scale<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                flip<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>                transforms<span class="token operator">=</span><span class="token punctuation">[</span>                    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'Resize'</span><span class="token punctuation">,</span> keep_ratio<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'RandomFlip'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    dict<span class="token punctuation">(</span>                        type<span class="token operator">=</span><span class="token string">'Normalize'</span><span class="token punctuation">,</span>                        mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">103.53</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">123.675</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                        std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                        to_rgb<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'Pad'</span><span class="token punctuation">,</span> size_divisor<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'ImageToTensor'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'Collect'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'balloon'</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    test<span class="token operator">=</span>dict<span class="token punctuation">(</span>        type<span class="token operator">=</span><span class="token string">'CocoDataset'</span><span class="token punctuation">,</span>        ann_file<span class="token operator">=</span>        <span class="token string">'/home/lry/projects/mmdetection/data/balloon/val/annotation_coco.json'</span><span class="token punctuation">,</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/val/'</span><span class="token punctuation">,</span>        pipeline<span class="token operator">=</span><span class="token punctuation">[</span>            dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'LoadImageFromFile'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'MultiScaleFlipAug'</span><span class="token punctuation">,</span>                img_scale<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                flip<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>                transforms<span class="token operator">=</span><span class="token punctuation">[</span>                    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'Resize'</span><span class="token punctuation">,</span> keep_ratio<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'RandomFlip'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    dict<span class="token punctuation">(</span>                        type<span class="token operator">=</span><span class="token string">'Normalize'</span><span class="token punctuation">,</span>                        mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">103.53</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">123.675</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                        std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                        to_rgb<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'Pad'</span><span class="token punctuation">,</span> size_divisor<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'ImageToTensor'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'Collect'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'balloon'</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>evaluation <span class="token operator">=</span> dict<span class="token punctuation">(</span>metric<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'bbox'</span><span class="token punctuation">,</span> <span class="token string">'segm'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>optimizer <span class="token operator">=</span> dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'SGD'</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.02</span><span class="token punctuation">,</span> momentum<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span> weight_decay<span class="token operator">=</span><span class="token number">0.0001</span><span class="token punctuation">)</span>optimizer_config <span class="token operator">=</span> dict<span class="token punctuation">(</span>grad_clip<span class="token operator">=</span>None<span class="token punctuation">)</span>lr_config <span class="token operator">=</span> dict<span class="token punctuation">(</span>    policy<span class="token operator">=</span><span class="token string">'step'</span><span class="token punctuation">,</span>    warmup<span class="token operator">=</span><span class="token string">'linear'</span><span class="token punctuation">,</span>    warmup_iters<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span>    warmup_ratio<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">,</span>    step<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">)</span>runner <span class="token operator">=</span> dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'EpochBasedRunner'</span><span class="token punctuation">,</span> max_epochs<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>checkpoint_config <span class="token operator">=</span> dict<span class="token punctuation">(</span>interval<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>log_config <span class="token operator">=</span> dict<span class="token punctuation">(</span>interval<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> hooks<span class="token operator">=</span><span class="token punctuation">[</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'TextLoggerHook'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>custom_hooks <span class="token operator">=</span> <span class="token punctuation">[</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'NumClassCheckHook'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>dist_params <span class="token operator">=</span> dict<span class="token punctuation">(</span>backend<span class="token operator">=</span><span class="token string">'nccl'</span><span class="token punctuation">)</span>log_level <span class="token operator">=</span> <span class="token string">'INFO'</span>load_from <span class="token operator">=</span> <span class="token string">'https://download.openmmlab.com/mmdetection/v2.0/mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_3x_coco/mask_rcnn_r50_caffe_fpn_mstrain-poly_3x_coco_bbox_mAP-0.408__segm_mAP-0.37_20200504_163245-42aa3d00.pth'</span>resume_from <span class="token operator">=</span> Noneworkflow <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'train'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>classes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'balloon'</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬ä¸€ä¸ªä¸€ä¸ªæ…¢æ…¢çœ‹,å®é™…ä¸Šå°±æ˜¯æ£€æµ‹åˆ†å‰²çš„å„ä¸ªç»“æ„æµç¨‹(backbone, neck, rpn_head, roi_head)ä»¥åŠæˆ‘ä»¬è®­ç»ƒéªŒè¯æ•°æ®çš„æ ¼å¼é¢„è®­ç»ƒæ–¹æ³•(train_cfg, data_type, data_root, train_pipeline, testâ€¦)ä»¥åŠå„ç±»å…³äºæƒé‡ä½ç½®ã€å­¦ä¹ ç‡ã€ä¼˜åŒ–å‡½æ•°ç­‰ç­‰â€¦:</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211109210515.png" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211109210526.png" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211109210532.png" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211109210556.png" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211109210539.png" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211109210544.png" alt></p><p>é™¤äº†ä»¥ä¸Šç»“æ„ä¹‹å¤–,å‰©ä¸‹çš„å°±æ˜¯ä¸€äº›æˆ‘ä»¬çš„å…¶ä½™é…ç½®:</p><pre class="line-numbers language-python"><code class="language-python">evaluation <span class="token operator">=</span> dict<span class="token punctuation">(</span>metric<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'bbox'</span><span class="token punctuation">,</span> <span class="token string">'segm'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>optimizer <span class="token operator">=</span> dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'SGD'</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.02</span><span class="token punctuation">,</span> momentum<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span> weight_decay<span class="token operator">=</span><span class="token number">0.0001</span><span class="token punctuation">)</span>optimizer_config <span class="token operator">=</span> dict<span class="token punctuation">(</span>grad_clip<span class="token operator">=</span>None<span class="token punctuation">)</span>lr_config <span class="token operator">=</span> dict<span class="token punctuation">(</span>    policy<span class="token operator">=</span><span class="token string">'step'</span><span class="token punctuation">,</span>    warmup<span class="token operator">=</span><span class="token string">'linear'</span><span class="token punctuation">,</span>    warmup_iters<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span>    warmup_ratio<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">,</span>    step<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">)</span>runner <span class="token operator">=</span> dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'EpochBasedRunner'</span><span class="token punctuation">,</span> max_epochs<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>checkpoint_config <span class="token operator">=</span> dict<span class="token punctuation">(</span>interval<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>log_config <span class="token operator">=</span> dict<span class="token punctuation">(</span>interval<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> hooks<span class="token operator">=</span><span class="token punctuation">[</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'TextLoggerHook'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>custom_hooks <span class="token operator">=</span> <span class="token punctuation">[</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'NumClassCheckHook'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>dist_params <span class="token operator">=</span> dict<span class="token punctuation">(</span>backend<span class="token operator">=</span><span class="token string">'nccl'</span><span class="token punctuation">)</span>log_level <span class="token operator">=</span> <span class="token string">'INFO'</span>load_from <span class="token operator">=</span> <span class="token string">'https://download.openmmlab.com/mmdetection/v2.0/mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_3x_coco/mask_rcnn_r50_caffe_fpn_mstrain-poly_3x_coco_bbox_mAP-0.408__segm_mAP-0.37_20200504_163245-42aa3d00.pth'</span>resume_from <span class="token operator">=</span> Noneworkflow <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'train'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>classes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'balloon'</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="2021-11-10æ™šæ›´æ–°"><a href="#2021-11-10æ™šæ›´æ–°" class="headerlink" title="2021.11.10æ™šæ›´æ–°"></a>2021.11.10æ™šæ›´æ–°</h1><h2 id="Preface-1"><a href="#Preface-1" class="headerlink" title="Preface"></a>Preface</h2><p>æŒ‰ç…§æ˜¨å¤©çœ‹çš„è‡ªå·±ä¹‹å‰åšå®¢å’Œæ€»ç»“çš„æ€è·¯ï¼Œç›®å‰å½“åŠ¡ä¹‹æ€¥å°±æ˜¯æ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„ä»£ç æ¥è½¬æ¢labelmeæ ‡æ³¨çš„æ•°æ®é›†å˜ä¸ºCOCOæ ¼å¼çš„ï¼Œç›®å‰åœ¨GitHubæˆ‘æ‰¾åˆ°äº†ä¸€äº›ç›¸å…³çš„å¼€æºå°é¡¹ç›®ï¼Œæ‰“ç®—æ ¹æ®è¿™ä¸ªä»“åº“<a href="https://github.com/veraposeidon/labelme2Datasets" target="_blank" rel="noopener">https://github.com/veraposeidon/labelme2Datasets</a> æ¥è½¬æ¢æˆ‘ä»¬çš„æ•°æ®ï¼Œå½“ç„¶è¿™é‡Œè‚¯å®šéœ€è¦æ›´æ”¹ä¸€äº›ä»£ç ã€‚å¦å¤–è¿™é‡Œç”±äºåˆ†å‰²å¹¶æ²¡æœ‰åšæ•°æ®æ ‡æ³¨ï¼Œæ‰€ä»¥æˆ‘è‡ªå·±å¾—é‡æ–°å†™ä¸€éåˆ†å‰²çš„ç›¸å…³æ ‡æ³¨ã€‚</p><blockquote><p>çœŸæ˜¯æ‡’å¾—å¤Ÿå¯ä»¥ï¼Œ11.10æ•´å®Œçš„ï¼Œè¦ç­‰åˆ°11.13å·æ¥å†™ï¼Œåäº†ã€‚</p></blockquote><h2 id="COCO-jsonå’ŒLabelme-jsonåŒºåˆ«"><a href="#COCO-jsonå’ŒLabelme-jsonåŒºåˆ«" class="headerlink" title="COCO.jsonå’ŒLabelme.jsonåŒºåˆ«"></a>COCO.jsonå’ŒLabelme.jsonåŒºåˆ«</h2><p><del>å¾…æ›´</del><br>2021.11.13å·²æ›´æ–°ã€‚</p><p>ä¸Šé¢æœ‰æåˆ°Labelme.jsonæ–‡ä»¶ä¸»è¦æ ¼å¼ï¼ŒCOCOæ•°æ®é›†å¤§æ¦‚é•¿è¿™ä¸ªæ ·å­ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token punctuation">{</span>    <span class="token string">"images"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>image<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">"annotations"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>annotation<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">"categories"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>category<span class="token punctuation">]</span><span class="token punctuation">}</span>image <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">"id"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"width"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"height"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"file_name"</span><span class="token punctuation">:</span> str<span class="token punctuation">,</span><span class="token punctuation">}</span>annotation <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">"id"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"image_id"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"category_id"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"segmentation"</span><span class="token punctuation">:</span> RLE <span class="token operator">or</span> <span class="token punctuation">[</span>polygon<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">"area"</span><span class="token punctuation">:</span> float<span class="token punctuation">,</span>    <span class="token string">"bbox"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>width<span class="token punctuation">,</span>height<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">"iscrowd"</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token operator">or</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">}</span>categories <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>    <span class="token string">"id"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"name"</span><span class="token punctuation">:</span> str<span class="token punctuation">,</span>    <span class="token string">"supercategory"</span><span class="token punctuation">:</span> str<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>COCOçš„jsonæ–‡ä»¶æ˜¯æ‰€æœ‰å›¾ç‰‡éƒ½æ”¾åˆ°ä¸€ä¸ªjsonæ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”ç±»åˆ«ã€å›¾ç‰‡æå‰éƒ½ç”¨ç¼–å·idå®šä¹‰å¥½ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç»§ç»­çœ‹ä¸€ä¸‹Labelme.jsonæ–‡ä»¶åŒ…å«ä»€ä¹ˆï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token punctuation">{</span>  <span class="token string">"version"</span><span class="token punctuation">:</span> <span class="token string">"4.5.13"</span><span class="token punctuation">,</span>  <span class="token string">"flags"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token string">"shapes"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>    <span class="token punctuation">{</span>      <span class="token string">"label"</span><span class="token punctuation">:</span> <span class="token string">"780B"</span><span class="token punctuation">,</span>      <span class="token string">"points"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">[</span>          <span class="token number">734.0</span><span class="token punctuation">,</span>          <span class="token number">2425.0</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span>          <span class="token number">2779.0</span><span class="token punctuation">,</span>          <span class="token number">2355.0</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span>          <span class="token number">2584.0</span><span class="token punctuation">,</span>          <span class="token number">3580.0</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span>          <span class="token number">819.0</span><span class="token punctuation">,</span>          <span class="token number">3770.0</span>        <span class="token punctuation">]</span>      <span class="token punctuation">]</span><span class="token punctuation">,</span>      <span class="token string">"group_id"</span><span class="token punctuation">:</span> null<span class="token punctuation">,</span>      <span class="token string">"shape_type"</span><span class="token punctuation">:</span> <span class="token string">"polygon"</span><span class="token punctuation">,</span>      <span class="token string">"flags"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>    <span class="token punctuation">{</span>    <span class="token string">"label"</span><span class="token punctuation">:</span><span class="token string">"780B"</span><span class="token punctuation">,</span>    <span class="token string">"points"</span><span class="token punctuation">:</span><span class="token punctuation">[</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>    <span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">"group_id"</span><span class="token punctuation">:</span> null<span class="token punctuation">,</span>      <span class="token string">"shape_type"</span><span class="token punctuation">:</span> <span class="token string">"polygon"</span><span class="token punctuation">,</span>      <span class="token string">"flags"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token punctuation">}</span>  <span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token string">"imagePath"</span><span class="token punctuation">:</span> <span class="token string">"IMG_20211021_154043.jpg"</span><span class="token punctuation">,</span>  <span class="token string">"imageData"</span><span class="token punctuation">:</span> null<span class="token punctuation">,</span>  <span class="token string">"imageHeight"</span><span class="token punctuation">:</span> <span class="token number">4608</span><span class="token punctuation">,</span>  <span class="token string">"imageWidth"</span><span class="token punctuation">:</span> <span class="token number">3456</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>labelmeæ–‡ä»¶æ˜¯æ¯ä¸€ä¸ªå›¾ç‰‡éƒ½æœ‰è‡ªå·±çš„jsonæ–‡ä»¶è´Ÿè´£å­˜å‚¨å„ä¸ªå›¾ç‰‡ã€‚</p><p>å¦å¤–è¿™é‡Œä»‹ç»ä¸€ä¸‹COCOæ•°æ®é›†ä¸­çš„segmentationç±»å‹çš„labelæ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Œå®é™…ä¸Šå°±æ˜¯ç±»ä¼¼äºå¤šè¾¹å½¢çš„æ¯ä¸€ä¸ªé¡¶ç‚¹è¿™ä¸ªæ ·å¼ï¼Œè¿™å¯¹æˆ‘ä»¬ç›®å‰çš„æ•°æ®é›†éå¸¸æ–¹ä¾¿ï¼Œå› ä¸ºæˆ‘ä»¬ç›®å‰æ•°æ®é›†å¹¶æ²¡æœ‰æ ‡æ³¨æ¯ä¸€ä¸ªç‰©ä½“çš„åˆ†å‰²æ•°æ®é›†ï¼Œä½†æ˜¯æˆ‘ä»¬çš„ç›®æ ‡æœ¬èº«å°±æ˜¯çŸ©å½¢æ¡†ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥ç”¨æ£€æµ‹çš„labelå°±å¯ä»¥ç›´æ¥è½¬åŒ–ä¸ºCOCOæ ¼å¼çš„åˆ†å‰²çš„labelã€‚å› ä¸ºéƒ½æ˜¯åªæœ‰4ä¸ªç‚¹å°±å¯ä»¥ã€‚</p><h2 id="è½¬æ¢æºç åˆå§‹ç‰ˆ"><a href="#è½¬æ¢æºç åˆå§‹ç‰ˆ" class="headerlink" title="è½¬æ¢æºç åˆå§‹ç‰ˆ"></a>è½¬æ¢æºç åˆå§‹ç‰ˆ</h2><p>ç›®å‰æ‰“ç®—è½¬æ¢çš„æºç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token triple-quoted-string string">"""æœ¬æ¨¡å—ç”¨äºæ‰¹é‡è½¬æ¢labelmeæ ‡è®°çš„æ ¼å¼ï¼Œä½¿ä¹‹å˜æˆcocoæ•°æ®é›†æ ¼å¼"""</span><span class="token comment" spellcheck="true"># -*- coding:utf-8 -*-</span><span class="token comment" spellcheck="true"># !/usr/bin/env python</span><span class="token keyword">import</span> argparse<span class="token keyword">import</span> json<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">import</span> skimage<span class="token punctuation">.</span>io <span class="token keyword">as</span> io<span class="token keyword">import</span> cv2<span class="token keyword">from</span> labelme <span class="token keyword">import</span> utils<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> glob<span class="token keyword">import</span> PIL<span class="token punctuation">.</span>Image<span class="token keyword">class</span> <span class="token class-name">MyEncoder</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span>JSONEncoder<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">default</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> isinstance<span class="token punctuation">(</span>obj<span class="token punctuation">,</span> np<span class="token punctuation">.</span>integer<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> int<span class="token punctuation">(</span>obj<span class="token punctuation">)</span>        <span class="token keyword">elif</span> isinstance<span class="token punctuation">(</span>obj<span class="token punctuation">,</span> np<span class="token punctuation">.</span>floating<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> float<span class="token punctuation">(</span>obj<span class="token punctuation">)</span>        <span class="token keyword">elif</span> isinstance<span class="token punctuation">(</span>obj<span class="token punctuation">,</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> obj<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> super<span class="token punctuation">(</span>MyEncoder<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">labelme2coco</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> labelme_json<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> save_json_path<span class="token operator">=</span><span class="token string">'./tran.json'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">'''        labelme_json: æ‰€æœ‰labelmeçš„jsonæ–‡ä»¶è·¯å¾„ç»„æˆçš„åˆ—è¡¨        save_json_path: jsonä¿å­˜ä½ç½®        '''</span>        self<span class="token punctuation">.</span>labelme_json <span class="token operator">=</span> labelme_json        self<span class="token punctuation">.</span>save_json_path <span class="token operator">=</span> save_json_path        self<span class="token punctuation">.</span>images <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>categories <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>annotations <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># self.data_coco = {}</span>        self<span class="token punctuation">.</span>label <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>annID <span class="token operator">=</span> <span class="token number">1</span>        self<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">0</span>        self<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">0</span>        self<span class="token punctuation">.</span>save_json<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">data_transfer</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> num<span class="token punctuation">,</span> json_file <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>self<span class="token punctuation">.</span>labelme_json<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"num:"</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>num <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'    '</span> <span class="token operator">+</span> json_file<span class="token punctuation">)</span>            <span class="token keyword">with</span> open<span class="token punctuation">(</span>json_file<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>                data <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>fp<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># åŠ è½½jsonæ–‡ä»¶</span>                self<span class="token punctuation">.</span>images<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>image<span class="token punctuation">(</span>data<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">for</span> shapes <span class="token keyword">in</span> data<span class="token punctuation">[</span><span class="token string">'shapes'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                    label <span class="token operator">=</span> shapes<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span>                    <span class="token keyword">if</span> label <span class="token operator">not</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>label<span class="token punctuation">:</span>                        self<span class="token punctuation">.</span>categories<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>categorie<span class="token punctuation">(</span>label<span class="token punctuation">)</span><span class="token punctuation">)</span>                        self<span class="token punctuation">.</span>label<span class="token punctuation">.</span>append<span class="token punctuation">(</span>label<span class="token punctuation">)</span>                    points <span class="token operator">=</span> shapes<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># è¿™é‡Œçš„pointæ˜¯ç”¨rectangleæ ‡æ³¨å¾—åˆ°çš„ï¼Œåªæœ‰ä¸¤ä¸ªç‚¹ï¼Œéœ€è¦è½¬æˆå››ä¸ªç‚¹</span>                    <span class="token comment" spellcheck="true">#points.append([points[0][0], points[1][1]])</span>                    <span class="token comment" spellcheck="true">#points.append([points[1][0], points[0][1]])</span>                    self<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>annotation<span class="token punctuation">(</span>points<span class="token punctuation">,</span> label<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">)</span>                    self<span class="token punctuation">.</span>annID <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token keyword">def</span> <span class="token function">image</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">:</span>        image <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        img <span class="token operator">=</span> utils<span class="token punctuation">.</span>img_b64_to_arr<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'imageData'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># è§£æåŸå›¾ç‰‡æ•°æ®</span>        <span class="token comment" spellcheck="true"># img=io.imread(data['imagePath']) # é€šè¿‡å›¾ç‰‡è·¯å¾„æ‰“å¼€å›¾ç‰‡</span>        <span class="token comment" spellcheck="true"># img = cv2.imread(data['imagePath'], 0)</span>        height<span class="token punctuation">,</span> width <span class="token operator">=</span> img<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>        img <span class="token operator">=</span> None        image<span class="token punctuation">[</span><span class="token string">'height'</span><span class="token punctuation">]</span> <span class="token operator">=</span> height        image<span class="token punctuation">[</span><span class="token string">'width'</span><span class="token punctuation">]</span> <span class="token operator">=</span> width        image<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> num <span class="token operator">+</span> <span class="token number">1</span>        <span class="token comment" spellcheck="true">#image['file_name'] = data['imagePath'].split("\\")[-1] #æ­¤è¡Œä¸é€‚åˆæˆ‘çš„æ•°æ®é›†</span>        image<span class="token punctuation">[</span><span class="token string">'file_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'imagePath'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\\"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>height <span class="token operator">=</span> height        self<span class="token punctuation">.</span>width <span class="token operator">=</span> width        <span class="token keyword">return</span> image    <span class="token keyword">def</span> <span class="token function">categorie</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> label<span class="token punctuation">)</span><span class="token punctuation">:</span>        categorie <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        categorie<span class="token punctuation">[</span><span class="token string">'supercategory'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Cancer'</span>        categorie<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> len<span class="token punctuation">(</span>self<span class="token punctuation">.</span>label<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>  <span class="token comment" spellcheck="true"># 0 é»˜è®¤ä¸ºèƒŒæ™¯</span>        categorie<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> label        <span class="token keyword">return</span> categorie    <span class="token keyword">def</span> <span class="token function">annotation</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> points<span class="token punctuation">,</span> label<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">:</span>        annotation <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        annotation<span class="token punctuation">[</span><span class="token string">'segmentation'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>list<span class="token punctuation">(</span>np<span class="token punctuation">.</span>asarray<span class="token punctuation">(</span>points<span class="token punctuation">)</span><span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>        annotation<span class="token punctuation">[</span><span class="token string">'iscrowd'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>        annotation<span class="token punctuation">[</span><span class="token string">'image_id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> num <span class="token operator">+</span> <span class="token number">1</span>        <span class="token comment" spellcheck="true"># annotation['bbox'] = str(self.getbbox(points)) # ä½¿ç”¨listä¿å­˜jsonæ–‡ä»¶æ—¶æŠ¥é”™ï¼ˆä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼‰</span>        <span class="token comment" spellcheck="true"># list(map(int,a[1:-1].split(','))) a=annotation['bbox'] ä½¿ç”¨è¯¥æ–¹å¼è½¬æˆlist</span>        annotation<span class="token punctuation">[</span><span class="token string">'bbox'</span><span class="token punctuation">]</span> <span class="token operator">=</span> list<span class="token punctuation">(</span>map<span class="token punctuation">(</span>float<span class="token punctuation">,</span> self<span class="token punctuation">.</span>getbbox<span class="token punctuation">(</span>points<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        annotation<span class="token punctuation">[</span><span class="token string">'area'</span><span class="token punctuation">]</span> <span class="token operator">=</span> annotation<span class="token punctuation">[</span><span class="token string">'bbox'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> annotation<span class="token punctuation">[</span><span class="token string">'bbox'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># annotation['category_id'] = self.getcatid(label)</span>        annotation<span class="token punctuation">[</span><span class="token string">'category_id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>getcatid<span class="token punctuation">(</span>label<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># æ³¨æ„ï¼Œæºä»£ç é»˜è®¤ä¸º1</span>        annotation<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>annID        <span class="token keyword">return</span> annotation    <span class="token keyword">def</span> <span class="token function">getcatid</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> label<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> categorie <span class="token keyword">in</span> self<span class="token punctuation">.</span>categories<span class="token punctuation">:</span>            <span class="token keyword">if</span> label <span class="token operator">==</span> categorie<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                <span class="token keyword">return</span> categorie<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span>        <span class="token keyword">return</span> <span class="token number">1</span>    <span class="token keyword">def</span> <span class="token function">getbbox</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> points<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># img = np.zeros([self.height,self.width],np.uint8)</span>        <span class="token comment" spellcheck="true"># cv2.polylines(img, [np.asarray(points)], True, 1, lineType=cv2.LINE_AA)  # ç”»è¾¹ç•Œçº¿</span>        <span class="token comment" spellcheck="true"># cv2.fillPoly(img, [np.asarray(points)], 1)  # ç”»å¤šè¾¹å½¢ å†…éƒ¨åƒç´ å€¼ä¸º1</span>        polygons <span class="token operator">=</span> points        mask <span class="token operator">=</span> self<span class="token punctuation">.</span>polygons_to_mask<span class="token punctuation">(</span><span class="token punctuation">[</span>self<span class="token punctuation">.</span>height<span class="token punctuation">,</span> self<span class="token punctuation">.</span>width<span class="token punctuation">]</span><span class="token punctuation">,</span> polygons<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#print(polygons)</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>mask2box<span class="token punctuation">(</span>mask<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">mask2box</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> mask<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">'''ä»maskåç®—å‡ºå…¶è¾¹æ¡†        maskï¼š[h,w]  0ã€1ç»„æˆçš„å›¾ç‰‡        1å¯¹åº”å¯¹è±¡ï¼Œåªéœ€è®¡ç®—1å¯¹åº”çš„è¡Œåˆ—å·ï¼ˆå·¦ä¸Šè§’è¡Œåˆ—å·ï¼Œå³ä¸‹è§’è¡Œåˆ—å·ï¼Œå°±å¯ä»¥ç®—å‡ºå…¶è¾¹æ¡†ï¼‰        '''</span>        <span class="token comment" spellcheck="true"># np.where(mask==1)</span>        index <span class="token operator">=</span> np<span class="token punctuation">.</span>argwhere<span class="token punctuation">(</span>mask <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#print(index)</span>        rows <span class="token operator">=</span> index<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>        clos <span class="token operator">=</span> index<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># è§£æå·¦ä¸Šè§’è¡Œåˆ—å·</span>        <span class="token comment" spellcheck="true">#print(rows)</span>        left_top_r <span class="token operator">=</span> np<span class="token punctuation">.</span>min<span class="token punctuation">(</span>rows<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># y</span>        left_top_c <span class="token operator">=</span> np<span class="token punctuation">.</span>min<span class="token punctuation">(</span>clos<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># x</span>        <span class="token comment" spellcheck="true"># è§£æå³ä¸‹è§’è¡Œåˆ—å·</span>        right_bottom_r <span class="token operator">=</span> np<span class="token punctuation">.</span>max<span class="token punctuation">(</span>rows<span class="token punctuation">)</span>        right_bottom_c <span class="token operator">=</span> np<span class="token punctuation">.</span>max<span class="token punctuation">(</span>clos<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># return [(left_top_r,left_top_c),(right_bottom_r,right_bottom_c)]</span>        <span class="token comment" spellcheck="true"># return [(left_top_c, left_top_r), (right_bottom_c, right_bottom_r)]</span>        <span class="token comment" spellcheck="true"># return [left_top_c, left_top_r, right_bottom_c, right_bottom_r]  # [x1,y1,x2,y2]</span>        <span class="token keyword">return</span> <span class="token punctuation">[</span>left_top_c<span class="token punctuation">,</span> left_top_r<span class="token punctuation">,</span> right_bottom_c <span class="token operator">-</span> left_top_c<span class="token punctuation">,</span>                right_bottom_r <span class="token operator">-</span> left_top_r<span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># [x1,y1,w,h] å¯¹åº”COCOçš„bboxæ ¼å¼</span>    <span class="token keyword">def</span> <span class="token function">polygons_to_mask</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> img_shape<span class="token punctuation">,</span> polygons<span class="token punctuation">)</span><span class="token punctuation">:</span>        mask <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>img_shape<span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>        mask <span class="token operator">=</span> PIL<span class="token punctuation">.</span>Image<span class="token punctuation">.</span>fromarray<span class="token punctuation">(</span>mask<span class="token punctuation">)</span>        xy <span class="token operator">=</span> list<span class="token punctuation">(</span>map<span class="token punctuation">(</span>tuple<span class="token punctuation">,</span> polygons<span class="token punctuation">)</span><span class="token punctuation">)</span>        PIL<span class="token punctuation">.</span>ImageDraw<span class="token punctuation">.</span>Draw<span class="token punctuation">(</span>mask<span class="token punctuation">)</span><span class="token punctuation">.</span>polygon<span class="token punctuation">(</span>xy<span class="token operator">=</span>xy<span class="token punctuation">,</span> outline<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> fill<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>        mask <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>mask<span class="token punctuation">,</span> dtype<span class="token operator">=</span>bool<span class="token punctuation">)</span>        <span class="token keyword">return</span> mask    <span class="token keyword">def</span> <span class="token function">data2coco</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        data_coco <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        data_coco<span class="token punctuation">[</span><span class="token string">'images'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>images        data_coco<span class="token punctuation">[</span><span class="token string">'categories'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>categories        data_coco<span class="token punctuation">[</span><span class="token string">'annotations'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>annotations        <span class="token keyword">return</span> data_coco    <span class="token keyword">def</span> <span class="token function">save_json</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>data_transfer<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>data_coco <span class="token operator">=</span> self<span class="token punctuation">.</span>data2coco<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># ä¿å­˜jsonæ–‡ä»¶</span>        json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>self<span class="token punctuation">.</span>data_coco<span class="token punctuation">,</span> open<span class="token punctuation">(</span>self<span class="token punctuation">.</span>save_json_path<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> indent<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> cls<span class="token operator">=</span>MyEncoder<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># indent=4 æ›´åŠ ç¾è§‚æ˜¾ç¤º</span>labelme_json <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">'H:/camellia/Aug/è®­ç»ƒ/val_json/*.json'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>labelme_json<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># labelme_json=['./Annotations/*.json']</span><span class="token comment" spellcheck="true"># labelme_json=glob.glob('./Annotations/*.json')</span>saveme_json <span class="token operator">=</span> <span class="token string">'H:/camellia/Aug/è®­ç»ƒ/annotations/val.json'</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Start."</span><span class="token punctuation">)</span>labelme2coco<span class="token punctuation">(</span>labelme_json<span class="token punctuation">,</span> saveme_json<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Finished."</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ä»£ç è¯¦è§£"><a href="#ä»£ç è¯¦è§£" class="headerlink" title="ä»£ç è¯¦è§£"></a>ä»£ç è¯¦è§£</h2><p>æŒ‰ç…§è¿è¡Œé¡ºåºæ¥è§£é‡Šä»£ç ï¼š</p><h3 id="main"><a href="#main" class="headerlink" title="main()"></a>main()</h3><p>å…³äºä»¥ä¸Šä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è¿è¡Œçš„é¡ºåºæ¥å®šä¹‰ï¼Œé¦–å…ˆæ˜¯globäº†æ‰€æœ‰.jsonå‰ç¼€çš„æ–‡ä»¶ï¼Œå› ä¸ºæˆ‘ä»¬labelmeçš„æ–‡ä»¶éƒ½æ˜¯ä¸€ä¸ªå›¾ç‰‡ä¸“é—¨ç”Ÿæˆä¸€ä¸ª.jsonæ–‡ä»¶ï¼Œè€Œæˆ‘ä»¬çš„COCOæ•°æ®é›†æ ¼å¼æ˜¯æ‰€æœ‰çš„å›¾ç‰‡çš„ä¿¡æ¯éƒ½æ”¾åˆ°äº†ä¸€ä¸ª.jsonå›¾ç‰‡ä¸­ï¼Œæ¥ç€æˆ‘ä»¬å®šä¹‰ä¿å­˜åˆ°çš„jsonæ–‡ä»¶ï¼Œç„¶åç›´æ¥è°ƒç”¨ç±»labelme2coco,ç„¶åç›´æ¥å¾—åˆ°çš„ç»“æœã€‚</p><h3 id="labelme2coco"><a href="#labelme2coco" class="headerlink" title="labelme2coco"></a>labelme2coco</h3><p>labelme2cocoæ˜¯æ•´ä¸ªæ–‡ä»¶çš„å…³é”®ã€‚</p><h3 id="init"><a href="#init" class="headerlink" title="__init__"></a><code>__init__</code></h3><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">labelme2coco</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> labelme_json<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> save_json_path<span class="token operator">=</span><span class="token string">'./tran.json'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># è¿™é‡Œå®šä¹‰äº†é»˜è®¤çš„å­˜å‚¨è·¯å¾„</span>        <span class="token triple-quoted-string string">'''        labelme_json: æ‰€æœ‰labelmeçš„jsonæ–‡ä»¶è·¯å¾„ç»„æˆçš„åˆ—è¡¨        save_json_path: jsonä¿å­˜ä½ç½®        '''</span>        self<span class="token punctuation">.</span>labelme_json <span class="token operator">=</span> labelme_json     <span class="token comment" spellcheck="true"># labelme_jsonçš„æ–‡ä»¶è·¯å¾„ï¼Œæ˜¯ä¸€ä¸ªåˆ—è¡¨å­˜å‚¨ç€æ‰€æœ‰çš„å¾…è½¬åŒ–jsonæ–‡ä»¶è·¯å¾„</span>        self<span class="token punctuation">.</span>save_json_path <span class="token operator">=</span> save_json_path  <span class="token comment" spellcheck="true"># ä¿å­˜çš„è·¯å¾„</span>        self<span class="token punctuation">.</span>images <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># å¯¹åº”ç”ŸæˆCOCOå½¢å¼jsonæ–‡ä»¶çš„imageçš„ç±»å‹ã€‚</span>        self<span class="token punctuation">.</span>categories <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># åŒä¸Š</span>        self<span class="token punctuation">.</span>annotations <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># åŒä¸Š</span>        <span class="token comment" spellcheck="true"># self.data_coco = {}</span>        self<span class="token punctuation">.</span>label <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>annID <span class="token operator">=</span> <span class="token number">1</span>        self<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">0</span>        self<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">0</span>        self<span class="token punctuation">.</span>save_json<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># æ³¨æ„è¿™é‡Œä¸€è°ƒç”¨è¯¥ç±»å°±ç›´æ¥è¿è¡Œç›¸å…³çš„æ‰€æœ‰ä»£ç äº†ï¼Œè¿™ä¸ªæŠ€å·§å¾ˆæœ‰ç”¨ã€‚</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬æ¥ä¸‹æ¥åº”è¯¥çœ‹<code>save_json()</code>ï¼š</p><h3 id="save-json"><a href="#save-json" class="headerlink" title="save_json()"></a>save_json()</h3><pre class="line-numbers language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">save_json</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>data_transfer<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>data_coco <span class="token operator">=</span> self<span class="token punctuation">.</span>data2coco<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># ä¿å­˜jsonæ–‡ä»¶</span>        json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>self<span class="token punctuation">.</span>data_coco<span class="token punctuation">,</span> open<span class="token punctuation">(</span>self<span class="token punctuation">.</span>save_json_path<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> indent<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> cls<span class="token operator">=</span>MyEncoder<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># indent=4 æ›´åŠ ç¾è§‚æ˜¾ç¤º</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªå¯ä»¥çœ‹åˆ°å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªè°ƒç”¨çš„ç±»å†…çš„å‡½æ•°æ¥æ€»ä½“è°ƒç”¨ã€‚æˆ‘ä»¬ç»§ç»­æ¥çœ‹data_transfer()</p><h3 id="data-transfer"><a href="#data-transfer" class="headerlink" title="data_transfer()"></a>data_transfer()</h3><pre class="line-numbers language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">data_transfer</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> num<span class="token punctuation">,</span> json_file <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>self<span class="token punctuation">.</span>labelme_json<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"num:"</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>num <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'    '</span> <span class="token operator">+</span> json_file<span class="token punctuation">)</span>            <span class="token keyword">with</span> open<span class="token punctuation">(</span>json_file<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>                data <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>fp<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># åŠ è½½jsonæ–‡ä»¶</span>                self<span class="token punctuation">.</span>images<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>image<span class="token punctuation">(</span>data<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># æ³¨æ„è¿™ä¸ªimageæ˜¯ä¸ªå‡½æ•°ï¼ å°†è¯¥å›¾ç‰‡çš„æ‰€æœ‰ç›¸åº”çš„ä¿¡æ¯è½¬åŒ–ä¸ºCOCOçš„imageæ ¼å¼</span>                <span class="token keyword">for</span> shapes <span class="token keyword">in</span> data<span class="token punctuation">[</span><span class="token string">'shapes'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>   <span class="token comment" spellcheck="true"># shapesæ˜¯ä¸»è¦çš„æ ‡æ³¨ä¿¡æ¯ï¼Œæˆ‘ä»¬é‡ç‚¹å°±æ˜¯è¯»å–è¿™ä¸ªï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰å¿…è¦è¯»å–æ‰€æœ‰ï¼Œå¯èƒ½åªéœ€è¦è¯»å–ç¬¬ä¸€ä¸ª780bå°±å¯ä»¥</span>                    label <span class="token operator">=</span> shapes<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># æ³¨æ„è¿™é‡Œæ˜¯ä¸€ä¸ªå¾ªç¯ï¼Œè¿™ä¸ªå¾ªç¯å°†æ‰€æœ‰çš„labelæœ‰å…³æ–‡ä»¶éƒ½å¾ªç¯äº†ä¸€é</span>                    <span class="token keyword">if</span> label <span class="token operator">not</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>label<span class="token punctuation">:</span>                        self<span class="token punctuation">.</span>categories<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>categorie<span class="token punctuation">(</span>label<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># æ³¨æ„è¿™ä¸ªself.categorieä¹Ÿæ˜¯ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªä»£ç æ®µå°±æ˜¯è¦ç”ŸæˆCOCOçš„categoriesæ ¼å¼</span>                        self<span class="token punctuation">.</span>label<span class="token punctuation">.</span>append<span class="token punctuation">(</span>label<span class="token punctuation">)</span>                    points <span class="token operator">=</span> shapes<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># è¿™é‡Œçš„pointæ˜¯ç”¨rectangleæ ‡æ³¨å¾—åˆ°çš„ï¼Œåªæœ‰ä¸¤ä¸ªç‚¹ï¼Œéœ€è¦è½¬æˆå››ä¸ªç‚¹</span>                    <span class="token comment" spellcheck="true">#points.append([points[0][0], points[1][1]])</span>                    <span class="token comment" spellcheck="true">#points.append([points[1][0], points[0][1]])</span>                    self<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>annotation<span class="token punctuation">(</span>points<span class="token punctuation">,</span> label<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># åŒæ ·çš„ï¼Œself.annotationä¹Ÿæ˜¯ä¸€ä¸ªç›¸åº”çš„å‡½æ•°è¦å°†æ‰€ç»™çš„pointsæ–‡ä»¶è½¬åŒ–ä¸ºannotationå’Œsegmentationæ–‡ä»¶</span>                    self<span class="token punctuation">.</span>annID <span class="token operator">+=</span> <span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œä¸€æ­¥ä¸€æ­¥è¯´ï¼Œé¦–å…ˆå°±æ˜¯è¦å°†æ‰€æœ‰çš„jsonæ–‡ä»¶å¾ªç¯éå†ä¸€éï¼Œä¹‹åæ‰“å¼€æ¯ä¸ªæ–‡ä»¶ï¼Œé¦–å…ˆåŠ è½½æ–‡ä»¶ï¼Œä¹‹åè°ƒç”¨ç±»ä¸­å®šä¹‰å¥½çš„self.image()å‡½æ•°,è¿™ä¸ªå‡½æ•°å°†è¯¥å›¾ç‰‡æ‰€æœ‰ç›¸åº”çš„ä¿¡æ¯è½¬åŒ–æˆCOCOçš„imageçš„æ ¼å¼ç„¶åè¿”å›COCOæ ¼å¼çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬å°†è¿™ä¸ªä¿¡æ¯åŠ åˆ°self.imagesä¸­å»ã€‚æˆ‘ä»¬å…ˆè§£æä¸€ä¸‹ç›¸å…³çš„self.image()å‡½æ•°ã€‚</p><h3 id="image"><a href="#image" class="headerlink" title="image()"></a>image()</h3><p>å®é™…ä¸Šimage()éœ€è¦çš„ä¿¡æ¯ä¹Ÿå°±æ˜¯ä¸€ä¸ªå›¾ç‰‡çš„é«˜å®½ã€å°†å›¾ç‰‡æ•´ç†æˆç¼–å·ï¼Œå›¾ç‰‡åã€‚</p><pre class="line-numbers language-python"><code class="language-python">image <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">"id"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"width"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"height"</span><span class="token punctuation">:</span> int<span class="token punctuation">,</span>    <span class="token string">"file_name"</span><span class="token punctuation">:</span> str<span class="token punctuation">,</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>imageå‡½æ•°å®é™…ä¸Šå°±æ˜¯è¯»å–äº†ä»¥ä¸Šçš„æä¾›çš„ä¿¡æ¯ç„¶åè½¬åŒ–è¿‡å»ï¼š</p><pre class="line-numbers language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">image</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">:</span>        image <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        img <span class="token operator">=</span> utils<span class="token punctuation">.</span>img_b64_to_arr<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'imageData'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># è§£æåŸå›¾ç‰‡æ•°æ®ï¼Œæ³¨æ„æˆ‘ä»¬å¹¶ä¸æ˜¯æ‰€æœ‰æ–‡ä»¶éƒ½æœ‰,æ€ªä¸å¾—æ‰€æœ‰æ–‡ä»¶éƒ½æ‰“å¼€è¿è¡Œä¼šæŠ¥é”™ï¼ŒçœŸæ˜¯å¥½å¥‡æ€ªï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡æ–‡ä»¶è·¯å¾„æ‰“å¼€ï¼Œå‚è§ä¸‹ä¸€è¡Œä»£ç </span>        <span class="token comment" spellcheck="true"># img=io.imread(os.path.join(root, data['imagePath'])) # é€šè¿‡å›¾ç‰‡è·¯å¾„æ‰“å¼€å›¾ç‰‡ï¼Œ ä¸è¿‡è¿™ä¸ªå°±éœ€è¦è®¾ä¸€ä¸ªå…¨å±€çš„root</span>        <span class="token comment" spellcheck="true"># img = cv2.imread(data['imagePath'], 0)</span>        height<span class="token punctuation">,</span> width <span class="token operator">=</span> img<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>        img <span class="token operator">=</span> None        image<span class="token punctuation">[</span><span class="token string">'height'</span><span class="token punctuation">]</span> <span class="token operator">=</span> height        image<span class="token punctuation">[</span><span class="token string">'width'</span><span class="token punctuation">]</span> <span class="token operator">=</span> width        image<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> num <span class="token operator">+</span> <span class="token number">1</span>        <span class="token comment" spellcheck="true">#image['file_name'] = data['imagePath'].split("\\")[-1] #æ­¤è¡Œä¸é€‚åˆæˆ‘çš„æ•°æ®é›†</span>        image<span class="token punctuation">[</span><span class="token string">'file_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'imagePath'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\\"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>height <span class="token operator">=</span> height        self<span class="token punctuation">.</span>width <span class="token operator">=</span> width        <span class="token keyword">return</span> image<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„åˆ°æˆ‘ä»¬æœ€ç»ˆè¿”å›çš„æ˜¯ä¸€ä¸ªå­—å…¸ã€‚<br>è¿™é‡Œæˆ‘ä»¬å‘ç°ç”¨åˆ°äº†ä¸€ä¸ªå‡½æ•°utils.img_b64_to_arr()ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯ç”¨æ¥å°†æˆ‘ä»¬çš„å›¾ç‰‡è¯»å–æˆcv2çš„imgæ ¼å¼çŸ©é˜µï¼Œè¿™ä¸ªutilså®é™…ä¸Šæ˜¯labelmeè¿™ä¸ªåº“ä¸­çš„ä¸€ä¸ªæ¨¡å—ã€‚ç›®å‰æˆ‘çš„ç†è§£æ˜¯ï¼Œlabelmeç”Ÿæˆçš„.jsonæ–‡ä»¶é‡Œé¢çš„imageDataæ˜¯ä¸€å †æˆ‘çœ‹ä¸æ‡‚çš„ç¼–ç ï¼Œè¿™äº›ç¼–ç å®é™…ä¸Šå­˜å‚¨çš„å°±æ˜¯å›¾ç‰‡çš„ä¿¡æ¯ï¼Œç„¶åæˆ‘ä»¬é€šè¿‡<code>img_b64_to_arr()</code>å‡½æ•°æ¥â€œç¿»è¯‘â€ä¸ºæˆ‘ä»¬èƒ½çœ‹æ‡‚çš„å›¾ç‰‡RGBçŸ©é˜µå½¢å¼å­˜å‚¨ã€‚<br>å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„æ³¨é‡Šä¹Ÿç»™å‡ºäº†ä¸€äº›å…¶ä»–æ–¹å¼çš„æ‰“å¼€å›¾ç‰‡å½¢å¼ï¼Œæœ‰ç”¨cv2è¯»å–ï¼Œæœ‰ç”¨skimage.ioè¯»å–çš„ï¼Œå› ä¸ºæœ‰å¯èƒ½æˆ‘ä»¬data[â€˜imageDataâ€™]çš„å€¼ä¸ºnull(<del>æˆ‘ç›®å‰é¡¹ç›®çš„æ•°æ®é›†å°±æ˜¯è¿™æ ·</del>)ã€‚å…¶ä»–çš„æ ¼å¼éƒ½æ˜¯å¾ˆç®€å•çš„å¤åˆ¶äº†ï¼Œç›¸å¯¹è€Œè¨€ä¸ç”¨å¤šè¯´ã€‚</p><h3 id="data-transfer-1"><a href="#data-transfer-1" class="headerlink" title="data_transfer()"></a>data_transfer()</h3><p>å¥½äº†æˆ‘ä»¬æ¥ä¸‹æ¥ç»§ç»­è¯´æˆ‘ä»¬çš„data_transfer()å‡½æ•°ã€‚æ¥ä¸‹æ¥æ˜¯å¯¹data[â€˜shapesâ€™]æ‰€æœ‰æ–‡ä»¶è¿›è¡Œä¸€ä¸ªéå†ï¼Œshapesæ˜¯ä¸»è¦çš„æ ‡æ³¨ä¿¡æ¯ï¼Œæˆ‘ä»¬é‡ç‚¹å°±æ˜¯è¯»å–è¿™ä¸ªï¼Œshapesé‡Œé¢åŒ…å«ç€æ‰€æœ‰çš„æ ‡æ³¨æ¡†ground truthä¿¡æ¯ï¼Œå½“ç„¶æˆ‘ä»¬è¿™é‡Œå› ä¸ºä»…ä»…å¯¹ä¸€ä¸ªå¤§æ¡†åšåˆ†å‰²æ‰€ä»¥åªéœ€è¦ä¸€ä¸ª780Bçš„labelå°±å¯ä»¥ï¼Œè¿™é‡Œå®ƒå°†æ‰€æœ‰éƒ½éå†äº†ä¸€éï¼Œç„¶åè°ƒç”¨äº†self.categorieå‡½æ•°æ¥è®©æˆ‘ä»¬çš„labelé‡Œé¢çš„ä¿¡æ¯è½¬åŒ–ä¸ºCOCOæ ¼å¼çš„ã€‚å®é™…ä¸Šå°±æ˜¯å˜ä¸ºCOCOæ ¼å¼jsonæ–‡ä»¶ä¸­é‚£ä¸ªcategoriesç±»å‹ï¼Œæˆ‘ä»¬ç»§ç»­æ¥çœ‹self.categorie()</p><h3 id="categorie"><a href="#categorie" class="headerlink" title="categorie()"></a>categorie()</h3><pre class="line-numbers language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">categorie</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> label<span class="token punctuation">)</span><span class="token punctuation">:</span>        categorie <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        categorie<span class="token punctuation">[</span><span class="token string">'supercategory'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Cancer'</span>        categorie<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> len<span class="token punctuation">(</span>self<span class="token punctuation">.</span>label<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>  <span class="token comment" spellcheck="true"># 0 é»˜è®¤ä¸ºèƒŒæ™¯</span>        categorie<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> label        <span class="token keyword">return</span> categorie<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®é™…ä¸Šéå¸¸ç®€å•ï¼Œå› ä¸ºCOCOé‡Œé¢çš„categoriesåªéœ€è¦çŸ¥é“æ•´ä¸ªæ•°æ®é›†æœ‰å“ªäº›ç±»ï¼Œæ¯ä¸ªç±»éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„idå°±OKäº†ã€‚</p><h3 id="data-transfer-2"><a href="#data-transfer-2" class="headerlink" title="data_transfer()"></a>data_transfer()</h3><p>å®é™…ä¸Šåé¢éƒ½æ˜¯ç±»ä¼¼çš„ï¼Œå¯¹åº”çš„åŠŸèƒ½è°ƒç”¨ç›¸åº”çš„å‡½æ•°å°±OKã€‚è¿™é‡Œä¸è¯¦ç»†è°ˆäº†ï¼Œæ²¡æœ‰å¿…è¦è¯¦ç»†è§£é‡Šã€‚</p><h3 id="data2coco"><a href="#data2coco" class="headerlink" title="data2coco()"></a>data2coco()</h3><p>éšåæˆ‘ä»¬çœ‹åˆ°è¿™é‡Œè°ƒç”¨äº†ç›¸å…³çš„å‡½æ•°è½¬åŒ–ä¸ºjsonæ–‡ä»¶éœ€è¦çš„å­—å…¸æ ¼å¼ï¼š</p><pre class="line-numbers language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">data2coco</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        data_coco <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        data_coco<span class="token punctuation">[</span><span class="token string">'images'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>images        data_coco<span class="token punctuation">[</span><span class="token string">'categories'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>categories        data_coco<span class="token punctuation">[</span><span class="token string">'annotations'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>annotations        <span class="token keyword">return</span> data_coco<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€åè¿›è¡Œä¸€ä¸‹json.dumpå°±æˆåŠŸä¿å­˜å¥½jsonæ–‡ä»¶äº†ã€‚</p><h2 id="è½¬åŒ–ä»£ç æœ€ç»ˆæ”¹è‰¯ç‰ˆ"><a href="#è½¬åŒ–ä»£ç æœ€ç»ˆæ”¹è‰¯ç‰ˆ" class="headerlink" title="è½¬åŒ–ä»£ç æœ€ç»ˆæ”¹è‰¯ç‰ˆ"></a>è½¬åŒ–ä»£ç æœ€ç»ˆæ”¹è‰¯ç‰ˆ</h2><p>ç»è¿‡ä¸Šè¿°æè¿°ï¼Œæœ€ç»ˆåšä¸€ä¸ªæ”¹è‰¯ï¼Œå¾—åˆ°ç›¸åº”çš„ç»“æœï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token triple-quoted-string string">"""æœ¬æ¨¡å—ç”¨äºæ‰¹é‡è½¬æ¢labelmeæ ‡è®°çš„æ ¼å¼ï¼Œä½¿ä¹‹å˜æˆcocoæ•°æ®é›†æ ¼å¼"""</span><span class="token comment" spellcheck="true"># -*- coding:utf-8 -*-</span><span class="token comment" spellcheck="true"># !/usr/bin/env python</span><span class="token keyword">import</span> argparse<span class="token keyword">import</span> json<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">import</span> skimage<span class="token punctuation">.</span>io <span class="token keyword">as</span> io<span class="token keyword">import</span> cv2<span class="token keyword">from</span> labelme <span class="token keyword">import</span> utils<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> glob<span class="token keyword">import</span> PIL<span class="token punctuation">.</span>Image<span class="token keyword">import</span> os<span class="token keyword">class</span> <span class="token class-name">MyEncoder</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span>JSONEncoder<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">default</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> isinstance<span class="token punctuation">(</span>obj<span class="token punctuation">,</span> np<span class="token punctuation">.</span>integer<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> int<span class="token punctuation">(</span>obj<span class="token punctuation">)</span>        <span class="token keyword">elif</span> isinstance<span class="token punctuation">(</span>obj<span class="token punctuation">,</span> np<span class="token punctuation">.</span>floating<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> float<span class="token punctuation">(</span>obj<span class="token punctuation">)</span>        <span class="token keyword">elif</span> isinstance<span class="token punctuation">(</span>obj<span class="token punctuation">,</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> obj<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> super<span class="token punctuation">(</span>MyEncoder<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">labelme2coco</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> labelme_json<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> save_json_path<span class="token operator">=</span><span class="token string">'./tran.json'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># è¿™é‡Œå®šä¹‰äº†é»˜è®¤çš„å­˜å‚¨è·¯å¾„</span>        <span class="token triple-quoted-string string">'''        labelme_json: æ‰€æœ‰labelmeçš„jsonæ–‡ä»¶è·¯å¾„ç»„æˆçš„åˆ—è¡¨        save_json_path: jsonä¿å­˜ä½ç½®        '''</span>        self<span class="token punctuation">.</span>labelme_json <span class="token operator">=</span> labelme_json     <span class="token comment" spellcheck="true"># labelme_jsonçš„æ–‡ä»¶è·¯å¾„ï¼Œæ˜¯ä¸€ä¸ªåˆ—è¡¨å­˜å‚¨ç€æ‰€æœ‰çš„å¾…è½¬åŒ–jsonæ–‡ä»¶è·¯å¾„</span>        self<span class="token punctuation">.</span>save_json_path <span class="token operator">=</span> save_json_path  <span class="token comment" spellcheck="true"># ä¿å­˜çš„è·¯å¾„</span>        self<span class="token punctuation">.</span>images <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># å¯¹åº”ç”ŸæˆCOCOå½¢å¼jsonæ–‡ä»¶çš„imageçš„ç±»å‹ã€‚</span>        self<span class="token punctuation">.</span>categories <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># åŒä¸Š</span>        self<span class="token punctuation">.</span>annotations <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># åŒä¸Š</span>        <span class="token comment" spellcheck="true"># self.data_coco = {}</span>        self<span class="token punctuation">.</span>label <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>annID <span class="token operator">=</span> <span class="token number">1</span>        self<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">0</span>        self<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">0</span>        self<span class="token punctuation">.</span>root <span class="token operator">=</span> <span class="token string">'/home/lry/projects/mmdetection/data/780b/'</span>        self<span class="token punctuation">.</span>save_json<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># æ³¨æ„è¿™é‡Œä¸€è°ƒç”¨è¯¥ç±»å°±ç›´æ¥è¿è¡Œç›¸å…³çš„æ‰€æœ‰ä»£ç äº†ï¼Œè¿™ä¸ªæŠ€å·§å¾ˆæœ‰ç”¨ã€‚</span>    <span class="token keyword">def</span> <span class="token function">data_transfer</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> num<span class="token punctuation">,</span> json_file <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>self<span class="token punctuation">.</span>labelme_json<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"num:"</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>num <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'    '</span> <span class="token operator">+</span> json_file<span class="token punctuation">)</span>            <span class="token keyword">with</span> open<span class="token punctuation">(</span>json_file<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>                data <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>fp<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># åŠ è½½jsonæ–‡ä»¶</span>                <span class="token comment" spellcheck="true"># æ³¨æ„è¿™ä¸ªimageæ˜¯ä¸ªå‡½æ•°ï¼ å°†è¯¥å›¾ç‰‡çš„æ‰€æœ‰ç›¸åº”çš„ä¿¡æ¯è½¬åŒ–ä¸ºCOCOçš„imageæ ¼å¼</span>                self<span class="token punctuation">.</span>images<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>image<span class="token punctuation">(</span>data<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># shapesæ˜¯ä¸»è¦çš„æ ‡æ³¨ä¿¡æ¯ï¼Œæˆ‘ä»¬é‡ç‚¹å°±æ˜¯è¯»å–è¿™ä¸ªï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰å¿…è¦è¯»å–æ‰€æœ‰ï¼Œå¯èƒ½åªéœ€è¦è¯»å–ç¬¬ä¸€ä¸ª780bå°±å¯ä»¥</span>                <span class="token keyword">for</span> shapes <span class="token keyword">in</span> data<span class="token punctuation">[</span><span class="token string">'shapes'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                    <span class="token comment" spellcheck="true"># é¦–å…ˆæˆ‘ä»¬ä¼šåˆ¤æ–­æ˜¯å¦è¿™ä¸ªlabelæ˜¯å¦æ˜¯"780B"</span>                    <span class="token keyword">if</span> shapes<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"780B"</span><span class="token punctuation">:</span>                        <span class="token keyword">continue</span>                    <span class="token comment" spellcheck="true"># æ³¨æ„è¿™é‡Œæ˜¯ä¸€ä¸ªå¾ªç¯ï¼Œè¿™ä¸ªå¾ªç¯å°†æ‰€æœ‰çš„labelæœ‰å…³æ–‡ä»¶éƒ½å¾ªç¯äº†ä¸€é</span>                    label <span class="token operator">=</span> shapes<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span>                    <span class="token keyword">if</span> label <span class="token operator">not</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>label<span class="token punctuation">:</span>                        <span class="token comment" spellcheck="true"># æ³¨æ„è¿™ä¸ªself.categorieä¹Ÿæ˜¯ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªä»£ç æ®µå°±æ˜¯è¦ç”ŸæˆCOCOçš„categoriesæ ¼å¼</span>                        self<span class="token punctuation">.</span>categories<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>categorie<span class="token punctuation">(</span>label<span class="token punctuation">)</span><span class="token punctuation">)</span>                        self<span class="token punctuation">.</span>label<span class="token punctuation">.</span>append<span class="token punctuation">(</span>label<span class="token punctuation">)</span>                    <span class="token comment" spellcheck="true"># è¿™é‡Œçš„pointæ˜¯ç”¨rectangleæ ‡æ³¨å¾—åˆ°çš„ï¼Œåªæœ‰ä¸¤ä¸ªç‚¹ï¼Œéœ€è¦è½¬æˆå››ä¸ªç‚¹</span>                    points <span class="token operator">=</span> shapes<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span>                    <span class="token comment" spellcheck="true">#points.append([points[0][0], points[1][1]])</span>                    <span class="token comment" spellcheck="true">#points.append([points[1][0], points[0][1]])</span>                    <span class="token comment" spellcheck="true"># åŒæ ·çš„ï¼Œself.annotationä¹Ÿæ˜¯ä¸€ä¸ªç›¸åº”çš„å‡½æ•°è¦å°†æ‰€ç»™çš„pointsæ–‡ä»¶è½¬åŒ–ä¸ºannotationå’Œsegmentationæ–‡ä»¶</span>                    self<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span>append<span class="token punctuation">(</span>                        self<span class="token punctuation">.</span>annotation<span class="token punctuation">(</span>points<span class="token punctuation">,</span> label<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">)</span>                    self<span class="token punctuation">.</span>annID <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token keyword">def</span> <span class="token function">image</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">:</span>        image <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        <span class="token comment" spellcheck="true"># è§£æåŸå›¾ç‰‡æ•°æ®ï¼Œæ³¨æ„æˆ‘ä»¬å¹¶ä¸æ˜¯æ‰€æœ‰æ–‡ä»¶éƒ½æœ‰,æ€ªä¸å¾—æ‰€æœ‰æ–‡ä»¶éƒ½æ‰“å¼€è¿è¡Œä¼šæŠ¥é”™ï¼ŒçœŸæ˜¯å¥½å¥‡æ€ªï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡æ–‡ä»¶è·¯å¾„æ‰“å¼€ï¼Œå‚è§ä¸‹ä¸€è¡Œä»£ç </span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            img <span class="token operator">=</span> utils<span class="token punctuation">.</span>img_b64_to_arr<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'imageData'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            img<span class="token operator">=</span>io<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>self<span class="token punctuation">.</span>root<span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token string">'imagePath'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># é€šè¿‡å›¾ç‰‡è·¯å¾„æ‰“å¼€å›¾ç‰‡ï¼Œ ä¸è¿‡è¿™ä¸ªå°±éœ€è¦è®¾ä¸€ä¸ªå…¨å±€çš„root</span>        <span class="token comment" spellcheck="true"># img = cv2.imread(data['imagePath'], 0)</span>        height<span class="token punctuation">,</span> width <span class="token operator">=</span> img<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>        img <span class="token operator">=</span> None        image<span class="token punctuation">[</span><span class="token string">'height'</span><span class="token punctuation">]</span> <span class="token operator">=</span> height        image<span class="token punctuation">[</span><span class="token string">'width'</span><span class="token punctuation">]</span> <span class="token operator">=</span> width        image<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> num <span class="token operator">+</span> <span class="token number">1</span>        <span class="token comment" spellcheck="true"># image['file_name'] = data['imagePath'].split("\\")[-1] #æ­¤è¡Œä¸é€‚åˆæˆ‘çš„æ•°æ®é›†</span>        image<span class="token punctuation">[</span><span class="token string">'file_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'imagePath'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\\"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>height <span class="token operator">=</span> height        self<span class="token punctuation">.</span>width <span class="token operator">=</span> width        <span class="token keyword">return</span> image    <span class="token keyword">def</span> <span class="token function">categorie</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> label<span class="token punctuation">)</span><span class="token punctuation">:</span>        categorie <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        <span class="token comment" spellcheck="true"># categorie['supercategory'] = 'Cancer'  # è¿™ä¸ªæ— ç”¨</span>        categorie<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> len<span class="token punctuation">(</span>self<span class="token punctuation">.</span>label<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>  <span class="token comment" spellcheck="true"># 0 é»˜è®¤ä¸ºèƒŒæ™¯</span>        categorie<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> label        <span class="token keyword">return</span> categorie    <span class="token keyword">def</span> <span class="token function">annotation</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> points<span class="token punctuation">,</span> label<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">:</span>        annotation <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        annotation<span class="token punctuation">[</span><span class="token string">'segmentation'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>list<span class="token punctuation">(</span>np<span class="token punctuation">.</span>asarray<span class="token punctuation">(</span>points<span class="token punctuation">)</span><span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>        annotation<span class="token punctuation">[</span><span class="token string">'iscrowd'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>        annotation<span class="token punctuation">[</span><span class="token string">'image_id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> num <span class="token operator">+</span> <span class="token number">1</span>        <span class="token comment" spellcheck="true"># annotation['bbox'] = str(self.getbbox(points)) # ä½¿ç”¨listä¿å­˜jsonæ–‡ä»¶æ—¶æŠ¥é”™ï¼ˆä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼‰</span>        <span class="token comment" spellcheck="true"># list(map(int,a[1:-1].split(','))) a=annotation['bbox'] ä½¿ç”¨è¯¥æ–¹å¼è½¬æˆlist</span>        annotation<span class="token punctuation">[</span><span class="token string">'bbox'</span><span class="token punctuation">]</span> <span class="token operator">=</span> list<span class="token punctuation">(</span>map<span class="token punctuation">(</span>float<span class="token punctuation">,</span> self<span class="token punctuation">.</span>getbbox<span class="token punctuation">(</span>points<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        annotation<span class="token punctuation">[</span><span class="token string">'area'</span><span class="token punctuation">]</span> <span class="token operator">=</span> annotation<span class="token punctuation">[</span><span class="token string">'bbox'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> annotation<span class="token punctuation">[</span><span class="token string">'bbox'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># annotation['category_id'] = self.getcatid(label)</span>        annotation<span class="token punctuation">[</span><span class="token string">'category_id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>getcatid<span class="token punctuation">(</span>label<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># æ³¨æ„ï¼Œæºä»£ç é»˜è®¤ä¸º1</span>        annotation<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>annID        <span class="token keyword">return</span> annotation    <span class="token keyword">def</span> <span class="token function">getcatid</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> label<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> categorie <span class="token keyword">in</span> self<span class="token punctuation">.</span>categories<span class="token punctuation">:</span>            <span class="token keyword">if</span> label <span class="token operator">==</span> categorie<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                <span class="token keyword">return</span> categorie<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span>        <span class="token keyword">return</span> <span class="token number">1</span>    <span class="token keyword">def</span> <span class="token function">getbbox</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> points<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># img = np.zeros([self.height,self.width],np.uint8)</span>        <span class="token comment" spellcheck="true"># cv2.polylines(img, [np.asarray(points)], True, 1, lineType=cv2.LINE_AA)  # ç”»è¾¹ç•Œçº¿</span>        <span class="token comment" spellcheck="true"># cv2.fillPoly(img, [np.asarray(points)], 1)  # ç”»å¤šè¾¹å½¢ å†…éƒ¨åƒç´ å€¼ä¸º1</span>        polygons <span class="token operator">=</span> points        mask <span class="token operator">=</span> self<span class="token punctuation">.</span>polygons_to_mask<span class="token punctuation">(</span><span class="token punctuation">[</span>self<span class="token punctuation">.</span>height<span class="token punctuation">,</span> self<span class="token punctuation">.</span>width<span class="token punctuation">]</span><span class="token punctuation">,</span> polygons<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># print(polygons)</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>mask2box<span class="token punctuation">(</span>mask<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">mask2box</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> mask<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">'''ä»maskåç®—å‡ºå…¶è¾¹æ¡†        maskï¼š[h,w]  0ã€1ç»„æˆçš„å›¾ç‰‡        1å¯¹åº”å¯¹è±¡ï¼Œåªéœ€è®¡ç®—1å¯¹åº”çš„è¡Œåˆ—å·ï¼ˆå·¦ä¸Šè§’è¡Œåˆ—å·ï¼Œå³ä¸‹è§’è¡Œåˆ—å·ï¼Œå°±å¯ä»¥ç®—å‡ºå…¶è¾¹æ¡†ï¼‰        '''</span>        <span class="token comment" spellcheck="true"># np.where(mask==1)</span>        index <span class="token operator">=</span> np<span class="token punctuation">.</span>argwhere<span class="token punctuation">(</span>mask <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># print(index)</span>        rows <span class="token operator">=</span> index<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>        clos <span class="token operator">=</span> index<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># è§£æå·¦ä¸Šè§’è¡Œåˆ—å·</span>        <span class="token comment" spellcheck="true"># print(rows)</span>        left_top_r <span class="token operator">=</span> np<span class="token punctuation">.</span>min<span class="token punctuation">(</span>rows<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># y</span>        left_top_c <span class="token operator">=</span> np<span class="token punctuation">.</span>min<span class="token punctuation">(</span>clos<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># x</span>        <span class="token comment" spellcheck="true"># è§£æå³ä¸‹è§’è¡Œåˆ—å·</span>        right_bottom_r <span class="token operator">=</span> np<span class="token punctuation">.</span>max<span class="token punctuation">(</span>rows<span class="token punctuation">)</span>        right_bottom_c <span class="token operator">=</span> np<span class="token punctuation">.</span>max<span class="token punctuation">(</span>clos<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># return [(left_top_r,left_top_c),(right_bottom_r,right_bottom_c)]</span>        <span class="token comment" spellcheck="true"># return [(left_top_c, left_top_r), (right_bottom_c, right_bottom_r)]</span>        <span class="token comment" spellcheck="true"># return [left_top_c, left_top_r, right_bottom_c, right_bottom_r]  # [x1,y1,x2,y2]</span>        <span class="token keyword">return</span> <span class="token punctuation">[</span>left_top_c<span class="token punctuation">,</span> left_top_r<span class="token punctuation">,</span> right_bottom_c <span class="token operator">-</span> left_top_c<span class="token punctuation">,</span>                right_bottom_r <span class="token operator">-</span> left_top_r<span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># [x1,y1,w,h] å¯¹åº”COCOçš„bboxæ ¼å¼</span>    <span class="token keyword">def</span> <span class="token function">polygons_to_mask</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> img_shape<span class="token punctuation">,</span> polygons<span class="token punctuation">)</span><span class="token punctuation">:</span>        mask <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>img_shape<span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>        mask <span class="token operator">=</span> PIL<span class="token punctuation">.</span>Image<span class="token punctuation">.</span>fromarray<span class="token punctuation">(</span>mask<span class="token punctuation">)</span>        xy <span class="token operator">=</span> list<span class="token punctuation">(</span>map<span class="token punctuation">(</span>tuple<span class="token punctuation">,</span> polygons<span class="token punctuation">)</span><span class="token punctuation">)</span>        PIL<span class="token punctuation">.</span>ImageDraw<span class="token punctuation">.</span>Draw<span class="token punctuation">(</span>mask<span class="token punctuation">)</span><span class="token punctuation">.</span>polygon<span class="token punctuation">(</span>xy<span class="token operator">=</span>xy<span class="token punctuation">,</span> outline<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> fill<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>        mask <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>mask<span class="token punctuation">,</span> dtype<span class="token operator">=</span>bool<span class="token punctuation">)</span>        <span class="token keyword">return</span> mask    <span class="token keyword">def</span> <span class="token function">data2coco</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        data_coco <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        data_coco<span class="token punctuation">[</span><span class="token string">'images'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>images        data_coco<span class="token punctuation">[</span><span class="token string">'categories'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>categories        data_coco<span class="token punctuation">[</span><span class="token string">'annotations'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>annotations        <span class="token keyword">return</span> data_coco    <span class="token keyword">def</span> <span class="token function">save_json</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>data_transfer<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>data_coco <span class="token operator">=</span> self<span class="token punctuation">.</span>data2coco<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># ä¿å­˜jsonæ–‡ä»¶</span>        json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>self<span class="token punctuation">.</span>data_coco<span class="token punctuation">,</span> open<span class="token punctuation">(</span>self<span class="token punctuation">.</span>save_json_path<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                  indent<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> cls<span class="token operator">=</span>MyEncoder<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># indent=4 æ›´åŠ ç¾è§‚æ˜¾ç¤º</span><span class="token comment" spellcheck="true"># labelme_json = glob.glob(</span><span class="token comment" spellcheck="true">#     '/home/lry/projects/mmdetection/data/780b/*.json')</span><span class="token comment" spellcheck="true"># print(labelme_json)</span><span class="token comment" spellcheck="true"># # labelme_json=['./Annotations/*.json']</span><span class="token comment" spellcheck="true"># # labelme_json=glob.glob('./Annotations/*.json')</span><span class="token comment" spellcheck="true"># saveme_json = '/home/lry/projects/mmdetection/lry/draft.json'</span><span class="token comment" spellcheck="true"># print("Start.")</span><span class="token comment" spellcheck="true"># labelme2coco(labelme_json, saveme_json)</span><span class="token comment" spellcheck="true"># print("Finished.")</span>val_json <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">'/home/lry/data/780b_std/val/*.json'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>val_json<span class="token punctuation">)</span>saveme_json <span class="token operator">=</span> <span class="token string">'/home/lry/data/780b_std/val/annotation_coco.json'</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Start."</span><span class="token punctuation">)</span>labelme2coco<span class="token punctuation">(</span>val_json<span class="token punctuation">,</span> saveme_json<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Finished."</span><span class="token punctuation">)</span>train_json <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">'/home/lry/data/780b_std/train/*.json'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>train_json<span class="token punctuation">)</span>saveme_json <span class="token operator">=</span> <span class="token string">'/home/lry/data/780b_std/train/annotation_coco.json'</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Start."</span><span class="token punctuation">)</span>labelme2coco<span class="token punctuation">(</span>train_json<span class="token punctuation">,</span> saveme_json<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Finished."</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="åˆ’åˆ†è®­ç»ƒé›†å’ŒéªŒè¯é›†"><a href="#åˆ’åˆ†è®­ç»ƒé›†å’ŒéªŒè¯é›†" class="headerlink" title="åˆ’åˆ†è®­ç»ƒé›†å’ŒéªŒè¯é›†"></a>åˆ’åˆ†è®­ç»ƒé›†å’ŒéªŒè¯é›†</h2><p>è¿™é‡ŒæŒ‰ç…§7ï¼š3æ¥åˆ’åˆ†è®­ç»ƒé›†å’ŒéªŒè¯é›†:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token triple-quoted-string string">"""æœ¬æ¨¡å—ç”¨äºåˆ’åˆ†éªŒè¯é›†å’Œæµ‹è¯•é›†ï¼Œå¤§æ¦‚æ¯”ä¾‹ä¸º7ï¼š3"""</span><span class="token keyword">import</span> shutil<span class="token keyword">import</span> os<span class="token keyword">import</span> random<span class="token keyword">import</span> glob<span class="token keyword">def</span> <span class="token function">move_file</span><span class="token punctuation">(</span>old_path<span class="token punctuation">,</span> imgs<span class="token punctuation">,</span>  new_path<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">'''è¿™ä¸ªå‡½æ•°æ˜¯ç”¨æ¥ç§»åŠ¨å›¾ç‰‡å’Œç›¸åº”çš„jsonæ–‡ä»¶'''</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>old_path<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>new_path<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># filelist = os.listdir(old_path) #åˆ—å‡ºè¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶,listdirè¿”å›çš„æ–‡ä»¶åˆ—è¡¨æ˜¯ä¸åŒ…å«è·¯å¾„çš„ã€‚</span>    filelist <span class="token operator">=</span> imgs    <span class="token keyword">print</span><span class="token punctuation">(</span>filelist<span class="token punctuation">)</span>    <span class="token keyword">for</span> file <span class="token keyword">in</span> filelist<span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># file = file - "/home/lry/data/780b_std/"</span>        src <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>old_path<span class="token punctuation">,</span> file<span class="token punctuation">[</span>len<span class="token punctuation">(</span><span class="token string">"/home/lry/data/780b_std/"</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        dst <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>new_path<span class="token punctuation">,</span> file<span class="token punctuation">[</span>len<span class="token punctuation">(</span><span class="token string">"/home/lry/data/780b_std/"</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        src_json <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>old_path<span class="token punctuation">,</span> file<span class="token punctuation">[</span>len<span class="token punctuation">(</span><span class="token string">"/home/lry/data/780b_std/"</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'.jpg'</span><span class="token punctuation">)</span>        dst_json <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>new_path<span class="token punctuation">,</span> file<span class="token punctuation">[</span>len<span class="token punctuation">(</span><span class="token string">"/home/lry/data/780b_std/"</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'.jpg'</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'src:'</span><span class="token punctuation">,</span> src<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'dst:'</span><span class="token punctuation">,</span> dst<span class="token punctuation">)</span>        shutil<span class="token punctuation">.</span>move<span class="token punctuation">(</span>src<span class="token punctuation">,</span> dst<span class="token punctuation">)</span>        shutil<span class="token punctuation">.</span>move<span class="token punctuation">(</span>src_json<span class="token punctuation">,</span> dst_json<span class="token punctuation">)</span>old_path <span class="token operator">=</span> <span class="token string">"/home/lry/data/780b_std"</span>new_val <span class="token operator">=</span> <span class="token string">"/home/lry/data/780b_std/val"</span>new_train <span class="token operator">=</span> <span class="token string">"/home/lry/data/780b_std/train"</span>pics <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">"/home/lry/data/780b_std/*.json"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># print(len(pics))</span><span class="token comment" spellcheck="true"># print(pics[0][len("/home/lry/data/780b_std/"):-5] + ".jpg")</span><span class="token comment" spellcheck="true"># print(pics[0][:-4])</span><span class="token comment" spellcheck="true"># print(pics)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"moving...."</span><span class="token punctuation">)</span>move_file<span class="token punctuation">(</span>old_path<span class="token punctuation">,</span> pics<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">140</span><span class="token punctuation">]</span><span class="token punctuation">,</span> new_train<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"train end!"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"moving..."</span><span class="token punctuation">)</span>move_file<span class="token punctuation">(</span>old_path<span class="token punctuation">,</span> pics<span class="token punctuation">[</span><span class="token number">140</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> new_val<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"val end!"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è®¾å®šconfigæ–‡ä»¶"><a href="#è®¾å®šconfigæ–‡ä»¶" class="headerlink" title="è®¾å®šconfigæ–‡ä»¶"></a>è®¾å®šconfigæ–‡ä»¶</h2><p>æˆ‘ä»¬å†³å®šç”¨mask_rcnnï¼Œè¿™é‡Œç›´æ¥åœ¨<code>configs</code>ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹å«åšfenghuoï¼Œç„¶ååŠ å…¥ä¸€ä¸ª<code>mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_fenghuo.py</code>æ–‡ä»¶å°±OKã€‚æ–‡ä»¶å†…å®¹ä¸ºï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token triple-quoted-string string">"""æœ¬æ¨¡å—ç”¨äºæ”¾ç½®configsï¼Œå®šä¹‰æ¨¡å‹ç»“æ„,è¯¥é…ç½®æ–‡ä»¶å°†æ”¾åˆ°`/home/lry/projects/mmdetection/configs/fenghuo/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_balloon.py`"""</span><span class="token comment" spellcheck="true"># The new config inherits a base config to highlight the necessary modification</span>_base_ <span class="token operator">=</span> <span class="token string">'../mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_coco.py'</span><span class="token comment" spellcheck="true"># We also need to change the num_classes in head to match the dataset's annotation</span>model <span class="token operator">=</span> dict<span class="token punctuation">(</span>    roi_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>        bbox_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>num_classes<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        mask_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>num_classes<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># Modify dataset related settings</span>dataset_type <span class="token operator">=</span> <span class="token string">'COCODataset'</span>classes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'780B'</span><span class="token punctuation">,</span><span class="token punctuation">)</span>data <span class="token operator">=</span> dict<span class="token punctuation">(</span>    train<span class="token operator">=</span>dict<span class="token punctuation">(</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/780b_std/train/'</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/780b_std/train/annotation_coco.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    val<span class="token operator">=</span>dict<span class="token punctuation">(</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/780b_std/val/'</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/780b_std/val/annotation_coco.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    test<span class="token operator">=</span>dict<span class="token punctuation">(</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/780b_std/val/'</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/780b_std/val/annotation_coco.json'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># We can use the pre-trained Mask RCNN model to obtain higher performance</span>load_from <span class="token operator">=</span> <span class="token string">'checkpoints/mask_rcnn_r50_caffe_fpn_mstrain-poly_3x_coco_bbox_mAP-0.408__segm_mAP-0.37_20200504_163245-42aa3d00.pth'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è®­ç»ƒæ¨¡å‹"><a href="#è®­ç»ƒæ¨¡å‹" class="headerlink" title="è®­ç»ƒæ¨¡å‹"></a>è®­ç»ƒæ¨¡å‹</h2><pre class="line-numbers language-python"><code class="language-python">python tools<span class="token operator">/</span>train<span class="token punctuation">.</span>py configs<span class="token operator">/</span>fenghuo<span class="token operator">/</span>mask_rcnn_r50_caffe_fpn_mstrain<span class="token operator">-</span>poly_1x_fenghuo<span class="token punctuation">.</span>py<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="æµ‹è¯•æ¨¡å‹"><a href="#æµ‹è¯•æ¨¡å‹" class="headerlink" title="æµ‹è¯•æ¨¡å‹"></a>æµ‹è¯•æ¨¡å‹</h2><pre class="line-numbers language-python"><code class="language-python">CUDA_VISIBLE<span class="token operator">=</span><span class="token number">1</span> python tools<span class="token operator">/</span>test<span class="token punctuation">.</span>py configs<span class="token operator">/</span>fenghuo<span class="token operator">/</span>mask_rcnn_r50_caffe_fpn_mstrain<span class="token operator">-</span>poly_1x_fenghuo<span class="token punctuation">.</span>py work_dirs<span class="token operator">/</span>mask_rcnn_r50_caffe_fpn_mstrain<span class="token operator">-</span>poly_1x_fenghuo<span class="token operator">/</span>latest<span class="token punctuation">.</span>pth  <span class="token operator">-</span><span class="token operator">-</span>eval bbox segm<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="2021-11-14æ—¥æ—©æ›´æ–°"><a href="#2021-11-14æ—¥æ—©æ›´æ–°" class="headerlink" title="2021.11.14æ—¥æ—©æ›´æ–°"></a>2021.11.14æ—¥æ—©æ›´æ–°</h1><ul><li>è¿œç¨‹ä»“åº“ï¼š<a href="https://www.jianshu.com/p/e4bb2ac7e770" target="_blank" rel="noopener">https://www.jianshu.com/p/e4bb2ac7e770</a></li></ul><p>ç›®å‰éœ€è¦æ–°å»ºè¿œç¨‹GitHubä»“åº“æ–¹ä¾¿æˆ‘ä¸åˆ«äººåä½œ</p><p>ç›®å‰æ•´ä¸ªå¤§æ¡†çš„æ£€æµ‹è¿˜æ¯”è¾ƒæˆåŠŸï¼Œæ¥ç€å°±æ˜¯æ£€æµ‹æ¯ä¸ªå°æ¡†çš„åˆ†ç±»ä»»åŠ¡ã€‚</p><h1 id="2021-11-29æ—¥æ™šæ›´æ–°"><a href="#2021-11-29æ—¥æ™šæ›´æ–°" class="headerlink" title="2021.11.29æ—¥æ™šæ›´æ–°"></a>2021.11.29æ—¥æ™šæ›´æ–°</h1><p>è¿œç¨‹ä»“åº“åˆ›å»ºæˆåŠŸï¼Œä»“åº“åœ°å€ï¼š<a href="https://github.com/LRY89757/mmdet-for-fenghuo" target="_blank" rel="noopener">çƒ½ç«æ£€æµ‹</a></p><p>ç›®å‰éœ€è¦åšçš„äº‹æƒ…ï¼š</p><ul><li>å†™ä¸€ä¸ªå…³äºè¿™ç±»Labelmeæ–‡æ¡£éœ€è¦çš„dataloaderï¼Œå†™ä¸€ä¸ªå°½é‡æ¯”è¾ƒå…¨é¢é€‚é…æ€§æ¯”è¾ƒå¼ºã€å¯è¿ç§»æ€§æ¯”è¾ƒå¥½çš„dataloader</li><li>å¯¹äºè¿è¡Œå‡ºæ¥çš„ç»“æœçš„å›¾åƒåšä¸€ä¸ªç®€å•çš„åˆ‡åˆ†ï¼Œå¹³å‡åˆ†ä¸º19ä»½ç„¶åå°†æ¯ä¸€ä¸ªå•ç‹¬çš„ç›˜éƒ½cropå‡ºæ¥ç„¶åå°†éç›˜åŒºåŸŸæ ‡é»‘æ”¾åˆ°resnet101ç­‰å„ç±»åˆ†ç±»ç½‘ç»œä¸­è¿›è¡Œç›¸å…³çš„åˆ†ç±»ä»»åŠ¡ã€‚</li><li>åˆ’åˆ†æµ‹è¯•é›†å’Œè®­ç»ƒé›†çš„æ—¶å€™é€‰æ‹©ä½¿ç”¨ç”Ÿæˆval.txtè¿˜æœ‰train.txtæ–‡ä»¶çš„æ ¼å¼ï¼Œæ¯ä¸ª.txtæ–‡ä»¶å†…é˜²æ­¢ç›¸å…³æ•°æ®çš„è·¯å¾„ã€‚è€Œä¸æ˜¯å°†å…¶å¤åˆ¶åˆ°ä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ä¸­è¿›è¡Œåˆ†ç±»ï¼Œä¸‡ä¸€ç¡¬ç›˜æ²¡æœ‰é‚£ä¹ˆå¤§çš„ç©ºé—´æ€ä¹ˆåŠï¼Œä¸è¦æ»¥ç”¨ç¡¬ç›˜èµ„æºã€‚</li></ul><h1 id="2021-11-30æ—¥æ™šæ›´æ–°"><a href="#2021-11-30æ—¥æ™šæ›´æ–°" class="headerlink" title="2021.11.30æ—¥æ™šæ›´æ–°"></a>2021.11.30æ—¥æ™šæ›´æ–°</h1><p>ç›®å‰å·²ç»ç¡®å®šæœ¬å‘¨ç°åšç¬¬äºŒé¡¹ï¼Œå°±æ˜¯åšä¸€ä¸‹ç›®å‰ç›˜ç¬¦çš„åˆ†ç±»æ“ä½œã€‚</p><p>ç›®å‰ç¬¬ä¸€æ­¥é‡åˆ°çš„å›°éš¾å°±æ˜¯æš‚æ—¶ä¸çŸ¥é“æˆ‘ä»¬<code>inference_detector()</code>è¿™ä¸ªå‡½æ•°å¾—åˆ°çš„ç»“æœçš„å¤§è‡´å½¢å¼ã€‚å› ä¸ºä¹‹å‰åšåˆ†å‰²çš„æ—¶å€™ç›´æ¥å°†ç»“æœæ”¾åˆ°å‡½æ•°çš„å‚æ•°ä¸­<code>model.show_result(img, result, out_file=f&#39;/home/lry/projects/mmdetection/lry/demo{i}.jpg&#39;)</code>æ¥æ˜¾ç¤ºç»“æœäº†ï¼Œå†åŠ ä¸Šæˆ‘æœ¬æ¥å¯¹è¿™ä¸ªä¹Ÿä¸å¤ªç†Ÿæ‚‰ï¼Œæ‰€ä»¥ç›®å‰æ‰“ç®—æ·±å…¥ç†è§£ä¸‹å…³äºå‡½æ•°<code>inference_detector()</code>ï¼Œé¡ºä¾¿å°†è¿™ä¸€ç³»åˆ—æœ‰å…³çš„éƒ½äº†è§£ä¸€ä¸‹ï¼š<code>init_detector,inference_detector, show_result_pyplot</code>,è¿™äº›éƒ½æ˜¯æºäºåº“<code>mmdet.apis</code>,æ‰€ä»¥æˆ‘ä»¬æ¥æ‰¾ä¸€ä¸‹<a href="https://mmdetection.readthedocs.io/en/latest/api.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>å…³äºmmdet.apisçš„æœ‰å…³è§£é‡Šï¼š<br>å®é™…ä¸Šæœ‰å…³<code>inference_detector</code>çš„<a href="https://mmdetection.readthedocs.io/en/latest/api.html#mmdet.apis.inference_detector" target="_blank" rel="noopener">å†…å®¹</a>ååˆ†æœ‰é™ï¼š</p><blockquote><p>mmdet.apis.inference_detector(<em>model</em>, <em>imgs</em>)<a href="https://mmdetection.readthedocs.io/en/latest/_modules/mmdet/apis/inference.html#inference_detector" target="_blank" rel="noopener">[SOURCE]</a></p><p>Inference image(s) with the detector.</p><ul><li><p>Parameters</p><p><strong>model</strong> (<em>nn.Module</em>) â€“ The loaded detector.<strong>imgs</strong> (<em>str/ndarray</em> <em>or</em> <em>list<strong>[</strong>str/ndarray**] or</em> <em>tuple<strong>[</strong>str/ndarray**]</em>) â€“ Either image files or loaded images.</p></li><li><p>Returns</p><p>If imgs is a list or tuple, the same length list type results will be returned, otherwise return the detection results directly.</p></li></ul></blockquote><p>å½“ç„¶æ„Ÿå…´è¶£å¯ä»¥å»é€‰æ‹©çœ‹ä¸€ä¸‹æœ‰å…³æºç .è¿™é‡Œæˆ‘é€‰æ‹©ç”¨ä»£ç æ¥æ¢ç´¢ä¸‹æœ‰å…³çš„ç»“æœ:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> mmdet<span class="token punctuation">.</span>apis <span class="token keyword">import</span> init_detector<span class="token punctuation">,</span>inference_detector<span class="token punctuation">,</span> show_result_pyplot<span class="token keyword">import</span> mmcv<span class="token keyword">import</span> os<span class="token keyword">import</span> glob<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image<span class="token keyword">from</span> torchvision<span class="token punctuation">.</span>transforms <span class="token keyword">import</span> ToTensorconfig_file <span class="token operator">=</span> <span class="token string">"/home/lry/projects/mmdetection/configs/fenghuo/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_fenghuo.py"</span>checkpoint_file <span class="token operator">=</span> <span class="token string">"/home/lry/projects/mmdetection/work_dirs/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_fenghuo/latest.pth"</span>model <span class="token operator">=</span> init_detector<span class="token punctuation">(</span>config_file<span class="token punctuation">,</span> checkpoint_file<span class="token punctuation">,</span>device<span class="token operator">=</span><span class="token string">"cuda:3"</span><span class="token punctuation">)</span>img <span class="token operator">=</span> <span class="token string">'/home/lry/projects/mmdetection/data/780b_std/IMG_20211021_153945.jpg'</span>result <span class="token operator">=</span> inference_detector<span class="token punctuation">(</span>model<span class="token punctuation">,</span> img<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token string">'\n\n'</span><span class="token punctuation">,</span> result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'\n\n'</span><span class="token punctuation">,</span> result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shape<span class="token punctuation">)</span>img <span class="token operator">=</span> Image<span class="token punctuation">.</span>open<span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ‰å…³è¿™éƒ¨åˆ†ä¸»è¦å°±çœ‹resultçš„è¾“å‡ºåˆ°åº•æ˜¯ä»€ä¹ˆä¸œè¥¿,å¦‚æœæˆ‘ä»¬æƒ³è¦ä¿å­˜ç»“æœåˆ°æŸåœ°æˆ–æ˜¯å±•ç¤ºç»“æœå¯ä»¥ç”¨<code>model.show_result(img, result, out_file=f&#39;/home/lry/projects/mmdetection/lry/demo{i}.jpg&#39;)</code>æ¥æ˜¾ç¤º.</p><p>ç®€å•æ¥çœ‹ä¸‹ä»£ç è¿è¡Œç»“æœ:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token punctuation">(</span><span class="token punctuation">[</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3.6979218e+02</span><span class="token punctuation">,</span> <span class="token number">2.3255410e+03</span><span class="token punctuation">,</span> <span class="token number">2.7979324e+03</span><span class="token punctuation">,</span> <span class="token number">4.2280156e+03</span><span class="token punctuation">,</span>        <span class="token number">9.9831665e-01</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>float32<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token punctuation">[</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3.6979218e+02</span><span class="token punctuation">,</span> <span class="token number">2.3255410e+03</span><span class="token punctuation">,</span> <span class="token number">2.7979324e+03</span><span class="token punctuation">,</span> <span class="token number">4.2280156e+03</span><span class="token punctuation">,</span>        <span class="token number">9.9831665e-01</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>float32<span class="token punctuation">)</span><span class="token punctuation">]</span>  <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3.6979218e+02</span> <span class="token number">2.3255410e+03</span> <span class="token number">2.7979324e+03</span> <span class="token number">4.2280156e+03</span> <span class="token number">9.9831665e-01</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">4608</span><span class="token punctuation">,</span> <span class="token number">3456</span><span class="token punctuation">)</span>torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4608</span><span class="token punctuation">,</span> <span class="token number">3456</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°,resultæ˜¯ä¸€ä¸ªå…ƒç»„,å…ƒç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªnp.array,å«æœ‰5ä¸ªå…ƒç´ ,5ä¸ªå…ƒç´ ä¸­ç¬¬ä¸€ä¸ªä»£è¡¨çš„æ˜¯æ£€æµ‹æ¡†çš„å‡†ç¡®åº¦,ç„¶åå››ä¸ªå‚æ•°ä»£è¡¨çš„æ˜¯å›¾ç‰‡çš„æ£€æµ‹æ¡†çš„å·¦ä¸Šå³ä¸‹ç›¸å…³å‚æ•°,ç„¶åç¬¬äºŒä¸ªå…ƒç´ å°±æ˜¯å›¾ç‰‡åˆ†å‰²æ•°æ®é›†çš„åˆ†å‰²ç»“æœäº†.è¿™ä¸ªç»“æœæ˜¯ç”±Trueå’ŒFalseç»„æˆçš„å’Œå›¾åƒæœ¬èº«Tensorå¤§å°ç›¸åŒçš„ä¸€ä¸ªçŸ©é˜µ.(Trueä»£è¡¨è¯¥åƒç´ æ˜¯å«æœ‰ç‰©ä½“çš„)</p><h2 id="Code-Trace-of-mmdet-apis-inference-detector"><a href="#Code-Trace-of-mmdet-apis-inference-detector" class="headerlink" title="Code Trace of mmdet.apis.inference_detector()"></a>Code Trace of <code>mmdet.apis.inference_detector()</code></h2><p>çš„ç¡®åˆšæ‰æˆ‘ä»¬å°†è¿™ä¸ªæ¥å£å½“ä½œé»‘ç›’æ¥æ¢ç´¢åˆ°äº†ä»–çš„ä¸€äº›å…·ä½“åŠŸèƒ½ã€‚è¿™æ ·å¯¹äºåšé¡¹ç›®æ¥è¯´éå¸¸è¶³å¤Ÿäº†ï¼Œä½†æ˜¯æˆ‘ä»¬è¿™é‡Œæ·±å…¥ä¸€ä¸‹æ¥æ¢ç´¢ä¸€ä¸‹ä»–çš„æºç æ˜¯æ€ä¹ˆæ ·çš„ï¼ˆ<del>æ„Ÿè°¢è’‹å“¥å¸¦æˆ‘é£</del>ï¼‰ã€‚</p><p>é¦–å…ˆæ¥çœ‹æˆ‘ä»¬çš„inference_detector()æºç <code>mmdet/apis/inference.py</code>:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">inference_detector</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> imgs<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Inference image(s) with the detector.    Args:        model (nn.Module): The loaded detector.        imgs (str/ndarray or list[str/ndarray] or tuple[str/ndarray]):           Either image files or loaded images.    Returns:        If imgs is a list or tuple, the same length list type results        will be returned, otherwise return the detection results directly.    """</span>    <span class="token keyword">if</span> isinstance<span class="token punctuation">(</span>imgs<span class="token punctuation">,</span> <span class="token punctuation">(</span>list<span class="token punctuation">,</span> tuple<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        is_batch <span class="token operator">=</span> <span class="token boolean">True</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        imgs <span class="token operator">=</span> <span class="token punctuation">[</span>imgs<span class="token punctuation">]</span>        is_batch <span class="token operator">=</span> <span class="token boolean">False</span>    cfg <span class="token operator">=</span> model<span class="token punctuation">.</span>cfg    device <span class="token operator">=</span> next<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>device  <span class="token comment" spellcheck="true"># model device</span>    <span class="token keyword">if</span> isinstance<span class="token punctuation">(</span>imgs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>        cfg <span class="token operator">=</span> cfg<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># set loading pipeline type</span>        cfg<span class="token punctuation">.</span>data<span class="token punctuation">.</span>test<span class="token punctuation">.</span>pipeline<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'LoadImageFromWebcam'</span>    cfg<span class="token punctuation">.</span>data<span class="token punctuation">.</span>test<span class="token punctuation">.</span>pipeline <span class="token operator">=</span> replace_ImageToTensor<span class="token punctuation">(</span>cfg<span class="token punctuation">.</span>data<span class="token punctuation">.</span>test<span class="token punctuation">.</span>pipeline<span class="token punctuation">)</span>    test_pipeline <span class="token operator">=</span> Compose<span class="token punctuation">(</span>cfg<span class="token punctuation">.</span>data<span class="token punctuation">.</span>test<span class="token punctuation">.</span>pipeline<span class="token punctuation">)</span>    datas <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> img <span class="token keyword">in</span> imgs<span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># prepare data</span>        <span class="token keyword">if</span> isinstance<span class="token punctuation">(</span>img<span class="token punctuation">,</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token comment" spellcheck="true"># directly add img</span>            data <span class="token operator">=</span> dict<span class="token punctuation">(</span>img<span class="token operator">=</span>img<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token comment" spellcheck="true"># add information into dict</span>            data <span class="token operator">=</span> dict<span class="token punctuation">(</span>img_info<span class="token operator">=</span>dict<span class="token punctuation">(</span>filename<span class="token operator">=</span>img<span class="token punctuation">)</span><span class="token punctuation">,</span> img_prefix<span class="token operator">=</span>None<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># build the data pipeline</span>        data <span class="token operator">=</span> test_pipeline<span class="token punctuation">(</span>data<span class="token punctuation">)</span>        datas<span class="token punctuation">.</span>append<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    data <span class="token operator">=</span> collate<span class="token punctuation">(</span>datas<span class="token punctuation">,</span> samples_per_gpu<span class="token operator">=</span>len<span class="token punctuation">(</span>imgs<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># just get the actual data from DataContainer</span>    data<span class="token punctuation">[</span><span class="token string">'img_metas'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>img_metas<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">for</span> img_metas <span class="token keyword">in</span> data<span class="token punctuation">[</span><span class="token string">'img_metas'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>    data<span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>img<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">for</span> img <span class="token keyword">in</span> data<span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> next<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>is_cuda<span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># scatter to specified GPU</span>        data <span class="token operator">=</span> scatter<span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">[</span>device<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> m <span class="token keyword">in</span> model<span class="token punctuation">.</span>modules<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">assert</span> <span class="token operator">not</span> isinstance<span class="token punctuation">(</span>                m<span class="token punctuation">,</span> RoIPool            <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'CPU inference with RoIPool is not supported currently.'</span>    <span class="token comment" spellcheck="true"># forward the model</span>    <span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        results <span class="token operator">=</span> model<span class="token punctuation">(</span>return_loss<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> rescale<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token operator">**</span>data<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token operator">not</span> is_batch<span class="token punctuation">:</span>        <span class="token keyword">return</span> results<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> results<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®é™…ä¸Šè¿™ä¹ˆé•¿çš„æºç ï¼ŒçœŸæ­£å…³é”®çš„å°±å€’æ•°ç¬¬å…­è¡Œçš„ä»£ç <code>results = model(return_loss=False, rescale=True, **data)</code>è¿™è¡Œä»£ç è°ƒç”¨äº†modelæ¥è¿›è¡Œæ¨ç†ç„¶åè¿”å›äº†ç»“æœresultsã€‚æˆ‘ä»¬è¦çœ‹modelçš„è€Œmodelæ˜¯æˆ‘ä»¬ä¼ è¿›æ¥çš„å‚æ•°ï¼Œæ˜¯æˆ‘ä»¬ä½¿ç”¨<code>init_detector</code>è¿™ä¸ªæ¥å£æ¥è°ƒç”¨çš„ï¼Œè¿™ä¸ªæ¥å£ä½¿ç”¨äº†æˆ‘ä»¬çš„configæ–‡ä»¶ä»¥åŠç›¸å…³çš„checkpointæ–‡ä»¶ã€‚è¿™é‡Œconfigæ–‡ä»¶å·²ç»éå¸¸ç†Ÿæ‚‰äº†ï¼Œå°±æ˜¯åˆ©ç”¨è¿™ä¸ªæ­å»ºçš„æ¨¡å‹ã€‚æˆ‘ä»¬éœ€è¦çœ‹çš„æ˜¯å…³äºconfigæ–‡ä»¶é‡Œé¢æ‰€ç”¨çš„æ¨¡å‹ã€‚è€Œè¦æœ€åçš„è¾“å‡ºæ˜¯ç”±<code>roi_heads</code>ï¼Œä¹Ÿå°±æ˜¯maskrcnnæœ€åä¸€ä¸ªæ¨¡å—æ¥è¾“å‡ºçš„ã€‚æˆ‘ä»¬å…ˆè¿½è¸ªä¸€ä¸‹æœ‰å…³çš„configæ–‡ä»¶ï¼š<br>é¦–å…ˆæ˜¯æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ä¸Šå±‚çš„configæ–‡ä»¶<code>configs/fenghuo/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_fenghuo.py</code>, ä»è¿™é‡Œæ‰¾å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ç»§æ‰¿çš„æ˜¯<code>_base_ = &#39;../mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_coco.py&#39;</code>é‚£ä¹ˆæˆ‘ä»¬ç»§ç»­æ‰¾åˆ°è¿™ä¸ªæ¨¡å—å°±<code>configs/mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_coco.py</code>,å¯ä»¥çœ‹åˆ°ä»–ç»§æ‰¿çš„æ˜¯<code>_base_ = &#39;./mask_rcnn_r50_fpn_1x_coco.py&#39;</code>,æˆ‘ä»¬ç»§ç»­æ‰¾è¿™ä¸ªæ–‡ä»¶<code>configs/mask_rcnn/mask_rcnn_r50_fpn_1x_coco.py</code>,è¿™ä¸ªæ–‡ä»¶æœ‰ç‚¹åƒæ˜¯ä¸€ä¸ªpackageçš„<code>__init__.py</code>ï¼Œå°±æ˜¯ä»£ç åªæœ‰æ‰€æœ‰éœ€è¦ç»§æ‰¿çš„åŸºæœ¬ç±»å‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">_base_ <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token string">'../_base_/models/mask_rcnn_r50_fpn.py'</span><span class="token punctuation">,</span>    <span class="token string">'../_base_/datasets/coco_instance.py'</span><span class="token punctuation">,</span>    <span class="token string">'../_base_/schedules/schedule_1x.py'</span><span class="token punctuation">,</span> <span class="token string">'../_base_/default_runtime.py'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œå°±æ˜¯ä¸€äº›æ¨¡å‹å…·ä½“é…ç½®çš„ç»§æ‰¿åŸºç±»æ–‡ä»¶ï¼Œæˆ‘ä»¬æƒ³è¦çœ‹æ¨¡å‹çš„<code>roi_heads</code>éƒ¨åˆ†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å»æ‰¾<code>&#39;../_base_/models/mask_rcnn_r50_fpn.py&#39;</code>æ–‡ä»¶ã€‚æˆ‘ä»¬å¯ä»¥åœ¨<code>configs/_base_/models/mask_rcnn_r50_fpn.py</code>é‡Œæ‰¾åˆ°<code>roi_heads</code>çš„å®šä¹‰:</p><pre class="line-numbers language-python"><code class="language-python">    roi_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>        type<span class="token operator">=</span><span class="token string">'StandardRoIHead'</span><span class="token punctuation">,</span>        bbox_roi_extractor<span class="token operator">=</span>dict<span class="token punctuation">(</span>            type<span class="token operator">=</span><span class="token string">'SingleRoIExtractor'</span><span class="token punctuation">,</span>            roi_layer<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'RoIAlign'</span><span class="token punctuation">,</span> output_size<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span> sampling_ratio<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>            featmap_strides<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        bbox_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>            type<span class="token operator">=</span><span class="token string">'Shared2FCBBoxHead'</span><span class="token punctuation">,</span>            in_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>            fc_out_channels<span class="token operator">=</span><span class="token number">1024</span><span class="token punctuation">,</span>            roi_feat_size<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span>            num_classes<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">,</span>            bbox_coder<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'DeltaXYWHBBoxCoder'</span><span class="token punctuation">,</span>                target_means<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                target_stds<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            reg_class_agnostic<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>            loss_cls<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'CrossEntropyLoss'</span><span class="token punctuation">,</span> use_sigmoid<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> loss_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            loss_bbox<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'L1Loss'</span><span class="token punctuation">,</span> loss_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        mask_roi_extractor<span class="token operator">=</span>dict<span class="token punctuation">(</span>            type<span class="token operator">=</span><span class="token string">'SingleRoIExtractor'</span><span class="token punctuation">,</span>            roi_layer<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'RoIAlign'</span><span class="token punctuation">,</span> output_size<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">,</span> sampling_ratio<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>            featmap_strides<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        mask_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>            type<span class="token operator">=</span><span class="token string">'FCNMaskHead'</span><span class="token punctuation">,</span>            num_convs<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>            in_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>            conv_out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>            num_classes<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">,</span>            loss_mask<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'CrossEntropyLoss'</span><span class="token punctuation">,</span> use_mask<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> loss_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œé¢å¯ä»¥çœ‹åˆ°æ•´ä¸ª<code>roi_head</code>éƒ½æ˜¯å±äº<code>type=&#39;StandardRoIHead&#39;</code>, ç”±äºMMDetectionçš„æ³¨å†Œå™¨Registryæœºåˆ¶ï¼Œæˆ‘ä»¬çŸ¥é“æˆ‘ä»¬éœ€è¦å»åˆ°<code>mmdet</code>æ–‡ä»¶å¤¹ä¸­å»æ‰¾è¿™äº›ä¸œè¥¿ï¼Œåœ¨<code>mmdet/models/roi_heads</code>ä¸­æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°<code>mmdet/models/roi_heads/standard_roi_head.py</code>è¿™ä¸ªæ–‡ä»¶ã€‚<br>ç„¶åæˆ‘ä»¬éœ€è¦ä»ç±»ä¸­å¯»æ‰¾å…³äºforwardçš„æœ‰å…³å‡½æ•°ï¼Œåˆšå¼€å§‹æ‰¾çš„æ˜¯<code>forward_dummy()</code>è¿™ä¸ªå‡½æ•°ï¼Œä½†æ˜¯ä»è¿™ä¸ªå‡½æ•°ä¸­çœ‹ä¸åˆ°å…³äºcls_scoreå’Œbbox_predä»¥åŠmask_predçš„åˆå¹¶æœ‰å…³æ­¥éª¤ï¼Œæˆ–è€…è¯´ä¸å¤ªèƒ½å¯¹åº”ä¸Šï¼Œåæ¥æ‰“äº†ä¸€äº›æ–­ç‚¹å‘ç°ä¼¼ä¹ç¨‹åºæ ¹æœ¬ä¸ä¼šç»è¿‡è¿™ä¸ªå‡½æ•°ã€‚æ‰€ä»¥åº”è¯¥ä¸æ˜¯ç»è¿‡è¿™ä¸ªforwardå‡½æ•°ï¼Œè€Œå¦å¤–çš„forwardå‡½æ•°ï¼Œé¦–å…ˆå¯ä»¥æ’é™¤<code>forward_train</code>è¿™ä¸ªå‡½æ•°ï¼Œæˆ–è€…æ˜¯æ’é™¤æ‰€æœ‰å’Œtrainæœ‰å…³çš„å‡½æ•°ï¼Œå› ä¸ºæˆ‘ä»¬æ¯•ç«Ÿè¿™ä¸ªæ˜¯åšçš„æ¨æ–­ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦çš„ä¸æ˜¯å»trainï¼Œè‡³å°‘ä¹Ÿåœ¨testé‡Œé¢ã€‚</p><p>åæ¥ç»è¿‡æ‰“æ–­ç‚¹å‘ç°ç¨‹åºè¿è¡Œåœ¨<code>simple_test()</code>è¿™ä¸ªå‡½æ•°é‡Œé¢ï¼š</p><pre class="line-numbers language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">simple_test</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>                    x<span class="token punctuation">,</span>                    proposal_list<span class="token punctuation">,</span>                    img_metas<span class="token punctuation">,</span>                    proposals<span class="token operator">=</span>None<span class="token punctuation">,</span>                    rescale<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Test without augmentation.        Args:            x (tuple[Tensor]): Features from upstream network. Each                has shape (batch_size, c, h, w).            proposal_list (list(Tensor)): Proposals from rpn head.                Each has shape (num_proposals, 5), last dimension                5 represent (x1, y1, x2, y2, score).            img_metas (list[dict]): Meta information of images.            rescale (bool): Whether to rescale the results to                the original image. Default: True.        Returns:            list[list[np.ndarray]] or list[tuple]: When no mask branch,            it is bbox results of each image and classes with type            `list[list[np.ndarray]]`. The outer list            corresponds to each image. The inner list            corresponds to each class. When the model has mask branch,            it contains bbox results and mask results.            The outer list corresponds to each image, and first element            of tuple is bbox results, second element is mask results.        """</span>        <span class="token keyword">assert</span> self<span class="token punctuation">.</span>with_bbox<span class="token punctuation">,</span> <span class="token string">'Bbox head must be implemented.'</span>        det_bboxes<span class="token punctuation">,</span> det_labels <span class="token operator">=</span> self<span class="token punctuation">.</span>simple_test_bboxes<span class="token punctuation">(</span>            x<span class="token punctuation">,</span> img_metas<span class="token punctuation">,</span> proposal_list<span class="token punctuation">,</span> self<span class="token punctuation">.</span>test_cfg<span class="token punctuation">,</span> rescale<span class="token operator">=</span>rescale<span class="token punctuation">)</span>        bbox_results <span class="token operator">=</span> <span class="token punctuation">[</span>            bbox2result<span class="token punctuation">(</span>det_bboxes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> det_labels<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>                        self<span class="token punctuation">.</span>bbox_head<span class="token punctuation">.</span>num_classes<span class="token punctuation">)</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>det_bboxes<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">]</span>        <span class="token keyword">if</span> <span class="token operator">not</span> self<span class="token punctuation">.</span>with_mask<span class="token punctuation">:</span>            <span class="token keyword">return</span> bbox_results        <span class="token keyword">else</span><span class="token punctuation">:</span>            segm_results <span class="token operator">=</span> self<span class="token punctuation">.</span>simple_test_mask<span class="token punctuation">(</span>                x<span class="token punctuation">,</span> img_metas<span class="token punctuation">,</span> det_bboxes<span class="token punctuation">,</span> det_labels<span class="token punctuation">,</span> rescale<span class="token operator">=</span>rescale<span class="token punctuation">)</span>            <span class="token keyword">return</span> list<span class="token punctuation">(</span>zip<span class="token punctuation">(</span>bbox_results<span class="token punctuation">,</span> segm_results<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ç€è°ƒè¯•å‘ç°è¿™é‡Œè°ƒç”¨äº†å‡½æ•°bbox2result()æ¥å®ç°äº†å…³äºè½¬åŒ–çš„ä¸€äº›é—®é¢˜ã€‚</p><p>å®é™…ä¸Šåˆ°æ­¤å°±ç»“æŸäº†ï¼Œå½“ç„¶<code>forward_dummy()</code>è¿™ä¸ªå‡½æ•°æ˜¯éå¸¸æœ‰ç ”ç©¶æ„ä¹‰çš„ï¼Œåœ¨<code>mmdet/models/detectors/two_stage.py</code>é‡Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªæ˜¯ä¸ºäº†ï¼Œç‰¹åˆ«æ˜¯è¿™é‡Œè°ƒç”¨äº†<code>_bbox_forward()</code>è¿™ä¸ªå‡½æ•°,å€¼å¾—æ³¨æ„ä¸€ä¸‹ã€‚</p><p>å¦å¤–æˆ‘ä»¬ä»¥ä¸Šä»…ä»…æ˜¯è®²äº†ä¸€ä¸ªmask_rcnnçš„ä¸€ä¸ªå¾ˆå°çš„<code>roi_head</code>éƒ¨åˆ†ï¼Œå¦‚æœè¦æ€»ä½“çœ‹å…¨ä½“çš„ä¸€ä¸ªæ¦‚å†µçš„è¯ï¼Œå¯ä»¥é€‰æ‹©å»çœ‹ä¸€ä¸‹<code>mmdet/models/detectors/two_stage.py</code>è™½ç„¶ä¹Ÿä¸ç®—æ˜¯æ€»ä½“ï¼Œä½†æ˜¯ä¹Ÿé«˜äº†ä¸€çº§ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹å…·ä½“çš„è¿™ä¸ª<code>TwoStageDetector</code>æ˜¯æ€ä¹ˆè°ƒåº¦çš„ï¼Œæ˜¯å¦‚ä½•è¿è¡Œèµ·æ¥çš„ã€‚</p><h2 id="dataloader-in-mmdetection"><a href="#dataloader-in-mmdetection" class="headerlink" title="dataloader in mmdetection"></a><strong>dataloader in mmdetection</strong></h2><p>å…¶æ¬¡æ˜¯å…³äºè¿™å‘¨è¦åšçš„ç¬¬ä¸€ä¸ªä»»åŠ¡ï¼Œè¿™ä¸ªä»»åŠ¡å®é™…ä¸Šå°±æ˜¯æ¥åšä¸€ä¸ªLabelmeæ•°æ®çš„dataloader,å½“ç„¶è¯´èµ·æ¥å®¹æ˜“ï¼Œè¿™ä¸ªè¦æŠŠdataloaderèåˆ°MMDetectioné‡Œé¢è¿˜æ˜¯éœ€è¦æ·±å…¥ç†è§£ä»–çš„Rigistryæœºåˆ¶çš„ï¼Œè€Œä¸”å…‰å†™ä»£ç è¿™ä¸€æ­¥å¦‚æœå®Œå…¨ä¸çœ‹ä»–çš„å…³äºCOCODatasetçš„ä»£ç é è‡ªå·±å†™ææ€•æ˜¯éå¸¸éš¾åŠçš„ã€‚æ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä¸€æ­¥ä¸€æ­¥çš„æ¥æ¢ç´¢ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬æ¥æ‰¾åˆ°COCOçš„dataloaderåˆ°åº•åœ¨å“ªé‡Œã€‚</p><p>è¿˜æ˜¯ä»configæ–‡ä»¶å¼€å§‹æ‰¾ï¼Œç”±äºä¸Šæ–‡å·²ç»æ‰¾è¿‡äº†ï¼Œè¿™é‡Œç›´æ¥å¼•ç”¨ä¸Šæ–‡çš„å¯»æ‰¾è¿‡ç¨‹ï¼š</p><p>â€œâ€â€â€</p><p>é¦–å…ˆæ˜¯æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ä¸Šå±‚çš„configæ–‡ä»¶<code>configs/fenghuo/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_fenghuo.py</code>, ä»è¿™é‡Œæ‰¾å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ç»§æ‰¿çš„æ˜¯<code>_base_ = &#39;../mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_coco.py&#39;</code>é‚£ä¹ˆæˆ‘ä»¬ç»§ç»­æ‰¾åˆ°è¿™ä¸ªæ¨¡å—å°±<code>configs/mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_coco.py</code>,å¯ä»¥çœ‹åˆ°ä»–ç»§æ‰¿çš„æ˜¯<code>_base_ = &#39;./mask_rcnn_r50_fpn_1x_coco.py&#39;</code>,æˆ‘ä»¬ç»§ç»­æ‰¾è¿™ä¸ªæ–‡ä»¶<code>configs/mask_rcnn/mask_rcnn_r50_fpn_1x_coco.py</code>,è¿™ä¸ªæ–‡ä»¶æœ‰ç‚¹åƒæ˜¯ä¸€ä¸ªpackageçš„<code>__init__.py</code>ï¼Œå°±æ˜¯ä»£ç åªæœ‰æ‰€æœ‰éœ€è¦ç»§æ‰¿çš„åŸºæœ¬ç±»å‹ï¼š</p><p>```python</p><p><em>base</em> = [</p><p>  â€˜../<em>base</em>/models/mask_rcnn_r50_fpn.pyâ€™,</p><p>  â€˜../<em>base</em>/datasets/coco_instance.pyâ€™,</p><p>  â€˜../<em>base</em>/schedules/schedule_1x.pyâ€™, â€˜../<em>base</em>/default_runtime.pyâ€™</p><p>]</p><p>```</p><p>â€œâ€â€</p><p>ç„¶åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨<code>&#39;../_base_/datasets/coco_instance.py&#39;</code>é‡Œé¢ï¼Œå‰å‡ è¡Œä»£ç å°±æœ‰<code>dataset_type = &#39;CocoDataset&#39;</code>å’Œä¸Šæ–‡ç›¸åŒçš„Registryæœºåˆ¶ï¼Œæˆ‘ä»¬åˆ°<code>mmdet</code>æ–‡ä»¶å¤¹ä¸­å»å¯»æ‰¾ï¼Œå¯ä»¥å‘ç°åœ¨<code>mmdet/datasets/coco.py</code>é‡Œé¢æœ‰<code>CocoDataset</code>è¿™ä¸ªç±»ã€‚è¿™ä¸ªå°±æ˜¯å…³äºCocoDatasetçš„dataloader.ç»ˆäºæ‰¾åˆ°äº†ï¼</p><p>ä½†æ˜¯æœ‰574è¡Œä»£ç â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦èšŒåŸ ä½äº†ğŸ˜¥ã€‚</p><h1 id="2021-12-1æ—¥ä¸Šåˆæ›´æ–°"><a href="#2021-12-1æ—¥ä¸Šåˆæ›´æ–°" class="headerlink" title="2021.12.1æ—¥ä¸Šåˆæ›´æ–°"></a>2021.12.1æ—¥ä¸Šåˆæ›´æ–°</h1><h2 id="dataloader-in-mmdet"><a href="#dataloader-in-mmdet" class="headerlink" title="dataloader in mmdet"></a>dataloader in mmdet</h2><p>å†ç¨å¾®è¯´ä¸€ä¸‹å…³äºRigistryè¿˜æœ‰ç»§æ‰¿ç±»éœ€è¦åšçš„ä¸€äº›ä¸œè¥¿ã€‚</p><p>æˆ‘ä»¬ç»§ç»­ä»ä¸Šæ–‡ä¸­å¾—åˆ°çš„åœ¨<code>mmdet/datasets/coco.py</code>ä¸­çœ‹åˆ°çš„CocoDatasetç±»çš„å†…å®¹ï¼ˆä»…ä»…é€‰æ‹©äº†ä¸€éƒ¨åˆ†ï¼Œå®Œæ•´ç‰ˆçœ‹<a href="https://github.com/open-mmlab/mmdetection/blob/master/mmdet/datasets/coco.py" target="_blank" rel="noopener">è¿™é‡Œ</a>ï¼‰ï¼š</p><p>```python</p><p># Copyright (c) OpenMMLab. All rights reserved.</p><p>@DATASETS.register_module()</p><p>class CocoDataset(CustomDataset):</p><p>  CLASSES = (â€˜personâ€™, â€˜bicycleâ€™, â€˜carâ€™, â€˜motorcycleâ€™, â€˜airplaneâ€™, â€˜busâ€™,</p><p>â€‹        â€˜trainâ€™, â€˜truckâ€™, â€˜boatâ€™, â€˜traffic lightâ€™, â€˜fire hydrantâ€™,</p><p>â€‹        â€˜stop signâ€™, â€˜parking meterâ€™, â€˜benchâ€™, â€˜birdâ€™, â€˜catâ€™, â€˜dogâ€™,</p><p>â€‹        â€˜horseâ€™, â€˜sheepâ€™, â€˜cowâ€™, â€˜elephantâ€™, â€˜bearâ€™, â€˜zebraâ€™, â€˜giraffeâ€™,</p><p>â€‹        â€˜backpackâ€™, â€˜umbrellaâ€™, â€˜handbagâ€™, â€˜tieâ€™, â€˜suitcaseâ€™, â€˜frisbeeâ€™,</p><p>â€‹        â€˜skisâ€™, â€˜snowboardâ€™, â€˜sports ballâ€™, â€˜kiteâ€™, â€˜baseball batâ€™,</p><p>â€‹        â€˜baseball gloveâ€™, â€˜skateboardâ€™, â€˜surfboardâ€™, â€˜tennis racketâ€™,</p><p>â€‹        â€˜bottleâ€™, â€˜wine glassâ€™, â€˜cupâ€™, â€˜forkâ€™, â€˜knifeâ€™, â€˜spoonâ€™, â€˜bowlâ€™,</p><p>â€‹        â€˜bananaâ€™, â€˜appleâ€™, â€˜sandwichâ€™, â€˜orangeâ€™, â€˜broccoliâ€™, â€˜carrotâ€™,</p><p>â€‹        â€˜hot dogâ€™, â€˜pizzaâ€™, â€˜donutâ€™, â€˜cakeâ€™, â€˜chairâ€™, â€˜couchâ€™,</p><p>â€‹        â€˜potted plantâ€™, â€˜bedâ€™, â€˜dining tableâ€™, â€˜toiletâ€™, â€˜tvâ€™, â€˜laptopâ€™,</p><p>â€‹        â€˜mouseâ€™, â€˜remoteâ€™, â€˜keyboardâ€™, â€˜cell phoneâ€™, â€˜microwaveâ€™,</p><p>â€‹        â€˜ovenâ€™, â€˜toasterâ€™, â€˜sinkâ€™, â€˜refrigeratorâ€™, â€˜bookâ€™, â€˜clockâ€™,</p><p>â€‹        â€˜vaseâ€™, â€˜scissorsâ€™, â€˜teddy bearâ€™, â€˜hair drierâ€™, â€˜toothbrushâ€™)</p><p>  def load_annotations(self, ann_file):</p><p>â€‹    â€œâ€â€Load annotation from COCO style annotation file.</p><p>â€‹    Args:</p><p>â€‹      ann_file (str): Path of annotation file.</p><p>â€‹    Returns:</p><p>```</p><p>ä¸»è¦æ˜¯çœ‹ä¸€ä¸‹<code>@DATASETS.register_module()</code>è¿™ä¸ªè£…é¥°å™¨ï¼Œå…³äºè£…é¥°å™¨çš„è¯­æ³•æ·±å…¥çš„éƒ¨åˆ†ä¸å†è¯´ï¼Œæˆ‘ä»¬è¿™é‡Œåªéœ€è¦çŸ¥é“è¿™ä¸ªå°±ç›¸å½“äºæˆ‘ä»¬æ³¨å†Œäº†æœ‰å…³çš„<code>Rigistry</code>,ä»è¿™ä¸ªå®šä¹‰ä¹‹åï¼Œæˆ‘ä»¬åªéœ€è¦å°±åƒå‰é¢ä¸€æ ·<code>dataset_type = &#39;CocoDataset&#39;</code>å°±å¯ä»¥å°†è¿™ä¸ªdataloaderæ”¾åˆ°MMdetä¸­ã€‚</p><p>å¦å¤–å¦‚æœè‡ªå·±è¦å†™dataloaderçš„è¯ï¼Œç±»éœ€è¦ç»§æ‰¿çš„å°±æ˜¯<code>from .custom import CustomDataset</code>ä¸­çš„<code>CustomDataset</code>.</p><p>å¦å¤–æˆ‘ä»¬è¿˜è¦æ³¨æ„çš„æ˜¯</p><h2 id="å›¾åƒåˆ†å‰²ç›˜ç¬¦åˆ‡ç‰‡æ•°æ®é¢„å¤„ç†æ“ä½œ"><a href="#å›¾åƒåˆ†å‰²ç›˜ç¬¦åˆ‡ç‰‡æ•°æ®é¢„å¤„ç†æ“ä½œ" class="headerlink" title="å›¾åƒåˆ†å‰²ç›˜ç¬¦åˆ‡ç‰‡æ•°æ®é¢„å¤„ç†æ“ä½œ"></a>å›¾åƒåˆ†å‰²ç›˜ç¬¦åˆ‡ç‰‡æ•°æ®é¢„å¤„ç†æ“ä½œ</h2><h3 id="Preface-2"><a href="#Preface-2" class="headerlink" title="Preface"></a>Preface</h3><p>æ˜¨å¤©æœ¬æ¥æ‰“ç®—è®¤çœŸåšä¸€ä¸‹å…³äºç›˜ç¬¦åˆ†ç±»çš„ä»»åŠ¡çš„ï¼Œæ²¡æƒ³åˆ°è¿˜æ˜¯æœ€ç»ˆæ²¡æœ‰å¼„ï¼Œå…‰é¡¾ç€æMMdetectionçš„æºç è¿™äº›ä¸œè¥¿äº†æ²¡æœ‰æ¥å¾—åŠæï¼Œç›®å‰å·²çŸ¥æ¥å£<code>inference_detector</code>è¿”å›çš„resultçš„ç»“æœäº†ï¼Œå°±æ˜¯ä¸€ä¸ªå…ƒç»„tupleï¼Œç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯æ£€æµ‹æ¡†çš„ä½ç½®å’Œç½®ä¿¡åº¦ï¼Œç„¶åç¬¬äºŒä¸ªå…ƒç´ å°±æ˜¯åˆ†å‰²çš„ç»“æœï¼Œæ˜¯ä¸€ä¸ªä¸å›¾ç‰‡å¤§å°ç›¸åŒçš„ä¸€ä¸ªäºŒç»´çŸ©é˜µï¼Œç”±Trueå’ŒFalseç»„æˆã€‚</p><p>æˆ‘ä»¬æ¥ä¸‹æ¥å¼€å§‹å°è¯•åšå›¾åƒçš„å¤„ç†ã€‚</p><p>é¦–å…ˆæ„å»ºdetectorå¾—åˆ°ä¸€äº›å…·ä½“ç»“æœï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/12/01/LqL6m6.png" alt></p><h3 id="å›¾åƒå¤„ç†ç®—æ³•åˆ†æä¸ç®—æ³•æ­¥éª¤å®ç°"><a href="#å›¾åƒå¤„ç†ç®—æ³•åˆ†æä¸ç®—æ³•æ­¥éª¤å®ç°" class="headerlink" title="å›¾åƒå¤„ç†ç®—æ³•åˆ†æä¸ç®—æ³•æ­¥éª¤å®ç°"></a>å›¾åƒå¤„ç†ç®—æ³•åˆ†æä¸ç®—æ³•æ­¥éª¤å®ç°</h3><h4 id="å¯¹äºåˆ†å‰²çš„ç»“æœé¢„å¤„ç†"><a href="#å¯¹äºåˆ†å‰²çš„ç»“æœé¢„å¤„ç†" class="headerlink" title="å¯¹äºåˆ†å‰²çš„ç»“æœé¢„å¤„ç†"></a>å¯¹äºåˆ†å‰²çš„ç»“æœé¢„å¤„ç†</h4><p>é¦–å…ˆï¼Œè¿™ä¸ªæ£€æµ‹æ¡†çš„ç»“æœå¹¶ä¸æ˜¯éå¸¸é è°±,å¾ˆæ˜æ˜¾å¦‚æœæˆ‘ä»¬é€‰æ‹©å¯¹å¾—åˆ°çš„bboxæ¥è¿›è¡Œå‡ç­‰åˆ†å‰²æ˜¯å®Œå…¨ä¸è¡Œçš„ï¼Œåˆ†å‰²çš„ç»“æœè¿˜è¦å¥½ä¸€äº›ç›¸å¯¹è€Œè¨€ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œå¯ä»¥é€‰æ‹©è€ƒè™‘ä¸€ä¸‹ä½¿ç”¨åˆ†å‰²æ•°æ®ä½†æ˜¯è¦å¯¹åˆ†å‰²æ•°æ®è¿›è¡Œä¸€äº›è½¬æ¢æˆ–è€…æ˜¯è¯´ä¿®è¡¥ã€‚</p><p>ç›®å‰ä¸€ä¸ªæƒ³æ³•æ˜¯å¯¹äºåˆ†å‰²ç»“æœçš„è¾¹ç•Œå–å¹³å‡å€¼æ¥å¾—åˆ°4æ¡å¯ä»¥ç”¨çš„è¾¹ç»„æˆä¸€ä¸ªæ–°çš„bboxã€‚ç„¶åæˆ‘ä»¬å†å¯¹å¾—åˆ°çš„æ–°çš„bboxè¿›è¡Œå¹³å‡åˆ‡åˆ†æˆ19ç­‰ä»½ï¼Œå½“ç„¶è¿™é‡Œæ²¡æœ‰è€ƒè™‘æ˜¯å¦æ˜¯å€¾æ–œçš„ï¼Œå› ä¸ºæˆ‘ä»¬è¦åˆ‡å‡ºçš„å›¾ç‰‡è¦éƒ½æ˜¯æ°´å¹³çŸ©å½¢ï¼Œç„¶åæ ¹æ®åæ ‡å…³ç³»å°†æˆ‘ä»¬åˆ‡é™¤çŸ©å½¢éƒ¨åˆ†ä¸åŒ…å«ç›˜ç¬¦çš„éƒ¨åˆ†æ¶‚é»‘ï¼ˆæ‰€ä»¥å†™ä»£ç æ—¶ä¸å¦¨å…ˆå°†éç›˜ç¬¦éƒ¨åˆ†æ¶‚é»‘ã€‚ï¼‰</p><p>ç›®å‰è€ƒè™‘çš„ç®—æ³•æ­¥éª¤æ˜¯ï¼š</p><ul><li><p>æ ¹æ®æ„å»ºdetectorå¾—åˆ°çš„åˆ†å‰²ç»“æœçŸ©é˜µï¼Œæ ¹æ®è¾¹ç•Œå¹³å‡æ€æƒ³å¾—åˆ°ä¸€ä¸ª bbox</p></li><li><p>å¾—åˆ°bboxçš„å››ä¸ªé¡¶ç‚¹ï¼ˆä¸€å®šæ˜¯bboxçŸ©é˜µæœ€é å·¦ï¼Œæœ€é å³ï¼Œæœ€é ä¸Šï¼Œæœ€é ä¸‹çš„å››ä¸ªé¡¶ç‚¹ï¼‰ã€‚</p></li><li><p>æ ¹æ®å››ä¸ªé¡¶ç‚¹çš„å…³ç³»å¾—åˆ°å·¦å³çš„ä¸¤ç»„è¾¹çš„ç‚¹ï¼Œç„¶åæ ¹æ®å·¦å³ç­‰æ¯”ä¾‹å…³ç³»æ ‡æ³¨å¥½ä¸­é—´è¦åˆ‡åˆ†çš„18ä¸ªç‚¹ï¼Œè¿åŒç€å·¦å³ä¸¤ç«¯ç‚¹éƒ½æ”¾åˆ°ä¸€ä¸ªåˆ—è¡¨é‡Œï¼Œä¸Šä¸‹éƒ½è¦æœ‰ï¼Œï¼ˆå…¶å®ä¹Ÿå°±é€šè¿‡ç»™bboxçš„çŸ©é˜µä¸Šä¸‹ä¸¤æ¡è¾¹ç­‰åˆ†æˆ19ä»½ï¼Œä»¥åˆ©äºåç»­ç”»å›¾åˆ‡å‰²ã€‚ï¼‰</p></li><li><p>å¼€å§‹åˆ‡å‰²ï¼Œå¹¶é€‰æ‹©å°†å›¾ç‰‡ä¸­éç›˜ç¬¦çš„éƒ¨åˆ†æ¶‚é»‘ï¼ˆè¿™ä¸ªå¯ä»¥åœ¨åˆ‡å‰²ä¹‹å‰å°±æ¶‚é»‘äº†ï¼‰</p></li><li><p>å¯¹ä¸€å¼ å›¾ç‰‡å¾—åˆ°çš„19ä¸ªç›˜ç¬¦æ ‡ä¸Šç§ç±»ï¼Œè‡³äºç§ç±»å¯ä»¥é€‰æ‹©åˆ©ç”¨å½“æ—¶çš„jsonæ–‡ä»¶æ¥æ ‡ç§ç±»ã€‚</p></li></ul><p>ç»†èŠ‚è¡¥å……ï¼š</p><ul><li><p>é¦–å…ˆé€šè¿‡å››ä¸ªé¡¶ç‚¹å¾—åˆ°ä¸€ä¸ªæ°´å¹³bboxå¯ä»¥å†™ä¸€ä¸ªå‡½æ•°å¤ç”¨</p></li><li><p>ç»™å®šä¸¤ä¸ªé¡¶ç‚¹å°†å…¶è¿çº¿ç­‰åˆ†å‰²æˆ19ä»½å¹¶è¿”å›è¯¥ç›´çº¿æ‰€åˆ†åæ ‡åˆ—è¡¨ï¼Œæˆ–è€…è¯´ç»™å®šå››ä¸ªé¡¶ç‚¹è¿”å›åˆ‡åˆ†å¥½çš„å„ä¸ªå°ç›˜ç¬¦é¡¶ç‚¹åæ ‡åˆ—è¡¨ï¼ˆæ„æ€å°±æ˜¯åˆ—è¡¨ä¸­æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªåˆ†å¥½çš„å°æ¡†çš„å››ä¸ªé¡¶ç‚¹åæ ‡ï¼‰ã€‚</p></li><li><p>æ¶‚é»‘æ“ä½œå®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥ä¸º</p></li><li><p><strong>ä»¥ä¸Šæ‰€æœ‰çš„æ“ä½œéƒ½æ”¾åˆ°ä¸€ä¸ªç±»é‡Œç»Ÿä¸€å¤„ç†ï¼Œç„¶ååˆ°æ—¶å€™è°ƒç”¨ç›´æ¥æ„å»ºç±»çš„æ—¶å€™å°±è°ƒç”¨äº†è¿›è¡Œå®Œé¢„å¤„ç†æ“ä½œã€‚</strong></p></li></ul><h3 id="å¯¹äºæ™®é€šæ ‡æ³¨labelmeæ–‡ä»¶çš„ç»“æœé¢„å¤„ç†"><a href="#å¯¹äºæ™®é€šæ ‡æ³¨labelmeæ–‡ä»¶çš„ç»“æœé¢„å¤„ç†" class="headerlink" title="å¯¹äºæ™®é€šæ ‡æ³¨labelmeæ–‡ä»¶çš„ç»“æœé¢„å¤„ç†"></a><strong>å¯¹äºæ™®é€šæ ‡æ³¨labelmeæ–‡ä»¶çš„ç»“æœé¢„å¤„ç†</strong></h3><p>å› ä¸ºLabelmeæ–‡ä»¶æ˜¯å¯¹äºæ¯ä¸€ä¸ªå›¾ç‰‡éƒ½æœ‰ä¸€ä¸ªå•ç‹¬çš„jsonæ–‡ä»¶ï¼Œç„¶åæ¯ä¸€ä¸ªjsonæ–‡ä»¶éƒ½ä¼šæœ‰å„ä¸ªç›˜ç¬¦çš„ä½ç½®ä¿¡æ¯è¿˜æœ‰å…·ä½“çš„åæ ‡ç§ç±»ï¼Œæ‰€ä»¥è¿™æ ·ä¸€æ¥ç›¸æ¯”äºåˆ†å‰²çš„ç»“æœè¦å¥½å¾ˆå¤šï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œæ€è·¯ç®€å•å¾ˆå¤šï¼š</p><ul><li><p>è¯»å–<code>.json</code>æ–‡ä»¶</p></li><li><p>å¯¹äºå°†æ¯ä¸ªå°ç›˜ç¬¦å››ä¸ªé¡¶ç‚¹è½¬åŒ–ä¸ºä¸€ä¸ªè¾ƒå¤§çš„bbox</p></li><li><p>å¤§æ¡†bboxå†…éç›˜ç¬¦éƒ¨åˆ†æ¶‚é»‘</p></li><li><p>ä¿å­˜ï¼Œæ³¨æ„å›¾ç‰‡æ ‡ç­¾çš„ä¿å­˜</p></li></ul><h3 id="æ™®é€šlabelmeæ–‡ä»¶è¯»å–åˆ†æ"><a href="#æ™®é€šlabelmeæ–‡ä»¶è¯»å–åˆ†æ" class="headerlink" title="æ™®é€šlabelmeæ–‡ä»¶è¯»å–åˆ†æ"></a>æ™®é€šlabelmeæ–‡ä»¶è¯»å–åˆ†æ</h3><h1 id="2021-12-2æ—¥ä¸‹åˆæ›´æ–°"><a href="#2021-12-2æ—¥ä¸‹åˆæ›´æ–°" class="headerlink" title="2021.12.2æ—¥ä¸‹åˆæ›´æ–°"></a>2021.12.2æ—¥ä¸‹åˆæ›´æ–°</h1><p>æ˜¨å¤©åšäº†å…³äºæ•°æ®é›†çš„æ•´ç†æ“ä½œä»¥åŠå…³äºæ•°æ®çš„è½¬åŒ–æ“ä½œï¼Œç›®å‰ä¸€ä¸ªæˆç†Ÿçš„æ•°æ®é›†å·²ç»è½¬åŒ–å®Œæˆï¼Œä¸è¿‡<strong>ç›¸å…³è®°å½•æ–‡æ¡£æ²¡æœ‰å®Œæˆ</strong>ï¼Œç¡®å®æ²¡æœ‰æ—¶é—´è®°å½•äº†ï¼Œç­‰è¿™ä¸¤å¤©è®°å½•ä¸€ä¸‹ã€‚<br>åŒæ—¶æ˜¨å¤©ä¹Ÿå†™äº†å…³äºæ–‡ä»¶çš„dataloaderçš„è¯»å–ï¼Œè¿™æ–¹é¢è¿˜æ˜¯èŠ±äº†ä¸€äº›å¿ƒæ€çš„ï¼Œç›®å‰æ¥ä¸‹æ¥çš„ä»»åŠ¡å°±æ˜¯æ„å»ºç›¸å…³æ¨¡å‹ç„¶åè¿›è¡Œæœ‰å…³çš„è®­ç»ƒï¼Œå½“ç„¶è¿™é‡Œè€ƒè™‘ä½¿ç”¨ä¸åŒçš„æœ‰å…³æ¨¡å‹æ¯”å¦‚è¯´resnet101, regnetè¿™ç±»éƒ½å°è¯•ä¸€ä¸‹ï¼Œå½“ç„¶å¯ä»¥ç›´æ¥ä»torchvision.modelsç›´æ¥å¯¼å…¥æœ‰å…³çš„æ¨¡å‹ã€‚</p><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯æ­£å¥½æˆ‘ä»¬å¯ä»¥å°†æ•´ä¸ªçš„æ¨¡å‹çš„è®­ç»ƒï¼Œæ•°æ®å¯è§†åŒ–ï¼Œè°ƒæ•´å¯è§†åŒ–ç­‰ç­‰è¿™ä¸€ç³»åˆ—çš„æ“ä½œéƒ½å°è¯•å­¦ä¹ æ“ä½œä¸€éï¼Œè™½ç„¶ä¹‹å‰ä¹Ÿæ•´è¿‡å¥½å¤šéï¼Œä½†æ˜¯è‡ªä»å­¦äº†mmdetectionä¹‹åå°±å¾ˆå°‘å¼„äº†ï¼Œå¯ä»¥å†æ·±å…¥æ¢ç´¢ä¸€ä¸‹ã€‚</p><p>å¦å¤–</p><p>ä¸€äº›å‚è€ƒæ–‡æ¡£ï¼š</p><ul><li><a href="https://blog.csdn.net/weixin_36670529/article/details/105910572" target="_blank" rel="noopener">https://blog.csdn.net/weixin_36670529/article/details/105910572</a></li><li></li></ul><h1 id="2021-12-3æ—¥-amp-amp-4æ—¥-amp-amp-5æ—¥æ›´æ–°"><a href="#2021-12-3æ—¥-amp-amp-4æ—¥-amp-amp-5æ—¥æ›´æ–°" class="headerlink" title="2021.12.3æ—¥&amp;&amp;4æ—¥&amp;&amp;5æ—¥æ›´æ–°"></a>2021.12.3æ—¥&amp;&amp;4æ—¥&amp;&amp;5æ—¥æ›´æ–°</h1><h2 id="Preface-3"><a href="#Preface-3" class="headerlink" title="Preface"></a>Preface</h2><p>æ•°æ®å¤„ç†æœ‰å…³çš„è®°å½•æ–‡æ¡£æ˜¨å¤©å·²ç»æ•´ç†å®Œæ¯•ã€‚ä¸ºäº†å¸å–æ•™è®­ï¼Œä»¥åè¿˜æ˜¯è¾¹å†™è¾¹æ•´ç†æ–‡æ¡£æ¯”è¾ƒå¥½ï¼Œé™¤éæ˜¯æ—¶é—´è¿‡äºç´§æ€¥ã€‚</p><p>ä»Šå¤©å°±å†™ä¸€ä¸‹æœ‰å…³æ¨¡å‹ï¼Œæ ¹æ®ç›®å‰çš„è¿›å±•ï¼Œä»»åŠ¡ä¸»è¦å¦‚ä¸‹ï¼š</p><ul><li>å…³äºéªŒè¯é›†ã€è®­ç»ƒé›†çš„åˆ’åˆ†</li><li>train_one_epochå‡½æ•°</li><li>è®¡ç®—éªŒè¯é›†å‡†ç¡®ç‡çš„å‡½æ•°</li><li>ä½¿ç”¨è‡ªå·±çš„æ•°æ®é›†</li><li>ä½¿ç”¨tqdm</li></ul><h2 id="éªŒè¯é›†ã€è®­ç»ƒé›†çš„åˆ’åˆ†"><a href="#éªŒè¯é›†ã€è®­ç»ƒé›†çš„åˆ’åˆ†" class="headerlink" title="éªŒè¯é›†ã€è®­ç»ƒé›†çš„åˆ’åˆ†"></a>éªŒè¯é›†ã€è®­ç»ƒé›†çš„åˆ’åˆ†</h2><p>å¤§æ¦‚8ï¼š2åˆ’åˆ†ï¼Œå…·ä½“éš¾åº¦å¹¶ä¸é«˜ã€‚ä»…ä»…æ˜¯è®°å¾—ä½¿ç”¨å‡½æ•°shutilå°±OKäº†ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token triple-quoted-string string">"""æœ¬æ¨¡å—ç”¨äºåˆ’åˆ†éªŒè¯é›†å’Œæµ‹è¯•é›†ï¼Œå¤§æ¦‚æ¯”ä¾‹ä¸º8ï¼š2"""</span><span class="token keyword">import</span> shutil<span class="token keyword">import</span> os<span class="token keyword">import</span> random<span class="token keyword">import</span> glob<span class="token keyword">def</span> <span class="token function">move_file</span><span class="token punctuation">(</span>imgs<span class="token punctuation">,</span>  new_path<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">'''è¿™ä¸ªå‡½æ•°æ˜¯ç”¨æ¥ç§»åŠ¨å›¾ç‰‡ä»æ—§è·¯å¾„ç§»åˆ°æ–°è·¯å¾„'''</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>new_path<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># filelist = os.listdir(old_path) # åˆ—å‡ºè¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶,listdirè¿”å›çš„æ–‡ä»¶åˆ—è¡¨æ˜¯ä¸åŒ…å«è·¯å¾„çš„ã€‚</span>    filelist <span class="token operator">=</span> imgs    <span class="token keyword">print</span><span class="token punctuation">(</span>filelist<span class="token punctuation">)</span>    <span class="token keyword">for</span> file <span class="token keyword">in</span> filelist<span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># file = file - "/home/lry/data/780b_std/"</span>        src <span class="token operator">=</span> file        dst <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>new_path<span class="token punctuation">,</span> file<span class="token punctuation">[</span>len<span class="token punctuation">(</span><span class="token string">'/home/lry/data/780b_singe_padded/'</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'src:'</span><span class="token punctuation">,</span> src<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'dst:'</span><span class="token punctuation">,</span> dst<span class="token punctuation">)</span>        shutil<span class="token punctuation">.</span>move<span class="token punctuation">(</span>src<span class="token punctuation">,</span> dst<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># old_path = "/home/lry/data/780b_std"</span>new_val <span class="token operator">=</span> <span class="token string">"/home/lry/data/780b_singe_padded_std/val"</span>new_train <span class="token operator">=</span> <span class="token string">"/home/lry/data/780b_singe_padded_std/train"</span>pics <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">"/home/lry/data/780b_singe_padded/*.jpg"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># print(pics)</span><span class="token keyword">print</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>pics<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># print(pics[0][-30:])</span><span class="token comment" spellcheck="true"># print(len(pics))</span><span class="token comment" spellcheck="true"># print(pics[0][len("/home/lry/data/780b_std/"):-5] + ".jpg")</span><span class="token comment" spellcheck="true"># print(pics[0][:-4])</span><span class="token comment" spellcheck="true"># print(pics)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"moving...."</span><span class="token punctuation">)</span>move_file<span class="token punctuation">(</span>pics<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">702</span><span class="token punctuation">]</span><span class="token punctuation">,</span> new_train<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"train end!"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"moving..."</span><span class="token punctuation">)</span>move_file<span class="token punctuation">(</span>pics<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">702</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> new_val<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"val end!"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># if __name__ == '__main__':</span><span class="token comment" spellcheck="true">#     pics = glob.glob("/home/lry/data/780b_singe_padded_std/train/*.jpg")</span><span class="token comment" spellcheck="true">#     print(len(pics))</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="train-one-epochå‡½æ•°"><a href="#train-one-epochå‡½æ•°" class="headerlink" title="train_one_epochå‡½æ•°"></a>train_one_epochå‡½æ•°</h2><p>è¿™ä¸ªå…·ä½“çš„ä¸å¤šè¯´ï¼Œè¿™é‡Œå°±å†™ä¸€ä¸‹å¤§è‡´çš„æµç¨‹ï¼š</p><ol><li>åˆ©ç”¨dataloaderåŠ è½½æ•°æ®</li><li>æ•°æ®ã€æ¨¡å‹éƒ¨ç½²åˆ°cudaGPUä¸­</li><li>å‰å‘ä¼ æ’­</li><li>è®¡ç®—loss</li><li>åå‘ä¼ æ’­è®¡ç®—æ¢¯åº¦</li><li>è°ƒç”¨ä¼˜åŒ–å™¨ä¼˜åŒ–æ›´æ–°æƒé‡</li><li>åœ¨torch.no_gradæ¡ä»¶ä¸‹è®¡ç®—valå‡†ç¡®ç‡ã€‚</li></ol><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">train_one_epoch</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> trainloader<span class="token punctuation">,</span> valloader<span class="token punctuation">,</span> optimizer<span class="token punctuation">,</span> criterion<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">'''    è®­ç»ƒä¸€ä¸ªepochï¼Œè¿”å›è¯¥epochçš„train_loss, train_acc, val_accå‡†ç¡®ç‡    '''</span>    device <span class="token operator">=</span> torch<span class="token punctuation">.</span>device<span class="token punctuation">(</span><span class="token string">"cuda"</span> <span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">"cpu"</span><span class="token punctuation">)</span>    model<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># train</span>    correct <span class="token operator">=</span> <span class="token number">0</span>    total <span class="token operator">=</span> <span class="token number">0</span>    train_loss <span class="token operator">=</span> <span class="token number">0.0</span>    <span class="token keyword">for</span> i<span class="token punctuation">,</span> data <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>trainloader<span class="token punctuation">)</span><span class="token punctuation">:</span>        labels<span class="token punctuation">,</span> inputs <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>        optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>        output <span class="token operator">=</span> model<span class="token punctuation">(</span>inputs<span class="token punctuation">)</span>        _<span class="token punctuation">,</span> predicted <span class="token operator">=</span> torch<span class="token punctuation">.</span>max<span class="token punctuation">(</span>output<span class="token punctuation">.</span>data<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>        total <span class="token operator">+=</span> labels<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>        correct <span class="token operator">+=</span> <span class="token punctuation">(</span>predicted <span class="token operator">==</span> labels<span class="token punctuation">)</span><span class="token punctuation">.</span>sum<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>        loss <span class="token operator">=</span> criterion<span class="token punctuation">(</span>output<span class="token punctuation">,</span> labels<span class="token punctuation">)</span>        train_loss <span class="token operator">+=</span> loss        loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>        optimizer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>    train_loss <span class="token operator">=</span> train_loss <span class="token operator">/</span> <span class="token number">2808</span>    train_acc <span class="token operator">=</span> correct <span class="token operator">/</span> total    <span class="token comment" spellcheck="true"># valå‡†ç¡®ç‡</span>    correct <span class="token operator">=</span> <span class="token number">0</span>    total <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> data <span class="token keyword">in</span> valloader<span class="token punctuation">:</span>            labels<span class="token punctuation">,</span> images <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>            outputs <span class="token operator">=</span> model<span class="token punctuation">(</span>images<span class="token punctuation">)</span>            _<span class="token punctuation">,</span> predicted <span class="token operator">=</span> torch<span class="token punctuation">.</span>max<span class="token punctuation">(</span>outputs<span class="token punctuation">.</span>data<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            total <span class="token operator">+=</span> labels<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>            correct <span class="token operator">+=</span> <span class="token punctuation">(</span>predicted <span class="token operator">==</span> labels<span class="token punctuation">)</span><span class="token punctuation">.</span>sum<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>    val_acc <span class="token operator">=</span> correct <span class="token operator">/</span> total    <span class="token keyword">return</span> train_loss<span class="token punctuation">,</span> train_acc<span class="token punctuation">,</span> val_acc<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å…³äºå¯¼å…¥æ¨¡å‹"><a href="#å…³äºå¯¼å…¥æ¨¡å‹" class="headerlink" title="å…³äºå¯¼å…¥æ¨¡å‹"></a>å…³äºå¯¼å…¥æ¨¡å‹</h2><blockquote><p>2021.12.4æ›´æ–°ã€‚<br>æ‰€æœ‰æ¨¡å‹éƒ½åœ¨torchvisionåº“é‡Œé¢ï¼Œå…¶ä¸­torchvision.modelsä¿å­˜å®šä¹‰äº†è®¸è®¸å¤šå¤šæˆ‘ä»¬éœ€è¦çš„æ¨¡å‹ã€‚å…·ä½“å¯¼å…¥æ–¹å¼ä¹Ÿéå¸¸ç®€å•ï¼šç›´æ¥<code>torchivision.models.resnet50(pretrained=True)</code>åƒè¿™ç±»å°±è¡Œ,å½“ç„¶å¦‚æœæˆ‘ä»¬æƒ³è¦æ”¹ä¸€äº›ä¸œè¥¿ï¼Œæ¯”å¦‚resnet50æœ€åæœ‰ä¸€ä¸ªä¸€å±‚çš„å…¨è¿æ¥å±‚ï¼Œæˆ‘ä»¬æƒ³è¦æ”¹ä¸€ä¸‹è¿™ä¸ªæœ€åå…¨è¿æ¥å±‚çš„è¾“å‡º,æ¯”æ–¹è¯´ç›®å‰æˆ‘æœ‰14ç±»è¾“å‡ºä½†æ˜¯torchvisionå®˜æ–¹çš„resnet50çš„modelé»˜è®¤æœ€åçš„å…¨è¿æ¥å±‚æ˜¯<code>nn.Linear(2048, 1000)</code>,å› ä¸ºè¿™ä¸ªæ˜¯åŸºäº<code>Imagenet</code>æ•°æ®é›†çš„ã€‚é‚£ä¹ˆå¦‚æœæˆ‘ä»¬è¦æ›´æ”¹ï¼Œä¸€ä¸ªæ–¹æ³•æ˜¯å¯ä»¥æŸ¥çœ‹è¯¥æ¨¡å‹pytorchå®šä¹‰çš„æºä»£ç ï¼Œå› ä¸º<br><code>torchivision.models.resnet50(pretrained=True)</code>è¿™ä¸ªæˆ–è€…è¯´è¿™ç±»å‡½æ•°æ˜¯æœ‰ç›¸å…³çš„å‚æ•°ç”¨æ¥æ”¹æœ€åå…¨è¿æ¥å±‚çš„outputçš„ï¼Œæˆ–è€…å¯ä»¥é€‰æ‹© ç›´æ¥æ›´æ”¹ï¼Œå°±åƒæˆ‘è¿™é‡Œä¸€æ ·ï¼š</p></blockquote><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># å¯¼å…¥æ¨¡å‹</span>model <span class="token operator">=</span> models<span class="token punctuation">.</span>resnet50<span class="token punctuation">(</span>pretrained<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># print(model)</span><span class="token keyword">print</span><span class="token punctuation">(</span>model<span class="token punctuation">.</span>fc<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># æŸ¥çœ‹é»˜è®¤æœ€åä¸€å±‚å…¨è¿æ¥å±‚çš„ç»“æ„</span><span class="token comment" spellcheck="true"># print(type(model.fc))</span><span class="token comment" spellcheck="true"># print(dict(model.fc.named_parameters()).keys())</span>model<span class="token punctuation">.</span>fc <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">,</span> num_classes<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>model<span class="token punctuation">.</span>fc<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°±æ˜¯åˆ©ç”¨<code>model.fc = nn.Linear(2048, num_classes)</code>æ¥å®šä¹‰æœ€åä¸€å±‚çš„å‚æ•°ï¼Œè¿™ä¸ªå¾ˆå·§å¦™å®é™…ä¸Šï¼Œå°±ç›¸å½“äºé‡æ–°å®šä¹‰äº†ä¸€éï¼Œæ”¹äº†ç›¸å…³çš„ç»“æ„ã€‚</p><h2 id="å…³äºéƒ¨ç½²åˆ°cudaä¸Š"><a href="#å…³äºéƒ¨ç½²åˆ°cudaä¸Š" class="headerlink" title="å…³äºéƒ¨ç½²åˆ°cudaä¸Š"></a>å…³äºéƒ¨ç½²åˆ°cudaä¸Š</h2><blockquote><p>2021.12.4æ›´æ–°ã€‚</p></blockquote><p>è¿™ä¸ªæˆ‘ä¹‹å‰ä¸€ç›´ä½¿ç”¨çš„æ˜¯å…³äº<code>device = torch.device(&quot;cuda:0&quot; if torch.cuda.is_available() else &quot;cpu&quot;)</code>æ¥æŒ‡å®šgpuè®­ç»ƒï¼Œä½†æ˜¯ç»“æœå´å¹¶ä¸æ˜¯æˆ‘æƒ³çš„é‚£æ ·åœ¨ç‰¹å®šçš„gpuä¸Šè®­ç»ƒ. è¿™é‡Œç”¨åˆ°äº†ä¹‹å‰ç»„é•¿å»ºè®®çš„ä¸€ç§ç”¨æ³•ï¼Œä¹Ÿæ˜¯ä»–ä»¬å¸¸ç”¨çš„åšæ³•,ç”šè‡³å½“æ—¶æˆ‘è¿˜åœ¨åˆ†å‰²ä»»åŠ¡ä¸­åšäº†çš„ï¼Œè¿™æ˜¯æˆ‘å½“æ—¶åˆ†å‰²ä»»åŠ¡çš„è¿è¡Œä»£ç ï¼š</p><pre class="line-numbers language-python"><code class="language-python">CUDA_VISIBLE_DEVICES<span class="token operator">=</span><span class="token number">1</span> python tools<span class="token operator">/</span>test<span class="token punctuation">.</span>py configs<span class="token operator">/</span>fenghuo<span class="token operator">/</span>mask_rcnn_r50_caffe_fpn_mstrain<span class="token operator">-</span>poly_1x_fenghuo<span class="token punctuation">.</span>py work_dirs<span class="token operator">/</span>mask_rcnn_r50_caffe_fpn_mstrain<span class="token operator">-</span>poly_1x_fenghuo<span class="token operator">/</span>latest<span class="token punctuation">.</span>pth  <span class="token operator">-</span><span class="token operator">-</span>eval bbox segm<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å®é™…ä¸Šä¹Ÿå°±æ˜¯åœ¨ç›¸å…³è¿è¡Œpythonå‘½ä»¤å‰åŠ äº†<code>CUDA_VISIBLE_DEVICES=1</code>,CUDAï¼š1ï¼Œæœ‰æ—¶å€™è¦ä½¿ç”¨å¤šå¼ å¡å¹¶è¡Œå¯ä»¥é€‰æ‹©ä½¿ç”¨é€—å·åˆ†å¼€ä¸¤å¼ å¡ï¼Œä¾‹å¦‚ï¼šCUDA_VISIBLE_DEVICES=1, 2ã€‚<br>è¿™æ ·åšä¹‹åæ¨¡å‹ä¼šè¿›è¡Œå•å¡è®­ç»ƒï¼Œå¦å¤–å½“æˆ‘ä»¬è¦è¿›è¡Œå®æ—¶ç›‘æ§æ˜¾å­˜å’Œè¿›ç¨‹ç›¸å…³ä½¿ç”¨çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨<code>watch</code>å‘½ä»¤ï¼Œæ¯”å¦‚è¯´ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p><pre class="line-numbers language-python"><code class="language-python">watch <span class="token operator">-</span>n <span class="token number">1</span> nvidia<span class="token operator">-</span>smi<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™ä¸ªä»£è¡¨æ¯ä¸€ç§’åˆ·æ–°ä¸€æ¬¡æ˜¾å¡ä½¿ç”¨æƒ…å†µã€‚<br>å…³äºå¤šå¡è¿™æ–¹é¢ï¼Œæ˜¯ä¸€é—¨å¤§å­¦é—®ï¼Œæš‚æ—¶å…ˆä¸åœ¨è¿™é‡Œå±•å¼€è¯´ã€‚</p><h2 id="å…³äºbatch-size"><a href="#å…³äºbatch-size" class="headerlink" title="å…³äºbatch_size"></a>å…³äºbatch_size</h2><blockquote><p>2021.12.4æ›´æ–°ã€‚<br>æœ€ä¸€å¼€å§‹çš„æ—¶å€™è°ƒçš„batch_size=128ï¼Œä½†æ˜¯ç»“æœä¸€ä¸‹å­æ˜¾å­˜ä¸è¶³å¯¼è‡´ç¨‹åºç»ˆæ­¢äº†ã€‚æœ¬æ¥æˆ‘ä»¥ä¸ºè¿™ä¹ˆå¥½çš„æ˜¾å¡ï¼Œå®³ã€‚è¿˜æ˜¯æˆ‘å¤ªè‚¤æµ…äº†ï¼Œæœ¬èº«å›¾ç‰‡å¤§å°å°±ä¸å°ï¼Œä¸€å¼ å›¾ç‰‡<code>1800Ã—180</code>è¿™ä¹ˆå¤§çš„å›¾ç‰‡ç¡®å®(ä¸€èˆ¬ç§‘ç ”æˆ–æ˜¯ä¸€äº›ç»å…¸æ•°æ®é›†è®­ç»ƒéƒ½æ˜¯<code>224Ã—224</code>è¿™ç±»å¤§å°),å†åŠ ä¸Šè¿™äº›æ˜¾å­˜ä»€ä¹ˆçš„å’Œå¡æœ¬èº«æ˜¯2080tiè¿˜æ˜¯3090æ²¡æœ‰å…³ç³»ï¼Œè¿™ä¸ªå’Œæ˜¾å­˜æœ‰å…³ç³»ã€‚è€Œè¿™ä¸ªæœåŠ¡å™¨çš„æ˜¾å­˜æ˜¯12Gï¼Œä¹Ÿä¸æ˜¯å¾ˆå¤§ï¼Œæ‰€ä»¥è¯´æœ€å¥½è¿˜æ˜¯ä¸è¦ç”¨åˆ°è¿™ä¹ˆå¤§çš„batch_sizeäº†ï¼Œåæ¥æ”¹æˆ<code>batch_size=4</code>,ç»“æœå‘ç°ä»…ä»…4ä¸ªbatch_sizeå°±æ¶ˆè€—äº†å‡ ä¹4ä¸ªGçš„æ˜¾å­˜ï¼Œåæ¥è¯•äº†è¯•å°†batch_sizeè°ƒè‡³10ï¼Œç»“æœå·®ä¸å¤šå äº†8ä¸ªGçš„æ˜¾å­˜ï¼Œé¢„è®¡batch_size=16èƒ½å®Œå…¨å æ»¡ï¼Œä¸è¿‡è¿™é‡Œæ²¡æœ‰ç»§ç»­å®éªŒã€‚</p></blockquote><h2 id="å…³äºå¹¶è¡ŒGPUè®¡ç®—"><a href="#å…³äºå¹¶è¡ŒGPUè®¡ç®—" class="headerlink" title="å…³äºå¹¶è¡ŒGPUè®¡ç®—"></a>å…³äºå¹¶è¡ŒGPUè®¡ç®—</h2><blockquote><p>2021.12.4æ›´æ–°ã€‚</p></blockquote><h2 id="è¿›åº¦æ¡tqdm"><a href="#è¿›åº¦æ¡tqdm" class="headerlink" title="è¿›åº¦æ¡tqdm"></a>è¿›åº¦æ¡tqdm</h2><blockquote><p>2021.12.4æ›´æ–°ã€‚<br>è¿›åº¦æ¡æ€ä¹ˆç”¨ï¼Œç›®å‰æˆ‘åªä¼šç”¨éå¸¸åŸºæœ¬çš„ï¼Œå°±æ˜¯ç”¨ä¸€ä¸ª<code>tqdm.tqdm()</code>å†…å«ä¸€ä¸ªiterableçš„å‚æ•°æ¯”å¦‚åˆ—è¡¨è¿™ç±»ã€‚ç„¶åæ”¾åˆ°foré‡Œé¢è¿›è¡Œå¾ªç¯ã€‚å½“ç„¶è¿™ä¼¼ä¹å¯¹æˆ‘ç›®å‰æ¥è¯´ç®—æ˜¯å¤Ÿäº†ï¼Œä½†æ˜¯å¦‚æœæƒ³è¦æ›´è¿›ä¸€æ­¥çš„è¯å¯ä»¥çœ‹çœ‹<a href="https://github.com/tqdm/tqdm" target="_blank" rel="noopener">GitHubæºç åœ°å€</a>ï¼Œä¹Ÿæœ‰ä¸€ä¸ªè¾ƒä¸ºè¯¦ç»†çš„introduction.</p></blockquote><h2 id="ä»»åŠ¡å®Œæˆå¯ç¤ºä¸ä¸è¶³"><a href="#ä»»åŠ¡å®Œæˆå¯ç¤ºä¸ä¸è¶³" class="headerlink" title="ä»»åŠ¡å®Œæˆå¯ç¤ºä¸ä¸è¶³"></a>ä»»åŠ¡å®Œæˆå¯ç¤ºä¸ä¸è¶³</h2><p>ä»¥ä¸Šçš„ä»»åŠ¡æˆåŠŸå†™å®Œï¼Œæ¨¡å‹ä¹ŸæˆåŠŸè·‘å®Œï¼Œç»“æœå¦‚ä¸‹(ä¸€ä¸ªç®€å•çš„ç»“æœ)ï¼š<br><a href="https://imagelol.com/image/LnBiyC" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/12/03/LnBiyC.png" alt></a><br>ç›®å‰åªæ˜¯å®Œæˆäº†ä¸€ä¸ªå°çš„demoè€Œå·²ï¼Œæ•´ä¸ªé¡¹ç›®æœ‰ç€éå¸¸å¤šçš„ä»»åŠ¡éœ€è¦ç»§ç»­åšï¼Œè¿˜æœ‰å¥½å¤šä»£ç ç»§ç»­å†™ã€‚<br>æ¥ä¸‹æ¥è¦å®Œæˆçš„ä»¥åŠç›®å‰å·¥ä½œçš„ä¸è¶³åœ¨äºï¼š</p><ul><li>æ ‡ç­¾æ²¡æœ‰åˆå¹¶æ¥è®­ç»ƒï¼Œç›®å‰å„ä¸ªå°ç±»æ²¡æœ‰åˆå¹¶ï¼Œä»…ä»…æ˜¯æŠŠæ¯ä¸€ä¸ªå°ç±»éƒ½åˆ†å¼€è®­ç»ƒäº†ã€‚</li><li>batch_sizeå¯ä»¥ç»§ç»­è°ƒé«˜ï¼Œå› ä¸ºç›®å‰çš„ä»»åŠ¡å°è¯•batch_size=4å¯ä»¥å‘ç°æ˜¾å­˜å ç”¨äº†4000å¤šå…†ï¼Œç„¶è€ŒæœåŠ¡å™¨å•å¡2080tiå¯ä»¥ä½¿ç”¨è¶…è¿‡11000å…†çš„æ˜¾å­˜ï¼Œæ‰€ä»¥å¯ä»¥å°è¯•è·‘æ»¡ã€‚å½“ç„¶ç›®å‰4å¼ å¡æœ‰2å¼ æ˜¯ç©ºé—²çš„ï¼Œå¦‚æœè¦è¿›ä¸€æ­¥ä½¿ç”¨2å¼ å¡å¹¶è¡Œçš„è¯ï¼Œå¯ä»¥è¯•è¯•<a href="https://pytorch.org/tutorials/intermediate/ddp_tutorial.html" target="_blank" rel="noopener">DISTRIBUTED DATA PARALLEL</a>,å½“ç„¶è¿™ä¸ªå¯èƒ½ç›®å‰æ¯”è¾ƒéš¾ï¼Œä¸è¿‡å¯ä»¥é€‚å½“çœ‹ä¸€çœ‹ï¼Œè¿™æ ·çš„è¯batch_sizeç”šè‡³å¯ä»¥è°ƒåˆ°20ã€‚</li><li>ç›®å‰ä»…ä»…å¯¼å…¥ä½¿ç”¨äº†å®˜æ–¹çš„resnet101ï¼Œè¿˜å¯ä»¥è¯•è¯•å…¶ä»–æ¨¡å‹</li><li>epochå¯ä»¥å¾€ä¸Šè°ƒè°ƒè¯•è¯•</li><li><strong>æ¨¡å‹ã€è®­ç»ƒlogè®°å¾—ä¿å­˜</strong>ï¼ŒåŒ…æ‹¬ä¸€äº›å…³é”®çš„æ•°æ®å¯ä»¥æ”¾åˆ°ä¸€ä¸ªtxtæ–‡æ¡£é‡Œé¢ï¼Œå†™ä»£ç å®ç°logçš„è®°å½•ï¼Œå¯ä»¥å‚è€ƒmmdetectionï¼Œå®ƒçš„è®°å½•å°±éå¸¸è¯¦ç»†ã€‚</li></ul><h2 id="ä¿å­˜è®­ç»ƒæƒé‡ï¼Œæ¨¡å‹æ–¹æ³•"><a href="#ä¿å­˜è®­ç»ƒæƒé‡ï¼Œæ¨¡å‹æ–¹æ³•" class="headerlink" title="ä¿å­˜è®­ç»ƒæƒé‡ï¼Œæ¨¡å‹æ–¹æ³•"></a>ä¿å­˜è®­ç»ƒæƒé‡ï¼Œæ¨¡å‹æ–¹æ³•</h2><blockquote><p>2021.12.4æ›´æ–°ã€‚</p></blockquote><p>ä¸»è¦å‚è€ƒçš„å°±æ˜¯ä»¥ä¸‹æ–‡æ¡£ä»¬ï¼š</p><ul><li><a href="https://zhuanlan.zhihu.com/p/38056115" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/38056115</a></li><li><a href="https://blog.csdn.net/weixin_40522801/article/details/106563354" target="_blank" rel="noopener">https://blog.csdn.net/weixin_40522801/article/details/106563354</a></li><li><a href="https://pytorch.org/tutorials/beginner/saving_loading_models.html" target="_blank" rel="noopener">https://pytorch.org/tutorials/beginner/saving_loading_models.html</a></li></ul><p>å½“ç„¶ä»£ç å†™å¾—å‚è€ƒçš„æœ€å¼€å§‹é‚£ç¯‡çŸ¥ä¹æ–‡æ¡£ï¼Œæ¨¡å‹ä¿å­˜ä»£ç ä¸ºï¼š</p><pre class="line-numbers language-python"><code class="language-python">launchTimestamp <span class="token operator">=</span> str<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        torch<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'epoch'</span><span class="token punctuation">:</span> epoch <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'state_dict'</span><span class="token punctuation">:</span> model<span class="token punctuation">.</span>state_dict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'best_loss'</span><span class="token punctuation">:</span> best_loss<span class="token punctuation">,</span>                            <span class="token string">'optimizer'</span><span class="token punctuation">:</span> optimizer<span class="token punctuation">.</span>state_dict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>                           <span class="token string">'/home/lry/projects/mmdetection/lry/model_classification/checkpoints'</span> <span class="token operator">+</span> <span class="token string">'/resnet50-m-'</span> <span class="token operator">+</span> launchTimestamp <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> str<span class="token punctuation">(</span><span class="token string">"%.4f"</span> <span class="token operator">%</span> best_loss<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.pth.tar'</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>f<span class="token string">'model {launchTimestamp} saved!'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç›®å‰è¿˜æ²¡å°è¯•è¿‡åŠ è½½æ¨¡å‹ï¼Œå…ˆä¸è€ƒè™‘äº†ï¼Œä»¥åå†è¯´å§ã€‚</p><h2 id="æ¨¡å‹çš„ç±»åˆ«åˆå¹¶"><a href="#æ¨¡å‹çš„ç±»åˆ«åˆå¹¶" class="headerlink" title="æ¨¡å‹çš„ç±»åˆ«åˆå¹¶"></a>æ¨¡å‹çš„ç±»åˆ«åˆå¹¶</h2><blockquote><p>2021.12.4æ›´æ–°ã€‚<br>è¿™æ–¹é¢å®é™…ä¸Šå¤§å¤šéƒ½æ˜¯è„æ´»ç´¯æ´»ï¼Œéœ€è¦ä»‹ç»çš„æ°æ°ä¸å¤ªå¤š.<br>ä¸è¿‡ç¡®å®æ¯”è¾ƒè€ƒéªŒä»£ç èƒ½åŠ›ã€‚</p></blockquote><h2 id="å…³äºlr-scheduler"><a href="#å…³äºlr-scheduler" class="headerlink" title="å…³äºlr_scheduler"></a>å…³äºlr_scheduler</h2><blockquote><p>2021.12.4æ›´æ–°ã€‚<br>å‚è€ƒæ–‡æ¡£ï¼š<a href="https://www.kaggle.com/isbhargav/guide-to-pytorch-learning-rate-scheduling" target="_blank" rel="noopener">https://www.kaggle.com/isbhargav/guide-to-pytorch-learning-rate-scheduling</a></p></blockquote><h2 id="åˆ†ç±»ä»»åŠ¡å®Œæˆå¯ç¤ºä¸ä¸è¶³"><a href="#åˆ†ç±»ä»»åŠ¡å®Œæˆå¯ç¤ºä¸ä¸è¶³" class="headerlink" title="åˆ†ç±»ä»»åŠ¡å®Œæˆå¯ç¤ºä¸ä¸è¶³"></a>åˆ†ç±»ä»»åŠ¡å®Œæˆå¯ç¤ºä¸ä¸è¶³</h2><p>æœ¬äººä»»åŠ¡æ¥è¿‘æ”¶å°¾ï¼Œç›®å‰è¿˜æ˜¯éå¸¸æ»¡æ„çš„ï¼Œè‡³å°‘å¯¹äºç»“æœæ¥è¯´ï¼š<br><a href="https://imagelol.com/image/LnTsAT" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/12/03/LnTsAT.png" alt></a></p><p>æœ¬æ¥æˆ‘è¿˜æƒ³è¿›ä¸€æ­¥å°è¯•ä¸€ä¸‹ä¸åŒçš„å­¦ä¹ ç‡å’Œä¸€äº›å…¶ä»–çš„æ¨¡å‹ï¼Œä½†æ˜¯ç”±äºæœ¬æ¬¡å®éªŒå®é™…ä¸Šå¯¹äºä»»åŠ¡æœ¬èº«å·²ç»å®Œæˆäº†ï¼Œå¦‚æœæƒ³è¦æ·±å…¥ç ”ç©¶å¯ä»¥ä¹‹ååšç ”ç©¶æ—¶æˆ–æ˜¯æƒ³è¦æ¢ç´¢å†è¯´äº†ã€‚<br>è€Œå¯¹äºæœ¬æ¬¡æ¥çœ‹ï¼Œå®é™…ä¸Šå®Œå…¨å¤Ÿäº†ã€‚æ¥ä¸‹æ¥å°±æˆ‘ä¸ªäººè€Œè¨€ï¼Œæˆ‘æƒ³åšçš„ä¸€äº›ä¸œè¥¿å°±æ˜¯ï¼š</p><ul><li><a href="https://pytorch.org/tutorials/intermediate/ddp_tutorial.html" target="_blank" rel="noopener">DISTRIBUTED DATA PARALLEL</a>å¤šå¡è®­ç»ƒï¼Œå¯ä»¥é—®ä¸€ä¸‹å¼ ç»´å¤©å­¦å§å¥¹çš„å¤šå¡è®­ç»ƒæ˜¯æ€ä¹ˆå¼„çš„ã€‚</li><li>å¤šçœ‹çœ‹åˆ«äººå†™çš„pytorchä»£ç ï¼Œä¸ç®¡æ˜¯å“ªä¸€ç±»çš„ä»£ç éƒ½è¡Œ</li><li>å…³äºåˆ†å‰²ä»»åŠ¡çš„iouè°ƒèŠ‚æ¢ç´¢</li><li>transformerè®ºæ–‡çš„é˜…è¯»ä¸å­¦ä¹ ï¼Œå°¤å…¶æ˜¯å…³äº</li><li>å†™å®Œä¸Šé¢çš„æ–‡æ¡£(<del>å”‰å¥½å¤šæ–‡æ¡£è¦å†™ï¼Œå¯ä»¥å…ˆå†™å¤šå¡è®­ç»ƒéƒ¨åˆ†ï¼šè¾¹å­¦å¤šå¡è®­ç»ƒè¾¹å†™</del>)</li><li>å¯¼å…¥æ¨¡å‹æ–¹å¼ä¹Ÿå¯ä»¥çœ‹çœ‹<code>hello-dian-ai</code>ä¸­çš„lab2å¯¼å…¥é¢„è®­ç»ƒbackboneçš„æ–¹å¼ã€‚</li></ul><p>è¿™æ˜¯æˆªæ­¢åˆ°æœ¬å‘¨äº”æˆ‘çš„è¿™äº”å¤©ç›¸å…³ä»»åŠ¡ä»£ç å’Œæ—¶é—´çš„ç»Ÿè®¡ï¼Œpythonä»£ç æ•²äº†16ä¸ªå°æ—¶ï¼Œmarkdownç¬”è®°è®°äº†5ä¸ªå°æ—¶ã€‚æ€»ä½“æ¥çœ‹æœ¬å‘¨ä¸‰ï¼ˆ12.1æ—¥ï¼‰æ•²å¾—æœ€å¤šï¼Œæ•²äº†7ä¸ªå¤šå°æ—¶pythonä»£ç ã€‚å¯¹äºå·¥ä½œè¿˜æ˜¯éå¸¸æ»¡æ„çš„ï¼<br><a href="https://imagelol.com/image/LnT0pO" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/12/03/LnT0pO.png" alt></a></p><h2 id="DISTRIBUTED-DATA-PARALLEL"><a href="#DISTRIBUTED-DATA-PARALLEL" class="headerlink" title="DISTRIBUTED DATA PARALLEL"></a>DISTRIBUTED DATA PARALLEL</h2><p>Reference:</p><ul><li><a href="https://pytorch.org/tutorials/intermediate/ddp_tutorial.html" target="_blank" rel="noopener">https://pytorch.org/tutorials/intermediate/ddp_tutorial.html</a></li><li><a href="https://github.com/tczhangzhi/pytorch-distributed" target="_blank" rel="noopener">https://github.com/tczhangzhi/pytorch-distributed</a></li><li><a href="https://zhuanlan.zhihu.com/p/31558973" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/31558973</a></li><li><a href="https://www.cnblogs.com/jiangkejie/p/14603479.html" target="_blank" rel="noopener">https://www.cnblogs.com/jiangkejie/p/14603479.html</a></li><li><a href="https://zhuanlan.zhihu.com/p/86441879" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/86441879</a></li></ul><h2 id="ä¿®æ”¹åˆ†å‰²ä»»åŠ¡çš„IOU"><a href="#ä¿®æ”¹åˆ†å‰²ä»»åŠ¡çš„IOU" class="headerlink" title="ä¿®æ”¹åˆ†å‰²ä»»åŠ¡çš„IOU"></a>ä¿®æ”¹åˆ†å‰²ä»»åŠ¡çš„IOU</h2><p>mmlabæœ€åˆé»˜è®¤çš„é…ç½®ä¸ºï¼š</p><pre class="line-numbers language-python"><code class="language-python">    <span class="token comment" spellcheck="true"># model training and testing settings</span>    train_cfg<span class="token operator">=</span>dict<span class="token punctuation">(</span>        rpn<span class="token operator">=</span>dict<span class="token punctuation">(</span>            assigner<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'MaxIoUAssigner'</span><span class="token punctuation">,</span>                pos_iou_thr<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">,</span>                neg_iou_thr<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span>                min_pos_iou<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span>                match_low_quality<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                ignore_iof_thr<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            sampler<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'RandomSampler'</span><span class="token punctuation">,</span>                num<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>                pos_fraction<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                neg_pos_ub<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>                add_gt_as_proposals<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            allowed_border<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>            pos_weight<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>            debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        rpn_proposal<span class="token operator">=</span>dict<span class="token punctuation">(</span>            nms_pre<span class="token operator">=</span><span class="token number">2000</span><span class="token punctuation">,</span>            max_per_img<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>            nms<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'nms'</span><span class="token punctuation">,</span> iou_threshold<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            min_bbox_size<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        rcnn<span class="token operator">=</span>dict<span class="token punctuation">(</span>            assigner<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'MaxIoUAssigner'</span><span class="token punctuation">,</span>                pos_iou_thr<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                neg_iou_thr<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                min_pos_iou<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                match_low_quality<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                ignore_iof_thr<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            sampler<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'RandomSampler'</span><span class="token punctuation">,</span>                num<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span>                pos_fraction<span class="token operator">=</span><span class="token number">0.25</span><span class="token punctuation">,</span>                neg_pos_ub<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>                add_gt_as_proposals<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            mask_size<span class="token operator">=</span><span class="token number">28</span><span class="token punctuation">,</span>            pos_weight<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>            debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    test_cfg<span class="token operator">=</span>dict<span class="token punctuation">(</span>        rpn<span class="token operator">=</span>dict<span class="token punctuation">(</span>            nms_pre<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>            max_per_img<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>            nms<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'nms'</span><span class="token punctuation">,</span> iou_threshold<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            min_bbox_size<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        rcnn<span class="token operator">=</span>dict<span class="token punctuation">(</span>            score_thr<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">,</span>            nms<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'nms'</span><span class="token punctuation">,</span> iou_threshold<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            max_per_img<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>            mask_thr_binary<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬è¿™é‡Œè°ƒæ•´äº†ç›¸å…³çš„<code>pos_iou_thread=0.9 or 0.8</code>,å½“ç„¶rpnå’Œrcnnä»¥åŠnmséƒ¨åˆ†éƒ½è°ƒäº†ã€‚è°ƒæ•´åä¸ºï¼š</p><pre class="line-numbers language-python"><code class="language-python">    <span class="token comment" spellcheck="true"># model training and testing settings</span>    train_cfg<span class="token operator">=</span>dict<span class="token punctuation">(</span>        rpn<span class="token operator">=</span>dict<span class="token punctuation">(</span>            assigner<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'MaxIoUAssigner'</span><span class="token punctuation">,</span>                pos_iou_thr<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>                neg_iou_thr<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                min_pos_iou<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span>                match_low_quality<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                ignore_iof_thr<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            sampler<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'RandomSampler'</span><span class="token punctuation">,</span>                num<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>                pos_fraction<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                neg_pos_ub<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>                add_gt_as_proposals<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            allowed_border<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>            pos_weight<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>            debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        rpn_proposal<span class="token operator">=</span>dict<span class="token punctuation">(</span>            nms_pre<span class="token operator">=</span><span class="token number">2000</span><span class="token punctuation">,</span>            max_per_img<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>            nms<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'nms'</span><span class="token punctuation">,</span> iou_threshold<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            min_bbox_size<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        rcnn<span class="token operator">=</span>dict<span class="token punctuation">(</span>            assigner<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'MaxIoUAssigner'</span><span class="token punctuation">,</span>                pos_iou_thr<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span>                neg_iou_thr<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                min_pos_iou<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                match_low_quality<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                ignore_iof_thr<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            sampler<span class="token operator">=</span>dict<span class="token punctuation">(</span>                type<span class="token operator">=</span><span class="token string">'RandomSampler'</span><span class="token punctuation">,</span>                num<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span>                pos_fraction<span class="token operator">=</span><span class="token number">0.25</span><span class="token punctuation">,</span>                neg_pos_ub<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>                add_gt_as_proposals<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            mask_size<span class="token operator">=</span><span class="token number">28</span><span class="token punctuation">,</span>            pos_weight<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>            debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    test_cfg<span class="token operator">=</span>dict<span class="token punctuation">(</span>        rpn<span class="token operator">=</span>dict<span class="token punctuation">(</span>            nms_pre<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>            max_per_img<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>            nms<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'nms'</span><span class="token punctuation">,</span> iou_threshold<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            min_bbox_size<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        rcnn<span class="token operator">=</span>dict<span class="token punctuation">(</span>            score_thr<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">,</span>            nms<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'nms'</span><span class="token punctuation">,</span> iou_threshold<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            max_per_img<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>            mask_thr_binary<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªæ–‡æ¡£æ˜¯æˆ‘æ‰¾configæ¥å›æ‰¾æœ€åå›æº¯åˆ°çš„ï¼Œç”±äºå›æº¯è¿‡ç¨‹æ¯”è¾ƒéº»çƒ¦ï¼Œæ–‡ä»¶åä»€ä¹ˆçš„å‘½åï¼Œæœ€åä¹Ÿæ˜¯æ‰¾äº†æŒºé•¿æ—¶é—´æ‰¾<strong>å‡†</strong>äº†ã€‚ç²¾ç¡®ä½ç½®åœ¨<code>/home/lry/projects/mmdetection/configs/_base_/models/mask_rcnn_r50_fpn.py</code>è¿™é‡Œã€‚</p><p>åˆ«çš„æ²¡æœ‰å¤ªå¤šæ”¹å˜ï¼Œå°±è®­ç»ƒå®Œäº†ä¹‹åæœ‰äº›äº†ä¸€ä¸ªæ–°çš„inferenceçš„pythonä»£ç ï¼Œåœ¨<code>/home/lry/projects/mmdetection/lry/compare_sege.py</code>,ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token triple-quoted-string string">"""æœ¬æ¨¡å—æ˜¯ä¸€ä¸ªå°demoï¼Œç”¨æ¥å¯¹æ¯”å•å¼ å›¾ç‰‡ç»“æœæ€ä¹ˆæ ·"""</span><span class="token keyword">from</span> mmdet<span class="token punctuation">.</span>apis <span class="token keyword">import</span> init_detector<span class="token punctuation">,</span>inference_detector<span class="token punctuation">,</span> show_result_pyplot<span class="token keyword">import</span> mmcv<span class="token keyword">import</span> os<span class="token keyword">import</span> glob<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image<span class="token keyword">from</span> torchvision<span class="token punctuation">.</span>transforms <span class="token keyword">import</span> ToTensor<span class="token keyword">import</span> torch <span class="token keyword">as</span> t<span class="token comment" spellcheck="true"># å®šä¹‰model</span>config_file <span class="token operator">=</span> <span class="token string">"/home/lry/projects/mmdetection/configs/fenghuo/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_fenghuo.py"</span>checkpoint_file_before <span class="token operator">=</span> <span class="token string">"/home/lry/projects/mmdetection/work_dirs/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_fenghuo/latest.pth"</span>checkpoint_file_after <span class="token operator">=</span> <span class="token string">"/home/lry/checkpoints/fenghuo/model_segementation_maskrcnn_10/latest.pth"</span>model_before <span class="token operator">=</span> init_detector<span class="token punctuation">(</span>config_file<span class="token punctuation">,</span> checkpoint_file_before<span class="token punctuation">,</span>device<span class="token operator">=</span><span class="token string">"cuda:3"</span><span class="token punctuation">)</span>model_after <span class="token operator">=</span> init_detector<span class="token punctuation">(</span>config_file<span class="token punctuation">,</span> checkpoint_file_after<span class="token punctuation">,</span>device<span class="token operator">=</span><span class="token string">"cuda:2"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># é€‰å–éªŒè¯é›†çš„å‰10å¼ å›¾ç‰‡è¿›è¡ŒéªŒè¯</span>imgs <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">'/home/lry/data/780b_std/val/*.jpg'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token keyword">for</span> i<span class="token punctuation">,</span> img <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>imgs<span class="token punctuation">)</span><span class="token punctuation">:</span>    result_b <span class="token operator">=</span> inference_detector<span class="token punctuation">(</span>model_before<span class="token punctuation">,</span> img<span class="token punctuation">)</span>    model_before<span class="token punctuation">.</span>show_result<span class="token punctuation">(</span>img<span class="token punctuation">,</span> result_b<span class="token punctuation">,</span> out_file<span class="token operator">=</span>f<span class="token string">'/home/lry/checkpoints/fenghuo/compare/before/demo_val{i}.jpg'</span><span class="token punctuation">)</span>    result_a <span class="token operator">=</span> inference_detector<span class="token punctuation">(</span>model_after<span class="token punctuation">,</span> img<span class="token punctuation">)</span>    model_after<span class="token punctuation">.</span>show_result<span class="token punctuation">(</span>img<span class="token punctuation">,</span> result_a<span class="token punctuation">,</span> out_file<span class="token operator">=</span>f<span class="token string">'/home/lry/checkpoints/fenghuo/compare/after/demo_val{i}.jpg'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è®­ç»ƒæ³¨æ„"><a href="#è®­ç»ƒæ³¨æ„" class="headerlink" title="è®­ç»ƒæ³¨æ„"></a>è®­ç»ƒæ³¨æ„</h2><p>è¿™é‡Œè®­ç»ƒçš„æ—¶å€™ä¸ç»„é•¿äº¤æµçš„æ—¶å€™å‘ç°æœ‰è¿™ä¹ˆä¸€äº›é—®é¢˜ï¼š</p>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> çƒ½ç«é›†å›¢ </tag>
            
            <tag> é¡¹ç›® </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>rpc explore</title>
      <link href="/2021/11/06/rpc-explore/"/>
      <url>/2021/11/06/rpc-explore/</url>
      
        <content type="html"><![CDATA[<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>æœ€è¿‘åœ¨å­¦C++ï¼Œæƒ³è¦å†™ä¸€äº›C++çš„ä»£ç ï¼Œä½†æ˜¯ç›®å‰è‹¦äºä¸çŸ¥é“å†™å•¥æ¯”è¾ƒå¥½ï¼Œæƒ³å†™ä¸€äº›æ¯”è¾ƒå®ç”¨çš„ï¼Œä½†æ˜¯ç¡®å®æ²¡å•¥èƒ½åŠ›ï¼Œæ‰¾äº†æ‰¾é¡¹ç›®ç»„é•¿jhyï¼Œä»–å‘Šè¯‰æˆ‘è¯´æœ€è¿‘ä»–æœ‰ä¸€äº›å†™è½®å­çš„éœ€æ±‚ï¼Œæ­£å¥½æˆ‘æ‹¿è¿™ä¸ªç»ƒä¸€ä¸‹æ‰‹ã€‚</p><p>rpcï¼Œè¿™ä¸ªä¼¼ä¹æ¶‰åŠåˆ°äº†ç½‘ç»œç¼–ç¨‹â€¦â€¦å¥½å®¶ä¼™ï¼Œè¿™ä¸ªçœ‹èµ·æ¥éš¾åº¦å¹¶ä¸å°å•Šâ€¦â€¦</p><p>ä¸è¿‡ä¼¼ä¹è¿™ä¸ªå¹¶ä¸éœ€è¦ä»€ä¹ˆå…ˆéªŒçŸ¥è¯†ï¼Ÿä¸ç®¡æ€ä¹ˆæ ·ï¼Œæˆ‘å…ˆæŠŠå¯èƒ½è¦ç”¨åˆ°çš„çŸ¥è¯†ç½‘ç»œé“¾æ¥å…ˆåˆ—å‡ºæ¥ï¼š</p><ul><li><p>ä»€ä¹ˆæ˜¯RPCï¼š</p><ul><li>é€šä¿—è¯­è¨€è§£é‡Šä¸€ä¸‹RPCæ¡†æ¶ï¼š<a href="https://www.zhihu.com/question/25536695" target="_blank" rel="noopener">https://www.zhihu.com/question/25536695</a></li><li>ä»€ä¹ˆæ˜¯RPCï¼š<a href="https://www.jianshu.com/p/7d6853140e13" target="_blank" rel="noopener">https://www.jianshu.com/p/7d6853140e13</a> </li><li>å¦‚ä½•ç»™è€å©†è§£é‡Šä»€ä¹ˆæ˜¯RPCï¼š<a href="https://zhuanlan.zhihu.com/p/36427583" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/36427583</a></li></ul></li><li><p>socketåº“æ•™ç¨‹ï¼š</p><ul><li>socketåº“èœé¸Ÿæ•™ç¨‹ï¼š<a href="https://www.runoob.com/python/python-socket.html" target="_blank" rel="noopener">https://www.runoob.com/python/python-socket.html</a></li><li>socketç¼–ç¨‹ï¼š<a href="https://www.liujiangblog.com/course/python/76" target="_blank" rel="noopener">https://www.liujiangblog.com/course/python/76</a></li><li>å®˜ç½‘æ•™ç¨‹ï¼š<a href="https://docs.python.org/zh-tw/3/howto/sockets.html" target="_blank" rel="noopener">https://docs.python.org/zh-tw/3/howto/sockets.html</a></li></ul></li><li><p>å¾®è½¯æ–‡æ¡£winsock:</p><ul><li>get started: <a href="https://docs.microsoft.com/en-us/windows/win32/winsock/getting-started-with-winsock" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/windows/win32/winsock/getting-started-with-winsock</a></li><li>complete winsock client code:    <a href="https://docs.microsoft.com/en-us/windows/win32/winsock/complete-client-code" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/windows/win32/winsock/complete-client-code</a></li><li>Complete Winsock Server Code: <a href="https://docs.microsoft.com/en-us/windows/win32/winsock/complete-server-code" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/windows/win32/winsock/complete-server-code</a></li></ul></li><li><p>nrpcé¡¹ç›®åœ°å€ï¼š</p><ul><li><a href="https://github.com/npurson/nrpc" target="_blank" rel="noopener">https://github.com/npurson/nrpc</a></li></ul></li><li><p>æç®€C++Library</p><ul><li>Bç«™ç®€å•ä»‹ç»ï¼š<a href="https://www.bilibili.com/video/BV1Qc411877H?from=search&amp;seid=9190274609142958771&amp;spm_id_from=333.337.0.0" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1Qc411877H?from=search&amp;seid=9190274609142958771&amp;spm_id_from=333.337.0.0</a></li><li>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/button-chen/buttonrpc_cpp14" target="_blank" rel="noopener">https://github.com/button-chen/buttonrpc_cpp14</a></li></ul></li></ul><p>ç›®å‰çœ‹<a href="https://www.runoob.com/python/python-socket.html" target="_blank" rel="noopener">èœé¸Ÿæ•™ç¨‹</a>å’Œ<a href="https://www.liujiangblog.com/course/python/76" target="_blank" rel="noopener">åˆ˜æ±Ÿåšå®¢æ•™ç¨‹</a>å­¦äº†ä¸€äº›åŸºæœ¬çš„.æ„Ÿè§‰<a href="https://docs.python.org/zh-cn/3/howto/sockets.html" target="_blank" rel="noopener">å®˜ç½‘æ•™ç¨‹</a>ä¹Ÿå€¼å¾—ä¸€è¯».å½“ç„¶ï¼Œä»¥ä¸‹åšå®¢å¯èƒ½è®°å½•å¹¶ä¸æ˜¯éå¸¸å…¨ï¼Œä¸€æ—¶é—´æ— æ³•å…¨éƒ¨æƒ³èµ·æ¥ã€‚</p><h1 id="Socket-in-Python"><a href="#Socket-in-Python" class="headerlink" title="Socket in Python"></a>Socket in Python</h1><h2 id="intro"><a href="#intro" class="headerlink" title="intro"></a>intro</h2><p>Socketåˆç§°â€å¥—æ¥å­—â€ï¼Œåº”ç”¨ç¨‹åºé€šå¸¸é€šè¿‡â€å¥—æ¥å­—â€å‘ç½‘ç»œå‘å‡ºè¯·æ±‚æˆ–è€…åº”ç­”ç½‘ç»œè¯·æ±‚ï¼Œä½¿ä¸»æœºé—´æˆ–è€…ä¸€å°è®¡ç®—æœºä¸Šçš„è¿›ç¨‹é—´å¯ä»¥é€šè®¯ã€‚å½“ç„¶è¿™ä¹ˆè¯´å¯èƒ½æ¯”è¾ƒè¿˜æ˜¯å¾ˆéš¾ç†è§£ï¼Œæˆ‘ä»¬ç»§ç»­æ‰ç¢äº†è¯´ã€‚</p><p>å®Œæ•´çš„socketé€šä¿¡é€»è¾‘å¦‚ä¸‹ï¼š</p><p><a href="https://imagelol.com/image/IjzXTO" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/11/06/IjzXTO.png" alt></a></p><p>è¿™äº›æ˜¯æœ€åŸºæœ¬ä¹Ÿæ˜¯å”¯ä¸€éœ€è¦æ­»è®°ç¡¬èƒŒçš„çŸ¥è¯†ç‚¹ã€‚è¿™äº›å°±æ˜¯æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„ä¸»è¦è¿è¡Œé€»è¾‘ã€‚</p><p>æˆ‘ä»¬åœ¨pythonä¸­ä¸€èˆ¬ä¼šç”¨socket()å‡½æ•°æ¥åˆ›å»ºå¥—æ¥å­—ï¼Œè¯­æ³•æ ¼å¼ä¸ºï¼š</p><pre class="line-numbers language-python"><code class="language-python">socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span><span class="token punctuation">[</span>family<span class="token punctuation">[</span><span class="token punctuation">,</span> type<span class="token punctuation">[</span><span class="token punctuation">,</span> proto<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="å‡½æ•°socketå‚æ•°"><a href="#å‡½æ•°socketå‚æ•°" class="headerlink" title="å‡½æ•°socketå‚æ•°"></a>å‡½æ•°socketå‚æ•°</h2><pre><code>* family: å¥—æ¥å­—å®¶æ—å¯ä»¥ä½¿ AF_UNIX æˆ–è€… AF_INETã€‚* type: å¥—æ¥å­—ç±»å‹å¯ä»¥æ ¹æ®æ˜¯é¢å‘è¿æ¥çš„è¿˜æ˜¯éè¿æ¥åˆ†ä¸º SOCK_STREAM æˆ– SOCK_DGRAMã€‚* protocol: ä¸€èˆ¬ä¸å¡«é»˜è®¤ä¸º 0ã€‚</code></pre><h2 id="Socket-å¯¹è±¡-å†…å»º-æ–¹æ³•"><a href="#Socket-å¯¹è±¡-å†…å»º-æ–¹æ³•" class="headerlink" title="Socket å¯¹è±¡(å†…å»º)æ–¹æ³•"></a>Socket å¯¹è±¡(å†…å»º)æ–¹æ³•</h2><p>ä¸‹é¢æ˜¯ä¸€å¤§å †å¾ˆæœ‰ç”¨éå¸¸æœ‰å¿…è¦äº†è§£ä½†ä¸éœ€è¦åˆ»æ„å»è®°çš„å†…å®¹ï¼š</p><table><thead><tr><th align="left">å‡½æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">æœåŠ¡å™¨ç«¯å¥—æ¥å­—</td><td align="left"></td></tr><tr><td align="left">s.bind()</td><td align="left">ç»‘å®šåœ°å€ï¼ˆhost,portï¼‰åˆ°å¥—æ¥å­—ï¼Œ åœ¨ AF_INETä¸‹ï¼Œä»¥å…ƒç»„ï¼ˆhost,portï¼‰çš„å½¢å¼è¡¨ç¤ºåœ°å€ã€‚</td></tr><tr><td align="left">s.listen()</td><td align="left">å¼€å§‹ TCP ç›‘å¬ã€‚backlog æŒ‡å®šåœ¨æ‹’ç»è¿æ¥ä¹‹å‰ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥æŒ‚èµ·çš„æœ€å¤§è¿æ¥æ•°é‡ã€‚è¯¥å€¼è‡³å°‘ä¸º 1ï¼Œå¤§éƒ¨åˆ†åº”ç”¨ç¨‹åºè®¾ä¸º 5 å°±å¯ä»¥äº†ã€‚</td></tr><tr><td align="left">s.accept()</td><td align="left">è¢«åŠ¨æ¥å—TCPå®¢æˆ·ç«¯è¿æ¥,(é˜»å¡å¼)ç­‰å¾…è¿æ¥çš„åˆ°æ¥</td></tr><tr><td align="left">å®¢æˆ·ç«¯å¥—æ¥å­—</td><td align="left"></td></tr><tr><td align="left">s.connect()</td><td align="left">ä¸»åŠ¨åˆå§‹åŒ–TCPæœåŠ¡å™¨è¿æ¥ï¼Œã€‚ä¸€èˆ¬addressçš„æ ¼å¼ä¸ºå…ƒç»„ï¼ˆhostname,portï¼‰ï¼Œå¦‚æœè¿æ¥å‡ºé”™ï¼Œè¿”å›socket.erroré”™è¯¯ã€‚</td></tr><tr><td align="left">s.connect_ex()</td><td align="left">connect()å‡½æ•°çš„æ‰©å±•ç‰ˆæœ¬,å‡ºé”™æ—¶è¿”å›å‡ºé”™ç ,è€Œä¸æ˜¯æŠ›å‡ºå¼‚å¸¸</td></tr><tr><td align="left">å…¬å…±ç”¨é€”çš„å¥—æ¥å­—å‡½æ•°</td><td align="left"></td></tr><tr><td align="left">s.recv()</td><td align="left">æ¥æ”¶ TCP æ•°æ®ï¼Œæ•°æ®ä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›ï¼Œbufsize æŒ‡å®šè¦æ¥æ”¶çš„æœ€å¤§æ•°æ®é‡ã€‚flag æä¾›æœ‰å…³æ¶ˆæ¯çš„å…¶ä»–ä¿¡æ¯ï¼Œé€šå¸¸å¯ä»¥å¿½ç•¥ã€‚</td></tr><tr><td align="left">s.send()</td><td align="left">å‘é€ TCP æ•°æ®ï¼Œå°† string ä¸­çš„æ•°æ®å‘é€åˆ°è¿æ¥çš„å¥—æ¥å­—ã€‚è¿”å›å€¼æ˜¯è¦å‘é€çš„å­—èŠ‚æ•°é‡ï¼Œè¯¥æ•°é‡å¯èƒ½å°äº string çš„å­—èŠ‚å¤§å°ã€‚</td></tr><tr><td align="left">s.sendall()</td><td align="left">å®Œæ•´å‘é€ TCP æ•°æ®ã€‚å°† string ä¸­çš„æ•°æ®å‘é€åˆ°è¿æ¥çš„å¥—æ¥å­—ï¼Œä½†åœ¨è¿”å›ä¹‹å‰ä¼šå°è¯•å‘é€æ‰€æœ‰æ•°æ®ã€‚æˆåŠŸè¿”å› Noneï¼Œå¤±è´¥åˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</td></tr><tr><td align="left">s.recvfrom()</td><td align="left">æ¥æ”¶ UDP æ•°æ®ï¼Œä¸ recv() ç±»ä¼¼ï¼Œä½†è¿”å›å€¼æ˜¯ï¼ˆdata,addressï¼‰ã€‚å…¶ä¸­ data æ˜¯åŒ…å«æ¥æ”¶æ•°æ®çš„å­—ç¬¦ä¸²ï¼Œaddress æ˜¯å‘é€æ•°æ®çš„å¥—æ¥å­—åœ°å€ã€‚</td></tr><tr><td align="left">s.sendto()</td><td align="left">å‘é€ UDP æ•°æ®ï¼Œå°†æ•°æ®å‘é€åˆ°å¥—æ¥å­—ï¼Œaddress æ˜¯å½¢å¼ä¸ºï¼ˆipaddrï¼Œportï¼‰çš„å…ƒç»„ï¼ŒæŒ‡å®šè¿œç¨‹åœ°å€ã€‚è¿”å›å€¼æ˜¯å‘é€çš„å­—èŠ‚æ•°ã€‚</td></tr><tr><td align="left">s.close()</td><td align="left">å…³é—­å¥—æ¥å­—</td></tr><tr><td align="left">s.getpeername()</td><td align="left">è¿”å›è¿æ¥å¥—æ¥å­—çš„è¿œç¨‹åœ°å€ã€‚è¿”å›å€¼é€šå¸¸æ˜¯å…ƒç»„ï¼ˆipaddr,portï¼‰ã€‚</td></tr><tr><td align="left">s.getsockname()</td><td align="left">è¿”å›å¥—æ¥å­—è‡ªå·±çš„åœ°å€ã€‚é€šå¸¸æ˜¯ä¸€ä¸ªå…ƒç»„(ipaddr,port)</td></tr><tr><td align="left">s.setsockopt(level,optname,value)</td><td align="left">è®¾ç½®ç»™å®šå¥—æ¥å­—é€‰é¡¹çš„å€¼ã€‚</td></tr><tr><td align="left">s.getsockopt(level,optname[.buflen])</td><td align="left">è¿”å›å¥—æ¥å­—é€‰é¡¹çš„å€¼ã€‚</td></tr><tr><td align="left">s.settimeout(timeout)</td><td align="left">è®¾ç½®å¥—æ¥å­—æ“ä½œçš„è¶…æ—¶æœŸï¼Œtimeoutæ˜¯ä¸€ä¸ªæµ®ç‚¹æ•°ï¼Œå•ä½æ˜¯ç§’ã€‚å€¼ä¸ºNoneè¡¨ç¤ºæ²¡æœ‰è¶…æ—¶æœŸã€‚ä¸€èˆ¬ï¼Œè¶…æ—¶æœŸåº”è¯¥åœ¨åˆšåˆ›å»ºå¥—æ¥å­—æ—¶è®¾ç½®ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½ç”¨äºè¿æ¥çš„æ“ä½œï¼ˆå¦‚connect()ï¼‰</td></tr><tr><td align="left">s.gettimeout()</td><td align="left">è¿”å›å½“å‰è¶…æ—¶æœŸçš„å€¼ï¼Œå•ä½æ˜¯ç§’ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®è¶…æ—¶æœŸï¼Œåˆ™è¿”å›Noneã€‚</td></tr><tr><td align="left">s.fileno()</td><td align="left">è¿”å›å¥—æ¥å­—çš„æ–‡ä»¶æè¿°ç¬¦ã€‚</td></tr><tr><td align="left">s.setblocking(flag)</td><td align="left">å¦‚æœflagä¸º0ï¼Œåˆ™å°†å¥—æ¥å­—è®¾ä¸ºéé˜»å¡æ¨¡å¼ï¼Œå¦åˆ™å°†å¥—æ¥å­—è®¾ä¸ºé˜»å¡æ¨¡å¼ï¼ˆé»˜è®¤å€¼ï¼‰ã€‚éé˜»å¡æ¨¡å¼ä¸‹ï¼Œå¦‚æœè°ƒç”¨recv()æ²¡æœ‰å‘ç°ä»»ä½•æ•°æ®ï¼Œæˆ–send()è°ƒç”¨æ— æ³•ç«‹å³å‘é€æ•°æ®ï¼Œé‚£ä¹ˆå°†å¼•èµ·socket.errorå¼‚å¸¸ã€‚</td></tr><tr><td align="left">s.makefile()</td><td align="left">åˆ›å»ºä¸€ä¸ªä¸è¯¥å¥—æ¥å­—ç›¸å…³è¿çš„æ–‡ä»¶</td></tr></tbody></table><ul><li><p>æ³¨æ„äº‹é¡¹ï¼š</p><ol><li><p>Python3ä»¥åï¼Œsocketä¼ é€’çš„éƒ½æ˜¯bytesç±»å‹çš„æ•°æ®ï¼Œå­—ç¬¦ä¸²éœ€è¦å…ˆè½¬æ¢ä¸€ä¸‹ï¼Œstring.encode()å³å¯ï¼›å¦ä¸€ç«¯æ¥æ”¶åˆ°çš„bytesæ•°æ®æƒ³è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œåªè¦bytes.decode()ä¸€ä¸‹å°±å¯ä»¥ã€‚</p></li><li><p>åœ¨æ­£å¸¸é€šä¿¡æ—¶ï¼Œaccept()å’Œrecv()æ–¹æ³•éƒ½æ˜¯é˜»å¡çš„ã€‚æ‰€è°“çš„é˜»å¡ï¼ŒæŒ‡çš„æ˜¯ç¨‹åºä¼šæš‚åœåœ¨é‚£ï¼Œä¸€ç›´ç­‰åˆ°æœ‰æ•°æ®è¿‡æ¥ã€‚</p></li></ol></li></ul><h2 id="socketç¼–ç¨‹æ€è·¯ï¼š"><a href="#socketç¼–ç¨‹æ€è·¯ï¼š" class="headerlink" title="socketç¼–ç¨‹æ€è·¯ï¼š"></a>socketç¼–ç¨‹æ€è·¯ï¼š</h2><p><strong>æœåŠ¡ç«¯ï¼š</strong></p><ol><li>åˆ›å»ºå¥—æ¥å­—ï¼Œç»‘å®šå¥—æ¥å­—åˆ°æœ¬åœ°IPä¸ç«¯å£ï¼šsocket.socket(socket.AF_INET,socket.SOCK_STREAM) , s.bind()</li><li>å¼€å§‹ç›‘å¬è¿æ¥ï¼šs.listen()</li><li>è¿›å…¥å¾ªç¯ï¼Œä¸æ–­æ¥å—å®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚ï¼šs.accept()</li><li>æ¥æ”¶ä¼ æ¥çš„æ•°æ®ï¼Œæˆ–è€…å‘é€æ•°æ®ç»™å¯¹æ–¹ï¼šs.recv() , s.sendall()</li><li>ä¼ è¾“å®Œæ¯•åï¼Œå…³é—­å¥—æ¥å­—ï¼šs.close()</li></ol><p><strong>å®¢æˆ·ç«¯:</strong></p><ol><li>åˆ›å»ºå¥—æ¥å­—ï¼Œè¿æ¥æœåŠ¡å™¨åœ°å€ï¼šsocket.socket(socket.AF_INET,socket.SOCK_STREAM) , s.connect()</li><li>è¿æ¥åå‘é€æ•°æ®å’Œæ¥æ”¶æ•°æ®ï¼šs.sendall(), s.recv()</li><li>ä¼ è¾“å®Œæ¯•åï¼Œå…³é—­å¥—æ¥å­—ï¼šs.close()</li></ol><p>Pythonçš„socketç¼–ç¨‹ï¼Œé€šå¸¸å¯åˆ†ä¸ºTCPå’ŒUDPç¼–ç¨‹ä¸¤ç§ï¼Œå‰è€…æ˜¯å¸¦è¿æ¥çš„å¯é ä¼ è¾“æœåŠ¡ï¼Œæ¯æ¬¡é€šä¿¡éƒ½è¦æ¡æ‰‹ï¼Œç»“æŸä¼ è¾“ä¹Ÿè¦æŒ¥æ‰‹ï¼Œæ•°æ®ä¼šè¢«æ£€éªŒï¼Œæ˜¯ä½¿ç”¨æœ€å¹¿çš„é€šç”¨æ¨¡å¼ï¼›åè€…æ˜¯ä¸å¸¦è¿æ¥çš„ä¼ è¾“æœåŠ¡ï¼Œç®€å•ç²—æš´ï¼Œä¸åŠ æ§åˆ¶å’Œæ£€æŸ¥çš„ä¸€è‚¡è„‘å°†æ•°æ®å‘é€å‡ºå»çš„æ–¹å¼ï¼Œä½†æ˜¯ä¼ è¾“é€Ÿåº¦å¿«ï¼Œé€šå¸¸ç”¨äºå®‰å…¨å’Œå¯é ç­‰çº§ä¸é«˜çš„ä¸šåŠ¡åœºæ™¯ï¼Œæ¯”å¦‚æ–‡ä»¶ä¸‹è½½ã€‚</p><p>å…ˆéªŒçŸ¥è¯†å¼•å…¥è¿™ä¹ˆå¤šå®é™…ä¸Šå¯èƒ½ä½ è¿˜æ˜¯ä¸äº†è§£ï¼Œå®é™…ä¸Šè¿™äº›ä»¥ä¸Šçš„å†…å®¹å°±æ˜¯ä¸ºäº†åˆ›å»ºæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ç›¸äº’è”ç³»é€šä¿¡ç”¨çš„ï¼Œæˆ‘ä»¬ä»¥ä¸€äº›ä¾‹å­æ¥çœŸæ­£å­¦ä¹ ä¸€ä¸‹socket:</p><h2 id="å®ä¾‹1"><a href="#å®ä¾‹1" class="headerlink" title="å®ä¾‹1"></a>å®ä¾‹1</h2><p>åˆ›å»ºä¸¤ä¸ª.pyæ–‡ä»¶ï¼Œç”¨æ¥åˆ†åˆ«åˆ›å»ºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ï¼š</p><h3 id="æœåŠ¡ç«¯"><a href="#æœåŠ¡ç«¯" class="headerlink" title="æœåŠ¡ç«¯"></a>æœåŠ¡ç«¯</h3><p>æˆ‘ä»¬ä½¿ç”¨ socket æ¨¡å—çš„ <strong>socket</strong> å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ª socket å¯¹è±¡ã€‚socket å¯¹è±¡å¯ä»¥é€šè¿‡è°ƒç”¨å…¶ä»–å‡½æ•°æ¥è®¾ç½®ä¸€ä¸ª socket æœåŠ¡ã€‚</p><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨ <strong>bind(hostname, port)</strong> å‡½æ•°æ¥æŒ‡å®šæœåŠ¡çš„ <em>port(ç«¯å£)</em>ã€‚</p><p>æ¥ç€ï¼Œæˆ‘ä»¬è°ƒç”¨ socket å¯¹è±¡çš„ <em>accept</em> æ–¹æ³•ã€‚è¯¥æ–¹æ³•ç­‰å¾…å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œå¹¶è¿”å› <em>connection</em> å¯¹è±¡ï¼Œè¡¨ç¤ºå·²è¿æ¥åˆ°å®¢æˆ·ç«¯ã€‚</p><p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/python</span><span class="token comment" spellcheck="true"># -*- coding: UTF-8 -*-</span><span class="token comment" spellcheck="true"># æ–‡ä»¶åï¼šserver.py</span><span class="token keyword">import</span> socket  <span class="token comment" spellcheck="true"># å¯¼å…¥ç›¸å…³åº“</span>s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># åˆ›å»ºsocketå¯¹è±¡</span>host <span class="token operator">=</span> socket<span class="token punctuation">.</span>gethostname<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># è·å–æœ¬åœ°ä¸»æœºå</span>port <span class="token operator">=</span> <span class="token number">12345</span> <span class="token comment" spellcheck="true"># è®¾ç½®ç«¯å£</span>s<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> hostname<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># å°†æœ¬åœ°ä¸»æœºä¸ç«¯å£è¿æ¥èµ·æ¥</span>s<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># ç­‰å¾…å®¢æˆ·ç«¯çš„è¿æ¥</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    c<span class="token punctuation">,</span> addr <span class="token operator">=</span> s<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># å»ºç«‹å®¢æˆ·ç«¯è¿æ¥</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è®¿é—®åœ°å€ï¼š"</span><span class="token punctuation">,</span> addr<span class="token punctuation">)</span>    c<span class="token punctuation">.</span>send<span class="token punctuation">(</span>b<span class="token string">"welcome!"</span><span class="token punctuation">)</span>    c<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™äº›æ³¨é‡Šå†™å¾—è¿˜æ˜¯æ¯”è¾ƒæ¸…æ™°çš„ï¼Œå½“ç„¶è¿™åªæ˜¯server.pyä¸­çš„ï¼Œä»…ä»…æ˜¯å°†æœåŠ¡ç«¯è¿™ä¸€å—å„¿é…ç½®å¥½äº†ã€‚æˆ‘ä»¬æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹clientå®¢æˆ·ç«¯çš„ä»£ç ï¼š</p><h3 id="å®¢æˆ·ç«¯"><a href="#å®¢æˆ·ç«¯" class="headerlink" title="å®¢æˆ·ç«¯"></a>å®¢æˆ·ç«¯</h3><p>æ¥ä¸‹æ¥æˆ‘ä»¬å†™ä¸€ä¸ªç®€å•çš„å®¢æˆ·ç«¯å®ä¾‹è¿æ¥åˆ°ä»¥ä¸Šåˆ›å»ºçš„æœåŠ¡ã€‚ç«¯å£å·ä¸º 12345ã€‚</p><p><strong>socket.connect(hosname, port )</strong> æ–¹æ³•æ‰“å¼€ä¸€ä¸ª TCP è¿æ¥åˆ°ä¸»æœºä¸º <em>hostname</em> ç«¯å£ä¸º <em>port</em> çš„æœåŠ¡å•†ã€‚è¿æ¥åæˆ‘ä»¬å°±å¯ä»¥ä»æœåŠ¡ç«¯è·å–æ•°æ®ï¼Œè®°ä½ï¼Œæ“ä½œå®Œæˆåéœ€è¦å…³é—­è¿æ¥ã€‚</p><p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/python</span><span class="token comment" spellcheck="true"># -*- coding: UTF-8 -*-</span><span class="token comment" spellcheck="true"># æ–‡ä»¶åï¼šclient.py</span><span class="token keyword">import</span> socket  <span class="token comment" spellcheck="true"># å¯¼å…¥æ¨¡å—</span>s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># åˆ›å»ºç›¸å…³å¯¹è±¡</span>host <span class="token operator">=</span> socket<span class="token punctuation">.</span>getname<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#  è·å¾—ä¸»æœºå</span>port <span class="token operator">=</span> <span class="token number">12345</span> <span class="token comment" spellcheck="true"># è®¾ç½®ç«¯å£</span>socket<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># å…³é—­è¿æ¥ã€‚</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç°åœ¨æˆ‘ä»¬æ‰“å¼€ä¸¤ä¸ªç»ˆç«¯ï¼Œç¬¬ä¸€ä¸ªç»ˆç«¯æ‰§è¡Œ server.py æ–‡ä»¶ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">$ python server.py<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¬¬äºŒä¸ªç»ˆç«¯æ‰§è¡Œ client.py æ–‡ä»¶ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">$ python client.py welcome!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¿™æ—¶æˆ‘ä»¬å†æ‰“å¼€ç¬¬ä¸€ä¸ªç»ˆç«¯ï¼Œå°±ä¼šçœ‹åˆ°æœ‰ä»¥ä¸‹ä¿¡æ¯è¾“å‡ºï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">è¿æ¥åœ°å€ï¼š ('10.21.190.181', 7773)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å½“ç„¶ä»¥ä¸Šè¿˜æ˜¯å¤ªç®€å•äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­å‚è€ƒå®˜ç½‘<a href="https://docs.python.org/zh-cn/3/howto/sockets.html" target="_blank" rel="noopener">Python Socket Library and Modules</a>ï¼Œå®é™…ä¸Šå°±æ˜¯æˆ‘ä»¬ä¸Šé¢çš„ç½‘å€ã€‚</p><p>æˆ‘ä»¬æ¥ä¸‹æ¥å†çœ‹ä¸€äº›æ›´å¤æ‚ä¸€äº›çš„ä»£ç ï¼š</p><h2 id="å®ä¾‹äºŒ"><a href="#å®ä¾‹äºŒ" class="headerlink" title="å®ä¾‹äºŒ"></a>å®ä¾‹äºŒ</h2><h3 id="å®¢æˆ·ç«¯-1"><a href="#å®¢æˆ·ç«¯-1" class="headerlink" title="å®¢æˆ·ç«¯"></a>å®¢æˆ·ç«¯</h3><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token comment" spellcheck="true"># -*- coding:utf-8 -*-</span><span class="token keyword">import</span> socketip_port <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> <span class="token number">9999</span><span class="token punctuation">)</span>sk <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># åˆ›å»ºå¥—æ¥å­—</span>sk<span class="token punctuation">.</span>bind<span class="token punctuation">(</span>ip_port<span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># ç»‘å®šæœåŠ¡åœ°å€</span>sk<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>                    <span class="token comment" spellcheck="true"># ç›‘å¬è¿æ¥è¯·æ±‚</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'å¯åŠ¨socketæœåŠ¡ï¼Œç­‰å¾…å®¢æˆ·ç«¯è¿æ¥...'</span><span class="token punctuation">)</span>conn<span class="token punctuation">,</span> address <span class="token operator">=</span> sk<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token comment" spellcheck="true"># ç­‰å¾…è¿æ¥ï¼Œæ­¤å¤„è‡ªåŠ¨é˜»å¡,å¦å¤–è¯·æ³¨æ„è¿™é‡Œæ”¾ç½®çš„ä½ç½®å’Œä¸Šæ–‡å®ä¾‹1çš„åŒºåˆ«ï¼Œå½“ç„¶è¿˜æœ‰close()çš„ä½ç½®ä¹Ÿæœ‰åŒºåˆ«ã€‚</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>     <span class="token comment" spellcheck="true"># ä¸€ä¸ªæ­»å¾ªç¯ï¼Œç›´åˆ°å®¢æˆ·ç«¯å‘é€â€˜exitâ€™çš„ä¿¡å·ï¼Œæ‰å…³é—­è¿æ¥</span>    client_data <span class="token operator">=</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token comment" spellcheck="true"># æ¥æ”¶ä¿¡æ¯</span>    <span class="token keyword">if</span> client_data <span class="token operator">==</span> <span class="token string">"exit"</span><span class="token punctuation">:</span>       <span class="token comment" spellcheck="true"># åˆ¤æ–­æ˜¯å¦é€€å‡ºè¿æ¥</span>        exit<span class="token punctuation">(</span><span class="token string">"é€šä¿¡ç»“æŸ"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æ¥è‡ª%sçš„å®¢æˆ·ç«¯å‘ä½ å‘æ¥ä¿¡æ¯ï¼š%s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>address<span class="token punctuation">,</span> client_data<span class="token punctuation">)</span><span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span><span class="token string">'æœåŠ¡å™¨å·²ç»æ”¶åˆ°ä½ çš„ä¿¡æ¯'</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># å›é¦ˆä¿¡æ¯ç»™å®¢æˆ·ç«¯</span>conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># å…³é—­è¿æ¥</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å®¢æˆ·ç«¯-2"><a href="#å®¢æˆ·ç«¯-2" class="headerlink" title="å®¢æˆ·ç«¯"></a>å®¢æˆ·ç«¯</h3><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token comment" spellcheck="true"># -*- coding:utf-8 -*-</span><span class="token keyword">import</span> socketip_port <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> <span class="token number">9999</span><span class="token punctuation">)</span>s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token comment" spellcheck="true"># åˆ›å»ºå¥—æ¥å­—</span>s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>ip_port<span class="token punctuation">)</span>      <span class="token comment" spellcheck="true"># è¿æ¥æœåŠ¡å™¨</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>     <span class="token comment" spellcheck="true"># é€šè¿‡ä¸€ä¸ªæ­»å¾ªç¯ä¸æ–­æ¥æ”¶ç”¨æˆ·è¾“å…¥ï¼Œå¹¶å‘é€ç»™æœåŠ¡å™¨</span>    inp <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">"è¯·è¾“å…¥è¦å‘é€çš„ä¿¡æ¯ï¼š "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token operator">not</span> inp<span class="token punctuation">:</span>     <span class="token comment" spellcheck="true"># é˜²æ­¢è¾“å…¥ç©ºä¿¡æ¯ï¼Œå¯¼è‡´å¼‚å¸¸é€€å‡º</span>        <span class="token keyword">continue</span>    s<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>inp<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> inp <span class="token operator">==</span> <span class="token string">"exit"</span><span class="token punctuation">:</span>   <span class="token comment" spellcheck="true"># å¦‚æœè¾“å…¥çš„æ˜¯â€˜exitâ€™ï¼Œè¡¨ç¤ºæ–­å¼€è¿æ¥</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç»“æŸé€šä¿¡ï¼"</span><span class="token punctuation">)</span>        <span class="token keyword">break</span>    server_reply <span class="token operator">=</span> s<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>server_reply<span class="token punctuation">)</span>s<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>       <span class="token comment" spellcheck="true"># å…³é—­è¿æ¥</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„æˆ‘ä»¬å®ä¾‹äºŒä¸­è¿˜å¯ä»¥å¯¹æˆ‘ä»¬çš„æœåŠ¡ç«¯å‘é€ä¿¡æ¯ï¼Œå’ŒæœåŠ¡ç«¯äº¤äº’ï¼Œè¿™ä¸ªæ˜¯éå¸¸äº†ä¸èµ·çš„ã€‚æˆ‘ä»¬éœ€è¦ä»”ç»†ç ”ç©¶ä¸€ä¸‹å®ä¾‹1ã€2ä¹‹é—´ä»£ç çš„å¾®å°çš„åŒºåˆ«å’Œè”ç³»ã€‚</p><p><em>æ³¨æ„ï¼šä»¥ä¸Šå‡ä¸ºTCPç¼–ç¨‹ï¼Œæˆ‘ä»¬é™¤äº†è¿™ç§å¤–ï¼Œè¿˜æœ‰UDPç¼–ç¨‹ï¼Œç›¸å¯¹è€Œè¨€UDPç»“æ„ç®€å•ä¸€äº›ï¼ŒTCPä¿è¯æ•°æ®æ­£ç¡®æ€§å’Œæ•°æ®é¡ºåºï¼Œä½†æ˜¯UDPå¹¶ä¸ä¿è¯æ•°æ®æ­£ç¡®æ€§ï¼ˆå¯èƒ½ä¸¢åŒ…ï¼‰å’Œä¸ä¿è¯é¡ºåº</em><br>æƒ³è¦äº†è§£æ›´å¤šï¼Œå¯ä»¥çœ‹ä¸€äº›ç›¸å…³Blog:</p><ul><li><a href="https://www.cnblogs.com/Anker/p/6210840.html" target="_blank" rel="noopener">https://www.cnblogs.com/Anker/p/6210840.html</a></li><li><a href="https://blog.csdn.net/weixin_38055381/article/details/80135363" target="_blank" rel="noopener">https://blog.csdn.net/weixin_38055381/article/details/80135363</a></li><li><a href="https://blog.csdn.net/yangshiziping/article/details/52750011" target="_blank" rel="noopener">https://blog.csdn.net/yangshiziping/article/details/52750011</a></li><li><a href="https://zhuanlan.zhihu.com/p/150203096" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/150203096</a></li></ul><p>æ›´å¤šçš„è¿˜æœ‰è®¸å¤šå¸¸ç”¨çš„Internetæ¨¡å—ï¼š</p><h2 id="Python-Internet-æ¨¡å—"><a href="#Python-Internet-æ¨¡å—" class="headerlink" title="Python Internet æ¨¡å—"></a>Python Internet æ¨¡å—</h2><p>ä»¥ä¸‹åˆ—å‡ºäº† Python ç½‘ç»œç¼–ç¨‹çš„ä¸€äº›é‡è¦æ¨¡å—ï¼š</p><table><thead><tr><th align="left">åè®®</th><th align="left">åŠŸèƒ½ç”¨å¤„</th><th align="left">ç«¯å£å·</th><th align="left">Python æ¨¡å—</th></tr></thead><tbody><tr><td align="left">HTTP</td><td align="left">ç½‘é¡µè®¿é—®</td><td align="left">80</td><td align="left">httplib, urllib, xmlrpclib</td></tr><tr><td align="left">NNTP</td><td align="left">é˜…è¯»å’Œå¼ è´´æ–°é—»æ–‡ç« ï¼Œä¿—ç§°ä¸ºâ€å¸–å­â€</td><td align="left">119</td><td align="left">nntplib</td></tr><tr><td align="left">FTP</td><td align="left">æ–‡ä»¶ä¼ è¾“</td><td align="left">20</td><td align="left">ftplib, urllib</td></tr><tr><td align="left">SMTP</td><td align="left">å‘é€é‚®ä»¶</td><td align="left">25</td><td align="left">smtplib</td></tr><tr><td align="left">POP3</td><td align="left">æ¥æ”¶é‚®ä»¶</td><td align="left">110</td><td align="left">poplib</td></tr><tr><td align="left">IMAP4</td><td align="left">è·å–é‚®ä»¶</td><td align="left">143</td><td align="left">imaplib</td></tr><tr><td align="left">Telnet</td><td align="left">å‘½ä»¤è¡Œ</td><td align="left">23</td><td align="left">telnetlib</td></tr><tr><td align="left">Gopher</td><td align="left">ä¿¡æ¯æŸ¥æ‰¾</td><td align="left">70</td><td align="left">gopherlib, urllib</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++ç¬”è®°(ç»§æ‰¿ä¸æ„é€ )</title>
      <link href="/2021/11/05/c-bi-ji-ji-cheng-yu-gou-zao/"/>
      <url>/2021/11/05/c-bi-ji-ji-cheng-yu-gou-zao/</url>
      
        <content type="html"><![CDATA[<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul><li>åä¸­ç§‘æŠ€å¤§å­¦é‡‘è‰¯æµ·æ•™æˆPPT</li><li>C++11ç»§æ‰¿æ„é€ å‡½æ•°ï¼š<a href="https://www.runoob.com/w3cnote/cpp11-inheritance-constructor.html" target="_blank" rel="noopener">https://www.runoob.com/w3cnote/cpp11-inheritance-constructor.html</a></li><li>C++ç»§æ‰¿ï¼š<a href="https://www.runoob.com/cplusplus/cpp-inheritance.html" target="_blank" rel="noopener">https://www.runoob.com/cplusplus/cpp-inheritance.html</a></li></ul><h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>æœ¬åšå®¢ä¸»è¦ä»‹ç»æœ‰å…³C++ç»§æ‰¿ä¸æ„é€ çš„ä¸€äº›çŸ¥è¯†ç‚¹ã€‚</p><h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><p>é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ä¸­æœ€é‡è¦çš„ä¸€ä¸ªæ¦‚å¿µæ˜¯ç»§æ‰¿ã€‚ç»§æ‰¿å…è®¸æˆ‘ä»¬ä¾æ®å¦ä¸€ä¸ªç±»æ¥å®šä¹‰ä¸€ä¸ªç±»ï¼Œè¿™ä½¿å¾—åˆ›å»ºå’Œç»´æŠ¤ä¸€ä¸ªåº”ç”¨ç¨‹åºå˜å¾—æ›´å®¹æ˜“ã€‚è¿™æ ·åšï¼Œä¹Ÿè¾¾åˆ°äº†é‡ç”¨ä»£ç åŠŸèƒ½å’Œæé«˜æ‰§è¡Œæ•ˆç‡çš„æ•ˆæœã€‚</p><p>å½“åˆ›å»ºä¸€ä¸ªç±»æ—¶ï¼Œæ‚¨ä¸éœ€è¦é‡æ–°ç¼–å†™æ–°çš„æ•°æ®æˆå‘˜å’Œæˆå‘˜å‡½æ•°ï¼Œåªéœ€æŒ‡å®šæ–°å»ºçš„ç±»ç»§æ‰¿äº†ä¸€ä¸ªå·²æœ‰çš„ç±»çš„æˆå‘˜å³å¯ã€‚è¿™ä¸ªå·²æœ‰çš„ç±»ç§°ä¸º<strong>åŸºç±»</strong>ï¼Œæ–°å»ºçš„ç±»ç§°ä¸º<strong>æ´¾ç”Ÿç±»</strong>ã€‚</p><p>ç»§æ‰¿ä»£è¡¨äº† <strong>is a</strong> å…³ç³»ã€‚ä¾‹å¦‚ï¼Œå“ºä¹³åŠ¨ç‰©æ˜¯åŠ¨ç‰©ï¼Œç‹—æ˜¯å“ºä¹³åŠ¨ç‰©ï¼Œå› æ­¤ï¼Œç‹—æ˜¯åŠ¨ç‰©ï¼Œç­‰ç­‰ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.runoob.com/wp-content/uploads/2015/05/cpp-inheritance-2020-12-15-1.png" alt="å›¾æºèœé¸Ÿæ•™ç¨‹"></p><p>ç›¸å…³ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">// åŸºç±»class Animal {    // eat() å‡½æ•°    // sleep() å‡½æ•°};//æ´¾ç”Ÿç±»class Dog : public Animal {    // bark() å‡½æ•°};<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸€ä¸ªç±»å¯ä»¥æ´¾ç”Ÿè‡ªå¤šä¸ªç±»ï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥ä»å¤šä¸ªåŸºç±»ä¸­ç»§æ‰¿æ•°æ®ä¸å‡½æ•°ã€‚å®šä¹‰ä¸€ä¸ªæ´¾ç”Ÿç±»æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ª<strong>ç±»æ´¾ç”Ÿåˆ—è¡¨</strong>æ¥æŒ‡å®šåŸºç±»ã€‚ç±»æ´¾ç”Ÿåˆ—è¡¨ä»¥ä¸€ä¸ªæˆ–å¤šä¸ªåŸºç±»å‘½åï¼Œå½¢å¼å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">class derived-class: access-specifier base-class<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å…¶ä¸­è®¿é—®ä¿®é¥°ç¬¦æ˜¯<strong>publicã€protectedæˆ–privateå…¶ä¸­ä¸€ä¸ª</strong>ï¼Œbase-classæ˜¯ä¹‹å‰å®šä¹‰è¿‡çš„æŸä¸ªç±»çš„åç§°ã€‚å¦‚æœæœªä½¿ç”¨è®¿é—®ä¿®é¥°ç¬¦access-specifierï¼Œ<strong>åˆ™é»˜è®¤ä¸ºprivate</strong>.</p><p>å‡è®¾æœ‰ä¸€ä¸ªåŸºç±» <strong>Shape</strong>ï¼Œ<strong>Rectangle</strong> æ˜¯å®ƒçš„æ´¾ç”Ÿç±»ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">#include <iostream>using namespace std;// åŸºç±»class Shape {   public:      void setWidth(int w)      {         width = w;      }      void setHeight(int h)      {         height = h;      }   protected:      int width;      int height;};// æ´¾ç”Ÿç±»class Rectangle: public Shape{   public:      int getArea()      {          return (width * height);       }};int main(void){   Rectangle Rect;   Rect.setWidth(5);   Rect.setHeight(7);   // è¾“å‡ºå¯¹è±¡çš„é¢ç§¯   cout << "Total area: " << Rect.getArea() << endl;   return 0;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¼–è¯‘æ‰§è¡Œç»“æœä¸ºï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">Total area: 35<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="è®¿é—®æ§åˆ¶å’Œç»§æ‰¿"><a href="#è®¿é—®æ§åˆ¶å’Œç»§æ‰¿" class="headerlink" title="è®¿é—®æ§åˆ¶å’Œç»§æ‰¿"></a>è®¿é—®æ§åˆ¶å’Œç»§æ‰¿</h2><p>æ´¾ç”Ÿç±»å¯ä»¥è®¿é—®åŸºç±»ä¸­æ‰€æœ‰çš„éç§æœ‰æˆå‘˜ã€‚å› æ­¤åŸºç±»æˆå‘˜å¦‚æœä¸æƒ³è¢«æ´¾ç”Ÿç±»çš„æˆå‘˜å‡½æ•°è®¿é—®ï¼Œåˆ™åº”åœ¨åŸºç±»ä¸­å£°æ˜ä¸º privateã€‚</p><p>æˆ‘ä»¬å¯ä»¥æ ¹æ®è®¿é—®æƒé™æ€»ç»“å‡ºä¸åŒçš„è®¿é—®ç±»å‹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><table><thead><tr><th align="left">è®¿é—®</th><th align="left">public</th><th align="left">protected</th><th align="left">private</th></tr></thead><tbody><tr><td align="left">åŒä¸€ä¸ªç±»</td><td align="left">yes</td><td align="left">yes</td><td align="left">yes</td></tr><tr><td align="left">æ´¾ç”Ÿç±»</td><td align="left">yes</td><td align="left">yes</td><td align="left">no</td></tr><tr><td align="left">å¤–éƒ¨çš„ç±»</td><td align="left">yes</td><td align="left">no</td><td align="left">no</td></tr></tbody></table><p>ä¸€ä¸ªæ´¾ç”Ÿç±»ç»§æ‰¿äº†æ‰€æœ‰çš„åŸºç±»æ–¹æ³•ï¼Œä½†ä¸‹åˆ—æƒ…å†µé™¤å¤–ï¼š</p><ul><li>åŸºç±»çš„æ„é€ å‡½æ•°ã€ææ„å‡½æ•°å’Œæ‹·è´æ„é€ å‡½æ•°ã€‚</li><li>åŸºç±»çš„é‡è½½è¿ç®—ç¬¦ã€‚</li><li>åŸºç±»çš„å‹å…ƒå‡½æ•°ã€‚</li></ul><h2 id="ç»§æ‰¿ç±»å‹"><a href="#ç»§æ‰¿ç±»å‹" class="headerlink" title="ç»§æ‰¿ç±»å‹"></a>ç»§æ‰¿ç±»å‹</h2><p>å½“ä¸€ä¸ªç±»æ´¾ç”Ÿè‡ªåŸºç±»ï¼Œè¯¥åŸºç±»å¯ä»¥è¢«ç»§æ‰¿ä¸º <strong>publicã€protected</strong> æˆ– <strong>private</strong> å‡ ç§ç±»å‹ã€‚ç»§æ‰¿ç±»å‹æ˜¯é€šè¿‡ä¸Šé¢è®²è§£çš„è®¿é—®ä¿®é¥°ç¬¦ access-specifier æ¥æŒ‡å®šçš„ã€‚</p><p>æˆ‘ä»¬å‡ ä¹ä¸ä½¿ç”¨ <strong>protected</strong> æˆ– <strong>private</strong> ç»§æ‰¿ï¼Œé€šå¸¸ä½¿ç”¨ <strong>public</strong> ç»§æ‰¿ã€‚å½“ä½¿ç”¨ä¸åŒç±»å‹çš„ç»§æ‰¿æ—¶ï¼Œéµå¾ªä»¥ä¸‹å‡ ä¸ªè§„åˆ™ï¼š</p><ul><li><strong>å…¬æœ‰ç»§æ‰¿ï¼ˆpublicï¼‰ï¼š</strong>å½“ä¸€ä¸ªç±»æ´¾ç”Ÿè‡ª<strong>å…¬æœ‰</strong>åŸºç±»æ—¶ï¼ŒåŸºç±»çš„<strong>å…¬æœ‰</strong>æˆå‘˜ä¹Ÿæ˜¯æ´¾ç”Ÿç±»çš„<strong>å…¬æœ‰</strong>æˆå‘˜ï¼ŒåŸºç±»çš„<strong>ä¿æŠ¤</strong>æˆå‘˜ä¹Ÿæ˜¯æ´¾ç”Ÿç±»çš„<strong>ä¿æŠ¤</strong>æˆå‘˜ï¼ŒåŸºç±»çš„<strong>ç§æœ‰</strong>æˆå‘˜ä¸èƒ½ç›´æ¥è¢«æ´¾ç”Ÿç±»è®¿é—®ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡è°ƒç”¨åŸºç±»çš„<strong>å…¬æœ‰</strong>å’Œ<strong>ä¿æŠ¤</strong>æˆå‘˜æ¥è®¿é—®ã€‚</li><li><strong>ä¿æŠ¤ç»§æ‰¿ï¼ˆprotectedï¼‰ï¼š</strong> å½“ä¸€ä¸ªç±»æ´¾ç”Ÿè‡ª<strong>ä¿æŠ¤</strong>åŸºç±»æ—¶ï¼ŒåŸºç±»çš„<strong>å…¬æœ‰</strong>å’Œ<strong>ä¿æŠ¤</strong>æˆå‘˜å°†æˆä¸ºæ´¾ç”Ÿç±»çš„<strong>ä¿æŠ¤</strong>æˆå‘˜ã€‚</li><li><strong>ç§æœ‰ç»§æ‰¿ï¼ˆprivateï¼‰ï¼š</strong>å½“ä¸€ä¸ªç±»æ´¾ç”Ÿè‡ª<strong>ç§æœ‰</strong>åŸºç±»æ—¶ï¼ŒåŸºç±»çš„<strong>å…¬æœ‰</strong>å’Œ<strong>ä¿æŠ¤</strong>æˆå‘˜å°†æˆä¸ºæ´¾ç”Ÿç±»çš„<strong>ç§æœ‰</strong>æˆå‘˜ã€‚</li></ul><h2 id="å¤šç»§æ‰¿"><a href="#å¤šç»§æ‰¿" class="headerlink" title="å¤šç»§æ‰¿"></a>å¤šç»§æ‰¿</h2><p>å¤šç»§æ‰¿å³ä¸€ä¸ªå­ç±»å¯ä»¥æœ‰å¤šä¸ªçˆ¶ç±»ï¼Œå®ƒç»§æ‰¿äº†å¤šä¸ªçˆ¶ç±»çš„ç‰¹æ€§ã€‚</p><p>C++ ç±»å¯ä»¥ä»å¤šä¸ªç±»ç»§æ‰¿æˆå‘˜ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">class <æ´¾ç”Ÿç±»å>:<ç»§æ‰¿æ–¹å¼1><åŸºç±»å1>,<ç»§æ‰¿æ–¹å¼2><åŸºç±»å2>,â€¦{<æ´¾ç”Ÿç±»ç±»ä½“>};<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­ï¼Œè®¿é—®ä¿®é¥°ç¬¦ç»§æ‰¿æ–¹å¼æ˜¯ <strong>publicã€protected</strong> æˆ– <strong>private</strong> å…¶ä¸­çš„ä¸€ä¸ªï¼Œç”¨æ¥ä¿®é¥°æ¯ä¸ªåŸºç±»ï¼Œå„ä¸ªåŸºç±»ä¹‹é—´ç”¨é€—å·åˆ†éš”ï¼Œå¦‚ä¸Šæ‰€ç¤ºã€‚ç°åœ¨è®©æˆ‘ä»¬ä¸€èµ·çœ‹çœ‹ä¸‹é¢çš„å®ä¾‹ï¼š</p><h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><pre class="line-numbers language-c++"><code class="language-c++">#include <iostream>using namespace std;// åŸºç±» Shapeclass Shape {   public:      void setWidth(int w)      {         width = w;      }      void setHeight(int h)      {         height = h;      }   protected:      int width;      int height;};// åŸºç±» PaintCostclass PaintCost {   public:      int getCost(int area)      {         return area * 70;      }};// æ´¾ç”Ÿç±»class Rectangle: public Shape, public PaintCost{   public:      int getArea()      {          return (width * height);       }};int main(void){   Rectangle Rect;   int area;   Rect.setWidth(5);   Rect.setHeight(7);   area = Rect.getArea();   // è¾“å‡ºå¯¹è±¡çš„é¢ç§¯   cout << "Total area: " << Rect.getArea() << endl;   // è¾“å‡ºæ€»èŠ±è´¹   cout << "Total paint cost: $" << Rect.getCost(area) << endl;   return 0;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å½“ä¸Šé¢çš„ä»£ç è¢«ç¼–è¯‘å’Œæ‰§è¡Œæ—¶ï¼Œå®ƒä¼šäº§ç”Ÿä¸‹åˆ—ç»“æœï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">Total area: 35Total paint cost: $2450<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="Intro-1"><a href="#Intro-1" class="headerlink" title="Intro"></a>Intro</h2><ul><li><p>ç»§æ‰¿æ˜¯C++ç±»å‹æ¼”åŒ–çš„é‡è¦æœºåˆ¶ï¼Œåœ¨ä¿ç•™åŸæœ‰ç±»çš„å±æ€§å’Œè¡Œä¸ºçš„åŸºç¡€ä¸Šï¼Œæ´¾ç”Ÿå‡ºçš„æ–°ç±»å¯ä»¥æœ‰æŸç§ç¨‹åº¦çš„å˜å¼‚ã€‚</p></li><li><p>é€šè¿‡ç»§æ‰¿ï¼Œæ–°ç±»è‡ªåŠ¨å…·æœ‰äº†åŸæœ‰ç±»çš„å±æ€§å’Œè¡Œä¸ºï¼Œå› è€Œåªéœ€å®šä¹‰åŸæœ‰ç±»å‹æ²¡æœ‰çš„æ–°çš„æ•°æ®æˆå‘˜å’Œå‡½æ•°æˆå‘˜ã€‚å®ç°äº†è½¯ä»¶é‡ç”¨ï¼Œä½¿å¾—ç±»ä¹‹é—´å…·å¤‡äº†å±‚æ¬¡æ€§ã€‚</p></li><li><p>é€šè¿‡ç»§æ‰¿å’Œæ´¾ç”Ÿå½¢æˆçš„ç±»ç°‡ï¼Œåæ˜ äº†é¢å‘å¯¹è±¡é—®ï¼ˆä¸»ï¼‰é¢˜åŸŸã€ä¸»é¢˜ç­‰æ¦‚å¿µï¼Œå½¢æˆç±»ä¼¼Javaçš„åŒ…ã€‚</p></li><li><p>å•ç»§æ‰¿æ˜¯åªæœ‰ä¸€ä¸ªåŸºç±»çš„ç»§æ‰¿æ–¹å¼ã€‚</p></li></ul><ul><li><p>å¤šç»§æ‰¿çš„æ´¾ç”Ÿç±»æœ‰å¤šäºä¸€ä¸ªçš„åŸºç±»ï¼Œæ´¾ç”Ÿç±»å°†æ˜¯æ‰€æœ‰åŸºç±»è¡Œä¸ºçš„ç»„åˆã€‚</p></li><li><p>æ´¾ç”Ÿç±»ä¸åŸºç±»ï¼šæ¥å—æˆå‘˜çš„æ–°ç±»ç§°ä¸ºæ´¾ç”Ÿç±»ï¼Œå¦‚ä¾‹ä¸­çš„Pointç±»ï¼›æä¾›æˆå‘˜çš„ç±»ç§°ä¸ºåŸºç±»ï¼Œå¦‚ä¾‹ä¸­çš„Locationç±»ã€‚</p></li><li><p>åŸºç±»æ˜¯å¯¹è‹¥å¹²ä¸ªæ´¾ç”Ÿç±»çš„æŠ½è±¡ï¼Œæå–äº†æ´¾ç”Ÿç±»çš„å…¬å…±ç‰¹å¾ï¼›è€Œæ´¾ç”Ÿç±»æ˜¯åŸºç±»çš„å…·ä½“åŒ–ï¼Œé€šè¿‡å¢åŠ å±æ€§æˆ–è¡Œä¸ºå˜ä¸ºæ›´æœ‰ç”¨çš„ç±»å‹ã€‚</p></li><li><p>æ´¾ç”Ÿç±»å¯ä»¥çœ‹ä½œåŸºç±»å®šä¹‰çš„å»¶ç»­ï¼Œå…ˆå®šä¹‰ä¸€ä¸ªæŠ½è±¡ç¨‹åº¦è¾ƒé«˜çš„åŸºç±»ï¼Œè¯¥åŸºç±»ä¸­æœ‰äº›æ“ä½œå¹¶æœªå®ç°ï¼›ç„¶åå®šä¹‰æ›´ä¸ºå…·ä½“çš„æ´¾ç”Ÿç±»ï¼Œå®ç°æŠ½è±¡åŸºç±»ä¸­æœªå®ç°çš„æ“ä½œã€‚</p></li></ul><h2 id="è·å¾—æ–°çš„æ´¾ç”Ÿç±»"><a href="#è·å¾—æ–°çš„æ´¾ç”Ÿç±»" class="headerlink" title="è·å¾—æ–°çš„æ´¾ç”Ÿç±»"></a>è·å¾—æ–°çš„æ´¾ç”Ÿç±»</h2><ul><li><p>C++é€šè¿‡å¤šç§æ§åˆ¶æ´¾ç”Ÿçš„æ–¹æ³•è·å¾—æ–°çš„æ´¾ç”Ÿç±»ï¼Œå¯åœ¨å®šä¹‰æ´¾ç”Ÿç±»æ—¶ï¼š</p></li><li><p>æ·»åŠ æ–°çš„æ•°æ®æˆå‘˜å’Œå‡½æ•°æˆå‘˜ï¼›</p></li><li><p>ä¿®æ”¹ç»§æ‰¿æ¥çš„åŸºç±»æˆå‘˜çš„è®¿é—®æƒé™ï¼›</p></li><li><p>é‡æ–°å®šä¹‰åŒåçš„æ•°æ®å’Œå‡½æ•°æˆå‘˜ã€‚</p></li></ul><h1 id="å•ç»§æ‰¿"><a href="#å•ç»§æ‰¿" class="headerlink" title="å•ç»§æ‰¿"></a>å•ç»§æ‰¿</h1><h2 id="Reference-1"><a href="#Reference-1" class="headerlink" title="Reference"></a>Reference</h2><ul><li>ç»§æ‰¿å¸¸è§ç‰¹æ€§ï¼š<a href="https://segmentfault.com/a/1190000021460678" target="_blank" rel="noopener">https://segmentfault.com/a/1190000021460678</a></li><li>ç»§æ‰¿å’Œæ´¾ç”Ÿï¼š<a href="https://zhuanlan.zhihu.com/p/144603044" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/144603044</a></li></ul><p><em>åŸºæœ¬æ ¼å¼ä¸º:</em></p><p>å•ç»§æ‰¿çš„å®šä¹‰æ ¼å¼ï¼š</p><p>class &lt;æ´¾ç”Ÿç±»å&gt;:** &lt;ç»§æ‰¿æ–¹å¼&gt; &lt;åŸºç±»å&gt;</p><p>â€‹     {</p><p>ã€€ã€€ã€€ã€€&lt;<strong>æ´¾ç”Ÿç±»æ–°å®šä¹‰æˆå‘˜</strong>&gt;</p><p>ã€€ã€€ã€€ã€€&lt;<strong>æ´¾ç”Ÿç±»é‡å®šä¹‰åŸºç±»åŒåçš„æ•°æ®å’Œå‡½æ•°æˆå‘˜</strong>&gt;</p><p>ã€€ã€€ã€€ã€€&lt;<strong>æ´¾ç”Ÿç±»å£°æ˜ä¿®æ”¹åŸºç±»æˆå‘˜è®¿é—®æƒé™</strong>&gt;</p><p>â€‹     };</p><p>&lt;ç»§æ‰¿æ–¹å¼&gt;æŒ‡æ˜æ´¾ç”Ÿç±»é‡‡ç”¨ä»€ä¹ˆç»§æ‰¿æ–¹å¼ä»åŸºç±»è·å¾—æˆå‘˜ï¼Œåˆ†ä¸ºä¸‰ç§ï¼šprivateè¡¨ç¤ºç§æœ‰åŸºç±»ï¼›protectedè¡¨ç¤ºä¿æŠ¤åŸºç±»ï¼›publicè¡¨ç¤ºå…¬æœ‰åŸºç±»ã€‚ </p><ul><li>æ³¨æ„åŒºåˆ«ç»§æ‰¿æ–¹å¼å’Œè®¿é—®æƒé™ã€‚æ´¾ç”Ÿç±»å¯ä»¥è®¿é—®åŸºç±»é™¤äº†ç§æœ‰å¯¹è±¡çš„æ‰€æœ‰å¯¹è±¡ï¼Œè€Œç§æœ‰å¯¹è±¡å¯ä»¥é€šè¿‡ä¿æŠ¤æ–¹æ³•æˆ–è€…å…¬æœ‰æ–¹æ³•æ¥è¿›è¡Œè®¿é—®ã€‚è€Œè®¿é—®æƒé™åˆ™æ˜¯å®šä¹‰çš„æ´¾ç”Ÿç±»è‡ªå·±çš„å¯¹è±¡è®¿é—®æƒé™ã€‚</li><li>ä»¥ä¸Š3ä¸ªä¸»è¦çš„æ–¹é¢è¿˜æ˜¯å¾ˆé‡è¦çš„ï¼Œå…³äºæ´¾ç”Ÿç±»åˆ°åº•è¿›è¡Œäº†ä»€ä¹ˆç›¸å…³çš„å˜åŒ–<ul><li>ç¬¬ä¸€ä¸ªå¯èƒ½æ–°å¢äº†æ–°æˆå‘˜çš„å®šä¹‰</li><li>ç¬¬äºŒä¸ªä¾¿æ˜¯é‡å®šä¹‰ä¸åŸºç±»åŒåçš„æ•°æ®ä¸å‡½æ•°æˆå‘˜</li><li>ç¬¬ä¸‰ä¸ªæ˜¯å£°æ˜ä¿®æ”¹åŸºç±»æˆå‘˜è®¿é—®æƒé™ã€‚</li></ul></li></ul><p>æˆ‘ä»¬ç»“åˆä¾‹å­æ¥çœ‹ä¸€ä¸‹ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">#include <graphics.h>class LOCATION{ //å®šä¹‰å®šä½åæ ‡ç±»    int x, y;public:    int getx();    int gety();                //gety( )è·å¾—å½“å‰åæ ‡y    void moveto(int x, int y); //å®šä¹‰ç§»åŠ¨åæ ‡å‡½æ•°æˆå‘˜    LOCATION(int x, int y);    ~LOCATION();};void LOCATION::moveto(int x, int y){    LOCATION::x = x;    LOCATION::y = y;}int LOCATION::getx() { return x; }int LOCATION::gety() { return y; }LOCATION::LOCATION(int x, int y){    LOCATION::x = x;    LOCATION::y = y;}LOCATION::~LOCATION() {}class POINT : public LOCATION{    //å®šä¹‰ç‚¹ç±»ï¼Œä»LOCATIONç±»ç»§æ‰¿ï¼Œç»§æ‰¿æ–¹å¼ä¸ºpublic    int visible; //æ–°å¢å¯è§å±æ€§public:    int isvisible() { return visible; } //æ–°å¢å‡½æ•°æˆå‘˜    void show(), hide();    void moveto(int x, int y); //é‡æ–°å®šä¹‰ä¸åŸºç±»åŒåå‡½æ•°    POINT(int x, int y) : LOCATION(x, y) { visible = 0; }    //åœ¨æ„é€ æ´¾ç”Ÿç±»å¯¹è±¡å‰å…ˆæ„é€ åŸºç±»å¯¹è±¡    ~POINT() { hide(); }};void POINT::show(){    visible = 1;    putpixel(getx(), gety(), getcolor());}void POINT::hide(){    visible = 0;    putpixel(getx(), gety(), getbkcolor());}void POINT::moveto(int x, int y){    int v = isvisible();    if (v)        hide();    LOCATION::moveto(x, y); //ä¸èƒ½å»æ‰LOCATION::ï¼Œä¼šè‡ªé€’å½’    if (v)        show();}void main(void){    POINT p(3, 6);    p.LOCATION::moveto(7, 8); //è°ƒç”¨åŸºç±»movetoå‡½æ•°    p.moveto(9, 18);          //è°ƒç”¨æ´¾ç”Ÿç±»movetoå‡½æ•°}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å…³äºclassã€structã€unionè¯´æ˜"><a href="#å…³äºclassã€structã€unionè¯´æ˜" class="headerlink" title="å…³äºclassã€structã€unionè¯´æ˜"></a>å…³äºclassã€structã€unionè¯´æ˜</h2><ul><li>ç”¨classå£°æ˜çš„ç±»çš„ç»§æ‰¿æ–¹å¼ç¼ºçœä¸ºprivateï¼Œå£°æ˜class POINT:private LOCATIONç­‰ä»·äºå£°æ˜class POINT:LOCATION.</li><li>æ´¾ç”Ÿç±»ä¹Ÿå¯ä»¥ç”¨structå£°æ˜ï¼Œä¸åŒä¹‹å¤„åœ¨äºç”¨structå£°æ˜çš„ç»§æ‰¿æ–¹å¼å’Œè®¿é—®æƒé™ç¼ºçœä¸ºpublicã€‚</li><li><strong>ç”¨unionå£°æ˜çš„ç±»æ—¢ä¸èƒ½ä½œæ´¾ç”Ÿç±»çš„åŸºç±»ï¼Œä¹Ÿä¸èƒ½åšä»»ä½•åŸºç±»çš„æ´¾ç”Ÿç±»</strong></li></ul><h2 id="ç»§æ‰¿æ–¹å¼"><a href="#ç»§æ‰¿æ–¹å¼" class="headerlink" title="ç»§æ‰¿æ–¹å¼"></a>ç»§æ‰¿æ–¹å¼</h2><ul><li>å½“åŸºç±»æˆå‘˜è¢«ç»§æ‰¿åˆ°æ´¾ç”Ÿç±»æ—¶ï¼Œè¯¥æˆå‘˜åœ¨æ´¾ç”Ÿç±»çš„è®¿é—®æƒé™ç”±ç»§æ‰¿æ–¹å¼å†³å®šã€‚è¿™å°±æ˜¯æˆ‘ä»¬ä¹‹å‰è¯´çš„ï¼Œå‚è§prefaceä¸­çš„è¯´æ˜ï¼Œä»¥ä¸‹é‡å¤è¯´æ˜ä¸€éï¼š<br>å½“ä¸€ä¸ªç±»æ´¾ç”Ÿè‡ªåŸºç±»ï¼Œè¯¥åŸºç±»å¯ä»¥è¢«ç»§æ‰¿ä¸º <strong>publicã€protected</strong> æˆ– <strong>private</strong> å‡ ç§ç±»å‹ã€‚ç»§æ‰¿ç±»å‹æ˜¯é€šè¿‡ä¸Šé¢è®²è§£çš„è®¿é—®ä¿®é¥°ç¬¦ access-specifier æ¥æŒ‡å®šçš„ã€‚<br>æˆ‘ä»¬å‡ ä¹ä¸ä½¿ç”¨ <strong>protected</strong> æˆ– <strong>private</strong> ç»§æ‰¿ï¼Œé€šå¸¸ä½¿ç”¨ <strong>public</strong> ç»§æ‰¿ã€‚å½“ä½¿ç”¨ä¸åŒç±»å‹çš„ç»§æ‰¿æ—¶ï¼Œéµå¾ªä»¥ä¸‹å‡ ä¸ªè§„åˆ™ï¼š</li></ul><ul><li><strong>å…¬æœ‰ç»§æ‰¿ï¼ˆpublicï¼‰ï¼š</strong>å½“ä¸€ä¸ªç±»æ´¾ç”Ÿè‡ª<strong>å…¬æœ‰</strong>åŸºç±»æ—¶ï¼ŒåŸºç±»çš„<strong>å…¬æœ‰</strong>æˆå‘˜ä¹Ÿæ˜¯æ´¾ç”Ÿç±»çš„<strong>å…¬æœ‰</strong>æˆå‘˜ï¼ŒåŸºç±»çš„<strong>ä¿æŠ¤</strong>æˆå‘˜ä¹Ÿæ˜¯æ´¾ç”Ÿç±»çš„<strong>ä¿æŠ¤</strong>æˆå‘˜ï¼ŒåŸºç±»çš„<strong>ç§æœ‰</strong>æˆå‘˜ä¸èƒ½ç›´æ¥è¢«æ´¾ç”Ÿç±»è®¿é—®ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡è°ƒç”¨åŸºç±»çš„<strong>å…¬æœ‰</strong>å’Œ<strong>ä¿æŠ¤</strong>æˆå‘˜æ¥è®¿é—®ã€‚</li><li><strong>ä¿æŠ¤ç»§æ‰¿ï¼ˆprotectedï¼‰ï¼š</strong> å½“ä¸€ä¸ªç±»æ´¾ç”Ÿè‡ª<strong>ä¿æŠ¤</strong>åŸºç±»æ—¶ï¼ŒåŸºç±»çš„<strong>å…¬æœ‰</strong>å’Œ<strong>ä¿æŠ¤</strong>æˆå‘˜å°†æˆä¸ºæ´¾ç”Ÿç±»çš„<strong>ä¿æŠ¤</strong>æˆå‘˜ã€‚</li><li><strong>ç§æœ‰ç»§æ‰¿ï¼ˆprivateï¼‰ï¼š</strong>å½“ä¸€ä¸ªç±»æ´¾ç”Ÿè‡ª<strong>ç§æœ‰</strong>åŸºç±»æ—¶ï¼ŒåŸºç±»çš„<strong>å…¬æœ‰</strong>å’Œ<strong>ä¿æŠ¤</strong>æˆå‘˜å°†æˆä¸ºæ´¾ç”Ÿç±»çš„<strong>ç§æœ‰</strong>æˆå‘˜ã€‚</li></ul><ul><li>åŸºç±»çš„ç§æœ‰æˆå‘˜åŒæ ·ä¹Ÿè¢«ç»§æ‰¿åˆ°æ´¾ç”Ÿç±»ä¸­ï¼Œæ„æˆæ´¾ç”Ÿç±»çš„ä¸€éƒ¨åˆ†ï¼Œä½†å¯¹æ´¾ç”Ÿç±»å‡½æ•°æˆå‘˜ä¸å¯è§ï¼Œä¸èƒ½è¢«æ´¾ç”Ÿç±»å‡½æ•°æˆå‘˜è®¿é—®ã€‚<ul><li>è‹¥æ´¾ç”Ÿç±»å‡½æ•°æˆå‘˜è¦è®¿é—®åŸºç±»çš„ç§æœ‰æˆå‘˜ï¼Œåˆ™å¿…é¡»å°†å…¶å£°æ˜ä¸ºåŸºç±»çš„æˆå‘˜å‹å…ƒã€‚ </li></ul></li><li>åœ¨æ´¾ç”Ÿç±»å¤–éƒ¨ï¼Œå¯¹å…¶æˆå‘˜è®¿é—®çš„æƒé™ï¼š<ul><li>å¯¹äºæ–°å®šä¹‰æˆå‘˜ï¼ŒæŒ‰å®šä¹‰æ—¶çš„è®¿é—®æƒé™è®¿é—®ï¼›</li><li>å¯¹äºç»§æ‰¿æ¥çš„åŸºç±»æˆå‘˜ï¼Œ<strong>å–å†³äºè¿™äº›æˆå‘˜åœ¨æ´¾ç”Ÿç±»ä¸­çš„è®¿é—®æƒé™ï¼Œä¸å…¶åœ¨åŸºç±»ä¸­å®šä¹‰çš„è®¿é—®æƒé™æ— å…³ã€‚</strong></li></ul></li></ul><p><em>å†é‡å¤ä¸€éï¼šç»§æ‰¿æ¥çš„åŸºç±»ç§æœ‰æˆå‘˜ä¸å¯è¢«æ´¾ç”Ÿç±»çš„å‡½æ•°è®¿é—®ï¼Œé™¤éæˆ‘ä»¬åœ¨åŸºç±»å°†å‡½æ•°å®šä¹‰ä¸ºå‹å…ƒ</em></p><p>è¿™é‡Œæˆ‘ä»¬è¿›ä¸€æ­¥çœ‹ä¸€ä¸‹ä¸åŒç»§æ‰¿æ–¹å¼å¸¦æ¥çš„ä¸€äº›åŒºåˆ«,ä»ç„¶ä»¥åˆšæ‰çš„ä¾‹å­ç‚¹ç±»ä¸ºä¾‹ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">// é¦–å…ˆæ˜¯åŸºç±»æˆå‘˜ï¼šprivateæˆå‘˜:int x, y;publicæˆå‘˜:int getx();int gety();void moveto( );LOCATION( );~LOCATION( );<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-c++"><code class="language-c++">æ´¾ç”Ÿç±»POINTæ–°å¢æˆå‘˜privateæˆå‘˜:int visible;publicæˆå‘˜:int isvisible( );void show( );void hide( );void moveto( );POINT( );~POINT( );<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é‚£ä¹ˆæˆ‘ä»¬å¦‚æœç»§æ‰¿æ–¹å¼ä¸ºpublic:</p><pre class="line-numbers language-c++"><code class="language-c++">// ç»§æ‰¿æ–¹å¼ä¸ºpublicæ—¶POINTå¯è®¿é—®çš„æˆå‘˜privateæˆå‘˜:int visible;publicæˆå‘˜:int isvisible( );void show( );void hide( );void moveto( );POINT( );~POINT( );int getx( );int gety( );void LOCATION::moveto( );LOCATION( );~LOCATION( );<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°æœ€ç»ˆåŸºç±»çš„publicæˆå‘˜å˜ä¸ºå­ç±»çš„publicæˆå‘˜ï¼Œè™½ç„¶çˆ¶ç±»çš„ç§æœ‰æˆå‘˜æ˜¯æ´¾ç”Ÿç±»çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯å´æ— æ³•è¢«æ´¾ç”Ÿç±»è®¿é—®ã€‚</p><ul><li><p><em>è‹¥ç±»POINTçš„ç»§æ‰¿æ–¹å¼ä¸ºpublicï¼ŒåŸºç±»å‡½æ•°getxã€getyæ´¾ç”Ÿåçš„è®¿é—®æƒé™ä»ä¸ºpublicï¼Œå¯¹ç±»POINTæ¥è¯´è¿™æ˜¯åˆç†çš„ï¼Œå› ä¸ºï¼Œå¯¹ç±»POINTæ¥è¯´åˆ™ç±»éœ€è¦è¿™æ ·çš„å‡½æ•°æˆå‘˜ï¼›</em></p></li><li><p>*åŒä¸Šï¼Œè‹¥ç±»POINTçš„ç»§æ‰¿æ–¹å¼ä¸ºpublicï¼ŒåŸºç±»å‡½æ•°æˆå‘˜movetoæ´¾ç”Ÿåçš„è®¿é—®æƒé™ä¸ºpublicï¼Œå¯¹ç±»POINTæ¥è¯´åˆ™æ˜¯ä¸åˆç†çš„ï¼Œå› ä¸ºç±»POINTè‡ªå·±å®šä¹‰äº†publicå‡½æ•°æˆå‘˜movetoã€‚åœ¨ç¬¬8é¡µä¸­ï¼Œä¸»å‡½æ•°è¿˜èƒ½è°ƒç”¨åŸºç±»å‡½æ•°LOCATION::movetoã€‚ *</p></li></ul><p>é‚£ä¹ˆæˆ‘ä»¬å†çœ‹å¦‚æœç»§æ‰¿æ–¹å¼å˜ä¸ºprivate:</p><pre class="line-numbers language-c++"><code class="language-c++">ç»§æ‰¿æ–¹å¼ä¸ºprivateæ—¶POINTå¯è®¿é—®çš„æˆå‘˜privateæˆå‘˜:int visible;int getx( );int gety( );void LOCATION::moveto( );LOCATION( );~LOCATION( );publicæˆå‘˜:int isvisible( );void show( );void hide( );void moveto( );POINT( );~POINT( );<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°åŸæ¥åŸºç±»ä¸ºpublicçš„æˆå‘˜å¦‚ä»Šåœ¨æ´¾ç”Ÿç±»å˜ä¸ºäº†privateç§æœ‰æˆå‘˜å¹¶ä¸”ä»ç„¶å¯ä»¥è¢«åŸºç±»æ‰€è®¿é—®ã€‚</p><p>æ¥ç€æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹å¦‚ä½•æ›´æ”¹æŸäº›æˆå‘˜çš„è®¿é—®æƒé™ï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬è™½ç„¶ç»§æ‰¿æ–¹å¼æ˜¯privateï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯æƒ³å°†ä¸€äº›åŸºç±»æˆå‘˜å˜æˆpublic:<br><strong>ç»§æ‰¿æ–¹å¼ä¸ºprivateæ—¶ï¼ŒåŸºç±»æˆå‘˜åœ¨æ´¾ç”Ÿç±»ä¸­çš„è®¿é—®æƒé™å˜ä¸ºprivateã€‚å¯ä»¥ä½¿ç”¨ â€œåŸºç±»å::æˆå‘˜â€æˆ–â€œusing åŸºç±»å::æˆå‘˜â€ ä¿®æ”¹æˆå‘˜çš„è®¿é—®æƒé™, æ´¾ç”Ÿç±»ä¸èƒ½å†å®šä¹‰åŒåçš„æˆå‘˜ã€‚</strong></p><pre class="line-numbers language-c++"><code class="language-c++">    class POINT: private LOCATION { //privateå¯çœç•¥        int visible;            public:        LOCATION::getx;    //ä¿®æ”¹æƒé™æˆpublic        LOCATION::gety;    //ä¿®æ”¹æƒé™æˆpublic        int isvisible( ) { return visible; }        void show( ), hide( );        void moveto(int x, int y);            POINT(int x,int y):LOCATION(x,y){ visible=0; }        ~POINT( ){ hide( ); }    };<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>*<em>è‹¥ LOCATION::getx æ˜¯åœ¨protected:å±æ€§ä¸‹é¢å®šä¹‰çš„ï¼Œåˆ™åŸºç±»çš„ getx çš„è®¿é—®æƒé™æ˜¯protected ã€‚ *</em></p><p>ç»è¿‡ä»¥ä¸Šæ›´æ”¹åï¼Œæˆ‘ä»¬çš„è®¿é—®æƒé™å°±å˜ä¸ºï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">// ä¿®æ”¹privateæ´¾ç”Ÿçš„åŸºç±»æˆå‘˜è®¿é—®æƒé™æ—¶privateæˆå‘˜:int visible;void LOCATION::moveto( );LOCATION( );~LOCATION( );publicæˆå‘˜:int isvisible( );void show( );void hide( );void moveto( );POINT( );~POINT( );int getx( );   //è§å‰é¡µPPTçš„å®šä¹‰int gety( );<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æˆå‘˜è®¿é—®"><a href="#æˆå‘˜è®¿é—®" class="headerlink" title="æˆå‘˜è®¿é—®"></a>æˆå‘˜è®¿é—®</h2><p><strong>åŸºç±»æˆå‘˜ç»è¿‡ç»§æ‰¿æ–¹å¼è¢«ç»§æ‰¿åˆ°æ´¾ç”Ÿç±»åï¼Œè¦æ³¨æ„è®¿é—®æƒé™çš„å˜åŒ–ã€‚<br>æŒ‰é¢å‘å¯¹è±¡çš„ä½œç”¨åŸŸï¼Œä¸åŸºç±»åŒåçš„æ´¾ç”Ÿç±»æˆå‘˜è¢«ä¼˜å…ˆè®¿é—®ã€‚</strong><br>æ´¾ç”Ÿç±»ä¸­æ”¹å†™åŸºç±»åŒåå‡½æ•°æ—¶ï¼Œè¦æ³¨æ„åŒºåˆ†è¿™äº›åŒåå‡½æ•°ï¼Œå¦åˆ™å¯èƒ½é€ æˆè‡ªé€’å½’è°ƒç”¨ã€‚</p><p>æ ‡è¯†ç¬¦çš„ä½œç”¨èŒƒå›´å¯åˆ†ä¸ºä»å°åˆ°å¤§å››ç§çº§åˆ«ï¼š<br>â‘ ä½œç”¨äºå‡½æ•°æˆå‘˜å†…ï¼›<br>â‘¡ä½œç”¨äºç±»æˆ–è€…æ´¾ç”Ÿç±»å†…ï¼›<br>â‘¢ä½œç”¨äºåŸºç±»å†…ï¼›<br>â‘£ä½œç”¨äºè™šåŸºç±»å†…ã€‚</p><ul><li>æ ‡è¯†ç¬¦çš„ä½œç”¨èŒƒå›´è¶Šå°ï¼Œè¢«è®¿é—®åˆ°çš„ä¼˜å…ˆçº§è¶Šé«˜ã€‚<strong>å¦‚æœå¸Œæœ›è®¿é—®ä½œç”¨èŒƒå›´æ›´å¤§çš„æ ‡è¯†ç¬¦ï¼Œåˆ™å¯ä»¥ç”¨ç±»åå’Œä½œç”¨åŸŸè¿ç®—ç¬¦è¿›è¡Œé™å®šã€‚</strong></li></ul><p>åŒæ ·ä»¥ä¸€ä¸ªä¾‹å­è§£æï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">class LIST{    struct NODE    { //å®šä¹‰èŠ‚ç‚¹ç±»        int val;        NODE *next;        NODE(int v, NODE *p)        {            val = v;            next = p;        }        ~NODE()        {            delete next;            next = 0;        }    } * head; //å®šä¹‰æ•°æ®æˆå‘˜,æƒé™ä¸ºprivate.public:    int insert(int), contains(int);    LIST() { head = 0; } //0è¡¨ç¤ºç©ºæŒ‡é’ˆ    ~LIST()    {        if (head)        {            delete head;            head = 0; //0è¡¨ç¤ºç©ºæŒ‡é’ˆ         }     }};int LIST::contains(int v){ //æœç´¢é“¾è¡¨ï¼ŒæŸ¥è¯¢æ˜¯å¦å­˜åœ¨è¯¥èŠ‚ç‚¹    NODE *h = head;    while (h != 0 && h->val != v)        h = h->next;    return h != 0; //0è¡¨ç¤ºç©ºæŒ‡é’ˆ}int LIST::insert(int v){ //åœ¨é“¾è¡¨ä¸­æ’å…¥æ–°å¢èŠ‚ç‚¹    head = new NODE(v, head);    return 1;}class SET : protected LIST{             //é‡‡ç”¨ä¿æŠ¤ç»§æ‰¿æ–¹å¼    int used; //é›†åˆå…ƒç´ çš„ä¸ªæ•°public:    LIST::contains;  //ä¿®æ”¹containså‡½æ•°è®¿é—®æƒé™    int insert(int); //éœ€è¦æ”¹å˜usedå€¼ï¼Œå› æ­¤æ”¹å†™insertå‡½æ•°    SET(){};         //ç­‰ä»·äºSET( ):LIST( ){ };};int SET::insert(int v){ //LIST::insertä¸­çš„LISTä¸èƒ½çœç•¥ï¼šå¦åˆ™è‡ªé€’å½’    if (!contains(v) && LIST::insert(v))        return used++;    return 0;}void main(void){    SET s;    s.insert(3);    s.contains(3);}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ´¾ç”Ÿç±»ä¸èƒ½è®¿é—®åŸºç±»ç§æœ‰æˆå‘˜ï¼Œé™¤éå°†æ´¾ç”Ÿç±»çš„å£°æ˜ä¸ºåŸºç±»çš„å‹å…ƒç±»ï¼Œæˆ–è€…å°†æ•™å…»è®¿é—®åŸºç±»ç§æœ‰æˆå‘˜çš„æ´¾ç”Ÿç±»å‡½æ•°å£°æ˜ä¸ºåŸºç±»çš„å‹å…ƒï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">class B;           //å‰å‘å£°æ˜ç±»Bclass A {    int a, b;public:    A(int x) { a=x; }    friend B;          //å£°æ˜Bä¸ºAçš„å‹å…ƒç±»ï¼ŒBç±»æˆå‘˜å¯ä»¥è®¿é—®Aä»»ä½•æˆå‘˜};class B: A {           //ç¼ºçœä¸ºprivateç»§æ‰¿ï¼Œç­‰ä»·äºclass B: private A{    int b;public:    B(int x): A(x) { b = x;  A::b = x;  a += 3; }   //å¯è®¿é—®ç§æœ‰æˆå‘˜A::a, A::b};void main(void) {    B x(7); }<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ„é€ å’Œææ„"><a href="#æ„é€ å’Œææ„" class="headerlink" title="æ„é€ å’Œææ„"></a>æ„é€ å’Œææ„</h2><h3 id="æ„é€ ä¸ææ„å‡½æ•°çš„é¡ºåº"><a href="#æ„é€ ä¸ææ„å‡½æ•°çš„é¡ºåº" class="headerlink" title="æ„é€ ä¸ææ„å‡½æ•°çš„é¡ºåº"></a>æ„é€ ä¸ææ„å‡½æ•°çš„é¡ºåº</h3><ul><li>å•ç»§æ‰¿æ´¾ç”Ÿç±»çš„æ„é€ é¡ºåºæ¯”è¾ƒå®¹æ˜“ç¡®å®šï¼š<ul><li>è°ƒç”¨è™šåŸºç±»çš„æ„é€ å‡½æ•°ï¼›</li><li>è°ƒç”¨åŸºç±»çš„æ„é€ å‡½æ•°ï¼›</li><li>æŒ‰ç…§æ´¾ç”Ÿç±»ä¸­æ•°æ®æˆå‘˜çš„å£°æ˜é¡ºåºï¼Œä¾æ¬¡è°ƒç”¨æ•°æ®æˆå‘˜çš„æ„é€ å‡½æ•°æˆ–åˆå§‹åŒ–æ•°æ®æˆå‘˜ï¼›</li><li>æœ€åæ‰§è¡Œæ´¾ç”Ÿç±»çš„æ„é€ å‡½æ•°æ„é€ æ´¾ç”Ÿç±»ã€‚ </li></ul></li><li><strong>ææ„æ˜¯æ„é€ çš„é€†åºã€‚</strong></li></ul><p>ä»¥ä¸‹æƒ…å†µæ´¾ç”Ÿç±»å¿…é¡»å®šä¹‰è‡ªå·±çš„æ„é€ å‡½æ•°ï¼š</p><ul><li>è™šåŸºç±»æˆ–åŸºç±»åªå®šä¹‰äº†å¸¦å‚æ•°çš„æ„é€ å‡½æ•°ï¼›</li><li>æ´¾ç”Ÿç±»è‡ªèº«å®šä¹‰äº†<strong>å¼•ç”¨æˆå‘˜æˆ–åªè¯»æˆå‘˜</strong>ï¼›</li><li>æ´¾ç”Ÿç±»éœ€è¦ä½¿ç”¨å¸¦å‚æ•°æ„é€ å‡½æ•°åˆå§‹åŒ–çš„å¯¹è±¡æˆå‘˜ã€‚</li></ul><pre class="line-numbers language-c++"><code class="language-c++">#include <iostream>class A{    int a;public:    A(int x) : a(x) { std::cout << a; } //ä¹Ÿå¯åœ¨æ„é€ å‡½æ•°ä½“å†…å†æ¬¡å¯¹aèµ‹å€¼    ~A() { std::cout << a; }};class B : A{ //ç§æœ‰ç»§æ‰¿ï¼Œç­‰ä»·äºclass B: private A {    int b, c;    const int d; //Bä¸­å®šä¹‰æœ‰åªè¯»æˆå‘˜ï¼Œæ•…å¿…é¡»å®šä¹‰æ„é€ å‡½æ•°åˆå§‹åŒ–    A x, y;public:    B(int v) : b(v), y(b + 2), x(b + 1), d(b), A(v)    { //æ³¨æ„æ„é€ ä¸å‡ºç°é¡ºåºæ— å…³        c = v;        std::cout << b << c << d;        std::cout << "C";    }    ~B() { std::cout << â€œDâ€; } //æ´¾ç”Ÿç±»æˆå‘˜å®é™…æ„é€ é¡ºåºä¸º b, d, x, y};void main(void) { B z(1); } //è¾“å‡ºç»“æœï¼š123111CD321<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»¥ä¸Šä»£ç çš„è¾“å‡ºç»“æœæ˜¯å€¼å¾—åå¤ç©å‘³çš„ï¼Œæœ¬èº«çš„æ„é€ é¡ºåºå’Œææ„é¡ºåºéå¸¸é‡è¦ï¼š</p><ul><li>æ´¾ç”Ÿç±»æˆå‘˜æ„é€ å‡½æ•°æœ€ä¸€å¼€å§‹æ‰§è¡ŒåŸºç±»æ„é€ å‡½æ•°A(v),æ‰€ä»¥æˆ‘ä»¬å¾—åˆ°ç¬¬ä¸€ä¸ªè¾“å‡º1ï¼Œç„¶åæˆ‘ä»¬æ ¹æ®åœ¨ç±»å†…çš„å®šä¹‰é¡ºåºb,d,x,yè¿›è¡Œç›¸å…³çš„åˆå§‹åŒ–æ„é€ </li><li>bè¿›è¡Œåˆå§‹åŒ–ä¸º1,æ²¡æœ‰ä»»ä½•cout,æ¥ç€æ˜¯dçš„åˆå§‹åŒ–å¾—åˆ°1ï¼ŒåŒæ ·æ²¡æœ‰cout</li><li>æ¥ç€è°ƒç”¨xæ„é€ å‡½æ•°cout&lt;&lt;2, è°ƒç”¨yæ„é€ å‡½æ•°cout&lt;&lt;3</li><li>è€Œåå¼€å§‹æ‰§è¡ŒèŠ±æ‹¬å·å†…å®¹cout&lt;&lt;b&lt;&lt;c&lt;&lt;d,coutç»“æœ1ï¼Œ1ï¼Œ1</li><li>æœ€åcout&lt;&lt;â€Câ€ï¼Œæ„é€ ç¯èŠ‚ç»“æŸã€‚</li><li>è€Œæˆ‘ä»¬ææ„çš„æ—¶å€™ï¼Œæ‰§è¡Œé¡ºåºä¸ºå…ˆæ´¾ç”Ÿç±»æœ€ååŸºç±»çš„é¡ºåºã€‚</li><li>å› ä¸ºææ„æ˜¯æ„é€ çš„é€†åºï¼Œé¦–å…ˆè¿›å…¥å‡½æ•°~B(),é¦–å…ˆè¾“å‡ºDï¼Œç„¶åå…ˆææ„y,å†ææ„x,æ¥ç€ææ„åŸºç±»Aã€‚</li></ul><p>è¿™å°±æ˜¯ä»¥ä¸Šè¯´æ˜çš„é¡ºåºï¼Œè¿™é‡Œé‡æ–°ä»‹ç»ä¸€éåŠ æ·±è®°å¿†ï¼š</p><ul><li>å•ç»§æ‰¿æ´¾ç”Ÿç±»çš„æ„é€ é¡ºåºæ¯”è¾ƒå®¹æ˜“ç¡®å®šï¼š<ul><li>è°ƒç”¨è™šåŸºç±»çš„æ„é€ å‡½æ•°ï¼›</li><li>è°ƒç”¨åŸºç±»çš„æ„é€ å‡½æ•°ï¼›</li><li><strong>æŒ‰ç…§æ´¾ç”Ÿç±»ä¸­æ•°æ®æˆå‘˜çš„å£°æ˜é¡ºåº</strong>ï¼Œä¾æ¬¡è°ƒç”¨æ•°æ®æˆå‘˜çš„æ„é€ å‡½æ•°æˆ–åˆå§‹åŒ–æ•°æ®æˆå‘˜ï¼›</li><li>æœ€åæ‰§è¡Œæ´¾ç”Ÿç±»çš„æ„é€ å‡½æ•°æ„é€ æ´¾ç”Ÿç±»ã€‚ </li></ul></li><li><strong>ææ„æ˜¯æ„é€ çš„é€†åºã€‚</strong></li></ul><p>å¦å¤–çœ‹ä¸€äº›æ³¨æ„äº‹é¡¹ï¼š</p><h3 id="å¼•ç”¨å˜é‡æ„é€ ç±»ä¸æŒ‡é’ˆå˜é‡åˆ©ç”¨newæ„é€ ç±»å†…å­˜æ³„æ¼é—®é¢˜"><a href="#å¼•ç”¨å˜é‡æ„é€ ç±»ä¸æŒ‡é’ˆå˜é‡åˆ©ç”¨newæ„é€ ç±»å†…å­˜æ³„æ¼é—®é¢˜" class="headerlink" title="å¼•ç”¨å˜é‡æ„é€ ç±»ä¸æŒ‡é’ˆå˜é‡åˆ©ç”¨newæ„é€ ç±»å†…å­˜æ³„æ¼é—®é¢˜"></a>å¼•ç”¨å˜é‡æ„é€ ç±»ä¸æŒ‡é’ˆå˜é‡åˆ©ç”¨newæ„é€ ç±»å†…å­˜æ³„æ¼é—®é¢˜</h3><ul><li><p>å¦‚æœè™šåŸºç±»å’ŒåŸºç±»çš„æ„é€ å‡½æ•°æ˜¯æ— å‚çš„ï¼Œåˆ™æ„é€ æ´¾ç”Ÿç±»å¯¹è±¡æ—¶ï¼Œæ„é€ å‡½æ•°å¯ä»¥ä¸ç”¨æ˜¾å¼è°ƒç”¨å®ƒä»¬çš„æ„é€ å‡½æ•°ï¼Œç¼–è¯‘ç¨‹åºä¼šè‡ªåŠ¨è°ƒç”¨è™šåŸºç±»æˆ–åŸºç±»çš„æ— å‚æ„é€ å‡½æ•°ã€‚</p></li><li><p><strong>å¦‚æœå¼•ç”¨å˜é‡rå¼•ç”¨çš„æ˜¯ä¸€ä¸ªå¯¹è±¡vï¼Œåˆ™å¯¹è±¡çš„æ„é€ å’Œææ„ç”±å¯¹è±¡vå®Œæˆï¼Œè€Œä¸åº”è¯¥ç”±å¼•ç”¨å˜é‡rå®Œæˆã€‚</strong></p></li><li><p><strong>å¦‚æœè¢«å¼•ç”¨çš„å¯¹è±¡æ˜¯ç”¨newç”Ÿæˆçš„ï¼Œåˆ™å¼•ç”¨å˜é‡rå¿…é¡»ç”¨delete &amp;rææ„å¯¹è±¡ï¼Œå¦åˆ™è¢«å¼•ç”¨çš„å¯¹è±¡å°†å› æ— æ³•å®Œå…¨é‡Šæ”¾ç©ºé—´ï¼ˆä¸ºå¯¹è±¡ç”³è¯·çš„ç©ºé—´ï¼‰è€Œäº§ç”Ÿå†…å­˜æ³„æ¼ã€‚</strong></p></li></ul><p>æ¥ä¸‹æ¥æ˜¯è¢«å¼•ç”¨å¯¹è±¡çš„ææ„é—®é¢˜ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">#include <iostream>using namespace std;class A {    int  i;   int *s;public:    A(int x) {        s = new int[i=x];         cout << "(C): " << i << "\n";     }    ~A( ) {        delete s;         cout << "(D): " << i << "\n";     }};void sub1(void) {     A &p = *new A(1);  }//å†…å­˜æ³„éœ²void sub2(void) {      A *q = new A(2);} //å†…å­˜æ³„éœ²void sub3(void) {    A &p = *new A(3);    delete &p;}void sub4(void) {    A *q = new A(4);      delete q;  }int main(void) {    sub1( );   sub2( );    sub3( );   sub4( );    return 0;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºç»“æœï¼š<br>(C):1<br>(C):2<br>(C):3<br>(D):3<br>(C):4<br>(D):4</p><h2 id="çˆ¶ç±»ä¸å­ç±»"><a href="#çˆ¶ç±»ä¸å­ç±»" class="headerlink" title="çˆ¶ç±»ä¸å­ç±»"></a>çˆ¶ç±»ä¸å­ç±»</h2><h3 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h3><ul><li>å¦‚æœæ´¾ç”Ÿç±»çš„ç»§æ‰¿æ–¹å¼ä¸ºpublicï¼Œåˆ™è¿™æ ·çš„æ´¾ç”Ÿç±»ç§°ä¸ºåŸºç±»çš„å­ç±»ï¼Œè€Œç›¸åº”çš„åŸºç±»åˆ™ç§°ä¸ºæ´¾ç”Ÿç±»çš„çˆ¶ç±»ã€‚æ³¨æ„åªæœ‰publicç»§æ‰¿æ‰æœ‰è¿™ä¸ªå­ç±»çˆ¶ç±»è¿™ç§æ¦‚å¿µã€‚</li><li>C++å…è®¸çˆ¶ç±»æŒ‡é’ˆç›´æ¥æŒ‡å‘å­ç±»å¯¹è±¡ï¼Œä¹Ÿå…è®¸çˆ¶ç±»å¼•ç”¨ç›´æ¥å¼•ç”¨å­ç±»å¯¹è±¡ã€‚</li><li>é€šè¿‡çˆ¶ç±»æŒ‡é’ˆè°ƒç”¨è™šå‡½æ•°æ—¶æ™šæœŸç»‘å®šï¼Œæ ¹æ®å¯¹è±¡çš„å®é™…ç±»å‹ç»‘å®šåˆ°åˆé€‚çš„æˆå‘˜å‡½æ•°ã€‚</li><li>çˆ¶ç±»æŒ‡é’ˆå®é™…æŒ‡å‘çš„å¯¹è±¡çš„ç±»å‹ä¸åŒï¼Œè™šå‡½æ•°ç»‘å®šçš„å‡½æ•°çš„è¡Œä¸ºå°±ä¸åŒï¼Œä»è€Œäº§ç”Ÿå¤šæ€ã€‚</li></ul><p>ç¼–è¯‘æ—¶ï¼š</p><ul><li>ç¼–è¯‘ç¨‹åºåªèƒ½æ ¹æ®ç±»å‹å®šä¹‰é™æ€åœ°æ£€æŸ¥è¯­ä¹‰ã€‚ç”±äºçˆ¶ç±»æŒ‡é’ˆå¯ä»¥ç›´æ¥æŒ‡å‘å­ç±»å¯¹è±¡ï¼Œè€Œåˆ°åº•æ˜¯æŒ‡å‘çˆ¶ç±»å¯¹è±¡è¿˜æ˜¯å­ç±»å¯¹è±¡åªèƒ½åœ¨è¿è¡Œæ—¶ç¡®å®šã€‚</li><li>ç¼–è¯‘æ—¶ï¼Œåªèƒ½æŠŠçˆ¶ç±»æŒ‡é’ˆæŒ‡å‘çš„å¯¹è±¡éƒ½å½“ä½œçˆ¶ç±»å¯¹è±¡ã€‚å› æ­¤ç¼–è¯‘æ—¶ï¼š<br>çˆ¶ç±»æŒ‡é’ˆè®¿é—®å¯¹è±¡çš„æ•°æ®æˆå‘˜æˆ–å‡½æ•°æˆå‘˜æ—¶ï¼Œä¸èƒ½è¶…è¶Šçˆ¶ç±»ä¸ºç›¸åº”å¯¹è±¡æˆå‘˜è§„å®šçš„è®¿é—®æƒé™ï¼›</li><li>ä¹Ÿä¸èƒ½é€šè¿‡çˆ¶ç±»æŒ‡é’ˆè®¿é—®å­ç±»æ–°å¢çš„æˆå‘˜ï¼Œå› ä¸ºè¿™äº›æˆå‘˜åœ¨çˆ¶ç±»ä¸­ä¸å­˜åœ¨ï¼Œç¼–è¯‘ç¨‹åºæ— æ³•è¯†åˆ«ã€‚</li></ul><p>æ¥ä¸€ä¸ªä¾‹å­æ¥è¿›ä¸€æ­¥è¯´æ˜ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">#include <iostream>using namespace std;class POINT{    int x, y;public:    int getx() { return x; }    int gety() { return y; }    void show() { cout << "Show a point\n"; }    POINT(int x, int y)    {        POINT::x = x;        POINT::y = y;    }};class CIRCLE : public POINT{    int r;public:    int getr() { return r; }    void show() { cout << "Show a circle\n"; }    CIRCLE(int x, int y, int r) : POINT(x, y) { CIRCLE::r = r; }};int main(void){    CIRCLE c(3, 7, 8);    POINT *p = &c; //çˆ¶ç±»å¯¹è±¡æŒ‡é’ˆpå¯ä»¥ç›´æ¥æŒ‡å‘å­ç±»å¯¹è±¡ï¼Œä¸ç”¨ç±»å‹è½¬æ¢    cout << â€œThe circle with radius â€ << c.getr();    //ä¸èƒ½ä½¿ç”¨p->getr( )ï¼Œå› ä¸ºgetr( )å‡½æ•°ä¸æ˜¯çˆ¶ç±»çš„å‡½æ•°æˆå‘˜    //ç¼–è¯‘ç¨‹åºæ— æ³•é€šè¿‡æ£€æŸ¥    cout << â€œ is at(â€ << p->getx() << â€œ, â€ << p->gety() << â€œ)\nâ€;    p->show();    //pè™½ç„¶æŒ‡å‘å­ç±»å¯¹è±¡ï¼Œä½†è°ƒç”¨çš„æ˜¯çˆ¶ç±»çš„showå‡½æ•°}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºç»“æœï¼š<br>The circle with radius 8 is at (3, 7)<br>Show a point</p><p><strong>è¿™é‡Œé¢æœ€å…³é”®çš„ä¸€ç‚¹å°±æ˜¯pè™½ç„¶æŒ‡å‘å­ç±»å¯¹è±¡ï¼Œä½†è°ƒç”¨çš„æ˜¯çˆ¶ç±»çš„showå‡½æ•°</strong>(ä½†æ˜¯å¦‚æœæ˜¯è™šå‡½æ•°å°±è°ƒç”¨çš„æ˜¯å­ç±»çš„è™šå‡½æ•°äº†ã€‚)</p><h3 id="å¼ºåˆ¶ç±»å‹è½¬æ¢"><a href="#å¼ºåˆ¶ç±»å‹è½¬æ¢" class="headerlink" title="å¼ºåˆ¶ç±»å‹è½¬æ¢"></a>å¼ºåˆ¶ç±»å‹è½¬æ¢</h3><ul><li><p>è‹¥åŸºç±»å’Œæ´¾ç”Ÿç±»æ²¡æœ‰æ„æˆçˆ¶å­å…³ç³»ï¼Œåˆ™ï¼š</p><ul><li><p><strong>åŸºç±»æŒ‡é’ˆä¸èƒ½ç›´æ¥æŒ‡å‘æ´¾ç”Ÿç±»å¯¹è±¡ï¼Œå¿…é¡»é€šè¿‡å¼ºåˆ¶ç±»å‹è½¬æ¢æ‰èƒ½æŒ‡å‘æ´¾ç”Ÿç±»å¯¹è±¡ã€‚</strong></p></li><li><p><strong>åŸºç±»å¼•ç”¨ä¹Ÿä¸èƒ½ç›´æ¥å¼•ç”¨æ´¾ç”Ÿç±»å¯¹è±¡ï¼Œè€Œå¿…é¡»é€šè¿‡å¼ºåˆ¶ç±»å‹è½¬æ¢æ‰èƒ½å¼•ç”¨æ´¾ç”Ÿç±»å¯¹è±¡ã€‚</strong></p></li></ul></li></ul><p>ã€ä¾‹6.7ã€‘å¼•ç”¨çˆ¶ç±»å¯¹è±¡çš„å¼•ç”¨å˜é‡å¼•ç”¨å­ç±»å¯¹è±¡ã€‚</p><pre class="line-numbers language-c++"><code class="language-c++">#include <iostream>using namespace std;class A{    int a;public:    int getv() { return a; }    A() { a = 0; }    A(int x) { a = x; }    ~A() { cout << "~A\n"; }};class B : A{ //éçˆ¶å­ï¼šprivate    int b;public:    int getv()    {        return b + A::getv();    }    B() { b = 0; } //ç­‰äºB( ):A( )    B(int x) : A(x) { b = x; }    ~B() { cout << "~B\n"; }};class C : public A{    int c;public:    int getv() { return c + A::getv(); }    C() { c = 0; } //ç­‰ä»·äºC( ):A( ) { c = 0; }    C(int x) : A(x) { c = x; }    ~C() { cout << "~C\n"; }};int main(void){    A &p = *new C(3);      //ç›´æ¥å¼•ç”¨Cç±»å¯¹è±¡ï¼šAå’ŒCçˆ¶å­    A &q = *(A *)new B(5); //å¼ºåˆ¶è½¬æ¢å¼•ç”¨Bç±»å¯¹è±¡ï¼šAå’ŒBéçˆ¶å­    cout << "p.getv( )=" << p.getv() << "\n";    cout << "q.getv( )=" << q.getv() << "\n";    delete &p; //ææ„C(3)çš„çˆ¶ç±»Aè€Œéå­ç±»C    delete &q; //ææ„B(5)çš„çˆ¶ç±»A è€Œéå­ç±»B    return 0;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºï¼š<br>p.getv( ) = 3<br>q.getv( ) = 5<br>~A<br>~A</p><p><code>A&amp;p= *new C(3)</code>è¿™ä¸€è¡Œä»£ç è¡¨ç¤ºåˆ›é€ ä¸€ä¸ªCç±»å‹çš„å¯¹è±¡ï¼Œè°ƒç”¨å‡½æ•°C(int)æ¥è¿›è¡Œåˆå§‹åŒ–ç±»ï¼Œnewè¿ç®—ç¬¦è¿”å›åœ°å€ååœ¨åŠ ä¸€ä¸ª<code>*</code>å·è®¿é—®è¯¥åœ°å€ï¼Œç„¶åèµ‹ç»™ä¸€ä¸ªAç±»çš„å¼•ç”¨p.è¿™ä¸ªç¡®å®ä¸æ˜¯éå¸¸å¥½ç†è§£ã€‚è¿™é‡Œè¿˜è¦æ³¨æ„ä¸€ä¸‹ä¸¤è€…Aç±»å’ŒCç±»æ˜¯çˆ¶å­å…³ç³»ï¼Œè€Œä¸‹é¢ä¸€è¡Œä»£ç çš„<code>A &amp;q = *(A *)new B(5);</code>ä¸­Aç±»å’ŒBç±»å°±ä¸æ˜¯çˆ¶å­å…³ç³»ã€‚</p><p>æœ€åè¾“å‡ºçš„ç»“æœå¯ä»¥çœ‹å‡ºï¼Œè°ƒç”¨çš„éƒ½æ˜¯Aç±»çš„å‡½æ•°getv()ï¼Œä½†æ˜¯å½“æˆ‘ä»¬ææ„ç›¸åº”çš„å¯¹è±¡çš„æ—¶å€™ä»…ä»…çˆ¶ç±»çš„ææ„å‡½æ•°è¢«è°ƒç”¨äº†ï¼Œå­ç±»ã€æ´¾ç”Ÿç±»æ ¹æœ¬æ²¡æœ‰è¢«è°ƒç”¨ææ„ï¼Œé€ æˆå†…å­˜æ³„æ¼é—®é¢˜ã€‚</p><p>è¿™ä¸ªç›®å‰ä¼¼æ‡‚éæ‡‚ï¼Œä½†æ˜¯æˆ‘å®åœ¨çœ‹ä¸ä¸‹å»äº†ï¼Œç›®å‰çœ‹åˆ°ç¬¬å…­ç« ç¬¬31å¼ PPTäº†ï¼Œä½†æ˜¯ä»¥ä¸Šè¿™ä¸ªä»£ç è¿˜ä¸å¤ªæ‡‚ï¼Œåˆ°æ—¶å€™å†è¯´ï¼</p><p>è¿™é‡Œå¯¹çˆ¶ç±»å­ç±»æŒ‡é’ˆåšä¸€ä¸ªæ€»ç»“å†ï¼Œ</p><ul><li><p>ç¼–è¯‘æ–¹é¢ï¼šè™½ç„¶æˆ‘ä»¬çˆ¶ç±»æŒ‡é’ˆå¯ä»¥æŒ‡å‘å­ç±» ï¼Œä½†æ˜¯ç”±äºç¼–è¯‘ç¨‹åºåªèƒ½æ ¹æ®ç±»å‹å®šä¹‰é™æ€çš„æ£€æŸ¥è¯­ä¹‰ï¼Œæ‰€ä»¥æˆ‘ä»¬ç¼–è¯‘çš„æ—¶å€™çˆ¶ç±»æŒ‡é’ˆä¸ç®¡æŒ‡å‘çš„æ˜¯çˆ¶ç±»è¿˜æ˜¯å­ç±»ï¼Œç¼–è¯‘å™¨ç»Ÿä¸€è®¤ä¸ºè¿™æ˜¯æŒ‡å‘çš„çˆ¶ç±»ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬è®¿é—®å­ç±»æ–°å‡ºç°çš„å¯¹è±¡çš„æ—¶å€™ï¼Œç¼–è¯‘ä¼šæŠ¥é”™ã€‚</p></li><li><p>å¦‚æœåŸºç±»å’Œæ´¾ç”Ÿç±»æ²¡æœ‰æ„æˆæ‰€è°“çš„çˆ¶å­å…³ç³»ï¼Œé‚£ä¹ˆæˆ‘ä»¬åŸºç±»æŒ‡é’ˆä¸å¯ä»¥ç›´æ¥æŒ‡å‘æ´¾ç”Ÿç±»ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å¼ºåˆ¶ç±»å‹è½¬æ¢åšåˆ°è¿™ä¸€ç‚¹ï¼Œåªä¸è¿‡ææ„çš„æ—¶å€™åªèƒ½ææ„æ‰åŸºç±»çš„éƒ¨åˆ†ã€‚</p><ul><li>åœ¨æ´¾ç”Ÿç±»æˆå‘˜å†…éƒ¨ï¼ŒåŸºç±»æŒ‡é’ˆå¯ä»¥ç›´æ¥æŒ‡å‘è¯¥æ´¾ç”Ÿç±»å¯¹è±¡ï¼Œå¯¹æ´¾ç”Ÿç±»å‡½æ•°è€Œè¨€ï¼ŒåŸºç±»ç­‰åŒå½“ä½œäºçˆ¶ç±»ã€‚</li><li>å¦‚æœå‡½æ•°å£°æ˜ä¸ºæ´¾ç”Ÿç±»çš„å‹å…ƒï¼Œåˆ™è¯¥å‹å…ƒå®šä¹‰çš„åŸºç±»æŒ‡é’ˆä¹Ÿå¯ä»¥ç›´æ¥æŒ‡å‘è¯¥åŸºç±»çš„æ´¾ç”Ÿç±»å¯¹è±¡ï¼Œä¹Ÿä¸å¿…é€šè¿‡å¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚</li></ul></li></ul><p>é’ˆå¯¹ä»¥ä¸Šå¯ä»¥çœ‹ä¸€ä¸ªå°ä¾‹å­ï¼š<br>ã€ä¾‹6.9ã€‘å®šä¹‰æœºè½¦ç±»VEHICLEï¼Œå¹¶æ´¾ç”Ÿå‡ºæ±½è½¦ç±»CARã€‚</p><pre class="line-numbers language-c++"><code class="language-c++">#include<iostream>using namespace std;class VEHICLE{    int speed, weight, wheels;public:    VEHICLE(int spd, int wgt, int whl);};VEHICLE::VEHICLE(int spd, int wgt, int whl){    speed = spd;    weight = wgt;    wheels = whl;}class CAR : private VEHICLE{    int seats;public:    VEHICLE *who();    CAR(int sd, int wt, int st);    friend int main();};CAR::CAR(int sd, int wt, int st) : VEHICLE(sd, wt, 4) { seats = st; }VEHICLE *CAR::who(){    VEHICLE *p = this;  //æ´¾ç”Ÿç±»å†…çš„åŸºç±»æŒ‡é’ˆç›´æ¥æŒ‡å‘æ´¾ç”Ÿç±»å¯¹è±¡    VEHICLE &q = *this; //æ´¾ç”Ÿç±»å†…çš„åŸºç±»å¼•ç”¨ç›´æ¥å¼•ç”¨æ´¾ç”Ÿç±»å¯¹è±¡    return p;}//åœ¨æ´¾ç”Ÿç±»çš„å‹å…ƒmainä¸­ï¼ŒåŸºç±»å’Œæ´¾ç”Ÿç±»æ„æˆçˆ¶å­å…³ç³»int main(void){    CAR c(1, 2, 3);    VEHICLE *p = &c;    return 0;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°ä»¥ä¸Šå°±æœ‰åœ¨æ´¾ç”Ÿç±»ä¸­ç›´æ¥å®šä¹‰åŸºç±»æŒ‡é’ˆå’Œå¼•ç”¨p\qæ¥æŒ‡å‘æ´¾ç”Ÿç±»å¯¹è±¡ï¼Œå¹¶ä¸”è¿™é‡Œå®šä¹‰äº†<code>main()</code>å‡½æ•°ä¸ºæ´¾ç”Ÿç±»çš„å‹å…ƒï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨mainå‡½æ•°ä¸­ç›´æ¥å®šä¹‰åŸºç±»æŒ‡é’ˆæŒ‡å‘æ´¾ç”Ÿç±»ã€‚</p><h2 id="æ´¾ç”Ÿç±»çš„å­˜å‚¨ç©ºé—´"><a href="#æ´¾ç”Ÿç±»çš„å­˜å‚¨ç©ºé—´" class="headerlink" title="æ´¾ç”Ÿç±»çš„å­˜å‚¨ç©ºé—´"></a>æ´¾ç”Ÿç±»çš„å­˜å‚¨ç©ºé—´</h2><ul><li>æ´¾ç”Ÿç±»çš„æˆå‘˜ä¸€éƒ¨åˆ†æ˜¯æ–°å®šä¹‰çš„ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯ä»åŸºç±»æ–°ç»§æ‰¿æ¥å¾—ï¼Œå› æ­¤æ´¾ç”Ÿç±»å¯¹è±¡çš„å­˜å‚¨ç©ºé—´ä¸­å¿…ç„¶åŒ…å«äº†åŸºç±»çš„æˆå‘˜ã€‚</li><li>åœ¨æ„é€ æ´¾ç”Ÿç±»å¯¹è±¡ä¹‹å‰ï¼Œé¦–å…ˆæ„é€ çš„åŒ¿åçš„åŸºç±»å­˜å‚¨ç©ºé—´ï¼Œä½œä¸ºæ´¾ç”Ÿç±»å¯¹è±¡å­˜å‚¨ç©ºé—´çš„ä¸€éƒ¨åˆ†ã€‚</li><li>åœ¨è®¡ç®—æ´¾ç”Ÿç±»å¯¹è±¡å­˜å‚¨ç©ºé—´æ—¶ï¼Œ<strong>åŸºç±»ä¸æ´¾ç”Ÿç±»çš„é™æ€æ•°æ®æˆå‘˜éƒ½ä¸è®¡ç®—åœ¨å†…</strong>ã€‚</li></ul><p>æ‰€ä»¥å®é™…ä¸Šç®—èµ·æ¥è¿˜ä¸æ˜¯éå¸¸å¤æ‚ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">#include <iostream>class A {    int  h, i, j;    static int k;};class B: A {          //ç­‰ä»·äºclass B:  private A    int  m, n, p;    static int q;};int A::k = 0;     //é™æ€æ•°æ®æˆå‘˜å¿…é¡»åˆå§‹åŒ–int B::q = 0;void main(void) {    std::cout << "Size of int = " << sizeof(int) << "\n";    std::cout << "Size of A = "   << sizeof(A)   << "\n";    std::cout << "Size of B = "   << sizeof(B)   << "\n";}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://imagelol.com/image/I9vDRH" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/11/10/I9vDRH.png" alt></a></p><h1 id="å¤šç»§æ‰¿-1"><a href="#å¤šç»§æ‰¿-1" class="headerlink" title="å¤šç»§æ‰¿"></a>å¤šç»§æ‰¿</h1><h2 id="Preface-1"><a href="#Preface-1" class="headerlink" title="Preface"></a>Preface</h2><ul><li>å•ç»§æ‰¿æ˜¯å¤šç»§æ‰¿çš„ä¸€ç§ç‰¹ä¾‹ï¼Œå¤šç»§æ‰¿æ´¾ç”Ÿç±»å…·æœ‰æ›´å¼ºçš„ç±»å‹è¡¨è¾¾èƒ½åŠ›ã€‚</li><li>å¤šç»§æ‰¿æ´¾ç”Ÿç±»æœ‰å¤šä¸ªåŸºç±»æˆ–è™šåŸºç±»ã€‚</li><li>æ´¾ç”Ÿç±»ç»§æ‰¿æ‰€æœ‰åŸºç±»çš„<strong>æ•°æ®æˆå‘˜å’Œæˆå‘˜å‡½æ•°</strong>ã€‚</li><li>æ´¾ç”Ÿç±»åœ¨ç»§æ‰¿å¤šä¸ªåŸºç±»æ—¶ï¼Œä¸åŒçš„åŸºç±»å¯ä»¥é‡‡ç”¨ä¸åŒçš„æ´¾ç”Ÿæ§åˆ¶ã€‚</li><li>åŸºç±»ä¹‹é—´çš„æˆå‘˜å¯èƒ½åŒåï¼ŒåŸºç±»ä¸æ´¾ç”Ÿç±»çš„æˆå‘˜ä¹Ÿå¯èƒ½åŒåã€‚åœ¨å‡ºç°åŒåæ—¶ï¼Œå¦‚é¢å‘å¯¹è±¡çš„ä½œç”¨åŸŸä¸èƒ½è§£æï¼Œåº”è¯¥ä½¿ç”¨ä½œç”¨åŸŸè¿ç®—ç¬¦æ¥æŒ‡æ˜æ‰€è¦è®¿é—®çš„ç±»çš„æˆå‘˜ã€‚</li></ul><blockquote><ol><li>å¤šç»§æ‰¿æ´¾ç”Ÿç±»çš„å®šä¹‰ï¼š<br>class æ´¾ç”Ÿç±»å:&lt;æ´¾ç”Ÿæ–¹å¼&gt; åŸºç±»1,&lt;æ´¾ç”Ÿæ–¹å¼&gt; åŸºç±»2, â€¦ {<br>&lt;ç±»ä½“&gt;<br>};<ol start="2"><li>å­˜åœ¨æ´¾ç”Ÿç±»å¯¹è±¡å¤šæ¬¡åˆå§‹åŒ–åŒä¸€(ç‰©ç†)åŸºç±»å¯¹è±¡é—®é¢˜ã€‚ </li></ol></li></ol></blockquote><p>å…ˆçœ‹ä¸€ä¸ªå°ä¾‹å­ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">//ã€ä¾‹9.1ã€‘å®šä¹‰å…·æœ‰æ°´å¹³æ»šåŠ¨æ¡å’Œå‚ç›´æ»šåŠ¨æ¡çš„çª—å£ç±»ã€‚ class Window {    //...public:    Window(int top, int left, int bottom, int right);    ~Window( );};class Hscrollbar {    //...public:    HScrollbar(int top, int left, int bottom, int right);    ~ HScrollbar( );}; class Vscrollbar {    //...public:    VScrollbar (int top, int left, int bottom, int right);    ~ VScrollbar( );};class ScrollableWind: public Window {    HScrollbar  hScrollBar;      //å§”æ‰˜hScrollBarä»£ç†æ°´å¹³æ»šåŠ¨    VScrollbar  vScrollBar;      //å§”æ‰˜vScrollBarä»£ç†å‚ç›´æ»šåŠ¨    //...public:    ScrollableWind(int top, int left, int bottom, int right);    ~ScrollableWind( );};ScrollableWind::ScrollableWind (int t, int l, int b, int r):Window(t, l, b, r), hScrollbar(t, r+1, b-1, r), vScrollbar(b-1,l-1,b,r+1) {    //...};// Windowã€hScrollBarå’ŒvScrollBaråˆ†åˆ«åˆå§‹åŒ–æ˜¾ç¤ºç«¯å£ï¼Œåˆ™æ´¾ç”Ÿç±»ScrollableWindçš„å¯¹è±¡å°±ä¼šå¤šæ¬¡åˆå§‹åŒ–æ˜¾ç¤ºç«¯å£ï¼Œä»è€Œå¯¼è‡´æ˜¾ç¤ºå±å‡ºç°å¤šæ¬¡é—ªçƒã€‚// ç”¨å¤šç»§æ‰¿æ–¹å¼å®šä¹‰æ´¾ç”Ÿç±» ScrollableWindï¼š class ScrollableWind: public Window, public HScrollbar, public Vscrollbar {    //...public:    ScrollableWind(int top, int left, int bottom, int right);    ~ScrollableWind( );};ScrollableWind::ScrollableWind (int t, int l, int b, int r): Window(t, l, b, r),          HScrollbar(t, r+1, b-1, r), VScrollbar(b-1,l-1,b,r+1) {    //...}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»¥ä¸Šå°±æ˜¯ä¸€ä¸ªéå¸¸å…¸å‹ã€ä¹Ÿæ˜¯éå¸¸ç®€å•çš„å…³äºå¤šç»§æ‰¿çš„ä¾‹å­ï¼Œå½“ç„¶ä¹Ÿéå¸¸ç®€å•ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯å…³äºæ´¾ç”Ÿç±»çš„æ„é€ å‡½æ•°ï¼Œéœ€è¦å…ˆå°†å„ä¸ªåŸºç±»åˆå§‹åŒ–ã€‚è¿™ä¸€ç‚¹éå¸¸é‡è¦ã€‚</p><h2 id="å¤šæ¬¡é—ªçƒ"><a href="#å¤šæ¬¡é—ªçƒ" class="headerlink" title="å¤šæ¬¡é—ªçƒ"></a>å¤šæ¬¡é—ªçƒ</h2><p>ä½†æ˜¯å¦‚æœç¨å¾®å¤æ‚ä¸€äº›å°±ä¼šæ¯”è¾ƒéš¾åŠäº†ï¼Œå¤šç»§æ‰¿å®é™…ä¸Šå¾ˆå¸¸è§çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯æ´¾ç”Ÿç±»å¯¹è±¡å¤šæ¬¡åˆå§‹åŒ–åŒä¸€åŸºç±»æˆå‘˜ã€‚å‡è®¾ä»¥ä¸Šå®šä¹‰çš„ç±»Windowã€HScrollbarã€VScrollbar éƒ½æ˜¯ä»åŸºç±» Port æ´¾ç”Ÿï¼Œå³ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">class Port  { â€¦ };                       class Window: public Port  { â€¦ };class HScrollbar: public Port  { â€¦ };   class VScrollbar: public Port  { â€¦ };class ScrollableWind: public Window, public HScrollbar, public VScrollbar{â€¦};<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>åˆ›å»ºScrollableWindå¯¹è±¡æ—¶ï¼ŒPortçš„æ„é€ å‡½æ•°é€šè¿‡3æ¡ä¸åŒçš„è·¯å¾„ï¼Œè¢«è°ƒç”¨äº†3æ¬¡ï¼Œä»è€Œå°†æ˜¾ç¤ºç«¯å£åˆå§‹åŒ–3æ¬¡ã€‚å³1ä¸ªå­ç±»æœ‰3ä¸ªåŒåç¥–å…ˆç±»ï¼Œè€Œç‰©ç†æ˜¾ç¤ºç«¯å£åªæœ‰ä¸€ä¸ªï¼</strong><br>ä»¥ä¸‹ä¸ºæ´¾ç”Ÿæ ‘ï¼š<br><a href="https://imagelol.com/image/I9jEDS" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/11/10/I9jEDS.png" alt></a></p><p>æˆ‘ä»¬ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬è¿™é‡Œé€‰æ‹©ä½¿ç”¨<code>virtual</code>æ¥å®šä¹‰è™šåŸºç±»ã€‚è¿™æ ·çš„è¯å°±å¯ä»¥ä½¿å¾—æˆ‘ä»¬çš„æ˜¾ç¤ºç«¯å£Portä»…è¢«åˆå§‹åŒ–ä¸€æ¬¡ï¼š</p><p><a href="https://imagelol.com/image/I9jmF2" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/11/10/I9jmF2.png" alt="I9jmF2.png"></a></p><pre class="line-numbers language-c++"><code class="language-c++">class Window: virtual public Port  { â€¦ };class HScrollbar: public virtual Port  { â€¦ };class VScrollbar: public virtual Port  { â€¦ };class ScrollableWind: public Window, public HScrollbar, public VScrollbar   {  â€¦  };<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è™šåŸºç±»"><a href="#è™šåŸºç±»" class="headerlink" title="è™šåŸºç±»"></a>è™šåŸºç±»</h2><ul><li><p>åŒä¸€ä¸ªç±»ä¸èƒ½å¤šæ¬¡ä½œä¸ºæŸä¸ªæ´¾ç”Ÿç±»çš„ç›´æ¥åŸºç±»ï¼Œä½†å¯å¤šæ¬¡ä½œä¸ºå…¶é—´æ¥åŸºç±»ï¼Œä»è€Œå¼•èµ·å­˜å‚¨ç©ºé—´çš„æµªè´¹å’Œå…¶ä»–é—®é¢˜ã€‚æ­¤æ—¶ï¼Œè¿™äº›é—´æ¥åŸºç±»å¯å®šä¹‰ä¸ºè™šåŸºç±»ã€‚</p></li><li><p>åŒä¸€é¢—æ´¾ç”Ÿæ ‘ä¸­çš„åŒåè™šåŸºç±»ï¼Œå…±äº«åŒä¸€ä¸ªå­˜å‚¨ç©ºé—´ï¼›å…¶æ„é€ å‡½æ•°å’Œææ„å‡½æ•°ä»…æ‰§è¡Œ1æ¬¡ï¼Œ<strong>ä¸”æ„é€ å‡½æ•°å°½å¯èƒ½æœ€æ—©æ‰§è¡Œï¼Œè€Œææ„å‡½æ•°å°½å¯èƒ½æœ€æ™šæ‰§è¡Œã€‚</strong></p></li><li><p>å¦‚æœè™šåŸºç±»ä¸åŸºç±»åŒåï¼Œåˆ™å®ƒä»¬å°†åˆ†åˆ«æ‹¥æœ‰å„è‡ªçš„å­˜å‚¨ç©ºé—´ï¼Œåªæœ‰åŒåè™šåŸºç±»æ‰å…±äº«å­˜å‚¨ç©ºé—´ï¼Œè€ŒåŒååŸºç±»åˆ™æ‹¥æœ‰å„è‡ªçš„å­˜å‚¨ç©ºé—´ã€‚</p></li><li><p>è™šåŸºç±»å’ŒåŸºç±»åŒåå¿…ç„¶ä¼šå¯¼è‡´äºŒä¹‰æ€§è®¿é—®ï¼Œç¼–è¯‘ç¨‹åºä¼šå¯¹è¿™ç§äºŒä¹‰æ€§è®¿é—®æå‡ºè­¦å‘Šã€‚å½“å‡ºç°è¿™ç§æƒ…å†µæ—¶ï¼Œå»ºè®®ï¼šè¦ä¹ˆå°†åŸºç±»è¯´æ˜ä¸ºå¯¹è±¡æˆå‘˜ï¼Œè¦ä¹ˆå°†åŸºç±»éƒ½è¯´æ˜ä¸ºè™šåŸºç±»ã€‚å¯ç”¨ä½œç”¨åŸŸè¿ç®—ç¬¦é™å®šè¦è®¿é—®çš„æˆå‘˜ã€‚</p></li></ul><p>è™šåŸºç±»å°±æ˜¯ä¸ºäº†è®©æŸä¸ªæ´¾ç”Ÿç±»çš„å„ä¸ªåŸºç±»å…±äº«ä¸€ä¸ªå…±åŒçš„â€œå¤§â€åŸºç±»ã€‚</p><p>æˆ‘ä»¬ä¸å¦¨çœ‹çœ‹å…³äºè™šåŸºç±»çš„äºŒä¹‰æ€§é—®é¢˜ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">#include <iostream>using namespace std;struct A {    int a;    A(int x) { a = x; }};struct B: A {   //ç­‰äºstruct B:public A    B(int x):A(x) {  }};struct C {    C( ) {  }};struct D: virtual A, C {    D(int x):A(x)  {  }   //åŒæ ·è°ƒç”¨C( )};struct E: B, D {    E(int x):A(x), B(x+5), D(x+10) {  }};int main(void) {    E  e(0);//  cout << "a=" << e.a;  //äºŒä¹‰æ€§è®¿é—®    cout << "a=" << e.B::a;    cout << "a=" << e.D::a;    return 0;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><em>ä¸ºè§£å†³ e.a äº§ç”Ÿçš„äºŒä¹‰æ€§ï¼Œè¦ä¹ˆå°†Eçš„åŸºç±»Bè¯´æ˜ä¸ºå¯¹è±¡æˆå‘˜ï¼Œè¦ä¹ˆå°†Bçš„åŸºç±»Aè¯´æ˜ä¸ºè™šåŸºç±»ã€‚è‹¥å°†Bçš„åŸºç±»Aè¯´æ˜ä¸ºè™šåŸºç±»ï¼Œåˆ™ e.aã€e.B::aåŠ e.D::a éƒ½è¡¨ç¤ºè™šåŸºç±»Açš„æˆå‘˜ a ã€‚</em></p><h2 id="æ´¾ç”Ÿç±»æˆå‘˜-ç±»æˆå‘˜åŒåé—®é¢˜"><a href="#æ´¾ç”Ÿç±»æˆå‘˜-ç±»æˆå‘˜åŒåé—®é¢˜" class="headerlink" title="æ´¾ç”Ÿç±»æˆå‘˜(ç±»æˆå‘˜åŒåé—®é¢˜)"></a>æ´¾ç”Ÿç±»æˆå‘˜(ç±»æˆå‘˜åŒåé—®é¢˜)</h2><p>å½“æ´¾ç”Ÿç±»æœ‰å¤šä¸ªåŸºç±»æˆ–è™šåŸºç±»æ—¶ï¼ŒåŸºç±»æˆ–è™šåŸºç±»çš„æˆå‘˜ä¹‹é—´å¯èƒ½å‡ºç°åŒåï¼›æ´¾ç”Ÿç±»å’ŒåŸºç±»æˆ–è™šåŸºç±»çš„æˆå‘˜ä¹‹é—´ä¹Ÿå¯èƒ½å‡ºç°åŒåã€‚<br>å‡ºç°ä¸Šè¿°åŒåé—®é¢˜æ—¶ï¼Œå¿…é¡»é€šè¿‡é¢å‘å¯¹è±¡çš„ä½œç”¨åŸŸè§£æï¼Œæˆ–è€…ç”¨ä½œç”¨åŸŸè¿ç®—ç¬¦::æŒ‡å®šè¦è®¿é—®çš„æˆå‘˜ï¼Œå¦åˆ™å°±ä¼šå¼•èµ·äºŒä¹‰æ€§é—®é¢˜ã€‚<br>è¯·çœ‹é©¬å…‰å¿—ã€ŠC++ç²¾è¦æ•™ç¨‹ã€‹<br>ã€ä¾‹9.2ã€‘åŸºç±»æˆå‘˜é—´çš„åŒåé—®é¢˜ã€‚<br>ã€ä¾‹9.4ã€‘æ´¾ç”Ÿç±»æˆå‘˜ä¸åŸºç±»æˆå‘˜åŒåé—®é¢˜ã€‚<br>ã€ä¾‹9.5ã€‘è™šåŸºç±»ä¸åŸºç±»çš„æˆå‘˜åŒåé—®é¢˜ã€‚<br>æˆ‘æ‡’å¾—æ•²ä»£ç äº†ï¼Œæ‰€ä»¥è¿™é‡Œè¯·å‚è€ƒç›¸å…³ä¹¦ç±ã€‚</p><h2 id="å•é‡åŠå¤šé‡ç»§æ‰¿çš„æ„é€ ä¸ææ„"><a href="#å•é‡åŠå¤šé‡ç»§æ‰¿çš„æ„é€ ä¸ææ„" class="headerlink" title="å•é‡åŠå¤šé‡ç»§æ‰¿çš„æ„é€ ä¸ææ„"></a>å•é‡åŠå¤šé‡ç»§æ‰¿çš„æ„é€ ä¸ææ„</h2><h3 id="æ„é€ é¡ºåº"><a href="#æ„é€ é¡ºåº" class="headerlink" title="æ„é€ é¡ºåº"></a>æ„é€ é¡ºåº</h3><ul><li><p>åœ¨è€ƒè™‘å¤šç»§æ‰¿æ´¾ç”Ÿç±»æ„é€ å‡½æ•°çš„æ‰§è¡Œé¡ºåºæ—¶ï¼Œå¿…é¡»æ³¨æ„æ´¾ç”Ÿç±»å¯èƒ½æœ‰è™šåŸºç±»ã€åŸºç±»ã€å¯¹è±¡æˆå‘˜ã€constæˆå‘˜ä»¥åŠå¼•ç”¨æˆå‘˜ã€‚<strong>å½“è™šåŸºç±»ã€åŸºç±»å’Œå¯¹è±¡æˆå‘˜åªæœ‰å¸¦å‚æ•°çš„æ„é€ å‡½æ•°æ—¶ï¼Œæ´¾ç”Ÿç±»å¿…é¡»å®šä¹‰è‡ªå·±çš„æ„é€ å‡½æ•°ï¼Œè€Œä¸èƒ½åˆ©ç”¨C++æä¾›çš„ç¼ºçœæ„é€ å‡½æ•°ã€‚ç±»æœ‰éé™æ€å¯¹è±¡æˆå‘˜ã€const æˆå‘˜æ—¶ï¼Œä¹Ÿå¿…é¡»å®šä¹‰æ„é€ å‡½æ•°ã€‚</strong></p></li><li><p>å¯¹äºè™šåŸºç±»ã€åŸºç±»å’Œå¯¹è±¡æˆå‘˜æ¥è¯´ï¼Œå¦‚æœå®ƒä»¬æ²¡æœ‰å®šä¹‰è‡ªå·±çš„æ„é€ å‡½æ•°ï¼Œåˆ™ç¼–è¯‘ç¨‹åºå°±ä¼šä¸ºå®ƒä»¬æä¾›ç¼ºçœçš„æ— å‚æ„é€ å‡½æ•°ã€‚å¯¹äºè™šåŸºç±»ã€åŸºç±»å’Œå¯¹è±¡æˆå‘˜çš„æ— å‚æ„é€ å‡½æ•°ï¼Œæ— è®ºå®ƒä»¬æ˜¯è‡ªå®šä¹‰çš„è¿˜æ˜¯ç”±ç¼–è¯‘ç¨‹åºæä¾›çš„ï¼Œå¯è¢«æ´¾ç”Ÿç±»æ„é€ å‡½æ•°æŒ‰å®šä¹‰é¡ºåºè‡ªåŠ¨åœ°è°ƒç”¨ã€‚</p></li></ul><p>å…³äºè°ƒç”¨æ„é€ å‡½æ•°çš„é¡ºåºï¼Œå®é™…ä¸Šæˆ‘ä»¬åœ¨å•ç»§æ‰¿çš„æ„é€ å‡½æ•°é‚£ä¸€èŠ‚åšå®¢å·²ç»è¯´è¿‡äº†ï¼Œä½†æ˜¯è¿™é‡Œå†é‡å¤ä»‹ç»ä¸€éï¼Œå¦å¤–è¿™é‡Œåˆè¡¥å……äº†å…³äºè™šåŸºç±»è¿˜æœ‰ç±»å®šä¹‰é¡ºåºçš„è§£é‡Šï¼š</p><ul><li>æ´¾ç”Ÿç±»å¯¹è±¡çš„æ„é€ é¡ºåºæè¿°ï¼š</li></ul><p>â‘ æŒ‰å®šä¹‰é¡ºåº<strong>è‡ªå·¦è‡³å³ã€è‡ªä¸‹è€Œä¸Šåœ°</strong>æ„é€ æ‰€æœ‰è™šåŸºç±»ï¼›</p><p>â‘¡æŒ‰å®šä¹‰é¡ºåºæ„é€ æ´¾ç”Ÿç±»çš„æ‰€æœ‰ç›´æ¥åŸºç±»ï¼›</p><p>â‘¢æŒ‰<strong>å®šä¹‰é¡ºåº</strong>æ„é€ ï¼ˆåˆå§‹åŒ–ï¼‰æ´¾ç”Ÿç±»çš„æ‰€æœ‰æ•°æ®æˆå‘˜ï¼ŒåŒ…æ‹¬å¯¹è±¡æˆå‘˜ã€constæˆå‘˜å’Œå¼•ç”¨æˆå‘˜ï¼›</p><p>â‘£æ‰§è¡Œæ´¾ç”Ÿç±»è‡ªèº«çš„æ„é€ å‡½æ•°ä½“ï¼›</p><p>å¦‚æœè™šåŸºç±»ã€åŸºç±»ã€å¯¹è±¡æˆå‘˜ã€constæˆå‘˜ä»¥åŠå¼•ç”¨æˆå‘˜åˆæ˜¯æ´¾ç”Ÿç±»å¯¹è±¡ï¼Œé‡å¤ä¸Šè¿°æ´¾ç”Ÿç±»å¯¹è±¡çš„æ„é€ è¿‡ç¨‹ï¼Œ<strong>ä½†åŒåè™šåŸºç±»å¯¹è±¡åœ¨åŒä¸€æ£µæ´¾ç”Ÿæ ‘ä¸­ä»…æ„é€ ä¸€æ¬¡ã€‚</strong></p><ul><li>ææ„ï¼šææ„æ´¾ç”Ÿç±»å¯¹è±¡çš„é¡ºåºåŒæ„é€ <strong>é€†åº</strong>ã€‚</li></ul><h3 id="ä¾‹ä¸€"><a href="#ä¾‹ä¸€" class="headerlink" title="ä¾‹ä¸€"></a>ä¾‹ä¸€</h3><p>æˆ‘ä»¬çœ‹ä¸€ä¸ªæ¯”è¾ƒå…¸å‹çš„ä¾‹å­ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">#include <iostream>using namespace std;struct A{    A() { cout << 'A'; }};struct B{    B() { cout << 'B'; }};struct C{    int a;    int &b;    const int c;    C(char d) : c(d), b(a)    {        a = d;        cout << d;    }};struct D{    D() { cout << 'D'; }};struct E : A, virtual B, C, virtual D{    A x, y;    B z;    E() : z(), y(), C('C')    {        cout << 'E';    }};int main(void){    E e;    return 0;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬å¯ä»¥ç®€å•åˆ†æä¸€ä¸‹ï¼š<br>é¦–å…ˆå®šä¹‰äº†<code>E e;</code>ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºé¦–å…ˆè°ƒç”¨E()æ„é€ å‡½æ•°ï¼Œä¸è¦è¢«ä¸Šé¢çš„å‡½æ•°è¿·æƒ‘äº†ï¼Œæˆ‘ä»¬é¦–å…ˆè‚¯å®šæ˜¯è™šåŸºç±»ï¼Œä¸ç®¡<code>E():</code>åé¢çš„å®šä¹‰é¡ºåºï¼Œé¡ºåºæ˜¯æ ¹æ®ä¸Šé¢<code>struct E : A, virtual B, C, virtual D</code>è¿™ä¸ªé¡ºåºæ¥å¾—ï¼Œæ‰€ä»¥æˆ‘ä»¬é¦–å…ˆåˆå§‹åŒ–è™šåŸºç±»B, Dï¼Œæ¥ç€æ˜¯åŸºç±»A,Cï¼Œç„¶åæ˜¯æˆ‘ä»¬å®šä¹‰çš„æ•°æ®ç±»å‹x,y,zï¼Œæœ€åè¾“å‡ºEï¼Œæ‰€ä»¥ç»“æœåº”è¯¥ä¸º<code>BDACAABE</code>.</p><p>ä»¥ä¸Šè¿™ä¸ªä¾‹å­å¤ªç®€å•äº†ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å¯ä»¥çœ‹ä¸€ä¸ªæ›´åŠ å¤æ‚ä¸€ç‚¹çš„ä¾‹å­ï¼š</p><h3 id="ä¾‹äºŒ"><a href="#ä¾‹äºŒ" class="headerlink" title="ä¾‹äºŒ"></a>ä¾‹äºŒ</h3><pre class="line-numbers language-c++"><code class="language-c++">// ã€ä¾‹9.7ã€‘å¤šç»§æ‰¿æ´¾ç”Ÿç±»çš„æ„é€ è¿‡ç¨‹ã€‚#include <iostream>using namespace std;struct A{    A() { cout << 'A'; }};struct B{    const A a;    B() { cout << 'B'; }};struct C{    C() { cout << 'C'; }};struct D{    D() { cout << 'D'; }};struct E:A{    E() { cout << 'E'; }};struct F:B, virtual C{                 F(){cout << 'F';}};struct G:B{    G() { cout << 'G'; }};struct H:virtual C, virtual D{                         H(){cout << 'H';}};struct I:E, F, virtual G, H{    E e;    F f;    I() : f(), e(), F(), E() { cout << 'I'; }};int main(void){    I i;    return 0;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç›¸æ¯”ä¹‹ä¸‹ï¼Œè¿™ä¸ªå°±å¤æ‚éå¸¸å¤šï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/11/10/I9jCke.png" alt><br>è¾“å‡ºé¡ºåºä¸ºï¼šCABGDAEABFHAECABFI<br>å…³äºä¸ºä»€ä¹ˆè¿™é‡Œæœ€å…ˆè¾“å‡ºçš„ä¸æ˜¯Gï¼Œå°±æ˜¯å› ä¸ºæˆ‘ä»¬ä¸Šæ–‡çš„é¡ºåºè§„å®šçš„æ˜¯ï¼š</p><blockquote><p> æŒ‰å®šä¹‰é¡ºåº<strong>è‡ªå·¦è‡³å³ã€è‡ªä¸‹è€Œä¸Šåœ°</strong>æ„é€ æ‰€æœ‰è™šåŸºç±»ï¼›</p></blockquote><p>æ³¨æ„è¿™é‡ŒæŒ‰å®šä¹‰é¡ºåº<strong>è‡ªå·¦è‡³å³ã€è‡ªä¸‹è€Œä¸Šåœ°</strong>æ„é€ æ‰€æœ‰è™šåŸºç±»ï¼›è¿™å¥è¯éå¸¸é‡è¦ï¼</p><p>æˆ‘ä»¬æ­£æ˜¯ç”±äºè¿™å¥è¯ï¼Œå°±åƒå›¾ä¸Šçš„é¡ºåºï¼Œå…ˆå°†æœ€å¼€å§‹ä¸€æ’æ’ç±»æ’æ•´é½ï¼Œç„¶åè¿›è¡Œç›¸å…³çš„å¯¹äºæ•´ä½“çš„ä»å·¦è‡³å³ã€è‡ªä¸‹è€Œä¸Šçš„å¯»æ‰¾ï¼ŒæŒ‰ç…§æ‰¾åˆ°çš„é¡ºåºæ„é€ è™šåŸºç±»ï¼ˆæ³¨æ„è™šåŸºç±»å¾ˆæœ‰å¯èƒ½ä¹Ÿæœ‰å®ƒçš„åŸºç±»å°±åƒè¿™ä¸ªå›¾ä¸­çš„Gï¼Œè¿™äº›éƒ½è¦è€ƒè™‘åˆ°ï¼‰ã€ç„¶åæ¥ç€æ„é€ åŸºç±»ç„¶åæ„é€ ç±»çš„å¯¹è±¡ã€‚æ•´ä¸ªè¿‡ç¨‹è¿˜æ˜¯æ¯”è¾ƒæ¸…æ™°çš„ï¼Œå¤šçœ‹å‡ éè¿™ä¸ªä¾‹é¢˜å°±å¯èƒ½æ¸…æ¥šå¤šäº†ã€‚</p><h3 id="è™šåŸºç±»çš„å¤šç»§æ‰¿è¯´æ˜ï¼ˆvs2019ï¼‰"><a href="#è™šåŸºç±»çš„å¤šç»§æ‰¿è¯´æ˜ï¼ˆvs2019ï¼‰" class="headerlink" title="è™šåŸºç±»çš„å¤šç»§æ‰¿è¯´æ˜ï¼ˆvs2019ï¼‰"></a>è™šåŸºç±»çš„å¤šç»§æ‰¿è¯´æ˜ï¼ˆvs2019ï¼‰</h3><p>å¯¹äºä¸€ä¸ªç›´æ¥åŸºç±»Cï¼Œå¦‚æœå…¶ä»–ç›´æ¥åŸºç±»çš„ç¥–å…ˆç±»ä¸­ä¹ŸåŒ…å«Cè¿™ä¸ªç±»ï¼Œåˆ™è¿™2ä¸ªCç±»ä¸èƒ½æ˜¯ä¸€ä¸ªæ˜¯è™šåŸºç±»ã€ä¸€ä¸ªæ˜¯éè™šåŸºç±»ã€‚å¯¹äº class  C: C1, virtual C2ï¼šC2çš„ç¥–å…ˆç±»ä¸­ä¸èƒ½åŒ…å«éè™šçš„åŸºç±»C1ï¼ŒC1çš„ç¥–å…ˆç±»ä¸­ä¸èƒ½åŒ…å«è™šåŸºç±»C2ï¼Œå¦åˆ™æŠ¥é”™ã€‚</p><pre class="line-numbers language-c++"><code class="language-c++">struct  A { };struct  B: A { };struct  C: A { };struct  D: B { };struct  E: A, C { };struct  F: virtual  A, C { };     //é”™ï¼šç›´æ¥åŸºç±»Aæ˜¯è™šçš„ï¼Œè€ŒC::Aéè™šstruct  G: virtual B, D { };     //é”™ï¼šç›´æ¥åŸºç±»Bæ˜¯è™šçš„ï¼Œè€ŒD::Béè™šstruct  H: virtual B, C { };     //å¯¹ï¼šç›´æ¥åŸºç±»Bæ˜¯è™šçš„ï¼ŒCçš„ç»§æ‰¿é“¾ä¸­æ²¡æœ‰éè™šçš„Bstruct   I:  virtual B, E { };     //å¯¹ï¼šEçš„ç¥–å…ˆç±»æ²¡æœ‰Bï¼ŒBçš„ç¥–å…ˆç±»æ²¡æœ‰Estruct   J: virtual C, E { };      //é”™ï¼šEçš„ç¥–å…ˆç±»åŒ…å«éè™šçš„C<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç±»çš„å­˜å‚¨ç©ºé—´"><a href="#ç±»çš„å­˜å‚¨ç©ºé—´" class="headerlink" title="ç±»çš„å­˜å‚¨ç©ºé—´"></a>ç±»çš„å­˜å‚¨ç©ºé—´</h2><p>è¿™é‡Œå°±æ˜¯ç®€å•ä»‹ç»ä¸€ä¸‹ï¼Œåº”è¯¥è¿˜ä¼šå¦å¼€ä¸€ä¸ªåšå®¢æ¥ä»‹ç»è¿™æ®µå†…å®¹ï¼š</p><h3 id="æ´¾ç”Ÿç±»æ— è™šåŸºç±»çš„æƒ…å†µä¸‹"><a href="#æ´¾ç”Ÿç±»æ— è™šåŸºç±»çš„æƒ…å†µä¸‹" class="headerlink" title="æ´¾ç”Ÿç±»æ— è™šåŸºç±»çš„æƒ…å†µä¸‹"></a>æ´¾ç”Ÿç±»æ— è™šåŸºç±»çš„æƒ…å†µä¸‹</h3><ul><li>è‹¥æ´¾ç”Ÿç±»çš„ç¬¬ä¸€ä¸ªåŸºç±»å»ºç«‹äº†è™šå‡½æ•°å…¥å£åœ°å€è¡¨ï¼ˆVFTï¼‰ï¼Œåˆ™æ´¾ç”Ÿç±»å°±å…±ç”¨è¯¥è¡¨é¦–å€æ‰€å ç”¨çš„å­˜å‚¨å•å…ƒï¼›</li><li>è‹¥æ´¾ç”Ÿç±»çš„ç¬¬ä¸€ä¸ªåŸºç±»æ²¡æœ‰å®šä¹‰è™šå‡½æ•°ï¼Œæ´¾ç”Ÿç±»å°±åœ¨å»ºç«‹å®Œæ‰€æœ‰åŸºç±»çš„å­˜å‚¨ç©ºé—´ä¹‹åï¼Œæ ¹æ®æ´¾ç”Ÿç±»ä¸­æ˜¯å¦å®šä¹‰äº†æ–°çš„è™šå‡½æ•°ï¼Œç¡®å®šæ˜¯å¦ä¸ºVFTè¡¨é¦–å€åˆ†é…ä¸€ä¸ªå­˜å‚¨å•å…ƒï¼Œç„¶åä¸ºæ–°å®šä¹‰çš„æ•°æ®æˆå‘˜å»ºç«‹å­˜å‚¨ç©ºé—´ã€‚</li><li>é™æ€æ•°æ®æˆå‘˜ä¸åŒ…æ‹¬åœ¨å†…ã€‚</li></ul><p>ç¬¬9ç« PPTç¬¬20é¡µPPTã€‚</p>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>practice mmdet 3</title>
      <link href="/2021/11/03/practice-mmdet-3/"/>
      <url>/2021/11/03/practice-mmdet-3/</url>
      
        <content type="html"><![CDATA[<h1 id="MMDetectionæ•´ä½“æ„å»ºæµç¨‹æ€æƒ³"><a href="#MMDetectionæ•´ä½“æ„å»ºæµç¨‹æ€æƒ³" class="headerlink" title="MMDetectionæ•´ä½“æ„å»ºæµç¨‹æ€æƒ³"></a><strong>MMDetectionæ•´ä½“æ„å»ºæµç¨‹æ€æƒ³</strong></h1><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><p>all reference(<del>å‡ ä¹å®Œå…¨åŸæ–‡ç…§æŠ„</del>)ï¼š<a href="https://zhuanlan.zhihu.com/p/337375549" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/337375549</a></p></li><li><p>MMDetå®˜æ–¹å­¦ä¹ è·¯çº¿ï¼š<a href="https://zhuanlan.zhihu.com/p/369826931" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/369826931</a></p></li><li><p>æºç åœ°å€: <a href="https://github.com/open-mmlab/mmdetection" target="_blank" rel="noopener">https://github.com/open-mmlab/mmdetection</a></p></li><li><p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://mmdetection.readthedocs.io/en/latest/" target="_blank" rel="noopener">https://mmdetection.readthedocs.io/en/latest/</a></p></li><li><p>MMDetectionå­¦ä¹ è®°å½•ï¼š<a href="https://zhuanlan.zhihu.com/p/256344471" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/256344471</a></p></li><li><p>æºç éƒ¨åˆ†è§£æï¼š<a href="https://nicehuster.github.io/2019/04/08/mmdetection/" target="_blank" rel="noopener">https://nicehuster.github.io/2019/04/08/mmdetection/</a></p></li></ul><p>æœ¬æ–‡å…¨ç¯‡ç…§æŠ„ï¼Œæ‰€ä»¥æˆ‘å»ºè®®è‡ªå·±å…¨ç¯‡èƒŒè¯µğŸ˜ã€‚</p><h2 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a><strong>Preface</strong></h2><p>ç›®å‰æµç¨‹æ€æƒ³éƒ½æœ‰ä»¥ä¸‹æµç¨‹åˆ’åˆ†ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic1.zhimg.com/80/v2-7ecc8e5e19c59a3e6682c5e3cdc34918_720w.jpg" alt="æ•´ä½“æ„å»ºæµç¨‹"></p><p>è®­ç»ƒæ ¸å¿ƒç»„ä»¶ä¸€èˆ¬åŒ…æ‹¬9ä¸ªï¼š</p><ol><li><p>ç‰¹å¾æå–ï¼Œbackboneå±‚ï¼Œä¾‹å¦‚ResNetå±‚</p></li><li><p>ä½†å°ºåº¦æˆ–è€…å¤šå°ºåº¦ç‰¹å¾å›¾è¾“å…¥åˆ°neckæ¨¡å—ä¸­è¿›è¡Œç‰¹å¾èåˆæˆ–è€…å¢å¼ºï¼Œå…¸å‹çš„neckå°±æ˜¯FPNã€‚</p></li><li><p>ä¸€èˆ¬å¤šå°ºåº¦ç‰¹å¾æœ€åéƒ½ä¼šè¾“å…¥åˆ°headéƒ¨åˆ†ä¸€èˆ¬åŒ…æ‹¬åˆ†ç±»å’Œå›å½’åˆ†æ”¯è¾“å‡ºã€‚</p></li><li><p>æ•´ä¸ªç½‘ç»œæ„å»ºé˜¶æ®µéƒ½å¯ä»¥å¼•å…¥ä¸€äº›å³æ’å³ç”¨å¢å¼ºç®—å­æ¥å¢åŠ æå–èƒ½åŠ›ï¼Œä¾‹å¦‚SPPï¼ŒDCNç­‰</p></li><li><p>ç›®æ ‡æ£€æµ‹headè¾“å‡ºä¸€èˆ¬æ˜¯ç‰¹å¾å›¾ï¼Œå¯¹äºåˆ†ç±»ä»»åŠ¡å­˜åœ¨ä¸¥é‡çš„æ­£è´Ÿæ ·æœ¬ä¸å¹³è¡¡ï¼Œå¯ä»¥é€šè¿‡æ­£è´Ÿæ ·æœ¬å±æ€§åˆ†é…å’Œé‡‡æ ·æ§åˆ¶</p></li><li><p>ä¸ºäº†æ–¹ä¾¿æ”¶æ•›å’Œå¹³è¡¡å¤šåˆ†æ”¯ï¼Œä¸€èˆ¬éƒ½ä¼šå¯¹gt bboxè¿›è¡Œç¼–ç ã€‚</p></li><li><p>æœ€åä¸€æ­¥æ˜¯è®¡ç®—åˆ†ç±»å’Œå›å½’lossï¼Œè¿›è¡Œè®­ç»ƒ</p></li><li><p>è®­ç»ƒè¿‡ç¨‹ä¸­ä¹ŸåŒ…æ‹¬éå¸¸å¤šçš„trick,ä¾‹å¦‚ä¼˜åŒ–å™¨é€‰æ‹©ï¼Œå‚æ•°è°ƒèŠ‚ç­‰ã€‚</p></li></ol><p>ä½†æ˜¯ä»¥ä¸Š9ä¸ªç»„ä»¶ä¸æ˜¯æ¯ä¸€ä¸ªç®—æ³•éƒ½éœ€è¦çš„ã€‚</p><h2 id="Backbone"><a href="#Backbone" class="headerlink" title="Backbone"></a><strong>Backbone</strong></h2><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic2.zhimg.com/80/v2-cdee2bd9f289d650ddbcbd748c4be0f9_720w.jpg" alt></p><p>backboneä½œç”¨ä¸»è¦æ˜¯ç‰¹å¾æå–ï¼Œç›®å‰MMDetectiohnå·²ç»é›†æˆäº†å¤§éƒ¨åˆ†éª¨æ¶ç½‘ç»œï¼Œå¯ä»¥çœ‹ä¸€ä¸‹<code>mmdet/models/backbones</code></p><p>å¯ä»¥çœ‹åˆ°æœ‰ï¼š</p><pre class="line-numbers language-python"><code class="language-python">__all__ <span class="token operator">=</span> <span class="token punctuation">[</span>  <span class="token string">'RegNet'</span><span class="token punctuation">,</span> <span class="token string">'ResNet'</span><span class="token punctuation">,</span> <span class="token string">'ResNetV1d'</span><span class="token punctuation">,</span> <span class="token string">'ResNeXt'</span><span class="token punctuation">,</span> <span class="token string">'SSDVGG'</span><span class="token punctuation">,</span> <span class="token string">'HRNet'</span><span class="token punctuation">,</span>  <span class="token string">'MobileNetV2'</span><span class="token punctuation">,</span> <span class="token string">'Res2Net'</span><span class="token punctuation">,</span> <span class="token string">'HourglassNet'</span><span class="token punctuation">,</span> <span class="token string">'DetectoRS_ResNet'</span><span class="token punctuation">,</span>  <span class="token string">'DetectoRS_ResNeXt'</span><span class="token punctuation">,</span> <span class="token string">'Darknet'</span><span class="token punctuation">,</span> <span class="token string">'ResNeSt'</span><span class="token punctuation">,</span> <span class="token string">'TridentResNet'</span><span class="token punctuation">,</span> <span class="token string">'CSPDarknet'</span><span class="token punctuation">,</span>  <span class="token string">'SwinTransformer'</span><span class="token punctuation">,</span> <span class="token string">'PyramidVisionTransformer'</span><span class="token punctuation">,</span> <span class="token string">'PyramidVisionTransformerV2'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€å¸¸ç”¨çš„è¿˜æ˜¯ResNetç³»åˆ—ï¼ŒResNetV1dç³»åˆ—å’ŒRes2Netç³»åˆ—ã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦å¯¹éª¨æ¶è¿›è¡Œæ‰©å±•ï¼Œæˆ‘ä»¬å¯ä»¥ç»§æ‰¿ä¸Šè¿°ç½‘ç»œï¼Œç„¶åé€šè¿‡æ³¨å†Œå™¨æœºåˆ¶ï¼ˆä¹Ÿå°±æ˜¯è¯»æºç é‡åˆ°çš„rigistryï¼‰æ³¨å†Œä½¿ç”¨ã€‚ä¸€ä¸ªå…¸å‹çš„ç”¨æ³•æ˜¯ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># éª¨æ¶çš„é¢„è®­ç»ƒæƒé‡è·¯å¾„</span>pretrained<span class="token operator">=</span><span class="token string">'torchvision://resnet50'</span><span class="token punctuation">,</span>backbone<span class="token operator">=</span>dict<span class="token punctuation">(</span>  type<span class="token operator">=</span><span class="token string">'ResNet'</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># éª¨æ¶ç±»åï¼Œåé¢çš„å‚æ•°éƒ½æ˜¯è¯¥ç±»çš„åˆå§‹åŒ–å‚æ•°</span>  depth<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span>  num_stages<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>  out_indices<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  frozen_stages<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>  norm_cfg<span class="token operator">=</span>dict<span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token string">'BN'</span><span class="token punctuation">,</span> requires_grad<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>   norm_eval<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>  style<span class="token operator">=</span><span class="token string">'pytorch'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡MMCVçš„æ³¨å†Œå™¨æœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡dictå½¢å¼é…ç½®æ¥å®ä¾‹åŒ–ä»»ä½•å·²ç»æ³¨å†Œçš„ç±»ï¼Œéå¸¸æ–¹ä¾¿å’Œçµæ´»ã€‚</p><h2 id="Neck"><a href="#Neck" class="headerlink" title="Neck"></a><strong>Neck</strong></h2><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic1.zhimg.com/80/v2-f0975c00a32fa03a80860f9c09234bbc_720w.jpg" alt></p><p>neckå¯ä»¥è®¤ä¸ºæ˜¯backboneå’Œheadçš„è¿æ¥å±‚ï¼Œä¸»è¦è´Ÿè´£å¯¹backboneçš„ç‰¹å¾è¿›è¡Œé«˜æ•ˆèåˆå’Œå¢å¼ºï¼Œèƒ½å¤Ÿå¯¹è¾“å…¥çš„ä½†å°ºåº¦æˆ–è€…å¤šå°ºåº¦ç‰¹å¾è¿›è¡Œèåˆã€å¢å¼ºè¾“å‡ºç­‰ã€‚æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹æ–‡ä»¶<code>mmdet/models/necks</code></p><pre class="line-numbers language-python"><code class="language-python">__all__ <span class="token operator">=</span> <span class="token punctuation">[</span>  <span class="token string">'FPN'</span><span class="token punctuation">,</span> <span class="token string">'BFP'</span><span class="token punctuation">,</span> <span class="token string">'ChannelMapper'</span><span class="token punctuation">,</span> <span class="token string">'HRFPN'</span><span class="token punctuation">,</span> <span class="token string">'NASFPN'</span><span class="token punctuation">,</span> <span class="token string">'FPN_CARAFE'</span><span class="token punctuation">,</span> <span class="token string">'PAFPN'</span><span class="token punctuation">,</span>  <span class="token string">'NASFCOS_FPN'</span><span class="token punctuation">,</span> <span class="token string">'RFP'</span><span class="token punctuation">,</span> <span class="token string">'YOLOV3Neck'</span><span class="token punctuation">,</span> <span class="token string">'FPG'</span><span class="token punctuation">,</span> <span class="token string">'DilatedEncoder'</span><span class="token punctuation">,</span>  <span class="token string">'CTResNetNeck'</span><span class="token punctuation">,</span> <span class="token string">'SSDNeck'</span><span class="token punctuation">,</span> <span class="token string">'YOLOXPAFPN'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªæœ€å¸¸ç”¨çš„åº”è¯¥æ˜¯FPNï¼Œä¸€ä¸ªå…¸å‹çš„ç”¨æ³•ä¸ºï¼š</p><pre class="line-numbers language-python"><code class="language-python">neck<span class="token operator">=</span>dict<span class="token punctuation">(</span>  type<span class="token operator">=</span><span class="token string">'FPN'</span><span class="token punctuation">,</span>  in_channels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token number">2048</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># éª¨æ¶å¤šå°ºåº¦ç‰¹å¾å›¾è¾“å‡ºé€šé“</span>  out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># å¢å¼ºåé€šé“è¾“å‡º</span>  num_outs<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># è¾“å‡ºnum_outsä¸ªå¤šå°ºåº¦ç‰¹å¾å›¾</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Head"><a href="#Head" class="headerlink" title="Head"></a><strong>Head</strong></h2><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic2.zhimg.com/80/v2-fdd9a6232e62c75b143153dab8ba9bc1_720w.jpg" alt></p><p>ç›®æ ‡æ£€æµ‹ç®—æ³•è¾“å‡ºä¸€èˆ¬åŒ…æ‹¬åˆ†ç±»å’Œæ¡†åæ ‡å›å½’ä¸¤ä¸ªåˆ†æ”¯ï¼Œä¸åŒç®—æ³•headæ¨¡å—å¤æ‚ç¨‹åº¦ä¸ä¸€æ ·ï¼Œçµæ´»åº¦æ¯”è¾ƒé«˜ã€‚åœ¨ç½‘ç»œæ„å»ºæ–¹é¢ï¼Œç†è§£ç›®æ ‡æ£€æµ‹ç®—æ³•ä¸»è¦æ˜¯è¦ç†è§£headæ¨¡å—ã€‚</p><p>MMDetectionä¸­headæ¨¡å—åˆåˆ’åˆ†ä¸ºtwo-stageæ‰€éœ€çš„ROIHEADå’Œone-stageæ‰€éœ€çš„DenseHead,ä¹Ÿå°±æ˜¯è¯´æ‰€æœ‰çš„one-stageç®—æ³•çš„headæ¨¡å—éƒ½åœ¨<code>mmdet/models/dense_heads</code>ä¸­ï¼Œè€Œtwo-stageç®—æ³•è¿˜åŒ…æ‹¬é¢å¤–çš„<code>mmdet/models/roi_heads</code>.</p><p>ç›®å‰å·²ç»å®ç°çš„dense_headsåŒ…æ‹¬</p><pre class="line-numbers language-python"><code class="language-python">__all__ <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token string">'AnchorFreeHead'</span><span class="token punctuation">,</span> <span class="token string">'AnchorHead'</span><span class="token punctuation">,</span> <span class="token string">'GuidedAnchorHead'</span><span class="token punctuation">,</span> <span class="token string">'FeatureAdaption'</span><span class="token punctuation">,</span>    <span class="token string">'RPNHead'</span><span class="token punctuation">,</span> <span class="token string">'GARPNHead'</span><span class="token punctuation">,</span> <span class="token string">'RetinaHead'</span><span class="token punctuation">,</span> <span class="token string">'RetinaSepBNHead'</span><span class="token punctuation">,</span> <span class="token string">'GARetinaHead'</span><span class="token punctuation">,</span>    <span class="token string">'SSDHead'</span><span class="token punctuation">,</span> <span class="token string">'FCOSHead'</span><span class="token punctuation">,</span> <span class="token string">'RepPointsHead'</span><span class="token punctuation">,</span> <span class="token string">'FoveaHead'</span><span class="token punctuation">,</span>    <span class="token string">'FreeAnchorRetinaHead'</span><span class="token punctuation">,</span> <span class="token string">'ATSSHead'</span><span class="token punctuation">,</span> <span class="token string">'FSAFHead'</span><span class="token punctuation">,</span> <span class="token string">'NASFCOSHead'</span><span class="token punctuation">,</span>    <span class="token string">'PISARetinaHead'</span><span class="token punctuation">,</span> <span class="token string">'PISASSDHead'</span><span class="token punctuation">,</span> <span class="token string">'GFLHead'</span><span class="token punctuation">,</span> <span class="token string">'CornerHead'</span><span class="token punctuation">,</span> <span class="token string">'YOLACTHead'</span><span class="token punctuation">,</span>    <span class="token string">'YOLACTSegmHead'</span><span class="token punctuation">,</span> <span class="token string">'YOLACTProtonet'</span><span class="token punctuation">,</span> <span class="token string">'YOLOV3Head'</span><span class="token punctuation">,</span> <span class="token string">'PAAHead'</span><span class="token punctuation">,</span>    <span class="token string">'SABLRetinaHead'</span><span class="token punctuation">,</span> <span class="token string">'CentripetalHead'</span><span class="token punctuation">,</span> <span class="token string">'VFNetHead'</span><span class="token punctuation">,</span> <span class="token string">'StageCascadeRPNHead'</span><span class="token punctuation">,</span>    <span class="token string">'CascadeRPNHead'</span><span class="token punctuation">,</span> <span class="token string">'EmbeddingRPNHead'</span><span class="token punctuation">,</span> <span class="token string">'LDHead'</span><span class="token punctuation">,</span> <span class="token string">'CascadeRPNHead'</span><span class="token punctuation">,</span>    <span class="token string">'AutoAssignHead'</span><span class="token punctuation">,</span> <span class="token string">'DETRHead'</span><span class="token punctuation">,</span> <span class="token string">'YOLOFHead'</span><span class="token punctuation">,</span> <span class="token string">'DeformableDETRHead'</span><span class="token punctuation">,</span>    <span class="token string">'SOLOHead'</span><span class="token punctuation">,</span> <span class="token string">'DecoupledSOLOHead'</span><span class="token punctuation">,</span> <span class="token string">'CenterNetHead'</span><span class="token punctuation">,</span> <span class="token string">'YOLOXHead'</span><span class="token punctuation">,</span>    <span class="token string">'DecoupledSOLOLightHead'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‡ ä¹æ¯ä¸€ä¸ªç®—æ³•éƒ½åŒ…æ‹¬ä¸€ä¸ªç‹¬ç«‹çš„head,è€Œroi_headsæ¯”è¾ƒæ‚ï¼Œç®€å•åˆ—ä¸€ä¸‹<code>__init__.py</code>æ–‡ä»¶é‡Œçš„è¯ï¼Œéƒ½æœ‰ï¼š</p><pre class="line-numbers language-python"><code class="language-python">__all__ <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token string">'BaseRoIHead'</span><span class="token punctuation">,</span> <span class="token string">'CascadeRoIHead'</span><span class="token punctuation">,</span> <span class="token string">'DoubleHeadRoIHead'</span><span class="token punctuation">,</span> <span class="token string">'MaskScoringRoIHead'</span><span class="token punctuation">,</span>    <span class="token string">'HybridTaskCascadeRoIHead'</span><span class="token punctuation">,</span> <span class="token string">'GridRoIHead'</span><span class="token punctuation">,</span> <span class="token string">'ResLayer'</span><span class="token punctuation">,</span> <span class="token string">'BBoxHead'</span><span class="token punctuation">,</span>    <span class="token string">'ConvFCBBoxHead'</span><span class="token punctuation">,</span> <span class="token string">'DIIHead'</span><span class="token punctuation">,</span> <span class="token string">'SABLHead'</span><span class="token punctuation">,</span> <span class="token string">'Shared2FCBBoxHead'</span><span class="token punctuation">,</span>    <span class="token string">'StandardRoIHead'</span><span class="token punctuation">,</span> <span class="token string">'Shared4Conv1FCBBoxHead'</span><span class="token punctuation">,</span> <span class="token string">'DoubleConvFCBBoxHead'</span><span class="token punctuation">,</span>    <span class="token string">'FCNMaskHead'</span><span class="token punctuation">,</span> <span class="token string">'HTCMaskHead'</span><span class="token punctuation">,</span> <span class="token string">'FusedSemanticHead'</span><span class="token punctuation">,</span> <span class="token string">'GridHead'</span><span class="token punctuation">,</span>    <span class="token string">'MaskIoUHead'</span><span class="token punctuation">,</span> <span class="token string">'BaseRoIExtractor'</span><span class="token punctuation">,</span> <span class="token string">'GenericRoIExtractor'</span><span class="token punctuation">,</span>    <span class="token string">'SingleRoIExtractor'</span><span class="token punctuation">,</span> <span class="token string">'PISARoIHead'</span><span class="token punctuation">,</span> <span class="token string">'PointRendRoIHead'</span><span class="token punctuation">,</span> <span class="token string">'MaskPointHead'</span><span class="token punctuation">,</span>    <span class="token string">'CoarseMaskHead'</span><span class="token punctuation">,</span> <span class="token string">'DynamicRoIHead'</span><span class="token punctuation">,</span> <span class="token string">'SparseRoIHead'</span><span class="token punctuation">,</span> <span class="token string">'TridentRoIHead'</span><span class="token punctuation">,</span>    <span class="token string">'SCNetRoIHead'</span><span class="token punctuation">,</span> <span class="token string">'SCNetMaskHead'</span><span class="token punctuation">,</span> <span class="token string">'SCNetSemanticHead'</span><span class="token punctuation">,</span> <span class="token string">'SCNetBBoxHead'</span><span class="token punctuation">,</span>    <span class="token string">'FeatureRelayHead'</span><span class="token punctuation">,</span> <span class="token string">'GlobalContextHead'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œtwo-stageæˆ–è€…multi-stageç®—æ³•ï¼Œä¼šé¢å¤–åŒ…æ‹¬ä¸€ä¸ªåŒºåŸŸæå–å™¨roi extractor,ç”¨äºå°†ä¸åŒå¤§å°çš„RoIç‰¹å¾å›¾ç»Ÿä¸€æˆç›¸åŒå¤§å°ã€‚</p><p>è™½ç„¶headéƒ¨åˆ†çš„ç½‘ç»œæ„å»ºæ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯ç”±äºæ­£è´Ÿæ ·æœ¬å±æ€§å®šä¹‰ã€æ­£è´Ÿæ ·æœ¬é‡‡æ ·å’Œbboxç¼–è§£ç æ¨¡å—éƒ½åœ¨headæ¨¡å—ä¸­è¿›è¡Œç»„åˆè°ƒç”¨ï¼Œ<strong>æ•…MMDetectionä¸­æœ€å¤æ‚çš„æ¨¡å—å°±æ˜¯head</strong></p><h2 id="Enhance"><a href="#Enhance" class="headerlink" title="Enhance"></a><strong>Enhance</strong></h2><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic3.zhimg.com/80/v2-65a706efe224f0b7ffc7f4fd7a65f2ca_720w.jpg" alt></p><p>enhanceæ˜¯å³æ’å³ç”¨ã€èƒ½å¤Ÿå¯¹ç‰¹å¾è¿›è¡Œå¢å¼ºçš„æ¨¡å—ï¼Œå…¶å…·ä½“ä»£ç å¯ä»¥é€šè¿‡ dict å½¢å¼æ³¨å†Œåˆ° backboneã€neck å’Œ head ä¸­ï¼Œéå¸¸æ–¹ä¾¿(ç›®å‰è¿˜ä¸å®Œå–„)ã€‚å¸¸ç”¨çš„ enhance æ¨¡å—æ˜¯ SPPã€ASPPã€RFBã€Dropoutã€Dropblockã€DCN å’Œå„ç§æ³¨æ„åŠ›æ¨¡å— SeNetã€Non_Localã€CBA ç­‰ã€‚ç›®å‰ MMDetection ä¸­éƒ¨åˆ†æ¨¡å—æ”¯æŒ enhance çš„æ¥å…¥ï¼Œä¾‹å¦‚ ResNet éª¨æ¶ä¸­çš„ pluginsï¼Œè¿™ä¸ªéƒ¨åˆ†çš„è§£è¯»æ”¾åœ¨å…·ä½“ç®—æ³•æ¨¡å—ä¸­è®²è§£ã€‚</p><h2 id="BBox-Assigner"><a href="#BBox-Assigner" class="headerlink" title="BBox Assigner"></a><strong>BBox Assigner</strong></h2><p>æ­£è´Ÿæ ·æœ¬å±æ€§åˆ†é…æ¨¡å—ä½œç”¨æ˜¯è¿›è¡Œæ­£è´Ÿæ ·æœ¬å®šä¹‰æˆ–è€…æ­£è´Ÿæ ·æœ¬åˆ†é…ï¼ˆå¯èƒ½ä¹ŸåŒ…æ‹¬å¿½ç•¥æ ·æœ¬å®šä¹‰ï¼‰ï¼Œæ­£æ ·æœ¬å°±æ˜¯å¸¸è¯´çš„å‰æ™¯æ ·æœ¬ï¼ˆå¯ä»¥æ˜¯ä»»ä½•ç±»åˆ«ï¼‰ï¼Œè´Ÿæ ·æœ¬å°±æ˜¯èƒŒæ™¯æ ·æœ¬ã€‚å› ä¸ºç›®æ ‡æ£€æµ‹æ˜¯ä¸€ä¸ªåŒæ—¶è¿›è¡Œåˆ†ç±»å’Œå›å½’çš„é—®é¢˜ï¼Œå¯¹äºåˆ†ç±»åœºæ™¯å¿…ç„¶éœ€è¦ç¡®å®šæ­£è´Ÿæ ·æœ¬ï¼Œå¦åˆ™æ— æ³•è®­ç»ƒã€‚è¯¥æ¨¡å—è‡³å…³é‡è¦ï¼Œä¸åŒçš„æ­£è´Ÿæ ·æœ¬åˆ†é…ç­–ç•¥ä¼šå¸¦æ¥æ˜¾è‘—çš„æ€§èƒ½å·®å¼‚ï¼Œç›®å‰å¤§éƒ¨åˆ†ç›®æ ‡æ£€æµ‹ç®—æ³•éƒ½ä¼šå¯¹è¿™ä¸ªéƒ¨åˆ†è¿›è¡Œæ”¹è¿›ï¼Œè‡³å…³é‡è¦ã€‚ä¸€äº›å…¸å‹çš„åˆ†é…ç­–ç•¥å¦‚ä¸‹ï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic3.zhimg.com/v2-12bae70e2ea2e4afb05d0d8d3f38ca56_r.jpg" alt></p><p>å¯¹åº”çš„ä»£ç åœ¨<code>mmdet/core/bbox/assigners</code>ä¸­,ä¸»è¦åŒ…æ‹¬</p><pre class="line-numbers language-python"><code class="language-python">__all__ <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token string">'BaseAssigner'</span><span class="token punctuation">,</span> <span class="token string">'MaxIoUAssigner'</span><span class="token punctuation">,</span> <span class="token string">'ApproxMaxIoUAssigner'</span><span class="token punctuation">,</span> <span class="token string">'AssignResult'</span><span class="token punctuation">,</span>    <span class="token string">'PointAssigner'</span><span class="token punctuation">,</span> <span class="token string">'ATSSAssigner'</span><span class="token punctuation">,</span> <span class="token string">'CenterRegionAssigner'</span><span class="token punctuation">,</span> <span class="token string">'GridAssigner'</span><span class="token punctuation">,</span>    <span class="token string">'HungarianAssigner'</span><span class="token punctuation">,</span> <span class="token string">'RegionAssigner'</span><span class="token punctuation">,</span> <span class="token string">'UniformAssigner'</span><span class="token punctuation">,</span> <span class="token string">'SimOTAAssigner'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="BBox-Sampler"><a href="#BBox-Sampler" class="headerlink" title="BBox Sampler"></a><strong>BBox Sampler</strong></h2><p>åœ¨ç¡®å®šæ¯ä¸ªæ ·æœ¬çš„æ­£è´Ÿå±æ€§åï¼Œå¯èƒ½è¿˜éœ€è¦è¿›è¡Œæ ·æœ¬å¹³è¡¡æ“ä½œã€‚æœ¬æ¨¡å—ä½œç”¨æ˜¯å¯¹å‰é¢å®šä¹‰çš„æ­£è´Ÿæ ·æœ¬ä¸å¹³è¡¡è¿›è¡Œé‡‡æ ·ï¼ŒåŠ›äº‰å…‹æœè¯¥é—®é¢˜ã€‚ä¸€èˆ¬åœ¨ç›®æ ‡æ£€æµ‹ä¸­ gt bbox éƒ½æ˜¯éå¸¸å°‘çš„ï¼Œæ‰€ä»¥æ­£è´Ÿæ ·æœ¬æ¯”æ˜¯è¿œè¿œå°äº 1 çš„ã€‚è€ŒåŸºäºæœºå™¨å­¦ä¹ è§‚ç‚¹ï¼šåœ¨æ•°æ®æåº¦ä¸å¹³è¡¡æƒ…å†µä¸‹è¿›è¡Œåˆ†ç±»ä¼šå‡ºç°é¢„æµ‹å€¾å‘äºæ ·æœ¬å¤šçš„ç±»åˆ«ï¼Œå‡ºç°è¿‡æ‹Ÿåˆï¼Œä¸ºäº†å…‹æœè¯¥é—®é¢˜ï¼Œé€‚å½“çš„æ­£è´Ÿæ ·æœ¬é‡‡æ ·ç­–ç•¥æ˜¯éå¸¸å¿…è¦çš„ï¼Œä¸€äº›å…¸å‹é‡‡æ ·ç­–ç•¥å¦‚ä¸‹ï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic4.zhimg.com/80/v2-91674a0710afadfd06a9ebd139f875fb_720w.jpg" alt></p><p>å¯¹åº”ä»£ç åœ¨<code>mmdet/core/bbox/samplers</code>ä¸­ï¼Œä¸»è¦æœ‰ï¼š</p><pre class="line-numbers language-python"><code class="language-python">__all__ <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token string">'BaseSampler'</span><span class="token punctuation">,</span> <span class="token string">'PseudoSampler'</span><span class="token punctuation">,</span> <span class="token string">'RandomSampler'</span><span class="token punctuation">,</span>    <span class="token string">'InstanceBalancedPosSampler'</span><span class="token punctuation">,</span> <span class="token string">'IoUBalancedNegSampler'</span><span class="token punctuation">,</span> <span class="token string">'CombinedSampler'</span><span class="token punctuation">,</span>    <span class="token string">'OHEMSampler'</span><span class="token punctuation">,</span> <span class="token string">'SamplingResult'</span><span class="token punctuation">,</span> <span class="token string">'ScoreHLRSampler'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> ç›®æ ‡æ£€æµ‹ </tag>
            
            <tag> CV </tag>
            
            <tag> æºç é˜…è¯» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>YOLOv3è®ºæ–‡ç²¾è¯»</title>
      <link href="/2021/10/27/yolov3-lun-wen-jing-du/"/>
      <url>/2021/10/27/yolov3-lun-wen-jing-du/</url>
      
        <content type="html"><![CDATA[<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><blockquote><p>è®ºæ–‡åœ°å€ï¼š<a href="https://arxiv.org/abs/1804.02767" target="_blank" rel="noopener">https://arxiv.org/abs/1804.02767</a></p><p>å‚è€ƒåšæ–‡ï¼š<a href="https://towardsdatascience.com/yolo-v3-object-detection-53fb7d3bfe6b" target="_blank" rel="noopener">https://towardsdatascience.com/yolo-v3-object-detection-53fb7d3bfe6b</a></p></blockquote><p>å°½ç®¡YOLOv3æ®è¯´æ˜¯å†™å¾—æœ€çƒ‚çš„ä¸€ç¯‡è®ºæ–‡ä¹‹ä¸€ï¼ˆå¹¶ä¸æ˜¯è¯´å†…å®¹çƒ‚ï¼Œåªæ˜¯æ–‡ç« å†™çš„å¤ªéšä¾¿äº† ï¼‰ä½†æ˜¯è¿™é‡Œé¢çš„å†…å®¹è¿˜æ˜¯å€¼å¾—ä¸€è¯»çš„ã€‚å°½ç®¡<del>æˆ‘çœ‹è¿™ä¸€ç¯‡ è®ºæ–‡å°±è·Ÿä¸€ç¯‡åšå®¢ä¼¼çš„ã€‚ã€‚ã€‚</del></p><p>æ–‡ç« è™½ç„¶åºŸè¯éå¸¸å¤šï¼Œä½†æ˜¯è¿™äº›åºŸè¯åªæ˜¯å¯¹äºAIè¡Œä¸šçš„å‘å±•ä¸è¿›æ­¥æ²¡æœ‰ç”¨ï¼Œå¯¹äºæˆ‘ä»¬å­¦ä¹ è¿˜æ˜¯å¾ˆæœ‰ç”¨çš„ ã€‚</p><p>YOLO9000åˆšå‡ºçš„æ—¶å€™(16å¹´)ï¼Œä»–æ˜¯æœ€å¿«çš„ï¼Œä¹Ÿæ˜¯æœ€ç²¾ç¡®çš„ä¹‹ä¸€ã€‚ä½†æ˜¯åˆ°18å¹´çš„æ—¶å€™ï¼Œ ä»–å·²ç»ä¸å†æ˜¯æœ€ç²¾ç¡®é‚£ä¸ªæ¢¯é˜Ÿé‡Œé¢çš„äº†ï¼ŒåƒRetinaNet, SSD,åœ¨ç²¾ç¡®åº¦(acuracy)ä¸Šéƒ½æ¯”ä»–å¥½å¾ˆå¤šï¼Œä¸è¿‡YOLO9000ä»ç„¶æ˜¯æœ€å¿«çš„ã€‚</p><p>è€ŒYOLOv3å°±ç›¸å½“äºæ˜¯ä¸€ä¸ªé€Ÿåº¦ä¸ç²¾ç¡®åº¦çš„ä¸€ä¸ªå¹³è¡¡ï¼ˆtradeoffï¼‰ï¼Œè™½ç„¶ä¸å¦‚ä¹‹å‰çš„v2å¿«äº†ï¼Œä½†æ˜¯å‡†ç¡®ç‡å´å¢åŠ äº†è®¸å¤šã€‚</p><p><em>But that speed has been traded off for boosts in accuracy in YOLO v3. While the earlier variant ran on 45 FPS on a Titan X, the current version clocks about 30 FPS. This has to do with the increase in *</em>complexity of underlying architecture called Darknet.***</p><p>è¿™é‡Œå…·ä½“åˆ—ä¸€ä¸‹ä¸»è¦çš„æ”¹è¿›éƒ¨åˆ†ï¼š</p><ul><li>Darknet-53</li><li>Detection ata three Scales</li><li>Better at detecting smaller objects</li><li>Changes in Loss Function</li><li>No more softmaxing the classes</li><li></li></ul><h1 id="Darknet-53"><a href="#Darknet-53" class="headerlink" title="Darknet-53"></a>Darknet-53</h1><p>åŸºäºæ­¤ä¹‹å‰æˆ‘ä»¬å…ˆå›é¡¾ä¸‹YOLOv2çš„Darknet-19:</p><p>YOLOv2ä½¿ç”¨çš„æ˜¯Darknet-19, è¿™ä¸ªæ˜¯ç”±äºä½œè€…å½“æ—¶è§‰å¾—VGGå¼æå–ç‰¹å¾å¤ªè€—è´¹ç®—åŠ›äº†ï¼Œå°±è‡ªå·±è®¾è®¡äº†ä¸€ä¸ªç½‘ç»œã€‚</p><p>Darknet-19æ˜¯ä¸€ä¸ª19å±‚çš„ç½‘ç»œç”¨äºåˆ†ç±»å¦å¤–åŠ äº†11å±‚ç”¨äºç›®æ ‡æ£€æµ‹ã€‚ä¸è¿‡YOLOv2ç¼ºç‚¹åœ¨é¢„æµ‹æ¯”è¾ƒå°çš„ç‰©ä½“ä¸Šæ¯”è¾ƒæœ‰ç¼ºé™·ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬çš„ç²’åº¦ç‰¹å¾è¢«å‹ç¼©çš„å¤ªå°äº†ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒYOLOv2å½“æ—¶é€‰æ‹©äº†concatenateä¸Šä¸€ä¸ªå±‚çš„feature mapã€‚æ¥å¾—åˆ°ä½å±‚æ¬¡çš„ç‰¹å¾ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒYOLOv2è¿˜ç¼ºäº†ä¸€äº›åœ¨ç›®å‰ç›®æ ‡æ£€æµ‹ä¸Šéå¸¸é‡è¦çš„trickï¼Œæ²¡æœ‰residual blocks,æ²¡æœ‰skip connections ä»¥åŠæ²¡æœ‰upsampling.YOLOv3å¼¥è¡¥äº†è¿™ä¹ˆäº›ç¼ºé™·ã€‚</p><p>First, YOLO v3 uses a variant of Darknet, which originally has 53 layer network trained on Imagenet. For the task of detection, 53 more layers are stacked onto it, giving us a <strong>106 layer fully convolutional underlying architecture for YOLO v3</strong>. This is the reason behind the slowness of YOLO v3 compared to YOLO v2. Here is how the architecture of YOLO now looks like.</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211028193240.png" alt></p><h1 id="Detection-at-three-Scales"><a href="#Detection-at-three-Scales" class="headerlink" title="Detection at three Scales"></a>Detection at three Scales</h1><p>æ–°çš„ç½‘ç»œç»“æ„åŠ äº†ä¸Šé‡‡æ ·å’Œskip connectionsã€‚v3æœ€é‡è¦çš„ä¸€ç‚¹å°±æ˜¯åœ¨3ä¸ªä¸åŒçš„å°ºåº¦ä¸Šåšæ£€æµ‹ã€‚åˆ†åˆ«ç”¨æ¥åšå°ç›®æ ‡ã€ä¸­ç›®æ ‡ã€å¤§ç›®æ ‡çš„æ£€æµ‹ã€‚</p><p>åˆ†åˆ«å°†æˆ‘ä»¬çš„ç‰¹å¾é™ç»´32ã€16ã€8å€ã€‚ç¬¬ä¸€ä¸ªæ£€æµ‹ç”¨æ¥åœ¨ç¬¬82å±‚å¼€å§‹æ£€æµ‹ï¼Œå‰81å±‚å°†æˆ‘ä»¬çš„ç½‘ç»œä¸‹é‡‡æ ·32å€ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†13Ã—13å¤§å°çš„å›¾ç‰‡ã€‚æ£€æµ‹æ—¶ç”¨çš„æ˜¯1Ã—1çš„kernelï¼Œå°†æœ€ç»ˆç»“æœå˜ä¸º13Ã—13Ã—255.</p><p>ç„¶åç¬¬äºŒä¸ªæ£€æµ‹åœ¨ç¬¬94å±‚å¼€å§‹ï¼Œé¦–å…ˆç¬¬79å±‚çš„feature mapç»è¿‡ä¸€äº›å·ç§¯å±‚ä¹‹åé€šè¿‡ä¸Šé‡‡æ ·å±‚Ã—2å˜ä¸ºäº†26Ã—26çš„shapeï¼Œç„¶åè¯¥ç‰¹å¾å’Œç¬¬61å±‚çš„feature map concatenateèµ·æ¥ï¼Œæœ€åä»ç„¶æ˜¯é€šè¿‡1Ã—1å·ç§¯å±‚æ¥æœ€åå¾—åˆ°26Ã—26Ã—255.</p><p>æœ€åä¸€ä¸ªæ£€æµ‹ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œç¬¬91å±‚çš„ ç‰¹å¾ç»è¿‡ä¸€äº›å·ç§¯å±‚åå†é€šè¿‡ä¸Šé‡‡æ ·å¾—åˆ°ä¸€ä¸ª52Ã—52çš„ä¸€ä¸ªtensor,æ¥ç€å’Œç¬¬36å±‚çš„ç‰¹å¾è¿›è¡Œä¸€ä¸ªconcatenate, æœ€åé€šè¿‡1Ã—1çš„å·ç§¯å±‚æœ€åå¾—åˆ°æˆ‘ä»¬çš„52Ã—52Ã—255çš„ç‰¹å¾ã€‚</p><p>æˆ‘ä»¬å¯ä»¥è®¤ä¸ºè¿™ä¸‰ä¸ªä¸åŒçš„æ£€æµ‹å™¨ç”¨æ¥æ£€æµ‹3ç§ä¸åŒå°ºåº¦çš„ç‰¹å¾ã€‚</p><p>è¿™é‡Œè§£é‡Šä¸€ä¸‹255æ€ä¹ˆæ¥å¾—ï¼Œ255 = B Ã— ï¼ˆ5 + Cï¼‰ï¼Œ è¿™é‡ŒB=3ï¼ŒC=80. å°±è§£é‡Šåˆ°è¿™é‡Œã€‚</p><h1 id="More-bounding-boxes-per-image"><a href="#More-bounding-boxes-per-image" class="headerlink" title="More bounding boxes per image"></a>More bounding boxes per image</h1><p>å¯¹äºYOLOv2æ¥è¯´ï¼Œæ¯ä¸€å¼ 416Ã—416çš„å›¾ç‰‡ï¼Œéƒ½ä¼šæœ‰13Ã—13Ã—5=845ä¸ªanchor boxesã€‚</p><p>å¯¹äºYOLOv3æ¥è¯´ï¼Œé¢„æµ‹çš„anchor boxesæœ‰13Ã—13Ã—3 Ã— ï¼ˆ1+4+16ï¼‰ = 10647ä¸ªboxesã€‚</p><p>æ‰€ä»¥å¾ˆæ˜æ˜¾ï¼Œv3å¤šäº†10å‡ å€çš„é¢„æµ‹æ¡†ï¼Œæ‰€ä»¥ç»“æœå°±æ˜¯é€Ÿåº¦ä¼šå˜å¾—æ›´æ…¢ã€‚</p><h1 id="Changes-in-Loss-Function"><a href="#Changes-in-Loss-Function" class="headerlink" title="Changes in Loss Function"></a>Changes in Loss Function</h1><p>I know this is intimidating, but notice the last three terms. Of them, the first one penalizes the objectness score prediction for bounding boxes responsible for predicting objects (the scores for these should ideally be 1), the second one for bounding boxes having no objects, (the scores should ideally be zero), and the last one penalises the class prediction for the bounding box which predicts the objects.</p><p>The last three terms in YOLO v2 are the squared errors, whereas in YOLO v3, theyâ€™ve been replaced by cross-entropy error terms. In other words, <strong>object confidence and class predictions in YOLO v3 are now predicted through logistic regression.</strong></p><p>While we are training the detector, for each ground truth box, we assign a bounding box, whose anchor has the maximum overlap with the ground truth box.</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://miro.medium.com/max/534/0*u4UXzV2E_opHIkNs.png" alt="img"></p><h1 id="ç•™ä¸€ä¸ªé—®é¢˜"><a href="#ç•™ä¸€ä¸ªé—®é¢˜" class="headerlink" title="ç•™ä¸€ä¸ªé—®é¢˜"></a>ç•™ä¸€ä¸ªé—®é¢˜</h1><p>Anchorä½œç”¨ï¼šç›®å‰å¤§æ–¹å‘Anchor-freeï¼Œä½†æ˜¯ç›®å‰è¿˜æ˜¯æœ‰Anchorçš„æ•ˆæœæ›´å¥½ï¼Œé‚£ä¹ˆAnchorçš„å…·ä½“èµ·åˆ°çš„ä½œç”¨æ˜¯ï¼š</p><ul><li>ä»¥YOLOä¸ºä¾‹ï¼Œæé«˜äº†æ¨¡å‹çš„ç²¾ç¡®ç‡å¹¶ä¸”è®©æ¨¡å‹æ›´å¿«æ›´åŠ æ–¹ä¾¿åœ°æ”¶æ•›ã€‚</li><li>Anchorå¯ä»¥æé«˜æ¨¡å‹çš„recallï¼Œé¿å…å°‘æ£€æµ‹åˆ°ç‰©ä½“ã€‚</li><li></li></ul><p>é™¤æ­¤ä¹‹å¤–Anchorè¿˜æœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿ</p>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> YOLO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>YOLOv2è®ºæ–‡ç ”è¯»</title>
      <link href="/2021/10/23/dian10-1-hou-xue-xi-ji-lu-yolov2/"/>
      <url>/2021/10/23/dian10-1-hou-xue-xi-ji-lu-yolov2/</url>
      
        <content type="html"><![CDATA[<h1 id="YOLOv2"><a href="#YOLOv2" class="headerlink" title="YOLOv2"></a>YOLOv2</h1><h2 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h2><p>è¿™æ˜¯ä¸€ç¯‡æ‰¿ä¸Šå¯ä¸‹çš„è®ºæ–‡ï¼Œç›¸å¯¹è€Œè¨€éå¸¸é‡è¦ã€‚</p><blockquote><p>Bç«™è®²è§£ï¼š<a href="https://www.bilibili.com/video/BV1Q64y1s74K" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1Q64y1s74K</a></p><p>è®ºæ–‡åœ°å€ï¼š<a href="https://arxiv.org/abs/1612.08242" target="_blank" rel="noopener">https://arxiv.org/abs/1612.08242</a></p></blockquote><iframe src="//player.bilibili.com/player.html?aid=761792345&bvid=BV1Q64y1s74K&cid=375754199&page=2" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe><p>ç°åœ¨å¼€å§‹çœ‹YOLOv2äº†ï¼Œæ„Ÿè§‰v1æ¯•ç«Ÿè¯»äº†é‚£ä¹ˆé•¿æ—¶é—´äº†ï¼Œä¹Ÿäº†è§£çš„å·®ä¸å¤šäº†ã€‚å‡ï¼æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹ç®—æ³•çš„å…·ä½“ç®—æ³•æ€è·¯å§ï¼Œç„¶åå¼€å§‹è¯»è®ºæ–‡å­¦ä¹ ç›¸å…³çš„å†…å®¹ã€‚</p><p>YOLO9000å¼•å…¥äº†ä¸€ç³»åˆ—æ”¹è¿›ï¼ŒåŠ å…¥äº†anchor,åŠ å…¥äº†batch normalizationï¼Œ åŠ äº†å¤šå°ºåº¦çš„è®­ç»ƒè¿™äº›ï¼Œè¿™äº›å¯¹äºä¹‹åçš„ç›®æ ‡æ£€æµ‹æœ‰ç€éå¸¸é‡è¦çš„å½±å“ï¼Œéœ€è¦æˆ‘ä»¬å¥½å¥½æ€è€ƒå­¦ä¹ ä¸€ä¸‹ã€‚</p><p><a href="https://imgtu.com/i/4bW3pd" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/10/02/4bW3pd.png" alt="YOLO9000"></a></p><p>æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹YOLOå¤§è‡´å‘è¡¨çš„ç‰ˆæœ¬ï¼š</p><p><a href="https://imgtu.com/i/4bWJXt" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/10/02/4bWJXt.png" alt="YOLO Milestone"></a></p><p>å†æ¥å¼ æˆ‘ä»¬å„ä¸ªç›®æ ‡æ£€æµ‹æ¯”è¾ƒæœ‰å½±å“åŠ›æ¨¡å‹ï¼š</p><p><a href="https://imgtu.com/i/4bWdAS" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/10/02/4bWdAS.png" alt="Object Detection"></a></p><ul><li>YOLOv1çš„è™½ç„¶é€Ÿåº¦å¾ˆå¿«ï¼Œå› ä¸ºå®ƒæ˜¯å•é˜¶æ®µç®—æ³•å˜›ï¼Œä½†æ˜¯ä»–çš„è¯†åˆ«mAPç›¸å¯¹äºæˆ‘ä»¬å…¶ä»–çš„å…ˆè¿›çš„ä¸¤é˜¶æ®µæ¥çœ‹ï¼Œè¿˜æ˜¯æœ‰æŒºå¤§çš„å·®è·ã€‚</li><li>å¦å¤–å°±æ˜¯å®šä½æ€§èƒ½æ¯”è¾ƒå·®ï¼Œç›¸å¯¹äºFasterRCNNæ¥çœ‹ï¼Œå®ƒç²¾ç¡®è°ƒæ•´æ¡†æ¡†çš„ä½ç½®çš„èƒ½åŠ›ä¸æ˜¯å¾ˆå¥½ã€‚</li><li>åŒæ—¶æ¥çœ‹ï¼Œå®ƒçš„recallæ¯”è¾ƒä½ï¼Œå…¨éƒ¨ç›®æ ‡å…¨éƒ¨æ£€å‡ºçš„èƒ½åŠ›æ¯”è¾ƒå·®ã€‚</li><li><strong>YOLOv2å¯¹ä»¥ä¸Šåšäº†å¾ˆå¤§çš„æ”¹è¿›</strong></li><li>YOLO9000åå­—å«åšï¼š<strong>YOLO9000ï¼šBetter, Faster, Stronger</strong>, è¿™é‡Œçš„Betterå°±æ˜¯æ›´åŠ çš„å‡†ç¡®.</li></ul><p><a href="https://imgtu.com/i/4bhdzj" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/10/02/4bhdzj.png" alt="YOLO9000, Better"></a></p><p>è¿™é‡Œæœ‰ç€è®¸å¤šçš„æ‰‹æ®µæ¥å¢åŠ æˆ‘ä»¬çš„å‡†ç¡®ç‡ï¼Œå¦‚ä¸Šæ€»ç»“æ¥çœ‹ï¼Œéå¸¸å‰å®³äº†ã€‚æˆ‘ä»¬ä¸€ä¸€æ€»ç»“æ¥çœ‹ã€‚</p><h2 id="Better"><a href="#Better" class="headerlink" title="Better"></a>Better</h2><ul><li>*â€Error analysis of YOLO compared to Fast R-CNN shows that YOLO makes a significant number of localization errors. Furthermore, YOLO has relatively low recall compared to region proposal-based methods. Thus we focus mainly on improving recall and localization while maintaining classification accuracy.â€*</li></ul><p>ç›¸æ¯”äºFaster RCNN,YOLOvè¿˜æ˜¯åœ¨å®šä½ä¸Šï¼Œç¼ºé™·å¾ˆå¤§ï¼Œæ¯•ç«Ÿæˆ‘ä»¬YOLOv1æ˜¯ç›´æ¥é¢„æµ‹çš„æ¡†çš„ä½ç½®ï¼Œè€ŒFaster-RCNNæ˜¯é€šè¿‡é¢„æµ‹çš„offsetï¼ˆ<em>å› ä¸ºæå‰æœ‰proposaläº†ï¼Œæ‰€ä»¥è¯´åªéœ€çŸ«æ­£ä¸€ä¸‹æ¡†å°±OKäº†ã€‚</em>)</p><p>CVçš„å¤§åŠ¿æ˜¯æ›´å¤§æ›´æ·±çš„ç½‘ç»œï¼Œæ›´å¥½çš„è¡¨ç°ç»å¸¸æ˜¯ç”±äºæ›´æ·±çš„ç½‘ç»œè®­ç»ƒä»¥åŠæ›´å¤šæ•°æ®æ¥æ”¯æ’‘ã€‚è¿™é‡ŒYOLOä¸ºäº†ä¿è¯é€Ÿåº¦ï¼Œåè€Œç®€åŒ–äº†è®¾è®¡çš„ç¥ç»ç½‘ç»œã€‚</p><h2 id="ç®—æ³•åŸç†"><a href="#ç®—æ³•åŸç†" class="headerlink" title="ç®—æ³•åŸç†"></a>ç®—æ³•åŸç†</h2><h3 id="Batch-Normalization"><a href="#Batch-Normalization" class="headerlink" title="Batch Normalization"></a>Batch Normalization</h3><p>å°†æˆ‘ä»¬ç¥ç»å…ƒçš„è¾“å‡ºå‡å»å‡å€¼é™¤ä»¥æ ‡å‡†å·®ï¼Œå¾—åˆ°äº†ä¸€ä¸ªä»¥0ä¸ºå‡å€¼ï¼Œ1ä¸ºæ ‡å‡†å·®çš„ä¸€ä¸ªåˆ†å¸ƒï¼Œè¿™æ ·çš„è¯åƒæˆ‘ä»¬çš„</p><p><a href="https://imgtu.com/i/4bhfSJ" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/10/02/4bhfSJ.png" alt="Batch Normalization"></a></p><p>Batch Normalizationçš„å…·ä½“æ­¥éª¤çš„è¯ï¼Œå®é™…ä¸Šä¹‹å‰å·²ç»äº†è§£è¿‡äº†ï¼Œç°åœ¨æˆ‘ä»¬ä¸å¦¨å†çœ‹ä¸€éå§ï¼š</p><p><a href="https://imgtu.com/i/4bhTw6" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/10/02/4bhTw6.png" alt="BN"></a></p><p>å½“æ—¶åº”è¯¥æ˜¯çœ‹äº†ä¸€ä¸ªè€å¤–çš„åšå®¢äº†è§£åˆ°äº†BNå±‚çš„å‰å‘åå‘ä¼ æ’­åŸç†ï¼Œè¿™é‡Œé“¾æ¥å¦‚ä¸‹ï¼š<a href="https://kratzert.github.io/2016/02/12/understanding-the-gradient-flow-through-the-batch-normalization-layer.html" target="_blank" rel="noopener">https://kratzert.github.io/2016/02/12/understanding-the-gradient-flow-through-the-batch-normalization-layer.html</a></p><p>ä¸ªäººè®¤ä¸ºè®²è§£çš„è¿˜æ˜¯éå¸¸å¥½çš„ã€‚ </p><p>å®é™…ä¸Šå› ä¸ºæˆ‘ä»¬çš„BNå°±æ˜¯åŠªåŠ›å°†æˆ‘ä»¬çš„æ•°æ®å¾€0ä¸Šèšåˆï¼Œè®©æˆ‘ä»¬çš„æ•°æ®è¿œç¦»é¥±å’ŒåŒºï¼Œè¿™é‡Œçš„é¥±å’ŒåŒºå®é™…ä¸Šæ˜¯æŒ‡çš„æˆ‘ä»¬çš„æ¿€æ´»å‡½æ•°çš„é¥±å’ŒåŒºï¼Œå› ä¸ºæˆ‘ä»¬æ¿€æ´»å‡½æ•°sigmoidå’Œtanhä»–ä»¬éƒ½æ˜¯åœ¨0å¤„æ¢¯åº¦æ¯”è¾ƒå¤§ï¼Œåˆ°æ—¶å€™æ”¹å–„æ¢¯åº¦ä¸‹é™çš„æ•ˆæœæ¯”è¾ƒå¥½ï¼Œæˆ‘ä»¬å¦‚æœè¿›è¡Œç›¸åº”çš„BNæ“ä½œï¼Œé‚£ä¹ˆæ•°æ®å°±èƒ½æ›´å¥½åœ°è¢«åˆ©ç”¨æ”¹è¿›ç½‘ç»œã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬ä¸è¿›è¡Œç›¸åº”çš„BNå¤„ç†ï¼Œå¯èƒ½ä¸¤æçš„æ•°æ®å°±ä¸ä¼šå¯¹è®­ç»ƒç½‘ç»œæœ‰ç€å¾ˆå¥½çš„å¸®åŠ©ã€‚æ€»çš„æ¥çœ‹ï¼ŒBNå±‚è¿˜æ˜¯ç”¨å¤„éå¸¸å¤§çš„ã€‚</p><p>ä¸‹é¢æ˜¯æé£é£æ•™æˆåœ¨CS231Næ€»ç»“çš„ï¼š</p><p><a href="https://imgtu.com/i/4b5OsA" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/10/02/4b5OsA.png" alt="BN advantages"></a></p><p><strong>æ³¨æ„è¿™ä¸ªæ–¹æ³•ç”šè‡³å¯ä»¥å–ä»£æˆ‘ä»¬çš„Dropoutå±‚ï¼Œä½†æ˜¯BNå¹¶ä¸èƒ½å’ŒDropoutå±‚ä¸€èµ·è¿›è¡Œä½¿ç”¨ï¼ï¼</strong></p><p>å¾ˆå¤šè®ºæ–‡éƒ½ç ”ç©¶äº†è¿™ä¸ªç°è±¡ï¼Œä»–ä»¬éƒ½æ˜¯ä¸ºäº†é˜²æ­¢è¿‡æ‹Ÿåˆï¼Œä½†æ˜¯ä¸€æ—¦æ”¾åˆ°ä¸€èµ·äº†ï¼Œå°±ä¸èƒ½è¿™ä¹ˆç”¨ï¼Œä¸workäº†ï¼Œå®é™…ä¸Šè¿™ä¸ªæ˜¯éå¸¸å¥‡æ€ªçš„ã€‚</p><h3 id="High-Resolution-Classifier"><a href="#High-Resolution-Classifier" class="headerlink" title="High Resolution Classifier"></a>High Resolution Classifier</h3><p>ä¸€èˆ¬ç¥ç»ç½‘ç»œéƒ½æ˜¯ä»¥å¾ˆå°çš„å›¾ç‰‡è¿›è¡Œæ£€æµ‹ä¸è®­ç»ƒçš„ï¼Œä½†æ˜¯YOLOv1çš„è¾“å…¥å›¾åƒæ˜¯448Ã—448ï¼Œå®ƒéœ€è¦ä»å°åˆ†è¾¨ç‡åˆ‡æ¢åˆ°å¤§åˆ†è¾¨ç‡ï¼Œè¿™ä¹ˆä¸€æ¥æ— ç–‘å°±æŸå¤±äº†è®¸å¤šï¼Œå¾—åˆ°äº†è®¸å¤šæ²¡ç”¨çš„ä¸œè¥¿ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©ä½¿ç”¨ç›´æ¥è®©YOLOv2åœ¨448Ã—448çš„é«˜åˆ†è¾¨ç‡çš„å›¾åƒè¿›è¡Œè®­ç»ƒã€‚</p><p><a href="https://imgtu.com/i/4bI4yj" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/10/02/4bI4yj.png" alt="High Resolution"></a></p><p>å¯ä»¥çœ‹åˆ°è¿™ä¹ˆä¸€æ¥æˆ‘ä»¬èƒ½å¤Ÿå¢åŠ 3.5%mAPçš„ç²¾ç¡®ç‡ã€‚ç½‘ç»œä¸éœ€è¦ä»å°åˆ†è¾¨ç‡åˆ°å¤§åˆ†è¾¨ç‡å»é€‚åº”äº†ï¼Œæˆ‘ä»¬ç›´æ¥è¿›è¡Œäº†ç›¸å…³çš„å¤§åˆ†è¾¨ç‡çš„é¢„è®­ç»ƒã€‚</p><h3 id="Convolutional-With-Anchor-Boxes"><a href="#Convolutional-With-Anchor-Boxes" class="headerlink" title="Convolutional With Anchor Boxes"></a>Convolutional With Anchor Boxes</h3><p>è¿™é‡Œä½¿ç”¨äº†Anchorï¼Œåæ¥ç›´åˆ°v5éƒ½åœ¨ä½¿ç”¨anchor,è™½ç„¶ä¹‹åä¸ç”¨äº†ï¼Œå˜æˆäº†<code>anchor-free</code>, ä½†æ˜¯ç†è§£è¿™äº›è¿˜æ˜¯éå¸¸é‡è¦çš„ã€‚æˆ‘ä»¬å°±ä»è¿™é‡Œå¼€å§‹äº†è§£ä¸€ä¸‹<code>Anchor</code>ã€‚</p><p>å°±åƒå‰é¢è¯´çš„ï¼ŒYOLOç›´æ¥é¢„æµ‹æ¡†çš„x,y,w,hï¼Œ<strong>ä½†æ˜¯FasterRCNNçš„RPNé¢„æµ‹çš„æ˜¯ä¸anchorçš„offsetï¼ï¼ï¼ˆå‘œå‘œå‘œæˆ‘çœŸæ˜¯ä¸ªåºŸç‰©ä»¥ä¸ºè‡ªå·±æŒæ¡å¾ˆæ¸…æ¥šçš„Faster RCNNå´è¢«YOLOä½œè€…æ— æ„ä¸­å¯¹æ¯”æ‰“äº†è„¸ï¼Œçœ‹æ¥è‡ªå·±æŒæ¡çš„è¿˜æ˜¯å¤ªæµ…äº†ï¼Œæºç è¯»äº†ä¸ªå¯‚å¯å•Šï¼Œèµ¶å¿«<a href="https://zhuanlan.zhihu.com/p/49897496" target="_blank" rel="noopener">æŠ¢æ•‘ä¸‹</a>ï¼‰</strong></p><p>é¢„æµ‹offsetsè€Œä¸æ˜¯ç›´æ¥é¢„æµ‹åæ ‡coordinateså¯ä»¥ç®€åŒ–é—®é¢˜ä»è€Œè®©æˆ‘ä»¬çš„ç½‘ç»œæ›´å¥½çš„å»å­¦ä¹ ï¼Œè¿™ä¸ªå¾ˆå¥½ç†è§£ï¼Œå› ä¸ºæœ‰äº†anchorç›¸å½“äºæœ‰äº†ä¸€ä¸ªå‚ç…§ç‰©ï¼Œç¥ç»ç½‘ç»œåªéœ€è¦ç»§ç»­è®©è¿™ä¸ªæ¡†å˜å¾— æ›´åŠ ç²¾ç¡®å°±OKäº†ï¼Œä½†æ˜¯å¦‚æœä»å¤´å¼€å§‹é¢„æµ‹éœ€è¦å¾ˆé•¿æ—¶é—´çš„å˜åŒ–ä¸åˆå§‹åŒ–è¿è¡Œã€‚</p><p>ä½œè€…å»æ‰äº†YOLOv1ä¸­çš„å…¨è¿æ¥å±‚ï¼Œç„¶åä½¿ç”¨anchoræ¥é¢„æµ‹æˆ‘ä»¬çš„ç»“æœã€‚æ­¤å¤–ä¹Ÿå»æ‰äº†ä¸€ä¸ªpoolingå±‚æ¥ä½¿ç½‘ç»œè¾“å‡ºçš„åˆ†è¾¨ç‡æ›´é«˜ã€‚å¦å¤–ä½œè€…å°†è¾“å…¥çš„shapeå˜æˆäº†416Ã—416ï¼Œ åŸæ¥æ˜¯448. è¿™æ˜¯å› ä¸ºä½œè€…æƒ³è¦å¾—åˆ°ä¸€ä¸ªå¥‡æ•°ä»è€Œè®©å›¾ç‰‡çš„ä¸­å¿ƒæ˜¯ä¸€ä¸ªcellè€Œä¸æ˜¯4ä¸ªï¼Œå› ä¸ºå¾ˆå¤šæˆ‘ä»¬éœ€è¦æ£€æµ‹å‡ºçš„objectéƒ½ä¼šå‡ºç°åœ¨å›¾ç‰‡ä¸­å¿ƒï¼Œæ‰€ä»¥è¿™ä¹ˆä¸€æ¥ä¼šæ›´åŠ æ–¹ä¾¿ä¸åˆç†ï¼Œåªéœ€è¦æ£€æµ‹ä¸€ä¸ªå¤§æ¡†è€Œä¸æ˜¯æœ‰4ä¸ªcellæ¥æ£€æµ‹è¾“å‡ºç»“æœã€‚</p><p>YOLOå°†å›¾ç‰‡æŠ½ç¼©32å€æ‰€ä»¥æˆ‘ä»¬æœ€åå¾—åˆ°çš„æ˜¯13Ã—13çš„feature mapã€‚</p><p>*â€When we move to anchor boxes we also decouple the<br>class prediction mechanism from the spatial location and<br>instead predict class and objectness for every anchor box.<br>Following YOLO, the objectness prediction still predicts<br>the IOU of the ground truth and the proposed box and the<br>class predictions predict the conditional probability of that<br>class given that there is an object.â€*</p><p>v2å¥½åƒè®­ç»ƒé˜¶æ®µä¹Ÿæ˜¯æ¯ä¸€ä¸ªboxéƒ½é¢„æµ‹äº†ç›¸åº”çš„ç±»åˆ«æ¦‚ç‡ã€‚</p><p>ä½¿ç”¨anchor boxeså‡†ç¡®ç‡æœ‰ä¸€ä¸ªå°å°çš„ä¸‹é™ï¼Œä½†æ˜¯recallå´ä¸Šå‡äº†ã€‚ä¹‹å‰æ˜¯69.5mAP, 81%recallï¼Œç°åœ¨å˜ä¸º69.2mAP, 88%recall.</p><p>å½“ç„¶ä¹‹å‰ç±»åˆ«æ˜¯å½’grid cellç®¡çš„ï¼Œç°åœ¨å˜ä¸ºå½’anchorç®¡äº†ã€‚ä¹‹å‰YOLOv1ä¸­æ˜¯æ¯ä¸€ä¸ªgrid cellçš„Bä¸ªboxä¸­åªèƒ½æœ‰ä¸€ä¸ªç±»åˆ«ï¼Œå¹¶ä¸”åªèƒ½æœ‰ä¸€ä¸ªç±»åˆ«è¾“å‡ºçŸ©é˜µï¼ˆæ ¹æ®IOUï¼‰ï¼Œä½†æ˜¯ç°åœ¨å˜æˆå½’ç”Ÿæˆçš„æ¯ä¸ªanchorç®¡ä¹‹åï¼Œä¸€ä¸ªgrid cellä¼šæœ‰å¤šä¸ªanchorå¹¶ä¸”å¾ˆæœ‰å¯èƒ½å¯ä»¥é¢„æµ‹å‡ºä¸åŒçš„ç±»åˆ«ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰äº†ä¸€ä¸ªgird cellä¸€ä¸ªç‰©ä½“çš„é™åˆ¶ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211023185835.png" alt="image-20211023185832501"></p><p>ç­‰è¯¦ç»†ç†è§£äº†è‡ªå·±å†å†™ä¸€éäº†è§£ä¸€ä¸‹ã€‚</p><h3 id="Dimension-Clusters"><a href="#Dimension-Clusters" class="headerlink" title="Dimension Clusters"></a>Dimension Clusters</h3><p>*â€We encounter two issues with anchor boxes when using them with YOLO.â€*</p><p>ä½¿ç”¨anchorçš„æ—¶å€™ï¼Œä½œè€…é‡åˆ°äº†ä¸¤ä¸ªé—®é¢˜ã€‚</p><h4 id="hand-picked-priors"><a href="#hand-picked-priors" class="headerlink" title="hand picked priors"></a>hand picked priors</h4><p>*â€The first is that the box dimensions are hand picked. The network can learn to adjust the boxes appropriately but if we pick better priors for the network to start with we can make it easier for the network to learn to predict good detections.â€*</p><p>æˆ‘ä»¬çš„anchor boxæ˜¯äººä¸ºæ ‡æ³¨çš„ï¼Œè™½ç„¶è¿™ä¹ˆåšç½‘ç»œä»ç„¶å¯ä»¥é€šè¿‡é¢„æµ‹offsetçš„æ–¹å¼æ¥ä¼˜åŒ–ä¿®æ­£ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿæœ€åˆå°±ç»™å‡ºä¸€ä¸ªæ¯”è¾ƒåˆé€‚çš„anchorï¼Œé‚£ä¹ˆç½‘ç»œæ— ç–‘å¯ä»¥ç»™å‡ºæ›´å¥½æ›´å¿«çš„è®­ç»ƒç»“æœã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211023180951.png" alt="Kmeans"></p><p>æ‰€ä»¥ä½œè€…å¯¹äºæ•°æ®é›†çš„GTåšäº†K-meansèšç±»ï¼Œå½“ç„¶ä½œè€…å¹¶æ²¡æœ‰åšæ ‡å‡†çš„èšç±»ï¼Œå› ä¸ºæœ€æ ‡å‡†çš„èšç±»é‡‡ç”¨çš„æ˜¯æ¬§å‡ é‡Œå¾—è·ç¦»ï¼Œæ˜¾ç„¶è¿™é‡Œå¦‚æœé‡‡ç”¨æ¬§å‡ é‡Œå¾—è·ç¦»ä¼šæœ‰å¾ˆå¤§çš„é—®é¢˜ï¼Œå› ä¸ºå¯¹äºå¤§çš„è¾¹æ¡†å’Œå°çš„è¾¹æ¡†æ¥è¯´ç›¸åŒçš„æ¬§å‡ é‡Œå¾—è¯¯å·®æ˜¯ä¸å…¬å¹³çš„ï¼Œä½œè€…è¿™é‡Œå®šä¹‰äº†ä¸€ç§å…¨æ–°çš„è·ç¦»ï¼š</p><blockquote><p> <strong>d(box, centroid) = 1 âˆ’ IOU(box, centroid)</strong></p></blockquote><p>è¿™å°±å’Œæ¡†çš„å°ºå¯¸æ²¡æœ‰å…³ç³»äº†ï¼Œè¿™æ˜¯çº¯ç²¹çš„IOUçš„å æ¯”ï¼Œå½“ç„¶è¿™ä¸ªè·ç¦»è¶Šå°ï¼Œæˆ‘ä»¬çš„IOUå æ¯”è¶Šå¤§ï¼Œè¿™å°±åˆç†å¾ˆå¤šã€‚</p><p>ä½œè€…å°è¯•äº†å¾ˆå¤šä¸ªkå€¼ï¼Œæœ€åé€‰ç”¨k=5ä½œä¸ºä¸€ä¸ªæ¯”è¾ƒå¥½çš„èƒ½å¤Ÿå…¼é¡¾æ¨¡å‹å¤æ‚åº¦ä¸é«˜recalçš„tradeoffã€‚</p><p>ä½œè€…ä¹Ÿç»™äº†ä¸€ä¸ªè¡¨æ ¼ç”¨æ¥å¯¹æ¯”ä¸åŒèšç±»kï¼Œä¸åŒèšç±»æ–¹æ³•ï¼Œæ˜¯å¦èšç±»çš„æ•ˆæœï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211023181641.png" alt="Cluster"></p><p>æœ€åå¾—å‡ºäº†ä½¿ç”¨èšç±»ç¡®å®æé«˜äº†æ•ˆæœè¿™æ ·çš„ä¸€ä¸ªæ€è·¯ã€‚</p><h4 id="Direct-location-prediction"><a href="#Direct-location-prediction" class="headerlink" title="Direct location prediction"></a>Direct location prediction</h4><p>å½“ç”¨anchor boxè¿™ç§æ–¹æ³•çš„æ—¶å€™ï¼Œä½œè€…é‡åˆ°çš„ç¬¬äºŒä¸ªé—®é¢˜åœ¨äºæ¨¡å‹çš„å‘æ•£ï¼Œæ¨¡å‹ä¸æ˜¯å¾ˆç¨³å®šã€‚å…¶ä¸­ç€é‡æåˆ°äº†åœ¨è®­ç»ƒè¿­ä»£çš„æ—©æœŸã€‚å¤§å¤šæ•°çš„instabilityæ˜¯ç”±äºé¢„æµ‹boxçš„(x, y)çš„æ—¶å€™ï¼Œåœ¨RPNä¸­ç½‘ç»œé¢„æµ‹çš„æ˜¯$t_x, t_y$â€‹, (RPNä¸­)æˆ‘ä»¬çš„(x, y)ä¸­å¿ƒåæ ‡è®¡ç®—çš„æ–¹æ³•æ˜¯ï¼š</p><blockquote><p>x = (tx âˆ— wa) âˆ’ xa<br>y = (ty âˆ— ha) âˆ’ ya</p></blockquote><p>è¿™å…¶ä¸­çš„$t_x, t_y$å°±æ˜¯æˆ‘ä»¬çš„é¢„æµ‹åç§»é‡ï¼Œç„¶å$w_a, h_a$æ˜¯anchorçš„å®½é«˜ï¼Œå¦‚æœè¿™é‡Œ$t_x=1$ï¼Œé‚£ä¹ˆç›¸å½“äºboxå‘å³ç§»åŠ¨ä¸€ä¸ªboxçš„å®½çš„è·ç¦»ã€‚-1å‘å·¦ç§»åŠ¨ã€‚è¿™ä¹ˆåšçš„è¯å°±å¯¹äºæœ€ç»ˆé¢„æµ‹å‡ºæ¥çš„anchor boxæ²¡æœ‰ä»»ä½•é™åˆ¶ï¼Œå®ƒå¯ä»¥å‡ºç°åœ¨æˆ‘ä»¬çš„å›¾ç‰‡çš„æ¯ä¸€ä¸ªä½ç½®ï¼Œè¿™æ˜¾ç„¶æ˜¯æœ‰äº›ä¸åˆç†çš„ï¼Œå› ä¸ºè®©è¿™ä¸ªgrid cellè´Ÿè´£è¿™äº›é¢„æµ‹å°±æ˜¯å› ä¸ºä¸­å¿ƒç‚¹åœ¨è¿™é‡Œé¢ï¼Œè¿™åè€Œå¾ˆå®¹æ˜“è·‘åˆ°å¤–è¾¹å°±å¯¹æ¨¡å‹çš„é¢„æµ‹åˆå§‹è¿­ä»£è¿™äº›éƒ½å¾ˆä¸å¥½ã€‚éšæœºåˆå§‹åŒ–çŠ¶æ€ä¸‹æ¨¡å‹éœ€è¦èŠ±è´¹å¾ˆé•¿æ—¶é—´å»ç¨³å®šï¼Œæ‰èƒ½é¢„æµ‹å‡ºä¸€ä¸ªæ¯”è¾ƒåˆç†æ¯”è¾ƒsensibleçš„æ¨¡å‹ã€‚</p><p>æ‰€ä»¥ä½œè€…æœ€åé€‰æ‹©å°†grid cellçš„å¤§å°å½’ä¸€åŒ–åˆ°0ä¸1ä¹‹é—´ç„¶åé€‰æ‹©ä½¿ç”¨ä¸€ä¸ªlogistic activationæ¥é™å®šæˆ‘ä»¬çš„é¢„æµ‹åœ¨grid cellçš„èŒƒå›´å†…ã€‚</p><p>*â€The network predicts 5 bounding boxes at each cell in<br>the output feature map. The network predicts 5 coordinates<br>for each bounding box, tx, ty, tw, th, and to. If the cell is<br>offset from the top left corner of the image by (cx, cy) and<br>the bounding box prior has width and height pw, ph, then<br>the predictions correspond to:â€*</p><p>$b_x = Ïƒ(t_x) + c_x$</p><p>$b_y = Ïƒ(t_y) + c_y$</p><p>$b_w = p_we^{t_w}$â€‹</p><p>$b_h = p_he^{t_h}$</p><p>$Pr(object) âˆ— IOU(b, object) = Ïƒ(to)$</p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ¯ä¸ªbboxéƒ½ä¼špredicts5ä¸ªå‚æ•°ï¼š$t_x, t_y, t_w, t_h, t_o$.æˆ‘ä»¬å¯ä»¥å…ˆæ¥çœ‹ä¸€ä¸‹ä»¥ä¸Šè¿™äº›ä¸ªå‚æ•°çš„æ„æ€ï¼š</p><p>$c_x,c_y$ æŒ‡çš„æ˜¯è¯¥cellçš„å·¦ä¸Šè§’ç¦»æˆ‘ä»¬çš„imageçš„å·¦ä¸Šè§’çš„x,yè½´æ–¹å‘çš„åç§»é‡ï¼Œä¹Ÿå°±æ˜¯å·¦ä¸Šè§’çš„åæ ‡ã€‚ç„¶å$p_w,p_h$â€‹å°±æ˜¯æˆ‘ä»¬çš„anchorçš„åŸºæœ¬å®½å’Œé«˜ï¼Œç„¶å$b_x, b_y,b_w, b_h$æ˜¯æˆ‘ä»¬çš„é¢„æµ‹æ¡†çš„x,yåæ ‡ä»¥åŠé«˜å®½ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211023205905.png" alt></p><p>å¯¹è¿™æ–¹é¢åšä¸€ä¸ªæ€»ç»“æ¥çœ‹ï¼Œç”±äºæˆ‘ä»¬åšäº†ä¸€ä¸ªé™åˆ¶ä½¿æˆ‘ä»¬çš„é¢„æµ‹locationæ›´åŠ ç¡®å®šä»è€Œä½¿å¾—æˆ‘ä»¬çš„æ¨¡å‹å¿«é€Ÿç¨³å®šï¼ŒåŒæ—¶ä½¿ç”¨èšç±»æ¥è®©æˆ‘ä»¬çš„æ¨¡å‹è®­ç»ƒæ›´åŠ è½»æ¾å‡†ç¡®ï¼Œæœ€ç»ˆä½¿æˆ‘ä»¬çš„YOLOæå‡äº†å‡ ä¹5%ä¸ªç‚¹ã€‚</p><h3 id="Fine-Grained-Features"><a href="#Fine-Grained-Features" class="headerlink" title="Fine-Grained Features"></a>Fine-Grained Features</h3><p>*â€Our detector runs on top of this expanded feature map so that it has access to fine grained features.â€*</p><p>Fine-Grained Features, ä¹Ÿå³â€œç»†ç²’åº¦ç‰¹å¾â€ã€‚</p><p>å®é™…ä¸Šä¹Ÿå°±æ˜¯å°†13Ã—13Ã—1024çš„å‰ä¸€æ­¥å·ç§¯å±‚å¾—åˆ°çš„26Ã—26Ã—512çš„å˜æˆ13Ã—13Ã—2048ç„¶åå’ŒåŸæ¥çš„13Ã—13Ã—1024çš„original featuresåˆå¹¶åˆ°ä¸€å—å„¿è¿›è¡Œè®­ç»ƒè€Œå·²ï¼Œä½œè€…ä¹Ÿè¯´äº†ç±»ä¼¼äºResNetçš„æ€è·¯ï¼Œè¿™ä¸ªå¤§æ¦‚æœ‰1%çš„æå‡ï¼Œå®é™…ä¸Šæå‡å¹¶ä¸æ˜¯éå¸¸å¤§ã€‚ä¸åƒçœŸæ­£çš„resnetä¸€æ ·æ˜¯ä¸€ç§éå¸¸å¤§çš„æå‡ã€‚</p><p>ä½†æ˜¯ä»£ç ä¸Šçš„å¤„ç†å’Œè®ºæ–‡ä¸Šçš„å¤„ç†ä¸å¤ªä¸€æ ·ï¼Œä»£ç ä¸Šçš„å¤„ç†æ˜¯å°†26Ã—26Ã—512é€šè¿‡1Ã—1Convå˜ä¸º26Ã—26Ã—64ç„¶åå†æ‹†åˆ†æˆ13Ã—13Ã—256å†å’Œä¹‹å‰çš„åˆå¹¶.</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211023202014.png" alt="image-20211023202012753"></p><h2 id="Multi-Scale-Training"><a href="#Multi-Scale-Training" class="headerlink" title="Multi-Scale Training"></a>Multi-Scale Training</h2><p>*â€The original YOLO uses an input resolution of 448 Ã— 448. With the addition of anchor boxes we changed the resolution to 416Ã—416. However, since our model only uses convolutional and pooling layers it can be resized on the fly. We want YOLOv2 to be robust to running on images of different sizes so we train this into the model.â€*</p><p>ä½œè€…ä¸åœ¨å›ºå®šè¾“å…¥å›¾åƒå°ºå¯¸çš„å¤§å°äº†ï¼Œç”±äºæˆ‘ä»¬çš„ç½‘ç»œå±‚æ˜¯é™é‡‡æ ·32å€ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©æ¯10ä¸ªbatchå°±éšæœºé€‰å–ä¸€ç§å›¾ç‰‡å°ºå¯¸ï¼Œè¿™ä¸ªå°ºå¯¸å°±æ˜¯32çš„å€æ•°ï¼š{320ï¼Œ 352ï¼Œ384ï¼Œâ€¦â€¦ï¼Œ608}ï¼Œç›¸å½“äºè®©æˆ‘ä»¬çš„æ¨¡å‹æ›´åŠ robustã€‚ä¼šå¼ºè¿«ç¥ç»ç½‘ç»œå­¦ä¹ å»é¢„æµ‹ä¸åŒè¾“å…¥sizeçš„å›¾ç‰‡ã€‚</p><p>æ¥ç€å°±æ˜¯ä½œè€…çš„â€å¹å˜˜â€œï¼ˆä½†è¿™æ˜¯æœ‰èµ„æœ¬æœ‰å®åŠ›çš„å¹ï¼‰</p><p>*â€At low resolutions YOLOv2 operates as a cheap, fairly accurate detector. At 288 Ã— 288 it runs at more than 90 FPS with mAP almost as good as Fast R-CNN. This makes it ideal for smaller GPUs, high framerate video, or multiple video streams. At high resolution YOLOv2 is a state-of-the-art detector with 78.6 mAP on VOC 2007 while still operating above real-time speeds. See Table 3 for a comparison of YOLOv2 with other frameworks on VOC 2007.â€*</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211023202840.png" alt="Detection frameworks on Pascal VOC 2007"></p><p>æˆ–è®¸ä½ ä¼šé—®ä¸ºä»€ä¹ˆæˆ‘ä»¬å¯ä»¥è¾“å…¥ä¸åŒå¤§å°çš„å›¾ç‰‡è€Œä¸æ”¹å˜æˆ‘ä»¬çš„æ¨¡å‹ç»“æ„ï¼Ÿè¿™æ˜¯å› ä¸ºæˆ‘ä»¬è¿™é‡Œå¹¶æ²¡æœ‰é€‰æ‹©ä½¿ç”¨æˆ‘ä»¬çš„å…¨è¿æ¥å±‚ï¼Œè¿™é‡ŒYOLOv2å°†æ¨¡å‹æœ«å°¾çš„ä¸¤ä¸ªå…¨è¿æ¥å±‚å»æ‰äº†ï¼Œç„¶åé€‰æ‹©ä½¿ç”¨äº†ä¸€ä¸ªAvgpoolï¼ŒYOLOv2ç”¨çš„å®é™…ä¸Šæ˜¯è‡ªå·±ç ”ç©¶å‡ºæ¥çš„darknet(ä¼šåœ¨Fasteré‚£ä¸€èŠ‚è®²)ï¼Œè¿™å°±å¯¼è‡´æˆ‘ä»¬çš„ä¸ç®¡è¾“å…¥æ˜¯ä»€ä¹ˆï¼Œè¾“å‡ºçš„ç»“æœéƒ½åªå–å†³äºæœ€åçš„é€šé“æ•°ã€‚</p><p>æˆ‘ä»¬å¯ä»¥çœ‹çœ‹è®ºæ–‡åˆ—å‡ºçš„Darknet-19ç»“æ„ï¼ˆä»…ä¸ºåˆ†ç±»éƒ¨åˆ†ï¼‰:</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211023203839.png" alt="Darknet-19"></p><h3 id="Compariasion-to-other-sota"><a href="#Compariasion-to-other-sota" class="headerlink" title="Compariasion to other sota"></a>Compariasion to other sota</h3><p><a href="https://imagelol.com/image/I0WrSH" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/10/27/I0WrSH.png" alt></a></p><h2 id="Loss-Function"><a href="#Loss-Function" class="headerlink" title="Loss Function"></a>Loss Function</h2><p>è¿™ä¸ªæ˜¯å­è±ªå…„åœ¨ç½‘ä¸Šæ‰¾çš„æŸå¤±å‡½æ•°å›¾ç„¶ååšçš„ç¬”è®°ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211023195308.png" alt></p><p>ï¼ˆæœªå®Œå¾…ç»­ï¼‰</p>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> YOLO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++ç¬”è®°ï¼ˆäºŒï¼‰</title>
      <link href="/2021/10/20/c-bi-ji-yi/"/>
      <url>/2021/10/20/c-bi-ji-yi/</url>
      
        <content type="html"><![CDATA[<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>C++æœ‰å…³çŸ¥è¯†ã€‚è®°å½•è¯¾æœ¬ä¸Šé‡åˆ°çš„æˆ–æ˜¯ä½œä¸šä¸­å‘ç°çš„é—®é¢˜ã€‚</p><h2 id="è™šå‡½æ•°ã€çº¯è™šå‡½æ•°"><a href="#è™šå‡½æ•°ã€çº¯è™šå‡½æ•°" class="headerlink" title="è™šå‡½æ•°ã€çº¯è™šå‡½æ•°"></a>è™šå‡½æ•°ã€çº¯è™šå‡½æ•°</h2><h3 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h3><ul><li>ä»‹ç»è™šå‡½æ•°ã€çº¯è™šå‡½æ•°ï¼š<a href="https://zhuanlan.zhihu.com/p/37331092" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/37331092</a></li><li>ä»‹ç»è™šå‡½æ•°ã€çº¯è™šå‡½æ•°ï¼š<a href="https://www.runoob.com/w3cnote/cpp-virtual-functions.html" target="_blank" rel="noopener">https://www.runoob.com/w3cnote/cpp-virtual-functions.html</a></li><li>é™æ€å‡½æ•°æ˜¯å¦å¯ä»¥æ˜¯è™šå‡½æ•°ï¼š<a href="https://blog.csdn.net/shltsh/article/details/45999801" target="_blank" rel="noopener">https://blog.csdn.net/shltsh/article/details/45999801</a></li><li>Virtual Function in C++ï¼š<a href="https://www.geeksforgeeks.org/virtual-function-cpp/" target="_blank" rel="noopener">https://www.geeksforgeeks.org/virtual-function-cpp/</a></li></ul><p>ä¸»è¦å¼•ç”¨èåˆä»¥ä¸Šå‡ ç¯‡æ–‡ç« ï¼Œæ‹¾äººç‰™æ…§ï¼Œä¾µæƒç«‹åˆ ã€‚</p><h3 id="Polymorphism"><a href="#Polymorphism" class="headerlink" title="Polymorphism"></a>Polymorphism</h3><p>å®é™…ä¸Šè¿™ä¸ªä¸»è¦æ˜¯ä¸å¤šæ€æœ‰å…³ï¼Œé¦–å…ˆæˆ‘ä»¬ä»‹ç»ä¸€ä¸‹å¤šæ€ï¼š</p><p>å¤šæ€ï¼ˆpolymorphismï¼‰æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€çš„ä¸€å¤§ç‰¹ç‚¹ï¼Œè€Œè™šå‡½æ•°æ˜¯å®ç°å¤šæ€çš„æœºåˆ¶ã€‚å…¶æ ¸å¿ƒç†å¿µå°±æ˜¯é€šè¿‡åŸºç±»è®¿é—®æ´¾ç”Ÿç±»å®šä¹‰çš„å‡½æ•°ã€‚å¤šæ€æ€§ä½¿å¾—ç¨‹åºè°ƒç”¨çš„å‡½æ•°æ˜¯åœ¨è¿è¡Œæ—¶åŠ¨æ€ç¡®å®šçš„ï¼Œè€Œä¸æ˜¯åœ¨ç¼–è¯‘æ—¶é™æ€ç¡®å®šçš„ã€‚ä½¿ç”¨ä¸€ä¸ªåŸºç±»ç±»å‹çš„æŒ‡é’ˆæˆ–è€…å¼•ç”¨ï¼Œæ¥æŒ‡å‘å­ç±»å¯¹è±¡ï¼Œè¿›è€Œè°ƒç”¨ç”±å­ç±»å¤å†™çš„ä¸ªæ€§åŒ–çš„è™šå‡½æ•°ï¼Œè¿™æ˜¯C++å®ç°å¤šæ€æ€§çš„ä¸€ä¸ªæœ€ç»å…¸çš„åœºæ™¯ã€‚</p><ul><li>è™šå‡½æ•°ï¼Œåœ¨ç±»æˆå‘˜æ–¹æ³•çš„å£°æ˜ï¼ˆä¸æ˜¯å®šä¹‰ï¼‰è¯­å¥å‰åŠ â€œvirtualâ€, å¦‚ virtual void func()</li><li>çº¯è™šå‡½æ•°ï¼Œåœ¨è™šå‡½æ•°ååŠ â€œ=0â€ï¼Œå¦‚ virtual void func()=0</li><li>å¯¹äºè™šå‡½æ•°ï¼Œå­ç±»å¯ä»¥ï¼ˆä¹Ÿå¯ä»¥ä¸ï¼‰é‡æ–°å®šä¹‰åŸºç±»çš„è™šå‡½æ•°ï¼Œè¯¥è¡Œä¸ºç§°ä¹‹ä¸ºå¤å†™Overrideã€‚</li><li>å¯¹äºçº¯è™šå‡½æ•°ï¼Œå­ç±»å¿…é¡»æä¾›çº¯è™šå‡½æ•°çš„ä¸ªæ€§åŒ–å®ç°ã€‚</li></ul><p>åœ¨æ´¾ç”Ÿå­ç±»ä¸­å¯¹è™šå‡½æ•°å’Œçº¯è™šå‡½æ•°çš„ä¸ªæ€§åŒ–å®ç°ï¼Œéƒ½ä½“ç°äº†â€œå¤šæ€â€ç‰¹æ€§ã€‚ä½†åŒºåˆ«æ˜¯ï¼š</p><ul><li>å­ç±»å¦‚æœä¸æä¾›è™šå‡½æ•°çš„å®ç°ï¼Œå°†ä¼šè‡ªåŠ¨è°ƒç”¨åŸºç±»çš„ç¼ºçœè™šå‡½æ•°å®ç°ï¼Œä½œä¸ºå¤‡é€‰æ–¹æ¡ˆï¼›</li><li>å­ç±»å¦‚æœä¸æä¾›çº¯è™šå‡½æ•°çš„å®ç°ï¼Œç¼–è¯‘å°†ä¼šå¤±è´¥ã€‚å°½ç®¡åœ¨åŸºç±»ä¸­å¯ä»¥ç»™å‡ºçº¯è™šå‡½æ•°çš„å®ç°ï¼Œä½†æ— æ³•é€šè¿‡æŒ‡å‘å­ç±»å¯¹è±¡çš„åŸºç±»ç±»å‹æŒ‡é’ˆæ¥è°ƒç”¨è¯¥çº¯è™šå‡½æ•°ï¼Œä¹Ÿå³ä¸èƒ½ä½œä¸ºå­ç±»ç›¸åº”çº¯è™šå‡½æ•°çš„å¤‡é€‰æ–¹æ¡ˆã€‚ï¼ˆçº¯è™šå‡½æ•°åœ¨åŸºç±»ä¸­çš„å®ç°è·Ÿå¤šæ€æ€§æ— å…³ï¼Œå®ƒåªæ˜¯æä¾›äº†ä¸€ç§è¯­æ³•ä¸Šçš„ä¾¿åˆ©ï¼Œåœ¨å˜åŒ–å¤šç«¯çš„åº”ç”¨åœºæ™¯ä¸­ç•™æœ‰åè·¯ã€‚ï¼‰</li></ul><p>çº¯è™šå‡½æ•°ç›¸å½“äºæä¾›äº†ä¸€ç§å…±åŒçš„æ ‡å‡†ï¼Œæ¯ä¸ªå­ç±»éƒ½å¿…é¡»å®šä¹‰å±äºè‡ªå·±çš„çº¯è™šå‡½æ•°ï¼Œè€Œè™šå‡½æ•°ç¡®å®æä¾›äº†å¤šæ€æœºåˆ¶ï¼Œå­ç±»å¯ä»¥å®ç°è‡ªå·±å¤å†™overrideçš„å‡½æ•°ï¼Œä¹Ÿå¯ä»¥è‡ªå·±ä¸å†™ç„¶åä½¿ç”¨çˆ¶ç±»çš„çº¯è™šå‡½æ•°ã€‚</p><h3 id="è™šå‡½æ•°"><a href="#è™šå‡½æ•°" class="headerlink" title="è™šå‡½æ•°"></a>è™šå‡½æ•°</h3><p>æˆ‘ä»¬å…ˆæ¥çœ‹è¿™æ ·ä¸€ä¸²ä»£ç ï¼š</p><p><strong>ï¼ˆè¿™é‡Œåªæ˜¯ä¸ºäº†ä¾¿äºç†è§£ï¼Œä½†æ˜¯å®é™…ä¸Šç±»çš„è®¾è®¡æœ‰ä¸€ä¸ªå‡†åˆ™å°±æ˜¯å­ç±»å°½é‡ä¸è¦é‡è½½éè™šå‡½æ•°ï¼‰</strong></p><pre class="line-numbers language-c++"><code class="language-c++">#include<iostream>using namespace std;int main(){    class base    {        public:            virtual void vir_func(){ cout<<"virtual function, this is class base"<<endl; }            void func(){ cout<<"normal function, this is class base"<<endl; }    };    class A:public base    {        public:            virtual void vir_func(){cout<<"virtual function, this is class A"<<endl;}            void func(){cout<<"normal function, this is class A"<<endl;}    };    class B:public base    {        public:            virtual void vir_func(){cout<<"virtual function, this is class B"<<endl;}            void func(){cout <<"nomal function, this is class B"<<endl;}    };    base* Base = new(base); base* a = new(A); base*b=new(B);    Base->func(); a->func();b->func();    cout<<"#################################"<<endl;    Base->vir_func(); a->vir_func(); b->vir_func();    cout<<"#################################"<<endl;    ((A*)b)->vir_func(); ((A*)b)->func();    return 0;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰ç€çˆ¶ç±»å­ç±»è°ƒç”¨è™šå‡½æ•°å’Œæ™®é€šæˆå‘˜å‡½æ•°çš„åŒºåˆ«ï¼Œè¿˜æ˜¯éå¸¸æ˜æ˜¾çš„ï¼š</p><p><strong>æ³¨æ„è¿™é‡Œå®šä¹‰çš„æŒ‡é’ˆæœ¬æ¥éƒ½æ˜¯æŒ‡å‘çˆ¶ç±»çš„æŒ‡é’ˆä½†æ˜¯çœŸå®æŒ‡å‘å´ä¸ä¸€å®šæ˜¯çˆ¶ç±»</strong></p><p>å¯¹äºæ™®é€šç±»å‡½æ•°ï¼Œ<strong>æ²¡æœ‰å®šä¹‰è™šå‡½æ•°ä»…ä»…æ˜¯ä¸åŸºç±»çš„æˆå‘˜å‡½æ•°é‡åçš„å­ç±»ç±»æˆå‘˜å‡½æ•°</strong>ï¼ŒæŒ‡é’ˆæœ¬èº«å®šä¹‰æ—¶æŒ‡å‘çš„å°±æ˜¯åŸºç±»æ‰€ä»¥è°ƒç”¨çš„æ˜¯åŸºç±»çš„æ™®é€šå‡½æ•°ã€‚è¿™ä¸ªæ˜¯ç¬¦åˆæˆ‘ä»¬å‰é¢çš„è®¤çŸ¥çš„ã€‚</p><p>ä½†æ˜¯åˆ°äº†è™šå‡½æ•°è¿™é‡Œï¼Œbaseå®šä¹‰äº†ä¸€ä¸ªvirtualå‡½æ•°vir_funcï¼Œè€Œåå­ç±»Aï¼ŒBéƒ½ç»§æ‰¿åoverrideäº†è¿™ä¸ªè™šå‡½æ•°ï¼Œæˆ‘ä»¬å®ä¾‹åŒ–è¿™ä¸‰ä¸ªç±»åè°ƒç”¨è¿™äº›ç±»çš„æ—¶å€™ä¼šå‘ç°æˆ‘ä»¬æˆåŠŸçš„è°ƒç”¨äº†é‡å†™çš„ç±»ã€‚</p><p>è€Œè¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬å°†bè¿›è¡Œä¸€ä¸ªå¼ºåˆ¶ç±»å‹è½¬æ¢æˆAç±»ä¹‹åï¼Œè°ƒç”¨å®ƒçš„è™šå‡½æ•°å’Œæ™®é€šæˆå‘˜å‡½æ•°ï¼Œå´å‘ç°ä»–çš„è™šå‡½æ•°ä»ç„¶æ˜¯Bç±»çš„è™šå‡½æ•°ï¼Œæ™®é€šå‡½æ•°å˜ä¸ºäº†Aç±»çš„æ™®é€šæˆå‘˜å‡½æ•°ã€‚</p><p><em>ä»¥ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºâ€œ<strong>å½“ä½¿ç”¨ç±»çš„æŒ‡é’ˆè°ƒç”¨æˆå‘˜å‡½æ•°æ—¶ï¼Œæ™®é€šå‡½æ•°ç”±æŒ‡é’ˆç±»å‹å†³å®šï¼Œè€Œè™šå‡½æ•°ç”±æŒ‡é’ˆæŒ‡å‘çš„å®é™…ç±»å‹å†³å®š</strong>â€</em></p><p>å¦å¤–å…³äºç±»çš„å­˜å‚¨ï¼Œå¯¹äºä¸€ä¸ªåªåŒ…å«éé™æ€æˆå‘˜å˜é‡å’Œæ™®é€šæˆå‘˜å‡½æ•°çš„ç±»ï¼Œå¦‚ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">class C {  void fun_a();  void fun_b();  int var;};<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å†…å­˜å¸ƒå±€å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic2.zhimg.com/80/v2-2fbe21ff4350dad5b4d2832571836fa5_720w.jpg" alt="å›¾æºçŸ¥ä¹ï¼š@ArKin"></p><p>æˆå‘˜å‡½æ•°æ”¾åœ¨ä»£ç åŒºï¼Œä¸ºæ‰€æœ‰å¯¹è±¡å…¬æœ‰ï¼Œä¸ç®¡æ–°å»ºå¤šå°‘ä¸ªè¯¥ç±»çš„å¯¹è±¡ï¼Œå¯¹åº”çš„éƒ½æ˜¯åŒä¸€ä¸ªå‡½æ•°å­˜å‚¨åŒºçš„å‡½æ•°ã€‚è€Œæˆå‘˜å˜é‡æ˜¯å„ä¸ªå¯¹è±¡æ‰€ç§æœ‰çš„ï¼Œæ¯æ–°å»ºä¸€ä¸ªå¯¹è±¡éƒ½ä¼šæ–°å»ºä¸€å—å†…å­˜åŒºæ¥å­˜å‚¨varçš„å€¼ã€‚</p><p>è°ƒç”¨æˆå‘˜å‡½æ•°çš„æ—¶å€™ï¼Œç¨‹åºä¼šæ ¹æ®ç±»çš„ç±»å‹ï¼Œæ‰¾åˆ°å¯¹åº”ä»£ç åŒºæ‰€å¯¹åº”çš„å‡½æ•°å¹¶è¿›è¡Œè°ƒç”¨ã€‚æ‰€ä»¥ä¸Šé¢ç”±äºa,b,Baseéƒ½æ˜¯baseç±»å‹çš„æŒ‡é’ˆï¼ˆè™½ç„¶æŒ‡å‘å¹¶ä¸ä¸€å®šæ˜¯baseç±»å‹ï¼‰ï¼Œæ‰€ä»¥è°ƒç”¨æ™®é€šæˆå‘˜å‡½æ•°çš„æ—¶å€™ä»–ä»¬éƒ½è°ƒç”¨çš„æ˜¯baseç±»å‹çš„æŒ‡é’ˆã€‚</p><p>è€Œå¯¹äºåŒ…å«è™šå‡½æ•°çš„ç±»ï¼Œæ¯”å¦‚ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">class D{    void func_a();    virtual void func_b();    int var;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªçš„å†…å­˜å¸ƒå±€ä¸ºï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic4.zhimg.com/80/v2-cbb25357580cb5c7f46bcacb5918f28f_720w.jpg" alt="å›¾æºçŸ¥ä¹ï¼š@ArKin"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ªè™šå‡½æ•°æŒ‡é’ˆå®é™…ä¸Šå­˜åœ¨äº†å…¨å±€æ•°æ®åŒºï¼Œå¦‚æœæˆ‘ä»¬å¯¹äºè¿™ä¸ªDè¿›è¡Œsizeofï¼Œä¼šå‘ç°å®ƒä¼šæ¯”sizeof(C)å¤šå‡º4ä¸ªå­—èŠ‚ã€‚å¤šå‡ºæ¥è¿™å››ä¸ªå­—èŠ‚å°±æ˜¯è™šå‡½æ•°è¡¨æŒ‡é’ˆvptrã€‚è¿™ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸€å¼ åä¸ºâ€œè™šå‡½æ•°è¡¨â€(vtbl)çš„è¡¨ï¼Œè¡¨ä¸­çš„æ•°æ®éƒ½æ˜¯å‡½æ•°æŒ‡é’ˆï¼Œå­˜å‚¨äº†è™šå‡½æ•°fun_b()å…·ä½“å®ç°æ‰€å¯¹åº”çš„ä½ç½®ã€‚</p><p>æ³¨æ„ï¼Œæ™®é€šå‡½æ•°ã€è™šå‡½æ•°ã€è™šå‡½æ•°è¡¨éƒ½æ˜¯åŒä¸€ä¸ªç±»çš„æ‰€æœ‰å¯¹è±¡å…¬æœ‰çš„ï¼Œåªæœ‰æˆå‘˜å˜é‡å’Œè™šå‡½æ•°è¡¨æŒ‡é’ˆæ˜¯æ¯ä¸ªå¯¹è±¡ç§æœ‰çš„ï¼Œsizeofçš„å€¼ä¹ŸåªåŒ…æ‹¬vptrå’Œvaræ‰€å å†…å­˜çš„å¤§å°ï¼Œå¹¶ä¸”vptré€šå¸¸ä¼šåœ¨å¯¹è±¡å†…å­˜çš„æœ€èµ·å§‹ä½ç½®ã€‚å¦å¤–ï¼Œå½“ç±»æœ‰å¤šä¸ªè™šå‡½æ•°æ—¶ï¼Œä»ç„¶åªæœ‰ä¸€ä¸ªè™šå‡½æ•°è¡¨æŒ‡é’ˆvptrï¼ˆæŒ‡å‘ä¸€ä¸ªè™šå‡½æ•°è¡¨ï¼‰ï¼Œè€Œæ­¤æ—¶çš„è™šå‡½æ•°è¡¨vtblä¸­ä¼šæœ‰å¤šä¸ªå‡½æ•°æŒ‡é’ˆï¼Œåˆ†åˆ«æŒ‡å‘å¯¹åº”çš„è™šå‡½æ•°å®ç°åŒºåŸŸã€‚å› æ­¤ï¼Œè™šå‡½æ•°å®ç°çš„è¿‡ç¨‹æ˜¯ï¼š<strong>é€šè¿‡å¯¹è±¡å†…å­˜ä¸­çš„è™šå‡½æ•°æŒ‡é’ˆvptræ‰¾åˆ°è™šå‡½æ•°è¡¨vtblï¼Œå†é€šè¿‡vtblä¸­çš„å‡½æ•°æŒ‡é’ˆæ‰¾åˆ°å¯¹åº”è™šå‡½æ•°çš„å®ç°åŒºåŸŸå¹¶è¿›è¡Œè°ƒç”¨ã€‚</strong>æ‰€ä»¥è™šå‡½æ•°çš„è°ƒç”¨æ—¶ç”±æŒ‡é’ˆæ‰€æŒ‡å‘å†…å­˜å—çš„å…·ä½“ç±»å‹å†³å®šçš„ã€‚</p><h3 id="çº¯è™šå‡½æ•°"><a href="#çº¯è™šå‡½æ•°" class="headerlink" title="çº¯è™šå‡½æ•°"></a>çº¯è™šå‡½æ•°</h3><p>åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼ŒåŸºç±»æœ¬èº«ç”Ÿæˆå¯¹è±¡æ˜¯ä¸åˆæƒ…ç†çš„ã€‚ä¾‹å¦‚ï¼ŒåŠ¨ç‰©ä½œä¸ºä¸€ä¸ªåŸºç±»å¯ä»¥æ´¾ç”Ÿå‡ºè€è™ã€å­”é›€ç­‰å­ç±»ï¼Œä½†åŠ¨ç‰©æœ¬èº«ç”Ÿæˆå¯¹è±¡æ˜æ˜¾ä¸åˆå¸¸ç†ã€‚è€Œé’ˆå¯¹æ¯ç§åŠ¨ç‰©çš„æ–¹æ³•åˆæœ‰æ‰€ä¸åŒï¼Œæ­¤æ—¶éœ€è¦ä½¿ç”¨å¤šæ€ç‰¹æ€§ï¼Œä¹Ÿå°±éœ€è¦åœ¨åŸºç±»ä¸­å®šä¹‰è™šå‡½æ•°ã€‚</p><p>çº¯è™šå‡½æ•°æ˜¯åœ¨åŸºç±»ä¸­å£°æ˜çš„è™šå‡½æ•°ï¼Œå®ƒè¦æ±‚ä»»ä½•æ´¾ç”Ÿç±»éƒ½è¦å®šä¹‰è‡ªå·±çš„å®ç°æ–¹æ³•ï¼Œä»¥å®ç°å¤šæ€æ€§ã€‚å®ç°äº†çº¯è™šå‡½æ•°çš„å­ç±»ï¼Œè¯¥çº¯è™šå‡½æ•°åœ¨å­ç±»ä¸­å°±å˜æˆäº†è™šå‡½æ•°ã€‚</p><p>å®šä¹‰çº¯è™šå‡½æ•°æ˜¯ä¸ºäº†å®ç°ä¸€ä¸ªæ¥å£ï¼Œç”¨æ¥è§„èŒƒæ´¾ç”Ÿç±»çš„è¡Œä¸ºï¼Œä¹Ÿå³è§„èŒƒç»§æ‰¿è¿™ä¸ªç±»çš„ç¨‹åºå‘˜å¿…é¡»å®ç°è¿™ä¸ªå‡½æ•°ã€‚æ´¾ç”Ÿç±»ä»…ä»…åªæ˜¯ç»§æ‰¿å‡½æ•°çš„æ¥å£ã€‚çº¯è™šå‡½æ•°çš„æ„ä¹‰åœ¨äºï¼Œè®©æ‰€æœ‰çš„ç±»å¯¹è±¡ï¼ˆä¸»è¦æ˜¯æ´¾ç”Ÿç±»å¯¹è±¡ï¼‰éƒ½å¯ä»¥æ‰§è¡Œçº¯è™šå‡½æ•°çš„åŠ¨ä½œï¼Œä½†åŸºç±»æ— æ³•ä¸ºçº¯è™šå‡½æ•°æä¾›ä¸€ä¸ªåˆç†çš„ç¼ºçœå®ç°ã€‚æ‰€ä»¥ç±»çº¯è™šå‡½æ•°çš„å£°æ˜å°±æ˜¯åœ¨å‘Šè¯‰å­ç±»çš„è®¾è®¡è€…ï¼Œâ€œä½ å¿…é¡»æä¾›ä¸€ä¸ªçº¯è™šå‡½æ•°çš„å®ç°ï¼Œä½†æˆ‘ä¸çŸ¥é“ä½ ä¼šæ€æ ·å®ç°å®ƒâ€ã€‚</p><p>å«æœ‰çº¯è™šå‡½æ•°çš„ç±»ç§°ä¹‹ä¸ºæŠ½è±¡ç±»ï¼Œå®ƒä¸èƒ½ç”Ÿæˆå¯¹è±¡ï¼ˆåˆ›å»ºå®ä¾‹ï¼‰ï¼Œåªèƒ½åˆ›å»ºå®ƒçš„æ´¾ç”Ÿç±»çš„å®ä¾‹ã€‚æŠ½è±¡ç±»æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç±»ï¼Œå®ƒæ˜¯ä¸ºäº†æŠ½è±¡å’Œè®¾è®¡çš„ç›®çš„ä¸ºå»ºç«‹çš„ï¼Œå®ƒå¤„äºç»§æ‰¿å±‚æ¬¡ç»“æ„çš„è¾ƒä¸Šå±‚ã€‚æŠ½è±¡ç±»çš„ä¸»è¦ä½œç”¨æ˜¯å°†æœ‰å…³çš„æ“ä½œä½œä¸ºç»“æœæ¥å£ç»„ç»‡åœ¨ä¸€ä¸ªç»§æ‰¿å±‚æ¬¡ç»“æ„ä¸­ï¼Œç”±å®ƒæ¥ä¸ºæ´¾ç”Ÿç±»æä¾›ä¸€ä¸ªå…¬å…±çš„æ ¹ï¼Œæ´¾ç”Ÿç±»å°†å…·ä½“å®ç°åœ¨å…¶åŸºç±»ä¸­ä½œä¸ºæ¥å£çš„æ“ä½œã€‚</p><p>æŠ½è±¡ç±»åªèƒ½ä½œä¸ºåŸºç±»æ¥ä½¿ç”¨ï¼Œå…¶çº¯è™šå‡½æ•°çš„å®ç°ç”±æ´¾ç”Ÿç±»ç»™å‡ºã€‚å¦‚æœæ´¾ç”Ÿç±»ä¸­æ²¡æœ‰é‡æ–°å®šä¹‰çº¯è™šå‡½æ•°ï¼Œè€Œåªæ˜¯ç»§æ‰¿åŸºç±»çš„çº¯è™šå‡½æ•°ï¼Œåˆ™è¿™ä¸ªæ´¾ç”Ÿç±»ä»ç„¶è¿˜æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ã€‚å¦‚æœæ´¾ç”Ÿç±»ä¸­ç»™å‡ºäº†åŸºç±»çº¯è™šå‡½æ•°çš„å®ç°ï¼Œåˆ™è¯¥æ´¾ç”Ÿç±»å°±ä¸å†æ˜¯æŠ½è±¡ç±»äº†ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯ä»¥å»ºç«‹å¯¹è±¡çš„å…·ä½“çš„ç±»ã€‚</p><h3 id="è™šå‡½æ•°-vs-çº¯è™šå‡½æ•°ï¼Œå¦‚ä½•é€‰ç”¨ï¼Ÿ"><a href="#è™šå‡½æ•°-vs-çº¯è™šå‡½æ•°ï¼Œå¦‚ä½•é€‰ç”¨ï¼Ÿ" class="headerlink" title="è™šå‡½æ•° vs çº¯è™šå‡½æ•°ï¼Œå¦‚ä½•é€‰ç”¨ï¼Ÿ"></a>è™šå‡½æ•° vs çº¯è™šå‡½æ•°ï¼Œå¦‚ä½•é€‰ç”¨ï¼Ÿ</h3><ol><li>å½“åŸºç±»ä¸­çš„æŸä¸ªæˆå‘˜æ–¹æ³•ï¼Œåœ¨å¤§å¤šæ•°æƒ…å½¢ä¸‹éƒ½åº”è¯¥ç”±å­ç±»æä¾›ä¸ªæ€§åŒ–å®ç°ï¼Œä½†åŸºç±»ä¹Ÿå¯ä»¥æä¾›ç¼ºçœå¤‡é€‰æ–¹æ¡ˆçš„æ—¶å€™ï¼Œè¯¥æ–¹æ³•åº”è¯¥è®¾è®¡ä¸ºè™šå‡½æ•°ã€‚</li><li>å½“åŸºç±»ä¸­çš„æŸä¸ªæˆå‘˜æ–¹æ³•ï¼Œå¿…é¡»ç”±å­ç±»æä¾›ä¸ªæ€§åŒ–å®ç°çš„æ—¶å€™ï¼Œåº”è¯¥è®¾è®¡ä¸ºçº¯è™šå‡½æ•°ã€‚</li></ol><h3 id="æ„é€ ã€ææ„å‡½æ•°ä¸çº¯è™šå‡½æ•°ã€è™šå‡½æ•°å…³ç³»"><a href="#æ„é€ ã€ææ„å‡½æ•°ä¸çº¯è™šå‡½æ•°ã€è™šå‡½æ•°å…³ç³»" class="headerlink" title="æ„é€ ã€ææ„å‡½æ•°ä¸çº¯è™šå‡½æ•°ã€è™šå‡½æ•°å…³ç³»"></a>æ„é€ ã€ææ„å‡½æ•°ä¸çº¯è™šå‡½æ•°ã€è™šå‡½æ•°å…³ç³»</h3><ul><li>æ„é€ å‡½æ•°ï¼Œææ„å‡½æ•°å¯ä¸å¯ä»¥æ˜¯è™šå‡½æ•°ï¼Ÿï¼š<a href="https://blog.csdn.net/cjjwwss/article/details/11780827" target="_blank" rel="noopener">https://blog.csdn.net/cjjwwss/article/details/11780827</a></li><li>æ„é€ å‡½æ•°ï¼Œææ„å‡½æ•°å¯ä¸å¯ä»¥æ˜¯è™šå‡½æ•°ï¼Ÿï¼š<a href="https://segmentfault.com/a/1190000037627702" target="_blank" rel="noopener">https://segmentfault.com/a/1190000037627702</a></li><li>è™šå‡½æ•°ï¼Œçº¯è™šå‡½æ•°ï¼š<a href="https://zhuanlan.zhihu.com/p/37331092" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/37331092</a></li></ul><p><strong><em>To construct an object, a constructor needs the exact type of the object it is to create. Consequently, a constructor cannot be virtual. Furthermore, a constructor is not quite an ordinary function, In particular, it interacts with memory management in ways ordinary member functions donâ€™t. Consequently, you cannot have a ponter to a constructor.</em></strong></p><p><em>â€” From ã€ŠThe C++ Progamming Languageã€‹15.6.2</em></p><blockquote><p><em>ç­”æ¡ˆæ˜¯ï¼šæ„é€ å‡½æ•°ä¸èƒ½æ˜¯è™šå‡½æ•°ï¼Œææ„å‡½æ•°å¯ä»¥æ˜¯è™šå‡½æ•°ä¸”æ¨èæœ€å¥½è®¾ç½®ä¸ºè™šå‡½æ•°ã€‚</em></p><p><em>é¦–å…ˆï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“è™šå‡½æ•°çš„å®ç°åˆ™æ˜¯é€šè¿‡å¯¹è±¡å†…å­˜ä¸­çš„vptræ¥å®ç°çš„ã€‚è€Œæ„é€ å‡½æ•°æ˜¯ç”¨æ¥å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡çš„ï¼Œé€šä¿—æ¥è®²å°±æ˜¯ä¸ºå¯¹è±¡å†…å­˜ä¸­çš„å€¼åšåˆå§‹åŒ–æ“ä½œã€‚é‚£ä¹ˆåœ¨æ„é€ å‡½æ•°å®Œæˆä¹‹å‰ï¼Œä¹Ÿå³è¿˜æ²¡æœ‰è¿›è¡Œåˆå§‹åŒ–ï¼Œæ­¤æ—¶vptræ˜¯æ²¡æœ‰å€¼çš„ï¼Œä¹Ÿå°±æ— æ³•é€šè¿‡vptræ‰¾åˆ°ä½œä¸ºæ„é€ å‡½æ•°å’Œè™šå‡½æ•°æ‰€åœ¨çš„ä»£ç åŒºï¼Œæ‰€ä»¥æ„é€ å‡½æ•°åªèƒ½ä»¥æ™®é€šå‡½æ•°çš„å½¢å¼å­˜æ”¾åœ¨ç±»æ‰€æŒ‡å®šçš„ä»£ç åŒºä¸­ã€‚</em></p><p><em>è€Œå¯¹äºææ„å‡½æ•°ï¼Œå½“æˆ‘ä»¬delete(a)çš„æ—¶å€™ï¼Œå¦‚æœææ„å‡½æ•°ä¸æ˜¯è™šå‡½æ•°ï¼Œé‚£ä¹ˆè°ƒç”¨çš„å°†ä¼šæ˜¯åŸºç±»baseçš„ææ„å‡½æ•°ã€‚è€Œå½“ç»§æ‰¿çš„æ—¶å€™ï¼Œé€šå¸¸æ´¾ç”Ÿç±»ä¼šåœ¨åŸºç±»çš„åŸºç¡€ä¸Šå®šä¹‰è‡ªå·±çš„æˆå‘˜ï¼Œæ­¤æ—¶æˆ‘ä»¬å½“ç„¶å¸Œæœ›å¯ä»¥è°ƒç”¨æ´¾ç”Ÿç±»çš„ææ„å‡½æ•°å¯¹æ–°å®šä¹‰çš„æˆå‘˜ä¹Ÿè¿›è¡Œææ„ã€‚</em></p></blockquote><h2 id="ä¸€äº›å…³äºç»§æ‰¿-è™šå‡½æ•°çš„é¢˜"><a href="#ä¸€äº›å…³äºç»§æ‰¿-è™šå‡½æ•°çš„é¢˜" class="headerlink" title="ä¸€äº›å…³äºç»§æ‰¿+è™šå‡½æ•°çš„é¢˜"></a>ä¸€äº›å…³äºç»§æ‰¿+è™šå‡½æ•°çš„é¢˜</h2><ol><li>åˆ†æä¸‹é¢çš„ç¨‹åºï¼ŒæŒ‡å‡ºé”™è¯¯ä¹‹å¤„ï¼ˆè§£é‡Šé”™è¯¯åŸå› ï¼‰ï¼Œå¹¶å†™å‡ºmain()å‡½æ•°ä¸­æ¯æ¡æ­£ç¡®çš„æŒ‡ä»¤çš„å±å¹•è¾“å‡ºç»“æœã€‚</li></ol><pre class="line-numbers language-c++"><code class="language-c++">struct A {    int a = 0;    int x = 1;    void f() { cout << "A::f()"; }    virtual void g() { cout << "A::g()"; }    A(int x) { }};struct B: A {     int x = 11;    int y = 12;    virtual void f() { cout << "B::f()"; }    void g() { cout << "B::g()"; }    void h() { cout << "B::h()"; }    B(int x): A(x) { }};struct C: B {     int x = 21;    int y = 22;    int z = 23;    void f() { cout << "C::f()"; }    void g() { cout << "C::g()"; }    virtual void h() { cout << "C::h()"; }    C(int x): B(x) { }} c(1);int main() {    A *p = &c;    p->f();    p->g();    p->h();    cout << p->a;    cout << p->x;    cout << p->y;    cout << p->z;    /**/    B *q = &c;    q->f();    q->g();    q->h();    cout << p->a;    cout << q->x;    cout << q->y;    cout << q->z;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»“æœå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">    A *p = &c;    p->f();   // A::f()    p->g();   // C::g()    p->h();   // error    cout << p->a<<endl; // 0     cout << p->x<<endl; // 1     cout << p->y; // error     cout << p->z; // error    /**/    B *q = &c;     q->f();  // C::f()    q->g();  // C::g()    q->h();  // B::h()     cout << p->a<<endl; // 0    cout << q->x<<endl; // 11    cout << q->y<<endl; // 12    cout << q->z; // error<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><em>é€‰è‡ªç¬¬3æ¬¡ä½œä¸šç¬¬ä¸‰é¢˜</em></p><p>æ—¢ç„¶è¿™é‡Œå·²ç»å¼€å§‹è®²è§£å…³äºè™šå‡½æ•°å’Œçº¯è™šå‡½æ•°çš„ä¸€äº›ä¸œè¥¿äº†ï¼Œæˆ‘ä»¬è¿™é‡Œå°±ç»§ç»­å±•å¼€è®²è§£å…³äºè™šå‡½æ•°å’Œçº¯è™šå‡½æ•°çš„æœ‰å…³çŸ¥è¯†ã€‚</p><p>æœ¬æ–‡æ¥ä¸‹æ¥ä¸»è¦å‚è€ƒé‡‘è‰¯æµ·è€å¸ˆçš„PPTï¼š</p><h1 id="è™šå‡½æ•°-1"><a href="#è™šå‡½æ•°-1" class="headerlink" title="è™šå‡½æ•°"></a>è™šå‡½æ•°</h1><p>è™šå‡½æ•°ï¼šå³ç”¨virtualå®šä¹‰çš„æˆå‘˜å‡½æ•°ã€‚Javaå‡ ä¹æ‰€æœ‰å‡½æ•°éƒ½é»˜è®¤ä¸ºè™šå‡½æ•°ã€‚å½“åŸºç±»å¯¹è±¡æŒ‡é’ˆæˆ–å¼•ç”¨æŒ‡å‘æˆ–å¼•ç”¨ä¸åŒç±»å‹æ´¾ç”Ÿç±»å¯¹è±¡æ—¶ï¼Œé€šè¿‡è™šå‡½æ•°åˆ°åŸºç±»æˆ–æ´¾ç”Ÿç±»ä¸­åŒåå‡½æ•°çš„æ˜ å°„å®ç°(åŠ¨æ€)å¤šæ€ã€‚</p><p>åŠ¨æ€å¤šæ€ï¼š<strong>é‡è½½å‡½æ•°è¡¨ç°çš„æ˜¯é™æ€(ç¼–è¯‘æ—¶)å¤šæ€æ€§ï¼Œè™šå‡½æ•°è¡¨ç°çš„æ˜¯åŠ¨æ€(è¿è¡Œæ—¶)å¤šæ€æ€§ï¼š</strong>é‡è½½å‡½æ•°æ˜¯é™æ€å¤šæ€å‡½æ•°ï¼Œé€šè¿‡é™æ€ç»‘å®šè°ƒç”¨é‡è½½å‡½æ•°ï¼›è™šå‡½æ•°æ˜¯åŠ¨æ€å¤šæ€å‡½æ•°ï¼Œé€šè¿‡åŠ¨æ€ç»‘å®šè°ƒç”¨(è™šæ˜ å°„åˆ°å®)å‡½æ•°ã€‚åŠ¨æ€ç»‘å®šæ˜¯ç¨‹åºè¿è¡Œæ—¶è‡ªå·±å®Œæˆçš„ï¼Œé™æ€ç»‘å®šæ˜¯ç¼–è¯‘æˆ–æ“ä½œç³»ç»Ÿå®Œæˆçš„ã€‚</p><p>è™šå‡½æ•°çš„åŠ¨æ€ç»‘å®šé€šè¿‡å­˜å‚¨åœ¨å¯¹è±¡ä¸­çš„ä¸€ä¸ªæŒ‡é’ˆå®Œæˆï¼Œå› æ­¤è™šå‡½æ•°ä¸€å®šæœ‰this(æŒ‡å‘è¿™ä¸ªå¯¹è±¡ï¼‰ã€‚(è¯¥æŒ‡é’ˆæŒ‡å‘è™šå‡½æ•°å…¥å£åœ°å€è¡¨VFT)</p><p>ç†è§£è¿™äº›æ˜¯å¾ˆå…³é”®çš„ã€‚</p><h2 id="å…³äºç±»ç»§æ‰¿åŒåå˜é‡"><a href="#å…³äºç±»ç»§æ‰¿åŒåå˜é‡" class="headerlink" title="å…³äºç±»ç»§æ‰¿åŒåå˜é‡"></a>å…³äºç±»ç»§æ‰¿åŒåå˜é‡</h2><p>å¦‚æœæˆ‘ä»¬æ´¾ç”Ÿç±»ä¸­æœ‰ä¸€ä¸ªè‡ªå®šä¹‰çš„ä¸åŸºç±»åŒåçš„å˜é‡ã€‚å¦‚æœä¸ä½¿ç”¨<code>using</code>è¿™ç§æ¥æ”¹å˜å˜é‡è®¿é—®æƒé™çš„è¯ï¼Œå°±ä¸ä¼šæŠ¥é”™ã€‚ç±»ä¼¼è¿™ç§ ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">class A{public:    int d;};class B:public A{public:    int d;}y;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç±»ä¼¼äºè¿™ç§å°±ä¸ä¼šäº§ç”ŸæŠ¥é”™ï¼Œè¿™é‡Œæˆ‘ä»¬Bä¸­æœ‰ä¸¤ä¸ªå¯ç”¨å˜é‡ï¼Œä¸€ä¸ªæ˜¯åŸºç±»Açš„dï¼Œå¦ä¸€ä¸ªæ˜¯è‡ªå·±å®šä¹‰çš„dï¼Œè®¿é—®æƒé™éƒ½æ˜¯public.å¦‚æœæˆ‘ä»¬è°ƒç”¨ <code>y.d</code>ï¼Œé‚£ä¹ˆå°±è°ƒç”¨çš„Bçš„dã€‚è°ƒç”¨Açš„då°±éœ€è¦<code>y.A::d</code>ã€‚å½“ç„¶å¦‚æœæˆ‘ä»¬æ²¡æœ‰åœ¨Bå†…å•ç‹¬å®šä¹‰dï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥è°ƒç”¨<code>y.d</code>è¿™ä¸ªæ—¶å€™è°ƒç”¨çš„å°±æ˜¯åŸºç±»Açš„däº†ã€‚</p><p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬ä½¿ç”¨<code>using</code>æ¥æ”¹å˜æ´¾ç”Ÿç±»ç»§æ‰¿åŸºç±»çš„æˆå‘˜è®¿é—®æƒé™çš„æ—¶å€™ï¼Œå°±ä¸å¯ä»¥å®šä¹‰åŒåå˜é‡ã€‚è¿™æ ·ä¼šå¯¼è‡´å†²çªã€‚</p><pre class="line-numbers language-c++"><code class="language-c++">class A{protected:    int a;};class B:public A{public:    using A::a;    int a;};<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åƒè¿™ç§å°±ä¼šå‡ºç°æŠ¥é”™ï¼Œå› ä¸ºè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨<code>using</code>æ”¹å˜è®¿é—®æƒé™çš„æ—¶å€™ï¼ŒA::aå°±ç›¸å½“äºæ˜¯Bç±»è‡ªå·±çš„äº†ï¼Œå½“ç„¶å°±ä¸èƒ½åœ¨ç±»å†…å®šä¹‰ä¸€ä¸ªåŒåçš„å˜é‡äº†ã€‚ </p><p><em>note: æ³¨æ„è¿™é‡ŒåŒæ ·ä¹Ÿä¸èƒ½è¯´åœ¨å…¶ä»–è®¿é—®æƒé™å®šä¹‰ä¸€ä¸ªæ–°å˜é‡ï¼ŒåŒæ ·ä¹Ÿä¼šæŠ¥é”™ï¼š</em></p><pre class="line-numbers language-c++"><code class="language-c++">class A{protected:    int a;};class B:public A{protected:    int a;public:    using A::a;};<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><em>åŒæ ·ä¹Ÿä¼šæŠ¥é”™ã€‚</em></p><h2 id="å…³äºæ„é€ å‡½æ•°ä¸€äº›é—®é¢˜"><a href="#å…³äºæ„é€ å‡½æ•°ä¸€äº›é—®é¢˜" class="headerlink" title="å…³äºæ„é€ å‡½æ•°ä¸€äº›é—®é¢˜"></a>å…³äºæ„é€ å‡½æ•°ä¸€äº›é—®é¢˜</h2><p>å¦‚æœåŸºç±»åªå®šä¹‰äº†éæ— å‚æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆæ´¾ç”Ÿç±»å®šä¹‰è‡ªå·±çš„åˆå§‹åŒ–å‡½æ•°çš„æ—¶å€™å¿…é¡»è¦å£°æ˜å®šä¹‰åŸºç±»çš„æ„é€ å‡½æ•°ï¼Œå› ä¸ºæ­¤æ—¶ç¼–è¯‘å™¨ä¸ä¼šè‡ªåŠ¨ç»™åŸºç±»ç”Ÿæˆæ— å‚æ„é€ å‡½æ•°ã€‚æ‰€ä»¥è°ƒç”¨æ— æ³•è°ƒç”¨æ— å‚æ„é€ å‡½æ•°ã€‚<br>æ¯”å¦‚è¯´ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">class A{public:    A(int x){cout<<"A\n";};};int main(){    A a;    return 0;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·çš„ä»£ç ç¼–è¯‘å™¨ç¼–è¯‘ä¼šæ— æ³•é€šè¿‡ï¼Œå› ä¸ºæ­¤æ—¶ä¼šå‡ºç°æŠ¥é”™<code>error: no matching function for call to â€˜A::A()â€™</code>ä¹Ÿå°±æ˜¯æ²¡æœ‰æ‰¾ä¸åˆ°æ— å‚æ„é€ å‡½æ•°æ¥å®ä¾‹åŒ–å¯¹è±¡ã€‚ç¼–è¯‘å™¨æ²¡æœ‰ç”Ÿæˆæ— å‚æ„é€ å‡½æ•°ã€‚</p><p>è€Œå¦‚æœæˆ‘ä»¬æƒ³è¦æ”¹å˜è¿™ç§æƒ…å†µï¼Œä¹Ÿå°±æ˜¯è®©ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªæ— å‚æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦è¿™æ ·æ“ä½œï¼ŒåŠ ä¸€ä¸ª<code>A()=default;</code></p><pre class="line-numbers language-c++"><code class="language-c++">class A{public:    A(int x){cout<<"A\n";};    A()=default;};int main(){    A a;    return 0;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·çš„è¯ç¨‹åºå°±æ²¡æœ‰é—®é¢˜äº†ï¼Œä¸ä¼šæŠ¥é”™äº†ã€‚</p><p>åŒæ ·çš„ï¼Œæˆ‘ä»¬ç”¨åˆ°ç±»çš„ç»§æ‰¿åŒæ ·æ˜¯è¿™æ ·ã€‚æ¯”å¦‚æˆ‘ä»¬Bç±»ç»§æ‰¿äº†Açš„ç±»ï¼Œå†™ç»§æ‰¿å‡½æ•°çš„æ—¶å€™ä¹Ÿéœ€è¦è°ƒç”¨ç›¸åº”çš„Açš„æœ‰å‚æ„é€ ï¼ˆ<del>å½“ç¼–è¯‘å™¨ä¸è‡ªåŠ¨ç”Ÿæˆæ— å‚æ„é€ çš„æ—¶å€™</del>ï¼‰ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">class A{public:    A(int x){cout<<"A\n";};    // A() = default;};class B:public A{    B(){cout<<"B\n";};};<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·çš„è¯ç¨‹åºå°±ä¼šæŠ¥é”™ã€‚å› ä¸ºç»§æ‰¿äº†Açš„åŸºç±»ï¼Œä½†æ˜¯çˆ¶ç±»å¹¶æ²¡æœ‰æ— å‚æ„é€ å‡½æ•°å¯ä¾›åˆå§‹åŒ–è°ƒç”¨ã€‚ç¼–è¯‘å™¨æ­¤æ—¶ä¸ä¼šè‡ªåŠ¨ç”Ÿæˆæ— å‚æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»è°ƒç”¨æœ‰å‚æ„é€ å‡½æ•°ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">class A{public:    A(int x){cout<<"A\n";};    // A() = default;};class B:public A{    B():A(3){cout<<"B\n";};};<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·çš„è¯å°±ä¸ä¼šæŠ¥é”™ã€‚<br>å¦å¤–å¦‚æœæˆ‘ä»¬å°±æƒ³ç”¨ç¼–è¯‘å™¨ç”Ÿæˆçš„æ— å‚æ„é€ ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä»ç„¶å¯ä»¥ä½¿ç”¨<code>A()=default;</code>:</p><pre class="line-numbers language-c++"><code class="language-c++">class A{public:    A(int x){cout<<"A\n";};    A() = default;};class B:public A{    B(){cout<<"B\n";};};<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·å°±å¯ä»¥äº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Word Embedding(å·²æ”¾å¼ƒ)</title>
      <link href="/2021/10/17/word-embedding/"/>
      <url>/2021/10/17/word-embedding/</url>
      
        <content type="html"><![CDATA[<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>äº‹å®ä¸Šï¼Œæˆ‘ç›®å‰å·²çŸ¥çš„ç¼–ç ä¹Ÿå°±ä¸€ä¸ªOne-hotç¼–ç ï¼Œè¿™ä¸ªç¡®å®ç”±äºä¹‹å‰ä¸æ€ä¹ˆç®¡NLPè¿™ä¸ªé¢†åŸŸæ‰€ä»¥è¿™æ–¹é¢çš„çŸ¥è¯†å¹¶æ²¡æœ‰å¾ˆæ·±çš„å»ç ”ç©¶å­¦ä¹ ã€‚ç°åœ¨å­¦åˆ°transformeræˆ‘è§‰å¾—æœ‰å¿…è¦å­¦ä¸€ä¸‹æœ‰å…³çš„çŸ¥è¯†ã€‚æ¥ä¸‹æ¥å°±æ˜¯æœ‰å…³Word Embeddingçš„ä¸€äº›ä»‹ç»è®²è§£ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211017212806.png" alt="Preface"></p><p>æ­£å¦‚ä¸Šå›¾ï¼Œæˆ‘ä»¬æœ€åˆçš„è¯å­¦ä¹ çš„ç¼–ç å«åšOne-hotç¼–ç ï¼Œè¿™ä¸ªç¼–ç ç¡®å®èƒ½å¤Ÿå°†æ‰€æœ‰çš„å­—è¯éƒ½ç”¨å‘é‡è¡¨ç¤ºå‡ºæ¥ï¼Œä½†æ˜¯å®é™…ä¸Šè¿™ä¸ªç¼–ç é—®é¢˜è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œåœ¨self-attentioné‚£ä¸€ç« èŠ‚æˆ‘ä»¬ä¹Ÿæœ‰æåˆ°è¿‡ï¼Œé«˜ç»´ç¨€ç–çŸ©é˜µå ç”¨äº†å¤§é‡çš„ç©ºé—´æ˜¯ä¸€æ–¹é¢ï¼Œå¦ä¸€æ–¹é¢å°±æ˜¯è¿™ä¸ªç¼–ç é»˜è®¤äº†æ‰€æœ‰å‘é‡æ˜¯å®Œå…¨æ²¡æœ‰å…³ç³»çš„ï¼Œè¯ä¹‹é—´å®Œå…¨æ²¡æœ‰è”ç³»ã€‚è®¸è®¸å¤šå¤šæœ‰å…³è”çš„ä¿¡æ¯ã€æœ‰è”ç³»ç”šè‡³æ˜¯ç›¸ä¼¼çš„å‘é‡æ²¡æœ‰èƒ½å¤Ÿæ”¾åˆ°ä¸€èµ·ï¼Œè¿™ä¸ªæ˜¯éå¸¸ä¸å¥½çš„ã€‚</p><p>æ‰€ä»¥å°±å‡ºç°äº†ä¸€ç§æ–¹æ³•å«åšWord Classè¿™ä¸ªæ–¹æ³•ã€‚è¿™ä¸ªæ˜¯ç”¨æ¥ç›¸å½“äºä¸€ä¸ªclustering, å°†ä¸€äº›ç›¸ä¼¼æˆ–æ˜¯åŒä¸€åˆ†ç±»çš„è¯éƒ½clusteringä¸€ä¸ªç±»ï¼Œç„¶åå°±éƒ½ä»¥ä¸€ç±»æ¥ä»£æ›¿ã€‚ä½†æ˜¯å…‰åšclusteringæ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºè¿™ä¸ªä»ç„¶æ²¡æœ‰è”ç³»åˆ°å„ä¸ªclusterçš„è”ç³»ï¼Œç±»ä¸ç±»ä¹‹é—´éƒ½æœ‰ç€è®¸è®¸å¤šå¤šçš„å…³è”å¯¼è‡´æˆ‘ä»¬å¯èƒ½æ²¡æœ‰åŠæ³•è¿›ä¸€æ­¥çš„æœ‰æ‰€è”ç³»ã€‚</p><p>æ¥ç€æˆ‘ä»¬ä¸ºäº†è¿›ä¸€æ­¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°±æå‡ºäº†Word Embedding, è¿›ä¸€æ­¥å°†æˆ‘ä»¬çš„æ¯ä¸€ä¸ªwordéƒ½projectionåˆ°ä¸€ä¸ªhigh dimension spaceä¸Šé¢ã€‚è™½ç„¶è¯´æ˜¯<code>high dimension</code>ä½†æ˜¯å…¶å®å®ƒçš„dimensionè¿œæ¯”æˆ‘ä»¬çš„One-hotçš„dimensionè¦ä½ã€‚ä¸€èˆ¬One-hotæœ‰å¤šå°‘ä¸ªè¯å°±æ˜¯å¤šå°‘ç»´ï¼Œä½†æ˜¯Word Embeddingå°±ä¼šä¸€èˆ¬ä¹Ÿå°±æ˜¯100ç»´ã€50ç»´è¿™ä¸ªæ ·å­ã€‚</p><h1 id="ç»è¿‡æˆ‘çš„è°ƒç ”ï¼Œå‘ç°è¿™ä¸ªæ²¡æœ‰å¿…è¦å»å­¦ï¼Œå®Œå…¨å¯ä»¥è°ƒåŒ…ä¾ ï¼Œç®—äº†ç®—äº†ï¼Œå½»åº•æ”¾å¼ƒã€‚"><a href="#ç»è¿‡æˆ‘çš„è°ƒç ”ï¼Œå‘ç°è¿™ä¸ªæ²¡æœ‰å¿…è¦å»å­¦ï¼Œå®Œå…¨å¯ä»¥è°ƒåŒ…ä¾ ï¼Œç®—äº†ç®—äº†ï¼Œå½»åº•æ”¾å¼ƒã€‚" class="headerlink" title="ç»è¿‡æˆ‘çš„è°ƒç ”ï¼Œå‘ç°è¿™ä¸ªæ²¡æœ‰å¿…è¦å»å­¦ï¼Œå®Œå…¨å¯ä»¥è°ƒåŒ…ä¾ ï¼Œç®—äº†ç®—äº†ï¼Œå½»åº•æ”¾å¼ƒã€‚"></a>ç»è¿‡æˆ‘çš„è°ƒç ”ï¼Œå‘ç°è¿™ä¸ªæ²¡æœ‰å¿…è¦å»å­¦ï¼Œå®Œå…¨å¯ä»¥è°ƒåŒ…ä¾ ï¼Œç®—äº†ç®—äº†ï¼Œå½»åº•æ”¾å¼ƒã€‚</h1>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nlp </tag>
            
            <tag> ç¼–ç  </tag>
            
            <tag> Word Embedding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>YOLOv3æºç è§£è¯»(è¿œè¿œæ²¡å†™å®Œ)</title>
      <link href="/2021/10/17/yolov3-yuan-ma-jie-du/"/>
      <url>/2021/10/17/yolov3-yuan-ma-jie-du/</url>
      
        <content type="html"><![CDATA[<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>ä¸å¾—ä¸è¯´è¿˜æ˜¯çœ‹æºç èƒ½å¤Ÿæ›´å¥½äº†è§£ä¸€ä¸ªæ¨¡å‹çš„åŸºæœ¬å®ç°ï¼Œ<em>talk is cheap</em>, åªæœ‰codeå†™å‡ºæ¥åè¿è¡Œå‡ºç›¸åº”çš„ç»“æœæˆ‘ä»¬æ‰æ•¢è¯´è¿™ä¸ªmodelsæˆ–è€…è¯´è¿™ä¸ªideasç¡®å®ä¸é”™ï¼Œè™½ç„¶å¯èƒ½è¿™ä¸ªä»£ç å†™èµ·æ¥å¾ˆå›°éš¾æˆ–è€…è¯»æ‡‚å¾ˆå›°éš¾ï¼Œä½†æ˜¯ç›¸åº”çš„è¯»æ‡‚æºç å¸¦æ¥çš„æ”¶ç›Šæ˜¯éå¸¸å·¨å¤§çš„ã€‚</p><blockquote><p>æºç åœ°å€ï¼š<a href="https://github.com/ultralytics/yolov3" target="_blank" rel="noopener">https://github.com/ultralytics/yolov3</a></p></blockquote><p>YOLOv3ï¼Œèµ°èµ·ï¼</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211017152727.png" alt></p><p>ä¸mmdetectionä¸åŒçš„æ˜¯ï¼Œæˆ‘ä»¬è¿™é‡Œå…ˆçœ‹ä¸€ä¸‹inferenceéƒ¨åˆ†çš„ä»£ç è¿è¡Œï¼Œä¹‹åå†æ¥ç€çœ‹æ€ä¹ˆä½¿ç”¨æ€ä¹ˆç»§ç»­è¿è¡Œã€‚</p><h1 id="detect-py"><a href="#detect-py" class="headerlink" title="detect.py"></a>detect.py</h1><h2 id="Preface-1"><a href="#Preface-1" class="headerlink" title="Preface"></a>Preface</h2><p><strong>Inference</strong></p><p><code>detect.py</code> runs YOLOv3 inference on a variety of sources, downloading models automatically from the <a href="https://github.com/ultralytics/yolov3/releases" target="_blank" rel="noopener">latest YOLOv3 release</a>, and saving results to <code>runs/detect</code>. Example inference sources are:</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://user-images.githubusercontent.com/26833433/114307955-5c7e4e80-9ae2-11eb-9f50-a90e39bee53f.png" width="900"> <p>å¯ä»¥çœ‹å‡ºdetect.pyé€‚ç”¨åœºæ™¯è¿˜æ˜¯æ¯”è¾ƒå¤šçš„ã€‚å¦å¤–æˆ‘ä»¬éœ€è¦æ³¨æ„ä»¥ä¸Šè¿è¡Œçš„æ ¼å¼ï¼Œå½“ç„¶è¿™åªæ˜¯ä¸€ä¸ªå°éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹ä¸€ä¸ªè¿è¡Œçš„ç»“æœï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211017155303.png" alt="image-20211017155301347"></p><p>é¦–å…ˆè¿˜æ˜¯çœ‹ä¸€ä¸‹éƒ½æœ‰å“ªäº›å‚æ•°å¯ä»¥ä½¿ç”¨çš„ï¼š</p><blockquote><p>lry@ubuntu ~/projects/yolov3 % python detect.py -h<br>usage: detect.py [-h] [â€“weights WEIGHTS [WEIGHTS â€¦]] [â€“source SOURCE]<br>                 [â€“img-size IMG_SIZE] [â€“conf-thres CONF_THRES]<br>                 [â€“iou-thres IOU_THRES] [â€“max-det MAX_DET] [â€“device DEVICE]<br>                 [â€“view-img] [â€“save-txt] [â€“save-conf] [â€“save-crop]<br>                 [â€“nosave] [â€“classes CLASSES [CLASSES â€¦]] [â€“agnostic-nms]<br>                 [â€“augment] [â€“update] [â€“project PROJECT] [â€“name NAME]<br>                 [â€“exist-ok] [â€“line-thickness LINE_THICKNESS]<br>                 [â€“hide-labels] [â€“hide-conf]</p><p>optional arguments:<br>  -h, â€“help            show this help message and exit<br>  â€“weights WEIGHTS [WEIGHTS â€¦]<br>                        model.pt path(s)<br>  â€“source SOURCE       source<br>  â€“img-size IMG_SIZE   inference size (pixels)<br>  â€“conf-thres CONF_THRES<br>                        object confidence threshold<br>  â€“iou-thres IOU_THRES<br>                        IOU threshold for NMS<br>  â€“max-det MAX_DET     maximum number of detections per image<br>  â€“device DEVICE       cuda device, i.e. 0 or 0,1,2,3 or cpu<br>  â€“view-img            display results<br>  â€“save-txt            save results to *.txt<br>  â€“save-conf           save confidences in â€“save-txt labels<br>  â€“save-crop           save cropped prediction boxes<br>  â€“nosave              do not save images/videos<br>  â€“classes CLASSES [CLASSES â€¦]<br>                        filter by class: â€“class 0, or â€“class 0 2 3<br>  â€“agnostic-nms        class-agnostic NMS<br>  â€“augment             augmented inference<br>  â€“update              update all models<br>  â€“project PROJECT     save results to project/name<br>  â€“name NAME           save results to project/name<br>  â€“exist-ok            existing project/name ok, do not increment<br>  â€“line-thickness LINE_THICKNESS<br>                        bounding box thickness (pixels)<br>  â€“hide-labels         hide labels<br>  â€“hide-conf           hide confidences</p></blockquote><p>å¯ä»¥çœ‹å‡ºå‚æ•°è¿˜æ˜¯è›®å¤šçš„ï¼Œå¹¶ä¸”å…¨éƒ½æ˜¯å¯é€‰çš„å‚æ•°ï¼Œè¿™é‡Œè‚¯å®šä¸èƒ½å…¨éƒ¨éƒ½ä»‹ç»ä¸€éï¼Œæˆ‘ä»¬è¿˜æ˜¯åˆ°æ—¶å€™è¾¹çœ‹æºç è¾¹è¯´ã€‚</p><h2 id="main"><a href="#main" class="headerlink" title="__main__"></a><code>__main__</code></h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    parser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--weights'</span><span class="token punctuation">,</span> nargs<span class="token operator">=</span><span class="token string">'+'</span><span class="token punctuation">,</span> type<span class="token operator">=</span>str<span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">'yolov3.pt'</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'model.pt path(s)'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--source'</span><span class="token punctuation">,</span> type<span class="token operator">=</span>str<span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">'data/images'</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'source'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># file/folder, 0 for webcam</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--img-size'</span><span class="token punctuation">,</span> type<span class="token operator">=</span>int<span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">640</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'inference size (pixels)'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--conf-thres'</span><span class="token punctuation">,</span> type<span class="token operator">=</span>float<span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">0.25</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'object confidence threshold'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--iou-thres'</span><span class="token punctuation">,</span> type<span class="token operator">=</span>float<span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">0.45</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'IOU threshold for NMS'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--max-det'</span><span class="token punctuation">,</span> type<span class="token operator">=</span>int<span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'maximum number of detections per image'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--device'</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'cuda device, i.e. 0 or 0,1,2,3 or cpu'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--view-img'</span><span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">'store_true'</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'display results'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--save-txt'</span><span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">'store_true'</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'save results to *.txt'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--save-conf'</span><span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">'store_true'</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'save confidences in --save-txt labels'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--save-crop'</span><span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">'store_true'</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'save cropped prediction boxes'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--nosave'</span><span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">'store_true'</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'do not save images/videos'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--classes'</span><span class="token punctuation">,</span> nargs<span class="token operator">=</span><span class="token string">'+'</span><span class="token punctuation">,</span> type<span class="token operator">=</span>int<span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'filter by class: --class 0, or --class 0 2 3'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--agnostic-nms'</span><span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">'store_true'</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'class-agnostic NMS'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--augment'</span><span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">'store_true'</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'augmented inference'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--update'</span><span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">'store_true'</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'update all models'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--project'</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">'runs/detect'</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'save results to project/name'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--name'</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">'exp'</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'save results to project/name'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--exist-ok'</span><span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">'store_true'</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'existing project/name ok, do not increment'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--line-thickness'</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> type<span class="token operator">=</span>int<span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'bounding box thickness (pixels)'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--hide-labels'</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">'store_true'</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'hide labels'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--hide-conf'</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">'store_true'</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'hide confidences'</span><span class="token punctuation">)</span>    opt <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>opt<span class="token punctuation">)</span>    check_requirements<span class="token punctuation">(</span>exclude<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'tensorboard'</span><span class="token punctuation">,</span> <span class="token string">'pycocotools'</span><span class="token punctuation">,</span> <span class="token string">'thop'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> opt<span class="token punctuation">.</span>update<span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># update all models (to fix SourceChangeWarning)</span>        <span class="token keyword">for</span> opt<span class="token punctuation">.</span>weights <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">'yolov3.pt'</span><span class="token punctuation">,</span> <span class="token string">'yolov3-spp.pt'</span><span class="token punctuation">,</span> <span class="token string">'yolov3-tiny.pt'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>            detect<span class="token punctuation">(</span>opt<span class="token operator">=</span>opt<span class="token punctuation">)</span>            strip_optimizer<span class="token punctuation">(</span>opt<span class="token punctuation">.</span>weights<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        detect<span class="token punctuation">(</span>opt<span class="token operator">=</span>opt<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¼€å¤´ä¾¿æ˜¯åŠ äº†è®¸å¤šçš„shellä¸­è¾“å…¥çš„å‚æ•°ï¼Œç„¶åæˆ‘ä»¬å¼€å§‹è¾“å‡ºè¿™äº›é…ç½®ï¼Œè¾“å‡ºä¹‹åè°ƒç”¨å‡½æ•°<code>check_requirements()</code>è¿›è¡Œæ£€æŸ¥æ˜¯å¦æˆ‘ä»¬çš„ç‰ˆæœ¬åˆé€‚ã€ç¯å¢ƒé…ç½®æ˜¯å¦æœ‰é—®é¢˜ï¼Œ(excludeè¡¨ç¤ºä¸æ£€æŸ¥ä¸€äº›ä¸œè¥¿çš„ç‰ˆæœ¬)ï¼Œå½“ç„¶è¿™é‡Œå°±ä¸å»çœ‹è¿™ä¸ªå‡½æ•°äº†ï¼Œæ²¡å•¥å¥½çœ‹çš„ï¼Œæ¯•ç«Ÿå°±æ˜¯æ£€æŸ¥ç‰ˆæœ¬ã€‚ä¸è¿‡ä¹‹åæ£€æŸ¥ç‰ˆæœ¬å¯ä»¥å‚è€ƒè¿™é‡Œçš„æ£€æŸ¥æ–¹å¼ï¼ˆå¦‚æœæ˜¯çº¯ç²¹å­¦ä¹ pythonçš„è¯è¿˜æ˜¯æœ‰ä¸€äº›çœ‹çš„å¿…è¦çš„ï¼‰ã€‚</p><p>å¦å¤–å°±æ˜¯å‡ è¡Œæ¯”è¾ƒé‡è¦çš„ä»£ç äº†ï¼Œé¦–å…ˆåˆ¤æ–­äº†ä¸€ä¸‹æ˜¯å¦<code>opt.update is none</code>, åˆ¤æ–­å®Œä¹‹åå°±ç»§ç»­å¯¹äºä¸åŒçš„è¿›è¡Œç›¸å…³çš„detectï¼Œè¿™é‡Œå®é™…ä¸Šæˆ‘æ²¡æœ‰å¤ªçœ‹æ‡‚ï¼Œè‡³äºè¿™äº›ä¸ª.ptæ–‡ä»¶å®é™…ä¸Šå’Œæˆ‘ä»¬å¸¸è§çš„.pthã€.pklæ˜¯ä¸€æ ·çš„ï¼Œæ ¼å¼å®Œå…¨ç›¸åŒï¼Œä»…ä»…æ˜¯åç¼€ä¸åŒï¼ˆ<strong>ä»…æ­¤è€Œå·²</strong>ï¼‰ã€‚éƒ½æ˜¯æ¨¡å‹çš„æƒé‡ï¼Œæƒ¯ä¾‹æ˜¯ä½¿ç”¨.pthï¼Œä½†æ˜¯å®˜æ–¹å¯èƒ½ç”¨.ptæ›´å¤šä¸€äº›ã€‚</p><p>æˆ‘ä»¬ç€é‡æ¥çœ‹ä¸€ä¸‹å‡½æ•°<code>detect()</code>.</p><h2 id="detect"><a href="#detect" class="headerlink" title="detect"></a>detect</h2><pre class="line-numbers language-python"><code class="language-python">@torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">detect</span><span class="token punctuation">(</span>opt<span class="token punctuation">)</span><span class="token punctuation">:</span>    source<span class="token punctuation">,</span> weights<span class="token punctuation">,</span> view_img<span class="token punctuation">,</span> save_txt<span class="token punctuation">,</span> imgsz <span class="token operator">=</span> opt<span class="token punctuation">.</span>source<span class="token punctuation">,</span> opt<span class="token punctuation">.</span>weights<span class="token punctuation">,</span> opt<span class="token punctuation">.</span>view_img<span class="token punctuation">,</span> opt<span class="token punctuation">.</span>save_txt<span class="token punctuation">,</span> opt<span class="token punctuation">.</span>img_size    save_img <span class="token operator">=</span> <span class="token operator">not</span> opt<span class="token punctuation">.</span>nosave <span class="token operator">and</span> <span class="token operator">not</span> source<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">'.txt'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># save inference images</span>    webcam <span class="token operator">=</span> source<span class="token punctuation">.</span>isnumeric<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">or</span> source<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">'.txt'</span><span class="token punctuation">)</span> <span class="token operator">or</span> source<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>startswith<span class="token punctuation">(</span>        <span class="token punctuation">(</span><span class="token string">'rtsp://'</span><span class="token punctuation">,</span> <span class="token string">'rtmp://'</span><span class="token punctuation">,</span> <span class="token string">'http://'</span><span class="token punctuation">,</span> <span class="token string">'https://'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># Directories</span>    save_dir <span class="token operator">=</span> increment_path<span class="token punctuation">(</span>Path<span class="token punctuation">(</span>opt<span class="token punctuation">.</span>project<span class="token punctuation">)</span> <span class="token operator">/</span> opt<span class="token punctuation">.</span>name<span class="token punctuation">,</span> exist_ok<span class="token operator">=</span>opt<span class="token punctuation">.</span>exist_ok<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># increment run</span>    <span class="token punctuation">(</span>save_dir <span class="token operator">/</span> <span class="token string">'labels'</span> <span class="token keyword">if</span> save_txt <span class="token keyword">else</span> save_dir<span class="token punctuation">)</span><span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>parents<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># make dir</span>    <span class="token comment" spellcheck="true"># Initialize</span>    set_logging<span class="token punctuation">(</span><span class="token punctuation">)</span>    device <span class="token operator">=</span> select_device<span class="token punctuation">(</span>opt<span class="token punctuation">.</span>device<span class="token punctuation">)</span>    half <span class="token operator">=</span> device<span class="token punctuation">.</span>type <span class="token operator">!=</span> <span class="token string">'cpu'</span>  <span class="token comment" spellcheck="true"># half precision only supported on CUDA</span>    <span class="token comment" spellcheck="true"># Load model</span>    model <span class="token operator">=</span> attempt_load<span class="token punctuation">(</span>weights<span class="token punctuation">,</span> map_location<span class="token operator">=</span>device<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># load FP32 model</span>    stride <span class="token operator">=</span> int<span class="token punctuation">(</span>model<span class="token punctuation">.</span>stride<span class="token punctuation">.</span>max<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># model stride</span>    imgsz <span class="token operator">=</span> check_img_size<span class="token punctuation">(</span>imgsz<span class="token punctuation">,</span> s<span class="token operator">=</span>stride<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># check img_size</span>    names <span class="token operator">=</span> model<span class="token punctuation">.</span>module<span class="token punctuation">.</span>names <span class="token keyword">if</span> hasattr<span class="token punctuation">(</span>model<span class="token punctuation">,</span> <span class="token string">'module'</span><span class="token punctuation">)</span> <span class="token keyword">else</span> model<span class="token punctuation">.</span>names  <span class="token comment" spellcheck="true"># get class names</span>    <span class="token keyword">if</span> half<span class="token punctuation">:</span>        model<span class="token punctuation">.</span>half<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># to FP16</span>    <span class="token comment" spellcheck="true"># Second-stage classifier</span>    classify <span class="token operator">=</span> <span class="token boolean">False</span>    <span class="token keyword">if</span> classify<span class="token punctuation">:</span>        modelc <span class="token operator">=</span> load_classifier<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'resnet101'</span><span class="token punctuation">,</span> n<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># initialize</span>        modelc<span class="token punctuation">.</span>load_state_dict<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">'weights/resnet101.pt'</span><span class="token punctuation">,</span> map_location<span class="token operator">=</span>device<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'model'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">.</span>eval<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># Set Dataloader</span>    vid_path<span class="token punctuation">,</span> vid_writer <span class="token operator">=</span> None<span class="token punctuation">,</span> None    <span class="token keyword">if</span> webcam<span class="token punctuation">:</span>        view_img <span class="token operator">=</span> check_imshow<span class="token punctuation">(</span><span class="token punctuation">)</span>        cudnn<span class="token punctuation">.</span>benchmark <span class="token operator">=</span> <span class="token boolean">True</span>  <span class="token comment" spellcheck="true"># set True to speed up constant image size inference</span>        dataset <span class="token operator">=</span> LoadStreams<span class="token punctuation">(</span>source<span class="token punctuation">,</span> img_size<span class="token operator">=</span>imgsz<span class="token punctuation">,</span> stride<span class="token operator">=</span>stride<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        dataset <span class="token operator">=</span> LoadImages<span class="token punctuation">(</span>source<span class="token punctuation">,</span> img_size<span class="token operator">=</span>imgsz<span class="token punctuation">,</span> stride<span class="token operator">=</span>stride<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># Run inference</span>    <span class="token keyword">if</span> device<span class="token punctuation">.</span>type <span class="token operator">!=</span> <span class="token string">'cpu'</span><span class="token punctuation">:</span>        model<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> imgsz<span class="token punctuation">,</span> imgsz<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">.</span>type_as<span class="token punctuation">(</span>next<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># run once</span>    t0 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> path<span class="token punctuation">,</span> img<span class="token punctuation">,</span> im0s<span class="token punctuation">,</span> vid_cap <span class="token keyword">in</span> dataset<span class="token punctuation">:</span>        img <span class="token operator">=</span> torch<span class="token punctuation">.</span>from_numpy<span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>        img <span class="token operator">=</span> img<span class="token punctuation">.</span>half<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> half <span class="token keyword">else</span> img<span class="token punctuation">.</span>float<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># uint8 to fp16/32</span>        img <span class="token operator">/=</span> <span class="token number">255.0</span>  <span class="token comment" spellcheck="true"># 0 - 255 to 0.0 - 1.0</span>        <span class="token keyword">if</span> img<span class="token punctuation">.</span>ndimension<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">:</span>            img <span class="token operator">=</span> img<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># Inference</span>        t1 <span class="token operator">=</span> time_synchronized<span class="token punctuation">(</span><span class="token punctuation">)</span>        pred <span class="token operator">=</span> model<span class="token punctuation">(</span>img<span class="token punctuation">,</span> augment<span class="token operator">=</span>opt<span class="token punctuation">.</span>augment<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># Apply NMS</span>        pred <span class="token operator">=</span> non_max_suppression<span class="token punctuation">(</span>pred<span class="token punctuation">,</span> opt<span class="token punctuation">.</span>conf_thres<span class="token punctuation">,</span> opt<span class="token punctuation">.</span>iou_thres<span class="token punctuation">,</span> opt<span class="token punctuation">.</span>classes<span class="token punctuation">,</span> opt<span class="token punctuation">.</span>agnostic_nms<span class="token punctuation">,</span>                                   max_det<span class="token operator">=</span>opt<span class="token punctuation">.</span>max_det<span class="token punctuation">)</span>        t2 <span class="token operator">=</span> time_synchronized<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># Apply Classifier</span>        <span class="token keyword">if</span> classify<span class="token punctuation">:</span>            pred <span class="token operator">=</span> apply_classifier<span class="token punctuation">(</span>pred<span class="token punctuation">,</span> modelc<span class="token punctuation">,</span> img<span class="token punctuation">,</span> im0s<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># Process detections</span>        <span class="token keyword">for</span> i<span class="token punctuation">,</span> det <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>pred<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># detections per image</span>            <span class="token keyword">if</span> webcam<span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># batch_size >= 1</span>                p<span class="token punctuation">,</span> s<span class="token punctuation">,</span> im0<span class="token punctuation">,</span> frame <span class="token operator">=</span> path<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> f<span class="token string">'{i}: '</span><span class="token punctuation">,</span> im0s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dataset<span class="token punctuation">.</span>count            <span class="token keyword">else</span><span class="token punctuation">:</span>                p<span class="token punctuation">,</span> s<span class="token punctuation">,</span> im0<span class="token punctuation">,</span> frame <span class="token operator">=</span> path<span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> im0s<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> getattr<span class="token punctuation">(</span>dataset<span class="token punctuation">,</span> <span class="token string">'frame'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>            p <span class="token operator">=</span> Path<span class="token punctuation">(</span>p<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># to Path</span>            save_path <span class="token operator">=</span> str<span class="token punctuation">(</span>save_dir <span class="token operator">/</span> p<span class="token punctuation">.</span>name<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># img.jpg</span>            txt_path <span class="token operator">=</span> str<span class="token punctuation">(</span>save_dir <span class="token operator">/</span> <span class="token string">'labels'</span> <span class="token operator">/</span> p<span class="token punctuation">.</span>stem<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token string">''</span> <span class="token keyword">if</span> dataset<span class="token punctuation">.</span>mode <span class="token operator">==</span> <span class="token string">'image'</span> <span class="token keyword">else</span> f<span class="token string">'_{frame}'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># img.txt</span>            s <span class="token operator">+=</span> <span class="token string">'%gx%g '</span> <span class="token operator">%</span> img<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># print string</span>            gn <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>im0<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># normalization gain whwh</span>            imc <span class="token operator">=</span> im0<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> opt<span class="token punctuation">.</span>save_crop <span class="token keyword">else</span> im0  <span class="token comment" spellcheck="true"># for opt.save_crop</span>            <span class="token keyword">if</span> len<span class="token punctuation">(</span>det<span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token comment" spellcheck="true"># Rescale boxes from img_size to im0 size</span>                det<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> scale_coords<span class="token punctuation">(</span>img<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> det<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> im0<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token punctuation">.</span>round<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># Print results</span>                <span class="token keyword">for</span> c <span class="token keyword">in</span> det<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    n <span class="token operator">=</span> <span class="token punctuation">(</span>det<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> c<span class="token punctuation">)</span><span class="token punctuation">.</span>sum<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># detections per class</span>                    s <span class="token operator">+=</span> f<span class="token string">"{n} {names[int(c)]}{'s' * (n > 1)}, "</span>  <span class="token comment" spellcheck="true"># add to string</span>                <span class="token comment" spellcheck="true"># Write results</span>                <span class="token keyword">for</span> <span class="token operator">*</span>xyxy<span class="token punctuation">,</span> conf<span class="token punctuation">,</span> cls <span class="token keyword">in</span> reversed<span class="token punctuation">(</span>det<span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">if</span> save_txt<span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># Write to file</span>                        xywh <span class="token operator">=</span> <span class="token punctuation">(</span>xyxy2xywh<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>xyxy<span class="token punctuation">)</span><span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> gn<span class="token punctuation">)</span><span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># normalized xywh</span>                        line <span class="token operator">=</span> <span class="token punctuation">(</span>cls<span class="token punctuation">,</span> <span class="token operator">*</span>xywh<span class="token punctuation">,</span> conf<span class="token punctuation">)</span> <span class="token keyword">if</span> opt<span class="token punctuation">.</span>save_conf <span class="token keyword">else</span> <span class="token punctuation">(</span>cls<span class="token punctuation">,</span> <span class="token operator">*</span>xywh<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># label format</span>                        <span class="token keyword">with</span> open<span class="token punctuation">(</span>txt_path <span class="token operator">+</span> <span class="token string">'.txt'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>                            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'%g '</span> <span class="token operator">*</span> len<span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rstrip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> line <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>                    <span class="token keyword">if</span> save_img <span class="token operator">or</span> opt<span class="token punctuation">.</span>save_crop <span class="token operator">or</span> view_img<span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># Add bbox to image</span>                        c <span class="token operator">=</span> int<span class="token punctuation">(</span>cls<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># integer class</span>                        label <span class="token operator">=</span> None <span class="token keyword">if</span> opt<span class="token punctuation">.</span>hide_labels <span class="token keyword">else</span> <span class="token punctuation">(</span>names<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token keyword">if</span> opt<span class="token punctuation">.</span>hide_conf <span class="token keyword">else</span> f<span class="token string">'{names[c]} {conf:.2f}'</span><span class="token punctuation">)</span>                        plot_one_box<span class="token punctuation">(</span>xyxy<span class="token punctuation">,</span> im0<span class="token punctuation">,</span> label<span class="token operator">=</span>label<span class="token punctuation">,</span> color<span class="token operator">=</span>colors<span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span> line_thickness<span class="token operator">=</span>opt<span class="token punctuation">.</span>line_thickness<span class="token punctuation">)</span>                        <span class="token keyword">if</span> opt<span class="token punctuation">.</span>save_crop<span class="token punctuation">:</span>                            save_one_box<span class="token punctuation">(</span>xyxy<span class="token punctuation">,</span> imc<span class="token punctuation">,</span> file<span class="token operator">=</span>save_dir <span class="token operator">/</span> <span class="token string">'crops'</span> <span class="token operator">/</span> names<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">/</span> f<span class="token string">'{p.stem}.jpg'</span><span class="token punctuation">,</span> BGR<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># Print time (inference + NMS)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>f<span class="token string">'{s}Done. ({t2 - t1:.3f}s)'</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># Stream results</span>            <span class="token keyword">if</span> view_img<span class="token punctuation">:</span>                cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>str<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span> im0<span class="token punctuation">)</span>                cv2<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 1 millisecond</span>            <span class="token comment" spellcheck="true"># Save results (image with detections)</span>            <span class="token keyword">if</span> save_img<span class="token punctuation">:</span>                <span class="token keyword">if</span> dataset<span class="token punctuation">.</span>mode <span class="token operator">==</span> <span class="token string">'image'</span><span class="token punctuation">:</span>                    cv2<span class="token punctuation">.</span>imwrite<span class="token punctuation">(</span>save_path<span class="token punctuation">,</span> im0<span class="token punctuation">)</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># 'video' or 'stream'</span>                    <span class="token keyword">if</span> vid_path <span class="token operator">!=</span> save_path<span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># new video</span>                        vid_path <span class="token operator">=</span> save_path                        <span class="token keyword">if</span> isinstance<span class="token punctuation">(</span>vid_writer<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>VideoWriter<span class="token punctuation">)</span><span class="token punctuation">:</span>                            vid_writer<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># release previous video writer</span>                        <span class="token keyword">if</span> vid_cap<span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># video</span>                            fps <span class="token operator">=</span> vid_cap<span class="token punctuation">.</span>get<span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>CAP_PROP_FPS<span class="token punctuation">)</span>                            w <span class="token operator">=</span> int<span class="token punctuation">(</span>vid_cap<span class="token punctuation">.</span>get<span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>CAP_PROP_FRAME_WIDTH<span class="token punctuation">)</span><span class="token punctuation">)</span>                            h <span class="token operator">=</span> int<span class="token punctuation">(</span>vid_cap<span class="token punctuation">.</span>get<span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>CAP_PROP_FRAME_HEIGHT<span class="token punctuation">)</span><span class="token punctuation">)</span>                        <span class="token keyword">else</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># stream</span>                            fps<span class="token punctuation">,</span> w<span class="token punctuation">,</span> h <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">,</span> im0<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> im0<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                            save_path <span class="token operator">+=</span> <span class="token string">'.mp4'</span>                        vid_writer <span class="token operator">=</span> cv2<span class="token punctuation">.</span>VideoWriter<span class="token punctuation">(</span>save_path<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>VideoWriter_fourcc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token string">'mp4v'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fps<span class="token punctuation">,</span> <span class="token punctuation">(</span>w<span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">)</span>                    vid_writer<span class="token punctuation">.</span>write<span class="token punctuation">(</span>im0<span class="token punctuation">)</span>    <span class="token keyword">if</span> save_txt <span class="token operator">or</span> save_img<span class="token punctuation">:</span>        s <span class="token operator">=</span> f<span class="token string">"\n{len(list(save_dir.glob('labels/*.txt')))} labels saved to {save_dir / 'labels'}"</span> <span class="token keyword">if</span> save_txt <span class="token keyword">else</span> <span class="token string">''</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>f<span class="token string">"Results saved to {save_dir}{s}"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>f<span class="token string">'Done. ({time.time() - t0:.3f}s)'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é¦–å…ˆèµ‹äº†ä¸€äº›å€¼ï¼š<code>source, weights, view_img, save_txt, imgsz = opt.source, opt.weights, opt.view_img, opt.save_txt, opt.img_size</code>, éšå</p>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æºç è§£è¯» </tag>
            
            <tag> YOLO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Code Trace of mmdetection</title>
      <link href="/2021/10/16/code-trace-of-mmdetection/"/>
      <url>/2021/10/16/code-trace-of-mmdetection/</url>
      
        <content type="html"><![CDATA[<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>æœ¬åšå®¢ä¸»è¦è®°å½•äº†ä¸€äº›å…³äºmmdetectionæºç çš„è¿è¡Œè¿½è¸ªã€‚è¯»æºç è¿˜æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œæˆ‘é€šè¿‡è¯»è¿™äº›æºç æ¥è§¦åˆ°äº†ä¸€äº›é«˜çº§é¡¹ç›®å¤§è§„æ¨¡ç¼–ç¨‹çš„å…ˆè¿›è®¾è®¡æ¨¡å¼ã€‚å°±æ˜¯è¿™ä¸ªåº“çš„ä»£ç æ˜¯æ€ä¹ˆé€šè¿‡ä¸€è¡Œå‘½ä»¤å±‚å±‚è°ƒç”¨è¿›è¡Œè¿è¡Œçš„ã€‚å°±ç®—æ˜¯è¯»æºç ï¼Œä¹Ÿè¦é¦–å…ˆäº†è§£ä¸€ä¸‹å¤§è‡´çš„æ¡†æ¶ï¼Œè¿™ä¸ªæ­¥éª¤æ˜¯å¿…è¦çš„ã€‚</p><p>æˆ‘ä¹‹å‰è¯»çš„æœ€å¤§çš„æºç ä¹Ÿä¸è¿‡æ˜¯faster-rcnnçš„ä»£ç ç½¢äº†ï¼Œæœ¬æ¥ä»¥ä¸ºé‚£ä¹ˆä¸Šä¸‡è¡Œä»£ç å·²ç»éå¸¸å‰å®³äº†ã€‚æ²¡æƒ³åˆ°å¯¹æ¯”äºmmdetectionæ¥çœ‹ï¼Œè¿™ä¸è¿‡æ˜¯ä¹ç‰›ä¸€æ¯›ã€‚æ‰ç²—ç•¥è¯»äº†ä¸€ç‚¹ç‚¹ï¼Œæˆ‘å°±å­¦åˆ°äº†ä¸çŸ¥é“å¤šå°‘å¾ˆå®ç”¨çš„çŸ¥è¯†ã€‚</p><p>å¦å¤–ï¼Œä¸ªäººè§‰å¾—è¯»è®ºæ–‡è¿˜æ˜¯æ²¡æœ‰è¯»æºç çˆ½ğŸ˜–ï¼ŒYOLOè¯»çš„çƒ¦æ­»â€¦â€¦</p><blockquote><p>å†™å®Œæ‰å‘ç°å˜æˆ<code>train.py</code>æºç è§£è¯»äº†ğŸ˜…ï¼Œä¸è¿‡æ²¡å…³ç³»ï¼Œè¿™ä¸ªä¹Ÿç®—æ˜¯éå¸¸é‡è¦çš„å­¦ä¹ äº†ã€‚å°†<code>train.py</code>äº†è§£çš„å·®ä¸å¤šé‚£ä¹ˆï¼Œåé¢ä»£ç è¿½è¸ªå°±ç®€å•å¤šäº†ã€‚</p><p><del>åè½¬äº†ï¼Œæˆ‘å¼€å§‹è¿½è¸ªäº†ï¼Œè¿˜æ˜¯è¿½è¸ªæ¶¨çŸ¥è¯†â€¦â€¦</del></p></blockquote><p><strong>æœ¬Blogä»<code>tools/train.py</code>å¼€å§‹è¿½è¸ªã€‚</strong></p><h1 id="parse-args"><a href="#parse-args" class="headerlink" title="parse_args()"></a>parse_args()</h1><p>æˆ‘ä»¬çŸ¥é“åœ¨zshè¿è¡Œ<code>train.py</code>ä¼šæœ‰è®¸å¤šå¯é€‰å‚æ•°ï¼š</p><pre class="line-numbers language-python"><code class="language-python">lry@ubuntu <span class="token operator">~</span><span class="token operator">/</span>projects<span class="token operator">/</span>mmdetection <span class="token operator">%</span> python tools<span class="token operator">/</span>train<span class="token punctuation">.</span>py <span class="token operator">-</span>husage<span class="token punctuation">:</span> train<span class="token punctuation">.</span>py <span class="token punctuation">[</span><span class="token operator">-</span>h<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>work<span class="token operator">-</span>dir WORK_DIR<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>resume<span class="token operator">-</span><span class="token keyword">from</span> RESUME_FROM<span class="token punctuation">]</span>                <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>no<span class="token operator">-</span>validate<span class="token punctuation">]</span>                <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>gpus GPUS <span class="token operator">|</span> <span class="token operator">-</span><span class="token operator">-</span>gpu<span class="token operator">-</span>ids GPU_IDS <span class="token punctuation">[</span>GPU_IDS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>seed SEED<span class="token punctuation">]</span>                <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>deterministic<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>options OPTIONS <span class="token punctuation">[</span>OPTIONS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span>                <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>cfg<span class="token operator">-</span>options CFG_OPTIONS <span class="token punctuation">[</span>CFG_OPTIONS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span>                <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>launcher <span class="token punctuation">{</span>none<span class="token punctuation">,</span>pytorch<span class="token punctuation">,</span>slurm<span class="token punctuation">,</span>mpi<span class="token punctuation">}</span><span class="token punctuation">]</span>                <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>local_rank LOCAL_RANK<span class="token punctuation">]</span>                configTrain a detectorpositional arguments<span class="token punctuation">:</span>  config                train config file pathoptional arguments<span class="token punctuation">:</span>  <span class="token operator">-</span>h<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token operator">-</span>help            show this help message <span class="token operator">and</span> exit  <span class="token operator">-</span><span class="token operator">-</span>work<span class="token operator">-</span>dir WORK_DIR   the dir to save logs <span class="token operator">and</span> models  <span class="token operator">-</span><span class="token operator">-</span>resume<span class="token operator">-</span><span class="token keyword">from</span> RESUME_FROM                        the checkpoint file to resume <span class="token keyword">from</span>  <span class="token operator">-</span><span class="token operator">-</span>no<span class="token operator">-</span>validate         whether <span class="token operator">not</span> to evaluate the checkpoint during training  <span class="token operator">-</span><span class="token operator">-</span>gpus GPUS           number of gpus to use <span class="token punctuation">(</span>only applicable to non<span class="token operator">-</span>                        distributed training<span class="token punctuation">)</span>  <span class="token operator">-</span><span class="token operator">-</span>gpu<span class="token operator">-</span>ids GPU_IDS <span class="token punctuation">[</span>GPU_IDS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>                        ids of gpus to use <span class="token punctuation">(</span>only applicable to non<span class="token operator">-</span>distributed                        training<span class="token punctuation">)</span>  <span class="token operator">-</span><span class="token operator">-</span>seed SEED           random seed  <span class="token operator">-</span><span class="token operator">-</span>deterministic       whether to set deterministic options <span class="token keyword">for</span> CUDNN                        backend<span class="token punctuation">.</span>  <span class="token operator">-</span><span class="token operator">-</span>options OPTIONS <span class="token punctuation">[</span>OPTIONS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>                        override some settings <span class="token keyword">in</span> the used config<span class="token punctuation">,</span> the key<span class="token operator">-</span>                        value pair <span class="token keyword">in</span> xxx<span class="token operator">=</span>yyy format will be merged into                        config file <span class="token punctuation">(</span>deprecate<span class="token punctuation">)</span><span class="token punctuation">,</span> change to <span class="token operator">-</span><span class="token operator">-</span>cfg<span class="token operator">-</span>options                        instead<span class="token punctuation">.</span>  <span class="token operator">-</span><span class="token operator">-</span>cfg<span class="token operator">-</span>options CFG_OPTIONS <span class="token punctuation">[</span>CFG_OPTIONS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>                        override some settings <span class="token keyword">in</span> the used config<span class="token punctuation">,</span> the key<span class="token operator">-</span>                        value pair <span class="token keyword">in</span> xxx<span class="token operator">=</span>yyy format will be merged into                        config file<span class="token punctuation">.</span> If the value to be overwritten <span class="token keyword">is</span> a list<span class="token punctuation">,</span>                        it should be like key<span class="token operator">=</span><span class="token string">"[a,b]"</span> <span class="token operator">or</span> key<span class="token operator">=</span>a<span class="token punctuation">,</span>b It also                        allows nested list<span class="token operator">/</span>tuple values<span class="token punctuation">,</span> e<span class="token punctuation">.</span>g<span class="token punctuation">.</span>                        key<span class="token operator">=</span><span class="token string">"[(a,b),(c,d)]"</span> Note that the quotation marks are                        necessary <span class="token operator">and</span> that no white space <span class="token keyword">is</span> allowed<span class="token punctuation">.</span>  <span class="token operator">-</span><span class="token operator">-</span>launcher <span class="token punctuation">{</span>none<span class="token punctuation">,</span>pytorch<span class="token punctuation">,</span>slurm<span class="token punctuation">,</span>mpi<span class="token punctuation">}</span>                        job launcher  <span class="token operator">-</span><span class="token operator">-</span>local_rank LOCAL_RANK<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™äº›å‚æ•°åªæœ‰configæ˜¯å¿…é€‰çš„å‚æ•°ï¼Œå…¶ä½™çš„éƒ½ä¸ºå¯é€‰å‚æ•°ã€‚</p><p>è¿™äº›å¯é€‰å‚æ•°çš„æ„é€ å‡½æ•°ä¸º<code>parse_args()</code>.ç”±äºè¿™æ–¹é¢ä»£ç å¾ˆç®€å•ï¼Œè¿™é‡Œä¸å¤šè¯¦ç»†çš„è§£é‡Šã€‚</p><p>ä½†æ˜¯ä¸ºäº†æ–¹ä¾¿å±•ç¤ºå¯¹æ¯”ï¼Œæˆ‘ä»¬è¿˜æ˜¯å°†æºç æ”¾ä¸Šæ¥(å¯ä»¥ç»“åˆä»¥ä¸Šçš„è¾“å‡ºæ¥ä¸€èµ·è€ƒè™‘åˆ†æï¼‰ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">parse_args</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    parser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span>description<span class="token operator">=</span><span class="token string">'Train a detector'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># </span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'config'</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'train config file path'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--work-dir'</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'the dir to save logs and models'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span>        <span class="token string">'--resume-from'</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'the checkpoint file to resume from'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span>        <span class="token string">'--no-validate'</span><span class="token punctuation">,</span>        action<span class="token operator">=</span><span class="token string">'store_true'</span><span class="token punctuation">,</span>        help<span class="token operator">=</span><span class="token string">'whether not to evaluate the checkpoint during training'</span><span class="token punctuation">)</span>    group_gpus <span class="token operator">=</span> parser<span class="token punctuation">.</span>add_mutually_exclusive_group<span class="token punctuation">(</span><span class="token punctuation">)</span>    group_gpus<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span>        <span class="token string">'--gpus'</span><span class="token punctuation">,</span>        type<span class="token operator">=</span>int<span class="token punctuation">,</span>        help<span class="token operator">=</span><span class="token string">'number of gpus to use '</span>        <span class="token string">'(only applicable to non-distributed training)'</span><span class="token punctuation">)</span>    group_gpus<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span>        <span class="token string">'--gpu-ids'</span><span class="token punctuation">,</span>        type<span class="token operator">=</span>int<span class="token punctuation">,</span>        nargs<span class="token operator">=</span><span class="token string">'+'</span><span class="token punctuation">,</span>        help<span class="token operator">=</span><span class="token string">'ids of gpus to use '</span>        <span class="token string">'(only applicable to non-distributed training)'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--seed'</span><span class="token punctuation">,</span> type<span class="token operator">=</span>int<span class="token punctuation">,</span> default<span class="token operator">=</span>None<span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'random seed'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span>        <span class="token string">'--deterministic'</span><span class="token punctuation">,</span>        action<span class="token operator">=</span><span class="token string">'store_true'</span><span class="token punctuation">,</span>        help<span class="token operator">=</span><span class="token string">'whether to set deterministic options for CUDNN backend.'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span>        <span class="token string">'--options'</span><span class="token punctuation">,</span>        nargs<span class="token operator">=</span><span class="token string">'+'</span><span class="token punctuation">,</span>        action<span class="token operator">=</span>DictAction<span class="token punctuation">,</span>        help<span class="token operator">=</span><span class="token string">'override some settings in the used config, the key-value pair '</span>        <span class="token string">'in xxx=yyy format will be merged into config file (deprecate), '</span>        <span class="token string">'change to --cfg-options instead.'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span>        <span class="token string">'--cfg-options'</span><span class="token punctuation">,</span>        nargs<span class="token operator">=</span><span class="token string">'+'</span><span class="token punctuation">,</span>        action<span class="token operator">=</span>DictAction<span class="token punctuation">,</span>        help<span class="token operator">=</span><span class="token string">'override some settings in the used config, the key-value pair '</span>        <span class="token string">'in xxx=yyy format will be merged into config file. If the value to '</span>        <span class="token string">'be overwritten is a list, it should be like key="[a,b]" or key=a,b '</span>        <span class="token string">'It also allows nested list/tuple values, e.g. key="[(a,b),(c,d)]" '</span>        <span class="token string">'Note that the quotation marks are necessary and that no white space '</span>        <span class="token string">'is allowed.'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span>        <span class="token string">'--launcher'</span><span class="token punctuation">,</span>        choices<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'none'</span><span class="token punctuation">,</span> <span class="token string">'pytorch'</span><span class="token punctuation">,</span> <span class="token string">'slurm'</span><span class="token punctuation">,</span> <span class="token string">'mpi'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        default<span class="token operator">=</span><span class="token string">'none'</span><span class="token punctuation">,</span>        help<span class="token operator">=</span><span class="token string">'job launcher'</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--local_rank'</span><span class="token punctuation">,</span> type<span class="token operator">=</span>int<span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>    args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">'LOCAL_RANK'</span> <span class="token operator">not</span> <span class="token keyword">in</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">:</span>        os<span class="token punctuation">.</span>environ<span class="token punctuation">[</span><span class="token string">'LOCAL_RANK'</span><span class="token punctuation">]</span> <span class="token operator">=</span> str<span class="token punctuation">(</span>args<span class="token punctuation">.</span>local_rank<span class="token punctuation">)</span>    <span class="token keyword">if</span> args<span class="token punctuation">.</span>options <span class="token operator">and</span> args<span class="token punctuation">.</span>cfg_options<span class="token punctuation">:</span>        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span>            <span class="token string">'--options and --cfg-options cannot be both '</span>            <span class="token string">'specified, --options is deprecated in favor of --cfg-options'</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> args<span class="token punctuation">.</span>options<span class="token punctuation">:</span>        warnings<span class="token punctuation">.</span>warn<span class="token punctuation">(</span><span class="token string">'--options is deprecated in favor of --cfg-options'</span><span class="token punctuation">)</span>        args<span class="token punctuation">.</span>cfg_options <span class="token operator">=</span> args<span class="token punctuation">.</span>options    <span class="token keyword">return</span> args<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬ä¸»è¦æ¥çœ‹<code>main()</code>å‡½æ•°ã€‚</p><h1 id="main"><a href="#main" class="headerlink" title="main()"></a>main()</h1><p>é¦–å…ˆè°ƒç”¨ä»¥ä¸Š<code>parse_args()</code>å‡½æ•°æ¥è¿½è¸ªè·å–æˆ‘ä»¬çš„shellè¾“å…¥çš„å‚æ•°ã€‚</p><pre class="line-numbers language-python"><code class="language-python">args <span class="token operator">=</span> parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Configç±»"><a href="#Configç±»" class="headerlink" title="Configç±»"></a>Configç±»</h2><h3 id="configåŸºæœ¬é…ç½®"><a href="#configåŸºæœ¬é…ç½®" class="headerlink" title="configåŸºæœ¬é…ç½®"></a>configåŸºæœ¬é…ç½®</h3><pre class="line-numbers language-python"><code class="language-python">cfg <span class="token operator">=</span> Config<span class="token punctuation">.</span>fromfile<span class="token punctuation">(</span>args<span class="token punctuation">.</span>config<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># è¯»å–æœ‰å…³çš„æ–‡ä»¶</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¯¥è¡Œä»£ç åˆ©ç”¨åˆ°äº†ç±»<code>Config</code>.</p><ul><li><p>å¯¼å…¥Configä»£ç ç›´æ¥å°±æ˜¯<code>from mmcv import Config</code>ï¼Œç»è¿‡æ‰¾mmcvåº“ï¼Œä¼šå‘ç°è¯¥Configç±»ä½äº<code>mmcv/utils/config.py</code>çš„ç¬¬70è¡Œã€‚è‡³äºä¸ºä»€ä¹ˆèƒ½å¤Ÿèƒ½ç›´æ¥èƒ½è¿™ä¹ˆå¯¼å…¥ï¼Œè¿™å°±æ¶‰åŠåˆ°<code>__init__</code>çš„æœ‰å…³ç±»ã€åº“å¯¼åŒ…é—®é¢˜ï¼Œè¿™é‡Œä¸å¤šè¯´ã€‚</p></li><li><p>Configç±»æ³¨é‡Šå†™é“ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token triple-quoted-string string">"""A facility for config and config files.    It supports common file formats as configs: python/json/yaml. The interface    is the same as a dict object and also allows access config values as    attributes.    Example:        >>> cfg = Config(dict(a=1, b=dict(b1=[0, 1])))        >>> cfg.a        1        >>> cfg.b        {'b1': [0, 1]}        >>> cfg.b.b1        [0, 1]        >>> cfg = Config.fromfile('tests/data/config/a.py')        >>> cfg.filename        "/home/kchen/projects/mmcv/tests/data/config/a.py"        >>> cfg.item4        'test'        >>> cfg        "Config [path: /home/kchen/projects/mmcv/tests/data/config/a.py]: "        "{'item1': [1, 2], 'item2': {'a': 0}, 'item3': True, 'item4': 'test'}"    """</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><p>å¯ä»¥çœ‹åˆ°è¿™ä¸ªç±»ä¸»è¦è´Ÿè´£çš„å°±æ˜¯è¯»å–è½¬åŒ–configæ–‡ä»¶ã€‚</p></li><li><p>å®ƒåªæ”¯æŒ<code>python/json/yaml</code>æ ¼å¼çš„è¯»å–ï¼Œå·²ç»è¶³å¤Ÿäº†ã€‚æˆ‘ä»¬ä¸Šæ¬¡è¯»å–çš„æ˜¯æ–‡ä»¶<code>configs/balloon/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_balloon.py</code>æ˜¯ä¸€ä¸ª<code>.py</code>æ–‡ä»¶ã€‚</p></li><li><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥é¡ºä¾¿çœ‹çœ‹ä¸Šæ¬¡çš„<code>.py</code>æ–‡ä»¶éƒ½æœ‰ä»€ä¹ˆ:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># The new config inherits a base config to highlight the necessary modification</span>_base_ <span class="token operator">=</span> <span class="token string">'../mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_coco.py'</span><span class="token comment" spellcheck="true"># We also need to change the num_classes in head to match the dataset's annotation</span>model <span class="token operator">=</span> dict<span class="token punctuation">(</span>    roi_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>        bbox_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>num_classes<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        mask_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>num_classes<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># Modify dataset related settings</span>dataset_type <span class="token operator">=</span> <span class="token string">'COCODataset'</span>classes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'balloon'</span><span class="token punctuation">,</span><span class="token punctuation">)</span>data <span class="token operator">=</span> dict<span class="token punctuation">(</span>    train<span class="token operator">=</span>dict<span class="token punctuation">(</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/train/'</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/train/annotation_coco.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    val<span class="token operator">=</span>dict<span class="token punctuation">(</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/val/'</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/val/annotation_coco.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    test<span class="token operator">=</span>dict<span class="token punctuation">(</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/val/'</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/val/annotation_coco.json'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># We can use the pre-trained Mask RCNN model to obtain higher performance</span><span class="token comment" spellcheck="true"># load_from = 'checkpoints/mask_rcnn_r50_caffe_fpn_mstrain-poly_3x_coco_bbox_mAP-0.408__segm_mAP-0.37_20200504_163245-42aa3d00.pth'</span>load_from <span class="token operator">=</span> <span class="token string">'https://download.openmmlab.com/mmdetection/v2.0/mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_3x_coco/mask_rcnn_r50_caffe_fpn_mstrain-poly_3x_coco_bbox_mAP-0.408__segm_mAP-0.37_20200504_163245-42aa3d00.pth'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>å¤§æ¦‚å°±æ˜¯æ•°æ®é›†ç±»å‹æ ¼å¼ã€è®­ç»ƒæ‰€ä½¿ç”¨ç½‘ç»œã€ç½‘ç»œæƒé‡ä½ç½®ã€æ•°æ®é›†æ‰€åœ¨çš„ä½ç½®è¿™äº›åŸºæœ¬çš„ä¿¡æ¯ã€‚<del>è¦ä¸ä¸ºä»€ä¹ˆå«configæ–‡ä»¶</del></li></ul></li></ul></li><li><p>æ³¨æ„åæ¥å®ƒä¹Ÿç»™å‡ºäº†ä¸€äº›æœ‰å…³çš„ä¾‹å­å…³äºä½¿ç”¨<code>Config.fromfile</code>å‡½æ•°ã€‚åªä¸è¿‡ä»–ç»™çš„å‚è€ƒæ–‡ä»¶å¤ªè¿‡äºç®€å•ï¼Œæˆ‘ä»¬è¿™é‡Œå†™ä¸€ä¸ªè¯»è¾ƒä¸ºå¤æ‚çš„æ–‡ä»¶çš„ä»£ç çœ‹ä¸€ä¸‹Configåˆ°åº•è¯»å–äº†ä»€ä¹ˆä¿¡æ¯ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> mmcv <span class="token keyword">import</span> Config<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    cfg <span class="token operator">=</span> Config<span class="token punctuation">.</span>fromfile<span class="token punctuation">(</span><span class="token string">"configs/balloon/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_balloon.py"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>cfg<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬è¿è¡Œç»“æœä¸ºï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016233150.png" alt="output"></p><p>è¿™ä¹ˆçœ‹æœ‰äº›æ¨¡ç³Šä¸æ¸…æ™°ï¼Œæˆ‘ä»¬å°†å®ƒæ”¾åˆ°ä¸€ä¸ª.jsonæ–‡ä»¶é‡Œæ¥çœ‹åå¯ä»¥å‘ç°è¿™é‡Œé¢é™¤äº†æœ‰configæ–‡ä»¶æºåœ°å€ï¼Œä¸»è¦å°±æ˜¯ï¼š</p><ul><li>æœ‰å…³æ¨¡å‹çš„é…ç½®ï¼Œæœ‰backbone ä¸ºResNetï¼Œå¯ä»¥çœ‹å‡ºç”¨çš„æ˜¯ResNet50ï¼Œbackboneç”¨äº†4ä¸ªstagesï¼Œè¿™äº›éƒ½ç¬¦åˆæˆ‘ä»¬çš„å¸¸è¯†ã€‚å¦å¤–å°±æ˜¯æ¯ä¸€å±‚çš„æ›´åŠ è¯¦ç»†çš„ä¿¡æ¯ï¼Œå…³äºæ•´ä¸ªç½‘ç»œçš„é…å¤‡è¿™äº›é—®é¢˜ã€‚</li><li>æ•°æ®é›†çš„åœ°å€ä¸ç±»åˆ«ç§ç±»æ•°ã€‚è¿˜åŒ…æ‹¬æ˜¯å¦è®­ç»ƒã€æ˜¯å¦é¢„è®­ç»ƒå¥½äº†ç­‰ç­‰ã€‚</li><li>è®­ç»ƒæƒé‡ä¸‹è½½çš„åœ°å€ï¼ˆå› ä¸ºè¿™é‡Œè®¾å®šäº†pretainedï¼‰ç­‰ã€‚</li></ul></li></ul><h3 id="Optional-é…ç½®"><a href="#Optional-é…ç½®" class="headerlink" title="Optional é…ç½®"></a>Optional é…ç½®</h3><pre class="line-numbers language-python"><code class="language-python">    <span class="token keyword">if</span> args<span class="token punctuation">.</span>cfg_options <span class="token keyword">is</span> <span class="token operator">not</span> None<span class="token punctuation">:</span>        cfg<span class="token punctuation">.</span>merge_from_dict<span class="token punctuation">(</span>args<span class="token punctuation">.</span>cfg_options<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¿™ä¸ªæ˜¯å¯é€‰çš„å‚æ•°ï¼Œåˆšæ‰çš„<code>-h</code>å‘½ä»¤ä¸­ä¹Ÿæœ‰ç›¸å…³çš„è§£é‡Šï¼š</p><blockquote><p> â€“cfg-options CFG_OPTIONS [CFG_OPTIONS â€¦]<br>override some settings in the used config, the key-value pair in xxx=yyy format will be merged into config file. If the value to be overwritten is a list, it should be like key=â€[a,b]â€ or key=a,b It also allows nested list/tuple values, e.g. key=â€[(a,b),(c,d)]â€ Note that the quotation marks are necessary and that no white space is allowed.</p></blockquote><p>ä¹Ÿå°±æ˜¯åŠ ä¸€äº›å‚æ•°åˆ°configåˆšæ‰è¯»åˆ°çš„cfgå½“ä¸­å»ã€‚å½“ç„¶éœ€è¦ä¸€ä¸ªå›ºå®šçš„ç±»å‹ï¼Œä»¥ä¸Šä¹Ÿç»™å‡ºäº†ä¸€äº›ä¾‹å­ã€‚</p><h2 id="custom-imports"><a href="#custom-imports" class="headerlink" title="custom_imports"></a>custom_imports</h2><pre class="line-numbers language-python"><code class="language-python">    <span class="token keyword">if</span> cfg<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'custom_imports'</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">from</span> mmcv<span class="token punctuation">.</span>utils <span class="token keyword">import</span> import_modules_from_strings        import_modules_from_strings<span class="token punctuation">(</span><span class="token operator">**</span>cfg<span class="token punctuation">[</span><span class="token string">'custom_imports'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªä»£ç æˆ‘çŒœæµ‹æ˜¯å¯»æ‰¾ä¸€ä¸‹æˆ‘ä»¬æ˜¯å¦è‡ªå·±å®šä¹‰ä¸€äº›æ¨¡å‹æˆ–è€…å¯¼å…¥ï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰ï¼Œé‚£ä¹ˆæ²¡å…³ç³»ç”¨é»˜è®¤çš„å°±OKï¼Œä½†æ˜¯å¦‚æœè‡ªå·±å®šä¹‰äº†çš„è¯ï¼Œå°±ä½¿ç”¨è‡ªå·±å®šä¹‰çš„ã€‚è¿™ä¸ªæ²¡å¿…è¦è¯¦ç»†å»çœ‹ï¼ˆ<del>æ¯•ç«Ÿçœ‹ä¸æ‡‚</del>ï¼‰ï¼Œæ‰€ä»¥æˆ‘ç•¥è¿‡å»äº†ã€‚</p><h2 id="cudnn-benchmark"><a href="#cudnn-benchmark" class="headerlink" title="cudnn_benchmark"></a>cudnn_benchmark</h2><pre class="line-numbers language-python"><code class="language-python">    <span class="token comment" spellcheck="true"># set cudnn_benchmark</span>    <span class="token keyword">if</span> cfg<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'cudnn_benchmark'</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        torch<span class="token punctuation">.</span>backends<span class="token punctuation">.</span>cudnn<span class="token punctuation">.</span>benchmark <span class="token operator">=</span> <span class="token boolean">True</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œé¢å…³äºå°†è¿™ä¸ªè®¾ä¸ºTrue è¿˜æ˜¯Falseæˆ‘çœ‹äº†çœ‹å…³äºPytorchå®˜æ–¹è®ºå›çš„ä¸€äº›è§£é‡Šï¼š<a href="https://discuss.pytorch.org/t/what-does-torch-backends-cudnn-benchmark-do/5936/2" target="_blank" rel="noopener">Pytorch è®ºå›</a> <a href="https://discuss.pytorch.org/t/what-does-torch-backends-cudnn-benchmark-do/5936/5" target="_blank" rel="noopener">çŸ¥ä¹</a>å°±æ˜¯å…³äº<code>torch.backends.cudnn.benchmark</code>è®¾ä¸ºT or Fçš„åŒºåˆ«ã€‚</p><p>æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆæ¥çœ‹ï¼Œè¿™ä¸ªå°±æ˜¯ç”¨æ¥ä¼˜åŒ–ç”¨çš„ï¼Œç®€å•æ¥è¯´ï¼Œå¦‚æœå·ç§¯ç½‘ç»œç»“æ„ä¸æ˜¯åŠ¨æ€å˜åŒ–çš„ï¼Œç½‘ç»œçš„è¾“å…¥ (batch sizeï¼Œå›¾åƒçš„å¤§å°ï¼Œè¾“å…¥çš„é€šé“) æ˜¯å›ºå®šçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†è¿™ä¸ªè®¾ä¸ºTrueå°±ä¼šæœ‰å¾ˆå¤§çš„ä¼˜åŒ–åŠ é€Ÿï¼Œå¯ä»¥è¾¾åˆ°30%~40%ï¼Œä½†æ˜¯å¦‚æœä¸æ˜¯å¯èƒ½å°±ä¼šè´Ÿä¼˜åŒ–ã€‚æ‰€ä»¥è¿™ä¸ªéœ€è¦åˆ†æ—¶ä¾¯ä½¿ç”¨ã€‚</p><blockquote><p>å¦‚æœä¸åœåœ°æ”¹å˜è¾“å…¥å½¢çŠ¶ï¼Œè¿è¡Œæ•ˆç‡ç¡®å®ä¼šå¾ˆä½ï¼Œå› ä¸ºå¯¹äºæ¯ä¸ªæ–°é‡åˆ°çš„å·ç§¯åœºæ™¯ PyTorch éƒ½ä¼šå»è‡ªåŠ¨å¯»æ‰¾æœ€é€‚åˆçš„å·ç§¯ç®—æ³•ã€‚ä½†æ˜¯ï¼Œæ ¹æ®ä¸Šè¾¹çš„æºä»£ç å’Œç»“æœæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹å‡ºæ¥ï¼Œå¯¹äºæŸä¸ªå·²ç»ä¼˜åŒ–è¿‡çš„å·ç§¯åœºæ™¯ï¼Œä¼šä¿å­˜åˆ°ç¼“å­˜ (cache) ä¸­ï¼Œä¸‹æ¬¡å†é‡åˆ°çš„æ—¶å€™ç›´æ¥ä»ç¼“å­˜ä¸­è¯»å–ç»“æœå°±å¥½äº†ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œåœ¨ PyTorch é»˜è®¤æƒ…å†µ(å³ <code>cudnn.benchmark=False</code> )ï¼Œè¾“å…¥å°ºå¯¸çš„å˜åŒ–å¹¶ä¸å½±å“æ•ˆç‡ã€‚</p></blockquote><p>æ‰€ä»¥è¿™ä¹ˆçœ‹æ¥è¿™ä¸ªä»£ç å°±å¾ˆå¥½ç†è§£äº†ï¼Œå¦‚æœæˆ‘ä»¬æœ‰å°†å…¶å®šä¹‰ä¸ºTrueï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä½¿ç”¨è¿™ä¸ªåŠ é€Ÿï¼Œå¦åˆ™ä¸ä½¿ç”¨ã€‚</p><h2 id="work-dir"><a href="#work-dir" class="headerlink" title="work_dir"></a>work_dir</h2><pre class="line-numbers language-python"><code class="language-python">    <span class="token comment" spellcheck="true"># work_dir is determined in this priority: CLI > segment in file > filename</span>    <span class="token keyword">if</span> args<span class="token punctuation">.</span>work_dir <span class="token keyword">is</span> <span class="token operator">not</span> None<span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># update configs according to CLI args if args.work_dir is not None</span>        cfg<span class="token punctuation">.</span>work_dir <span class="token operator">=</span> args<span class="token punctuation">.</span>work_dir    <span class="token keyword">elif</span> cfg<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'work_dir'</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span> <span class="token keyword">is</span> None<span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># use config filename as default work_dir if cfg.work_dir is None</span>        cfg<span class="token punctuation">.</span>work_dir <span class="token operator">=</span> osp<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string">'./work_dirs'</span><span class="token punctuation">,</span>                                osp<span class="token punctuation">.</span>splitext<span class="token punctuation">(</span>osp<span class="token punctuation">.</span>basename<span class="token punctuation">(</span>args<span class="token punctuation">.</span>config<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><em>æˆ‘ä»¬çš„work_diræ˜¯ç”¨æ¥ä¿å­˜logå’Œè®­ç»ƒæƒé‡çš„æ–‡ä»¶å¤¹</em></p><p>é¦–å…ˆç¬¬ä¸€è¡Œçš„æ³¨é‡Šå·²ç»è§£é‡Šäº†å…³äºæˆ‘ä»¬çš„work_dirçš„ä¼˜å…ˆçº§ï¼Œå‘½ä»¤è¡Œï¼ˆCLIï¼šCommand Line Interfaceï¼‰æ˜¯æœ€é«˜çš„ï¼Œç„¶åä½¿æ–‡ä»¶ä¸­çš„å‚æ•°ï¼Œæœ€åæ˜¯æˆ‘ä»¬çš„æ–‡ä»¶åã€‚<strong>äº‹å®ä¸Šçœ‹åé¢çš„ä»£ç ä¹Ÿæ˜¯è¿™ä¹ˆè¿ä½œçš„</strong></p><ul><li><p>é¦–å…ˆçœ‹ä¸€ä¸‹æ˜¯å¦å‘½ä»¤è¡Œä¸­è¯»å–çš„å‚æ•°ä¸­æœ‰è¿™ä¸€é¡¹ï¼Œæœ‰çš„è¯å°±ç›´æ¥ç”¨è¿™ä¸€é¡¹å°±OK</p></li><li><p>å¦‚æœæ²¡æœ‰æˆ‘ä»¬å°±çœ‹ä¸€ä¸‹configæ–‡ä»¶ä¸­æ˜¯å¦æœ‰è¿™ä¸ªè®¾å®šï¼Œæœ‰çš„è¯å°±è‡ªåŠ¨æ”¾åˆ°è¿™é‡Œäº†ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰çš„è¯å°±é‡æ–°å®šä¹‰ä¸€ä¸ªï¼Œ</p></li><li><p>é‡æ–°å®šä¹‰çš„æ–‡ä»¶è·¯å¾„å°±æ˜¯train.pyæ–‡ä»¶æ‰€åœ¨ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªwork_diræ–‡ä»¶å¤¹ï¼Œç„¶åwork_diræ–‡ä»¶å¤¹é‡Œåˆæ–°å»ºä¸€ä¸ªä¸æ¨¡å‹åŒåçš„æ–‡ä»¶å¤¹ï¼Œé‡Œé¢æ¥æ”¾logså’Œ.pth è®­ç»ƒæƒé‡ã€‚æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹ä¸Šæ¬¡è®­ç»ƒçš„åˆ°çš„æ–‡ä»¶ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016161532.png" alt></p><p>è¿™å®é™…ä¸Šå°±å¯¹åº”ä¸Šäº†ã€‚</p></li></ul><h2 id="resume-from-amp-amp-gpu-ids"><a href="#resume-from-amp-amp-gpu-ids" class="headerlink" title="resume_from &amp;&amp; gpu_ids"></a>resume_from &amp;&amp; gpu_ids</h2><pre class="line-numbers language-python"><code class="language-python">    <span class="token keyword">if</span> args<span class="token punctuation">.</span>resume_from <span class="token keyword">is</span> <span class="token operator">not</span> None<span class="token punctuation">:</span>        cfg<span class="token punctuation">.</span>resume_from <span class="token operator">=</span> args<span class="token punctuation">.</span>resume_from    <span class="token keyword">if</span> args<span class="token punctuation">.</span>gpu_ids <span class="token keyword">is</span> <span class="token operator">not</span> None<span class="token punctuation">:</span>        cfg<span class="token punctuation">.</span>gpu_ids <span class="token operator">=</span> args<span class="token punctuation">.</span>gpu_ids    <span class="token keyword">else</span><span class="token punctuation">:</span>        cfg<span class="token punctuation">.</span>gpu_ids <span class="token operator">=</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">if</span> args<span class="token punctuation">.</span>gpus <span class="token keyword">is</span> None <span class="token keyword">else</span> range<span class="token punctuation">(</span>args<span class="token punctuation">.</span>gpus<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="resume-from"><a href="#resume-from" class="headerlink" title="resume_from"></a>resume_from</h3><p>è¯¥å®šä¹‰åº”è¯¥æ˜¯æ¨¡å‹ä»æŸä¸ªä¸­æ–­çš„åœ°æ–¹é‡æ–°å¼€å§‹æ¢å¤è®­ç»ƒè¦ç”¨åˆ°çš„ã€‚ä»è‹±æ–‡è§£é‡ŠçŒœæµ‹è€Œå·²ã€‚</p><blockquote><p>  â€“resume-from RESUME_FROM<br>                        the checkpoint file to resume from</p></blockquote><p>å…·ä½“å…³äºæ¨¡å‹åŠ è½½å¯ä»¥çœ‹è¿™ä¸ªæ–‡ç« ï¼š<a href="https://blog.csdn.net/lxytsos/article/details/90639524ï¼Œ" target="_blank" rel="noopener">https://blog.csdn.net/lxytsos/article/details/90639524ï¼Œ</a> ä»¥åŠpytorchå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://pytorch123.com/ThirdSection/SaveModel/" target="_blank" rel="noopener">https://pytorch123.com/ThirdSection/SaveModel/</a></p><h3 id="gpu-ids"><a href="#gpu-ids" class="headerlink" title="gpu_ids"></a>gpu_ids</h3><p>ä½¿ç”¨å‡ ä¸ªgpuï¼Œå¦‚æœä½¿ç”¨æŒ‡å®šäº†ç¼–å·çš„è¯ï¼Œå°±æŒ‰æŒ‡å®šçš„æ¥ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šçš„è¯ï¼Œå°±ä½¿ç”¨æ‰€æœ‰èƒ½ç”¨çš„ã€‚</p><h2 id="launcher"><a href="#launcher" class="headerlink" title="launcher"></a>launcher</h2><pre class="line-numbers language-python"><code class="language-python">    <span class="token comment" spellcheck="true"># init distributed env first, since logger depends on the dist info.</span>    <span class="token keyword">if</span> args<span class="token punctuation">.</span>launcher <span class="token operator">==</span> <span class="token string">'none'</span><span class="token punctuation">:</span>        distributed <span class="token operator">=</span> <span class="token boolean">False</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        distributed <span class="token operator">=</span> <span class="token boolean">True</span>        init_dist<span class="token punctuation">(</span>args<span class="token punctuation">.</span>launcher<span class="token punctuation">,</span> <span class="token operator">**</span>cfg<span class="token punctuation">.</span>dist_params<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># re-set gpu_ids with distributed training mode</span>        _<span class="token punctuation">,</span> world_size <span class="token operator">=</span> get_dist_info<span class="token punctuation">(</span><span class="token punctuation">)</span>        cfg<span class="token punctuation">.</span>gpu_ids <span class="token operator">=</span> range<span class="token punctuation">(</span>world_size<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…³äºåˆ†å¸ƒå¼çš„ï¼Œæš‚æ—¶æ²¡æœ‰æ—¶é—´ä¹Ÿæ²¡æœ‰èƒ½åŠ›å»ç»§ç»­çœ‹ã€‚</p><h2 id="create-work-dir"><a href="#create-work-dir" class="headerlink" title="create work_dir"></a>create work_dir</h2><pre class="line-numbers language-python"><code class="language-python">    <span class="token comment" spellcheck="true"># create work_dir</span>    mmcv<span class="token punctuation">.</span>mkdir_or_exist<span class="token punctuation">(</span>osp<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>cfg<span class="token punctuation">.</span>work_dir<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># dump config</span>    cfg<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>osp<span class="token punctuation">.</span>join<span class="token punctuation">(</span>cfg<span class="token punctuation">.</span>work_dir<span class="token punctuation">,</span> osp<span class="token punctuation">.</span>basename<span class="token punctuation">(</span>args<span class="token punctuation">.</span>config<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># init the logger before other steps</span>    timestamp <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y%m%d_%H%M%S'</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    log_file <span class="token operator">=</span> osp<span class="token punctuation">.</span>join<span class="token punctuation">(</span>cfg<span class="token punctuation">.</span>work_dir<span class="token punctuation">,</span> f<span class="token string">'{timestamp}.log'</span><span class="token punctuation">)</span>    logger <span class="token operator">=</span> get_root_logger<span class="token punctuation">(</span>log_file<span class="token operator">=</span>log_file<span class="token punctuation">,</span> log_level<span class="token operator">=</span>cfg<span class="token punctuation">.</span>log_level<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šé¢ä»‹ç»work_dirçš„æ—¶å€™ä¼¼ä¹å¹¶æ²¡æœ‰è¯¦ç»†ä»‹ç»æ€ä¹ˆåˆ›ç«‹çš„æ–‡ä»¶ä¸ç›®å½•ï¼Œå®é™…ä¸Šä»£ç åœ¨è¿™é‡Œã€‚</p><p>å…·ä½“è¿‡ç¨‹ä¸å¤šè§£é‡Šäº†ï¼Œç»“æœè¿˜æ˜¯ä¸Šé¢çš„é‚£ä¸ªç»“æœï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016161532.png" alt></p><h2 id="record-the-log"><a href="#record-the-log" class="headerlink" title="record the log"></a>record the log</h2><pre class="line-numbers language-python"><code class="language-python">    <span class="token comment" spellcheck="true"># init the meta dict to record some important information such as</span>    <span class="token comment" spellcheck="true"># environment info and seed, which will be logged</span>    meta <span class="token operator">=</span> dict<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># log env info</span>    env_info_dict <span class="token operator">=</span> collect_env<span class="token punctuation">(</span><span class="token punctuation">)</span>    env_info <span class="token operator">=</span> <span class="token string">'\n'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span>f<span class="token string">'{k}: {v}'</span><span class="token punctuation">)</span> <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> env_info_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    dash_line <span class="token operator">=</span> <span class="token string">'-'</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">+</span> <span class="token string">'\n'</span>    logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'Environment info:\n'</span> <span class="token operator">+</span> dash_line <span class="token operator">+</span> env_info <span class="token operator">+</span> <span class="token string">'\n'</span> <span class="token operator">+</span>                dash_line<span class="token punctuation">)</span>    meta<span class="token punctuation">[</span><span class="token string">'env_info'</span><span class="token punctuation">]</span> <span class="token operator">=</span> env_info    meta<span class="token punctuation">[</span><span class="token string">'config'</span><span class="token punctuation">]</span> <span class="token operator">=</span> cfg<span class="token punctuation">.</span>pretty_text    <span class="token comment" spellcheck="true"># log some basic info</span>    logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span>f<span class="token string">'Distributed training: {distributed}'</span><span class="token punctuation">)</span>    logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span>f<span class="token string">'Config:\n{cfg.pretty_text}'</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># set random seeds</span>    <span class="token keyword">if</span> args<span class="token punctuation">.</span>seed <span class="token keyword">is</span> <span class="token operator">not</span> None<span class="token punctuation">:</span>        logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span>f<span class="token string">'Set random seed to {args.seed}, '</span>                    f<span class="token string">'deterministic: {args.deterministic}'</span><span class="token punctuation">)</span>        set_random_seed<span class="token punctuation">(</span>args<span class="token punctuation">.</span>seed<span class="token punctuation">,</span> deterministic<span class="token operator">=</span>args<span class="token punctuation">.</span>deterministic<span class="token punctuation">)</span>    cfg<span class="token punctuation">.</span>seed <span class="token operator">=</span> args<span class="token punctuation">.</span>seed    meta<span class="token punctuation">[</span><span class="token string">'seed'</span><span class="token punctuation">]</span> <span class="token operator">=</span> args<span class="token punctuation">.</span>seed    meta<span class="token punctuation">[</span><span class="token string">'exp_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> osp<span class="token punctuation">.</span>basename<span class="token punctuation">(</span>args<span class="token punctuation">.</span>config<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è®°å½•ç›¸å…³çš„è®­ç»ƒé‡è¦çš„ä¿¡æ¯ï¼Œæ¯”å¦‚è¯´è®­ç»ƒæ‰€ç”¨ç¯å¢ƒï¼Œè¿˜æ˜¯ä»¥æˆ‘ä¸Šæ¬¡è®­ç»ƒçš„ç¯å¢ƒä¸ºä¾‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016180730.png" alt></p><p>ä»¥åŠæ¨¡å‹çš„ä¸€äº›è®¾å®šï¼Œæ¯”å¦‚backboneã€neckã€headã€è®­ç»ƒçš„è®¾å®šç­‰ç­‰ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016180846.png" alt></p><p>å¦å¤–è¿˜æœ‰ä¸€äº›å°±æ˜¯è®­ç»ƒå’Œæµ‹è¯•çš„pipeline:</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016180926.png" alt></p><p>å¦å¤–å°±æ˜¯ä¸€äº›å…³äºæ•°æ®é›†çš„ä¸€äº›ä½ç½®ä¸è®­ç»ƒé›†ã€éªŒè¯é›†ã€æµ‹è¯•é›†ä¿¡æ¯</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016181058.png" alt></p><p>ä»¥åŠä¸€äº›è¶…å‚æ•°çš„è®¾å®šã€è®­ç»ƒæƒé‡ä½ç½®ã€ä¸€äº›æ¨¡å‹ä¿å­˜ä½ç½®ã€gpuè®¾å®šç­‰ç­‰</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016181219.png" alt></p><p>å¦å¤–å°±æ˜¯å„ä¸ªå±‚å‚æ•°çš„ä¿¡æ¯äº†ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016181318.png" alt></p><p>è¿™ä¸ªå°±å¾ˆé•¿äº†ï¼Œåªæˆªäº†ä¸€å°å°éƒ¨åˆ†å›¾è€Œå·²ã€‚</p><h2 id="build-detector"><a href="#build-detector" class="headerlink" title="build_detector"></a>build_detector</h2><pre class="line-numbers language-python"><code class="language-python">    model <span class="token operator">=</span> build_detector<span class="token punctuation">(</span>        cfg<span class="token punctuation">.</span>model<span class="token punctuation">,</span>        train_cfg<span class="token operator">=</span>cfg<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'train_cfg'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        test_cfg<span class="token operator">=</span>cfg<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'test_cfg'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    model<span class="token punctuation">.</span>init_weights<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™é‡Œä½¿ç”¨åˆ°äº†å‡½æ•°<code>build_detector()</code>, è¿™é‡Œä¼ äº† å‚æ•°<code>cfg.model, cfg.train_cfg, cfg.test_cfg</code>. å¦å¤–å°±æ˜¯modelçš„åˆå§‹åŒ–äº†ã€‚æˆ‘ä»¬é¦–å…ˆæ¥çœ‹ä¸€ä¸‹<code>cfg.model, cfg.train_cfg, cfg.test_cfg</code>è¿™äº›ä¸œè¥¿éƒ½æ˜¯ä»€ä¹ˆï¼Œè¿˜æ˜¯ä»¥æˆ‘ä»¬ä¸Šæ¬¡å†™çš„ä»£ç ä¸ºä¾‹ï¼Œçœ‹ä¸€ä¸‹è¿™å‡ ä¸ªéƒ¨åˆ†éƒ½æ˜¯å«å“ªäº›ä¸œè¥¿ã€‚</p><h3 id="cfg-model-cfg-train-cfg-cfg-test-cfg"><a href="#cfg-model-cfg-train-cfg-cfg-test-cfg" class="headerlink" title="cfg.model, cfg.train_cfg, cfg.test_cfg"></a><code>cfg.model, cfg.train_cfg, cfg.test_cfg</code></h3><p>æŸ¥çœ‹çš„ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> mmcv <span class="token keyword">import</span> Config<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    cfg <span class="token operator">=</span> Config<span class="token punctuation">.</span>fromfile<span class="token punctuation">(</span><span class="token string">"configs/balloon/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_balloon.py"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(cfg)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'cfg.model:\n'</span><span class="token punctuation">,</span> cfg<span class="token punctuation">.</span>model<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'cfg.train_cfg:\n'</span><span class="token punctuation">,</span> cfg<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'train_cfg'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'cfg.test_cfg:\n'</span><span class="token punctuation">,</span> cfg<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'test_cfg'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬å¯ä»¥çœ‹ä¸‹è¿è¡Œç»“æœï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016183013.png" alt></p><p>å¯ä»¥å‘ç°è¿™é‡Œé¢<code>cfg.model</code>æ˜¯ä¸€äº›å…³äºæ¨¡å‹çš„é…ç½®ä¿¡æ¯è€Œ<code>train_cfg</code>è¿˜æœ‰<code>test_cfg</code>æ˜¯<code>None</code>.</p><p>æˆ‘ä»¬æ¥ä¸‹æ¥å¯ä»¥çœ‹ä¸€ä¸‹å…³äº<code>build_detector</code>è¿™ä¸ªå‡½æ•°çš„å®šä¹‰ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯ä»<code>from mmdet.models import build_detector</code>è¿™ä¸ªæŒ‡ä»¤ä¸­æ‰¾åˆ°çš„ï¼Œè€Œå®ƒä½äº<code>mmdet/models/builder.py</code>ä¸­ï¼š</p><h3 id="build-detector-1"><a href="#build-detector-1" class="headerlink" title="build_detector"></a>build_detector</h3><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span>  <span class="token function">build_detector</span><span class="token punctuation">(</span>cfg<span class="token punctuation">,</span> train_cfg<span class="token operator">=</span>None<span class="token punctuation">,</span> test_cfg<span class="token operator">=</span>None<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Build detector."""</span>    <span class="token keyword">if</span> train_cfg <span class="token keyword">is</span> <span class="token operator">not</span> None <span class="token operator">or</span> test_cfg <span class="token keyword">is</span> <span class="token operator">not</span> None<span class="token punctuation">:</span>        warnings<span class="token punctuation">.</span>warn<span class="token punctuation">(</span>            <span class="token string">'train_cfg and test_cfg is deprecated, '</span>            <span class="token string">'please specify them in model'</span><span class="token punctuation">,</span> UserWarning<span class="token punctuation">)</span>    <span class="token keyword">assert</span> cfg<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'train_cfg'</span><span class="token punctuation">)</span> <span class="token keyword">is</span> None <span class="token operator">or</span> train_cfg <span class="token keyword">is</span> None<span class="token punctuation">,</span> \        <span class="token string">'train_cfg specified in both outer field and model field '</span>    <span class="token keyword">assert</span> cfg<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'test_cfg'</span><span class="token punctuation">)</span> <span class="token keyword">is</span> None <span class="token operator">or</span> test_cfg <span class="token keyword">is</span> None<span class="token punctuation">,</span> \        <span class="token string">'test_cfg specified in both outer field and model field '</span>    <span class="token keyword">return</span> DETECTORS<span class="token punctuation">.</span>build<span class="token punctuation">(</span>        cfg<span class="token punctuation">,</span> default_args<span class="token operator">=</span>dict<span class="token punctuation">(</span>train_cfg<span class="token operator">=</span>train_cfg<span class="token punctuation">,</span> test_cfg<span class="token operator">=</span>test_cfg<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°<code>train_cfg, test_cfg</code>åœ¨è¿™é‡Œéƒ½æ˜¯é»˜è®¤å‚æ•°ã€‚è¿™ä¸ªä¹Ÿæ˜¯æˆ‘ä»¬å¿…é¡»è¦å®šä¹‰çš„ï¼Œå¦åˆ™ä¼šæœ‰warningsæŠ¥é”™åœ¨è¿™é‡Œã€‚</p><p>å‡½æ•°æœ€åè¿”å›å€¼çš„æ—¶å€™å°±æ˜¯å†æ¬¡è°ƒç”¨äº†DETECTORS.buildè¿™ä¸ªå‡½æ•°ï¼Œä¸»è¦å‚æ•°ä»ç„¶æ˜¯cfg,æˆ‘ä»¬ç»§ç»­è¿½è¸ªï¼š</p><p>æˆ‘ä»¬å‘ç°DETECTORSå°±æ˜¯åœ¨<code>mmdet/models/builder.py</code>è¿™é‡Œå®šä¹‰çš„MODELSï¼Œè€Œä¸”æ¥çœ‹è¿™ä¸ªMODELSæ˜¯ä»è¿™ä¸€è¡Œä»£ç ä¸­æ‰¾åˆ°çš„ï¼Œè€Œè°ƒç”¨çš„Registryå‡½æ•°æ˜¯åœ¨mmcvçš„utilsé‡Œé¢ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016190348.png" alt></p><p>æˆ‘ä»¬éœ€è¦çœ‹ä¸€çœ‹Registryè¿™ä¸ªå‡½æ•°æºç ï¼Œä½äº<code>mmcv/utils/registry.py</code>æ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”æˆ‘æ‰“å¼€çœ‹äº†æ‰çŸ¥é“ï¼Œè¿™åŸæ¥æ˜¯ä¸ªç±»ğŸ˜“ï¼š</p><h3 id="Registry"><a href="#Registry" class="headerlink" title="Registry"></a>Registry</h3><p>ç±»æœ¬èº«ç‰¹åˆ«é•¿ï¼Œæˆ‘è¿™é‡Œå°±ä¸ç²˜è´´æºç äº†ï¼Œè¿™é‡Œå°†ä»–çš„æ³¨é‡Šæ–‡æ¡£è¯´æ˜ä¸€ä¸‹å°±OKï¼Œå› ä¸ºæœ¬èº«æ³¨é‡Šè¯´æ˜æ–‡æ¡£è®²è§£çš„å·²ç»å¾ˆæ¸…æ¥šäº†ï¼š</p><blockquote><p>  â€œâ€â€A registry to map strings to classes.</p><p>  Registered object could be built from registry.</p><p>  Example:</p><p>â€‹    &gt;&gt;&gt; MODELS = Registry(â€˜modelsâ€™)</p><p>â€‹    &gt;&gt;&gt; @MODELS.register_module()</p><p>â€‹    &gt;&gt;&gt; class ResNet:</p><p>â€‹    &gt;&gt;&gt;   pass</p><p>â€‹    &gt;&gt;&gt; resnet = MODELS.build(dict(type=â€™ResNetâ€™))</p><p>  Please refer to</p><p>  <a href="https://mmcv.readthedocs.io/en/latest/understand_mmcv/registry.html" target="_blank" rel="noopener">https://mmcv.readthedocs.io/en/latest/understand_mmcv/registry.html</a> for</p><p>  advanced useage.</p><p>  Args:</p><p>â€‹    name (str): Registry name.</p><p>â€‹    build_func(func, optional): Build function to construct instance from</p><p>â€‹      Registry, func:<code>build_from_cfg</code> is used if neither <code>parent</code> or</p><p>â€‹      <code>build_func</code> is specified. If <code>parent</code> is specified and</p><p>â€‹      <code>build_func</code> is not given,  <code>build_func</code> will be inherited</p><p>â€‹      from <code>parent</code>. Default: None.</p><p>â€‹    parent (Registry, optional): Parent registry. The class registered in</p><p>â€‹      children registry could be built from parent. Default: None.</p><p>â€‹    scope (str, optional): The scope of registry. It is the key to search</p><p>â€‹      for children registry. If not specified, scope will be the name of</p><p>â€‹      the package where class is defined, e.g. mmdet, mmcls, mmseg.</p><p>â€‹      Default: None.</p><p>  â€œâ€â€</p></blockquote><p>è¿™é‡Œå¤§è‡´è§£é‡Šä¸€ä¸‹ï¼Œ(æˆ‘å¦å¤–å†™äº†ä¸€ç¯‡ç†è§£registryçš„Blog):</p><ul><li>ç›¸å½“äºå°†å­—ç¬¦ä¸²æ˜ å°„åˆ°ç±»çš„æ³¨å†Œè¡¨ï¼ˆregistry)ã€‚</li><li>è¯¥registeredçš„å¯¹è±¡å¯ä»¥ä»registryä¸­åˆ›å»º</li><li>è¿™ä¸ªregistryçš„ç†è§£å¯èƒ½ç¨å¾®æœ‰äº›å›°éš¾ã€‚è¿™é‡Œè®©æˆ‘ä»¬å‚è€ƒ<a href="https://mmcv.readthedocs.io/en/latest/understand_mmcv/registry.htmlç½‘ç«™æ¥é˜…è¯»å­¦ä¹ ç†è§£" target="_blank" rel="noopener">https://mmcv.readthedocs.io/en/latest/understand_mmcv/registry.htmlç½‘ç«™æ¥é˜…è¯»å­¦ä¹ ç†è§£</a></li></ul><p>ç›®å‰æˆ‘ä»¬å¯ä»¥å…ˆç®€å•ä»ä»–çš„å„é¡¹å‚æ•°æ¥ç¨å¾®ç†è§£ä¸€ä¸‹ï¼Œè™½ç„¶å¯èƒ½ç†è§£èµ·æ¥éš¾åº¦æœ‰äº›å¤§(å¯¹æˆ‘è€Œè¨€)ï¼š</p><blockquote><p>  Args:</p><p>â€‹    name (str): Registry name.</p><p>â€‹    build_func(func, optional): Build function to construct instance from</p><p>â€‹      Registry, func:<code>build_from_cfg</code> is used if neither <code>parent</code> or</p><p>â€‹      <code>build_func</code> is specified. If <code>parent</code> is specified and</p><p>â€‹      <code>build_func</code> is not given,  <code>build_func</code> will be inherited</p><p>â€‹      from <code>parent</code>. Default: None.</p><p>â€‹    parent (Registry, optional): Parent registry. The class registered in</p><p>â€‹      children registry could be built from parent. Default: None.</p><p>â€‹    scope (str, optional): The scope of registry. It is the key to search</p><p>â€‹      for children registry. If not specified, scope will be the name of</p><p>â€‹      the package where class is defined, e.g. mmdet, mmcls, mmseg.</p><p>â€‹      Default: None.</p></blockquote><ul><li>name: è¿™ä¸ªæ˜¯registryçš„åç§°ï¼Œç±»å‹ä¸ºstrå‹</li><li>build_funcï¼šè¿™ä¸ªæ˜¯å¯é€‰çš„ï¼Œä»Registryä¸­æ„å»ºå®ä¾‹çš„æ„é€ å‡½æ•°ã€‚çœ‹ç›®å‰çš„æºç æ¥è¯´ï¼Œè¿™ä¸ªå¹¶ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ›´åƒæ˜¯ä¸€ä¸ªattributeï¼Œä»–çš„ä¼˜å…ˆçº§æ˜¯è‡ªå·±å®šä¹‰æ—¶ä¼ å…¥çš„<code>build_func</code>, parentçš„<code>build_func</code>, cfgæ–‡ä»¶ä¸­çš„<code>build_from_cfg</code>.(æˆ‘ä»¬çš„ä¸Šæ–‡å®šä¹‰çš„æ—¶å€™ä½¿ç”¨çš„æ˜¯çˆ¶ç±»ä¸ºMMCV_MODELS)</li><li>scope: registryçš„èŒƒå›´ã€‚è¿™æ˜¯å¯»æ‰¾å­ç±»registryçš„å…³é”®ã€‚å¦‚æœæ²¡æœ‰è¢«å®šä¹‰ï¼Œä¹Ÿå°±æ˜¯é€‰ç”¨é»˜è®¤çš„å‚æ•°å®šä¹‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„scopeå°†ä¼šæ˜¯ç±»è¢«å®šä¹‰æ—¶çš„æ•´ä¸ªpackageæ–‡ä»¶ï¼Œe.g. mmdet, mmcls, mmseg</li></ul><p>ç»§ç»­æº¯æºï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å…³äºMMCV_MODELSçš„å®šä¹‰ï¼š</p><h3 id="MMCV-MODELS"><a href="#MMCV-MODELS" class="headerlink" title="MMCV_MODELS"></a>MMCV_MODELS</h3><p>è¿˜æ˜¯å›åˆ°æˆ‘ä»¬çš„æ–‡ä»¶<code>mmdetection/mmdet/models/builder.py</code>ä¸­,æ‰¾åˆ°<code>MMCV_MODELS</code>:</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016193544.png" alt></p><p>å¯ä»¥çœ‹åˆ°åŸæ¥è¿˜æ˜¯ä»mmcvä¸­ææ¥çš„ï¼Œåªä¸è¿‡æ˜¯ä»mmcv.cnnä¸­importçš„MODELSï¼Œé‚£æˆ‘ä»¬å»çœ‹ä¸€ä¸‹è¿™ä¸ªMODELSï¼Œæˆ‘åœ¨æ–‡ä»¶<code>mmcv/cnn/builder.py</code>ä¸­æ‰¾åˆ°äº†MODELS,å…¶ä¸­å‘ç°å®é™…ä¸Šå®ƒæœ¬èº«ä¹Ÿæ˜¯é Registryå®šä¹‰çš„ç±»ï¼ˆ<del>æˆ‘å¥½åƒå†è¯´åºŸè¯ï¼Œæ¯•ç«Ÿå› ä¸ºè¿™ä¸ªæ˜¯çˆ¶ç±»å˜›</del>ï¼‰</p><p><strong>ä½†æ˜¯ï¼è¿™é‡Œé¢ç”¨åˆ°äº†å‚æ•°<code>build_func</code></strong>, æˆ‘å‘ç°è¿™ä¸ªbuild.pyä¸­å®é™…ä¸Šä¹Ÿå°±å®šä¹‰äº†ä¸€ä¸ªMODELSè¿˜æœ‰ç”Ÿæˆè¿™ä¸ªMODELSè¦ç”¨åˆ°çš„å‡½æ•°<code>build_model_from_cfg</code>, è¿™ä¸ªå‡½æ•°å°±æ˜¯æˆ‘ä»¬çš„å‚æ•°<code>build_func</code>ã€‚ æˆ‘ä»¬å¯ä»¥æ¥çœ‹ä¸€ä¸‹è¿™ä¸ª<code>.py</code>æ–‡ä»¶:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Copyright (c) OpenMMLab. All rights reserved.</span><span class="token keyword">from</span> <span class="token punctuation">.</span><span class="token punctuation">.</span>runner <span class="token keyword">import</span> Sequential<span class="token keyword">from</span> <span class="token punctuation">.</span><span class="token punctuation">.</span>utils <span class="token keyword">import</span> Registry<span class="token punctuation">,</span> build_from_cfg<span class="token keyword">def</span> <span class="token function">build_model_from_cfg</span><span class="token punctuation">(</span>cfg<span class="token punctuation">,</span> registry<span class="token punctuation">,</span> default_args<span class="token operator">=</span>None<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Build a PyTorch model from config dict(s). Different from    ``build_from_cfg``, if cfg is a list, a ``nn.Sequential`` will be built.    Args:        cfg (dict, list[dict]): The config of modules, is is either a config            dict or a list of config dicts. If cfg is a list, a            the built modules will be wrapped with ``nn.Sequential``.        registry (:obj:`Registry`): A registry the module belongs to.        default_args (dict, optional): Default arguments to build the module.            Defaults to None.    Returns:        nn.Module: A built nn module.    """</span>    <span class="token keyword">if</span> isinstance<span class="token punctuation">(</span>cfg<span class="token punctuation">,</span> list<span class="token punctuation">)</span><span class="token punctuation">:</span>        modules <span class="token operator">=</span> <span class="token punctuation">[</span>            build_from_cfg<span class="token punctuation">(</span>cfg_<span class="token punctuation">,</span> registry<span class="token punctuation">,</span> default_args<span class="token punctuation">)</span> <span class="token keyword">for</span> cfg_ <span class="token keyword">in</span> cfg        <span class="token punctuation">]</span>        <span class="token keyword">return</span> Sequential<span class="token punctuation">(</span><span class="token operator">*</span>modules<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> build_from_cfg<span class="token punctuation">(</span>cfg<span class="token punctuation">,</span> registry<span class="token punctuation">,</span> default_args<span class="token punctuation">)</span>MODELS <span class="token operator">=</span> Registry<span class="token punctuation">(</span><span class="token string">'model'</span><span class="token punctuation">,</span> build_func<span class="token operator">=</span>build_model_from_cfg<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡ä»¥ä¸Šä»£ç å¯ä»¥çœ‹å‡ºå®é™…ä¸Šè¿™ä¸ªå‡½æ•°ä½œç”¨å¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯æ ¹æ®æˆ‘ä»¬çš„cfgæ¥ç”Ÿç”Ÿæˆæˆ‘ä»¬çš„modelsï¼Œä»–çš„è¿”å›å€¼ä¸º<code>nn.Module</code>ç±»å‹ï¼Œæ˜¯ç”¨æ¥ç”Ÿæˆæˆ‘ä»¬çš„æ¨¡å‹ç”¨çš„ã€‚è‡³äºä»–çš„å‚æ•°æˆ‘å°±ä¸å¤šä»‹ç»äº†ï¼Œè¿™ä¸ªè¿˜æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œå¦å¤–ï¼Œå®é™…ä¸Šè¿™é‡Œé¢ä¸»è¦ç”¨åˆ°çš„æ ¹æ®cfgç”Ÿæˆmodelsçš„å‡½æ•°æ˜¯<code>build_from_cfg</code>å‡½æ•°ï¼ˆä¸¤è€…å‚æ•°éƒ½å·®ä¸å¤šï¼‰ã€‚è€Œæˆ‘ä»¬è¿™é‡Œä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨æ˜¯å› ä¸ºæˆ‘ä»¬çš„cfgæœ‰å¯èƒ½æ˜¯ä¸€ä¸ªlist, æ‰€ä»¥å°†é‚£ä¸€éƒ¨åˆ†å°è£…æˆå‡½æ•°ç„¶åè¿™ä¸ªå‡½æ•°æ¥ç»Ÿä¸€è°ƒç”¨ã€‚</p><p><em>å¦‚æœè¦æ‰¾build_from_cfgå‡½æ•°ï¼Œè¯·ä»<code>mmcv/utils/registry.py</code>ä¸­å¯»æ‰¾ã€‚æˆ‘å¤§è‡´è¯»äº†è¯»æºç ï¼Œä¸­é—´è¿˜è°ƒç”¨åˆ°äº†è®¸å¤šregistryçš„æ–¹æ³•ï¼Œè¿˜æ˜¯å¾ˆå€¼å¾—ä¸€è¯»çš„ã€‚</em></p><p>OKï¼Œåˆ°æ­¤æˆ‘ä»¬å…³äºMODELSçš„è¿½è¸ªåˆ°æ­¤ä¸ºæ­¢äº†ï¼Œæˆ‘ä»¬å¼€å§‹â€å›æº¯â€œä¸€ä¸‹æˆ‘ä»¬çš„å·¥ä½œï¼Œæˆ‘ä»¬åˆšæ‰ä»build_detectoré‚£ä¸€å°éƒ¨åˆ†çš„è¿”å›å€¼çš„DETECTORSå¼€å§‹è¿½è¸ªï¼Œç›®å‰ç»§ç»­çœ‹<code>DETECTORS.build()</code>çš„buildå‡½æ•°ï¼š</p><h3 id="build"><a href="#build" class="headerlink" title="build()"></a>build()</h3><p>å®é™…ä¸Šæˆ‘ä»¬äº†è§£åˆ°DETECTORSæ˜¯ä¸ªå•¥ä¹‹åï¼Œè¿™éƒ½ä¸å†æ˜¯é—®é¢˜äº†ã€‚å› ä¸ºDETECTORSå°±æ˜¯ä¸ªæˆ‘ä»¬å®šä¹‰çš„ç±»registryå˜›ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥è¿›è¡Œè¿™ä¸ªbuildï¼Œå®é™…ä¸Šå°±æ˜¯ä¸ªç±»å†…æ–¹æ³•çš„è°ƒç”¨ï¼š</p><pre class="line-numbers language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">build</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>build_func<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">,</span> registry<span class="token operator">=</span>self<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å“ˆå“ˆå“ˆï¼Œè¯¥é€ƒçš„è¿˜æ˜¯é€ƒä¸æ‰çš„ï¼Œè¿™ä¸ªç”¨çš„è¿˜æ˜¯é‚£ä¸ªå‡½æ•°ï¼Œç®€ç›´æ²¡ä¸€ç‚¹â€œæ–°æ„â€â€”â€”ä¸è¿‡æˆ‘è¿˜æ˜¯å¾ˆå–œæ¬¢æ²¡æœ‰æ–°æ„çš„ï¼Œæ¯•ç«Ÿä¸éœ€è¦è¿›ä¸€æ­¥è¯»æºç æ‰å¤´å‘äº†â€¦â€¦</p><p>OKï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„<code>build_detector</code>éƒ¨åˆ†æˆåŠŸç»“æŸäº†ï¼ï¼å“ˆå“ˆå“ˆï¼Œç»ˆäºç»“æŸäº†ï¼Œå¼€å§‹å¾€åç»§ç»­è¯»<code>train.py</code>æ–‡ä»¶ï¼š</p><h2 id="init-weights"><a href="#init-weights" class="headerlink" title="init_weights()"></a>init_weights()</h2><pre class="line-numbers language-python"><code class="language-python">model<span class="token punctuation">.</span>init_weights<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é€šè¿‡å‰é¢çš„æ•´ä½“åˆ†ææˆ‘ä»¬ç°åœ¨çŸ¥é“ï¼Œmodelå®é™…ä¸Šå°±æ˜¯æˆ‘ä»¬æ„é€ å®Œæˆåçš„æ¨¡å‹ã€‚ç±»å‹ä¸ºnn.Moduleã€‚</p><p>æˆ‘Googleäº†ä¸€ä¸‹è¿™ä¸ªä¸œè¥¿ï¼Œå‘ç°äº†ç¬¬ä¸€ä¸ªå°±æ˜¯mmdetectionçš„å®˜æ–¹æ–‡æ¡£:<a href="https://mmdetection.readthedocs.io/en/latest/tutorials/init_cfg.html" target="_blank" rel="noopener">https://mmdetection.readthedocs.io/en/latest/tutorials/init_cfg.html</a></p><p>è®²çš„è¿˜æ˜¯éå¸¸è¯¦ç»†çš„ã€‚å®é™…ä¸Šè¿™å°±æ˜¯ä¸€ä¸ªåˆå§‹åŒ–æƒé‡çš„è¿‡ç¨‹ã€‚æˆ‘ä»¬åªéœ€è¦çœ‹çœ‹æœ€ä¸€å¼€å§‹çš„å°±OKï¼Œæˆ‘ä»¬ä¸»è¦å°±æ˜¯ä¸¤æ­¥ï¼š</p><p>During training, a proper initialization strategy is beneficial to speeding up the training or obtaining a higher performance. <a href="https://github.com/open-mmlab/mmcv/blob/master/mmcv/cnn/utils/weight_init.py" target="_blank" rel="noopener">MMCV</a> provide some commonly used methods for initializing modules like <code>nn.Conv2d</code>. Model initialization in MMdetection mainly uses <code>init_cfg</code>. Users can initialize models with following two steps:</p><ol><li>Define <code>init_cfg</code> for a model or its components in <code>model_cfg</code>, but <code>init_cfg</code> of children components have higher priority and will override <code>init_cfg</code> of parents modules.</li><li>Build model as usual, but call <code>model.init_weights()</code> method explicitly, and model parameters will be initialized as configuration.</li></ol><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„æ¨¡å‹å‚æ•°åˆå§‹åŒ–æ˜¯é€šè¿‡å‘½ä»¤<code>model.init_weights()</code>æ˜¾å¼è°ƒç”¨çš„ã€‚åé¢ä¹Ÿä»‹ç»åˆ°äº†å·¥ä½œæµï¼š</p><p>The high-level workflow of initialization in MMdetection is :</p><p>model_cfg(init_cfg) -&gt; build_from_cfg -&gt; model -&gt; init_weight() -&gt; initialize(self, self.init_cfg) -&gt; childrenâ€™s init_weight()</p><p>å®é™…ä¸Šï¼Œæˆ‘ä»¬åˆšæ‰çš„ä»£ç è¿½è¸ªå·²ç»æ¶‰åŠåˆ°äº†ä»¥ä¸Šçš„å¾ˆå¤šéƒ¨åˆ†ã€‚æ‰€ä»¥è¿™ä¸ªä¸å¤šä»‹ç»ã€‚</p><h2 id="build-dataset"><a href="#build-dataset" class="headerlink" title="build_dataset"></a>build_dataset</h2><pre class="line-numbers language-python"><code class="language-python">datasets <span class="token operator">=</span> <span class="token punctuation">[</span>build_dataset<span class="token punctuation">(</span>cfg<span class="token punctuation">.</span>data<span class="token punctuation">.</span>train<span class="token punctuation">)</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å…ˆä¸çœ‹è¿™ä¸ªå‡½æ•°ï¼Œå…ˆæ¥äº†è§£ä¸€ä¸‹å…³äºcfg.data.trainæ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ï¼Œå¦å¤–ï¼Œç”±äºåé¢çš„éœ€è¦ï¼Œæˆ‘ä»¬ä¹Ÿæ¥ç€çœ‹ä¸€ä¸‹å…³äºcfg.data.train[â€˜typeâ€™]çš„ç±»å‹ï¼Œä¾ç„¶ä¸€ä¹‹å‰çš„ä¸€ä¸ªconfigæ–‡ä»¶æ¥åšå®éªŒï¼Œå®éªŒä»£ç å¦‚ä¸‹:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> mmcv <span class="token keyword">import</span> Config<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    cfg <span class="token operator">=</span> Config<span class="token punctuation">.</span>fromfile<span class="token punctuation">(</span><span class="token string">"configs/balloon/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_balloon.py"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(cfg)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'cfg.model:\n'</span><span class="token punctuation">,</span> cfg<span class="token punctuation">.</span>model<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'cfg.train_cfg:\n'</span><span class="token punctuation">,</span> cfg<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'train_cfg'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'cfg.test_cfg:\n'</span><span class="token punctuation">,</span> cfg<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'test_cfg'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'cfg.data.train:\n'</span><span class="token punctuation">,</span> cfg<span class="token punctuation">.</span>data<span class="token punctuation">.</span>train<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'cfg.data.train[\'type\']:\n'</span><span class="token punctuation">,</span> cfg<span class="token punctuation">.</span>data<span class="token punctuation">.</span>train<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬æ¥çœ‹ä¸€çœ‹è¿è¡Œç»“æœï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016205309.png" alt></p><p>å½“ç„¶æˆ‘ä»¬è¿™é‡Œå¹¶ä¸å…³å¿ƒå‰é¢çš„è¾“å‡ºï¼Œåªå…³å¿ƒåé¢çš„ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯æ•°æ®é›†çš„å„ç§å‚æ•°ä¸æ“ä½œï¼Œå…¶ä¸­â€™typeâ€™ä¸º<code>CoCoDataset</code>ç±»å‹ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸‹å‡½æ•°build_dataset():</p><p>å…¶ä¸­ç”¨åˆ°äº†å‡½æ•°build_dataset()ï¼Œæˆ‘ä»¬ä»ä¸Šæ–‡ä»£ç å¼•ç”¨<code>from mmdet.datasets import build_dataset</code>å¯ä»¥çœ‹åˆ°ï¼Œå®ƒæ¥è‡ªmmdet.datasets.ç»è¿‡æŸ¥æ‰¾ï¼Œä»–åœ¨<code>mmdetection/mmdet/datasets/builder.py</code>ä¸­ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">build_dataset</span><span class="token punctuation">(</span>cfg<span class="token punctuation">,</span> default_args<span class="token operator">=</span>None<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">from</span> <span class="token punctuation">.</span>dataset_wrappers <span class="token keyword">import</span> <span class="token punctuation">(</span>ConcatDataset<span class="token punctuation">,</span> RepeatDataset<span class="token punctuation">,</span>                                   ClassBalancedDataset<span class="token punctuation">,</span> MultiImageMixDataset<span class="token punctuation">)</span>    <span class="token keyword">if</span> isinstance<span class="token punctuation">(</span>cfg<span class="token punctuation">,</span> <span class="token punctuation">(</span>list<span class="token punctuation">,</span> tuple<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        dataset <span class="token operator">=</span> ConcatDataset<span class="token punctuation">(</span><span class="token punctuation">[</span>build_dataset<span class="token punctuation">(</span>c<span class="token punctuation">,</span> default_args<span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> cfg<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span> cfg<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'ConcatDataset'</span><span class="token punctuation">:</span>        dataset <span class="token operator">=</span> ConcatDataset<span class="token punctuation">(</span>            <span class="token punctuation">[</span>build_dataset<span class="token punctuation">(</span>c<span class="token punctuation">,</span> default_args<span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> cfg<span class="token punctuation">[</span><span class="token string">'datasets'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            cfg<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'separate_eval'</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span> cfg<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'RepeatDataset'</span><span class="token punctuation">:</span>        dataset <span class="token operator">=</span> RepeatDataset<span class="token punctuation">(</span>            build_dataset<span class="token punctuation">(</span>cfg<span class="token punctuation">[</span><span class="token string">'dataset'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> default_args<span class="token punctuation">)</span><span class="token punctuation">,</span> cfg<span class="token punctuation">[</span><span class="token string">'times'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span> cfg<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'ClassBalancedDataset'</span><span class="token punctuation">:</span>        dataset <span class="token operator">=</span> ClassBalancedDataset<span class="token punctuation">(</span>            build_dataset<span class="token punctuation">(</span>cfg<span class="token punctuation">[</span><span class="token string">'dataset'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> default_args<span class="token punctuation">)</span><span class="token punctuation">,</span> cfg<span class="token punctuation">[</span><span class="token string">'oversample_thr'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span> cfg<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'MultiImageMixDataset'</span><span class="token punctuation">:</span>        cp_cfg <span class="token operator">=</span> copy<span class="token punctuation">.</span>deepcopy<span class="token punctuation">(</span>cfg<span class="token punctuation">)</span>        cp_cfg<span class="token punctuation">[</span><span class="token string">'dataset'</span><span class="token punctuation">]</span> <span class="token operator">=</span> build_dataset<span class="token punctuation">(</span>cp_cfg<span class="token punctuation">[</span><span class="token string">'dataset'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        cp_cfg<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">)</span>        dataset <span class="token operator">=</span> MultiImageMixDataset<span class="token punctuation">(</span><span class="token operator">**</span>cp_cfg<span class="token punctuation">)</span>    <span class="token keyword">elif</span> isinstance<span class="token punctuation">(</span>cfg<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'ann_file'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>list<span class="token punctuation">,</span> tuple<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        dataset <span class="token operator">=</span> _concat_dataset<span class="token punctuation">(</span>cfg<span class="token punctuation">,</span> default_args<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        dataset <span class="token operator">=</span> build_from_cfg<span class="token punctuation">(</span>cfg<span class="token punctuation">,</span> DATASETS<span class="token punctuation">,</span> default_args<span class="token punctuation">)</span>    <span class="token keyword">return</span> dataset<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæ˜¯ç”¨æ¥è¿›è¡Œç›¸å…³çš„æ•°æ®ç±»å‹è¯»å–çš„ä¸€ä¸ªæ€»çš„å‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œé¢åˆ†äº†å¾ˆå¤šä¸ªç§ç±»ï¼ŒåŒ…æ‹¬å¦‚æœcfgæ–‡ä»¶æ˜¯å¤šç§æ•°æ®é›†æ€ä¹ˆè¯»å–æ€ä¹ˆåˆå¹¶ï¼Œå¦‚æœæ˜¯æ˜¯RepeatDatasetæ€ä¹ˆè¯»å–ï¼Œå¦‚æœæ˜¯ClassBalancedDatasetæ€ä¹ˆè¯»å–ï¼Œå¦‚æœæ˜¯MultiImageMixDatasetæ€ä¹ˆè¯»å–ç­‰ç­‰ç­‰ç­‰ã€‚è¿™é‡Œè¿˜æ˜¯éå¸¸é‡è¦çš„ã€‚</p><p>å¦å¤–å…³äºæˆ‘ä»¬çš„typeå¦‚æœæ˜¯<code>CocoDataset</code>æ€ä¹ˆæ¥ä¸‹æ¥èµ°ï¼Œæˆ‘ä¹Ÿè¯•äº†è¯•è¿™ä¸ªtypeæ˜¯æ€ä¹ˆå¾€åèµ°çš„ï¼Œé¦–å…ˆæˆ‘ä»¬å¯ä»¥æ’é™¤typeæ˜æ˜¾ä¸ç¬¦åˆçš„ï¼Œå¦å¤–ä¸¤ä¸ªisinstanceæˆ‘ä¹Ÿè¯•äº†è¯•ï¼Œä¹Ÿä¸å¯¹ã€‚é‚£ä¹ˆåªå¯èƒ½æ˜¯æœ€åä¸€ç§æƒ…å†µï¼Œä¹Ÿå³æœ€åä¸€ä¸ª<code>else</code>åé¢çš„ä»£ç ï¼š<code>dataset = build_from_cfg(cfg, DATASETS, default_args)</code>, é‚£ä¹ˆæˆ‘ä»¬æ¥ç€è¿½è¸ªå‡½æ•°ä¹‹å‰å…ˆææ¸…æ¥šè¿™ä¸ªDATASETS:åœ¨ç¬¬24è¡Œæ‰¾åˆ°äº†å®ƒçš„å®šä¹‰ï¼š</p><pre class="line-numbers language-python"><code class="language-python">DATASETS <span class="token operator">=</span> Registry<span class="token punctuation">(</span><span class="token string">'dataset'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å®é™…ä¸Šï¼Œè¿™é‡Œå°±å¯ä»¥çœ‹å‡ºæ¥ï¼Œå®ƒåˆæ˜¯ä¸€ä¸ªRegistryç±»ã€‚é‚£ä¹ˆæˆ‘ä»¬æ¥ä¸‹æ¥çœ‹çœ‹å‡½æ•°ä»£ç å§ï¼Œè¿™ä¸ªå‡½æ•°ä¹Ÿæ˜¯mmcv.utilså’Œ<code>Registry</code>ä¸€èµ·è¢«å¯¼å…¥çš„ï¼Œç»è¿‡æŸ¥æ‰¾ï¼Œå®ƒå’ŒRegistryä¸€æ ·ä¹Ÿåœ¨<code>mmcv/utils/registry.py</code>ä¸­ï¼ˆ<strong>æˆ‘ä¹Ÿæ˜¯åˆšåˆšæ‰å‘ç°è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬åˆšåˆšåœ¨MMCV_MODELSå°éƒ¨åˆ†æ¢è®¨çš„é‚£ä¸ªå°è£…å¥½çš„cfgå˜æˆæ¨¡å‹çš„å‡½æ•°ï¼ï¼ï¼å¤ªæƒŠå¹äº†ï¼ï¼</strong>)ï¼Œæˆ‘ä»¬è¿˜æ˜¯çœ‹ä¸€ä¸‹å®ƒçš„æºç ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">build_from_cfg</span><span class="token punctuation">(</span>cfg<span class="token punctuation">,</span> registry<span class="token punctuation">,</span> default_args<span class="token operator">=</span>None<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Build a module from config dict.    Args:        cfg (dict): Config dict. It should at least contain the key "type".        registry (:obj:`Registry`): The registry to search the type from.        default_args (dict, optional): Default initialization arguments.    Returns:        object: The constructed object.    """</span>    <span class="token keyword">if</span> <span class="token operator">not</span> isinstance<span class="token punctuation">(</span>cfg<span class="token punctuation">,</span> dict<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> TypeError<span class="token punctuation">(</span>f<span class="token string">'cfg must be a dict, but got {type(cfg)}'</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">'type'</span> <span class="token operator">not</span> <span class="token keyword">in</span> cfg<span class="token punctuation">:</span>        <span class="token keyword">if</span> default_args <span class="token keyword">is</span> None <span class="token operator">or</span> <span class="token string">'type'</span> <span class="token operator">not</span> <span class="token keyword">in</span> default_args<span class="token punctuation">:</span>            <span class="token keyword">raise</span> KeyError<span class="token punctuation">(</span>                <span class="token string">'`cfg` or `default_args` must contain the key "type", '</span>                f<span class="token string">'but got {cfg}\n{default_args}'</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token operator">not</span> isinstance<span class="token punctuation">(</span>registry<span class="token punctuation">,</span> Registry<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> TypeError<span class="token punctuation">(</span><span class="token string">'registry must be an mmcv.Registry object, '</span>                        f<span class="token string">'but got {type(registry)}'</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token punctuation">(</span>isinstance<span class="token punctuation">(</span>default_args<span class="token punctuation">,</span> dict<span class="token punctuation">)</span> <span class="token operator">or</span> default_args <span class="token keyword">is</span> None<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> TypeError<span class="token punctuation">(</span><span class="token string">'default_args must be a dict or None, '</span>                        f<span class="token string">'but got {type(default_args)}'</span><span class="token punctuation">)</span>    args <span class="token operator">=</span> cfg<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> default_args <span class="token keyword">is</span> <span class="token operator">not</span> None<span class="token punctuation">:</span>        <span class="token keyword">for</span> name<span class="token punctuation">,</span> value <span class="token keyword">in</span> default_args<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            args<span class="token punctuation">.</span>setdefault<span class="token punctuation">(</span>name<span class="token punctuation">,</span> value<span class="token punctuation">)</span>    obj_type <span class="token operator">=</span> args<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> isinstance<span class="token punctuation">(</span>obj_type<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">:</span>        obj_cls <span class="token operator">=</span> registry<span class="token punctuation">.</span>get<span class="token punctuation">(</span>obj_type<span class="token punctuation">)</span>        <span class="token keyword">if</span> obj_cls <span class="token keyword">is</span> None<span class="token punctuation">:</span>            <span class="token keyword">raise</span> KeyError<span class="token punctuation">(</span>                f<span class="token string">'{obj_type} is not in the {registry.name} registry'</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span> inspect<span class="token punctuation">.</span>isclass<span class="token punctuation">(</span>obj_type<span class="token punctuation">)</span><span class="token punctuation">:</span>        obj_cls <span class="token operator">=</span> obj_type    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> TypeError<span class="token punctuation">(</span>            f<span class="token string">'type must be a str or valid type, but got {type(obj_type)}'</span><span class="token punctuation">)</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> obj_cls<span class="token punctuation">(</span><span class="token operator">**</span>args<span class="token punctuation">)</span>    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># Normal TypeError does not print class name.</span>        <span class="token keyword">raise</span> type<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">(</span>f<span class="token string">'{obj_cls.__name__}: {e}'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬è®¨è®ºä¸€ä¸‹è¿™äº›ä»£ç ï¼š</p><ul><li><p>å®é™…ä¸Šä»£ç å¤§å¤šæ•°ç¯‡å¹…ä¹Ÿè¿˜éƒ½æ˜¯æ£€æŸ¥æ˜¯å¦æˆ‘ä»¬çš„è¾“å…¥å˜é‡æ ¼å¼æ­£ç¡®ï¼Œæ­¤å¤–ï¼Œ</p></li><li><p>ç”¨argsæ‹·è´äº†ä¸€ä»½cfgæ–‡ä»¶ï¼Œæ–¹ä¾¿åç»­ä¿®æ”¹</p></li><li><p>å»æ‰äº†typeè¿™ä¸€é¡¹ï¼ŒåŒæ—¶å€¼ä¿ç•™åˆ°äº†obj_typeå˜é‡ä¸­</p></li><li><p>åˆ¤æ–­æ˜¯å¦obj_typeçš„ç±»å‹ï¼Œå¦‚æœæ˜¯strï¼ˆCocoDatasetå°±æ˜¯è¿™ä¸ªç±»å‹ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è°ƒç”¨ä¸Šé¢å‚æ•°ä¸­çš„registryè¿™ä¸ªç±»å®ä¾‹çš„getå‡½æ•°ï¼Œè¿™ä¸ªå®ä¾‹æ”¾åˆ°æˆ‘ä»¬CocoDatasetè¿™ä¸ªä¾‹å­ä¸Šå®é™…ä¸Šå°±æ˜¯æˆ‘ä»¬çš„åˆšæ‰è¯´çš„DATASET</p></li><li><p>getå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªå¯¹åº”çš„ç±»ï¼Œç„¶åæŠŠè¿™ä¸ªè¿”å›å€¼èµ‹ç»™ä¸€ä¸ªæ–°å˜é‡obj_clsï¼Œåœ¨æˆ‘ä»¬è¿™ä¸ªä¾‹å­é‡Œåº”è¯¥æ˜¯è¿”å›äº†å®ƒè‡ªå·±è¿™ä¸ªç±»ã€‚</p></li><li><p>æ¥ç€æ£€æŸ¥ä¸€ä¸‹obj_clsè¿™ä¸ªç±»æœ‰æ²¡æœ‰ä»€ä¹ˆé—®é¢˜</p></li><li><p>æ²¡æœ‰å¼‚å¸¸æˆ–å…¶ä»–é—®é¢˜çš„è¯å‡½æ•°ä¼šè¿”å›obj_cls(**args)ï¼Œ å°±æ˜¯ç›¸å½“äºæ„é€ çš„ä¸€ä¸ªnn.Moduleå˜›  (<del>å¸Œæœ›è¯»è€…ä½ è¿˜èƒ½è®°å¾—**argsæ˜¯å¹²å˜›çš„</del>)</p></li><li><p>æ€»çš„åœ¨æˆ‘ä»¬ç›®å‰çš„ä¾‹å­çœ‹æ¥ï¼Œå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªDATASET(**cfg).åˆ°æ­¤ä¸ºæ­¢ï¼Œç›®å‰è¯´å®è¯ä¸çŸ¥é“DATASET(**cfg)æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ï¼Œä¸ºä»€ä¹ˆè¿˜èƒ½è¿™ä¹ˆç”¨ï¼Œæš‚æ—¶å…ˆæ”¾ç€å§ã€‚æˆ–è®¸å°±åº”è¯¥åƒå®ƒæ³¨é‡Šé‡Œé¢è¯´è¿‡çš„é‚£æ ·è¦ä»å®˜ç½‘ä¸Šçœ‹é«˜çº§ç”¨æ³•ï¼š  </p><blockquote><p> Please refer to <a href="https://mmcv.readthedocs.io/en/latest/understand_mmcv/registry.html" target="_blank" rel="noopener">https://mmcv.readthedocs.io/en/latest/understand_mmcv/registry.html</a> for advanced usage.</p></blockquote></li></ul><p><strong>2021. 10.19æ›´æ–°ï¼šè¿™æ–¹é¢æ€ä¹ˆåŠ è½½çš„æ•°æ®å®é™…ä¸Šè¿˜æ˜¯å¾ˆæœ‰å€¼å¾—æ¢è®¨çš„åœ°æ–¹çš„ï¼Œéœ€è¦è¯¦ç»†çœ‹çœ‹å®˜æ–¹æ–‡æ¡£å’Œæˆ‘ä»¬çš„æºç ï¼Œå…¶ä¸­æºç éƒ¨åˆ†æ³¨æ„ä¸€äº›é«˜çº§çš„è¯­æ³•ç³–çš„åº”ç”¨ã€‚</strong></p><h2 id="workflow"><a href="#workflow" class="headerlink" title="workflow"></a>workflow</h2><pre class="line-numbers language-python"><code class="language-python">    <span class="token keyword">if</span> len<span class="token punctuation">(</span>cfg<span class="token punctuation">.</span>workflow<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>        val_dataset <span class="token operator">=</span> copy<span class="token punctuation">.</span>deepcopy<span class="token punctuation">(</span>cfg<span class="token punctuation">.</span>data<span class="token punctuation">.</span>val<span class="token punctuation">)</span>        val_dataset<span class="token punctuation">.</span>pipeline <span class="token operator">=</span> cfg<span class="token punctuation">.</span>data<span class="token punctuation">.</span>train<span class="token punctuation">.</span>pipeline        datasets<span class="token punctuation">.</span>append<span class="token punctuation">(</span>build_dataset<span class="token punctuation">(</span>val_dataset<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å…³äºè¿™ä¸ªworkflowï¼Œå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªæœ‰æ²¡æœ‰val_datasetçš„é—®é¢˜ã€‚ç›¸å½“äºå¯¹äºéªŒè¯é›†ï¼Œå¯¹äºæ¨¡å‹çš„è¯„ä¼°ä¹Ÿè¿›è¡Œç›¸å…³çš„å·¥ä½œï¼Œç”±äºæ¨¡å‹è¯„ä¼°å’Œè®­ç»ƒæ˜¯ä¸ä¸€æ ·çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¦å¤–å¼€äº†ä¸€ä¸ªworkflowï¼Œç„¶åpipelineã€æ•°æ®é›†ç­‰ç­‰éƒ½é‡æ–°æ•´ç†ä¸€ä¸‹ã€‚</p><h2 id="checkpoint-config"><a href="#checkpoint-config" class="headerlink" title="checkpoint_config"></a>checkpoint_config</h2><pre class="line-numbers language-python"><code class="language-python">    <span class="token keyword">if</span> cfg<span class="token punctuation">.</span>checkpoint_config <span class="token keyword">is</span> <span class="token operator">not</span> None<span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># save mmdet version, config file content and class names in</span>        <span class="token comment" spellcheck="true"># checkpoints as meta data</span>        cfg<span class="token punctuation">.</span>checkpoint_config<span class="token punctuation">.</span>meta <span class="token operator">=</span> dict<span class="token punctuation">(</span>            mmdet_version<span class="token operator">=</span>__version__ <span class="token operator">+</span> get_git_hash<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            CLASSES<span class="token operator">=</span>datasets<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>CLASSES<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="train-detector"><a href="#train-detector" class="headerlink" title="train_detector"></a>train_detector</h2><pre class="line-numbers language-python"><code class="language-python">    <span class="token comment" spellcheck="true"># add an attribute for visualization convenience</span>    model<span class="token punctuation">.</span>CLASSES <span class="token operator">=</span> datasets<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>CLASSES    train_detector<span class="token punctuation">(</span>        model<span class="token punctuation">,</span>        datasets<span class="token punctuation">,</span>        cfg<span class="token punctuation">,</span>        distributed<span class="token operator">=</span>distributed<span class="token punctuation">,</span>        validate<span class="token operator">=</span><span class="token punctuation">(</span><span class="token operator">not</span> args<span class="token punctuation">.</span>no_validate<span class="token punctuation">)</span><span class="token punctuation">,</span>        timestamp<span class="token operator">=</span>timestamp<span class="token punctuation">,</span>        meta<span class="token operator">=</span>meta<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¼€å§‹è®­ç»ƒï¼Œè¿™æ–¹é¢çš„ä»£ç è§£æå€¼å¾—å¦å¼€ä¸€ä¸ªBlog,ä»Šå¤©å…ˆä¸è®²äº†ï¼Œä¸è¿‡è¯»åˆ°è¿™é‡Œçš„ä½ å·²ç»éå¸¸è¾›è‹¦äº†ï¼Œæ„Ÿè°¢é˜…è¯»ğŸ˜ã€‚</p><p>æœ€åä»¥ä¸€ä¸ªä»¤äººæ„‰æ‚¦çš„ä»£ç ç»“å°¾ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>THANK YOU!</p>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mmdetection </tag>
            
            <tag> pytorch </tag>
            
            <tag> æºç é˜…è¯» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Self Attention Is All My Need</title>
      <link href="/2021/10/13/self-attention-is-all-my-need/"/>
      <url>/2021/10/13/self-attention-is-all-my-need/</url>
      
        <content type="html"><![CDATA[<h1 id="Self-Attention"><a href="#Self-Attention" class="headerlink" title="Self Attention"></a>Self Attention</h1><h2 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h2><blockquote><p> ä¹…é—»transformerçš„å¤§åï¼Œå¬advå¤§ä½¬ç‹æ€¡å½¬å½¬å“¥çš„å»ºè®®çœ‹äº†çœ‹å°å¤§æå®æ¯…çš„è§†é¢‘å…³äºSelf Attentionå’ŒTransformerçš„<a href="https://www.bilibili.com/video/BV1Wv411h7kN?p=23" target="_blank" rel="noopener">è§†é¢‘</a>ï¼Œç¡®å®è®²çš„éå¸¸é€šä¿—æ˜“æ‡‚ï¼Œ<del>ä¸è¿‡å°æ¹¾æ™®é€šè¯ç¡®å®å¥½æœºè½¦è¯¶</del>ï¼è¿™é‡Œæ˜¯ä¸€äº›ç›¸å…³çš„ç¬”è®°ã€‚</p></blockquote><p>é¦–å…ˆè¿˜æ˜¯ç›¸å…³çš„ç¼–ç é—®é¢˜ï¼Œé™¤äº†æˆ‘ä»¬é€šå¸¸çš„One-hotç¼–ç å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹ä¸€äº›å…¶ä»–ç¼–ç æ–¹å¼æ¯”å¦‚æåˆ°çš„Word Embeddingï¼ŒOne-hotçš„åŠ£åŠ¿å°±åœ¨äºå…¶ç¼–ç çš„æ¯”å¦‚è¯´è¯æ±‡å°±é»˜è®¤æ˜¯ç›¸äº’æ²¡æœ‰å…³ç³»çš„ï¼Œè¿™æ˜¾ç„¶ä¸ç¬¦åˆå¸¸è¯†ï¼Œæˆ‘ä»¬åº”è¯¥é‡æ–°å¼„ä¸€ä¸ªç¼–ç æ¥ä½¿æˆ‘ä»¬çš„è¯æ±‡ä¹‹é—´çš„å…³ç³»ï¼Œè‡³å°‘ç›¸å…³æ€§æ¯”è¾ƒå¼ºçš„èƒ½å¤Ÿè¢«ä½“ç°å‡ºæ¥ã€‚è¿™å°±æ˜¯Word Embedding(è¯åµŒå…¥)ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016234141.png" alt></p><p>è¿™é‡Œä¹Ÿä¸ä¼šè¯¦ç»†å±•å¼€è¯´ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹è¿™ä¸ªè§†é¢‘æ¥è¿›è¡Œç›¸å…³çš„å­¦ä¹ ï¼š<a href="https://youtu.be/X7PH3NuYW0Q" target="_blank" rel="noopener">https://youtu.be/X7PH3NuYW0Q</a>  (in Mandarin)</p><p>è¿™æ ·æˆ‘ä»¬çš„å¥å­ç»è¿‡Word Embeddingåå¾—åˆ°çš„å¯èƒ½å°±æ˜¯ä¸€æ’é•¿çŸ­ä¸ä¸€çš„å‘é‡ã€‚</p><p>æˆ‘ä»¬ç»è¿‡ç»è¿‡è¿™äº›å¤§å°ä¸å›ºå®šçš„è¾“å…¥çŸ©é˜µä¼šå¾—åˆ°è¾“å‡ºï¼Œè¾“å‡ºä¸€èˆ¬å¯ä»¥åˆ†ä¸º3ç§ï¼š</p><h3 id="First-Input"><a href="#First-Input" class="headerlink" title="First Input"></a>First Input</h3><ul><li>è¾“å‡ºæ¯ä¸€ä¸ªlabelå¯¹åº”è¾“å…¥çš„æ¯ä¸€ä¸ªå‘é‡ï¼Œè¾“å…¥4ä¸ªå‘é‡ï¼Œå°±è¾“å‡º4ä¸ªç›¸åº”çš„labelï¼š</li><li><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016234148.png" alt><ul><li>ä¸¾ä¸ªä½¿ç”¨çš„ä¾‹å­ï¼Œè¯æ€§æ ‡æ³¨ï¼Œæˆ‘ä»¬è¦å¯¹è¾“å…¥çš„æ¯ä¸€ä¸ªåè¯éƒ½è¦è¿›è¡Œä¸€ä¸‹ç›¸å…³çš„è¯æ€§æ ‡æ³¨ï¼ˆPOS taggingï¼‰ï¼Œä¾‹å¦‚ä¸‹é¢è¾“å…¥ä¸€ä¸ª<code>I saw a saw</code> , ç¬¬ä¸€ä¸ªæ˜¯åè¯ï¼Œç¬¬äºŒä¸ªæ˜¯åŠ¨è¯ï¼Œç¬¬ä¸‰ä¸ªæ˜¯å‰¯è¯ï¼Œç¬¬å››ä¸ªæ˜¯åè¯ï¼Œæ¯ä¸€ä¸ªè¯éƒ½è¦æ ‡æ³¨ä¸€ä¸‹è¯æ€§ã€‚æ³¨æ„è¿™å¹¶ä¸æ˜¯ä»¶å¾ˆç®€å•çš„äº‹æƒ…ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦æ ¹æ®è¯­å¢ƒï¼Œæ¯”å¦‚è¯´æ‰€ç»™çš„ç¬¬ä¸€ä¸ª<code>saw</code>å°±æ˜¯åŠ¨è¯ï¼Œç¬¬äºŒä¸ª<code>saw</code>å°±æ˜¯åè¯ã€‚</li><li><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016234152.png" alt></li></ul></li></ul><p>æ¥ä¸‹æ¥çœ‹æˆ‘ä»¬ç¬¬äºŒç§è¾“å‡º</p><h3 id="Second-Input"><a href="#Second-Input" class="headerlink" title="Second Input"></a>Second Input</h3><p>æ¯ä¸€ä¸²è¾“å…¥éƒ½åªæœ‰ä¸€ä¸ªlabelè¾“å‡ºã€‚ä¹Ÿå°±æ˜¯æ•´ä¸ªè¾“å…¥çš„Sequenceéƒ½åªæœ‰ä¸€ä¸ªlabelã€‚ä¸€ä¸ªå¸¸è§çš„ä¾‹å­å°±æ˜¯æˆ‘ä»¬çš„Sentiment Analysisï¼ˆæƒ…æ„Ÿåˆ†æï¼‰ï¼Œåˆ¤æ–­è¾“å…¥æ–‡å­—çš„å¥½åï¼Œæ¯”å¦‚è¯´AIÎ çš„äºšé©¬é€Šç¾é£Ÿè¯„è®ºç­‰ç­‰ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016234157.png" alt></p><h3 id="Third-Input"><a href="#Third-Input" class="headerlink" title="Third Input"></a>Third Input</h3><p>ç¬¬ä¸‰ç§è¾“å‡ºå°±æ˜¯æˆ‘ä»¬çš„æ¨¡å‹è‡ªå·±å†³å®šè¾“å‡ºçš„æ•°é‡ã€‚è¿™ç§å°±æ˜¯æˆ‘ä»¬ç†ŸçŸ¥çš„<strong>Seq2Seq</strong>æ¨¡å‹ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016234201.png" alt></p><p>ä¾‹å­æ¯”å¦‚è¯´æœºå™¨ç¿»è¯‘ã€‚</p><p>ç”±äºæ—¶é—´æœ‰é™ï¼Œè§†é¢‘ä»¥ç¬¬ä¸€ä¸ªç±»å‹ä¸ºä¾‹æ¥ä»‹ç»æˆ‘ä»¬çš„æ³¨æ„åŠ›æœºåˆ¶ã€‚</p><h2 id="Sequence-Labeling"><a href="#Sequence-Labeling" class="headerlink" title="Sequence Labeling"></a>Sequence Labeling</h2><p>æˆ‘ä»¬è¿™ç§è¾“å…¥è¾“å‡ºä¸€æ ·çš„æƒ…å†µå°±å«åšSequence Labelingã€‚æˆ‘ä»¬éœ€è¦ç»™Sequenceä¸­çš„æ¯ä¸€ä¸ªå‘é‡éƒ½è¿›è¡Œä¸€ä¸ªlabelingã€‚</p><p>æˆ‘ä»¬æœ€ç›´è§‰çš„å†™æ³•å°±æ˜¯Sequenceæ¯ä¸€ä¸ªvectoréƒ½ä¸¢è¿›ä¸€ä¸ªFCå…¨è¿æ¥å±‚ï¼Œæˆ‘ä»¬æ¯ä¸€ä¸ªVectoréƒ½å¾—åˆ°äº†è¾“å‡ºï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°äº†æˆ‘ä»¬æƒ³è¦çš„ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016234208.png" alt></p><p>ä½†æ˜¯è¿™ä¹ˆç®€å•ç²—ç³™çš„æ–¹æ³•æ˜¾ç„¶æœ‰éå¸¸å¤§çš„ç‘•ç–µï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚æœæ˜¯æœºå™¨å­¦ä¹ çš„POS Taggingè¯æ€§æ ‡æ³¨çš„æ—¶å€™å°±ä¼šå‡ºç°éå¸¸å¤§çš„é—®é¢˜ï¼šç¬¬ä¸€ä¸ªå‡ºç°çš„<code>saw</code>å’Œæˆ‘ä»¬ç¬¬äºŒä¸ª<code>saw</code>è¯è¾“å…¥å®Œå…¨ä¸€æ ·ä½†æ˜¯æˆ‘ä»¬çš„æƒ³è¦çš„labelå´ä¸ä¸€æ ·ï¼Œä¹Ÿå°±æ˜¯ä¸Šä¸‹æ–‡çš„å› ç´ è¢«å¿½ç•¥äº†ï¼Œè¿™æ˜¾ç„¶æ˜¯æˆ‘ä»¬æ— æ³•æ¥å—çš„ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å°±è¦åŠªåŠ›è®©è¿™ä¸ªFully-Connected Networkè€ƒè™‘åˆ°è¿™äº›ä¸Šä¸‹æ–‡contextçš„é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬æ€ä¹ˆåšå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥è€ƒè™‘å°±å°†æˆ‘ä»¬çš„å…ˆåå‘é‡éƒ½æ”¾è¿›å»ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016234214.png" alt></p><p>å°±ç±»ä¼¼äºé€‰ä¸€ä¸ªwindowï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å°±é€‰æ‹©è¿™ä¸€ä¸ªwindowçš„éƒ½è¾“å…¥ç„¶åæ¥é¢„æµ‹è¿™ä¸ªvectorçš„labelã€‚</p><p>æˆ‘ä»¬è¿™æ ·ç¡®å®å¯ä»¥è§£å†³è®¸å¤šé—®é¢˜ï¼Œä½†æ˜¯è¿™åªæ˜¯ä¸€å®šç¨‹åº¦ä¸Šè€ƒè™‘äº†å‰åæ–‡ï¼Œè€ƒè™‘äº†å…ˆåå‡ ä¸ªcontextçš„å½±å“ã€‚</p><p>å¦‚æœæˆ‘ä»¬ç°åœ¨æœ‰è¿™ä¹ˆä¸€ä¸ªworkï¼Œéœ€è¦æˆ‘ä»¬è€ƒè™‘æ•´ä¸ªsequenceæ‰å¯ä»¥è§£å†³ã€‚é‚£æˆ‘ä»¬å°±æ²¡æœ‰åŠæ³•è¿™ä¹ˆåšäº†ã€‚å› ä¸ºå¦‚æœæˆ‘ä»¬ä¹Ÿè¿™ä¹ˆåšï¼Œæ•…æŠ€é‡æ–½ï¼Œæˆ‘ä»¬å¯èƒ½è¦å¼€ä¸€ä¸ªSequenceé‚£ä¹ˆé•¿çš„windowæ‰å¯ä»¥å°†æˆ‘ä»¬çš„sequenceç›–ä½ã€‚ä½†æ˜¯å¦‚æœæ˜¯ä¸€ä¸ªå¾ˆå¤§çš„è®­ç»ƒé›†çš„è¯ï¼Œæˆ‘ä»¬å°±éœ€è¦æ‰¾æˆ‘ä»¬çš„æ•´ä¸ªè®­ç»ƒé›†ï¼Œæ‰¾åˆ°æˆ‘ä»¬æœ€é•¿çš„sequenceæ¥å¼€windowï¼Œå¼€å®Œä¹‹åæˆ‘ä»¬å†è¿›è¡Œæˆ‘ä»¬çš„è®­ç»ƒï¼Œè¿™ä¹ˆä¸€æ¥æˆ‘ä»¬çš„Fully-Connected NNå°±ä¼šå¾ˆåºå¤§ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“è¿‡æ‹Ÿåˆã€‚</p><p>æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ›´åŠ ç²¾ç¡®çš„æ–¹æ³•æ¥èƒ½è€ƒè™‘æˆ‘ä»¬è¿™ä¸ªæ•´ä¸ªsequenceçš„æœºåˆ¶ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å°±è¦è€ƒè™‘Self-Attentionè¿™ä¸ªæœºåˆ¶äº†ã€‚</p><h2 id="Self-Attentionæœºåˆ¶"><a href="#Self-Attentionæœºåˆ¶" class="headerlink" title="Self-Attentionæœºåˆ¶"></a>Self-Attentionæœºåˆ¶</h2><p>æˆ‘ä»¬ä¼šå°†æ•´ä¸ªsequenceä¸¢è¿›æˆ‘ä»¬çš„self-attensionæœºåˆ¶ï¼Œç„¶åæˆ‘ä»¬sequenceçš„æ¯ä¸€ä¸ªvectoréƒ½å¯¹åº”å¾—åˆ°äº†ä¸€ä¸ªç»“åˆself-attentionè”ç³»äº†ä¸Šä¸‹æ–‡çš„ä¸€ä¸ªç»“æœï¼Œç„¶åæˆ‘ä»¬å†é€šè¿‡æˆ‘ä»¬çš„Fully-Connected Network.è¿™æ ·ä¸€æ¥æˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ä¸ªè¿™ä¹ˆæ ·ç»“åˆæ•´ä¸ªsequenceçš„ç»“æœã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016234220.png" alt></p><p>å½“ç„¶æˆ‘ä»¬è¿™ä¸ªå¹¶ä¸æ˜¯åªç”¨ä¸€æ¬¡Self-attentionï¼Œæˆ‘ä»¬å¯ä»¥å åŠ å¥½å¤šæ¬¡æ¥è¿›è¡Œç›¸å…³çš„è®­ç»ƒï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016234224.png" alt></p><p>æˆ‘ä»¬çš„Self-attentionç”¨æ¥è€ƒè™‘æ•´ä¸ªsequenceçš„ä¿¡æ¯ï¼Œç„¶åæˆ‘ä»¬çš„FCç”¨æ¥è€ƒè™‘æˆ‘ä»¬çš„æ¯ä¸€ä¸ªvectorå±€éƒ¨çš„ä¿¡æ¯ï¼Œå°±è¿™ä¹ˆå¤šæ¬¡æ•´åˆç„¶åè€ƒè™‘å°±å¯ä»¥å¾—åˆ°æ›´å¤šã€æ›´ç²¾å‡†çš„ç»“æœã€‚æˆ‘ä»¬Self-attentionæœ€çŸ¥åçš„æ–‡ç« å°±æ˜¯æˆ‘ä»¬çš„Attention is all you need.è®ºæ–‡åœ°å€ä¸ºï¼š<a href="https://arxiv.org/abs/1706.03762" target="_blank" rel="noopener">https://arxiv.org/abs/1706.03762</a></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸€çœ‹æœ‰å…³çš„Self-Attensionæ˜¯æ€ä¹ˆè¿ä½œçš„ï¼š</p><h2 id="Self-Attentionè¿ä½œæ–¹å¼"><a href="#Self-Attentionè¿ä½œæ–¹å¼" class="headerlink" title="Self-Attentionè¿ä½œæ–¹å¼"></a>Self-Attentionè¿ä½œæ–¹å¼</h2><p>æˆ‘ä»¬çš„Inputæ˜¯ ä¸€ä¸²vectorï¼Œç”±äºæˆ‘ä»¬å¾—inputå¯èƒ½æ˜¯æˆ‘ä»¬åˆå§‹çš„vectorï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯æˆ‘ä»¬ä¹‹åçš„ç»è¿‡ä¸€æ¬¡å¤„ç†åå¾—åˆ°çš„outputï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œç”¨$a^{1},a^{2},a^{3}$è¿™æ ·æ¥è¡¨ç¤ºï¼ˆ<del>å°æ¹¾çš„ä¸‹æ ‡éƒ½æ ‡åœ¨ä¸Šè¾¹ï¼Œæˆ‘ä»¬å¯èƒ½çœ‹ç€ä¼šæœ‰äº›ä¸ä¹ æƒ¯ã€‚</del>ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016234230.png" alt></p><p>æˆ‘ä»¬inputä¸€æ’$a$åæˆ‘ä»¬ä¼šè¾“å‡ºä¸€æ’$b$:</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016234238.png" alt></p><p>å¯ä»¥çœ‹å‡ºè¿™äº›éƒ½æ˜¯è€ƒè™‘äº†$a^{1},a^{2},a^{3}â€¦â€¦$è¿™äº›æ‰è¿›è¡Œè¾“å‡ºå‡ºæ¥çš„ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¢ç´¢ä¸€ä¸‹æ€ä¹ˆäº§ç”Ÿ$b^{1}$,äº†è§£è¿™ä¸ªåï¼Œå®é™…ä¸Šåé¢çš„$b^{2}â€¦â€¦$éƒ½å¾ˆå¥½ç†è§£äº†ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦æ ¹æ®$a^{1}$æ¥æ‰¾å‡ºè¿™ä¸ªsequenceé‡Œé¢ä¸$a^1$â€‹ç›¸å…³çš„å…¶ä»–å‘é‡ï¼Œæˆ‘ä»¬æ˜¯æƒ³è¦è€ƒè™‘æ•´ä¸ªsequenceä½†æ˜¯æˆ‘ä»¬åŒæ—¶æœ‰ä¸æƒ³å°†æ•´ä¸ªsequenceéƒ½è€ƒè™‘è¿›ä¸€ä¸ªwindowä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°çœŸæ­£ä¸å…¶æœ‰å…³ç³»çš„å‘é‡èµ„è®¯ã€‚</p><p>æ¯ä¸€ä¸ªå‘é‡å’Œ$a^1$çš„å…³è”ç¨‹åº¦æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªæ•°å€¼$\alpha$æ¥è¡¨ç¤ºã€‚å¦å¤–çš„é—®é¢˜å°±æ˜¯æˆ‘ä»¬æ€ä¹ˆå†³å®šä¸¤ä¸ªå‘é‡ï¼ˆæ¯”å¦‚$a^1å’Œa^3$ï¼‰çš„å…³è”æ€§ï¼Œæˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªè®¡ç®—attentionçš„moduleï¼ˆæ¨¡ç»„ï¼‰ã€‚è¿™é‡Œæä¾›ä¸¤ç§æ¨¡ç»„ï¼Œæˆ‘ä»¬å°†å‘é‡è¾“å…¥æ¨¡ç»„ä¸­ï¼Œç„¶åæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªå€¼$\alpha$â€‹â€‹å°±ä½œä¸ºå…³è”ç¨‹åº¦ã€‚â€‹è¿™ä¸ª$\alpha$çš„è®¡ç®—æ–¹æ³•æœ‰å¾ˆå¤šç§ï¼Œæˆ‘ä»¬ä¸¾å‡ºå¸¸è§çš„ä¸¤ç§ã€‚</p><p>ç¬¬ä¸€ç§åšæ³•ï¼š</p><h3 id="Dot-product-ç‚¹ä¹˜ï¼Œå†…ç§¯"><a href="#Dot-product-ç‚¹ä¹˜ï¼Œå†…ç§¯" class="headerlink" title="Dot-product(ç‚¹ä¹˜ï¼Œå†…ç§¯)"></a>Dot-product(ç‚¹ä¹˜ï¼Œå†…ç§¯)</h3><p>æˆ‘ä»¬å°†è¾“å…¥çš„å‘é‡åˆ†åˆ«ä¹˜ä¸Šä¸¤ä¸ªä¸åŒçš„çŸ©é˜µï¼Œç„¶åæˆ‘ä»¬å¾—åˆ°ä¸¤ä¸ªä¸åŒçš„å‘é‡ï¼Œæ¥ç€æˆ‘ä»¬å¯¹è¿™ä¸¤ä¸ªåšç‚¹ä¹˜ï¼Œå°±å¾—åˆ°äº†æˆ‘ä»¬çš„$\alpha$â€‹â€‹.</p><p>å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016234244.png" alt></p><ul><li>é¦–å…ˆä¸¤ä¸ªå‘é‡åˆ†åˆ«ä¹˜ä»¥çŸ©é˜µ$W^q, W^k$â€‹å¾—åˆ°äº†q, kä¸¤ä¸ªçŸ©é˜µ</li><li>q, kåšä¸€ä¸ªç‚¹ä¹˜ï¼Œä¹Ÿå°±æ˜¯å†…ç§¯å¾—åˆ°äº†æˆ‘ä»¬éœ€è¦çš„$\alpha$</li></ul><p>è¿™ä¸ªæ˜¯ç›®å‰æ¥è¯´æœ€å¸¸ç”¨çš„æ–¹æ³•ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬ç”¨åœ¨transformerä¸­çš„æ–¹æ³•ã€‚</p><p>ç¬¬äºŒç§æ–¹æ³•ï¼š</p><h3 id="Additive"><a href="#Additive" class="headerlink" title="Additive"></a>Additive</h3><ul><li>é¦–å…ˆæˆ‘ä»¬åŒæ ·åˆ†åˆ«ä¹˜ä»¥ä¸¤ä¸ªçŸ©é˜µå¾—åˆ°ä¸¤ä¸ªå‘é‡</li><li>ä¸¤ä¸ªå‘é‡ç›¸åŠ tanhè¿™æ ·ä¸€ä¸ªfunction</li><li>ç»è¿‡ä¸€ä¸ªçŸ©é˜µWtransformå¾—åˆ°$\alpha$</li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211014204704.png" alt="image-20211013212226243"></p><p>è¿™åªæ˜¯ä¸¤ç§æ–¹æ³•ä¹‹ä¸€ï¼Œè¿˜æœ‰éå¸¸å¤šç§è®¡ç®—çš„æ–¹æ³•ï¼Œæˆ‘ä»¬ä¸åšå¤šè®²ã€‚</p><h3 id="Self-Attentionçš„æœºç†"><a href="#Self-Attentionçš„æœºç†" class="headerlink" title="Self-Attentionçš„æœºç†"></a>Self-Attentionçš„æœºç†</h3><p>æˆ‘ä»¬æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹æ€ä¹ˆå¥—ç”¨åˆ°self-attentionä¹‹ä¸­ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016234255.png" alt></p><p>å¦‚ä¸Šå›¾ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºæˆ‘ä»¬çš„æ¯ä¸€ä¸ª$a^i$â€‹â€‹éƒ½ä¹˜ä»¥<strong>ç›¸åŒå…±äº«çš„$W^q,W^k$â€‹</strong>åå¾—åˆ°äº†$q^iï¼Œk^i$.è¿™é‡Œqå…¨ç§°ä¸ºquery, kå…¨ç§°ä¸ºkey. æˆ‘ä»¬çš„å…³è”æ€§å°±æ˜¯æ¯ä¸€ä¸ª$a^i$çš„$q^i$å’Œå…¶ä»–çš„æ‰€æœ‰$a^{j}$åšä¸€ä¸ªç‚¹ä¹˜åå¾—åˆ°ä¸€ä¸ª$\alpha^{i, j}$â€‹.è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬çš„attention score. è¿™ä¸ªå°±ç›¸å½“äºæˆ‘ä»¬çš„å…³è”ç³»æ•°ï¼Œå½“ç„¶ä¸ç®—æ˜¯æœ€ç»ˆçš„æ ¼å¼ã€‚</p><p>å¦å¤–æˆ‘ä»¬ä¹Ÿéœ€è¦è®¡ç®—è‡ªå·±å¯¹è‡ªå·±çš„attention scoreï¼ˆè¿™ä¸ªä¸æ˜¯å¯æœ‰å¯æ— çš„ï¼‰ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016234300.png" alt></p><p>æ¥ç€æˆ‘ä»¬å°†æˆ‘ä»¬å¾—åˆ°çš„$\alpha_{1ï¼Œ1â€¦4}$åšä¸€ä¸ªsoftmaxè®¡ç®—ï¼Œæ¥ç€æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ª$\alpha_{1,1â€¦4}^{`}$. </p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016234305.png" alt></p><p>ä¸ºä»€ä¹ˆè¦åšsoftmaxå¤„ç†å‘¢ï¼Ÿæˆ–è€…è¯´ä¸ºä»€ä¹ˆå¿…é¡»æ˜¯softmaxå‘¢ï¼Ÿå®é™…ä¸Šæˆ‘ä»¬ä¸ä¸€å®šéè¦ç”¨softmax,æˆ‘ä»¬ç”šè‡³å¯ä»¥ä½¿ç”¨RELUè¿›è¡Œç›¸å…³çš„å¤„ç†ã€‚</p><p>ç„¶åæˆ‘ä»¬æ¥ä¸‹æ¥ä»¥$a^1$ä¸ºä¾‹ï¼Œå°±å¯¹$a^i$ä¹˜ä»¥ä¸€ä¸ªç›¸åŒçš„å…±äº«çŸ©é˜µ$W^v$åå¾—åˆ°äº†$v^i$ï¼Œç„¶åæˆ‘ä»¬$v^i$å°±ä¹˜ä»¥å¯¹åº”çš„$\alpha_{1, i}^{`}$â€‹ç„¶ååŠ èµ·æ¥å°±å¾—åˆ°æˆ‘ä»¬çš„$b^1$.</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016234311.png" alt></p><p>å¦‚æœæˆ‘ä»¬æŸä¸€ä¸ªçš„attention scoreå€¼è¶Šé«˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ€ç»ˆå¾—åˆ°çš„å€¼å…¶æ‰€å çš„å½±å“å°±è¶Šå¤§ï¼Œè¿™å°±è¾¾åˆ°äº†æˆ‘ä»¬çš„æƒ³è¦æ ¹æ®æ•´ä¸ªsequenceä¸åŒvectorçš„å½±å“æ¥å¾—åˆ°æˆ‘ä»¬çš„ç»“æœçš„ç›®çš„ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹å¦‚ä½•å¯¹æˆ‘ä»¬ä»¥ä¸Šçš„è®¡ç®—è¿›è¡ŒçŸ©é˜µåŒ–ï¼š</p><h3 id="çŸ©é˜µåŒ–"><a href="#çŸ©é˜µåŒ–" class="headerlink" title="çŸ©é˜µåŒ–"></a>çŸ©é˜µåŒ–</h3><p>æˆ‘ä»¬å¯ä»¥ç¨å¾®æ€»ç»“å¹¶ä¸”å¤ä¹ ä¸€ä¸‹æˆ‘ä»¬çš„è¿ç®—è¿‡ç¨‹ï¼š</p><ul><li>é¦–å…ˆè¾“å…¥inputä¸º$a_{i}$â€‹, æˆ‘ä»¬å¯¹äºè¯¥å‘é‡ä¹˜ä»¥$W^q$â€‹å¾—åˆ°$q^i$â€‹</li><li>æ¥ç€æˆ‘ä»¬å°†$a^{1â€¦â€¦4}$ éƒ½ä¹˜ä»¥$W^K$åˆ†åˆ«å¾—åˆ°$k^{1â€¦â€¦4}$</li><li>ç„¶åå¯¹äº$q^i$â€‹å’Œæˆ‘ä»¬çš„$k^{1â€¦4}$â€‹åšä¸€ä¸ªdot productå¾—åˆ°æˆ‘ä»¬çš„åˆæ­¥çš„$\alpha_{i,1â€¦â€¦4}$â€‹â€‹,</li><li>å¯¹äº$\alpha_{i,1â€¦â€¦4}$åšsoftmaxå¾—åˆ°$\alpha_{i,1â€¦â€¦4}^`$.</li><li>æˆ‘ä»¬$a^{1â€¦â€¦4}$ä¹˜ä»¥çŸ©é˜µ$W^v$å¾—åˆ°$v^{1â€¦4}$</li><li>å¯¹æˆ‘ä»¬çš„$\alpha_{i,1â€¦â€¦4}^`$å’Œ$v^{1â€¦4}$åšä¸€ä¸ªä¹˜æ³•ï¼ˆå¯ä»¥ç†è§£ä¸ºç‚¹ä¹˜ï¼‰åç›¸åŠ å¾—åˆ°$b^i$ï¼Œä¹Ÿå³æˆ‘ä»¬çš„æœ€ç»ˆçš„outputã€‚</li></ul><p>å¯¹äºæ¯ä¸€ä¸ª$a^i$éƒ½è¿™ä¹ˆæ“ä½œï¼Œæˆ‘ä»¬æœ€åå°±ä¼šå¾—åˆ°æˆ‘ä»¬çš„outputã€‚</p><p>å½“ç„¶ï¼Œä»¥ä¸Šä¸ºæ¯ä¸€ä¸ªï¼Œä½†æ˜¯æˆ‘ä»¬æ³¨æ„åˆ°è¿™äº›å¾ˆå¤šæ“ä½œæ—¢ç„¶éƒ½æ˜¯ä¸€æ ·çš„ï¼Œè€Œä¸”æ˜¯åŒæ­¥è¿›è¡Œçš„ï¼Œæˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘å¯¹ä»¥ä¸Šçš„è¿™äº›è¿›è¡ŒçŸ©é˜µåŒ–ï¼Œè¿™æ ·æœ‰åŠ©äºæé«˜æˆ‘ä»¬çš„è¿ç®—é€Ÿåº¦ï¼Œæå‡æ•ˆç‡ï¼š</p><p>æˆ‘ä»¬çš„$q^i, k^i, v^i$éƒ½æ˜¯å¯ä»¥ä¸€å¼€å§‹ç®—å‡ºæ¥çš„ï¼Œå¯ä»¥ä½¿ç”¨çŸ©é˜µç›´æ¥å¾—åˆ°ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016234321.png" alt></p><p>è€Œæˆ‘ä»¬çš„$\alpha^{i, j}$ä¹Ÿæ˜¯åŒæ ·å¯ä»¥ä½¿ç”¨çŸ©é˜µå¾—åˆ°ï¼Œè™½ç„¶è¯´è¿™ä¸ªä¼¼ä¹æ˜¯é å†…ç§¯æ¥å¾—åˆ°çš„ï¼Œä½†æ˜¯è¿™ä¸ªåŒæ ·ä¹Ÿæ˜¯å¯ä»¥çŸ©é˜µåŒ–çš„ï¼Œå› ä¸ºä¸¤ä¸ªå‘é‡çš„å†…ç§¯å®é™…ä¸Šå°±æ˜¯æˆ‘ä»¬çš„ä¸€ä¸ªå‘é‡è¿›è¡Œè½¬ç½®åä¹˜ä»¥å¦ä¸€ä¸ªå‘é‡è€Œå·²ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªçŸ©é˜µä¹˜æ³•å¾—åˆ°æ‰€æœ‰çš„$\alpha^{i, j}$â€‹ï¼Œè€Œåä»…ä»…å¯¹å¾—åˆ°çš„ç»“æœmatrixæ¯ä¸€ä¸ªcolumnç»è¿‡softmaxè®©æ¯ä¸€ä¸ªcolumnå¾—åˆ°ç»“æœçš„å’Œä¸º1å°±OKäº†ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211014203104.png" alt></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬çš„$b^i$çš„å¾—åˆ°ä¹Ÿæ˜¯å¾ˆç±»ä¼¼çš„ï¼Œå°±æ˜¯$\alpha^{`}_{i, 1â€¦â€¦4}$ä¹˜ä»¥æˆ‘ä»¬çš„$v^{1â€¦4}$å°±å¯ä»¥ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211014203525.png" alt></p><p>æœ€åå¯ä»¥æ€»ç»“ä¸€ä¸‹ï¼Œæˆ‘ä»¬çš„ä»Iåˆ°Oï¼ˆinputâ€”â€”&gt;outputï¼‰çš„è¿‡ç¨‹å°±æ˜¯è¿™æ ·ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211014203845.png" alt></p><p>å®é™…ä¸Šç½‘ç»œå°±éœ€è¦å­¦ä¹ çš„å‚æ•°ä¹Ÿå°±æ˜¯$W^q, W^K, W^V$è¿™äº›å‚æ•°ã€‚</p><h2 id="Multi-head-Self-attention"><a href="#Multi-head-Self-attention" class="headerlink" title="Multi-head Self-attention"></a>Multi-head Self-attention</h2><p>æ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹è¿›é˜¶çš„ç‰ˆæœ¬. å¤šå¤´æœºåˆ¶ã€‚ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦å¾ˆå¤šä¸ªheadå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆç†è§£ï¼Œæˆ‘ä»¬ä¸åªæœ‰ä¸€ç§çš„ç›¸å…³æ€§éœ€è¦è€ƒè™‘ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è€ƒè™‘å¤šç§ä¸åŒçš„ç›¸å…³æ€§æ¥è¿›è¡Œç»¼åˆæ¥çœ‹ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ€å¥½è¿›è¡Œä¸€ä¸ªå¤šå¤´æ“ä½œï¼Œä¸åŒçš„qæ¥è€ƒè™‘ä¸åŒç§ç±»çš„ç›¸å…³æ€§è¿™ç§ã€‚</p><p>æˆ‘ä»¬å¯ä»¥è¿›è¡Œå¤šä¸ªqçš„è®¡ç®—ï¼Œè¿™ä¹ˆä¸€æ¥æˆ‘ä»¬åŒæ ·ä¹Ÿè¦æœ‰åŒæ ·çš„å¤šä¸ªk,å¤šä¸ªvï¼Œåªä¸è¿‡æˆ‘ä»¬ä¹‹åè®¡ç®—çš„æ—¶å€™æ˜¯åˆ†å¼€çš„ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211014210101.png" alt></p><p>ä¹‹åçš„è®¡ç®—åˆ°æœ€åæˆ‘ä»¬æ‰å°†æˆ‘ä»¬åˆ†åˆ«è®¡ç®—å‡ºæ¥çš„å¤šä¸ªbç»„åˆèµ·æ¥é€šè¿‡ä¹˜ä»¥ä¸€ä¸ªçŸ©é˜µæ¥å¾—åˆ°æœ€ç»ˆçš„bå†é€åˆ°æˆ‘ä»¬çš„è¾“å‡ºä¸Šå»ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211014210115.png" alt></p><p>å½“ç„¶æˆ‘ä»¬å¯èƒ½éœ€è¦ä¸åŒçš„headæ¥è¿›è¡Œè°ƒæ•´ï¼ˆä»¥ä¸Šæ˜¯ç”¨ä¸¤ä¸ªheadä½œä¸ºä¾‹å­ï¼‰ï¼Œè¿™ä¸ªæ•°é‡ä¹Ÿæ˜¯ä¸€ä¸ªéœ€è¦æˆ‘ä»¬æ¥è°ƒçš„hyperparameterã€‚</p><h2 id="æˆ‘ä»¬é—æ¼äº†ä»€ä¹ˆï¼Ÿ"><a href="#æˆ‘ä»¬é—æ¼äº†ä»€ä¹ˆï¼Ÿ" class="headerlink" title="æˆ‘ä»¬é—æ¼äº†ä»€ä¹ˆï¼Ÿ"></a>æˆ‘ä»¬é—æ¼äº†ä»€ä¹ˆï¼Ÿ</h2><p>æˆ‘ä»¬å‘ç°æˆ‘ä»¬ä¼¼ä¹æ²¡æœ‰è€ƒè™‘åˆ°å„ä¸ªvectorçš„ä½ç½®èµ„è®¯ï¼Ÿå› ä¸ºæˆ‘ä»¬æƒ³ï¼Œæˆ‘ä»¬ä¸ç®¡æ˜¯ç›¸å…³æ€§çš„è®¡ç®—ï¼Œè¿˜æ˜¯attention scoreçš„è®¡ç®—ï¼Œè¿˜æ˜¯æœ€ç»ˆçš„åŠ æƒï¼Œä¼¼ä¹æ¯ä¸€ä¸ªvectorï¼Œæˆ–è€…è¯´æ¯ä¸€ä¸ªinputçš„ç›¸å¯¹ä½ç½®å…³ç³»ä¼¼ä¹éƒ½æ²¡æœ‰è¢«ç”¨ä¸Šï¼Œè¿™å¯æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„é—®é¢˜ã€‚</p><p>è€Œæˆ‘ä»¬æ€ä¹ˆè¿›è¡Œä½ç½®çš„é“¾æ¥å‘¢ï¼Ÿå®é™…ä¸Šè¿™é‡Œæå®æ¯…è€å¸ˆæ²¡æœ‰å¤šè¯´ï¼Œä½†æ˜¯æˆ‘ä¹‹å‰æ˜¯å­¦äº†çš„ï¼ŒçœŸæ˜¯å°±å­¦äº†ä½ç½®ç¼–ç ï¼ŒçœŸæ˜¯å¤ªæ­£å¥½äº†ï¼ï¼</p><p>æˆ‘ç›´æ¥å°†å½“æ—¶çš„ç¬”è®°å¤åˆ¶ç²˜è´´åœ¨è¿™é‡Œå°±OKï¼š</p><blockquote><h4 id="ä½ç½®ç¼–ç "><a href="#ä½ç½®ç¼–ç " class="headerlink" title="ä½ç½®ç¼–ç "></a>ä½ç½®ç¼–ç </h4><p>æˆ‘ä»¬å…ˆè¯´ä¸€ä¸‹ä¸ºä»€ä¹ˆè¦è¿›è¡Œç›¸å…³çš„ä½ç½®ç¼–ç ï¼Œé‚£ä¹ˆå°±å…ˆè¯´è¯´RNNï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016234341.png" alt></p><p>å¾ˆå¤šäººå­¦ä¹ æœ‰å…³çš„RNNæ—¶æ²¡æœ‰å­¦å¥½(è™½ç„¶æˆ‘è¿˜æ²¡å¼€å§‹å­¦)ï¼Œ<strong>å°±æ˜¯æˆ‘ä»¬çš„å•å±‚ä¸‹æ˜¯ä¸€å¥—å‚æ•°</strong>ï¼Œæ¯ä¸€ä¸ªtime stepæ—¶é—´æ­¥é•¿åœ¨æ›´æ–°å‚æ•°æ—¶æ˜¯åŒæ—¶è¿›è¡Œçš„ã€‚æˆ‘ä»¬çš„å‚æ•°Uï¼ŒWï¼ŒVï¼ˆçœ‹å›¾å·¦ï¼‰ ã€‚ä¸ºäº†æ›´å¥½ç†è§£ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§æ—¶é—´çº¿å±•å¼€ï¼ˆçœ‹å›¾å³ï¼‰ï¼š</p><p>æˆ‘ä»¬çš„è¾“å…¥æ˜¯$x_{t-1}, x_{t}, x_{t+1}$,è¿™äº›å‚æ•°ï¼Œè€Œæˆ‘ä»¬çš„å±‚å‚æ•°å§‹ç»ˆæ˜¯Uï¼ŒWï¼Œ Vã€‚è¿™ä¸ªæ˜¯å…±äº«çš„ï¼ç„¶åè¿›ä¸€æ­¥å¾—åˆ°è¾“å‡ºã€‚</p><p>å¦å¤–ï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„ä¸€ç‚¹çš„æ˜¯ï¼Œæˆ‘ä»¬çš„RNNçš„æ¢¯åº¦æ¶ˆå¤±å’Œæ™®é€šçš„æ¢¯åº¦æ¶ˆå¤±è¿˜æ˜¯æœ‰å¾ˆå¤§å·®åˆ«çš„ã€‚æ™®é€šçš„æ¢¯åº¦æ¶ˆå¤±æ˜¯å› ä¸ºæˆ‘ä»¬çš„æ¢¯åº¦é™ä¸º0äº†ã€‚è€Œæˆ‘ä»¬RNNçš„æ¢¯åº¦æ¶ˆå¤±æ˜¯å› ä¸ºRNNæ˜¯ä¸€ä¸ªæ€»çš„æ¢¯åº¦ï¼Œè€Œæ€»æ¢¯åº¦è¢«è¿‘è·ç¦»æ¢¯åº¦ä¸»å¯¼ï¼Œè€Œè¿œè·ç¦»æ¢¯åº¦è¢«å¿½ç•¥ä¸è®¡ã€‚</p><p>åŒæ—¶æˆ‘ä»¬éœ€è¦æ³¨æ„ä¸€ç‚¹å°±æ˜¯æˆ‘ä»¬çš„RNNæ˜¯æœ‰ç€å¤©ç„¶çš„æ—¶åºå…³ç³»çš„ï¼Œå› ä¸ºæˆ‘ä»¬çš„è¿™ä¸ªç½‘ç»œå¿…é¡»æ˜¯å…ˆå¤„ç†å®Œ$x_{t-1}$å†å¤„ç†$x_{t}, x_{t+1}$è¿™äº›ã€‚</p><p>ä½†æ˜¯æˆ‘ä»¬çš„transformerå°±ä¸ä¸€æ ·äº†ï¼Œä»–åŠ äº†ä¸ªå¤šå¤´æ³¨æ„åŠ›æœºåˆ¶ï¼Œ<strong>ä»–æ˜¯æœ‰å¹¶è¡ŒåŒ–çš„ï¼</strong>ä¸æ˜¯ä¸€ä¸ªä¸€ä¸ªå¤„ç†çš„ï¼æ‰€ä»¥æˆ‘ä»¬çš„Transformerç¡®å®æ›´å¿«ï¼Œä½†æ˜¯ä¹Ÿå¿½ç•¥äº†ä¸€äº›é¡ºåºå…³ç³»ï¼Œè°åœ¨å‰é¢ï¼Œè°åœ¨åé¢è¿™äº›ä¸œè¥¿æ²¡æœ‰å¾ˆæ˜ç¡®çš„å®šä¹‰è¯´æ˜ã€‚</p><blockquote><p>è¯´å¤šäº†ï¼Œæˆ‘ä»¬è¿˜æ˜¯å›åˆ°ä½ç½®ç¼–ç å§ã€‚</p></blockquote><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä½ç½®ç¼–ç çš„å…¬å¼ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016234350.png" alt></p><p>è¿™ä¸ªå…¬å¼æˆ‘çœ‹äº†å¥½å¤šéUPä¸»è®²è§†é¢‘çš„é‚£ä¸ªç‰‡æ®µï¼è¶³è¶³æœ‰7éï¼Œæœ€åç»ˆäºå¼„æ‡‚äº†ï¼Œçœ‹æ¥æ²¡æ¥è§¦è¿‡NLPçš„ä»CVè¿‡æ¥çš„æ²¡çœ‹è¿‡RNNçš„äººä¹Ÿèƒ½ç†è§£Transformerçš„è¿™æ–¹é¢ã€‚</p><blockquote><p><a href="https://www.bilibili.com/video/BV1Di4y1c7Zm?p=2" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1Di4y1c7Zm?p=2</a></p></blockquote><p>æˆ‘ä»¬æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹è¯¦ç»†çœ‹ä¸€ä¸‹è¿™ä¸ªå…¬å¼çš„çŸ¥è¯†ã€‚</p><p>æˆ‘ä»¬è¿˜æ˜¯å…ˆçœ‹ä¸Šé¢ä½ç½®ç¼–ç çš„å…¬å¼ï¼š</p><ul><li>é¦–å…ˆposæŒ‡çš„æ˜¯æˆ‘ä»¬çš„è¯å‘é‡çš„ä½ç½®ï¼Œæ¯”å¦‚è¯´â€œçˆ±â€è¿™ä¸ªå­—å°±æ˜¯pos=2</li><li>2i, 2i+1æŒ‡ä»£çš„å°±æ˜¯å¥‡æ•°ä½ï¼Œå¶æ•°ä½çš„ä¸ä¸€æ ·ï¼Œå¥‡æ•°ä½åˆ©ç”¨çš„æ˜¯cosï¼Œè€Œå¶æ•°ä½åˆ©ç”¨çš„æ˜¯æ­£å¦‚ä½ç½®ç¼–ç ç»´åº¦é‚£é‡Œæ‰€è¡¨ç¤ºçš„é‚£æ ·ã€‚</li></ul><p>è¿™æ–¹é¢ç¼–ç å¥½ä¹‹åï¼Œæˆ‘ä»¬å°±ä¼šå’Œã€‚ä¹‹å‰Embeddingå¾—åˆ°çš„å‘é‡è¿›è¡Œç›¸å…³çš„åŠ å’Œï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016234417.png" alt></p><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œå°±æ˜¯æˆ‘ä»¬çš„ç›¸å…³çš„ä¸ºä½ç½®ç¼–ç å’Œä¹‹å‰çš„åŠ å’Œã€‚</p><p>å¦å¤–æˆ‘ä»¬è¿™é‡Œä¹Ÿå¯ä»¥å±•å¼€è®²ä¸€ä¸‹ä¸ºä»€ä¹ˆæ˜¯sinå’Œcosï¼Œä»¥åŠä¸ºä»€ä¹ˆæ˜¯è¿™æ ·çš„ä½ç½®ç¼–ç æœºåˆ¶ï¼Œèƒ½å¤Ÿæƒ³å‡ºè¿™æ ·çš„æœºåˆ¶çš„äººå¾—æœ‰å¤šæ·±åšçš„æ•°å­¦åŠŸåº•ï¼</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016234425.png" alt></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å›¾ä¸Šçš„é‚£ä¸¤ä¸ªç›¸å…³çš„å…¬å¼ï¼Œå¯¹äºpos+kä½ç½®çš„å‘é‡æ¥çœ‹æˆ‘ä»¬å°±æœ‰äº†éå¸¸å›ºå®šçš„ä¸€äº›çº¿æ€§ç»„åˆçš„å…³ç³»ï¼Œè¿™å°±å°†ä½ç½®å…³ç³»è”ç³»èµ·æ¥äº†ã€‚ä¸è¿‡å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¹ˆç¼–ç è¿™ç§ç›¸å¯¹ä½ç½®ä¿¡æ¯ä¼šåœ¨æ³¨æ„åŠ›æœºåˆ¶é‚£é‡Œæ¶ˆå¤±ï¼</p></blockquote><p>æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹ä»–ç»™å‡ºçš„ä¸€äº›ç›¸å…³çš„è®ºæ–‡çš„å›¾ç‰‡ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016234436.png" alt></p><p>è¿™ä¸ªæ˜¯ä»…ä»…åœ¨æ¯ä¸€ä¸ªvectorä¸ŠåŠ äº†ä¸ª$e^i$â€‹,ç”¨æ¥æ ‡è¯†ä½ç½®ä¿¡æ¯ï¼Œå®é™…ä¸Šè¿™ä¸ªè¿˜æ˜¯æ²¡æœ‰sinï¼Œ cosï¼ˆSinusoidalï¼‰å¥½ç”¨çš„ã€‚</p><p>å½“ç„¶è¿™ä¸ªä½ç½®ç¼–ç çš„é—®é¢˜æ˜¯ä¸€ä¸ªå¾ˆå¼€æ”¾æ€§çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å»å¥½å¥½ç ”ç©¶ä¸€ä¸‹ï¼Œè¿™ä¸ªé—®é¢˜ç›®å‰æ²¡æœ‰ä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016234442.png" alt></p><p>ä»¥ä¸Šéƒ½æ˜¯ä¸€äº›ç»“æœï¼Œæœ‰ç”¨RNNç”Ÿæˆçš„ï¼Œæœ‰ç”¨è®­ç»ƒé›†è®­ç»ƒå‡ºæ¥çš„ï¼Œè¿˜æœ‰ç”¨FLOATERæ¥å¾—åˆ°çš„ï¼Œè¿˜æ˜¯éå¸¸å¤šçš„ã€‚</p><h1 id="Self-Attension-Applications-in-every-field-of-AI"><a href="#Self-Attension-Applications-in-every-field-of-AI" class="headerlink" title="Self-Attension Applications in every field of AI"></a>Self-Attension Applications in every field of AI</h1><h2 id="NLP"><a href="#NLP" class="headerlink" title="NLP"></a>NLP</h2><p>æ®å½¬å“¥åœ¨çŸ¥ä¹ä¸Šçœ‹åˆ°çš„ä¸€ä¸ªé—®é¢˜é—®æˆ‘ä»¬ç›®å‰æœ€è®©äººæœ€éš¾å¿˜çš„ç½‘ç»œè®¸å¤šå›ç­”éƒ½æ˜¯ResNetå’ŒTransformerï¼Œä¸¤è€…æœ‰å¹¸æˆ‘ç›®å‰éƒ½æ¥è§¦åˆ°äº†ã€‚æ­£æ˜¯è¿™ä¹ˆäº›çœŸæ­£çš„å¤§ç‰›åšå‡ºæ¥çš„solid workæ‰è®©æˆ‘ä»¬æœ‰å£é¥­åƒï¼ŒGeoffrey Hintonï¼ŒYann LeCunï¼ŒYoshua Bengioï¼Œ KaimingHeï¼ŒAshish Vaswaniï¼Œ Jeff Dean, ä»–ä»¬åšåˆ°äº†å¼€åˆ›AIå¹¶è®©AIç»§ç»­â€œæ´»â€ä¸‹å»ã€‚æœ‰äº†ä»–ä»¬ï¼ŒAIæ‰èƒ½ä¸ä»…ä»…æ˜¯ä¸€ä¸ª<strong>imagination</strong>ã€‚çœŸå¸Œæœ›ä»–ä»¬èƒ½å¤Ÿç»§ç»­å‡ºäº›è¿™ä¹ˆåˆ’æ—¶ä»£ä»¤äººæ¿€åŠ¨çš„æˆæœ,èƒ½è®©æˆ‘ä»¬èƒ½å¤Ÿç»§ç»­è·Ÿç€ä»–ä»¬çš„æ­¥ä¼å­¦ä¹ å¹¶è¯•å›¾åšå‡ºä¸€äº›æˆæœã€‚ç›¸æ¯”äºä»–ä»¬ï¼Œæˆ‘ä»¬åšçš„é¡¶å¤šä¹Ÿå°±æ˜¯ä»–ä»¬æˆæœçš„è¾¹è§’æ–™éƒ½ä¸ç®—çš„ç¢æœ«è€Œå·²ã€‚</p><p>è¿™ä¹ˆå¤šå¤©çœ‹äº†è®¸å¤šè®ºæ–‡ï¼Œä¹Ÿå’Œè®¸å¤šåšå£«å­¦é•¿æ•™æˆè€å¸ˆé—¨äº¤æµä¹‹åï¼Œä¹Ÿç®—æ˜¯æ¥è§¦åˆ°äº†ä¸€ç‚¹å­¦æœ¯å‰æ²¿ã€‚å†çœ‹è¿™äº›çœŸæ­£AIç§‘å­¦å®¶çš„å·¥ä½œï¼Œç«™åœ¨ä»–ä»¬çš„è‚©è†€ä¸Šæ‰æ„Ÿè§‰åˆ°äº†ä»–ä»¬çš„é«˜åº¦ï¼Œæ‰è§‰å¾—è‡ªå·±çœŸçš„æ˜¯å¤ªæ¸ºå°äº†ï¼Œäººç±»çš„æ™ºæ…§çœŸæ˜¯ä¸€ä»¶ä¸å¯æƒ³è±¡çš„äº‹æƒ…ã€‚</p><p>å†æ¬¡çœŸå¿ƒå¸Œæœ›ä»–ä»¬èƒ½å¤Ÿç»§ç»­åšå‡ºè¿™äº›çœŸæ­£æœ‰åŠ©äºæ¨åŠ¨äººç±»ç¤¾ä¼šè¿›æ­¥æœ‰è´¡çŒ®çš„å·¥ä½œï¼Œä¸ºæ•´ä¸ªäººç±»é€ ç¦ã€‚</p><p>åŒæ—¶å¸Œæœ›æˆ‘ä¹Ÿèƒ½ä¸ºç§‘å­¦è´¡çŒ®ä¸€ä»½è‡ªå·±å¾®è–„çš„åŠ›é‡ã€‚ï¼ˆè™½ç„¶æˆ‘ä¸æ˜¯è¯´å‘é¡¶ä¼šæ‰æ˜¯åšè´¡çŒ®ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯æƒ³å‘é¡¶ä¼šâ€¦â€¦<del>çªç„¶å¥½ç‹­éš˜</del>ï¼‰</p><p>NLPä¸Šå¯ä»¥è¿›è¡Œç›¸å…³çš„è¿ç”¨ï¼Œæ¯”å¦‚æˆ‘ä»¬å¸¸è§çš„Transformerï¼ŒBERTã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211016234458.png" alt></p><p>ä½†æ˜¯æˆ‘ä»¬ä¸ä»…ä»…å¯ä»¥å°†å®ƒç”¨åˆ°NLPä¸Šï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥ç”¨åˆ°è®¸å¤šå…¶ä»–é¢†åŸŸã€‚</p><h2 id="CV"><a href="#CV" class="headerlink" title="CV"></a>CV</h2><blockquote><p>reference: presentation by Xin yi </p></blockquote><p>å¯¹äºå›¾ç‰‡ï¼Œæˆ‘ä»¬å®é™…ä¸Šå¯ä»¥å°†ä¸€å¼ å›¾ç‰‡çœ‹ä½œæ˜¯ä¸€ä¸ªVector setã€‚æˆ‘ä»¬å¯ä»¥å°†ä¸€ä¸ªå›¾ç‰‡çš„</p>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> self-attention </tag>
            
            <tag> transformer </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>practice mmdet(Customized datasets)</title>
      <link href="/2021/10/12/practice-mmdet-customized-datasets/"/>
      <url>/2021/10/12/practice-mmdet-customized-datasets/</url>
      
        <content type="html"><![CDATA[<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>ä¸Šä¸€ä¸ªæ–‡æ¡£å®é™…ä¸Šæˆ‘ä»¬å­¦ä¹ äº†æœ‰å…³çš„mmdetæ€ä¹ˆåŸºäºå·²æœ‰çš„æ ‡å‡†æ•°æ®é›†å’Œæ¨¡å‹æ¥è®­ç»ƒï¼Œå½“ç„¶æˆ‘ä»¬æ²¡æœ‰èƒ½å¤Ÿä¸€ä¸ªä¸€ä¸ªä»£ç è¿›è¡Œæº¯æºï¼Œæºç ä¹Ÿæ²¡æœ‰å¼€å§‹è¯¦ç»†äº†è§£è§£è¯»ï¼Œä½†æ˜¯å·²ç»è¿ˆå‡ºäº†ä¸€å°æ­¥ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ç»§ç»­æ¥çœ‹æ€ä¹ˆä½¿ç”¨è‡ªå®šä¹‰çš„æ•°æ®é›†è¿›è¡Œè®­ç»ƒã€‚</p><h1 id="Basic-steps"><a href="#Basic-steps" class="headerlink" title="Basic steps"></a>Basic steps</h1><p>é€šå¸¸è€Œè¨€æˆ‘ä»¬é€šå¸¸æœ‰ä¸‰æ­¥èµ°ï¼š</p><ol><li>å‡†å¤‡è‡ªå·±çš„æ•°æ®é›†(Prepare the customized dataset)</li><li>å‡†å¤‡ä¸€ä¸ªconfig(Prepare a config)</li><li>åœ¨è‡ªå®šä¹‰æ•°æ®é›†ä¸Šè®­ç»ƒï¼Œæµ‹è¯•ï¼Œæ¨æ–­(Train, test, inference models on the customized datasets.)</li></ol><p>è€Œæˆ‘ä»¬å‡†å¤‡ç¬¦åˆmmdetçš„æ•°æ®é›†é€šå¸¸ä¼šæœ‰ä»¥ä¸‹è¿™ä¹ˆäº›å½¢å¼ï¼š</p><ol><li>å°†æ•°æ®é›†æŒ‰ç…§COCOçš„æ ¼å¼æ¥å¼„</li><li>reorganize the dataset into a middle format.</li><li>å®è¡Œä¸€ä¸ªæ–°æ•°æ®é›†</li></ol><p>æˆ‘ä»¬é€šå¸¸ä¼šé€‰æ‹©å‰ä¸¤ç§æ–¹æ³•ï¼Œå› ä¸ºç®€å•ï¼Œå½“ç„¶ï¼Œæˆ‘ä»¬è¿™é‡Œå…ˆè¯•è¯•ç¬¬ä¸€ç§æ–¹æ³•ã€‚</p><p><strong>Note</strong>: MMDetection only supports evaluating mask AP of dataset in COCO format for now. So for instance segmentation task users should convert the data into coco format.</p><h1 id="Prepare-the-customized-dataset"><a href="#Prepare-the-customized-dataset" class="headerlink" title="Prepare the customized dataset"></a>Prepare the customized dataset</h1><p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹COCO annotationçš„æ ¼å¼</p><h2 id="COCO-annotation-format"><a href="#COCO-annotation-format" class="headerlink" title="COCO annotation format"></a>COCO annotation format</h2><p>The necessary keys of COCO format for instance segmentation is as below, for the complete details, please refer <a href="https://cocodataset.org/#format-data" target="_blank" rel="noopener">here</a>.</p><pre class="line-numbers language-shell"><code class="language-shell">{    "images": [image],    "annotations": [annotation],    "categories": [category]}image = {    "id": int,    "width": int,    "height": int,    "file_name": str,}annotation = {    "id": int,    "image_id": int,    "category_id": int,    "segmentation": RLE or [polygon],    "area": float,    "bbox": [x,y,width,height],    "iscrowd": 0 or 1,}categories = [{    "id": int,    "name": str,    "supercategory": str,}]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬ä»¥ä¸€ä¸ªè¾ƒå°çš„balloonæ•°æ®é›†ä¸ºä¾‹ï¼Œæˆ‘ä»¬éœ€è¦å†™ä¸€ä¸ªæ–°çš„å‡½æ•°æ¥è®©æˆ‘ä»¬çš„æ•°æ®é›†è½¬åŒ–ä¸ºCOCOçš„æ ¼å¼ã€‚ç„¶åæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨COCODatasetæ¥åŠ è½½æ•°æ®ç„¶åè®­ç»ƒï¼Œè¯„ä¼°ã€‚</p><h2 id="Balloon-dataset"><a href="#Balloon-dataset" class="headerlink" title="Balloon dataset"></a>Balloon dataset</h2><p>æˆ‘ä»¬å¯ä»¥æ¥çœ‹çœ‹æˆ‘ä»¬çš„ balloon datasetï¼š</p><p><a href="https://imgtu.com/i/5nwXnI" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/10/12/5nwXnI.png" alt></a></p><p>åˆçº§ç›®å½•æœ‰è®­ç»ƒé›†å’ŒéªŒè¯é›†ã€‚</p><p>ç„¶åç»§ç»­çœ‹ï¼š</p><p><a href="https://imgtu.com/i/5n0mNT" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/10/12/5n0mNT.png" alt></a></p><p><a href="https://imgtu.com/i/5n0VH0" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/10/12/5n0VH0.png" alt></a></p><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„å›¾ç‰‡éƒ½æ˜¯.jpg,ç„¶åannotationæ–‡ä»¶éƒ½æ˜¯.jsonæ ¼å¼çš„ã€‚æˆ‘ä»¬ç”¨vimå…ˆé¢„è§ˆä¸‹ï¼š</p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¤§è‡´çš„æ ¼å¼å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">{'base64_img_data': '', 'file_attributes': {}, 'filename': '34020010494_e5cb88e1c4_k.jpg', 'fileref': '', 'regions': {'0': {'region_attributes': {},   'shape_attributes': {'all_points_x': [1020,     1000,     994,     1003,     1023,     1050,     1089,     1134,     1190,     1265,     1321,     1361,     1403,     1428,     1442,     1445,     1441,     1427,     1400,     1361,     1316,     1269,     1228,     1198,     1207,     1210,     1190,     1177,     1172,     1174,     1170,     1153,     1127,     1104,     1061,     1032,     1020],    'all_points_y': [963,     899,     841,     787,     738,     700,     663,     638,     621,     619,     643,     672,     720,     765,     800,     860,     896,     942,     990,     1035,     1079,     1112,     1129,     1134,     1144,     1153,     1166,     1166,     1150,     1136,     1129,     1122,     1112,     1084,     1037,     989,     963],    'name': 'polygon'}}}, 'size': 1115004}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Convert-to-COCO-style"><a href="#Convert-to-COCO-style" class="headerlink" title="Convert to COCO style"></a>Convert to COCO style</h2><p>è¿™ä¸ªannotationæ˜¯ä¸€ä¸ªJSONæ–‡ä»¶ï¼Œæ¯ä¸€ä¸ªé”®å€¼å¯¹éƒ½è¡¨ç¤ºä¸€ä¸ªå›¾åƒæ‰€æœ‰annotationsï¼Œæˆ‘ä»¬éœ€è¦å†™ä¸€äº›ä»£ç æ¥å°†è¿™ä¸ªJSONæ–‡ä»¶è½¬åŒ–ä¸ºCOCOçš„æ ‡å‡†æ ¼å¼ï¼Œå°±åƒä¸‹é¢è¿™æ ·(ç»è¿‡æœ¬äººå¾®å°çš„ä¿®æ”¹å¹¶ä¸”è°ƒè¯•è¿è¡ŒæˆåŠŸ)ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> os<span class="token punctuation">.</span>path <span class="token keyword">as</span> osp<span class="token keyword">import</span> mmcv<span class="token keyword">def</span> <span class="token function">convert_balloon_to_coco</span><span class="token punctuation">(</span>ann_file<span class="token punctuation">,</span> out_file<span class="token punctuation">,</span> image_prefix<span class="token punctuation">)</span><span class="token punctuation">:</span>    data_infos <span class="token operator">=</span> mmcv<span class="token punctuation">.</span>load<span class="token punctuation">(</span>ann_file<span class="token punctuation">)</span>    annotations <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    images <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    obj_count <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> idx<span class="token punctuation">,</span> v <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>mmcv<span class="token punctuation">.</span>track_iter_progress<span class="token punctuation">(</span>data_infos<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        filename <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token string">'filename'</span><span class="token punctuation">]</span>        img_path <span class="token operator">=</span> osp<span class="token punctuation">.</span>join<span class="token punctuation">(</span>image_prefix<span class="token punctuation">,</span> filename<span class="token punctuation">)</span>        height<span class="token punctuation">,</span> width <span class="token operator">=</span> mmcv<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>img_path<span class="token punctuation">)</span><span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>        images<span class="token punctuation">.</span>append<span class="token punctuation">(</span>dict<span class="token punctuation">(</span>            id<span class="token operator">=</span>idx<span class="token punctuation">,</span>            file_name<span class="token operator">=</span>filename<span class="token punctuation">,</span>            height<span class="token operator">=</span>height<span class="token punctuation">,</span>            width<span class="token operator">=</span>width<span class="token punctuation">)</span><span class="token punctuation">)</span>        bboxes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        masks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> _<span class="token punctuation">,</span> obj <span class="token keyword">in</span> v<span class="token punctuation">[</span><span class="token string">'regions'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">assert</span> <span class="token operator">not</span> obj<span class="token punctuation">[</span><span class="token string">'region_attributes'</span><span class="token punctuation">]</span>            obj <span class="token operator">=</span> obj<span class="token punctuation">[</span><span class="token string">'shape_attributes'</span><span class="token punctuation">]</span>            px <span class="token operator">=</span> obj<span class="token punctuation">[</span><span class="token string">'all_points_x'</span><span class="token punctuation">]</span>            py <span class="token operator">=</span> obj<span class="token punctuation">[</span><span class="token string">'all_points_y'</span><span class="token punctuation">]</span>            poly <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">0.5</span><span class="token punctuation">,</span> y <span class="token operator">+</span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token keyword">for</span> x<span class="token punctuation">,</span> y <span class="token keyword">in</span> zip<span class="token punctuation">(</span>px<span class="token punctuation">,</span> py<span class="token punctuation">)</span><span class="token punctuation">]</span>            poly <span class="token operator">=</span> <span class="token punctuation">[</span>p <span class="token keyword">for</span> x <span class="token keyword">in</span> poly <span class="token keyword">for</span> p <span class="token keyword">in</span> x<span class="token punctuation">]</span>            x_min<span class="token punctuation">,</span> y_min<span class="token punctuation">,</span> x_max<span class="token punctuation">,</span> y_max <span class="token operator">=</span> <span class="token punctuation">(</span>                min<span class="token punctuation">(</span>px<span class="token punctuation">)</span><span class="token punctuation">,</span> min<span class="token punctuation">(</span>py<span class="token punctuation">)</span><span class="token punctuation">,</span> max<span class="token punctuation">(</span>px<span class="token punctuation">)</span><span class="token punctuation">,</span> max<span class="token punctuation">(</span>py<span class="token punctuation">)</span><span class="token punctuation">)</span>            data_anno <span class="token operator">=</span> dict<span class="token punctuation">(</span>                image_id<span class="token operator">=</span>idx<span class="token punctuation">,</span>                id<span class="token operator">=</span>obj_count<span class="token punctuation">,</span>                category_id<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>                bbox<span class="token operator">=</span><span class="token punctuation">[</span>x_min<span class="token punctuation">,</span> y_min<span class="token punctuation">,</span> x_max <span class="token operator">-</span> x_min<span class="token punctuation">,</span> y_max <span class="token operator">-</span> y_min<span class="token punctuation">]</span><span class="token punctuation">,</span>                area<span class="token operator">=</span><span class="token punctuation">(</span>x_max <span class="token operator">-</span> x_min<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>y_max <span class="token operator">-</span> y_min<span class="token punctuation">)</span><span class="token punctuation">,</span>                segmentation<span class="token operator">=</span><span class="token punctuation">[</span>poly<span class="token punctuation">]</span><span class="token punctuation">,</span>                iscrowd<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>            annotations<span class="token punctuation">.</span>append<span class="token punctuation">(</span>data_anno<span class="token punctuation">)</span>            obj_count <span class="token operator">+=</span> <span class="token number">1</span>    coco_format_json <span class="token operator">=</span> dict<span class="token punctuation">(</span>        images<span class="token operator">=</span>images<span class="token punctuation">,</span>        annotations<span class="token operator">=</span>annotations<span class="token punctuation">,</span>        categories<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">'id'</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'balloon'</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    mmcv<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>coco_format_json<span class="token punctuation">,</span> out_file<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    image_pre <span class="token operator">=</span> <span class="token string">'/home/lry/data/balloon/train/'</span>    ann_file <span class="token operator">=</span> <span class="token string">'/home/lry/data/balloon/train/via_region_data.json'</span>    out_file <span class="token operator">=</span> <span class="token string">'/home/lry/data/balloon/train_coco.json'</span>    convert_balloon_to_coco<span class="token punctuation">(</span>ann_file<span class="token punctuation">,</span> out_file<span class="token punctuation">,</span> image_pre<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€åannotationä¿å­˜ä¸ºJSONæ–‡ä»¶ï¼Œæ–‡ä»¶åä¸ºtrain_coco.json.</p><p>å½“ç„¶æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹è½¬åŒ–åçš„æ–‡ä»¶å’Œè½¬åŒ–å‰çš„æ–‡ä»¶å¯¹æ¯”ï¼š</p><p><a href="https://imgtu.com/i/5nr7VI" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/10/12/5nr7VI.png" alt="Comparition"></a></p><p>å³è¾¹å°±æ˜¯COCOçš„æ ¼å¼ã€‚</p><p>OKï¼Œæˆ‘ä»¬è½¬åŒ–å¥½æ ¼å¼ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æˆåŠŸä½¿ç”¨æˆ‘ä»¬çš„CoCoDatasetæ¥è®­ç»ƒä¸è¯„ä¼°æˆ‘ä»¬çš„æ¨¡å‹äº†ã€‚</p><h1 id="Prepare-a-config"><a href="#Prepare-a-config" class="headerlink" title="Prepare a config"></a>Prepare a config</h1><p>ç¬¬äºŒæ­¥å°±æ˜¯å‡†å¤‡ä¸€ä¸ªconfigæ–‡ä»¶ä»¥æ–¹ä¾¿æˆ‘ä»¬çš„datasetå¯ä»¥æˆåŠŸè¢«è¯»å–ã€‚å‡å®šæˆ‘ä»¬è¦ä½¿ç”¨Mask R-CNN with FPNï¼Œç”¨æ¥åœ¨æˆ‘ä»¬çš„ballon datasetä¸Šè®­ç»ƒæˆ‘ä»¬çš„detectorçš„configå¦‚ä¸‹ï¼š</p><blockquote><p> æˆ‘ä»¬çš„configéœ€è¦æ”¾åˆ°<code>configs/balloon/</code>ç›®å½•ä¸‹å¹¶ä¸”å‘½åä¸ºï¼š<code>mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_balloon.py</code></p><p> å…³äºè¿™ä¹ˆä¸€ä¸ªåå­—ï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆå¤æ‚æ˜¯æœ‰åŸå› çš„ï¼Œå‚è§è¿™é‡Œ:<a href="https://mmdetection.readthedocs.io/zh_CN/v2.18.0/tutorials/config.html#id4" target="_blank" rel="noopener">https://mmdetection.readthedocs.io/zh_CN/v2.18.0/tutorials/config.html#id4</a></p></blockquote><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># The new config inherits a base config to highlight the necessary modification</span>_base_ <span class="token operator">=</span> <span class="token string">'mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_coco.py'</span><span class="token comment" spellcheck="true"># We also need to change the num_classes in head to match the dataset's annotation</span>model <span class="token operator">=</span> dict<span class="token punctuation">(</span>    roi_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>        bbox_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>num_classes<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        mask_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>num_classes<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># Modify dataset related settings</span>dataset_type <span class="token operator">=</span> <span class="token string">'COCODataset'</span>classes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'balloon'</span><span class="token punctuation">,</span><span class="token punctuation">)</span>data <span class="token operator">=</span> dict<span class="token punctuation">(</span>    train<span class="token operator">=</span>dict<span class="token punctuation">(</span>        img_prefix<span class="token operator">=</span><span class="token string">'balloon/train/'</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'balloon/train/annotation_coco.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    val<span class="token operator">=</span>dict<span class="token punctuation">(</span>        img_prefix<span class="token operator">=</span><span class="token string">'balloon/val/'</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'balloon/val/annotation_coco.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    test<span class="token operator">=</span>dict<span class="token punctuation">(</span>        img_prefix<span class="token operator">=</span><span class="token string">'balloon/val/'</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'balloon/val/annotation_coco.json'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># We can use the pre-trained Mask RCNN model to obtain higher performance</span>load_from <span class="token operator">=</span> <span class="token string">'checkpoints/mask_rcnn_r50_caffe_fpn_mstrain-poly_3x_coco_bbox_mAP-0.408__segm_mAP-0.37_20200504_163245-42aa3d00.pth'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å½“ç„¶æˆ‘ä»¬é€šè¿‡è¯»è¿™é‡Œçš„æ–‡ä»¶ä¼šå‘ç°æˆ‘ä»¬çš„ä¹‹å‰è½¬åŒ–çš„JSONæ–‡ä»¶çš„ä½ç½®æ”¾é”™äº†ï¼Œç”šè‡³åå­—ä¹Ÿä¸å¯¹ï¼Œä½†æ˜¯æ²¡å…³ç³»ï¼Œåªéœ€è¦é‡æ–°è½¬ç§»ä¸‹å°±OKäº†ã€‚</p><p>æ³¨æ„ä¸€ä¸‹è¿™é‡Œï¼Œæˆ‘ä»¬ä¹‹å‰è¯»åˆ°è¿‡è¿™é‡Œï¼ˆ<strong>æ³¨æ„é«˜äº®çš„æ–‡å­—</strong>ï¼‰ï¼š</p><p><a href="https://imgtu.com/i/5n63Ke" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/10/12/5n63Ke.png" alt="Attension"></a></p><p>è™½ç„¶æˆ‘ä»¬çš„æ–‡ä»¶ä½äºæˆ‘ä»¬çš„é¡¹ç›®å¤–éƒ¨ï¼Œä½†æ˜¯Linuxé‡Œé¢æœ‰ä¸€ä¸ªè½¯è¿æ¥symlinkè¿™æ ·ä¸€ä¸ªæ¦‚å¿µï¼Œç±»ä¼¼äºå¿«æ·æ–¹å¼ï¼Œæˆ‘ä»¬åŒæ ·éœ€è¦ç”¨åˆ°è¿™ä¸ªæ¥åœ¨é¡¹ç›®ä¸­å»ºç«‹ä¸€ä¸ªsymlinkã€‚è‡³äºå…·ä½“æ€ä¹ˆåšï¼Œè¯·å‚è§æˆ‘çš„<a href="https://lry89757.github.io/2021/09/24/linux-bi-ji/">Linuxç¬”è®°</a>.</p><p>å¦å¤–æˆ‘ä»¬é™¤äº†è¿™é‡Œè¦æ›´æ”¹ä¹‹å¤–ï¼Œæˆ‘ä»¬<code>__base__</code>è¿™é‡Œçš„ä¸œè¥¿ä»ç„¶è¦æ›´æ”¹ï¼Œå› ä¸ºå¾ˆæ˜æ˜¾è·¯å¾„æœ‰é”™è¯¯ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªåœ°æ–¹ï¼ˆçœŸæ˜¯åäº†ï¼Œ<del>å®˜ç½‘ç»™çš„è¿™ä¹ˆå·®</del>ï¼‰:</p><p>æˆ‘ä»¬çš„è®­ç»ƒæƒé‡å®˜ç½‘å±…ç„¶æ²¡æœ‰ç»™å‡ºä»–çš„ä¸‹è½½åœ°å€åœ¨å“ªé‡Œï¼è¿˜æ˜¯å®³å¾—æˆ‘æ‰¾äº†ä¸€ä¸ªColabç½‘å€æ‰æ‰¾åˆ°ç½‘ä¸Šçš„è®­ç»ƒæƒé‡ï¼š</p><p><a href="https://imgtu.com/i/5n2RPI" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/10/12/5n2RPI.png" alt="æ³¨æ„é«˜äº®æ–‡å­—"></a></p><p>åŠ ä¸Šå°±è¡Œäº†ï¼Œæœ€ååœ¨åŠ ä¸Šè½¯è¿æ¥ï¼Œæˆ‘ä»¬å°±ä¼šå¾—åˆ°æˆ‘ä»¬æœ€ç»ˆçš„å®Œæˆç‰ˆä»£ç ï¼ˆä¸ªäººå‘ï¼‰ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># The new config inherits a base config to highlight the necessary modification</span>_base_ <span class="token operator">=</span> <span class="token string">'../mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_coco.py'</span><span class="token comment" spellcheck="true"># We also need to change the num_classes in head to match the dataset's annotation</span>model <span class="token operator">=</span> dict<span class="token punctuation">(</span>    roi_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>        bbox_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>num_classes<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        mask_head<span class="token operator">=</span>dict<span class="token punctuation">(</span>num_classes<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># Modify dataset related settings</span>dataset_type <span class="token operator">=</span> <span class="token string">'COCODataset'</span>classes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'balloon'</span><span class="token punctuation">,</span><span class="token punctuation">)</span>data <span class="token operator">=</span> dict<span class="token punctuation">(</span>    train<span class="token operator">=</span>dict<span class="token punctuation">(</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/train/'</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/train/annotation_coco.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    val<span class="token operator">=</span>dict<span class="token punctuation">(</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/val/'</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/val/annotation_coco.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    test<span class="token operator">=</span>dict<span class="token punctuation">(</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/val/'</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'/home/lry/projects/mmdetection/data/balloon/val/annotation_coco.json'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># We can use the pre-trained Mask RCNN model to obtain higher performance</span><span class="token comment" spellcheck="true"># load_from = 'checkpoints/mask_rcnn_r50_caffe_fpn_mstrain-poly_3x_coco_bbox_mAP-0.408__segm_mAP-0.37_20200504_163245-42aa3d00.pth'</span>load_from <span class="token operator">=</span> <span class="token string">'https://download.openmmlab.com/mmdetection/v2.0/mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_3x_coco/mask_rcnn_r50_caffe_fpn_mstrain-poly_3x_coco_bbox_mAP-0.408__segm_mAP-0.37_20200504_163245-42aa3d00.pth'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="Train-a-new-model"><a href="#Train-a-new-model" class="headerlink" title="Train a new model"></a>Train a new model</h1><p>å®é™…ä¸Šæˆ‘ä»¬è¿™é‡Œè®­ç»ƒå¾ˆç®€å•ï¼Œä»…ä»…ä¸€è¡ŒæŒ‡ä»¤å°±OKï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">python tools<span class="token operator">/</span>train<span class="token punctuation">.</span>py configs<span class="token operator">/</span>balloon<span class="token operator">/</span>mask_rcnn_r50_caffe_fpn_mstrain<span class="token operator">-</span>poly_1x_balloon<span class="token punctuation">.</span>py<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è®­ç»ƒè¿˜æ˜¯æ¯”è¾ƒå¿«çš„ç›¸å¯¹è€Œè¨€ï¼ˆè‡³å°‘æˆ‘æ„Ÿè§‰ï¼‰æ¯•ç«Ÿè¿™é‡Œä¹Ÿæ²¡æœ‰å¤šå¤§çš„æ•°æ®ï¼Œå…·ä½“æ‰§è¡Œè¿‡ç¨‹æˆ‘å°±æˆªäº†æ²¡å‡ å¼ å›¾ï¼š</p><p><a href="https://imgtu.com/i/5nWRjf" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/10/12/5nWRjf.png" alt></a><a href="https://imgtu.com/i/5nWzE4" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/10/12/5nWzE4.png" alt></a></p><p>æœ€åè¿è¡Œç»“æŸï¼š</p><p><a href="https://imgtu.com/i/5nWb3q" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/10/12/5nWb3q.png" alt></a></p><p>For more detailed usages, please refer to the <a href="https://mmdetection.readthedocs.io/en/latest/1_exist_data_model.html" target="_blank" rel="noopener">Case 1</a>.</p><h1 id="Test-and-inference"><a href="#Test-and-inference" class="headerlink" title="Test and inference"></a>Test and inference</h1><p>è¿™ä¸ªä¹Ÿæ˜¯ä¸€è¡Œä»£ç ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">python tools/test.py configs/balloon/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_balloon.py work_dirs/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_balloon.py/latest.pth --eval bbox segm<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> mmdet </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++ç¬”è®°</title>
      <link href="/2021/10/12/c-bi-ji/"/>
      <url>/2021/10/12/c-bi-ji/</url>
      
        <content type="html"><![CDATA[<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p><em>æœ¬Blogä¸»è¦æ¥è‡ªåä¸­ç§‘æŠ€å¤§å­¦é‡‘è‰¯æµ·æ•™æˆçš„PPTã€‚</em></p><p>å¥½ä¹…æ²¡å»ä¸Šè¿‡C++è¯¾äº†ï¼Œå¤§å¤šæ•°æ—¶é—´éƒ½æ˜¯ç›´æ¥åˆç¡ç¡è¿‡å»å°±æ²¡æ¥å¾—åŠå»ä¸Šè¯¾ï¼Œè¯¾æœ¬ä¹Ÿæ²¡æœ‰çœ‹è¿‡å‡ çœ¼ï¼Œç°åœ¨æƒ³æ¥è¿™ä¹Ÿå¤ªç½ªè¿‡äº†ã€‚C++æ¯•ç«Ÿæ˜¯è¿™ä¹ˆé‡è¦çš„ä¸€é—¨è¯¾ï¼Œ<del>è‡³å°‘è¿˜æœ‰è€ƒè¯•å‘¢å¯¹å§</del>ã€‚æ›´ä½•å†µä»¥åç»å¯¹è¦ç”¨åˆ°ï¼Œæ€ä¹ˆèƒ½ç›´æ¥æ”¾å¼ƒå‘¢ï¼Œç°åœ¨C++ä½œä¸šéƒ½å‡ºäº†ï¼Œè¯¾éƒ½è®²å¥½å¤šç« äº†ï¼Œå†ä¸å­¦å°±çœŸçš„è·Ÿä¸ä¸Šäº†ã€‚åŠæ—¶æ­¢æŸï¼Œå¼€å§‹å­¦ä¹ ï¼</p><blockquote><p>æœ¬ç¬”è®°ä¸åŒäºå…¶ä»–çš„ç¬”è®°ï¼Œè¿™ä¸ªç¬”è®°ä¸»è¦æ˜¯ç»™æˆ‘è‡ªå·±çœ‹çš„ï¼Œç”±äºæˆ‘ä¹‹å‰ä¹Ÿæœ‰ä¸€äº›å…³äºç±»çš„çŸ¥è¯†ï¼ˆåªä¸è¿‡æ˜¯python AI torchç­‰åº“æ–¹é¢ç”¨åˆ°çš„ä¸€äº›ç±»ï¼‰ï¼Œæ‰€ä»¥è¿™é‡Œå¯èƒ½ä¸æ˜¯å…¥é—¨çš„Blogã€‚</p></blockquote><p>å¯èƒ½è¿™äº›å¾ˆå¤šçš„åŸºç¡€çŸ¥è¯†åœ¨æˆ‘ä»¬ç¼–å†™ç»å¤§å¤šæ•°ä»£ç çš„æ—¶å€™éƒ½æ²¡ä»€ä¹ˆç”¨ï¼Œä½†æ˜¯çŸ¥ä¹æœ‰å¤§ä½¬æ›¾è¯´è¿‡è¿™ä¹ˆä¸€å¥è¯ï¼Œæˆ‘è®¤ä¸ºè¿˜éå¸¸å—ç”¨ï¼š</p><blockquote><p>â€œ<em>æˆ‘è§‰å¾—æ‰å®åŸºç¡€çŸ¥è¯†å¯ä»¥è®©ä½ åœ¨é˜…è¯»ä»£ç çš„æ—¶å€™ä¸è’™æ··è¿‡å…³ï¼Œä¸ç”¨æ¯æ¬¡éƒ½èŠ±è´¹å¤§é‡æ—¶é—´ç¢ç£¨ä»£ç çš„ç”¨æ„ï¼Œæœ€åä»ç„¶è’™æ··è¿‡å…³ï¼Œæµªè´¹æ—¶é—´åˆæ²¡è¿›æ­¥ã€‚ç£¨åˆ€ä¸è¯¯ç æŸ´åŠŸï¼Œå­¦ä¹ åŸºç¡€çŸ¥è¯†æ€»æ²¡é”™çš„</em>ã€‚â€</p></blockquote><p>å…³é”®å­—<code>union</code>, <code>class</code>, <code>struct</code>éƒ½å¯ä»¥ç”¨æ¥å£°æ˜å®šä¹‰ç±»ã€‚ç±»å°†æ•°æ®æˆå‘˜ã€å‡½æ•°æˆå‘˜ã€ç±»å‹æˆå‘˜å°è£…èµ·æ¥ï¼Œå¹¶æä¾›å¯ä¾›å¤–éƒ¨è®¿é—®çš„ç¼ºå£ï¼Œé™ä½äº†ç¨‹åºå¤æ‚æ€§ã€‚</p><p>ç±»æœ‰<code>attribute</code>å’Œ<code>method</code>ã€‚é€šå¸¸æˆ‘ä»¬ä¼šå°†æ™®é€šå˜é‡å°è£…èµ·æ¥ï¼Œä¸è®©æ™®é€šç”¨æˆ·è®¿é—®ã€‚è€Œæˆ‘ä»¬ä¼šåˆ©ç”¨å…¬æœ‰çš„æ–¹æ³•æ¥ä¿®æ”¹æ™®é€šå˜é‡ã€‚ç±»å®ä¾‹åŒ–åä¼šè°ƒç”¨æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–ä¸€äº›å€¼ã€‚æˆ‘ä»¬çš„æ„é€ å‡½æ•°å°±åƒæ˜¯pythoné‡Œçš„<code>__init__</code>.è€Œæˆ‘ä»¬çš„æ„é€ å‡½æ•°ä¸€èˆ¬éƒ½æ˜¯å…¬æœ‰çš„ï¼Œå¹¶ä¸”æ²¡æœ‰è¿”å›å€¼ã€‚è€Œææ„å‡½æ•°æ˜¯ç”¨æ¥é‡Šæ”¾å†…å­˜çš„ã€æ¯ç­å¯¹è±¡çš„ï¼Œ<strong>ææ„å‡½æ•°ä¸ç±»ååŒåå¹¶ä¸”åå‰æœ‰ä¸€ä¸ª~ç¬¦å·ã€‚</strong>æˆ‘ä»¬åº”è¯¥é¿å…ææ„å‡½æ•°æ‰§è¡Œå¤šæ¬¡æ‰§è¡Œã€‚</p><p>C++ç±»çš„å¤–éƒ¨å®šä¹‰ç±»çš„å‡½æ•°çš„æ—¶å€™éœ€è¦åœ¨å‡½æ•°åå¤–é¢åŠ ä¸€ä¸ª<code>ç±»å::</code>. </p><blockquote><p><strong>global reference: PPT by Lianghai KingğŸ˜˜ğŸ˜›</strong></p></blockquote><p><strong>M++ä¿®æ­£ï¼šå¼€å·¥å‡½æ•°ã€æ”¶å·¥å‡½æ•°è¡¨ç¤ºstartupå‡½æ•°ä¸terminateå‡½æ•°ï¼Œc/c++ä¸­åˆ†åˆ«åœ¨mainä¹‹å‰å’Œä¹‹åæ‰§è¡Œçš„ä¸¤ä¸ªå‡½æ•°ï¼Œè¯¦è§MSDNï¼š<a href="https://msdn.microsoft.com/en-us/library/1d3swxkt.aspx" target="_blank" rel="noopener">C++ Program Startup and Termination</a></strong></p><h1 id="Intro-fundamentals"><a href="#Intro-fundamentals" class="headerlink" title="Intro fundamentals"></a>Intro fundamentals</h1><h2 id="ç±»çš„å®šä¹‰ä¸å£°æ˜éƒ¨åˆ†"><a href="#ç±»çš„å®šä¹‰ä¸å£°æ˜éƒ¨åˆ†" class="headerlink" title="ç±»çš„å®šä¹‰ä¸å£°æ˜éƒ¨åˆ†"></a>ç±»çš„å®šä¹‰ä¸å£°æ˜éƒ¨åˆ†</h2><ul><li>ç±»çš„<strong>å£°æ˜ã€å®šä¹‰ã€å®ç°ä¸æ˜¯ä¸€ä¸ªæ¦‚å¿µï¼</strong><ul><li>ç±»çš„å£°æ˜ç”±ä¿ç•™å­—<code>class struct union</code>.åŠ ä¸Šç±»çš„åç§°æ„æˆã€‚</li><li>ç±»çš„å®šä¹‰åŒ…æ‹¬ç±»çš„å£°æ˜éƒ¨åˆ†å’Œç±»çš„ç”±{}æ‹¬èµ·æ¥çš„ä¸»ä½“ä¸¤éƒ¨åˆ†ç»„æˆã€‚</li><li>ç±»çš„å®ç°é€šå¸¸æŒ‡ç±»çš„å‡½æ•°æˆå‘˜çš„å®ç°ï¼Œå³å®šä¹‰ç±»çš„å‡½æ•°æˆå‘˜ã€‚</li></ul></li></ul><pre class="line-numbers language-c++"><code class="language-c++">class ç±»å; // å‰å‘å£°æ˜class ç±»å{private:    // ç§æœ‰æˆå‘˜å£°æ˜æˆ–å®šä¹‰;protected:    // ä¿æŠ¤æˆå‘˜å£°æ˜æˆ–å®šä¹‰;public:    // å…¬æœ‰æˆå‘˜å£°æ˜æˆ–å®šä¹‰;};<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>æ³¨æ„ç±»çš„<code>private/public/protected</code>ä¿ç•™å­—å¯ä»¥å¤šæ¬¡å‡ºç°ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åŒä¸€ä¸ª ç±»çš„å®šä¹‰ä¸­å‡ºç°å¤šä¸ª<code>private</code></li><li><strong>æ•°æ®æˆå‘˜çš„å®šä¹‰é¡ºåºä¸åˆå§‹åŒ–é¡ºåºæœ‰å…³</strong>ï¼ˆå…³äºè¿™ä¸€ç‚¹ ä»ç„¶æ˜¯ä¿ç•™æ„è§ï¼Œå…·ä½“çš„åº•å±‚éœ€è¦è¯¦ç»†é—®ä¸€ä¸‹è€å¸ˆå­¦é•¿ï¼Œå¯ä»¥ä¾æ‰˜è¿™ä¸ª<a href="https://blog.csdn.net/zhaojinjia/article/details/8785912" target="_blank" rel="noopener">é“¾æ¥</a>æ¥é—®  ï¼‰</li><li>è‹¥å‡½æ•°æˆå‘˜åœ¨ç±»å®šä¹‰ä½“å¤–å®ç°ï¼Œåˆ™åœ¨å‡½æ•°è¿”å›ç±»å‹å’Œå‡½æ•°åä¹‹é—´ï¼Œåº”ä½¿ç”¨ç±»åå’Œä½œç”¨åŸŸè¿ç®—ç¬¦â€œ::â€æ¥æŒ‡æ˜è¯¥å‡½æ•°æˆå‘˜æ‰€å±çš„ç±»ã€‚</li></ul><h2 id="æ„é€ å‡½æ•°æ˜¾å¼è°ƒç”¨"><a href="#æ„é€ å‡½æ•°æ˜¾å¼è°ƒç”¨" class="headerlink" title="æ„é€ å‡½æ•°æ˜¾å¼è°ƒç”¨"></a>æ„é€ å‡½æ•°æ˜¾å¼è°ƒç”¨</h2><blockquote><p>åŒä¸€ä¸ªå¯¹è±¡ä»…è‡ªåŠ¨æ„é€ ä¸€æ¬¡ã€‚æ„é€ å‡½æ•°æ˜¯å”¯ä¸€ä¸èƒ½è¢«æ˜¾å¼ï¼ˆäººå·¥ï¼‰è°ƒç”¨çš„å‡½æ•°æˆå‘˜ã€‚</p></blockquote><p>äº‹å®ä¸Š ï¼Œæ„é€ å‡½æ•°å¯ä»¥æ˜¾ç¤ºè°ƒç”¨ï¼Œ<strong>ä¸è¿‡åªèƒ½ç”¨äºåˆå§‹åŒ–æ—¶</strong>ã€‚<br>å‡è®¾æœ‰ç±»A, å¹¶æœ‰æ„é€ å‡½æ•°A(int,int);<br>åœ¨å®šä¹‰Açš„å¯¹è±¡aæ—¶ï¼Œå¯ä»¥æ˜¾ç¤ºè°ƒç”¨æ„é€ å‡½æ•°ï¼Œå†™ä½œ</p><pre class="line-numbers language-c++"><code class="language-c++">A a=A(1,1);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½†æ˜¯æ›´å¸¸ç”¨å’Œæ›´ç®€æ´çš„å†™æ³•ä¸º</p><pre class="line-numbers language-c++"><code class="language-c++">A a(1,1);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰€ä»¥æ˜¾ç¤ºè°ƒç”¨æ„é€ å‡½æ•°çš„æ–¹æ³•å¹¶ä¸å¸¸ç”¨ï¼Œä½†C++çš„è¯­æ³•æ˜¯æ”¯æŒè¿™ç§å†™æ³•çš„ã€‚</p><h2 id="C-æˆå‘˜å˜é‡åˆå§‹åŒ–é¡ºåº"><a href="#C-æˆå‘˜å˜é‡åˆå§‹åŒ–é¡ºåº" class="headerlink" title="C++æˆå‘˜å˜é‡åˆå§‹åŒ–é¡ºåº"></a>C++æˆå‘˜å˜é‡åˆå§‹åŒ–é¡ºåº</h2><p>æŒ–å‘ã€‚<strong>æ•°æ®æˆå‘˜çš„å®šä¹‰é¡ºåºä¸åˆå§‹åŒ–é¡ºåºæœ‰å…³</strong>ï¼ˆå…³äºè¿™ä¸€ç‚¹ ä»ç„¶æ˜¯ä¿ç•™æ„è§ï¼Œå…·ä½“çš„åº•å±‚éœ€è¦è¯¦ç»†é—®ä¸€ä¸‹è€å¸ˆå­¦é•¿ï¼Œå¯ä»¥ä¾æ‰˜è¿™ä¸ª<a href="https://blog.csdn.net/zhaojinjia/article/details/8785912" target="_blank" rel="noopener">é“¾æ¥</a>æ¥é—®  ï¼‰</p><h2 id="å…³äºææ„å‡½æ•°"><a href="#å…³äºææ„å‡½æ•°" class="headerlink" title="å…³äºææ„å‡½æ•°"></a>å…³äºææ„å‡½æ•°</h2><p><strong>å®šä¹‰ç±»æ—¶åº”æ³¨æ„çš„é—®é¢˜</strong>ï¼š</p><ul><li><p>æ„é€ å‡½æ•°ç”¨æ¥ä¸ºå¯¹è±¡ç”³è¯·å„ç§èµ„æºï¼Œå¹¶åˆå§‹åŒ–å¯¹è±¡çš„æ•°æ®æˆå‘˜ã€‚æ„é€ å‡½æ•°æœ‰éšå«å‚æ•°<strong>this,</strong> å¯ä»¥åœ¨å‚æ•°è¡¨å®šä¹‰è‹¥å¹²å‚æ•°ï¼Œç”¨äºåˆå§‹åŒ–æ•°æ®æˆå‘˜ã€‚</p></li><li><p>ææ„å‡½æ•°æ˜¯ç”¨æ¥æ¯ç­å¯¹è±¡çš„ï¼Œææ„è¿‡ç¨‹æ˜¯æ„é€ è¿‡ç¨‹çš„é€†è¿‡ç¨‹ã€‚ææ„å‡½æ•°é‡Šæ”¾å¯¹è±¡ç”³è¯·çš„æ‰€æœ‰èµ„æºã€‚</p></li><li><p>ææ„å‡½æ•°æ—¢èƒ½è¢«æ˜¾å¼è°ƒç”¨ï¼Œä¹Ÿèƒ½è¢«éšå¼ï¼ˆè‡ªåŠ¨ï¼‰è°ƒç”¨ã€‚<strong>ç”±äºåªæœ‰ä¸€ä¸ªå›ºå®šç±»å‹çš„thisï¼Œæ•…ä¸å¯èƒ½é‡è½½</strong>ï¼Œåªèƒ½æœ‰ä¸€ä¸ªææ„å‡½æ•°ã€‚</p></li><li><p><strong>è‹¥å®ä¾‹æ•°æ®æˆå‘˜æœ‰æŒ‡é’ˆï¼Œåº”å½“é˜²æ­¢åå¤ææ„ï¼ˆç”¨æŒ‡é’ˆæ˜¯å¦ä¸ºç©ºåšæ ‡å¿—ï¼‰ã€‚</strong></p></li><li><p>è”åˆä¹Ÿæ˜¯ç±»ï¼Œå¯å®šä¹‰æ„é€ ã€ææ„ä»¥åŠå…¶å®ƒå‡½æ•°æˆå‘˜ã€‚</p></li></ul><h2 id="ä¸€ä¸ªç®€å•çš„å®šä¹‰ç±»"><a href="#ä¸€ä¸ªç®€å•çš„å®šä¹‰ç±»" class="headerlink" title="ä¸€ä¸ªç®€å•çš„å®šä¹‰ç±»"></a>ä¸€ä¸ªç®€å•çš„å®šä¹‰ç±»</h2><pre class="line-numbers language-c++"><code class="language-c++">// ä¾‹4.1ã€‘å®šä¹‰å­—ç¬¦ä¸²ç±»å‹å’Œå­—ç¬¦ä¸²å¯¹è±¡ã€‚    #include <alloc.h>    struct STRING {        typedef  char * CHARPTR;    //å®šä¹‰ç±»å‹æˆå‘˜        CHARPTR  s;        //å®šä¹‰æ•°æ®æˆå‘˜        int  strlen( );        //å£°æ˜å‡½æ•°æˆå‘˜ï¼Œæ±‚è°çš„é•¿(æœ‰this)        STRING(const char *);    //å£°æ˜æ„é€ å‡½æ•°ï¼Œæœ‰this        ~STRING( );        //å£°æ˜ææ„å‡½æ•°ï¼Œæœ‰this    };    int STRING::strlen( ) {     //ç”¨è¿ç®—ç¬¦::åœ¨ç±»ä½“å¤–å®šä¹‰        int  k;        for(k=0; s[k]!=0; k++);        return k;    }<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œé¢ä¸»è¦å…³æ³¨ç‚¹åœ¨äº<code>ç±»å‹æˆå‘˜</code>æ˜¯ä»€ä¹ˆ, å…¶ä»–çš„éƒ½éå¸¸ç®€å•ã€‚</p><h2 id="ç¨‹åºä¸åŒç»“æŸå½¢å¼å¯¹å¯¹è±¡çš„å½±å“ï¼ˆexit-abort-return-ä»¥åŠå†…å­˜åˆ†åŒºé—®é¢˜"><a href="#ç¨‹åºä¸åŒç»“æŸå½¢å¼å¯¹å¯¹è±¡çš„å½±å“ï¼ˆexit-abort-return-ä»¥åŠå†…å­˜åˆ†åŒºé—®é¢˜" class="headerlink" title="ç¨‹åºä¸åŒç»“æŸå½¢å¼å¯¹å¯¹è±¡çš„å½±å“ï¼ˆexit,abort,return)ä»¥åŠå†…å­˜åˆ†åŒºé—®é¢˜"></a>ç¨‹åºä¸åŒç»“æŸå½¢å¼å¯¹å¯¹è±¡çš„å½±å“ï¼ˆexit,abort,return)ä»¥åŠå†…å­˜åˆ†åŒºé—®é¢˜</h2><ul><li><p>exité€€å‡ºï¼šå±€éƒ¨è‡ªåŠ¨å¯¹è±¡ä¸èƒ½è‡ªåŠ¨æ‰§è¡Œææ„å‡½æ•°ï¼Œæ•…æ­¤ç±»å¯¹è±¡èµ„æºä¸èƒ½è¢«é‡Šæ”¾ã€‚<strong>ä½†æ˜¯é™æ€å’Œå…¨å±€å¯¹è±¡åœ¨exité€€å‡ºmainæ—¶è‡ªåŠ¨æ‰§è¡Œæ”¶å·¥å‡½æ•°ææ„.</strong></p></li><li><p>labort é€€å‡ºï¼šæ‰€æœ‰å¯¹è±¡è‡ªåŠ¨è°ƒç”¨çš„ææ„å‡½æ•°éƒ½ä¸èƒ½æ‰§è¡Œã€‚å±€éƒ¨å’Œå…¨å±€å¯¹è±¡çš„èµ„æºéƒ½ä¸èƒ½è¢«é‡Šæ”¾ï¼Œå³aborté€€å‡ºmainåä¸æ‰§è¡Œæ”¶å·¥å‡½æ•°ã€‚</p></li><li><p>return è¿”å›ï¼šéšå¼è°ƒç”¨çš„ææ„å‡½æ•°å¾—ä»¥æ‰§è¡Œã€‚å±€éƒ¨å’Œå…¨å±€å¯¹è±¡çš„èµ„æºè¢«é‡Šæ”¾ã€‚</p></li><li><p>æ‰€ä»¥æˆ‘ä»¬æå€¡ä½¿ç”¨returnï¼Œå¦‚æœä½¿ç”¨abortå’Œexité‚£ä¹ˆæˆ‘ä»¬ éœ€è¦æ˜¾å¼è°ƒç”¨ææ„å‡½æ•°ã€‚å¦å¤–ä½¿ç”¨å¼‚å¸¸å¤„ç†çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨çš„ææ„å‡½æ•°éƒ½ä¼šæ‰§è¡Œã€‚</p></li></ul><p>å…³äºä»¥ä¸Šå†…å®¹ï¼Œæˆ‘æƒ³æˆ‘ä»¬æœ‰å¿…è¦æ‹“å±•ä¸€ä¸‹äº†è§£ä¸€ä¸‹å…³äºautoå’Œé™æ€å˜é‡ç­‰çš„å†…å­˜åˆ†åŒºé—®é¢˜ã€‚æˆ‘ä»¬å¯ä»¥ç®€å•æ€»ç»“ä¸€ä¸‹å°±æ˜¯ï¼š</p><p>C++ä¸­ç±»çš„å˜é‡å¯ä»¥é€šè¿‡staticã€constã€static constæ¥ä¿®é¥°ï¼Œä¸åŒçš„ä¿®é¥°åœ¨ä¸åŒçš„æƒ…å†µä¸‹è¡¨ç¤ºä¸åŒçš„å«ä¹‰ã€‚</p><p>ç¨‹åºè¿è¡ŒæœŸé—´çš„å†…å­˜åˆ†åŒºï¼š<br>1.ä»£ç åŒºï¼šå­˜æ”¾CPUæŒ‡ä»¤ç ã€‚<br>2.å¸¸é‡åŒºï¼šå­˜æ”¾åªè¯»å¸¸é‡ï¼Œè¯¥åŒºåªè¯»ï¼Œä¸å¯å†™ã€‚<br>3.é™æ€åŒºï¼šå­˜æ”¾é™æ€å˜é‡ï¼Œè¯¥åŒºåœ¨ç¨‹åºç¼–è¯‘å®Œæˆåå°±å†³å®šäº†å…¶å¤§å°ï¼Œç¨‹åºè¿è¡ŒæœŸé—´è¯¥åŒºçš„å¤§å°ä¸ä¼šå˜ï¼Œè¯¥åŒºå¯è¯»å†™ã€‚<br>4.åŠ¨æ€åŒºï¼šåˆ†ä¸ºå †åŒºå’Œæ ˆåŒºï¼Œç¨‹åºè¿è¡ŒæœŸé—´å…¶å¤§å°å¤„äºåŠ¨æ€å˜åŒ–ä¸­ã€‚å¤„äºè¯¥åŒºçš„å˜é‡ä¹Ÿä¼šæ—¶è€Œè¢«åˆ›å»ºæ—¶è€Œè¢«é”€æ¯ã€‚</p><blockquote><p>æƒ³è¦æ›´åŠ è¯¦ç»†çš„äº†è§£ç¨‹åºæ˜¯æ€ä¹ˆåˆ†é…å†…å­˜çš„ï¼Œå¯ä»¥è¿›ä¸€æ­¥å»çœ‹ä¸€ä¸‹è¿™ä¹ˆå‡ ç¯‡æ–‡ç« ï¼Œè®²è§£çš„æ˜¯éå¸¸è¯¦ç»†çš„ï¼š</p><p><a href="https://blog.csdn.net/LYKXHTP/article/details/88877930" target="_blank" rel="noopener">https://blog.csdn.net/LYKXHTP/article/details/88877930</a></p><p><a href="https://blog.csdn.net/taoqick/article/details/22822681" target="_blank" rel="noopener">https://blog.csdn.net/taoqick/article/details/22822681</a> </p><p><a href="https://zhuanlan.zhihu.com/p/120997610" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/120997610</a></p></blockquote><p>å¦å¤–æˆ‘ä»¬çœ‹ä¸€ä¸‹æ€ä¹ˆæ­£ç¡®ä½¿ç”¨exitå’Œabort:</p><pre class="line-numbers language-c++"><code class="language-c++">//ä¾‹4.2æœ¬ä¾‹è¯´æ˜exitå’Œabortçš„æ­£ç¡®ä½¿ç”¨æ–¹æ³•ã€‚#include <process.h>#include â€œstring.cppâ€      //ä¸æå€¡è¿™æ ·includeï¼šå› ä¸ºstring.cppå†…æœ‰å‡½æ•°å®šä¹‰STRING x("global");    //è‡ªåŠ¨è°ƒç”¨æ„é€ å‡½æ•°åˆå§‹åŒ–xvoid main(void) {      short error = 0;      STRING y("local");    //è‡ªåŠ¨è°ƒç”¨æ„é€ å‡½æ•°åˆå§‹åŒ–y      switch(error) {      case  0: return;      //æ­£å¸¸è¿”å›æ—¶è‡ªåŠ¨ææ„ xã€y      case  1: y.~STRING( );    //ä¸ºé˜²å†…å­˜æ³„æ¼ï¼Œexité€€å‡ºå‰å¿…é¡»æ˜¾å¼ææ„ y                    exit(1);                  default: x.~STRING( );    //ä¸ºé˜²å†…å­˜æ³„æ¼ï¼Œaborté€€å‡ºå‰é¡»æ˜¾å¼ææ„ xã€y        y.~STRING( );         abort( );       }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å½“ç„¶å…³äºä»¥ä¸Šçš„ä¸å»ºè®®ä½¿ç”¨ <code>#include &quot;string.cpp&quot;</code>, è¿™æ˜¯æœ‰åŸå› çš„ ï¼Œé˜²æ­¢é‡å¤å®šä¹‰å‡½æ•°å¯¼è‡´é”™è¯¯ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹stackoverflowä¸Šé¢çš„ä¸€äº›ä»‹ç»ï¼š<a href="https://stackoverflow.com/questions/19547091/including-cpp-files" target="_blank" rel="noopener">https://stackoverflow.com/questions/19547091/including-cpp-files</a></p><h2 id="ç±»é»˜è®¤æ„é€ å‡½æ•°çš„åˆ é™¤ä¸ä½¿ç”¨"><a href="#ç±»é»˜è®¤æ„é€ å‡½æ•°çš„åˆ é™¤ä¸ä½¿ç”¨" class="headerlink" title="ç±»é»˜è®¤æ„é€ å‡½æ•°çš„åˆ é™¤ä¸ä½¿ç”¨"></a>ç±»é»˜è®¤æ„é€ å‡½æ•°çš„åˆ é™¤ä¸ä½¿ç”¨</h2><ul><li>å¦‚æœç±»ä¸­æ²¡æœ‰å®šä¹‰ä»»ä½•æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨ä¸­ä¼šè‡ªåŠ¨ç»™æˆ‘ä»¬çš„ç±»æä¾›ä¸€ä¸ªæ— å‚çš„æ„é€ å‡½æ•°ï¼Œå®é™…ä¸Šè¿™ä¸ªåˆå§‹åŒ–æ—¶ç©ºæ“ä½œï¼Œä»€ä¹ˆéƒ½ä¸ä¼šå‘ç”Ÿ ã€‚</li><li>åªè¦ç±»ä¸­å®šä¹‰æœ‰æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å°±ä¸ä¼šè‡ªåŠ¨æä¾›æ— å‚æ„é€ å‡½æ•°ã€‚</li><li>ä¸ç®¡ç±»Aæ˜¯å¦å®šä¹‰äº†æ„é€ å‡½æ•°ï¼ŒAç±»åªè¦æ²¡æœ‰å®šä¹‰å¸¦å¼•ç”¨å‚æ•° A &amp; çš„æ„é€ å‡½æ•° A(const A &amp;a) ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æä¾›è¯¥æ„é€ å‡½æ•° A(const A &amp;a)ï¼ˆåˆ©ç”¨æµ…æ‹·è´å®ç°è¯¥æ„é€ å‡½æ•°ï¼‰ã€‚</li><li>å¯ä»¥åˆ©ç”¨ defaultã€delete å¼ºåˆ¶è¯´æ˜æ¥å—ã€åˆ é™¤ç¼–è¯‘å™¨æä¾›çš„æ„é€ å‡½æ•°ï¼Œå¦‚ A() = defaultã€ A(const A &amp;a) = deleteã€‚</li></ul><p>æˆ‘ä»¬å¯ä»¥çœ‹ä¸€äº›å°ä¾‹å­ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">// ä¾‹4.4 ä½¿ç”¨deleteç¦æ­¢æ„é€ å‡½æ•°ä»¥åŠdefaultæ¥å—æ„é€ å‡½æ•°ã€‚struct A {    int x = 0;    A(int m): x(m) { }    A(const A &a) = default;   //æ¥å—ç¼–è¯‘ç”Ÿæˆçš„æ‹·è´æ„é€ å‡½æ•°A(const A &)};void main(void) {    A x(2);           //æ­£ç¡®ï¼šè°ƒç”¨ç¨‹åºå‘˜è‡ªå®šä¹‰çš„å•å‚æ„é€ å‡½æ•°A(int)    A y(x);           //æ­£ç¡®ï¼šè°ƒç”¨ç¼–è¯‘ç”Ÿæˆçš„æ‹·è´æ„é€ å‡½æ•°A(const A &)    A u;           //é”™è¯¯ï¼šè°ƒç”¨æ„é€ å‡½æ•°A( )ï¼Œç¼–è¯‘å™¨ä¸æä¾›ç¼ºçœçš„A( )ï¼ˆå› ä¸ºæœ‰åˆ«çš„æ„é€ å‡½æ•°ï¼‰    A v( );           //æ­£ç¡®ï¼šå£°æ˜ä¸€ä¸ªå‡½æ•°v( )ï¼Œå…¶è¿”å›ç±»å‹ä¸ºA}   //`A v( )` is equal to `extern  A v( )`<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦å¤–å¯ä»¥æƒ³ä¸€ä¸‹è¿™å‡ ä¸ªé—®é¢˜ï¼š</p><blockquote><p> (1) å¦‚æœåœ¨ç±»Aä¸­å¢åŠ ä¸€æ¡è¯­å¥ A() = defaultï¼Œç»“æœä¼šæ€æ ·ï¼Ÿ</p><p>(2) å¦‚æœåˆ é™¤ç±»Aä¸­çš„ A(const A &amp;a) = defaultï¼Œç»“æœä¼šæ€æ ·ï¼Ÿ</p><p>(3) å¦‚æœå°†Aä¸­çš„ A(const A &amp;a) = default å†™æˆ A(const A &amp;a) = delete ï¼Œç»“æœä¼šæ€æ ·ï¼Ÿ</p></blockquote><p>å¦å¤–æ³¨æ„ä¸€ä¸‹è¿™ä¸ªæ“ä½œæ˜¯é”™è¯¯çš„ ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">struct A {    int x=0;    A( ) = delete;} a;//é”™è¯¯ï¼šç¼–è¯‘å™¨æä¾›çš„æ— å‚æ„é€ å‡½æ•°è¢«åˆ é™¤äº†<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å„ä¸ªæˆå‘˜çš„è®¿é—®æƒé™"><a href="#å„ä¸ªæˆå‘˜çš„è®¿é—®æƒé™" class="headerlink" title="å„ä¸ªæˆå‘˜çš„è®¿é—®æƒé™"></a>å„ä¸ªæˆå‘˜çš„è®¿é—®æƒé™</h2><p>å°è£…æœºåˆ¶è§„å®šäº†æ•°æ®æˆå‘˜ã€å‡½æ•°æˆå‘˜ã€ç±»å‹æˆå‘˜ çš„è®¿é—®æƒé™ã€‚åŒ…æ‹¬ä¸‰ç±»ï¼š</p><ul><li><p>privateï¼šç§æœ‰æˆå‘˜ï¼Œæœ¬ç±»å‡½æ•°æˆå‘˜å¯ä»¥è®¿é—®ï¼›æ´¾ç”Ÿç±»å‡½æ•°æˆå‘˜ã€å…¶ä»–ç±»å‡½æ•°æˆå‘˜å’Œæ™®é€šå‡½æ•°éƒ½ä¸èƒ½è®¿é—®ã€‚</p></li><li><p>protectedï¼šä¿æŠ¤æˆå‘˜ï¼Œæœ¬ç±»å’Œæ´¾ç”Ÿç±»çš„å‡½æ•°æˆå‘˜å¯ä»¥è®¿é—®ï¼Œå…¶ä»–ç±»å‡½æ•°æˆå‘˜å’Œæ™®é€šå‡½æ•°éƒ½ä¸èƒ½è®¿é—®ã€‚</p></li><li><p>publicï¼šå…¬æœ‰æˆå‘˜ï¼Œä»»ä½•å‡½æ•°å‡å¯è®¿é—®ã€‚</p></li></ul><p><strong>ç±»çš„å‹å…ƒä¸å—è¿™äº›é™åˆ¶</strong>ï¼Œå¯ä»¥è®¿é—®ç±»çš„æ‰€æœ‰æˆå‘˜ã€‚å¦å¤–ï¼Œé€šè¿‡å¼ºåˆ¶ç±»å‹è½¬æ¢å¯çªç ´è®¿é—®æƒé™çš„é™åˆ¶ã€‚</p><p><strong>æ„é€ å‡½æ•°å’Œææ„å‡½æ•°å¯ä»¥å®šä¹‰ä¸ºä»»ä½•è®¿é—®æƒé™</strong>ã€‚ä¸èƒ½è®¿é—®æ„é€ å‡½æ•°åˆ™æ— æ³•ç”¨å…¶åˆå§‹åŒ–å¯¹è±¡ã€‚</p><p>å¯ä»¥ä»¥ä¸€ä¸ªä¾‹å­æ¥çœ‹ä¸€ä¸‹ ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">#include <iostream>class A {     int  x;      //ç§æœ‰ï¼Œåªèƒ½è¢«æœ¬ç±»çš„æˆå‘˜è®¿é—®     typedef char * POINTER1;public:         //å…¬æœ‰ï¼Œèƒ½è¢«ä»»ä½•å‡½æ•°ä½¿ç”¨     int y;protected:    //ä¿æŠ¤ï¼šåªèƒ½è¢«æœ¬ç±»åŠç»§æ‰¿ç±»çš„æˆå‘˜è®¿é—®     int z;public:         //å…¬æœ‰ï¼Œèƒ½è¢«ä»»ä½•å‡½æ•°ä½¿ç”¨     typedef char * POINTER2;     A(int x,int y,int z): x(x),y(y),z(z) {}     int sum() {           return x+y+z;     }};void main(void) {     A a(1,2,3);     std::cout << a.x;         //é”™ï¼šä¸èƒ½è®¿é—®ç§æœ‰æˆå‘˜     std::cout << a.y;         //å¯¹     std::cout << a.z;         //é”™ï¼šä¸èƒ½è®¿é—®ä¿æŠ¤æˆå‘˜     std::cout << a.sum();  //å¯¹     char s[] = "abcd";     A::POINTER1 p1 = s;    //é”™ï¼šç±»å‹A::POINTER1æ˜¯ç§æœ‰çš„     A::POINTER2 p2 = s;  //å¯¹     p2 = "abcd";   //é”™ï¼š"abcd"æ˜¯const char *ï¼Œp2æ˜¯char *     p2 = (char *)"abcd";  //å¯¹ï¼Œç­‰ä»· p2 = (A::POINTER2)"abcd"}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å…³äºå¸¸é‡å­—ç¬¦ä¸²"><a href="#å…³äºå¸¸é‡å­—ç¬¦ä¸²" class="headerlink" title="å…³äºå¸¸é‡å­—ç¬¦ä¸²"></a>å…³äºå¸¸é‡å­—ç¬¦ä¸²</h2><p>å¸¸é‡å­—ç¬¦ä¸²ï¼ˆå¦‚â€œabcâ€ã€â€œ123ABâ€ç­‰ï¼‰æœ¬è´¨ä¸Šæ˜¯ const æŒ‡é’ˆï¼ˆchar *const pï¼‰ï¼Œ</p><p>å®ƒæŒ‡å‘ä¸€ä¸ªä¸å¯ä¿®æ”¹çš„å­—ç¬¦ä¸²ï¼ˆå³ const char *const pï¼‰ã€‚</p><p><strong>ä¸‹é¢çš„ä¾‹å­å¾ˆå€¼å¾—åå¤å“å‘³</strong></p><pre class="line-numbers language-c++"><code class="language-c++">int main(){    const char *const p1 = "abc";      //ç­‰ä»·ï¼šconst char *const p1("abc")    std::cout << "abc"[1] << p1[0];    p1 = â€œ123";                 //é”™    const char *p2 = "abc";            //ç­‰ä»·ï¼šconst char *p2("abc")    std::cout << "abc"[1] << p2[0];    p2 = â€œ123";                 //å¯¹    char *p3 = â€œabcâ€;        //é”™ï¼Œç­‰ä»· char *p3(â€œabcâ€)ï¼Œç”¨1ä¸ªconst charæŒ‡é’ˆå»æ„é€ charæŒ‡é’ˆ    char *p3 = (char *)"abc";        //ç­‰ä»·ï¼šchar *p3((char *)"abc")    std::cout << "abc"[1] << p3[0];    p3[0] = â€˜1â€™;            //ç¼–è¯‘å¯¹ï¼Œè¿è¡Œé”™    int  k = 1;            //ç­‰ä»·ï¼šint k(1)    char s[] = â€œabcâ€;           //å¯¹ï¼Œç­‰ä»· char s[]("abc")    char *p = â€œabcâ€;            //é”™ï¼Œç­‰ä»· char *p(â€œabcâ€)ï¼Œæ­£ç¡®çš„åº”è¯¥æ˜¯const char* p = â€œabcâ€}                //æ³¨æ„ï¼šæ„é€ æ•°ç»„å’Œæ„é€ æŒ‡é’ˆæ˜¯ä¸ä¸€æ ·çš„ï¼<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="new-and-delete"><a href="#new-and-delete" class="headerlink" title="new and delete"></a>new and delete</h3><h4 id="ç®€å•ä»‹ç»"><a href="#ç®€å•ä»‹ç»" class="headerlink" title="ç®€å•ä»‹ç»"></a>ç®€å•ä»‹ç»</h4><p>é¦–å…ˆä»‹ç»ä¸€ä¸‹å…³äºfree, malloc, new, delete:</p><ul><li>mallocä¸ºå‡½æ•°ï¼Œè´Ÿè´£åˆ†é…å †ç©ºé—´å†…å­˜ï¼Œåªåˆ†é…å†…å­˜ï¼Œä¸è°ƒç”¨æ„é€ å‡½æ•°æ„é€ å¯¹è±¡</li><li>freeä¹Ÿä¸ºå‡½æ•°ï¼Œè´Ÿè´£ é‡Šæ”¾å†…å­˜ï¼Œä½†æ˜¯åŒæ ·ä¸è°ƒç”¨ææ„å‡½æ•°ææ„å¯¹è±¡ã€‚æ‰€ä»¥ä»¥ä¸Šä¸¤è€…åœ¨ç±»å¯¹è±¡æœ‰æŒ‡é’ˆå¯¹è±¡çš„æ—¶å€™å®¹æ˜“å‘ç”Ÿå†…å­˜æ³„æ¼ã€‚</li><li>new<strong>ä¸ºè¿ç®—ç¬¦</strong>ï¼Œè´Ÿè´£åˆ†é…å¯¹è±¡å†…å­˜å¹¶åˆ†é…å†…å­˜ä¹‹åè°ƒç”¨æ„é€ å‡½æ•°æ„é€ å‡½æ•°ã€‚ç›¸å½“äºmalloc+è°ƒç”¨æ„é€ å‡½æ•°ã€‚</li><li>delete<strong>ä¸ºè¿ç®—ç¬¦</strong>ï¼Œè´Ÿè´£é‡Šæ”¾å†…å­˜ï¼Œé‡Šæ”¾å†…å­˜å‰è¿˜ä¼šè°ƒç”¨ææ„å‡½æ•°ææ„å¯¹è±¡ã€‚</li></ul><h4 id="å†…å­˜ç®¡ç†åŒºåˆ«"><a href="#å†…å­˜ç®¡ç†åŒºåˆ«" class="headerlink" title="å†…å­˜ç®¡ç†åŒºåˆ«"></a>å†…å­˜ç®¡ç†åŒºåˆ«</h4><ul><li>å†…å­˜ç®¡ç†çš„åŒºåˆ«ï¼š<ul><li>Cä¸å¿…å®ç°å‡½æ•° mallocã€freeï¼›C++å¿…é¡»å®ç°è¿ç®—ç¬¦ newã€deleteã€‚</li><li>å†…å­˜åˆ†é…ï¼šmallocä¸ºå‡½æ•°ï¼Œå‚æ•°ä¸ºå€¼è¡¨è¾¾å¼ï¼›newä¸ºè¿ç®—ç¬¦ï¼Œæ“ä½œæ•°ä¸ºç±»å‹è¡¨è¾¾å¼ï¼Œå…ˆåº•å±‚è°ƒç”¨mallocï¼Œç„¶åè°ƒç”¨æ„é€ å‡½æ•°ï¼›</li><li>ç”¨ â€œnew ç±»å‹è¡¨è¾¾å¼ { }â€ å¯ä½¿åˆ†é…çš„å†…å­˜æ¸…é›¶ï¼Œè‹¥â€œ{ }â€ä¸­æœ‰æ•°å€¼å¯ç”¨äºåˆå§‹åŒ–ã€‚ </li><li>å†…å­˜é‡Šæ”¾ï¼šfreeä¸ºå‡½æ•°ï¼Œå‚æ•°ä¸ºæŒ‡é’ˆç±»å‹å€¼è¡¨è¾¾å¼ï¼Œç›´æ¥é‡Šæ”¾å†…å­˜ï¼›deleteä¸ºè¿ç®—ç¬¦ï¼Œæ“ä½œæ•°ä¸ºæŒ‡é’ˆç±»å‹å€¼è¡¨è¾¾å¼ï¼Œå…ˆè°ƒç”¨ææ„å‡½æ•°ï¼Œç„¶ååº•å±‚è°ƒç”¨ freeã€‚</li><li>å¦‚ä¸ºç®€å•ç±»å‹(æ²¡æœ‰æ„é€ ã€ææ„å‡½æ•°)åˆ†é…å’Œé‡Šæ”¾å†…å­˜ï¼Œåˆ™newå’Œmallocã€ deleteå’Œfreeæ²¡æœ‰åŒºåˆ«ï¼Œå¯æ··åˆä½¿ç”¨ï¼šæ¯”å¦‚newåˆ†é…çš„å†…å­˜ç”¨freeé‡Šæ”¾ã€‚</li><li>æ— æ³•ç”¨mallocä»£æ›¿newåˆå§‹åŒ–, newè°ƒç”¨çš„æ„é€ å‡½æ•°å¯ç»´æŠ¤å¤šæ€ã€‚</li><li>æ³¨æ„deleteçš„æ–°å‚ç±»å‹åº”ä¸ºconst void *ï¼Œå› ä¸ºå®ƒå¯æ¥å—ä»»æ„æŒ‡é’ˆå®å‚</li></ul></li></ul><h4 id="å…·ä½“ç”¨æ³•"><a href="#å…·ä½“ç”¨æ³•" class="headerlink" title="å…·ä½“ç”¨æ³•"></a>å…·ä½“ç”¨æ³•</h4><p>ç®€å•çœ‹ä¸€ä¸‹newå’Œ deleteçš„åº”ç”¨ï¼š</p><p>new &lt;ç±»å‹è¡¨è¾¾å¼&gt;  åæ¥()æˆ–{}ç”¨äºåˆå§‹åŒ–æˆ–æ„é€ ã€‚{}å¯ç”¨äºæ•°ç»„å…ƒç´ </p><ul><li>ç±»å‹è¡¨è¾¾å¼ï¼šæ¯”å¦‚è¯´æˆ‘ä»¬å®šä¹‰int * p = new int; è¿™å°±ç­‰ä»·äº int * p = new int(0)</li><li>æ•°ç»„å½¢å¼ä»…ç¬¬ä¸€ç»´ä¸‹æ ‡å¯ä¸ºä»»æ„è¡¨è¾¾å¼ï¼Œå…¶ä»–ç»´å¿…é¡»æ˜¯å¸¸é‡è¡¨è¾¾å¼ï¼Œè¿™é‡Œä¸¾ä¸€ä¸ªå°ä¾‹å­ï¼šint (*q)[6][8]=new int[x+20][6][8];è¿™ä¸ªè¡¨è¾¾å¼ä»£è¡¨qæŒ‡å‘ä¸€ä¸ªintå‹å¤§å°ä¸º6Ã—8çš„æ•°ç»„ã€‚è¿™é‡Œç»™å®ƒåˆ†é…ç©ºé—´ä¸º[x+20][6][8]</li><li>ä¸ºå¯¹è±¡æ•°ç»„åˆ†é…å†…å­˜æ—¶ï¼Œå¿…é¡»è°ƒç”¨å‚æ•°æ— å‚æ„é€ å‡½æ•°</li></ul><p>delete &lt;æŒ‡é’ˆ&gt;</p><ul><li><strong>æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªéæ•°ç»„çš„å•ä¸ªå®ä½“</strong>ï¼Œ æ¯”å¦‚è¯´delete p;å¯èƒ½ä¼šè°ƒç”¨ææ„å‡½æ•°ï¼ˆåœ¨è¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå­˜åœ¨ææ„å‡½æ•°çš„æƒ…å†µä¸‹ï¼‰ï¼Œè€Œå¯¹äºæ•°ç»„å‹çš„åˆ é™¤åœ¨ä¸‹é¢è¯´ã€‚</li></ul><p>delete &lt;æ•°ç»„æŒ‡é’ˆ&gt;</p><ul><li>æŒ‡é’ˆæŒ‡å‘ä»»æ„ç»´çš„æ•°ç»„éƒ½ç›´æ¥delete [] qå°±OK</li><li>å¦‚ä¸ºå¯¹è±¡æ•°ç»„ï¼Œå¯¹æ‰€æœ‰å¯¹è±¡è°ƒç”¨ææ„å‡½æ•°ã€‚</li><li>å¦‚æœæ•°ç»„å…ƒç´ ä¸ºç®€å•ç±»å‹ï¼Œåˆ™å¯ä»¥ç”¨delete&lt;æŒ‡é’ˆ&gt;æ¥ä»£æ›¿ã€‚</li></ul><h4 id="ç‰¹æ®Šç”¨æ³•"><a href="#ç‰¹æ®Šç”¨æ³•" class="headerlink" title="ç‰¹æ®Šç”¨æ³•"></a>ç‰¹æ®Šç”¨æ³•</h4><ul><li>new è¿˜å¯ä»¥å¯¹å·²ç»ææ„çš„å˜é‡é‡æ–°æ„é€ ã€‚å¯ä»¥å‡å°‘å¯¹è±¡çš„è¯´æ˜ä¸ªæ•°ï¼Œæé«˜å†…å­˜çš„ä½¿ç”¨æ•ˆç‡ã€‚<strong>(ä¸æ˜¯æ‰€æœ‰C++ç¼–è¯‘å™¨éƒ½æ”¯æŒ)</strong></li></ul><pre class="line-numbers language-c++"><code class="language-c++"> STRING x ("Hello!"), *p = &x; x. ~STRING ( ); new (&x) STRING ("The World"); new (p) STRING ("The World");<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>è¿™ç§ç”¨æ³•å¯ä»¥èŠ‚çœå†…å­˜æˆ–æ ˆçš„ç©ºé—´ã€‚ </li></ul><h3 id="Hidden-parameters-this"><a href="#Hidden-parameters-this" class="headerlink" title="Hidden parameters: this"></a>Hidden parameters: <strong>this</strong></h3><ul><li><p>thisæŒ‡é’ˆæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æŒ‡é’ˆï¼Œå®ƒæ˜¯æ™®é€šå‡½æ•°æˆå‘˜éšå«çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå…¶ç±»å‹æ˜¯æŒ‡å‘è¦è°ƒç”¨è¯¥å‡½æ•°æˆå‘˜çš„å¯¹è±¡çš„constæŒ‡é’ˆã€‚</p></li><li><p>å½“å¯¹è±¡è°ƒç”¨å‡½æ•°æˆå‘˜æ—¶ï¼Œå¯¹è±¡çš„åœ°å€ä½œä¸ºå‡½æ•°çš„ç¬¬ä¸€ä¸ªå®å‚é¦–å…ˆå‹æ ˆï¼Œé€šè¿‡è¿™ç§æ–¹å¼å°†å¯¹è±¡åœ°å€ä¼ é€’ç»™éšå«å‚æ•°thisã€‚</p></li><li><p>æ„é€ å‡½æ•°å’Œææ„å‡½æ•°çš„thiså‚æ•°ç±»å‹å›ºå®šã€‚ä¾‹å¦‚A::~A()çš„thiså‚æ•°ç±»å‹ä¸ºA *const this; //ææ„å‡½æ•°çš„thisæŒ‡å‘å¯å†™å¯¹è±¡ï¼Œä½†thisæœ¬èº«æ˜¯åªè¯»çš„</p></li><li><p>æ³¨æ„ï¼šå¯ç”¨<em>thisæ¥å¼•ç”¨æˆ–è®¿é—®è°ƒç”¨è¯¥å‡½æ•°æˆå‘˜çš„æ™®é€šã€constæˆ–volatileå¯¹è±¡ï¼›ç±»çš„é™æ€å‡½æ•°æˆå‘˜æ²¡æœ‰éšå«çš„thisæŒ‡é’ˆï¼›this*</em>æŒ‡é’ˆä¸å…è®¸ç§»åŠ¨**ã€‚</p></li></ul><h3 id="å¯¹è±¡æ„é€ ä¸ææ„"><a href="#å¯¹è±¡æ„é€ ä¸ææ„" class="headerlink" title="å¯¹è±¡æ„é€ ä¸ææ„"></a>å¯¹è±¡æ„é€ ä¸ææ„</h3><ul><li><strong>æˆ‘ä»¬å®šä¹‰çš„ç±»ä¸­å«æœ‰åªè¯»å’Œå¼•ç”¨å®ä¾‹æ•°æ®æˆå‘˜çš„æ—¶å€™ï¼Œ å¦‚æœè¿™äº›åªè¯»å’Œå¼•ç”¨å®ä¾‹æ•°æ®æˆå‘˜ï¼Œå¹¶ä¸”Bç±»æ‰€æœ‰æ„é€ å‡½æ•°éƒ½å­˜åœ¨æ²¡æœ‰é»˜è®¤å€¼çš„å‚æ•°ï¼Œåˆ™ç±»Aå¿…é¡»è‡ªå®šä¹‰æ„é€ å‡½æ•°æ¥è°ƒç”¨ç±»Bçš„æœ‰å‚æ„é€ å‡½æ•°ã€‚</strong>ï¼Œ åªè¯»æˆå‘˜æ¯”å¦‚è¯´const int a; int const * p;è¿™ç±»ã€‚è€Œå…³äºå¼•ç”¨ç¤ºä¾‹æ•°æ®æˆå‘˜æ¯”å¦‚è¯´int&amp;Bç±»ä¼¼ï¼Ÿè¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆæˆ‘ä»¬åæ¥çš„ä¸€äº›åªè¯»å¯¹è±¡åªèƒ½åœ¨èŠ±æ‹¬å·{}å‰é¢ï¼Œå‡½æ•°å¤´åŠ ä¸€ä¸ªâ€œï¼šâ€åé¢è¿›è¡Œåˆå§‹åŒ–äº†ã€‚åªè¯»å’Œå¼•ç”¨æˆå‘˜ä¸å¯ä»¥åœ¨{}é‡Œé¢è¿›è¡Œèµ‹å€¼ã€‚</li><li>å¯¹äºåˆå§‹åŒ–é¡ºåºçš„é—®é¢˜ï¼Œå¯¹äºç»å¤§å¤šæ•°ç¼–è¯‘å™¨æ¥è¯´ï¼Œ<strong>åŸºç±»ä»¥åŠç¤ºä¾‹æ•°æ®æˆå‘˜æŒ‰ç…§å…¶åœ¨ç±»ä¸­å®šä¹‰çš„é¡ºåºåˆå§‹åŒ–è€Œä¸æ˜¯å‡ºç°åœ¨æ„é€ å‡½æ•°ä¸­èµ‹å€¼çš„é¡ºåºï¼</strong> å› æ­¤æœ‰è¿™ä¹ˆä¸€ç‚¹å»ºè®®ï¼Œæˆ‘ä»¬æœ€å¥½æŒ‰ç…§å…¬è®¤çš„åˆå§‹åŒ–é¡ºåºå¯¹è™šåŸºç±»ã€åŸºç±»å’Œæ˜¯å®ä¾‹æ•°æ®æˆå‘˜è¿›è¡Œåˆå§‹åŒ–ï¼Œä¼˜å…ˆçº§ï¼š<strong>è™šåŸºç±»é«˜äºåŸºç±»é«˜äºå®ä¾‹æ•°æ®æˆå‘˜</strong>ã€‚</li></ul><p><em>ä»¥ä¸Šä¸ºéœ€è¦æ³¨æ„çš„ç‚¹</em></p><p>æˆ‘ä»¬å¯ä»¥çœ‹ä¸ªä¾‹å­ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">// ã€ä¾‹4.17ã€‘åŒ…å«åªè¯»ã€å¼•ç”¨åŠå¯¹è±¡æˆå‘˜çš„ç±»ã€‚    class A {        int  a = 0;         //æ•°æ®æˆå‘˜å¯ä»¥åœ¨å®šä¹‰æ—¶åˆå§‹åŒ–    public:        A(int x) { a = x;}      //é‡è½½æ„é€ å‡½æ•°ï¼Œè‡ªåŠ¨å†…è”        A( ) { a = 0; }            //é‡è½½æ„é€ å‡½æ•°ï¼Œè‡ªåŠ¨å†…è”    };    class B {        const  int  b = 1;      //æ•°æ®æˆå‘˜å¯ä»¥åœ¨å®šä¹‰æ—¶åˆå§‹åŒ–        int  c, &d, e, f;     //b, d, g, håªèƒ½åœ¨æ„é€ å‡½æ•°ä½“å‰åˆå§‹åŒ–        A    g, h;     //æ•°æ®æˆå‘˜æŒ‰å®šä¹‰é¡ºåºb, c, d, e, f, g, håˆå§‹åŒ–public:  //ç±»Bæ„é€ å‡½æ•°ä½“å‰æœªå‡ºç°hï¼Œæ•…hç”¨A( )åˆå§‹åŒ–    B(int y): d(c), c(y), g(y) , b(y), e(y) {  //è‡ªåŠ¨å†…è”         c += y;                    f = y;     }  //fè¢«èµ‹å€¼ä¸ºy};void main(void) {    int x(5);                          //int x=5 ç­‰ä»·äº int x(5)    A a(x), y = 5;                       //A y=5 ç­‰ä»·äº A y(5)    A *p = new A[3] { 1, A(2) };  //åˆå§‹åŒ–çš„å…ƒç´ ä¸º A(1),  A(2), A(0)    B b(7),  z = (7, 8);                 //B z=(7, 8) ç­‰ä»·äº B z(8), ç­‰å·å³è¾¹å¿…å•å€¼    delete [ ] p;                     //é˜²æ­¢å†…å­˜æ³„æ¼ï¼šnew äº§ç”Ÿçš„æ‰€æœ‰å¯¹è±¡å¿…é¡»ç”¨ delete é‡Šæ”¾}                                             //æ•…(7, 8)ä¸ºCçš„æ‰©å·è¡¨è¾¾å¼ï¼Œ(7, 8) = 8<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»¥ä¸‹ä¸ºé‡‘è‰¯æµ·è€å¸ˆæ€»ç»“çš„çŸ¥è¯†ç‚¹ï¼š</p><ul><li><p>å¦‚æœªå®šä¹‰æˆ–ç”Ÿæˆæ„é€ å‡½æ•°ï¼Œåˆ™å¯ä»¥ç”¨â€{ }â€çš„å½¢å¼åˆå§‹åŒ–ã€‚è”åˆä»…éœ€åˆå§‹åŒ–ç¬¬ä¸€ä¸ªæˆå‘˜ã€‚</p></li><li><p>å¯¹è±¡æ•°ç»„çš„æ¯ä¸ªå…ƒç´ éƒ½å¿…é¡»åˆå§‹åŒ–ï¼Œé»˜è®¤é‡‡ç”¨æ— å‚æ„é€ å‡½æ•°åˆå§‹åŒ–ã€‚</p></li><li><p><strong>å•ä¸ªå‚æ•°çš„æ„é€ å‡½æ•°èƒ½è‡ªåŠ¨è½¬æ¢å•ä¸ªå®å‚å€¼æˆä¸ºå¯¹è±¡ã€‚</strong></p></li><li><p>è‹¥ç±»æœªè‡ªå®šä¹‰æ„é€ å‡½æ•°ï¼Œä¸”ç±»åŒ…å«ç§æœ‰å®ä¾‹æ•°æ®æˆå‘˜æ—¶ï¼Œç¼–è¯‘ä¼šè‡ªåŠ¨ç”Ÿæˆæ„é€ å‡½æ•°ã€‚</p></li><li><p>ä¸€æ—¦è‡ªå®šä¹‰æ„é€ å‡½æ•°ï¼Œå°†ä¸èƒ½æ¥å—ç¼–è¯‘ç”Ÿæˆçš„æ„é€ å‡½æ•°ï¼Œé™¤éç”¨defaultç­‰æ¥å—ã€‚</p></li><li><p>ç”¨å¸¸é‡å¯¹è±¡åšå®å‚ï¼Œæ€»æ˜¯ä¼˜å…ˆè°ƒç”¨å‚æ•°ä¸º&amp;&amp;ç±»å‹çš„æ„é€ å‡½æ•°ï¼›ç”¨å˜é‡å¯¹è±¡åšå®å‚ï¼Œæ€»æ˜¯ä¼˜å…ˆè°ƒç”¨å‚æ•°ä¸º&amp;ç±»å‹çš„æ„é€ å‡½æ•°ã€‚</p></li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/11/03/IKuvUU.png" alt="PPT by Lianghai King"></p><h1 id="Inline-anonymous-classes-and-bits"><a href="#Inline-anonymous-classes-and-bits" class="headerlink" title="Inline, anonymous classes and bits"></a>Inline, anonymous classes and bits</h1><p>å†…è”ã€åŒ¿åç±»åŠä½æ®µ</p><p>å†…è”æ¥çœ‹ï¼Œè¿™ä¸ªçŸ¥è¯†æœ¬èº«å¯èƒ½ç”¨å¤„å¹¶æ²¡æœ‰é‚£ä¹ˆå¤§ï¼Œä½†æ˜¯çŸ¥ä¹ä¸ŠæŸå¤§ä½¬è¯´å¾—å¥½ï¼š</p><blockquote><p>â€œå†…è”è¿™ä¸œè¥¿æœ€åè¿˜æ˜¯ç¼–è¯‘å™¨è¯´çš„ç®—ã€‚ä¸è¿‡ï¼Œåœ¨æ•´ä¸ªç ”ç©¶çš„è¿‡ç¨‹ï¼Œæˆ‘çŸ¥é“äº†æ€ä¹ˆåç¼–è¯‘è°ƒè¯•ï¼Œå‡½æ•°è°ƒç”¨ä¸å†…å­˜ã€å¯æ‰§è¡Œç¨‹åºçš„å…³ç³»ï¼Œç¼–è¯‘å™¨ç›¸å…³çš„çŸ¥è¯†ï¼Œä¸€äº›ä¸é”™çš„å·¥å…·ä¸å‚è€ƒèµ„æ–™ï¼Œå¦‚ä½•æ•´åˆçŸ¥è¯†ç‚¹ç­‰ï¼Œè¿™äº›è¿œæ¯”å†…è”è¿™ä¸ªçŸ¥è¯†ç‚¹æ›´é‡è¦ã€‚è€Œä¸”ï¼Œæ–‡ä¸­ä¹Ÿæåˆ°äº†inlineçš„ä½¿ç”¨åœºåˆä»¥åŠodrï¼Œç°åœ¨çš„æˆ‘é‡åˆ°inlineè¿™ä¸ªå…³é”®å­—èµ·ç ä¸ä¼šæ€‚äº†ã€‚â€</p></blockquote><p>è¿™é‡Œæœ‰å‡ ç¯‡å‚è€ƒé˜…è¯»çš„æ–‡ç« ï¼š</p><p><a href="https://zhuanlan.zhihu.com/p/50812510" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/50812510</a></p><p><a href="https://blog.csdn.net/zqixiao_09/article/details/50877383" target="_blank" rel="noopener">https://blog.csdn.net/zqixiao_09/article/details/50877383</a></p><p><a href="https://www.runoob.com/cplusplus/cpp-inline-functions.html" target="_blank" rel="noopener">https://www.runoob.com/cplusplus/cpp-inline-functions.html</a></p><p><del>æœ¬æ¬¡åšå®¢åˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘è¿˜è¦æ¶¦å»å­¦ç”µè·¯ç†è®ºå‘¢ğŸ˜­ğŸ˜­ğŸ˜­ğŸ˜­ğŸ˜­</del></p><p>2021.11.03æ›´æ–°</p><p>å†…è”å®é™…ä¸ŠçŸ¥è¯†ç‚¹å¹¶ä¸æ˜¯éå¸¸å¤æ‚ï¼Œ è¿™é‡Œå…ˆå°†å†…è”è€ƒè¯•è¦ç”¨çš„ä¸œè¥¿è¯´æ˜ä¸€ä¸‹ï¼Œæ¥ç€æ¥è¯´æ˜åº•å±‚ä¸€äº›åŸç†ã€‚</p><ol><li><p>å‡½æ•°æˆå‘˜çš„å†…è”è¯´æ˜ï¼š</p><ul><li>åœ¨ç±»ä½“å†…å®šä¹‰çš„ä»»ä½•å‡½æ•°æˆå‘˜éƒ½ä¼šè‡ªåŠ¨å†…è”</li><li>åœ¨ç±»å†…æˆ–ç±»å¤–ä½¿ç”¨inlineä¿ç•™å­—è¯´æ˜å‡½æ•°æˆå‘˜ã€‚</li></ul></li><li><p>å†…è”å¤±è´¥ï¼š </p><ul><li>æœ‰åˆ†æ”¯ç±»è¯­å¥</li><li>å®šä¹‰åœ¨ä½¿ç”¨å</li><li>å–å‡½æ•°åœ°å€</li><li>å®šä¹‰çº¯è™šå‡½æ•°</li></ul></li><li><p>å†…è”å‡½æ•°æˆå‘˜ä½œç”¨åŸŸå±€é™äºå½“å‰çš„ä»£ç æ–‡ä»¶</p></li><li><p>åŒ¿åç±»å‡½æ•°æˆå‘˜åªå¯ä»¥åœ¨ç±»ä½“å†…å®šä¹‰</p></li><li><p>å‡½æ•°å±€éƒ¨ç±»çš„æˆå‘˜åªèƒ½ åœ¨ç±»ä½“å†…å®šä¹‰ï¼ŒæŸäº›ç¼–è¯‘å™¨ä¸æ”¯æŒå±€éƒ¨ç±»ã€‚</p></li></ol><p>è¿™äº›çŸ¥è¯†ä¼¼ä¹éƒ½æ¯”è¾ƒå†·ï¼Œæš‚æ—¶æ²¡å…´è¶£çœ‹ï¼Œè¿‡æ®µæ—¶é—´å•ç‹¬å‚è€ƒä»¥ä¸Šåˆ—å‡ºåšå®¢å†™ä¸€ç¯‡å…³äºåº•å±‚å®ç°å†…è”çš„è¯´æ˜åšå®¢ã€‚</p><h1 id="member-function-pointer"><a href="#member-function-pointer" class="headerlink" title="member function pointer"></a>member function pointer</h1><p><em>ç±»æˆå‘˜æŒ‡é’ˆ</em></p><h2 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h2><ul><li>ç±»æˆå‘˜æŒ‡é’ˆï¼š<a href="https://zhuanlan.zhihu.com/p/367373924" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/367373924</a></li><li>ç±»æˆå‘˜å‡½æ•°æŒ‡é’ˆï¼š<a href="https://zh.wikipedia.org/wiki/%E7%B1%BB%E6%88%90%E5%91%98%E5%87%BD%E6%95%B0%E6%8C%87%E9%92%88" target="_blank" rel="noopener">https://zh.wikipedia.org/wiki/%E7%B1%BB%E6%88%90%E5%91%98%E5%87%BD%E6%95%B0%E6%8C%87%E9%92%88</a></li><li>C++ç±»æˆå‘˜æŒ‡é’ˆï¼š<a href="https://segmentfault.com/a/1190000022583207" target="_blank" rel="noopener">https://segmentfault.com/a/1190000022583207</a></li><li>ç±»æˆå‘˜å‡½æ•°æŒ‡é’ˆï¼š<a href="https://www.runoob.com/w3cnote/cpp-func-pointer.html" target="_blank" rel="noopener">https://www.runoob.com/w3cnote/cpp-func-pointer.html</a></li></ul><h2 id="Preface-1"><a href="#Preface-1" class="headerlink" title="Preface"></a>Preface</h2><p><em>â€œæŒ‡å‘ç±»æˆå‘˜çš„æŒ‡é’ˆâ€è¿™ä¸ªæè¿°ä¸­æœ‰â€œæŒ‡é’ˆâ€è¿™ä¸ªæœ¯è¯­ï¼Œå®ƒå…¶å®æ—¢ä¸åŒ…å«åœ°å€ï¼Œè¡Œä¸ºä¹Ÿä¸åƒæŒ‡é’ˆã€‚æ€ä¹ˆç†è§£å‘¢ï¼Ÿä¸å¸¸è§„æŒ‡é’ˆä¸åŒï¼Œä¸€ä¸ªæŒ‡å‘ç±»æˆå‘˜çš„æŒ‡é’ˆå¹¶ä¸æŒ‡å‘ä¸€ä¸ªå…·ä½“çš„å†…å­˜ä½ç½®ï¼Œå®ƒæŒ‡å‘çš„æ˜¯ä¸€ä¸ªç±»çš„ç‰¹å®šæˆå‘˜ï¼Œè€Œä¸æ˜¯æŒ‡å‘ä¸€ä¸ªç‰¹å®šå¯¹è±¡çš„ç‰¹å®šæˆå‘˜ã€‚é€šå¸¸æœ€æ¸…æ¥šçš„è¯´æ³•æ˜¯ï¼šæŠŠæ•°æ®æˆå‘˜çš„æŒ‡é’ˆçœ‹åšä¸ºä¸€ä¸ªåç§»é‡ï¼Œå®ƒå‘Šè¯‰ä½ ï¼Œ ä¸€ä¸ªç‰¹å®šæˆå‘˜çš„ä½ç½®è·ç¦»å¯¹åƒçš„èµ·ç‚¹æœ‰å¤šå°‘ä¸ªå­—èŠ‚ã€‚è€Œä¸”åœ¨å¤§å¤šæ•°ç¼–è¯‘å™¨ä¸­éƒ½æŠŠæ•°æ®æˆå‘˜çš„æŒ‡é’ˆå®ç°ä¸ºä¸€ä¸ªæ•´æ•°ï¼Œå…¶ä¸­åŒ…å«è¢«æŒ‡å‘æˆå‘˜çš„åç§»é‡ï¼Œå¦å¤–å†åŠ 1(è¿™é‡Œæ˜¯ä¸ºäº†è®©0å€¼ä¹Ÿå¯ä»¥è¡¨ç¤ºä¸€ä¸ªç©ºçš„æ•°æ®æˆå‘˜)ã€‚</em></p><p><em>å¦å¤– é™æ€æˆå‘˜å‡½æ•°å…¶å®è·Ÿæ™®é€šå‡½æ•°ä¸€æ ·ï¼Œæ‰€ä»¥è·Ÿç±»æˆå‘˜æŒ‡é’ˆæ— å…³ã€‚</em></p><pre class="line-numbers language-c++"><code class="language-c++">#include <iostream>using namespace std;class A{public:    int i = 12;    int AFun1(int c)    {        return i + c;    }    static int AStaticFun()    {        return 12;    }};int main(){    int A::*p = &A::i;             //påªæ˜¯è¡¨ç¤ºAç±»ä¸­iå­—æ®µçš„ä½ç½®ã€‚æ˜¯ç±»çš„ä½ç½®ï¼Œè·Ÿå¯¹è±¡æ— å…³ï¼Œæ‰€ä»¥pè¿˜å¹¶æ²¡æŒ‡å‘ä»»ä½•å†…å­˜    int (A::*fp)(int) = &A::AFun1; //fpæŒ‡å‘äº†æˆå‘˜å‡½æ•°AFun1,ä½†æ˜¯æˆå‘˜å‡½æ•°å¾—éœ€è¦å¯¹è±¡æ‰èƒ½è°ƒç”¨ã€‚    int (*sfp)() = &A::AStaticFun; //è·Ÿæ™®é€šå‡½æ•°æŒ‡é’ˆä¸€æ ·    A a;    cout << *p;         //é”™è¯¯ï¼Œpå¹¶æ²¡æŒ‡å‘ä»»ä½•å†…å­˜    cout << (*fp)();    //é”™è¯¯ï¼Œfpç¡®å®æŒ‡å‘æˆå‘˜å‡½æ•°ï¼Œä½†æ˜¯è°ƒç”¨æˆå‘˜å‡½æ•°éœ€è¦å¯¹è±¡æ¥è°ƒç”¨    cout << a.*p;       //"12" æ­£ç¡®    cout << (a.*fp)(8); //"20" 12+8 æ­£ç¡®    cout << (*sfp)();   //"12" æ­£ç¡®    return 0;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªç›®å‰ç”¨å¤„æ²¡æœ‰é‚£ä¹ˆå¤§ï¼Œä½†æ˜¯åœ¨ä¸€äº›äº‹ä»¶é©±åŠ¨å’Œå¤šçº¿ç¨‹åº”ç”¨è¢«å¹¿æ³›ç”¨äºè°ƒå›å›è°ƒå‡½æ•°ã€‚</p><p>ä¸‹é¢è¯¦ç»†è§£é‡Šä¸€ä¸‹ï¼š</p><h2 id="å®ä¾‹æˆå‘˜æŒ‡é’ˆ"><a href="#å®ä¾‹æˆå‘˜æŒ‡é’ˆ" class="headerlink" title="å®ä¾‹æˆå‘˜æŒ‡é’ˆ"></a>å®ä¾‹æˆå‘˜æŒ‡é’ˆ</h2><ul><li><p><strong>å®ä¾‹æˆå‘˜æŒ‡é’ˆæ˜¯æˆå‘˜ç›¸å¯¹äºå¯¹è±¡é¦–åœ°å€çš„åç§»</strong>ï¼Œä¸æ˜¯çœŸæ­£ä»£è¡¨åœ°å€çš„æŒ‡é’ˆã€‚ä»–ä¸ä¼šæŒ‡å‘ä»»ä½•åœ°å€ã€‚</p></li><li><p><strong>å®ä¾‹æˆå‘˜æŒ‡é’ˆä¸èƒ½ç§»åŠ¨</strong>ï¼š</p><ul><li>æ•°æ®æˆå‘˜çš„å¤§å°å’Œç±»å‹ä¸ä¸€å®šç›¸åŒï¼Œç§»åŠ¨åæŒ‡å‘çš„å†…å­˜å¯èƒ½æ˜¯æŸä¸ªæˆå‘˜çš„ä¸€éƒ¨åˆ†ï¼Œæˆ–è€…è·¨è¶Šä¸¤ä¸ªï¼ˆæˆ–ä»¥ä¸Šï¼‰æˆå‘˜çš„å†…å­˜ï¼›</li><li>å³ä½¿ç§»åŠ¨å‰åæŒ‡å‘çš„æˆå‘˜çš„ç±»å‹æ­£å¥½ç›¸åŒï¼Œè¿™ä¸¤ä¸ªæˆå‘˜çš„è®¿é—®æƒé™æœ‰å¯èƒ½ä¸åŒï¼Œç§»åŠ¨åå¯èƒ½å‡ºç°è¶Šæƒè®¿é—®é—®é¢˜ã€‚</li></ul></li><li><p><strong>å®ä¾‹æˆå‘˜æŒ‡é’ˆä¸èƒ½è½¬æ¢ç±»å‹</strong>ï¼Œ å¦åˆ™å¯ä»¥é€šè¿‡ç±»å‹è½¬æ¢é—´æ¥å®ç°å®ä¾‹æˆå‘˜æŒ‡é’ˆç§»åŠ¨ã€‚</p></li></ul><p>ã€ä¾‹5.2ã€‘æœ¬ä¾‹è¯´æ˜æ™®é€šæˆå‘˜æŒ‡é’ˆä¸èƒ½ç§»åŠ¨ã€‚</p><pre class="line-numbers language-c++"><code class="language-c++">#include <iostream>using namespace std;struct A{    int i; //å…¬æœ‰çš„æˆå‘˜iprivate:    long j;public:    int f()    {        cout << "f() ";        return 1;    }    static int h(){cout<<"h()"<<endl;return 0;}private:    void g() { cout << "g() "; }} a;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-c++"><code class="language-c++">void main(void) {    int  A::*pi = &A::i;         //æ™®é€šæ•°æ®æˆå‘˜æŒ‡é’ˆpiæŒ‡å‘publicæˆå‘˜A::i    int (A::*pf)( ) = &A::f;    //æ™®é€šå‡½æ•°æˆå‘˜æŒ‡é’ˆpfæŒ‡å‘å‡½æ•°æˆå‘˜A::f    int  x = a.*pi;              //ç­‰ä»·äº x=a.*(&A::i) = a.A::i = a.i    x = (a.*pf)( );               //.*çš„ä¼˜å…ˆçº§ä½ï¼Œæ•…ç”¨(a.*pf)    pi++;                    //é”™è¯¯ï¼Œ piä¸èƒ½ç§»åŠ¨ï¼Œå¦åˆ™æŒ‡å‘ç§æœ‰æˆå‘˜j    pf += 1;              //é”™è¯¯ï¼Œ pfä¸èƒ½ç§»åŠ¨    long y = (long) pi;     //é”™è¯¯ï¼Œpiä¸èƒ½è½¬æ¢ä¸ºé•¿æ•´å‹    x = x+ sizeof(int)             //å¯¹    pi = (int A::*)x;    //é”™è¯¯ï¼Œxä¸èƒ½è½¬æ¢ä¸ºæˆå‘˜æŒ‡é’ˆ}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-c++"><code class="language-c++">int main(){    A a;    int A:: * p = &A::i; // æˆå‘˜æŒ‡é’ˆï¼ŒæŒ‡å‘æˆå‘˜å˜é‡i    int (A::*q)() = &A::f;  // æˆå‘˜æŒ‡é’ˆï¼ŒæŒ‡å‘æˆå‘˜å‡½æ•°f()    int (*t)() = &A::h;  // éæˆå‘˜æŒ‡é’ˆï¼Œä»…ä»…æŒ‡å‘æ™®é€šçš„å‡½æ•°ã€‚    (a.*q)(); // æ³¨æ„è°ƒç”¨æ—¶.*è¿™ä¸ªç¬¦å·ä¼˜å…ˆçº§æ¯”è¾ƒä½æ‰€ä»¥è¦åŠ ä¸€ä¸ªæ‹¬å·ã€‚å¦å¤–æ³¨æ„éœ€è¦å€ŸåŠ©äºç‰¹å®šçš„å®ä¾‹æ¥è¿›è¡Œç›¸å…³çš„è°ƒç”¨ï¼    (*t)(); // æ™®é€šå‡½æ•°çš„è°ƒç”¨ç›´æ¥è°ƒç”¨å°±è¡Œï¼Œä¸éœ€è¦å€ŸåŠ©å®ä¾‹    return 0;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="constã€volatileã€mutable"><a href="#constã€volatileã€mutable" class="headerlink" title="constã€volatileã€mutable"></a>constã€volatileã€mutable</h1><h2 id="preface"><a href="#preface" class="headerlink" title="preface"></a>preface</h2><ul><li><p>const åªè¯»ï¼Œvolatile æ˜“å˜ï¼Œmutable æœºåŠ¨ã€‚</p></li><li><p>const å’Œ volatile å¯ä»¥å®šä¹‰å˜é‡ã€ç±»çš„æ•°æ®æˆå‘˜ã€å‡½æ•°æˆå‘˜åŠæ™®é€šå‡½æ•°çš„å‚æ•°å’Œè¿”å›ç±»å‹ã€‚</p></li><li><p>mutable åªèƒ½ç”¨æ¥å®šä¹‰ç±»çš„æ•°æ®æˆå‘˜ã€‚</p></li><li><p><strong>å«constå®ä¾‹æ•°æ®æˆå‘˜çš„ç±»å¿…é¡»å®šä¹‰æ„é€ å‡½æ•°</strong> (å¦‚æœconstå®ä¾‹æ•°æ®æˆå‘˜æ²¡æœ‰è®¾å®šç¼ºçœå€¼)ï¼Œä¸”æ•°æ®æˆå‘˜å¿…é¡»åœ¨æ„é€ å‡½æ•°å‚æ•°è¡¨ä¹‹åï¼Œå‡½æ•°ä½“ä¹‹å‰åˆå§‹åŒ–ã€‚</p></li><li><p><strong>å« volatileã€mutable æ•°æ®æˆå‘˜çš„ç±»åˆ™ä¸ä¸€å®šéœ€è¦å®šä¹‰æ„é€ å‡½æ•°ã€‚</strong></p></li></ul><pre class="line-numbers language-c++"><code class="language-c++">//ã€ä¾‹5. 3ã€‘å®šä¹‰å¯¼å¸ˆç±»ï¼Œå…è®¸æ”¹åä½†ä¸å…è®¸æ”¹æ€§åˆ«ã€‚#include <string.h>#include <iostream>using namespace std;class TUTOR{    char name[20];    const char sex; //æ€§åˆ«ä¸ºåªè¯»æˆå‘˜    int salary;public:    TUTOR(const char *name, const TUTOR *t);    TUTOR(const char *name, char gender, int salary);    const char *getname() { return name; }    char *setname(const char *name);};TUTOR::TUTOR(const char *n, const TUTOR *t) : sex(t->sex){    strcpy(name, n);    salary = t->salary;} //åªè¯»æˆå‘˜sexå¿…é¡»åœ¨æ„é€ å‡½æ•°ä½“ä¹‹å‰åˆå§‹åŒ–TUTOR::TUTOR(const char *n, char g, int s) : sex(g){    salary = s;    strcpy(name, n);} //éåªè¯»æˆå‘˜sarlaryå¯åœ¨å‡½æ•°ä½“å‰åˆå§‹åŒ–ï¼Œä¹Ÿå¯åœ¨ä½“å†…å†æ¬¡èµ‹å€¼char *TUTOR::setname(const char *n){    return strcpy(name, n); //strcpyçš„è¿”å›å€¼ä¸ºname}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-c++"><code class="language-c++">int main(void){    TUTOR wang("wang", 'F', 2000);    TUTOR yang("yang", &wang);    // *wang.getname() = â€˜Wâ€™; //é”™è¯¯:ä¸èƒ½æ”¹wang.getname( )æŒ‡çš„å­—ç¬¦    *yang.setname("Zang") = 'Y';    return 0;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="then"><a href="#then" class="headerlink" title="then"></a>then</h2><ul><li><p>æ™®é€šå‡½æ•°æˆå‘˜å‚æ•°è¡¨åå‡ºç°constæˆ–volatileï¼Œä¿®é¥°thisæŒ‡å‘çš„å¯¹è±¡ã€‚å‡ºç°constè¡¨ç¤ºthisæŒ‡å‘çš„å¯¹è±¡(å…¶éé™æ€æ•°æ®æˆå‘˜)ä¸èƒ½è¢«å‡½æ•°ä¿®æ”¹ï¼Œä½†å¯ä»¥ä¿®æ”¹thisæŒ‡å‘å¯¹è±¡çš„éåªè¯»ç±»å‹çš„é™æ€æ•°æ®æˆå‘˜ã€‚</p></li><li><p>æ„é€ æˆ–ææ„å‡½æ•°çš„thisä¸èƒ½è¢«è¯´æ˜ä¸º const æˆ– volatile çš„ (å³è¦æ„é€ æˆ–ææ„çš„å¯¹è±¡åº”è¯¥èƒ½è¢«ä¿®æ”¹ï¼Œä¸”çŠ¶æ€è¦ç¨³å®šä¸æ˜“å˜)ã€‚</p></li><li><p>å¯¹éšå«å‚æ•°çš„ä¿®é¥°è¿˜ä¼šä¼šå½±å“å‡½æ•°æˆå‘˜çš„é‡è½½ï¼š</p></li><li><p>æ™®é€šå¯¹è±¡åº”è°ƒç”¨å‚æ•°è¡¨åä¸å¸¦ const å’Œ volatile çš„å‡½æ•°æˆå‘˜ï¼›</p></li><li><p>const å’Œ volatile å¯¹è±¡åº”åˆ†åˆ«è°ƒç”¨å‚æ•°è¡¨åå‡ºç°constå’Œvolatileçš„å‡½æ•°æˆå‘˜ï¼Œå¦åˆ™ç¼–è¯‘ç¨‹åºä¼šå¯¹å‡½æ•°è°ƒç”¨å‘å‡ºè­¦å‘Šã€‚</p></li></ul><pre class="line-numbers language-c++"><code class="language-c++">//ã€ä¾‹5.4ã€‘å‚æ•°è¡¨åå‡ºç°constå’Œvolatileã€‚#include <iostream>usnig namespace std;class A{    int a;    const int b; //båªèƒ½åœ¨æ„é€ å‡½æ•°åˆå§‹åŒ–public:    int f()    {        a++;      //thisç±»å‹ä¸º A * const  this, æŒ‡å‘çš„        return a; //å¯¹è±¡å¯ä¿®æ”¹(æ•…å…¶æ™®é€šæˆå‘˜aå¯ä¿®æ”¹)ï¼Œåªè¯»æˆå‘˜bä¸å¯æ”¹    }    int f() const    {             //a++;     //thisç±»å‹ä¸ºconst A * const  thisï¼ŒæŒ‡å‘çš„å¯¹è±¡        return a; //ä¸å¯æ”¹ï¼Œå…¶æ™®é€šæˆå‘˜aä¸å¯æ”¹ã€‚åŒä¸Š, bä¸å¯æ”¹    }    int f() volatile    {        //thisç±»å‹ä¸ºvolatile A * const thisï¼ŒæŒ‡å‘çš„å¯¹è±¡å¯ä¿®æ”¹ï¼Œ        a++; //å…¶æ™®é€šæˆå‘˜aå¯ä¿®æ”¹ã€‚åªè¯»æˆå‘˜bä¸å¯æ”¹        return a;    }    int f() const volatile    { //thisç±»å‹ä¸ºconst volatile A* const thisï¼Œ        //a++;                        //ä¸èƒ½ä¿®æ”¹æ™®é€šæˆå‘˜aã€‚åŒä¸Šï¼Œåªè¯»æˆå‘˜bä¸å¯æ”¹        return a;    }    A(int x)    ï¼šb(x) { a = x; }} x(3);                //ç­‰ä»·äºA  x(3), xå¯ä¿®æ”¹,const A y(6);          // yã€zä¸å¯æ”¹const volatile A z(8); // xã€yã€zç”±startupå‡½æ•°æ„é€ ã€terminateå‡½æ•°ææ„int main(void){    x.f(); //æ™®é€šå¯¹è±¡xè°ƒç”¨int f( ): æŒ‡å‘çš„å¯¹è±¡å¯ä¿®æ”¹    y.f(); //åªè¯»å¯¹è±¡yè°ƒç”¨int f( ) const:æŒ‡å‘çš„å¯¹è±¡ä¸å¯ä¿®æ”¹    z.f(); //åªè¯»æ˜“å˜å¯¹è±¡zè°ƒç”¨int f( ) const volatile    return 0;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„ä¸åŒçš„å®šä¹‰è¿™é‡Œæ”¹å˜çš„æ˜¯æˆ‘ä»¬çš„thisæŒ‡é’ˆçš„ç±»å‹ä»è€Œå¯¼è‡´thisæŒ‡é’ˆæŒ‡å‘å¯¹è±¡çš„ç±»å‹æ”¹å˜ï¼ˆå®é™…ä¸Šæ˜¯thisæŒ‡é’ˆç±»å‹çš„æ”¹å˜å¯¼è‡´æˆ‘ä»¬æ— æ³•æ›´æ”¹å…¶æŒ‡å‘å†…å®¹çš„å€¼ï¼‰ã€‚</p><h2 id="Parallel"><a href="#Parallel" class="headerlink" title="Parallel"></a>Parallel</h2><p>è¿˜æ˜¯å€¼å¾—ä½œä¸ºä¸€ä¸ªçŸ¥è¯†ç‚¹æ¥ç†è§£çš„ã€‚å¯¹ä¹‹åå¹¶è¡Œæœ‰å¥½å¤„ã€‚</p><ul><li><p>å‡½æ•°æˆå‘˜å‚æ•°è¡¨åå‡ºç°volatileï¼Œå¸¸è¡¨ç¤ºè°ƒç”¨è¯¥å‡½æ•°æˆå‘˜çš„å¯¹è±¡æ˜¯æŒ¥å‘å¯¹è±¡ï¼Œè¿™é€šå¸¸æ„å‘³ç€å­˜åœ¨å¹¶å‘æ‰§è¡Œçš„è¿›ç¨‹ã€‚</p></li><li><p>C++ç¼–è¯‘ç¨‹åºå‡ ä¹éƒ½æ”¯æŒç¼–å†™å¹¶å‘è¿›ç¨‹ï¼Œç¼–è¯‘æ—¶ä¸å¯¹æŒ¥å‘å¯¹è±¡ä½œä»»ä½•è®¿é—®ä¼˜åŒ–ï¼Œå³ä¸åˆ©ç”¨å¯„å­˜å™¨å­˜æ”¾ä¸­é—´è®¡ç®—ç»“æœï¼Œè€Œæ˜¯ç›´æ¥è®¿é—®å¯¹è±¡å†…å­˜ä»¥ä¾¿è·å¾—å¯¹è±¡çš„æœ€æ–°å€¼ã€‚  </p></li><li><p>å‡½æ•°æˆå‘˜å‚æ•°è¡¨åå‡ºç° const æ—¶ï¼Œä¸èƒ½ä¿®æ”¹è°ƒç”¨å¯¹è±¡çš„éé™æ€æ•°æ®æˆå‘˜ï¼Œä½†å¦‚æœè¯¥æ•°æ®æˆå‘˜çš„å­˜å‚¨ç±»ä¸º mutableï¼Œåˆ™è¯¥æ•°æ®æˆå‘˜å°±å¯ä»¥è¢«ä¿®æ”¹ã€‚</p></li><li><p>mutable è¯´æ˜æ•°æ®æˆå‘˜ä¸ºæœºåŠ¨æ•°æ®æˆå‘˜ï¼Œè¯¥ç±»æˆå‘˜ä¸èƒ½ç”¨ constã€volatile æˆ– static ä¿®é¥°ã€‚ </p></li></ul><h2 id="amp-and-amp-amp"><a href="#amp-and-amp-amp" class="headerlink" title="&amp; and &amp;&amp;"></a>&amp; and &amp;&amp;</h2><p><em>æœ‰å€å¼•ç”¨å˜é‡å’Œæ— å€å¼•ç”¨å˜é‡ã€‚</em></p><ul><li><p>æœ‰å€å¼•ç”¨å˜é‡<strong>(&amp;)åªæ˜¯è¢«å¼•ç”¨å¯¹è±¡çš„åˆ«åï¼Œè¢«å¼•ç”¨å¯¹è±¡è‡ªå·±è´Ÿè´£æ„é€ å’Œææ„ï¼Œè¯¥å¼•ç”¨å˜é‡(é€»è¾‘ä¸Šä¸åˆ†é…å†…å­˜çš„å®ä½“)ä¸å¿…æ„é€ å’Œææ„ã€‚</strong></p></li><li><p>æ— å€å¼•ç”¨å˜é‡<strong>(&amp;&amp;)å¸¸ç”¨æ¥å¼•ç”¨ç¼“å­˜ä¸­çš„å¸¸é‡å¯¹è±¡ï¼Œè¯¥å¼•ç”¨å˜é‡(é€»è¾‘ä¸Šä¸åˆ†é…ç¼“å­˜çš„å®ä½“)ä¸å¿…æ„é€ å’Œææ„ã€‚æ— å€å¼•ç”¨å˜é‡å¯ä¸ºå·¦å€¼ï¼Œä½†è‹¥åŒæ—¶ç”¨constå®šä¹‰åˆ™ä¸ºä¼ ç»Ÿå³å€¼ã€‚</strong></p></li><li><p>å¦‚æœ<strong>Aç±»å‹çš„æœ‰å€å¼•ç”¨å˜é‡rå¼•ç”¨äº†newç”Ÿæˆçš„(ä¸€å®šæœ‰å€çš„ï¼‰å¯¹è±¡xï¼Œåˆ™åº”ä½¿ç”¨delete &amp;rææ„xï¼ŒåŒæ—¶é‡Šæ”¾å…¶æ‰€å å†…å­˜ã€‚</strong></p></li><li><p>r.~A<strong>( )ä»…ææ„xè€Œä¸é‡Šæ”¾å…¶æ‰€å å†…å­˜(ç”±newåˆ†é…)ï¼Œé€ æˆå†…å­˜æ³„æ¼ã€‚åº”è¯¥ç”¨</strong> delete &r;</p></li><li><p><strong>å¼•ç”¨å˜é‡å¿…é¡»åœ¨å®šä¹‰çš„åŒæ—¶åˆå§‹åŒ–</strong>ï¼Œå¼•ç”¨å‚æ•°åˆ™åœ¨è°ƒç”¨å‡½æ•°æ—¶åˆå§‹åŒ–ã€‚æœ‰å€ä¼ ç»Ÿå·¦å€¼å¼•ç”¨å˜é‡å’Œå‚æ•°å¿…é¡»ç”¨åŒç±»å‹çš„å·¦å€¼è¡¨è¾¾å¼åˆå§‹åŒ–ã€‚</p></li></ul><h2 id="mutable"><a href="#mutable" class="headerlink" title="mutable"></a>mutable</h2><ul><li><p>mutable ä»…ç”¨äºè¯´æ˜å®ä¾‹æ•°æ®æˆå‘˜ä¸ºæœºåŠ¨æˆå‘˜ï¼Œ<strong>ä¸èƒ½ç”¨äºé™æ€æ•°æ®æˆå‘˜çš„ã€‚</strong></p></li><li><p>æ‰€è°“æœºåŠ¨æ˜¯æŒ‡åœ¨æ•´ä¸ªå¯¹è±¡ä¸ºåªè¯»çŠ¶æ€æ—¶ï¼Œå…¶æ¯ä¸ªæˆå‘˜ç†è®ºä¸Šéƒ½æ˜¯ä¸å¯å†™çš„ï¼Œä½†è‹¥æŸä¸ªæˆå‘˜æ˜¯<strong>mutableæˆå‘˜ï¼Œåˆ™è¯¥æˆå‘˜åœ¨æ­¤çŠ¶æ€æ˜¯å¯å†™çš„ã€‚</strong></p></li><li><p>ä¾‹å¦‚ï¼Œäº§å“å¯¹è±¡çš„ä¿¡æ¯åœ¨æŸ¥è¯¢æ—¶åº”å¤„äºåªè¯»çŠ¶æ€ï¼Œä½†æ˜¯å…¶æˆå‘˜â€œæŸ¥è¯¢æ¬¡æ•°â€åº”åœ¨æ­¤çŠ¶æ€å¯å†™ï¼Œæ•…å¯ä»¥å®šä¹‰ä¸ºâ€œæœºåŠ¨â€æˆå‘˜ã€‚</p></li><li><p>ä¿ç•™å­—<strong>mutableè¿˜å¯ç”¨äºå®šä¹‰Lambdaè¡¨è¾¾å¼çš„å‚æ•°åˆ—è¡¨æ˜¯å¦å…è®¸åœ¨Lambdaçš„è¡¨è¾¾å¼å†…ä¿®æ”¹æ•è·çš„å¤–éƒ¨çš„å‚æ•°åˆ—è¡¨çš„å€¼ã€‚</strong></p></li></ul><p>a very simple example:</p><pre class="line-numbers language-c++"><code class="language-c++">#include<iostream>using namespace std;class PRODUCT {    char *name;    //äº§å“åç§°    int  price;        //äº§å“ä»·æ ¼    int  quantity;    //äº§å“æ•°é‡    mutable int count;    //äº§å“æŸ¥è¯¢æ¬¡æ•°public:    PRODUCT(const char* n, int m, int p);    int buy(int money);    void get(int& p, int& q)const;    ~PRODUCT(void);};void PRODUCT::get(int &p, int &q) const {  //const  PRODUCT *const this    p = price;     q = quantity;   //å½“å‰å¯¹è±¡ä¸ºconstå¯¹è±¡ï¼Œæ•…å…¶æˆå‘˜ä¸èƒ½è¢«ä¿®æ”¹    count++;                        //ä½†countä¸ºmutableæˆå‘˜ï¼Œå¯ä»¥ä¿®æ”¹}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="Static-data-amp-amp-function-member"><a href="#Static-data-amp-amp-function-member" class="headerlink" title="Static data&amp;&amp;function member"></a>Static data&amp;&amp;function member</h1><h2 id="static-data-member"><a href="#static-data-member" class="headerlink" title="static data member"></a>static data member</h2><ul><li><p>é™æ€æ•°æ®æˆå‘˜æ˜¯ä½¿ç”¨staticè¯´æ˜æˆ–å®šä¹‰çš„ç±»çš„æ•°æ®æˆå‘˜ã€‚</p></li><li><p>é™æ€æ•°æ®æˆå‘˜é€šå¸¸åœ¨ç±»çš„é‡Œé¢è¯´æ˜ï¼Œåœ¨ç±»çš„å¤–é¢å”¯ä¸€å®šä¹‰ä¸€æ¬¡ã€‚</p></li><li><p>é™æ€æ•°æ®æˆå‘˜ä¸€èˆ¬ç”¨æ¥æè¿°ç±»çš„æ€»ä½“ä¿¡æ¯ï¼Œä¾‹å¦‚å¯¹è±¡æ€»ä¸ªæ•°ã€‚</p></li><li><p>å®ä¾‹æ•°æ®æˆå‘˜å¯ä»¥å®šä¹‰é»˜è®¤å€¼ï¼Œä½†éconsté™æ€æ•°æ®æˆå‘˜ä¸èƒ½å®šä¹‰é»˜è®¤å€¼ã€‚</p></li><li><p>é™æ€æ•°æ®æˆå‘˜åœ¨ç±»ä¸­åˆå§‹åŒ–åªèƒ½å®šä¹‰ä¸º inline staticã€const staticã€const inline ç±»å‹ (ä¿ç•™å­—é¡ºåºå¯å˜ï¼‰ã€‚</p></li><li><p>é™æ€æ•°æ®æˆå‘˜ä¸ç®¡æ˜¯å¦ç”¨inlineã€constè¯´æ˜ï¼Œåœ¨æ‰€æœ‰ä»£ç æ–‡ä»¶åªæœ‰ä¸€ä¸ªå‰¯æœ¬ã€‚</p></li><li><p>å‡½æ•°ä¸­çš„å±€éƒ¨ç±»ä¸èƒ½å®šä¹‰é™æ€æ•°æ®æˆå‘˜ï¼Œå®¹æ˜“é€ æˆç”Ÿå‘½æœŸçŸ›ç›¾ã€‚</p></li><li><p>é™æ€æ•°æ®æˆå‘˜ä¸èƒ½å®šä¹‰ä¸ºä½æ®µæˆå‘˜ã€‚</p></li></ul><pre class="line-numbers language-c++"><code class="language-c++">ä¾‹5.9å‡½æ•°å±€éƒ¨ç±»ä¸èƒ½å®šä¹‰é™æ€æ•°æ®æˆå‘˜ï¼Œå…¨å±€ç±»å¯ä»¥å®šä¹‰ inline æˆ– const é™æ€æ•°æ®æˆå‘˜ã€‚int  x = 3;union  S {  //å®šä¹‰å±€éƒ¨ç±»T    const  static int b = 0;           //å…¨å±€ç±»ä¸­å¯ç”¨constå®šä¹‰åŒæ—¶åˆå§‹åŒ–é™æ€æˆå‘˜, å¿…é¡»ç”¨å¸¸é‡    inline  static int c = x;    //å…¨å±€ç±»å¯ç”¨inlineå®šä¹‰åŒæ—¶åˆå§‹åŒ–é™æ€æˆå‘˜, å¯ç”¨ä»»æ„è¡¨è¾¾å¼    inline  const static int d = x;  //å¯ç”¨ä»»æ„è¡¨è¾¾å¼    };void f(void) {    class  T {      //å®šä¹‰å‡½æ•°ä¸­çš„å±€éƒ¨ç±»T        int  c;        //static int d;   //é”™è¯¯ï¼šå‡½æ•°ä¸­çš„å±€éƒ¨ç±»ä¸èƒ½å®šä¹‰é™æ€æ•°æ®æˆå‘˜    };    T a;             //å±€éƒ¨è‡ªåŠ¨å˜é‡ a    static T s;      //å±€éƒ¨é™æ€å˜é‡ s}void main( ) {  f( ); f( );  }   //ç¬¬ä¸€ä¸ªå‡½æ•°è°ƒç”¨f( )è¿”å›å a.d â‡” s.d â‡” T::d äº§ç”Ÿç”ŸæˆçŸ›ç›¾<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="static-function-member"><a href="#static-function-member" class="headerlink" title="static function member"></a>static function member</h2><ul><li><p>é™æ€å‡½æ•°æˆå‘˜é€šå¸¸åœ¨ç±»é‡Œä»¥ static è¯´æ˜æˆ–å®šä¹‰ï¼Œå®ƒæ²¡æœ‰<strong>thiså‚æ•°ã€‚</strong></p></li><li><p>æœ‰<strong>thisçš„æ„é€ å’Œææ„å‡½æ•°ã€è™šå‡½æ•°åŠçº¯è™šå‡½æ•°éƒ½ä¸èƒ½å®šä¹‰ä¸ºé™æ€å‡½æ•°æˆå‘˜ã€‚</strong></p></li><li><p>é™æ€å‡½æ•°æˆå‘˜ä¸€èˆ¬ç”¨æ¥è®¿é—®ç±»çš„æ€»ä½“ä¿¡æ¯ï¼Œä¾‹å¦‚å¯¹è±¡æ€»ä¸ªæ•°ã€‚</p></li><li><p>é™æ€å‡½æ•°æˆå‘˜å¯ä»¥é‡è½½ã€å†…è”ã€å®šä¹‰é»˜è®¤å€¼å‚æ•°ã€‚</p></li><li><p>é™æ€å‡½æ•°æˆå‘˜åŒå®ä¾‹æˆå‘˜çš„ç»§æ‰¿ã€è®¿é—®è§„åˆ™æ²¡æœ‰æ²¡æœ‰å¤ªå¤§åŒºåˆ«ã€‚</p></li><li><p>é™æ€å‡½æ•°æˆå‘˜çš„<strong>å‚æ•°è¡¨åä¸èƒ½å‡ºç°</strong> const<strong>ã€volatileã€const volatile</strong> ç­‰ä¿®é¥°ç¬¦ã€‚</p></li><li><p>é™æ€å‡½æ•°æˆå‘˜çš„è¿”å›ç±»å‹å¯ä»¥åŒæ—¶ä½¿ç”¨ inline<strong>ã€constã€volatile</strong> ç­‰ä¿®é¥°ã€‚</p></li></ul><pre class="line-numbers language-c++"><code class="language-c++">class A {    double  i;    const static int  j=3;public:    static A &inc(A &);         //è¯´æ˜é™æ€å‡½æ•°æˆå‘˜    static A &dec(A &a) {   //åœ¨å†…ä½“å†…å®šä¹‰é™æ€å‡½æ•°æˆå‘˜ï¼šé»˜è®¤ä½¿ç”¨ inlinea.i = a.i - A::j;         return a;}};A &A::inc(A &a) {   //ä¸èƒ½ static A &A::inc(A &a),  why ?    a.i += A::j;              //é™æ€å‡½æ•°å¯è®¿é—®é™æ€æ•°æ®æˆå‘˜    return a;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="static-member-pointer"><a href="#static-member-pointer" class="headerlink" title="static member pointer"></a>static member pointer</h1><ul><li><p>é™æ€æˆå‘˜æŒ‡é’ˆæ˜¯æŒ‡å‘ç±»çš„é™æ€æˆå‘˜çš„æŒ‡é’ˆï¼ŒåŒ…æ‹¬é™æ€æ•°æ®æˆå‘˜æŒ‡é’ˆå’Œé™æ€å‡½æ•°æˆå‘˜æŒ‡é’ˆã€‚</p></li><li><p>é™æ€æ•°æ®æˆå‘˜çš„å­˜å‚¨å•å…ƒä¸ºè¯¥ç±»æ‰€æœ‰çš„å¯¹è±¡å…±äº«ï¼Œå› æ­¤ï¼Œé€šè¿‡è¯¥æŒ‡é’ˆä¿®æ”¹æˆå‘˜çš„å€¼æ—¶ä¼šå½±å“åˆ°æ‰€æœ‰å¯¹è±¡è¯¥æˆå‘˜çš„å€¼ã€‚ </p></li><li><p>é™æ€æ•°æ®æˆå‘˜é™¤äº†å…·æœ‰è®¿é—®æƒé™å¤–ï¼ŒåŒæ™®é€šå˜é‡æ²¡æœ‰æœ¬è´¨åŒºåˆ«ï¼›<strong>é™æ€æˆå‘˜æŒ‡é’ˆåˆ™å’Œæ™®é€šæŒ‡é’ˆæ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚</strong></p></li><li><p>å˜é‡ã€æ•°æ®æˆå‘˜ã€æ™®é€šå‡½æ•°å’Œå‡½æ•°æˆå‘˜çš„å‚æ•°å’Œè¿”å›å€¼éƒ½å¯ä»¥å®šä¹‰æˆé™æ€æˆå‘˜æŒ‡é’ˆã€‚</p></li></ul><p><a href="https://imagelol.com/image/IKYmQE" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/11/03/IKYmQE.png" alt></a></p><p><a href="https://imagelol.com/image/IKYpYQ" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/11/03/IKYpYQ.png" alt></a></p><p>2021.11.5æ—¥æ›´æ–°</p><hr><h1 id="é€šè¿‡å‡ é“ä½œä¸šé¢˜å¯¹ç±»æˆå‘˜æŒ‡é’ˆçš„ä¸€äº›æ€è€ƒ"><a href="#é€šè¿‡å‡ é“ä½œä¸šé¢˜å¯¹ç±»æˆå‘˜æŒ‡é’ˆçš„ä¸€äº›æ€è€ƒ" class="headerlink" title="é€šè¿‡å‡ é“ä½œä¸šé¢˜å¯¹ç±»æˆå‘˜æŒ‡é’ˆçš„ä¸€äº›æ€è€ƒ"></a>é€šè¿‡å‡ é“ä½œä¸šé¢˜å¯¹ç±»æˆå‘˜æŒ‡é’ˆçš„ä¸€äº›æ€è€ƒ</h1><p>ç”±äºæ˜¯å‡½æ•°æ•´ç†çš„é”™é¢˜ï¼Œæ‰€ä»¥å¯èƒ½æ•´ç†çš„ç¨å¾®æœ‰äº›ä¹±ï¼Œä¸è¿‡è¿™é‡Œé€‰æ‹©æŒ‰ç…§æ—¶é—´çº¿é¡ºåºæ¥è¿›è¡Œè§£é‡Šï¼š</p><p>é¦–å…ˆçœ‹ä»£ç ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">#include<iostream>using namespace std;class A{    static int *j, A::*a, i[5];public:    int x;    static int &k, *n;};int y = 0;int A::i[5] = {1, 2, 3};int *A::j = &y;int A::*j = &A::x;int A::*A::a = &A::x;int &A::k = y;int *A::n = &y;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªä»£ç æ˜¯å®Œå…¨æ²¡æœ‰é—®é¢˜çš„ã€‚æˆ‘ä»¬è¿™é‡Œå®šä¹‰äº†å¤§é‡é™æ€å˜é‡ï¼Œä¸‹é¢æˆ‘ä¸€ä¸€è§£æä¸€ä¸‹æ¯ä¸€è¡Œä»£ç ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">#include<iostream>using namespace std;class A{    static int *j, A::*a, i[5];  // jä¸ºstatic intå‹å˜é‡ï¼Œaä¸ºæŒ‡å‘static intç±»æˆå‘˜çš„æŒ‡é’ˆï¼Œiä¸ºä¸€ä¸ªé™æ€intå‹æ•°ç»„å…ƒç´ æ•°é‡ä¸º5.public:    int x;  // publicå‹æ™®é€šç±»æˆå‘˜ï¼Œ    static int &k, *n;  // k ä¸ºstatic intå‹å¼•ç”¨å˜é‡ï¼Œ nä¸ºæŒ‡å‘static int å‹çš„å˜é‡æŒ‡é’ˆã€‚};int y = 0;  // å®šä¹‰ä¸€ä¸ªæ–°çš„å˜é‡ï¼ˆéé™æ€å˜é‡ï¼Œä»…ä»…åœ¨å½“å‰æ–‡ä»¶æœ‰æ•ˆï¼‰int A::i[5] = {1, 2, 3};  // åˆå§‹åŒ–A::i[5]çš„ å‰3ä¸ªå…ƒç´ int *A::j = &y;  // åˆå§‹åŒ–ç±»å†…æ™®é€šæŒ‡å‘é™æ€intå‹æŒ‡é’ˆint A::*j = &A::x; // å®šä¹‰ä¸€ä¸ªæ–°çš„æŒ‡é’ˆï¼ï¼ï¼è¿™ä¸ªæŒ‡é’ˆä¸ºç±»æˆå‘˜æŒ‡é’ˆï¼ŒæŒ‡å‘Aç±»ä¸­çš„xæ™®é€šå¯¹è±¡int A::*A::a = &A::x;  // è¿™ä¸ªåº”è¯¥è¿™æ ·ç†è§£: (int A::*) (A::a), å¯ä»¥çœ‹åˆ°ï¼Œä¸ä¸Šé¢ä¸€è¡Œä»£ç ä¸åŒçš„ä¸€ç‚¹å°±åœ¨äºè¿™é‡Œç‰¹åˆ«æŒ‡å®šäº†Aï¼šï¼šaï¼Œè¿™ä¹Ÿå°±ä»£è¡¨æˆ‘ä»¬è¿™é‡Œå¹¶ä¸æ˜¯å®šä¹‰äº†ä¸€ä¸ªæ–°çš„å˜é‡ï¼Œè€Œæ˜¯ç±»å†…ç±»æˆå‘˜æŒ‡é’ˆå˜é‡çš„åˆå§‹åŒ–int &A::k = y; // è¿™é‡Œé¢åŒæ ·çš„ï¼š (int &) (A::k), ä»£è¡¨åˆå§‹åŒ–Aç±»å†…é™æ€æˆå‘˜ int *A::n = &y; // ä¸ä¸ŠåŒæ ·çš„ï¼Œ(int *) (A::n), ä»£è¡¨åˆå§‹åŒ–Aç±»å†…é™æ€æˆå‘˜ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„ï¼Œè¿™äº›åˆå§‹åŒ–æ“ä½œä¸å¯ä»¥åœ¨mainå‡½æ•°å†…æ‰§è¡Œï¼Œå› ä¸ºè¿™äº›éƒ½æ˜¯staticï¼Œæ‰€ä»¥å¯ä»¥åƒå®šä¹‰æ–°å˜é‡ä¸€æ ·æ¥åˆå§‹åŒ–è¿™äº›ç±»å†…é™æ€æˆå‘˜ï¼Œå½“ç„¶è¿™é‡Œçš„æ ¼å¼ä¹Ÿæ˜¯è¦æ ¼å¤–æ³¨æ„çš„ï¼Œéœ€è¦æœ‰ä¸€ä¸ª(A::)æ¥è¯´æ˜è¿™æ˜¯ä¸ªç±»å†…é™æ€å˜é‡çš„åˆå§‹åŒ–è€Œä¸æ˜¯æ–°å®šä¹‰äº†ä¸€ä¸ªå˜é‡ã€‚</p><p>æ¥ç€ï¼Œå¦‚æœè¿™äº›å˜é‡éƒ½ä¸æ˜¯é™æ€staticçš„é‚£åˆä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿ</p><p>æˆ‘åˆå†™åˆ°äº†ä¸€é“ç±»ä¼¼çš„é¢˜ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">// åˆ†æå¦‚ä¸‹å®šä¹‰æ˜¯å¦æ­£ç¡®ï¼Œå¹¶æŒ‡å‡ºé”™è¯¯åŸå› ã€‚struct A {     char *a, b, *geta( );  // ä¸€ä¸ªå­—ç¬¦æŒ‡é’ˆï¼Œä¸€ä¸ªå­—ç¬¦å˜é‡ï¼Œä¸€ä¸ªè¿”å›å€¼ä¸ºchar*ç±»å‹çš„æŒ‡é’ˆã€‚    char A::*p;     // æˆå‘˜å˜é‡æŒ‡é’ˆï¼ŒæŒ‡å‘charç±»å‹çš„ç±»Aæˆå‘˜    char *A::*q( );      char *(A::*r)( ); // æˆå‘˜å‡½æ•°æŒ‡é’ˆï¼ŒæŒ‡å‘è¿”å›å€¼ä¸ºchar* å‚æ•°ä¸ºç©ºçš„ç±»æˆå‘˜å‡½æ•°ã€‚}; int main(void) {     A a;     a.p = &A::a;      a.p = &A::b;      a.q = &A::geta;      a.r = a.geta;     a.r = &a.geta;    a.r = &A::geta;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å½“ç„¶ï¼Œè¿™ä¸ªä»£ç å°±å¾ˆæœ‰é—®é¢˜äº†ã€‚æˆ‘ä»¬å…ˆçœ‹ä»£ç çš„é—®é¢˜åœ¨å“ªé‡Œå†è¯´ä¸Šé¢æåˆ°çš„é—®é¢˜ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">#include <iostream>using namespace std;struct A{    char *a, b, *geta(); // ä¸€ä¸ªå­—ç¬¦æŒ‡é’ˆï¼Œä¸€ä¸ªå­—ç¬¦å˜é‡ï¼Œä¸€ä¸ªè¿”å›å€¼ä¸ºchar*ç±»å‹çš„æŒ‡é’ˆã€‚    char A::*p;          // æˆå‘˜å˜é‡æŒ‡é’ˆï¼ŒæŒ‡å‘charç±»å‹çš„ç±»Aæˆå‘˜    char *A::*q();       // æˆå‘˜æŒ‡é’ˆå‡½æ•°ï¼Œè¯¥å‡½æ•°è¿”å›å€¼ä¸ºchar* A::*ä¹Ÿå°±æ˜¯ä¸€ä¸ªAç±»æˆå‘˜æŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªchar*å‹çš„å¯¹è±¡    char *(A::*r)();     // æˆå‘˜å‡½æ•°æŒ‡é’ˆï¼ŒæŒ‡å‘è¿”å›å€¼ä¸ºchar* å‚æ•°ä¸ºç©ºçš„ç±»æˆå‘˜å‡½æ•°ã€‚};// char A::* (A::p) = &A::b;int main(void){    A a;            // æ­£ç¡®ï¼Œæ„é€ ç±»    a.p = &A::a;    // é”™è¯¯ï¼Œç±»å‹æ— æ³•å¯¹åº”ï¼ŒæŒ‡é’ˆåº”è¯¥ä¸åœ°å€å¯¹åº”è€Œä¸æ˜¯ä¸charå‹å¸¸é‡å¯¹åº”ã€‚    a.p = &A::b;    // æ­£ç¡®ã€‚    a.q = &A::geta; // é”™è¯¯ï¼Œç±»å‹ä¸å¯¹åº”ï¼Œqä¸ºä¸€ä¸ªå‡½æ•°è€Œä¸æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œä¸å¯¹åº”åœ°å€ã€‚    a.r = a.geta;   // é”™è¯¯ï¼ŒræŒ‡å‘ä¸€ä¸ªè¿”å›å€¼char*çš„æ— å‚Aç±»æˆå‘˜å‡½æ•°ï¼Œè¿™é‡Œé¢ç±»å‹ä¸å¯¹å¹¶ä¸”è¿™é‡Œä¸å¯ä»¥ä½¿ç”¨å¯¹è±¡çš„å®ä¾‹æ¥å–å€ï¼Œç±»æˆå‘˜æŒ‡é’ˆä¸å¯¹åº”å…·ä½“çš„åœ°å€    a.r = &a.geta;   // é”™è¯¯ï¼Œç±»æˆå‘˜æŒ‡é’ˆä¸å¯¹åº”å…·ä½“çš„åœ°å€ï¼Œå®ƒå¯¹åº”ä¸€ä¸ªç±»çš„æŠ½è±¡ç‰¹å®šæˆå‘˜ï¼Œè€Œä¸æ˜¯æ™®é€šæŒ‡é’ˆå¯¹åº”çš„åœ°å€ã€‚    a.r = &A::geta;  // æ­£ç¡®ã€‚    return 0;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œé¢è€ƒå¯Ÿçš„æœ‰æˆ‘ä»¬çš„ç±»æˆå‘˜æŒ‡é’ˆå®šä¹‰çš„æ—¶å€™ä¸èƒ½æŒ‡å‘å…·ä½“å®ä¾‹çš„æˆå‘˜åœ°å€ï¼Œä¹Ÿæœ‰è€ƒå¯ŸæŒ‡é’ˆä¸åœ°å€å¯¹åº”å…³ç³»ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å‘ç°è¿™é‡Œé¢æ­£ç¡®çš„å˜é‡å®šä¹‰æ˜¯å¯ä»¥å­˜åœ¨äºmainå‡½æ•°é‡Œé¢çš„ï¼Œå¹¶ä¸”è¿™é‡Œçš„èµ‹å€¼åˆå§‹åŒ–éƒ½æ˜¯ç›´æ¥æœ‰å…·ä½“å®ä¾‹è°ƒç”¨ç›¸å…³çš„æŒ‡é’ˆç„¶åå†è¿›è¡Œç›¸å…³çš„èµ‹å€¼ã€‚å°±æ¯”å¦‚è¿™ä¸€è¡Œä»£ç ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">a.p = &A::b //æ­£ç¡®<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬æƒ³ä½¿ç”¨ä¸Šæ–‡çš„è¿™ä¹ˆmainå‡½æ•°å‰é¢ä¸€è¡Œæ³¨é‡Šæ‰çš„ä»£ç ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">// char A::* (A::p) = &A::b;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ‘ä»¬å°±éœ€è¦å¯¹pæŒ‡é’ˆçš„å®šä¹‰é‡æ–°è¿›è¡Œæ”¹å˜ï¼Œæ”¹ä¸ºå’Œæœ€ä¸€å¼€å§‹ä»£ç çš„ä¸€æ ·å˜ä¸ºé™æ€å˜é‡ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">static char A::*p;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å°±è¯´è¿™ä¹ˆå¤šå§ï¼Œæ€»ä¹‹è¿˜æ˜¯å­¦åˆ°äº†è®¸å¤šä¸åŒçš„å…³äºç±»æˆå‘˜å˜é‡ã€ç±»æˆå‘˜æŒ‡é’ˆã€é™æ€æˆå‘˜å˜é‡ç­‰ç­‰åˆå§‹åŒ–å®šä¹‰çš„å„ç§è¯­æ³•é—®é¢˜çš„ã€‚</p><h1 id="å‹å…ƒå‡½æ•°çš„ä¸€ç‚¹çŸ¥è¯†"><a href="#å‹å…ƒå‡½æ•°çš„ä¸€ç‚¹çŸ¥è¯†" class="headerlink" title="å‹å…ƒå‡½æ•°çš„ä¸€ç‚¹çŸ¥è¯†"></a>å‹å…ƒå‡½æ•°çš„ä¸€ç‚¹çŸ¥è¯†</h1><p>å†™åˆ°äº†ä¸€é“ä½œä¸šé¢˜ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">// åˆ†æå¦‚ä¸‹å®šä¹‰æ˜¯å¦æ­£ç¡®ï¼Œå¹¶æŒ‡å‡ºé”™è¯¯åŸå› class A{    int a;    static friend int f();    friend int g();public:    friend int A();    A(int x) : a(x){};} a(5);int f() { return a.a; }int g() { return a.a; }<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œé¢æ¶‰åŠåˆ°äº†C++å‹å…ƒçš„ä¸€äº›çŸ¥è¯†ï¼ˆæ¥è‡ª<a href="https://www.apiref.com/cpp-zh/cpp/language/friend.html" target="_blank" rel="noopener">C++ API Reference Document</a>ï¼‰ï¼š</p><ul><li><p>å‹å…ƒå…³ç³»ä¸ä¼ é€’ï¼ˆä½ æœ‹å‹çš„æœ‹å‹ä¸æ˜¯ä½ çš„æœ‹å‹ï¼‰ã€‚</p></li><li><p>å‹å…ƒå…³ç³»ä¸ç»§æ‰¿ï¼ˆä½ æœ‹å‹çš„å­©å­ä¸æ˜¯ä½ çš„æœ‹å‹ï¼‰ã€‚</p></li><li><p>å‹å…ƒå‡½æ•°å£°æ˜ä¸­ä¸å…è®¸ä½¿ç”¨å­˜å‚¨ç±»è¯´æ˜ç¬¦ã€‚åœ¨å‹å…ƒå£°æ˜ä¸­å®šä¹‰çš„å‡½æ•°å…·æœ‰å¤–éƒ¨è¿æ¥ï¼Œå…ˆå‰å·²å®šä¹‰çš„å‡½æ•°ä¿æŒå…¶å®šä¹‰æ—¶æ‰€å…·æœ‰çš„è¿æ¥ã€‚</p></li><li><p><a href="https://www.apiref.com/cpp-zh/cpp/language/access.html" target="_blank" rel="noopener">è®¿é—®è¯´æ˜ç¬¦</a>å¯¹äºå‹å…ƒå£°æ˜çš„å«ä¹‰æ²¡æœ‰å½±å“ï¼ˆå®ƒä»¬å¯å‡ºç°äº <code>private:</code> æˆ–äº <code>public:</code> èŠ‚ï¼Œä¸”å¹¶æ— åŒºåˆ«ï¼‰ã€‚</p></li><li><p>å‹å…ƒç±»å£°æ˜ä¸èƒ½å®šä¹‰æ–°çš„ç±»ï¼ˆfriend class X {}; æ˜¯é”™çš„ï¼‰ã€‚</p></li><li><p>å½“å±€éƒ¨ç±»å°†ä¸€ä¸ªæ— é™å®šçš„å‡½æ•°æˆ–ç±»å£°æ˜ä¸ºå…¶å‹å…ƒæ—¶ï¼Œåª<a href="https://www.apiref.com/cpp-zh/cpp/language/lookup.html" target="_blank" rel="noopener">æŸ¥æ‰¾</a>åœ¨å…¶æœ€å†…å±‚éç±»ä½œç”¨åŸŸä¸­çš„å‡½æ•°ä¸ç±»ï¼Œè€Œéå…¨å±€å‡½æ•°ï¼š</p></li></ul><pre class="line-numbers language-c++"><code class="language-c++">class F {};int f();int main(){    extern int g();    class Local { // main() å‡½æ•°ä¸­çš„å±€éƒ¨ç±»        friend int f(); // é”™è¯¯ï¼Œæ²¡æœ‰å£°æ˜äº main() çš„è¯¥å‡½æ•°        friend int g(); // OKï¼Œmain() ä¸­æœ‰ g çš„å£°æ˜        friend class F; // ä»¤å±€éƒ¨ Fï¼ˆéšåå®šä¹‰ï¼‰ä¸ºå‹å…ƒ        friend class ::F; // ä»¤å…¨å±€ F ä¸ºå‹å…ƒ    };    class F {}; // å±€éƒ¨ F}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ç±»æˆ–ç±»æ¨¡æ¿ X ä¸­çš„å‹å…ƒå£°æ˜ä¸­è¢«é¦–æ¬¡å£°æ˜çš„åå­—ï¼Œæˆä¸º X çš„æœ€å†…å±‚å¤–å›´å‘½åç©ºé—´çš„æˆå‘˜ï¼Œä½†å¯¹äºæŸ¥æ‰¾ä¸å¯è§ï¼ˆé™¤äº†è€ƒè™‘ X çš„<a href="https://www.apiref.com/cpp-zh/cpp/language/adl.html" target="_blank" rel="noopener">å®å‚ä¾èµ–æŸ¥æ‰¾</a>ï¼‰ï¼Œé™¤éåœ¨è¯¥å‘½åç©ºé—´ä½œç”¨åŸŸä¸­æä¾›ä¸ä¹‹åŒ¹é…çš„å£°æ˜â€”â€”ç»†èŠ‚è§<a href="https://www.apiref.com/cpp-zh/cpp/language/namespace.html#.E5.91.BD.E5.90.8D.E7.A9.BA.E9.97.B4" target="_blank" rel="noopener">å‘½åç©ºé—´</a>ã€‚</p><p>END;</p>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>practice mmdet(2)</title>
      <link href="/2021/10/10/practice-mmdet-2/"/>
      <url>/2021/10/10/practice-mmdet-2/</url>
      
        <content type="html"><![CDATA[<h2 id="Test-existing-models-on-standard-datasets"><a href="#Test-existing-models-on-standard-datasets" class="headerlink" title="Test existing models on standard datasets"></a>Test existing models on standard datasets</h2><p>ä¸ºäº†è¯„ä¼°ä¸€ä¸ªmodelsçš„ç²¾ç¡®ç‡ï¼Œæˆ‘ä»¬é€šå¸¸åœ¨ä¸€äº›æ ‡å‡†çš„æ•°æ®é›†ä¸Šè¿›è¡Œæµ‹è¯•æ¨¡å‹ã€‚MMDetectionæ”¯æŒå¤šä¸ªä¸åŒçš„å…¬å…±æ•°æ®é›†åŒ…æ‹¬ï¼šCOCO, Pascal VOC, CityScapes, ä»¥åŠç­‰ç­‰â€¦â€¦å¯ä»¥å‚è€ƒè¿™ä¸ªé“¾æ¥æ¥çœ‹å“ªäº›æ•°æ®é›†è¢«æ”¯æŒï¼š<a href="https://github.com/open-mmlab/mmdetection/tree/master/configs/_base_/datasets" target="_blank" rel="noopener">https://github.com/open-mmlab/mmdetection/tree/master/configs/_base_/datasets</a></p><h3 id="Prepare-datasets"><a href="#Prepare-datasets" class="headerlink" title="Prepare datasets"></a>Prepare datasets</h3><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡å®˜ç½‘æˆ–æ˜¯é•œåƒç½‘ç«™æ¥ä¸‹è½½<a href="http://host.robots.ox.ac.uk/pascal/VOC/index.html" target="_blank" rel="noopener">Pascal VOC</a>æˆ–æ˜¯<a href="https://cocodataset.org/#download" target="_blank" rel="noopener">COCO</a> è¿™äº›æ•°æ®é›†ã€‚æ³¨æ„ä¸€ç‚¹ï¼Œæˆ‘ä»¬æ£€æµ‹ä»»åŠ¡ä¸­Pascal VOC2012æ•°æ®é›†æ˜¯Pascal VOC2007æ•°æ®é›†çš„ä¸€ä¸ªæ‹“å±•ï¼Œä¸¤æ•°æ®é›†å®Œå…¨æ²¡æœ‰äº¤é›†ï¼ˆoverlapï¼‰ã€‚æˆ‘ä»¬æœ€å¥½ä¸‹è½½æ•°æ®é›†åœ¨é¡¹ç›®ç›®å½•å¤–çš„æŸäº›åœ°æ–¹ï¼Œç„¶ååšä¸€ä¸ªé“¾æ¥åˆ° <code>$MMDETECTION/data</code>ä¸‹ã€‚æˆ‘ä»¬æ–‡ä»¶ç»“æ„æœ€å¥½åƒæ˜¯ä¸‹é¢ä¸€æ ·ï¼Œå¦‚æœä¸ä¸€æ ·çš„è¯ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦æ”¹æ­£æˆä¸‹é¢çš„æ ¼å¼ï¼š</p><pre><code>mmdetectionâ”œâ”€â”€ mmdetâ”œâ”€â”€ toolsâ”œâ”€â”€ configsâ”œâ”€â”€ dataâ”‚   â”œâ”€â”€ cocoâ”‚   â”‚   â”œâ”€â”€ annotationsâ”‚   â”‚   â”œâ”€â”€ train2017â”‚   â”‚   â”œâ”€â”€ val2017â”‚   â”‚   â”œâ”€â”€ test2017â”‚   â”œâ”€â”€ cityscapesâ”‚   â”‚   â”œâ”€â”€ annotationsâ”‚   â”‚   â”œâ”€â”€ leftImg8bitâ”‚   â”‚   â”‚   â”œâ”€â”€ trainâ”‚   â”‚   â”‚   â”œâ”€â”€ valâ”‚   â”‚   â”œâ”€â”€ gtFineâ”‚   â”‚   â”‚   â”œâ”€â”€ trainâ”‚   â”‚   â”‚   â”œâ”€â”€ valâ”‚   â”œâ”€â”€ VOCdevkitâ”‚   â”‚   â”œâ”€â”€ VOC2007â”‚   â”‚   â”œâ”€â”€ VOC2012</code></pre><p>ä¸€äº›æ¨¡å‹éœ€è¦é¢å¤–çš„<a href="http://calvin.inf.ed.ac.uk/wp-content/uploads/data/cocostuffdataset/stuffthingmaps_trainval2017.zip" target="_blank" rel="noopener">COCO-stuff</a> datasetsã€‚æ¯”å¦‚ï¼šHTC,DetectoRS å’ŒSCNetï¼Œæˆ‘ä»¬å¯ä»¥ä¸‹è½½ç„¶åè§£å‹ä¹‹åä»¥åˆ°CoCoæ–‡ä»¶å¤¹ä¸­ï¼Œç›®å½•éœ€è¦åƒæ˜¯è¿™ç§æ ¼å¼ï¼š</p><pre><code>mmdetectionâ”œâ”€â”€ dataâ”‚   â”œâ”€â”€ cocoâ”‚   â”‚   â”œâ”€â”€ annotationsâ”‚   â”‚   â”œâ”€â”€ train2017â”‚   â”‚   â”œâ”€â”€ val2017â”‚   â”‚   â”œâ”€â”€ test2017â”‚   â”‚   â”œâ”€â”€ stuffthingmaps</code></pre><p>Panoptic segmentation models like PanopticFPN require additional <a href="http://images.cocodataset.org/annotations/panoptic_annotations_trainval2017.zip" target="_blank" rel="noopener">COCO Panoptic</a> datasets, you can download and unzip then move to the coco annotation folder. The directory should be like this.</p><pre><code>mmdetectionâ”œâ”€â”€ dataâ”‚   â”œâ”€â”€ cocoâ”‚   â”‚   â”œâ”€â”€ annotationsâ”‚   â”‚   â”‚   â”œâ”€â”€ panoptic_train2017.jsonâ”‚   â”‚   â”‚   â”œâ”€â”€ panoptic_train2017â”‚   â”‚   â”‚   â”œâ”€â”€ panoptic_val2017.jsonâ”‚   â”‚   â”‚   â”œâ”€â”€ panoptic_val2017â”‚   â”‚   â”œâ”€â”€ train2017â”‚   â”‚   â”œâ”€â”€ val2017â”‚   â”‚   â”œâ”€â”€ test2017</code></pre><p>The <a href="https://www.cityscapes-dataset.com/" target="_blank" rel="noopener">cityscapes</a> annotations need to be converted into the coco format using <code>tools/dataset_converters/cityscapes.py</code>:</p><pre><code>pip install cityscapesscriptspython tools/dataset_converters/cityscapes.py \    ./data/cityscapes \    --nproc 8 \    --out-dir ./data/cityscapes/annotations</code></pre><h3 id="Test-existing-models"><a href="#Test-existing-models" class="headerlink" title="Test existing models"></a>Test existing models</h3><p>mmdetä¸ºåœ¨æ•´ä¸ªæ•°æ®é›†ä¸Šè¯„ä¼°ä¸€ä¸ªæ¨¡å‹æä¾›äº†æµ‹è¯•ä»£ç ï¼Œæˆ‘ä»¬éœ€è¦ä¸‹é¢çš„ä¸€äº›æµ‹è¯•ç¯å¢ƒï¼š</p><ul><li>single GPU</li><li>single node multiple GPUs</li><li>multiple nodes</li></ul><p>ç„¶åæˆ‘ä»¬éœ€è¦åŸºäºæˆ‘ä»¬çš„æµ‹è¯•ç¯å¢ƒæ¥é€‰æ‹©æ­£ç¡®çš„scriptè¿›è¡Œæµ‹è¯•ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># single-gpu testing</span>python tools<span class="token operator">/</span>test<span class="token punctuation">.</span>py \    $<span class="token punctuation">{</span>CONFIG_FILE<span class="token punctuation">}</span> \    $<span class="token punctuation">{</span>CHECKPOINT_FILE<span class="token punctuation">}</span> \    <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>out $<span class="token punctuation">{</span>RESULT_FILE<span class="token punctuation">}</span><span class="token punctuation">]</span> \    <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>eval $<span class="token punctuation">{</span>EVAL_METRICS<span class="token punctuation">}</span><span class="token punctuation">]</span> \    <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>show<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># multi-gpu testing</span>bash tools<span class="token operator">/</span>dist_test<span class="token punctuation">.</span>sh \    $<span class="token punctuation">{</span>CONFIG_FILE<span class="token punctuation">}</span> \    $<span class="token punctuation">{</span>CHECKPOINT_FILE<span class="token punctuation">}</span> \    $<span class="token punctuation">{</span>GPU_NUM<span class="token punctuation">}</span> \    <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>out $<span class="token punctuation">{</span>RESULT_FILE<span class="token punctuation">}</span><span class="token punctuation">]</span> \    <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>eval $<span class="token punctuation">{</span>EVAL_METRICS<span class="token punctuation">}</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¹‹å‰æˆ‘è¿˜æƒ³ç»™æ–‡ä»¶ç¿»è¯‘ä¸€ä¸‹ï¼Œä½†æ˜¯åæ¥å‘ç°è¿˜æ˜¯è‹±æ–‡çš„ä¸“ä¸šä¸€äº›ï¼š</p><p><code>tools/dist_test.sh</code> also supports multi-node testing, but relies on PyTorchâ€™s <a href="https://pytorch.org/docs/stable/distributed.html#launch-utility" target="_blank" rel="noopener">launch utility</a>.</p><p>Optional arguments:</p><ul><li><code>RESULT_FILE</code>: Filename of the output results in pickle format. If not specified, the results will not be saved to a file.</li><li><code>EVAL_METRICS</code>: Items to be evaluated on the results. Allowed values depend on the dataset, e.g., <code>proposal_fast</code>, <code>proposal</code>, <code>bbox</code>, <code>segm</code> are available for COCO, <code>mAP</code>, <code>recall</code> for PASCAL VOC. Cityscapes could be evaluated by <code>cityscapes</code> as well as all COCO metrics.</li><li><code>--show</code>: If specified, detection results will be plotted on the images and shown in a new window. It is only applicable to single GPU testing and used for debugging and visualization. Please make sure that GUI is available in your environment. Otherwise, you may encounter an error like <code>cannot connect to X server</code>.</li><li><code>--show-dir</code>: If specified, detection results will be plotted on the images and saved to the specified directory. It is only applicable to single GPU testing and used for debugging and visualization. You do NOT need a GUI available in your environment for using this option.</li><li><code>--show-score-thr</code>: If specified, detections with scores below this threshold will be removed.</li><li><code>--cfg-options</code>: if specified, the key-value pair optional cfg will be merged into config file</li><li><code>--eval-options</code>: if specified, the key-value pair optional eval cfg will be kwargs for dataset.evaluate() function, itâ€™s only for evaluation</li></ul><p>æ¥ç€æˆ‘ä»¬å¯ä»¥çœ‹å‡ ä¸ªä¾‹å­ï¼š</p><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦å…ˆä¸‹å¥½æœ‰å…³checkpointsæ–‡ä»¶åˆ°ç›®å½•checkpoints/ä¸‹ã€‚</p><h4 id="1-Test-Faster-R-CNN-and-visualize-the-results-Press-any-key-for-the-next-image-Config-and-checkpoint-files-are-available-here"><a href="#1-Test-Faster-R-CNN-and-visualize-the-results-Press-any-key-for-the-next-image-Config-and-checkpoint-files-are-available-here" class="headerlink" title="1. Test Faster R-CNN and visualize the results. Press any key for the next image. Config and checkpoint files are available here."></a>1. Test Faster R-CNN and visualize the results. Press any key for the next image. Config and checkpoint files are available <a href="https://github.com/open-mmlab/mmdetection/tree/master/configs/faster_rcnn" target="_blank" rel="noopener">here</a>.</h4><pre class="line-numbers language-python"><code class="language-python">python tools<span class="token operator">/</span>test<span class="token punctuation">.</span>py \    configs<span class="token operator">/</span>faster_rcnn<span class="token operator">/</span>faster_rcnn_r50_fpn_1x_coco<span class="token punctuation">.</span>py \    checkpoints<span class="token operator">/</span>faster_rcnn_r50_fpn_1x_coco_20200130<span class="token number">-047c8118.</span>pth \    <span class="token operator">-</span><span class="token operator">-</span>show<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æš‚æ—¶è¯»åˆ°è¿™é‡Œï¼š<a href="https://mmdetection.readthedocs.io/en/latest/1_exist_data_model.html#test-existing-models-on-standard-datasets" target="_blank" rel="noopener">https://mmdetection.readthedocs.io/en/latest/1_exist_data_model.html#test-existing-models-on-standard-datasets</a></p>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> mmdetection </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>explore Argparse Tutorial</title>
      <link href="/2021/10/05/explore-argparse-tutorial/"/>
      <url>/2021/10/05/explore-argparse-tutorial/</url>
      
        <content type="html"><![CDATA[<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>â€œ<em>This tutorial is intended to be a gentle introduction to <a href="https://docs.python.org/3/library/argparse.html#module-argparse" target="_blank" rel="noopener"><code>argparse</code></a>, the recommended command-line parsing module in the Python standard library.</em>â€œ</p><blockquote><p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://docs.python.org/3/howto/argparse.html" target="_blank" rel="noopener">https://docs.python.org/3/howto/argparse.html</a></p></blockquote><p>æ–°ç”Ÿæ‹›æ–°ç¾¤é‡Œæœ‰äººé—®äº†ä¸€äº›é—®é¢˜ï¼Œä»–ç»™å‡ºçš„é—®é¢˜ä»£ç ä¸­åŒ…æ‹¬è¿™ä¸ªåº“ï¼Œç›®å‰æˆ‘ç›®æµ‹æ˜¯å› ä¸ºä»–æ²¡æœ‰ç”¨å¥½è¿™ä¸ªåº“å¯¼è‡´å›¾ç‰‡è¯»å–è¿”å›äº†Noneï¼Œæ­£å¥½æˆ‘ä¹Ÿæ—©å°±æƒ³è¦å»äº†è§£ä¸€ä¸‹è¿™ä¸ªåº“ï¼Œé¡ºä¾¿å­¦ä¸€ä¸‹ã€‚</p><blockquote><p>äº†è§£å®Œåå‘ç°æˆ‘çš„æ¨æµ‹æ˜¯æ­£ç¡®çš„ã€‚ã€‚ã€‚</p></blockquote><h1 id="Concepts"><a href="#Concepts" class="headerlink" title="Concepts"></a>Concepts</h1><p>ä½œè€…é¦–å…ˆæ˜¯ä»‹ç»äº†ä¸€ä¸‹æˆ‘ä»¬çš„ä¸€äº›æœ‰å…³æ¦‚å¿µï¼Œä»–ä½¿ç”¨äº†Linuxå¸¸ç”¨å‘½ä»¤<code>ls</code>æ¥å¼•å…¥ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">$ lscpython  devguide  prog.py  pypy  rm-unused-function.patch$ ls pypyctypes_configure  demo  dotviewer  include  lib_pypy  lib-python ...$ ls -ltotal 20drwxr-xr-x 19 wena wena 4096 Feb 18 18:51 cpythondrwxr-xr-x  4 wena wena 4096 Feb  8 12:04 devguide-rwxr-xr-x  1 wena wena  535 Feb 19 00:05 prog.pydrwxr-xr-x 14 wena wena 4096 Feb  7 00:59 pypy-rw-r--r--  1 wena wena  741 Feb 18 01:01 rm-unused-function.patch$ ls --helpUsage: ls [OPTION]... [FILE]...List information about the FILEs (the current directory by default).Sort entries alphabetically if none of -cftuvSUX nor --sort is specified....<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><code>ls</code> åœ¨æ²¡æœ‰ä»»ä½•optionsçš„æ—¶å€™é»˜è®¤å±•ç¤ºç›®å‰ç›®å½•ä¸‹æ‰€æœ‰å†…å®¹</li><li>å¦‚æœæˆ‘ä»¬æƒ³è¦ä»–ä¸ä»…ä»…æä¾›å®ƒé»˜è®¤çš„é€‰é¡¹çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦åŠ ä¸€ç‚¹å…¶ä»–çš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯å…¶ä»–çš„å‚æ•°ï¼Œä¾‹å¦‚åŠ ä¸€ä¸ª <code>ls pypy</code></li><li>æˆ‘ä»¬å¦‚æœå¤šåŠ ä¸€ä¸ªå‚æ•°<code>-l</code>é‚£ä¾¿æ˜¯å±•ç¤ºå‡ºäº†æ–‡ä»¶çš„ä¸€äº›æ›´ä¸ºè¯¦å°½çš„ä¿¡æ¯</li><li>*â€Thatâ€™s a snippet of the help text. Itâ€™s very useful in that you can come across a program you have never used before, and can figure out how it works simply by reading its help text.â€*</li></ul><p><em>æˆ‘ä»¬å¯ä»¥å¼€å§‹ä»‹ç»Argparseåº“äº†ã€‚</em></p><h1 id="The-basics"><a href="#The-basics" class="headerlink" title="The basics"></a>The basics</h1><p>æˆ‘ä»¬ä»¥ä¸€ä¸ªéå¸¸ç®€å•çš„ä¾‹å­å¼€å§‹ï¼ˆè¿™ä¸ªä¾‹å­å‡ ä¹ä»€ä¹ˆéƒ½æ²¡åšï¼‰</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> argparseparser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span><span class="token punctuation">)</span>parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ç„¶åæˆ‘ä»¬åœ¨Linux shellé‡Œè¾“å…¥å‘½ä»¤è·‘ä¸€ä¸‹è¿™ä¸ªç¨‹åºï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">$ python3 prog.py$ python3 prog.py --helpusage: prog.py [-h]optional arguments:  -h, --help  show this help message and exit$ python3 prog.py --verboseusage: prog.py [-h]prog.py: error: unrecognized arguments: --verbose$ python3 prog.py foousage: prog.py [-h]prog.py: error: unrecognized arguments: foo<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬æ¥çœ‹çœ‹å‘ç”Ÿäº†ä»€ä¹ˆï¼š</p><ul><li>è¿è¡Œè¿™ä¸ªè„šæœ¬æ—¶å¦‚æœä¸å¸¦ä»»ä½•å‚æ•°é‚£ä¹ˆå°±ä¼šæ²¡æœ‰ä»»ä½•è¾“å‡ºåˆ°stdoutï¼Œ ä¸æ˜¯éå¸¸æœ‰ç”¨</li><li>ç¬¬äºŒä¸ªå¼€å§‹å±•ç¤ºæˆ‘ä»¬<code>argparse</code>çš„ç”¨å¤„ï¼Œæˆ‘ä»¬å‡ ä¹ä»€ä¹ˆéƒ½æ²¡åšï¼Œä½†æ˜¯å´å¾—åˆ°äº†è®¸å¤šæœ‰ç”¨çš„å¸®åŠ©æ–‡æ¡£ã€‚</li><li><code>--help</code>å‚æ•°ï¼Œå¯ä»¥ç¼©çŸ­ä¸º<code>-h</code>ã€‚</li></ul><h1 id="Introducing-Positional-arguments"><a href="#Introducing-Positional-arguments" class="headerlink" title="Introducing Positional arguments"></a>Introducing Positional arguments</h1><p>å†æ¥ä¸€ä¸ªä¾‹å­ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> argparseparser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span><span class="token punctuation">)</span>parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"echo"</span><span class="token punctuation">)</span>args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>echo<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åŒæ ·çš„åœ¨Linuxä¸Šè¿è¡Œï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">$ python3 prog.pyusage: prog.py [-h] echoprog.py: error: the following arguments are required: echo$ python3 prog.py --helpusage: prog.py [-h] echopositional arguments:  echooptional arguments:  -h, --help  show this help message and exit$ python3 prog.py foofoo<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>æˆ‘ä»¬åŠ äº†ä¸€ä¸ªæ–°çš„æ–¹æ³•<code>add_argument()</code>, è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬æ˜¯ç”¨æ¥æŒ‡å®šç¨‹åºå°†ä¼šæ¥å—å“ªä¸€ä¸ªå‘½ä»¤è¡ŒæŒ‡ä»¤ã€‚åœ¨æˆ‘ä»¬è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å‘½åå®ƒä¸º<code>echo</code>, ä»¥ä¾¿äºä»–æ˜¯å‘½ä»¤è¡Œçš„å‡½æ•°ã€‚</li><li>ç°åœ¨å¯åŠ¨æˆ‘ä»¬çš„ç¨‹åºéœ€è¦ç‰¹åˆ«æŒ‡å®šä¸€ä¸ªå‚æ•°</li><li><code>parse_args()</code>æ–¹æ³•è¿”å›çš„æ¥è‡ªæˆ‘ä»¬æŒ‡å®šå‚æ•°çš„ä¸€äº›æ•°æ®ï¼Œå½“å‰æƒ…å†µä¸‹ï¼Œæ˜¯<code>echo</code></li><li>è¿™ä¸ªå˜é‡ä¹Ÿæ˜¯æŸç§â€œé­”æœ¯â€æ–¹æ³•ï¼Œ ä¸éœ€è¦æŒ‡å®šå“ªä¸ªæ•°æ®è¢«å­˜åˆ°å“ªä¸ªåœ°æ–¹ã€‚æˆ‘ä»¬ä¹Ÿèƒ½æ³¨æ„åˆ°å®ƒçš„åå­—åŒ¹é…å¯¹åº”äº†<code>echo</code>æ–¹æ³•ã€‚</li></ul><p><em>ä½†æ˜¯æˆ‘ä»¬å‘ç°ï¼Œè™½ç„¶è¿™æ ·çœ‹èµ·æ¥è¿˜ä¸é”™ï¼Œä½†æ˜¯äº‹å®ä¸Šæˆ‘ä»¬è¿˜å¯ä»¥è¿›ä¸€æ­¥æ”¹è¿›ï¼Œæˆ‘ä»¬äº†è§£ä¸€ä¸ªå‚æ•°çš„åŠŸèƒ½è¿˜æ˜¯åªèƒ½ä»åå­—ä¸­çŒœæµ‹æˆ–è€…æ˜¯ä»æºä»£ç ä¸­çœ‹ã€‚æ˜¾ç„¶è¿™æ˜¯å¾ˆéš¾è¢«æˆ‘ä»¬æ¥å—çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</em></p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> argparseparser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span><span class="token punctuation">)</span>parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"echo"</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">"echo the string you use here"</span><span class="token punctuation">)</span>args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>echo<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨Linux shellä¸­è¿è¡Œï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">$ python3 prog.py -husage: prog.py [-h] echopositional arguments:  echo        echo the string you use hereoptional arguments:  -h, --help  show this help message and exit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç°åœ¨æˆ‘ä»¬ç”šè‡³å¯ä»¥è®©å®ƒæ›´åŠ useful:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> argparseparser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span><span class="token punctuation">)</span>parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"square"</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">"display a square of a given number"</span><span class="token punctuation">)</span>args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>square<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Following is a result of running the code:</p><pre class="line-numbers language-shell"><code class="language-shell">$ python3 prog.py 4Traceback (most recent call last):  File "prog.py", line 5, in <module>    print(args.square**2)TypeError: unsupported operand type(s) for ** or pow(): 'str' and 'int'<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥å‘ç°è¿™ä¼¼ä¹ä¸æ˜¯å¾ˆå¥æ•ˆï¼Œç¨‹åºæŠ¥é”™äº†ï¼Œå¾ˆå¥½ç†è§£ï¼šå› ä¸ºè¿™é‡Œé¢ä»å‘½ä»¤è¡Œè¯»å–çš„æ˜¯å­—ç¬¦ä¸²ï¼Œæ˜¾ç„¶å­—ç¬¦ä¸²æ˜¯æ²¡æœ‰åŠæ³•åšå¹³æ–¹çš„ã€‚</p><p>ä½†æ˜¯ï¼Œä½œè€…åæ¥åˆåŠ äº†ä¸€å¥ï¼šunless we tell it otherwise. So, letâ€™s tell <a href="https://docs.python.org/3/library/argparse.html#module-argparse" target="_blank" rel="noopener"><code>argparse</code></a> to treat that input as an integer:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> argparseparser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span><span class="token punctuation">)</span>parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"square"</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">"display a square of a given number"</span><span class="token punctuation">,</span>                    type<span class="token operator">=</span>int<span class="token punctuation">)</span>args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>square<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ç€ï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°äº†ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">$ python3 prog.py 416$ python3 prog.py fourusage: prog.py [-h] squareprog.py: error: argument square: invalid int value: 'four'<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="Introducing-Optional-arguments"><a href="#Introducing-Optional-arguments" class="headerlink" title="Introducing Optional arguments"></a>Introducing Optional arguments</h1><p>åˆ°ç›®å‰ä¸ºæ­¢æˆ‘ä»¬æ‰€ä½¿ç”¨çš„è¿˜éƒ½æ˜¯ä¸€äº›positional argumentsï¼Œç°åœ¨æˆ‘ä»¬åŠ ä¸€äº›optional onesï¼ˆåŸæ–‡ä¸­æŒ‡ä»£argumentsï¼‰ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> argparseparser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span><span class="token punctuation">)</span>parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"--verbosity"</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">"increase output verbosity"</span><span class="token punctuation">)</span>args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> args<span class="token punctuation">.</span>verbosity<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"verbosity turned on"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºä¸ºï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">$ python3 prog.py --verbosity 1verbosity turned on$ python3 prog.py$ python3 prog.py --helpusage: prog.py [-h] [--verbosity VERBOSITY]optional arguments:  -h, --help            show this help message and exit  --verbosity VERBOSITY                        increase output verbosity$ python3 prog.py --verbosityusage: prog.py [-h] [--verbosity VERBOSITY]prog.py: error: argument --verbosity: expected one argument<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>è¿™ä¸ªç¨‹åºä¼šåœ¨æˆ‘ä»¬æŒ‡å®š <code>--verbosity</code>è¿™ä¸ªå‚æ•°çš„æ—¶å€™æ‰ä¼šå±•ç¤ºå‡ºä¸€äº›ä¸œè¥¿ï¼Œåœ¨æ²¡æœ‰è¿™ä¸ªå‚æ•°çš„æ—¶å€™ä»€ä¹ˆéƒ½ä¸ä¼šå±•ç¤ºã€‚</li><li>ä¸ºäº†è¯´æ˜è¿™ä¸ªå‚æ•°å‘½ä»¤æ˜¯å¯é€‰çš„ï¼Œæˆ‘ä»¬å¦‚æœæ²¡æœ‰åŠ è¿™ä¸ªå‚æ•°ç¨‹åºä»ç„¶å¯ä»¥è¿è¡Œè€Œä¸æŠ¥é”™ï¼Œæ³¨æ„é»˜è®¤çŠ¶æ€ä¸‹ï¼Œè¯¥å‚æ•°æ˜¯ä¸è¢«å–ç”¨çš„ã€‚</li><li>æ³¨æ„è¿™ä¸ª<code>--help</code>çš„ä¿¡æ¯å…³äº <code>--verbosity</code>æ˜¯ä¸ä¸€æ ·çš„ã€‚</li><li>å½“æˆ‘ä»¬ä½¿ç”¨<code>--verbosity</code>é€‰é¡¹çš„æ—¶å€™ï¼Œ æˆ‘ä»¬å¿…é¡»æŒ‡å®šä¸€äº›ç‰¹å®šçš„å€¼èµ‹ç»™è¯¥é¡¹å‚æ•°ã€‚</li></ul><p>ä»¥ä¸Šå‚æ•°<code>--verbosity</code>å¯ä»¥æ¥å—ä»»æ„æ•´æ•°å€¼, ä½†æ˜¯é€šè¿‡çœ‹ä»£ç æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå®é™…ä¸Šåªæœ‰ä¸¤ä¸ªå€¼æ˜¯çœŸæ­£æœ‰ç”¨çš„ï¼Œ<code>True</code> or <code>False</code>. æˆ‘ä»¬å¯ä»¥ç›¸åº”çš„ä¿®æ­£ä¸€ä¸‹æˆ‘ä»¬çš„ä»£ç ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> argparseparser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span><span class="token punctuation">)</span>parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"--verbose"</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">"increase output verbosity"</span><span class="token punctuation">,</span>                    action<span class="token operator">=</span><span class="token string">"store_true"</span><span class="token punctuation">)</span>args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> args<span class="token punctuation">.</span>verbose<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"verbosity turned on"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>çœ‹ä¸€ä¸‹è¿è¡Œæƒ…å†µï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">$ python3 prog.py --verboseverbosity turned on$ python3 prog.py --verbose 1usage: prog.py [-h] [--verbose]prog.py: error: unrecognized arguments: 1$ python3 prog.py --helpusage: prog.py [-h] [--verbose]optional arguments:  -h, --help  show this help message and exit  --verbose   increase output verbosity<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>å¯ä»¥çœ‹åˆ°ï¼Œç°åœ¨è¯¥å‚æ•°æ›´å¤šçš„åƒæ˜¯ä¸€ä¸ªflag, è€Œä¸æ˜¯ä¸€ä¸ªéœ€è¦æ¥å—çš„å€¼valuesã€‚æˆ‘ä»¬ç”šè‡³æ”¹å˜é€‰é¡¹çš„åå­—æ¥åŒ¹é…æˆ‘ä»¬çš„idea. æ³¨æ„æˆ‘ä»¬ç°åœ¨ä½¿ç”¨äº†ï¼Œæˆ–è€…è¯´æŒ‡å®šäº†ä¸€ä¸ªæ–°çš„å…³é”®å­—ï¼š<code>action</code>. å¹¶ä¸”ç»™å®ƒäº†ä¸€ä¸ªé»˜è®¤çš„å€¼<code>store_true</code>. è¿™å°±æ„å‘³ç€ï¼Œæˆ‘ä»¬é€‰æ‹©äº†è¿™ä¸ªå‚æ•°ï¼Œç±»ä¼¼äºè¿™ä¸ªå‘½ä»¤<code>python3 prog.py --verbose</code>. è€Œä¸æ˜¯æŒ‡å®šä»–ä»£è¡¨<code>False</code>.</li><li>å½“æˆ‘ä»¬ç»™å®ƒæŒ‡å®šä¸€ä¸ªå€¼çš„æ—¶å€™ï¼Œä»–ä¼šæŠ¥é”™</li><li>æ³¨æ„è¿™é‡Œçš„help textå°±ä¸ä¸€æ ·äº†ã€‚å¯ä»¥å¯¹æ¯”ä¸€ä¸‹ä¸Šé¢çš„é‚£ä¸ª<code>python3 prog.py --help</code>å’Œæˆ‘ä»¬è¿™é‡Œçš„<code>python3 prog.py --help</code>. å°±å¯ä»¥çœ‹å‡ºåŒºåˆ«ã€‚</li></ul><h1 id="Short-options"><a href="#Short-options" class="headerlink" title="Short options"></a>Short options</h1><p>å¦‚æœå¯¹å‘½ä»¤è¡Œçš„ä¸€äº›å‘½ä»¤æ¯”è¾ƒç†Ÿæ‚‰ï¼Œæˆ‘ä»¬å°±å¯èƒ½ä¼šæƒ³ä¸€ä¸‹æ˜¯ä¸æ˜¯è¿™äº›å‚æ•°éƒ½åº”è¯¥æœ‰ä¸€ä¸ªå¿«æ·é”®å‘¢ï¼Ÿè¿™æ˜¯ç¡®å®å¾—ï¼Œè€Œä¸”æ˜¯éå¸¸ç®€å•çš„ï¼Œåªéœ€è¦å‰é¢åŠ ä¸€ä¸ªç±»ä¼¼äº<code>-v</code>çš„æŒ‡ä»¤å°±è¡Œï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> argparseparser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span><span class="token punctuation">)</span>parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"-v"</span><span class="token punctuation">,</span> <span class="token string">"--verbose"</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">"increase output verbosity"</span><span class="token punctuation">,</span>                    action<span class="token operator">=</span><span class="token string">"store_true"</span><span class="token punctuation">)</span>args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> args<span class="token punctuation">.</span>verbose<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"verbosity turned on"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>output:</p><pre class="line-numbers language-shell"><code class="language-shell">$ python3 prog.py -vverbosity turned on$ python3 prog.py --helpusage: prog.py [-h] [-v]optional arguments:  -h, --help     show this help message and exit  -v, --verbose  increase output verbosity<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„åˆ°æˆ‘ä»¬çš„help texté‡Œé¢ä¹ŸåŠ äº†<code>-v</code>è¿™ä¸ªå‘½ä»¤ã€‚</p><h1 id="Combining-Positional-and-Optional-arguments"><a href="#Combining-Positional-and-Optional-arguments" class="headerlink" title="Combining Positional and Optional arguments"></a>Combining Positional and Optional arguments</h1><p>æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹å¦‚ä½•å°†è¿™ä¸¤ç§å‚æ•°æ··åˆèµ·æ¥ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> argparseparser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span><span class="token punctuation">)</span>parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"square"</span><span class="token punctuation">,</span> type<span class="token operator">=</span>int<span class="token punctuation">,</span>                    help<span class="token operator">=</span><span class="token string">"display a square of a given number"</span><span class="token punctuation">)</span>parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"-v"</span><span class="token punctuation">,</span> <span class="token string">"--verbose"</span><span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">"store_true"</span><span class="token punctuation">,</span>                    help<span class="token operator">=</span><span class="token string">"increase output verbosity"</span><span class="token punctuation">)</span>args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>answer <span class="token operator">=</span> args<span class="token punctuation">.</span>square<span class="token operator">**</span><span class="token number">2</span><span class="token keyword">if</span> args<span class="token punctuation">.</span>verbose<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"the square of {} equals {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>args<span class="token punctuation">.</span>square<span class="token punctuation">,</span> answer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>answer<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹çœ‹è¿è¡Œç»“æœï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">$ python3 prog.pyusage: prog.py [-h] [-v] squareprog.py: error: the following arguments are required: square$ python3 prog.py 416$ python3 prog.py 4 --verbosethe square of 4 equals 16$ python3 prog.py --verbose 4the square of 4 equals 16<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>æ³¨æ„é¡ºåºæ˜¯æ— æ‰€è°“çš„</strong></li></ul><p>é‚£ä¹ˆå¦‚æœæˆ‘ä»¬è¿›ä¸€æ­¥ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> argparseparser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span><span class="token punctuation">)</span>parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"square"</span><span class="token punctuation">,</span> type<span class="token operator">=</span>int<span class="token punctuation">,</span>                    help<span class="token operator">=</span><span class="token string">"display a square of a given number"</span><span class="token punctuation">)</span>parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"-v"</span><span class="token punctuation">,</span> <span class="token string">"--verbosity"</span><span class="token punctuation">,</span> type<span class="token operator">=</span>int<span class="token punctuation">,</span>                    help<span class="token operator">=</span><span class="token string">"increase output verbosity"</span><span class="token punctuation">)</span>args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>answer <span class="token operator">=</span> args<span class="token punctuation">.</span>square<span class="token operator">**</span><span class="token number">2</span><span class="token keyword">if</span> args<span class="token punctuation">.</span>verbosity <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"the square of {} equals {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>args<span class="token punctuation">.</span>square<span class="token punctuation">,</span> answer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">elif</span> args<span class="token punctuation">.</span>verbosity <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{}^2 == {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>args<span class="token punctuation">.</span>square<span class="token punctuation">,</span> answer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>answer<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">$ python3 prog.py 416$ python3 prog.py 4 -vusage: prog.py [-h] [-v VERBOSITY] squareprog.py: error: argument -v/--verbosity: expected one argument$ python3 prog.py 4 -v 14^2 == 16$ python3 prog.py 4 -v 2the square of 4 equals 16$ python3 prog.py 4 -v 316<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬è¿™é‡Œé¢ç»™ä»–æŒ‡å®šäº†ä¸€å®šçš„å€¼åç¨‹åºä¼šæ€ä¹ˆåšã€‚</p><p>è¿™äº›çœ‹èµ·æ¥è¿˜ä¸é”™ï¼Œä½†æ˜¯é™¤äº†æœ€åä¸€ä¸ªï¼Œä¸ç®¡è¾“å…¥ä»€ä¹ˆï¼Œå®ƒéƒ½ä¼šè¿”å›ç›¸åŒçš„ç»“æœï¼Œæˆ‘ä»¬æƒ³è¦ä¸¥æ ¼é™å®šä»–çš„è¾“å…¥å¿…é¡»æ˜¯3ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> argparseparser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span><span class="token punctuation">)</span>parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"square"</span><span class="token punctuation">,</span> type<span class="token operator">=</span>int<span class="token punctuation">,</span>                    help<span class="token operator">=</span><span class="token string">"display a square of a given number"</span><span class="token punctuation">)</span>parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"-v"</span><span class="token punctuation">,</span> <span class="token string">"--verbosity"</span><span class="token punctuation">,</span> type<span class="token operator">=</span>int<span class="token punctuation">,</span> choices<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                    help<span class="token operator">=</span><span class="token string">"increase output verbosity"</span><span class="token punctuation">)</span>args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>answer <span class="token operator">=</span> args<span class="token punctuation">.</span>square<span class="token operator">**</span><span class="token number">2</span><span class="token keyword">if</span> args<span class="token punctuation">.</span>verbosity <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"the square of {} equals {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>args<span class="token punctuation">.</span>square<span class="token punctuation">,</span> answer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">elif</span> args<span class="token punctuation">.</span>verbosity <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{}^2 == {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>args<span class="token punctuation">.</span>square<span class="token punctuation">,</span> answer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>answer<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°æ­¤æ—¶å°±åªèƒ½åœ¨choices=[0, 1, 2]ä¸­é€‰æ‹©äº†ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">$ python3 prog.py 4 -v 3usage: prog.py [-h] [-v {0,1,2}] squareprog.py: error: argument -v/--verbosity: invalid choice: 3 (choose from 0, 1, 2)$ python3 prog.py 4 -husage: prog.py [-h] [-v {0,1,2}] squarepositional arguments:  square                display a square of a given numberoptional arguments:  -h, --help            show this help message and exit  -v {0,1,2}, --verbosity {0,1,2}                        increase output verbosity<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>æ³¨æ„è¿™ä¸ªåªèƒ½åœ¨choices=[0, 1, 2]ä¸­é€‰æ‹©è¿™ä¸ªä¿¡æ¯ä¸ä»…ä»…åœ¨æŠ¥é”™errorå‡ºæ˜¾ç¤ºäº†ï¼Œè¿˜åœ¨æˆ‘ä»¬çš„help textä¸­æ˜¾ç¤ºäº†ã€‚</li></ul><p><em>Now, letâ€™s use a different approach of playing with verbosity, which is pretty common. It also matches the way the CPython executable handles its own verbosity argument (check the output of <code>python --help</code>):</em></p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> argparseparser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span><span class="token punctuation">)</span>parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"square"</span><span class="token punctuation">,</span> type<span class="token operator">=</span>int<span class="token punctuation">,</span>                    help<span class="token operator">=</span><span class="token string">"display the square of a given number"</span><span class="token punctuation">)</span>parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"-v"</span><span class="token punctuation">,</span> <span class="token string">"--verbosity"</span><span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">"count"</span><span class="token punctuation">,</span>                    help<span class="token operator">=</span><span class="token string">"increase output verbosity"</span><span class="token punctuation">)</span>args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>answer <span class="token operator">=</span> args<span class="token punctuation">.</span>square<span class="token operator">**</span><span class="token number">2</span><span class="token keyword">if</span> args<span class="token punctuation">.</span>verbosity <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"the square of {} equals {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>args<span class="token punctuation">.</span>square<span class="token punctuation">,</span> answer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">elif</span> args<span class="token punctuation">.</span>verbosity <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{}^2 == {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>args<span class="token punctuation">.</span>square<span class="token punctuation">,</span> answer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>answer<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>We have introduced another action, â€œcountâ€, to count the number of occurrences of a specific optional arguments:</p><pre class="line-numbers language-shell"><code class="language-shell">$ python3 prog.py 416$ python3 prog.py 4 -v4^2 == 16$ python3 prog.py 4 -vvthe square of 4 equals 16$ python3 prog.py 4 --verbosity --verbositythe square of 4 equals 16$ python3 prog.py 4 -v 1usage: prog.py [-h] [-v] squareprog.py: error: unrecognized arguments: 1$ python3 prog.py 4 -husage: prog.py [-h] [-v] squarepositional arguments:  square           display a square of a given numberoptional arguments:  -h, --help       show this help message and exit  -v, --verbosity  increase output verbosity$ python3 prog.py 4 -vvv16<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>Yes, itâ€™s now more of a flag (similar to <code>action=&quot;store_true&quot;</code>) in the previous version of our script. That should explain the complaint.</li><li>It also behaves similar to â€œstore_trueâ€ action.</li><li>Now hereâ€™s a demonstration of what the â€œcountâ€ action gives. Youâ€™ve probably seen this sort of usage before.</li><li>And if you donâ€™t specify the <code>-v</code> flag, that flag is considered to have <code>None</code> value.</li><li>As should be expected, specifying the long form of the flag, we should get the same output.</li><li>Sadly, our help output isnâ€™t very informative on the new ability our script has acquired, but that can always be fixed by improving the documentation for our script (<em>e.g. via the <code>help</code> keyword argument</em>).</li><li>That last output exposes a bug in our program.</li></ul><p>Letâ€™s fix:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> argparseparser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span><span class="token punctuation">)</span>parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"square"</span><span class="token punctuation">,</span> type<span class="token operator">=</span>int<span class="token punctuation">,</span>                    help<span class="token operator">=</span><span class="token string">"display a square of a given number"</span><span class="token punctuation">)</span>parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"-v"</span><span class="token punctuation">,</span> <span class="token string">"--verbosity"</span><span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">"count"</span><span class="token punctuation">,</span>                    help<span class="token operator">=</span><span class="token string">"increase output verbosity"</span><span class="token punctuation">)</span>args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>answer <span class="token operator">=</span> args<span class="token punctuation">.</span>square<span class="token operator">**</span><span class="token number">2</span><span class="token comment" spellcheck="true"># bugfix: replace == with >=</span><span class="token keyword">if</span> args<span class="token punctuation">.</span>verbosity <span class="token operator">>=</span> <span class="token number">2</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"the square of {} equals {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>args<span class="token punctuation">.</span>square<span class="token punctuation">,</span> answer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">elif</span> args<span class="token punctuation">.</span>verbosity <span class="token operator">>=</span> <span class="token number">1</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{}^2 == {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>args<span class="token punctuation">.</span>square<span class="token punctuation">,</span> answer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>answer<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>And this is what it gives:</p><pre class="line-numbers language-shell"><code class="language-shell">$ python3 prog.py 4 -vvvthe square of 4 equals 16$ python3 prog.py 4 -vvvvthe square of 4 equals 16$ python3 prog.py 4Traceback (most recent call last):  File "prog.py", line 11, in <module>    if args.verbosity >= 2:TypeError: '>=' not supported between instances of 'NoneType' and 'int'<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>First output went well, and fixes the bug we had before. That is, we want any value &gt;= 2 to be as verbose as possible.</li><li>Third output not so good.</li></ul><p>Letâ€™s fix that bug:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> argparseparser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span><span class="token punctuation">)</span>parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"square"</span><span class="token punctuation">,</span> type<span class="token operator">=</span>int<span class="token punctuation">,</span>                    help<span class="token operator">=</span><span class="token string">"display a square of a given number"</span><span class="token punctuation">)</span>parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"-v"</span><span class="token punctuation">,</span> <span class="token string">"--verbosity"</span><span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">"count"</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>                    help<span class="token operator">=</span><span class="token string">"increase output verbosity"</span><span class="token punctuation">)</span>args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>answer <span class="token operator">=</span> args<span class="token punctuation">.</span>square<span class="token operator">**</span><span class="token number">2</span><span class="token keyword">if</span> args<span class="token punctuation">.</span>verbosity <span class="token operator">>=</span> <span class="token number">2</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"the square of {} equals {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>args<span class="token punctuation">.</span>square<span class="token punctuation">,</span> answer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">elif</span> args<span class="token punctuation">.</span>verbosity <span class="token operator">>=</span> <span class="token number">1</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{}^2 == {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>args<span class="token punctuation">.</span>square<span class="token punctuation">,</span> answer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>answer<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Weâ€™ve just introduced yet another keyword, <code>default</code>. Weâ€™ve set it to <code>0</code> in order to make it comparable to the other int values. Remember that by default, if an optional argument isnâ€™t specified, it gets the <code>None</code> value, and that cannot be compared to an int value (hence the <a href="https://docs.python.org/3/library/exceptions.html#TypeError" target="_blank" rel="noopener"><code>TypeError</code></a> exception).</p><p>And:</p><pre class="line-numbers language-shell"><code class="language-shell">$ python3 prog.py 416<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>You can go quite far just with what weâ€™ve learned so far, and we have only scratched the surface. The <a href="https://docs.python.org/3/library/argparse.html#module-argparse" target="_blank" rel="noopener"><code>argparse</code></a> module is very powerful, and weâ€™ll explore a bit more of it before we end this tutorial.</p><h1 id="Getting-a-little-more-advanced"><a href="#Getting-a-little-more-advanced" class="headerlink" title="Getting a little more advanced"></a>Getting a little more advanced</h1><blockquote><p><a href="https://docs.python.org/3/howto/argparse.html#getting-a-little-more-advanced" target="_blank" rel="noopener">https://docs.python.org/3/howto/argparse.html#getting-a-little-more-advanced</a></p></blockquote><p>æ²¡æ¥å¾—åŠçœ‹å‘¢ï¼Œå¾…æ›´â€¦â€¦</p>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è¯­æ³• </tag>
            
            <tag> Argparse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è·¯é¢è£‚ç¼æ•°æ®é›†è°ƒç ”</title>
      <link href="/2021/10/04/lu-mian-lie-feng-shu-ju-ji-diao-yan/"/>
      <url>/2021/10/04/lu-mian-lie-feng-shu-ju-ji-diao-yan/</url>
      
        <content type="html"><![CDATA[<h2 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h2><p>æ¢æŸ¥å…³äºè·¯é¢è£‚ç¼çš„å„ä¸ªæ•°æ®é›†ï¼Œç„¶åå†™ä¸€ä¸‹dataloaderè¿›è¡Œç›¸åº”çš„è¯»å–ï¼Œè¿›è¡Œä¸€ä¸‹mmdetè·‘ä¸€ä¸‹æ•°æ®é›†ã€‚</p><blockquote><p>è·¯é¢è£‚ç¼æ£€æµ‹ä¹‹æ‰€ä»¥ç§°ä¸ºä¸€é¡¹è‰°éš¾çš„å·¥ä½œï¼Œæ˜¯å› ä¸ºè·¯é¢è£‚ç¼ã€ç—…å®³çš„ä¸å‡åŒ€æ€§ï¼Œæ¯”å¦‚å…‰çº¿ã€å¼ºåº¦ä¸ç»Ÿä¸€ï¼Œä»¥åŠèƒŒæ™¯çš„å¤æ‚æ€§ï¼Œè£‚ç¼ä¸è·¯é¢èƒŒæ™¯åŒºå¯¹æ¯”åº¦ï¼ˆåŒºåˆ†åº¦ï¼‰è¾ƒå°ï¼Œåœ¨å…‰ç…§æ¡ä»¶ä¸åŒï¼Œä¹Ÿæœ‰å¯èƒ½å­˜åœ¨é˜´å½±ã€‚å› æ­¤æ„å»ºäº†FPGBNæ¨¡å‹ï¼Œå°†ä¸Šä¸‹æ–‡ä¿¡æ¯æ•´åˆåˆ°åº•å±‚ç‰¹å¾å€¼ï¼Œé‡‡ç”¨ç‰¹å¾é‡‘å­—å¡”ï¼ˆfeature pyramidï¼‰çš„æ–¹å¼è¿›è¡Œè£‚ç¼æ£€æµ‹ã€‚è®­ç»ƒæ—¶é€šè¿‡é‡æ–°è°ƒæ•´åœ¨åˆ†å±‚çš„åµŒå¥—æ ·æœ¬æƒé‡ï¼Œå¹³è¡¡æ˜“äºè¯†åˆ«å’Œå¾ˆéš¾è¯†åˆ«æ ·æœ¬çš„æŸå¤±è´¡çŒ®ã€‚æå‡ºäº†ä¸€ç§æ–°çš„è£‚ç¼æ£€æµ‹æ–¹æ³• average intersection over union (AIU)ï¼Œå°†å…¶ä¸state-of-the-art crack detection, edge detectionï¼Œsemantic segmentation methodsæ–¹æ³•è¿›è¡Œäº†å¯¹æ¯”ï¼Œä½“ç°å…¶æ›´å¥½çš„å‡†ç¡®æ€§ä¸æ™®é€‚æ€§ã€‚</p><p>from <a href="https://zhuanlan.zhihu.com/p/72899699" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/72899699</a></p></blockquote><p><em>ä½†å°±ç›®å‰æ¥çœ‹ï¼Œæˆ‘ä»¬å¯»æ‰¾çš„æ•°æ®é›†æ•ˆæœéƒ½ä¸å°½ç†æƒ³ï¼Œå¤§å¤šæ•°éƒ½æ˜¯ç›´æ¥æ‹æ‘„çš„è£‚ç¼ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬æ‰€è°“çš„æƒ³è¦ä»ä¸€ä¸ªè¾ƒè¿œçš„è§’åº¦å»æ‹æ‘„æˆ–è€…ä»è½¦ä¸Šæ¥æ‹åœ°ä¸‹é‚£ç§åœºæ™¯ã€‚</em></p><h2 id="ç®—æ³•è°ƒç ”"><a href="#ç®—æ³•è°ƒç ”" class="headerlink" title="ç®—æ³•è°ƒç ”"></a>ç®—æ³•è°ƒç ”</h2><ul><li>åŸºäºæ”¹è¿›Uâ€‘netæ¨¡å‹çš„è·¯é¢è£‚ç¼æ™ºèƒ½è¯†åˆ«:<a href="http://sjcj.nuaa.edu.cn/sjcjycl/article/html/202002007" target="_blank" rel="noopener">http://sjcj.nuaa.edu.cn/sjcjycl/article/html/202002007</a></li><li>åŸºäºè¯­ä¹‰åˆ†å‰²ç½‘ç»œæ¨¡å‹çš„è·¯é¢è£‚ç¼è¯†åˆ«ï¼š<a href="http://www.360doc.com/content/20/0810/16/28704984_929505569.shtml" target="_blank" rel="noopener">http://www.360doc.com/content/20/0810/16/28704984_929505569.shtml</a></li><li>FPHBNæ¨¡å‹:<a href="https://zhuanlan.zhihu.com/p/72899699" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/72899699</a>, è¯¥åšå®¢ä¸­åŒ…å«äº†å¤šç§æ•°æ®é›†ï¼Œä¹Ÿåœ¨ä¸‹é¢ä¸€ä¸€ä»‹ç»äº†ã€‚</li><li>deep_crack_detection:<a href="https://github.com/Sutadasuto/deep_crack_detection,ä¹‹å‰çš„ä¸€äº›å…³äºAligle-RNå›¾ç‰‡å°±æ˜¯ä»è¿™é‡Œæ¥çš„ã€‚ä¹Ÿæ˜¯æä¾›å¥½äº†è·¯é¢æ£€æµ‹çš„æ•°æ®é›†ã€‚" target="_blank" rel="noopener">https://github.com/Sutadasuto/deep_crack_detection,ä¹‹å‰çš„ä¸€äº›å…³äºAligle-RNå›¾ç‰‡å°±æ˜¯ä»è¿™é‡Œæ¥çš„ã€‚ä¹Ÿæ˜¯æä¾›å¥½äº†è·¯é¢æ£€æµ‹çš„æ•°æ®é›†ã€‚</a></li></ul><h2 id="CrackForest-é“è·¯è£‚ç¼å›¾åƒæ•°æ®"><a href="#CrackForest-é“è·¯è£‚ç¼å›¾åƒæ•°æ®" class="headerlink" title="CrackForest é“è·¯è£‚ç¼å›¾åƒæ•°æ®"></a>CrackForest é“è·¯è£‚ç¼å›¾åƒæ•°æ®</h2><p>CrackForestæ•°æ®é›†æ˜¯ä¸€ä¸ªå¸¦æ³¨é‡Šçš„é“è·¯è£‚ç¼å›¾åƒæ•°æ®åº“ï¼Œå¯ä»¥å¤§è‡´åæ˜ åŸå¸‚è·¯é¢çŠ¶å†µã€‚æœ¬æ•°æ®é›†éœ€è¦æˆ‘ä»¬æ³¨å†ŒModelWhaleä¸‹è½½ï¼Œæ•°æ®é‡å¾ˆå°,åªæœ‰329å¼ å›¾ç‰‡ï¼Œä½†æ˜¯æœ‰GTã€segç­‰æ•°æ®labelï¼Œè¿˜æ¯”è¾ƒé½å…¨ã€‚</p><blockquote><p>åœ°å€ï¼š<a href="https://www.heywhale.com/mw/dataset/5ec22bc4fb82740098d0046f" target="_blank" rel="noopener">https://www.heywhale.com/mw/dataset/5ec22bc4fb82740098d0046f</a></p></blockquote><p>å›¾ç‰‡æ ·ä¾‹ï¼š</p><p><a href="https://imgtu.com/i/4OjWY4" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/10/04/4OjWY4.jpg" alt="CrackForest"></a></p><p>ä¸€ä¸ªé—®é¢˜ï¼šWhat are the .seg files in this repository for and how to use them?</p><p>è§£ç­”ï¼š<a href="https://github.com/cuilimeng/CrackForest-dataset/issues/3" target="_blank" rel="noopener">https://github.com/cuilimeng/CrackForest-dataset/issues/3</a></p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> scipy<span class="token punctuation">.</span>io<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> cv2mat <span class="token operator">=</span> scipy<span class="token punctuation">.</span>io<span class="token punctuation">.</span>loadmat<span class="token punctuation">(</span><span class="token string">'001.mat'</span><span class="token punctuation">)</span>np_seg <span class="token operator">=</span> mat<span class="token punctuation">[</span><span class="token string">'groundTruth'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>np_seg <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>np_seg<span class="token punctuation">[</span>y<span class="token punctuation">,</span> x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">255</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>np_seg <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>np_seg<span class="token punctuation">[</span>y<span class="token punctuation">,</span> x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>cv2<span class="token punctuation">.</span>imwrite<span class="token punctuation">(</span><span class="token string">'./001.png'</span><span class="token punctuation">,</span> np_seg<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Cracks-and-Potholes-in-Road-Images-Dataset"><a href="#Cracks-and-Potholes-in-Road-Images-Dataset" class="headerlink" title="Cracks-and-Potholes-in-Road-Images-Dataset"></a>Cracks-and-Potholes-in-Road-Images-Dataset</h2><blockquote><p>æ•°æ®é›†ä¸‹è½½ï¼š<a href="https://md-datasets-cache-zipfiles-prod.s3.eu-west-1.amazonaws.com/t576ydh9v8-4.zip" target="_blank" rel="noopener">https://md-datasets-cache-zipfiles-prod.s3.eu-west-1.amazonaws.com/t576ydh9v8-4.zip</a></p><p>æ•°æ®é›†åœ°å€ï¼š<a href="https://data.mendeley.com/datasets/t576ydh9v8/4" target="_blank" rel="noopener">https://data.mendeley.com/datasets/t576ydh9v8/4</a></p><p>æ•°æ®é›†è¯¦è§£BLOGï¼š<a href="https://biankatpas.github.io/Cracks-and-Potholes-in-Road-Images-Dataset/" target="_blank" rel="noopener">https://biankatpas.github.io/Cracks-and-Potholes-in-Road-Images-Dataset/</a></p></blockquote><p>ç»™çš„ç®—æ˜¯æ¯”è¾ƒå¥½çš„æ•°æ®é›†ï¼Œ å¤§è‡´å½¢å¼æ˜¯è¿™æ ·çš„ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://biankatpas.github.io/Cracks-and-Potholes-in-Road-Images-Dataset/figures/2.png" alt></p><h2 id="CRACK500-Dataset"><a href="#CRACK500-Dataset" class="headerlink" title="CRACK500 Dataset"></a>CRACK500 Dataset</h2><p>è£‚ç¼è¯†åˆ«æ¨¡å‹çš„æ•°æ®é›†é‡‡ç”¨CRACK500æ•°æ®é›†ï¼Œæ­¤æ•°æ®é›†çš„æ¥æºæ˜¯Lei Zhang,Fan Yangç­‰äººåœ¨å¤©æ™®å¤§å­¦ä½¿ç”¨æ‰‹æœºæ‹æ‘„äº†500å¼ å¤§å°ä¸º200Ã—1500çš„è·¯é¢è£‚ç¼å›¾ç‰‡ï¼Œå¹¶å¯¹è£‚ç¼å›¾ç‰‡è¿›è¡Œé€åƒç´ åœ°æ ‡æ³¨ã€‚ä¸ºäº†é€‚é…ç½‘ç»œæ¨¡å‹è¾“å…¥å›¾åƒåƒç´ è¦æ±‚ï¼Œä¸”æ–¹ä¾¿æ¨¡å‹çš„è®­ç»ƒï¼Œæ¯å¼ åŸå§‹å›¾ç‰‡è¢«è£å‰ªä¸º16ä¸ªä¸é‡å çš„å›¾åƒåŒºåŸŸï¼Œæ¯å¼ å›¾ç‰‡ä¸Šè£‚ç¼åŒºåŸŸå‡è¶…è¿‡1 000ä¸ªåƒç´ ã€‚CRACK500æ•°æ®é›†ç”±è®­ç»ƒé›†ã€éªŒè¯é›†å’Œæµ‹è¯•é›†ç»„æˆï¼Œéƒ¨åˆ†åŸå§‹è®­ç»ƒå›¾ç‰‡åŠæ ‡ç­¾è§å›¾1ï¼Œè®­ç»ƒå›¾ç‰‡ä¸æ ‡ç­¾å›¾ç‰‡åå­—ç›¸åŒï¼Œä½†è®­ç»ƒå›¾ç‰‡ä¸ºjpgæ ¼å¼ï¼Œæ ‡ç­¾å›¾ç‰‡ä¸ºpngæ ¼å¼ã€‚è®­ç»ƒé›†åŒ…å«äº†3792å¼ å›¾ç‰‡ï¼ŒéªŒè¯é›†åŒ…å«696å¼ å›¾ç‰‡ï¼Œæµ‹è¯•é›†åŒ…å«2248å¼ å›¾ç‰‡ï¼Œå…¶ä¸­ä¸€åŠæ˜¯åŸå§‹å›¾ç‰‡ï¼Œä¸€åŠæ˜¯æ ‡ç­¾å›¾ç‰‡ã€‚CRACK500ä¸­çš„æ ‡ç­¾å›¾ç‰‡å¯¹åº”ç€åŸå§‹å›¾è¢«åˆ’åˆ†ä¸º2ç§é¢œè‰²ï¼ŒèƒŒæ™¯ä¸ºé»‘è‰²ï¼Œè£‚ç¼åŒºåŸŸä¸ºç™½è‰²ã€‚</p><blockquote><p>åœ°å€ï¼š<a href="https://github.com/TachibanaYoshino/Road-Crack-Segmentation--Keras/tree/master/dataset/CRACK500" target="_blank" rel="noopener">https://github.com/TachibanaYoshino/Road-Crack-Segmentation--Keras/tree/master/dataset/CRACK500</a></p><p>è¿™ä¸ªä¹Ÿæ˜¯ç›¸å…³çš„åœ°å€ï¼š<a href="https://github.com/fyangneil/pavement-crack-detection" target="_blank" rel="noopener">https://github.com/fyangneil/pavement-crack-detection</a></p><p>ä½†æ˜¯ç›¸å…³çš„æ•°æ®é›†åœ¨Google Driveï¼Œ ç™¾åº¦äº‘ç›˜ï¼Œ One Driveä¸­ï¼Œå¹¶ä¸”å‘ç°ï¼Œè¿™é‡Œé¢è¿˜æœ‰cracktree200çš„æ•°æ®é›†,GAPS 384çš„æ•°æ®é›†ï¼Œè¿˜æœ‰è®­ç»ƒå¥½çš„modelï¼š</p><p><a href="https://drive.google.com/drive/folders/1y9SxmmFVh0xdQR-wdchUmnScuWMJ5_O-" target="_blank" rel="noopener">https://drive.google.com/drive/folders/1y9SxmmFVh0xdQR-wdchUmnScuWMJ5_O-</a></p><p>å¦‚æœéœ€è¦å¯†ç çš„è¯ï¼Œå¯†ç åº”è¯¥æ˜¯ï¼š jviqï¼ˆ<del>ä¼¼ä¹æ˜¯ç™¾åº¦äº‘ç›˜è¦å¯†ç </del>ï¼‰</p></blockquote><p>æ ·ä¾‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211004164153.png" alt></p><h2 id="GAPs-384"><a href="#GAPs-384" class="headerlink" title="GAPs 384"></a>GAPs 384</h2><p>å¾·å›½æ²¥é’è·¯é¢ç—…å®³(gap)æ•°æ®é›†ï¼Œé€šè¿‡æä¾›æ ‡å‡†åŒ–çš„é«˜è´¨é‡å¤§è§„æ¨¡æ•°æ®é›†ï¼Œè§£å†³è·¯é¢ç—…å®³é¢†åŸŸçš„å¯æ¯”æ€§é—®é¢˜ã€‚gapæ•°æ®é›†å…±åŒ…å«1,969å¹…ç°åº¦å€¼å›¾åƒï¼ŒåŒ…å«è£‚ç¼ã€å‡¹å‘ã€åµŒè¡¥ç­‰ä¸åŒç±»åˆ«çš„ç—…å®³ï¼Œå›¾åƒåˆ†è¾¨ç‡ä¸º1920Ã—1080åƒç´ ï¼Œæ¯åƒç´ é‡ä»£è¡¨1.2mmÃ—1.2mmã€‚æœ‰å…³æ•°æ®é›†çš„æ›´å¤šç»†èŠ‚ï¼Œè¯·å‚è€ƒé˜…è¯»â€œHow to get pavement distress detection ready for deep learning? a systematic approach,â€ in International Joint Conference on Neural Networks, 2017, pp. 2039â€“2047.</p><p>å›¾åƒä¸­çš„å®é™…ç—…å®³ç”±ä¸€ä¸ªåŒ…å›´æ¡†åŒ…å›´ã€‚è¿™ç§ç±»å‹çš„æ³¨é‡Šå¯¹äºè®­ç»ƒæ·±åº¦æ¨¡å‹è¿›è¡Œåƒç´ çº§è£‚ç¼é¢„æµ‹ä»»åŠ¡æ¥è¯´è¿˜ä¸å¤Ÿå¥½ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä»gapæ•°æ®é›†ï¼ŒåªåŒ…å«è£‚çº¹ç±»åˆ«çš„ç—…å®³ï¼Œå¹¶è¿›è¡Œåƒç´ çº§æ ‡æ³¨ã€‚è¿™ä¸ªåŸºäºåƒç´ çš„å¸¦æ³¨é‡Šçš„è£‚çº¹æ•°æ®é›†å‘½åä¸ºGAPs384ï¼Œç”¨äºæµ‹è¯•åŸºäºCRACK500è®­ç»ƒçš„æ¨¡å‹çš„æ³›åŒ–æ€§ã€‚</p><p>ç”±äºå›¾åƒå°ºå¯¸å¤§ï¼ŒGPUå†…å­˜æœ‰é™ï¼Œæ¯å¼ å›¾åƒè£å‰ªä¸º6ä¸ªå¤§å°640Ã—540åƒç´ çš„éé‡å å›¾åƒåŒºåŸŸã€‚åªæœ‰å›¾åƒåŒºåŸŸå…·æœ‰1000ä¸ªåƒç´ æ‰ä¿ç•™ä¸‹æ¥ï¼Œå› æ­¤æˆ‘ä»¬å¾—åˆ°509å¹…å›¾åƒè¿›è¡Œæµ‹è¯•ã€‚</p><blockquote><p> åœ°å€ï¼š<a href="https://www.tu-ilmenau.de/en/university/departments/department-of-computer-science-and-automation/profile/institutes-and-groups/institute-of-computer-and-systems-engineering/group-for-neuroinformatics-and-cognitive-robotics/data-sets-code/german-asphalt-pavement-distress-dataset-gaps" target="_blank" rel="noopener">https://www.tu-ilmenau.de/en/university/departments/department-of-computer-science-and-automation/profile/institutes-and-groups/institute-of-computer-and-systems-engineering/group-for-neuroinformatics-and-cognitive-robotics/data-sets-code/german-asphalt-pavement-distress-dataset-gaps</a>  or  pip install gaps-dataset</p></blockquote><p>æ³¨æ„è¿™é‡Œé¢åŒ…å«äº†å¤šç‰ˆæœ¬ï¼Œv1, v2ç­‰ï¼Œé‡Œé¢ä¹Ÿæœ‰ç€åŠ è½½æ•°æ®é›†çš„ä¸€äº›æ–¹æ³•ï¼Œä¸è¿‡éƒ½æ˜¯ä¸€äº›ä»–è‡ªå®šä¹‰çš„åº“gapsçš„è°ƒç”¨ï¼Œä¾‹å¦‚ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211004164121.png" alt></p><h2 id="Cracktree-200"><a href="#Cracktree-200" class="headerlink" title="Cracktree 200"></a>Cracktree 200</h2><p>Zouç­‰äººæå‡ºäº†ä¸€ä¸ªæ•°æ®é›†æ¥è¯„ä¼°ä»–ä»¬æå‡ºçš„æ–¹æ³•ã€‚æ•°æ®é›†åŒ…æ‹¬206ä¸ªå°ºå¯¸ä¸º800Ã—600çš„è·¯é¢å›¾åƒï¼Œæœ‰å„ç§ç±»å‹çš„è£‚ç¼ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†è¿™ä¸ªæ•°æ®é›†å‘½åä¸ºCracktree200ã€‚è¯¥æ•°æ®é›†å…·æœ‰é˜´å½±ã€é®æŒ¡ã€ä½å¯¹æ¯”åº¦ã€å™ªå£°ç­‰æŒ‘æˆ˜ã€‚æ•°æ®é›†çš„æ ‡æ³¨ä¸ºåƒç´ çº§æ ‡ç­¾ï¼Œå¯ä»¥ç›´æ¥ç”¨äºè¯„ä»·ã€‚</p><blockquote><p>è®ºæ–‡åœ°å€ï¼š<a href="https://www.cse.sc.edu/~songwang/document/prl12.pdf" target="_blank" rel="noopener">https://www.cse.sc.edu/~songwang/document/prl12.pdf</a></p><p><del>ç›®å‰æ•°æ®åœ°å€æ²¡æ‰¾åˆ°ã€‚</del> æ‰¾åˆ°äº†ï¼Œåœ¨ä¸Šé¢çš„CRACK500çš„Google Driveé‡Œé¢ã€‚</p></blockquote><h2 id="Aigle-RN-amp-ESAR-amp-LCMS-amp-LRIS-amp-TEMPEST2"><a href="#Aigle-RN-amp-ESAR-amp-LCMS-amp-LRIS-amp-TEMPEST2" class="headerlink" title="Aigle-RN &amp; ESAR &amp; LCMS&amp;LRIS&amp;TEMPEST2"></a>Aigle-RN &amp; ESAR &amp; LCMS&amp;LRIS&amp;TEMPEST2</h2><p>Aigle-RNæ˜¯åŒ…å«38å¼ å¸¦æœ‰åƒç´ çº§æ ‡æ³¨çš„å›¾åƒã€‚è¯¥æ•°æ®é›†æ˜¯åœ¨è¡Œè½¦é€Ÿåº¦ä¸‹è·å¾—çš„ï¼Œä½¿ç”¨Aigle-RNç³»ç»Ÿå®šæœŸç›‘æµ‹æ³•å›½è·¯é¢çŠ¶å†µã€‚</p><p>ESARæ˜¯ç”±ä¸€ä¸ªæ²¡æœ‰æ§åˆ¶ç…§æ˜çš„é™æ€é‡‡é›†ç³»ç»Ÿè·å¾—çš„ã€‚ESARæœ‰15å¼ å®Œæ•´æ³¨é‡Šçš„è£‚çº¹å›¾åƒã€‚</p><p>LCMSåŒ…å«5ä¸ªåƒç´ çº§çš„å¸¦æ³¨é‡Šçš„è£‚çº¹å›¾åƒã€‚</p><p>ç”±äºè¿™ä¸‰ä¸ªæ•°æ®é›†çš„å›¾åƒæ•°é‡è¾ƒå°‘ï¼Œå› æ­¤å°†å®ƒä»¬ç»„åˆåˆ°ä¸€ä¸ªåä¸ºAELçš„æ•°æ®é›†ä¸­è¿›è¡Œæ¨¡å‹è¯„ä¼°ã€‚</p><blockquote><p>Code for testing Deep Learning models for crack detection with CrackForest [<a href="https://github.com/cuilimeng/CrackForest-dataset]" target="_blank" rel="noopener">https://github.com/cuilimeng/CrackForest-dataset]</a> dataset; Aigle-RN and ESAR (2 out of the 3 parts of the â€œCrackDatasetâ€)[<a href="https://www.irit.fr/~Sylvie.Chambon/Crack_Detection_Database.html]" target="_blank" rel="noopener">https://www.irit.fr/~Sylvie.Chambon/Crack_Detection_Database.html]</a> datasets; and the cropped CRACK500, GAPs384 and cracktree200 [<a href="https://github.com/fyangneil/pavement-crack-detection]" target="_blank" rel="noopener">https://github.com/fyangneil/pavement-crack-detection]</a> datasets.</p><p><em>You should download the datasets from the corresponding links and cite the sources.</em></p></blockquote><h2 id="Structural-Defects-Network-SDNET-2018"><a href="#Structural-Defects-Network-SDNET-2018" class="headerlink" title="Structural Defects Network(SDNET)2018"></a>Structural Defects Network(SDNET)2018</h2><blockquote><p>åœ°å€ï¼š<a href="https://www.kaggle.com/aniruddhsharma/structural-defects-network-concrete-crack-images" target="_blank" rel="noopener">https://www.kaggle.com/aniruddhsharma/structural-defects-network-concrete-crack-images</a></p></blockquote><p>SDNET2018 is an annotated image dataset for training, validation, and benchmarking of artificial intelligence-based crack detection algorithms for concrete. SDNET2018 contains over 56,000 images of cracked and non-cracked concrete bridge decks, walls, and pavements. The dataset includes cracks as narrow as 0.06 mm and as wide as 25 mm. The dataset also includes images with a variety of obstructions, including shadows, surface roughness, scaling, edges, holes, and background debris. SDNET2018 will be useful for the continued development of concrete crack detection algorithms based on deep learning convolutional neural networks, which are a subject of continued research in the field of structural health monitoring.</p><p>230 images of cracked and non-cracked concrete surfaces (54 bridge decks, 72 walls, 104 pavements) are captured using a 16 MP Nikon digital camera. The bridge decks were located at the Utah State University system, material, and structural health (SMASH) laboratory. The inspected walls belong to Russell/Wanlass Performance Hall building located on USU campus The pavement images were acquired from the roads and sidewalks on USU campus. Each image is segmented into 256 Ã— 256 px sub-images. Each sub-image is labelled as â€˜Crackedâ€™ if there was a crack in the sub-image or â€˜Non-crackedâ€™ if there was not a crack.</p><h2 id="ç›®å‰å·²çŸ¥æœ€å¤§çš„åˆ†å‰²æ•°æ®é›†"><a href="#ç›®å‰å·²çŸ¥æœ€å¤§çš„åˆ†å‰²æ•°æ®é›†" class="headerlink" title="ç›®å‰å·²çŸ¥æœ€å¤§çš„åˆ†å‰²æ•°æ®é›†"></a>ç›®å‰å·²çŸ¥æœ€å¤§çš„åˆ†å‰²æ•°æ®é›†</h2><blockquote><p>githubåœ°å€ï¼š<a href="https://github.com/khanhha/crack_segmentation" target="_blank" rel="noopener">https://github.com/khanhha/crack_segmentation</a></p><p>æ•°æ®é›†åœ°å€ï¼ˆGoogle driveï¼‰:<a href="https://github.com/khanhha/crack_segmentation" target="_blank" rel="noopener">https://github.com/khanhha/crack_segmentation</a></p></blockquote><p>å›¾ç‰‡å¤§å°å‡ä¸ºï¼ˆ448ï¼Œ 448ï¼‰ï¼ŒåŒ…å«äº†11200å¼ å›¾ç‰‡ï¼Œä»ä¸€äº›è£‚ç¼åˆ†å‰²æ•°æ®é›†ï¼ˆ12ç§ï¼‰ä¸­åˆå¹¶è€Œæ¥ã€‚</p><p><em>The two folders images and masks contain all the images. The two folders train and test contain training and testing images splitted from the two above folder. The splitting is stratified so that the proportion of each dataset in the train and test folder are similar</em></p><h2 id="Road-Damage-Dataset-for-GRDDC-2020"><a href="#Road-Damage-Dataset-for-GRDDC-2020" class="headerlink" title="Road Damage Dataset for GRDDC 2020"></a>Road Damage Dataset for GRDDC 2020</h2><blockquote><p>åœ°å€ï¼š<a href="https://github.com/sekilab/RoadDamageDetector/" target="_blank" rel="noopener">https://github.com/sekilab/RoadDamageDetector/</a></p></blockquote><p>ä¸‹è½½åœ°å€ï¼š</p><ul><li><a href="https://mycityreport.s3-ap-northeast-1.amazonaws.com/02_RoadDamageDataset/public_data/IEEE_bigdata_RDD2020/train.tar.gz" target="_blank" rel="noopener">train.tar.gz</a><ul><li><code>train.tar.gz</code> contains Japan/India/Czech images and annotations. The format of annotations is the same as pascalVOC.</li></ul></li><li><a href="https://mycityreport.s3-ap-northeast-1.amazonaws.com/02_RoadDamageDataset/public_data/IEEE_bigdata_RDD2020/test1.tar.gz" target="_blank" rel="noopener">test1.tar.gz</a></li><li><a href="https://mycityreport.s3-ap-northeast-1.amazonaws.com/02_RoadDamageDataset/public_data/IEEE_bigdata_RDD2020/sampleSubmission.txt" target="_blank" rel="noopener">sampleSubmission.txt</a></li><li><a href="https://mycityreport.s3-ap-northeast-1.amazonaws.com/02_RoadDamageDataset/public_data/IEEE_bigdata_RDD2020/test2.tar.gz" target="_blank" rel="noopener">test2.tar.gz</a></li></ul><h2 id="Road-Damage-Dataset-2019"><a href="#Road-Damage-Dataset-2019" class="headerlink" title="Road Damage Dataset 2019"></a>Road Damage Dataset 2019</h2><blockquote><p>åœ°å€ï¼š<a href="https://github.com/sekilab/RoadDamageDetector/" target="_blank" rel="noopener">https://github.com/sekilab/RoadDamageDetector/</a></p></blockquote><p>ä¸‹è½½åœ°å€ï¼š</p><p>Please pay attention to the disk capacity when downloading.</p><ul><li>trainedModels<ul><li><a href="https://mycityreport.s3-ap-northeast-1.amazonaws.com/02_RoadDamageDataset/public_data/Japan/CACAIE2020/frozen_inference_graph_resnet.pb" target="_blank" rel="noopener">Resnet(128MB)</a></li><li><a href="https://mycityreport.s3-ap-northeast-1.amazonaws.com/02_RoadDamageDataset/public_data/Japan/CACAIE2020/frozen_inference_graph_mobilenet.pb" target="_blank" rel="noopener">Mobilenet(18MB)</a></li></ul></li><li><a href="https://mycityreport.s3-ap-northeast-1.amazonaws.com/02_RoadDamageDataset/public_data/Japan/RDD2020_data.tar.gz" target="_blank" rel="noopener">RoadDamageDataset_2019 (2.4GB)</a></li></ul><h2 id="Road-Damage-Dataset-2018"><a href="#Road-Damage-Dataset-2018" class="headerlink" title="Road Damage Dataset 2018"></a>Road Damage Dataset 2018</h2><blockquote><p>åœ°å€ï¼š<a href="https://github.com/sekilab/RoadDamageDetector/" target="_blank" rel="noopener">https://github.com/sekilab/RoadDamageDetector/</a></p></blockquote><p>ä¸‹è½½åœ°å€ï¼š</p><p>Please pay attention to the disk capacity when downloading.</p><ul><li><a href="https://mycityreport.s3-ap-northeast-1.amazonaws.com/02_RoadDamageDataset/public_data/Japan/CACAIE2018/trainedModels.tar.gz" target="_blank" rel="noopener">trainedModels (70MB)</a></li><li><a href="https://mycityreport.s3-ap-northeast-1.amazonaws.com/02_RoadDamageDataset/public_data/Japan/CACAIE2018/RoadDamageDataset.tar.gz" target="_blank" rel="noopener">RoadDamageDataset_v1 (1.7GB)</a></li></ul><h2 id="Dataset-Tutorial-about-Road-Damage-Dataset-above"><a href="#Dataset-Tutorial-about-Road-Damage-Dataset-above" class="headerlink" title="Dataset Tutorial about Road Damage Dataset above"></a><strong>Dataset Tutorial about Road Damage Dataset above</strong></h2><p>We also created the tutorial of Road Damage Dataset. In this tutorial, we will show you:</p><ul><li>How to download Road Crack Dataset</li><li>The structure of the Dataset</li><li>The statistical information of the dataset</li><li>How to use trained models.</li></ul><p>Please check <a href="https://github.com/sekilab/RoadDamageDetector/blob/master/RoadDamageDatasetTutorial.ipynb" target="_blank" rel="noopener">RoadDamageDatasetTutorial.ipynb</a>.</p><h2 id="PID-Pavement-Image-Dataset"><a href="#PID-Pavement-Image-Dataset" class="headerlink" title="PID Pavement Image Dataset"></a>PID Pavement Image Dataset</h2><blockquote><p>åšå®¢åœ°å€ï¼š<a href="https://github.com/hanshenChen/PID-Pavement-Image-Dataset" target="_blank" rel="noopener">https://github.com/hanshenChen/PID-Pavement-Image-Dataset</a></p></blockquote><p>è¿™é‡Œé¢æ˜¯åˆ©ç”¨Google mapæ‹æ‘„çš„å›¾ç‰‡ï¼Œå®é™…ä¸Šé™¤äº†æœ‰äº›æ¨¡ç³Šä¹‹å¤–è¿˜å¯ä»¥ï¼Œç›´æ¥æ”¾åˆ°äº†GitHubä¸Šä¾›ç›´æ¥ä¸‹è½½ã€‚</p><p><a href="https://imgtu.com/i/4X0eu8" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/10/04/4X0eu8.png" alt="æ ·ä¾‹"></a></p>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®é›† </tag>
            
            <tag> è·¯é¢è£‚ç¼æ£€æµ‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>practice mmdet</title>
      <link href="/2021/10/04/practice-mmdet/"/>
      <url>/2021/10/04/practice-mmdet/</url>
      
        <content type="html"><![CDATA[<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>All refer to the <a href="https://mmdetection.readthedocs.io/en/latest/get_started.html" target="_blank" rel="noopener">Official website</a>. The environment is based on Ubuntu version 18.04.5, cuda version 11.0.228. </p><p>cuda version: <code>cat /usr/local/cuda/version.txt</code>  </p><p>Ubuntu version: <code>cat /etc/issue</code></p><p>OK, letâ€™s get started!</p><h1 id="Get-Started"><a href="#Get-Started" class="headerlink" title="Get Started"></a>Get Started</h1><h2 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h2><h3 id="Prepare-environment"><a href="#Prepare-environment" class="headerlink" title="Prepare environment"></a>Prepare environment</h3><ol><li><p>Create a conda virtual environment and activate it.</p><pre class="line-numbers language-shell"><code class="language-shell">conda create -n openmmlab python=3.7 -yconda activate openmmlab<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p>Install PyTorch and torchvision following the <a href="https://pytorch.org/" target="_blank" rel="noopener">official instructions</a>, here my own server is equipped with the cuda version 11.0.228. So I install the command:</p></li></ol><pre class="line-numbers language-shell"><code class="language-shell">conda install pytorch torchvision -c pytorch<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="Install-mmdet"><a href="#Install-mmdet" class="headerlink" title="Install mmdet"></a>Install mmdet</h3><p>Then we  install MMDetection manually:</p><ol><li><p>Install mmcv-full.</p><pre class="line-numbers language-shell"><code class="language-shell">pip install mmcv-full -f https://download.openmmlab.com/mmcv/dist/{cu_version}/{torch_version}/index.html<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ol><p>   Please replace <code>{cu_version}</code> and <code>{torch_version}</code> in the url to your desired one. For example, to install the latest <code>mmcv-full</code> with <code>CUDA 11.0</code> and <code>PyTorch 1.7.0</code>, use the following command:</p><pre class="line-numbers language-shell"><code class="language-shell">   pip install mmcv-full -f https://download.openmmlab.com/mmcv/dist/cu110/torch1.7.0/index.html<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>   See <a href="https://github.com/open-mmlab/mmcv#installation" target="_blank" rel="noopener">here</a> for different versions of MMCV compatible to different PyTorch and CUDA versions.</p><p>   Optionally you can compile mmcv from source if you need to develop both mmcv and mmdet. Refer to the <a href="https://github.com/open-mmlab/mmcv#installation" target="_blank" rel="noopener">guide</a> for details.</p><ol start="2"><li><p>Install MMDetection.</p><p>You can simply install mmdetection with the following command:</p><pre class="line-numbers language-shell"><code class="language-shell">pip install mmdet<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>or clone the repository and then install it:</p><pre class="line-numbers language-shell"><code class="language-shell">git clone https://github.com/open-mmlab/mmdetection.gitcd mmdetectionpip install -r requirements/build.txtpip install -v -e .  # or "python setup.py develop"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>Install extra dependencies for Instaboost, Panoptic Segmentation, LVIS dataset, or Albumentations.</p><pre class="line-numbers language-shell"><code class="language-shell"># for instaboostpip install instaboostfast# for panoptic segmentationpip install git+https://github.com/cocodataset/panopticapi.git# for LVIS datasetpip install git+https://github.com/lvis-dataset/lvis-api.git# for albumentationspip install albumentations>=0.3.2 --no-binary imgaug,albumentations<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><h2 id="Verification"><a href="#Verification" class="headerlink" title="Verification"></a>Verification</h2><p>To verify whether MMDetection is installed correctly, we can run the following sample code to initialize a detector and inference a demo image.</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> mmdet<span class="token punctuation">.</span>apis <span class="token keyword">import</span> init_detector<span class="token punctuation">,</span> inference_detectorconfig_file <span class="token operator">=</span> <span class="token string">'configs/faster_rcnn/faster_rcnn_r50_fpn_1x_coco.py'</span><span class="token comment" spellcheck="true"># download the checkpoint from model zoo and put it in `checkpoints/`</span><span class="token comment" spellcheck="true"># url: https://download.openmmlab.com/mmdetection/v2.0/faster_rcnn/faster_rcnn_r50_fpn_1x_coco/faster_rcnn_r50_fpn_1x_coco_20200130-047c8118.pth</span>checkpoint_file <span class="token operator">=</span> <span class="token string">'checkpoints/faster_rcnn_r50_fpn_1x_coco_20200130-047c8118.pth'</span>device <span class="token operator">=</span> <span class="token string">'cuda:0'</span><span class="token comment" spellcheck="true"># init a detector</span>model <span class="token operator">=</span> init_detector<span class="token punctuation">(</span>config_file<span class="token punctuation">,</span> checkpoint_file<span class="token punctuation">,</span> device<span class="token operator">=</span>device<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># inference the demo image</span>inference_detector<span class="token punctuation">(</span>model<span class="token punctuation">,</span> <span class="token string">'demo/demo.jpg'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>The above code is supposed to run successfully upon you finish the installation.</p><h2 id="Benchmark-and-Model-Zoo"><a href="#Benchmark-and-Model-Zoo" class="headerlink" title="Benchmark and Model Zoo"></a>Benchmark and Model Zoo</h2><p>å…³äºè¿™æ–¹é¢ï¼Œè¯·å‚é˜…å®˜ç½‘æ–‡æ¡£ï¼Œå› ä¸ºå®˜ç½‘æ–‡æ¡£è¯´å¾—éå¸¸è¯¦ç»†ï¼Œæˆ‘è‡ªå·±å°±æ˜¯æ€»ç»“ä¹Ÿåªæ˜¯å¤åˆ¶ç²˜è´´å®˜ç½‘çš„æ•°æ®ï¼Œæ²¡æœ‰è¿™ä¸ªå¿…è¦ã€‚</p><blockquote><p>å®˜ç½‘: <a href="https://mmdetection.readthedocs.io/en/latest/model_zoo.html" target="_blank" rel="noopener">https://mmdetection.readthedocs.io/en/latest/model_zoo.html</a></p></blockquote><ul><li>åªä½¿ç”¨é˜¿é‡Œäº‘æ¥å­˜å‚¨model zoo</li><li>æ‰€æœ‰çš„modeléƒ½åœ¨<code>coco_2017_train</code>ä¸Šè®­ç»ƒï¼Œ åœ¨<code>coco_2017_val</code>ä¸Šæµ‹è¯•</li><li>ä½¿ç”¨åˆ†å¸ƒå¼è®­ç»ƒ</li><li>All pytorch-style pretrained backbones on ImageNet are from PyTorch model zoo, caffe-style pretrained backbones are converted from the newly released model from detectron2.</li></ul><h1 id="Quick-Run"><a href="#Quick-Run" class="headerlink" title="Quick Run"></a>Quick Run</h1><h2 id="1-Inference-and-train-with-existing-models-and-standard-datasets"><a href="#1-Inference-and-train-with-existing-models-and-standard-datasets" class="headerlink" title="1: Inference and train with existing models and standard datasets"></a>1: Inference and train with existing models and standard datasets</h2><h3 id="Preface-1"><a href="#Preface-1" class="headerlink" title="Preface"></a>Preface</h3><p>è¿™é‡Œæœ‰å¿…è¦æå‰è¯´ä¸€ä¸‹ä»€ä¹ˆæ˜¯<code>Inference</code>æ˜¯ä»€ä¹ˆ, å®é™…ä¸Šä¸ªäººçš„ç†è§£å°±æ˜¯å’Œpredictionå®é™…ä¸Šå·®ä¸å¤ªå¤šï¼Œå°±æ˜¯ä¸€ä¸ªå‰å‘ä¼ æ’­å¾—è¿‡ç¨‹ï¼Œè¯´æ­£è§„ä¸€ç‚¹å«åšæŠŠè®­ç»ƒçš„æ–¹æ³•ç”¨åˆ°æˆ‘ä»¬çš„å·¥ä½œåº”ç”¨ä¸Šå»ã€‚</p><p>MMDetectionæä¾›äº†ä¸Šç™¾ä¸ªå·²ç»å­˜åœ¨çš„detection modelsåœ¨æˆ‘ä»¬çš„  <a href="https://mmdetection.readthedocs.io/en/latest/model_zoo.html" target="_blank" rel="noopener">Model Zoo</a>ã€‚å¹¶ä¸”æ”¯æŒå¤šç§æ ‡å‡†çš„æ•°æ®é›†ï¼ŒåŒ…æ‹¬Pascal VOC, COCO, CityScapes, LVIS, ç­‰ç­‰ã€‚æˆ‘ä»¬æ¥ä¸‹æ¥ä¼šç»§ç»­å­¦ä¹ å¦‚ä½•åœ¨è¿™äº›å·²ç»å­˜åœ¨çš„modelsä¸Šè¿è¡Œä¸€äº›ä»»åŠ¡ä¸æ ‡å‡†çš„æ•°æ®é›†ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li>åœ¨ç»™å®šçš„æ•°æ®ï¼ˆå›¾ç‰‡ï¼‰ä¸Šä½¿ç”¨æˆ‘ä»¬è®­ç»ƒå¥½çš„æ¨¡å‹</li><li>æµ‹è¯•å·²ç»å­˜åœ¨çš„modelsåœ¨æ ‡å‡†æ•°æ®é›†ä¸Šã€‚</li><li>åœ¨æ ‡å‡†æ•°æ®é›†ä¸Šè®­ç»ƒæˆ‘ä»¬çš„é¢„å®šä¹‰å¥½çš„æ¨¡å‹</li></ul><h3 id="Inference-with-existing-models"><a href="#Inference-with-existing-models" class="headerlink" title="Inference with existing models"></a>Inference with existing models</h3><p>æˆ‘ä»¬æƒ³è¦ä½¿ç”¨æˆ‘ä»¬çš„è®­ç»ƒå¥½çš„æ¨¡å‹ç›´æ¥æ¥é¢„æµ‹æˆ‘ä»¬çš„imagesã€‚åœ¨MMDetectionï¼Œä¸€ä¸ªæ¨¡å‹è¢«ä¸€ä¸ªconfiguration fileå’Œä¿å­˜åœ¨checkpoint fileä¸­çš„å·²ç»å­˜åœ¨çš„model parametersæ¥å®šä¹‰ã€‚</p><p>å¼€å§‹å…¥é—¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ¨èä½¿ç”¨ <a href="https://github.com/open-mmlab/mmdetection/tree/master/configs/faster_rcnn" target="_blank" rel="noopener">Faster RCNN</a> with this <a href="https://github.com/open-mmlab/mmdetection/blob/master/configs/faster_rcnn/faster_rcnn_r50_fpn_1x_coco.py" target="_blank" rel="noopener">configuration file</a> and this <a href="https://download.openmmlab.com/mmdetection/v2.0/faster_rcnn/faster_rcnn_r50_fpn_1x_coco/faster_rcnn_r50_fpn_1x_coco_20200130-047c8118.pth" target="_blank" rel="noopener">checkpoint file</a>. æˆ‘ä»¬æœ€å¥½å°†æˆ‘ä»¬çš„è¿™ä¸ªcheckpoint fileä¸‹è½½åˆ°æˆ‘ä»¬çš„<code>checkpoints</code>ç›®å½•ä¸‹ã€‚</p><h4 id="High-level-APIs-for-inference"><a href="#High-level-APIs-for-inference" class="headerlink" title="High-level APIs for inference"></a>High-level APIs for inference</h4><p>MMDetection provide high-level Python APIs for inference on images.è¿™é‡Œæœ‰ä¸€ä¸ªåœ¨ç»™å®šçš„å›¾ç‰‡æˆ–æ˜¯è§†é¢‘ä¸‹çš„å»ºç«‹æ¨¡å‹ä¸è¿›è¡Œæ¨æ–­çš„ä¾‹å­ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> mmdet<span class="token punctuation">.</span>apis <span class="token keyword">import</span> init_detector<span class="token punctuation">,</span> inference_detector <span class="token comment" spellcheck="true"># å¯¼å…¥ç›¸åº”æ¨¡å—</span><span class="token keyword">import</span> mmcv<span class="token comment" spellcheck="true"># Specify the path to model config and checkpoint file</span>config_file <span class="token operator">=</span> <span class="token string">'configs/faster_rcnn/faster_rcnn_r50_fpn_1x_coco.py'</span>checkpoint_file <span class="token operator">=</span> <span class="token string">'checkpoints/faster_rcnn_r50_fpn_1x_coco_20200130-047c8118.pth'</span><span class="token comment" spellcheck="true"># build the model from a config file and a checkpoint file</span>model <span class="token operator">=</span> init_detector<span class="token punctuation">(</span>config_file<span class="token punctuation">,</span> checkpoint_file<span class="token punctuation">,</span> device<span class="token operator">=</span><span class="token string">'cuda:0'</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># åˆå§‹åŒ–æ¨¡å‹ï¼ŒåŒ…æ‹¬åŸºæœ¬é…ç½®configä»¥åŠæˆ‘ä»¬çš„å‚æ•°</span><span class="token comment" spellcheck="true"># test a single image and show the results</span>img <span class="token operator">=</span> <span class="token string">'test.jpg'</span>  <span class="token comment" spellcheck="true"># or img = mmcv.imread(img), which will only load it once</span>result <span class="token operator">=</span> inference_detector<span class="token punctuation">(</span>model<span class="token punctuation">,</span> img<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># é¢„æµ‹</span><span class="token comment" spellcheck="true"># visualize the results in a new window</span>model<span class="token punctuation">.</span>show_result<span class="token punctuation">(</span>img<span class="token punctuation">,</span> result<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># å¯è§†åŒ–å±•ç¤ºç»“æœ</span><span class="token comment" spellcheck="true"># or save the visualization results to image files</span>model<span class="token punctuation">.</span>show_result<span class="token punctuation">(</span>img<span class="token punctuation">,</span> result<span class="token punctuation">,</span> out_file<span class="token operator">=</span><span class="token string">'result.jpg'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># å°†ç»“æœå¯è§†åŒ–å¹¶ä¿å­˜åˆ°result.jpgä¸­ã€‚</span><span class="token comment" spellcheck="true"># test a video and show the results</span>video <span class="token operator">=</span> mmcv<span class="token punctuation">.</span>VideoReader<span class="token punctuation">(</span><span class="token string">'video.mp4'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># åˆ©ç”¨mmcvæ¥è¯»å–è§†é¢‘</span><span class="token keyword">for</span> frame <span class="token keyword">in</span> video<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># å¯¹äºå›¾ç‰‡çš„æ¯ä¸€å¸§è¿›è¡Œç›¸åº”çš„è¯†åˆ«æ¨æ–­ã€‚</span>    result <span class="token operator">=</span> inference_detector<span class="token punctuation">(</span>model<span class="token punctuation">,</span> frame<span class="token punctuation">)</span>    model<span class="token punctuation">.</span>show_result<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> result<span class="token punctuation">,</span> wait_time<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>A notebook demo can be found in <a href="https://github.com/open-mmlab/mmdetection/blob/master/demo/inference_demo.ipynb" target="_blank" rel="noopener">demo/inference_demo.ipynb</a>.</p><p>Note: <code>inference_detector</code> only supports single-image inference for now.</p><p>è¿™é‡Œé¢æˆ‘è‡ªå·±åˆé‡æ–°å®šä¹‰å†™äº†ä¸€éå¤šç§å›¾åƒçš„inferenceï¼Œå®é™…ä¸Šå°±æ˜¯åŠ äº†ä¸ªå¾ªç¯ï¼Œä¸æ˜¯æˆ‘ä»¬çš„é‚£ç§batch_sizeçš„é‚£ç§ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># å¯¼å…¥ç›¸åº”åº“</span><span class="token keyword">from</span> mmdet<span class="token punctuation">.</span>apis <span class="token keyword">import</span> init_detector<span class="token punctuation">,</span> inference_detector<span class="token keyword">import</span> mmcv<span class="token keyword">import</span> os<span class="token comment" spellcheck="true"># åŠ è½½å›¾ç‰‡</span>root <span class="token operator">=</span> <span class="token string">'/home/lry/data/PennFudanPed/PNGImages/'</span>imgs <span class="token operator">=</span> list<span class="token punctuation">(</span>sorted<span class="token punctuation">(</span>os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># ç›¸å…³é…ç½®æ–‡ä»¶</span>config_file <span class="token operator">=</span> <span class="token string">"/home/lry/envs/miniconda3/envs/openmmlab/lib/python3.7/site-packages/mmdet/.mim/configs/faster_rcnn/faster_rcnn_r50_fpn_1x_coco.py"</span> checkpoint_file <span class="token operator">=</span> <span class="token string">"checkpoints/faster_rcnn_r50_fpn_1x_coco_20200130-047c8118.pth"</span><span class="token comment" spellcheck="true"># åŠ è½½æ¨¡å‹</span>model <span class="token operator">=</span> init_detector<span class="token punctuation">(</span>config<span class="token operator">=</span>config_file<span class="token punctuation">,</span> checkpoint<span class="token operator">=</span>checkpoint_file<span class="token punctuation">,</span> device<span class="token operator">=</span><span class="token string">'cuda:0'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># è¿›è¡Œæ¨æ–­</span><span class="token keyword">if</span> <span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">'answer'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    root_ <span class="token operator">=</span> os<span class="token punctuation">.</span>getcwd<span class="token punctuation">(</span><span class="token punctuation">)</span>    os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>root_ <span class="token operator">+</span> <span class="token string">'/answer'</span><span class="token punctuation">)</span><span class="token keyword">for</span> img <span class="token keyword">in</span> imgs<span class="token punctuation">:</span>    img <span class="token operator">=</span> root <span class="token operator">+</span> img    result <span class="token operator">=</span> inference_detector<span class="token punctuation">(</span>model<span class="token punctuation">,</span> img<span class="token punctuation">)</span>    model<span class="token punctuation">.</span>show_result<span class="token punctuation">(</span>img<span class="token punctuation">,</span> result<span class="token punctuation">,</span> out_file<span class="token operator">=</span>f<span class="token string">'answers/hello{img[-7:]}'</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>f<span class="token string">'{img[-7:]} is finished!'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all is finished!'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ•ˆæœè¿˜ç®—å¯ä»¥å§ï¼š</p><p><a href="https://imgtu.com/i/4jvWE6" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/10/05/4jvWE6.png" alt="output"></a></p><h4 id="Asynchronous-interface-supported-for-Python-3-7"><a href="#Asynchronous-interface-supported-for-Python-3-7" class="headerlink" title="Asynchronous interface - supported for Python 3.7+"></a>Asynchronous interface - supported for Python 3.7+</h4><blockquote><p>asynchronous   <strong>adj.</strong>ä¸åŒæ—¶å­˜åœ¨ï¼ˆæˆ–å‘ç”Ÿï¼‰çš„ï¼›éå…±æ—¶çš„</p><ol><li><p>This communication is said to be asynchronous because events do not arrive immediately in response to requests, but some time later. </p><p>ä¹‹æ‰€ä»¥ç§°ä¸ºå¼‚æ­¥ï¼Œæ˜¯å› ä¸ºè¯·æ±‚å“åº”ä¸æ˜¯ç«‹åˆ»å‘ç”Ÿçš„ï¼Œè€Œæ˜¯è¦ç­‰ä¸€æ®µæ—¶é—´ã€‚</p><p><a href="http://www.ibm.com" target="_blank" rel="noopener">www.ibm.com</a></p></li><li><p>Once that occurs, you can think of your application as any other app, asynchronous or not. </p><p>é™¤æ­¤ä»¥å¤–ï¼Œå¯ä»¥å°†æ‚¨çš„åº”ç”¨ç¨‹åºçœ‹ä½œå…¶ä»–åº”ç”¨ç¨‹åºä¸€æ ·ï¼Œæ— è®ºæ˜¯å¦å¼‚æ­¥ã€‚</p><p><a href="http://www.ibm.com" target="_blank" rel="noopener">www.ibm.com</a></p></li><li><p>Unfortunately the very nature of an asynchronous call means that delegates cannot be inlined. </p><p>ä¸å¹¸çš„æ˜¯ï¼Œå¼‚æ­¥è°ƒç”¨çš„æœ¬è´¨æ„å‘³ç€ä¸èƒ½å†…è”å§”æ‰˜ï¼ˆdelegatescannotbeinlinedï¼‰ã€‚</p><p><a href="http://www.infoq.com" target="_blank" rel="noopener">www.infoq.com</a></p></li><li><p>Furthermore, there is quite a bit of boilerplate code involved in setting up an asynchronous call. </p><p>æ­¤å¤–ï¼Œåœ¨å»ºç«‹å¼‚æ­¥è°ƒç”¨æ—¶è¿˜åŒ…æ‹¬ä¸å°‘æ ·æ¿ä»£ç ã€‚</p></li></ol></blockquote><p>å¯¹äº3.7+çš„pythonå¯ä»¥ä½¿ç”¨å¼‚æ­¥æ¨æ–­ã€‚ </p><ul><li>By utilizing CUDA streams, it allows not to block CPU on GPU bound inference code and enables better CPU/GPU utilization for single-threaded application</li><li>Inference can be done concurrently either between different input data samples or between different models of some inference pipeline.</li></ul><p><del>è¿™é‡Œé™äºæœ¬äººçš„ç¿»è¯‘æ°´å¹³å’Œä¸ªäººçŸ¥è¯†èƒ½åŠ›ï¼Œè¿™é‡Œæš‚æ—¶æ²¡æ³•ç¿»è¯‘ï¼Œæ‰€ä»¥ç›´æ¥æŠ„åŸæ–‡äº†</del></p><p>See <code>tests/async_benchmark.py</code> to compare the speed of synchronous and asynchronous interfacesï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> asyncio<span class="token keyword">import</span> torch<span class="token keyword">from</span> mmdet<span class="token punctuation">.</span>apis <span class="token keyword">import</span> init_detector<span class="token punctuation">,</span> async_inference_detector<span class="token keyword">from</span> mmdet<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>contextmanagers <span class="token keyword">import</span> concurrent<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    config_file <span class="token operator">=</span> <span class="token string">'configs/faster_rcnn/faster_rcnn_r50_fpn_1x_coco.py'</span>    checkpoint_file <span class="token operator">=</span> <span class="token string">'checkpoints/faster_rcnn_r50_fpn_1x_coco_20200130-047c8118.pth'</span>    device <span class="token operator">=</span> <span class="token string">'cuda:0'</span>    model <span class="token operator">=</span> init_detector<span class="token punctuation">(</span>config_file<span class="token punctuation">,</span> checkpoint<span class="token operator">=</span>checkpoint_file<span class="token punctuation">,</span> device<span class="token operator">=</span>device<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># queue is used for concurrent inference of multiple images</span>    streamqueue <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>Queue<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># queue size defines concurrency level</span>    streamqueue_size <span class="token operator">=</span> <span class="token number">3</span>    <span class="token keyword">for</span> _ <span class="token keyword">in</span> range<span class="token punctuation">(</span>streamqueue_size<span class="token punctuation">)</span><span class="token punctuation">:</span>        streamqueue<span class="token punctuation">.</span>put_nowait<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>Stream<span class="token punctuation">(</span>device<span class="token operator">=</span>device<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># test a single image and show the results</span>    img <span class="token operator">=</span> <span class="token string">'test.jpg'</span>  <span class="token comment" spellcheck="true"># or img = mmcv.imread(img), which will only load it once</span>    <span class="token keyword">async</span> <span class="token keyword">with</span> concurrent<span class="token punctuation">(</span>streamqueue<span class="token punctuation">)</span><span class="token punctuation">:</span>        result <span class="token operator">=</span> <span class="token keyword">await</span> async_inference_detector<span class="token punctuation">(</span>model<span class="token punctuation">,</span> img<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># visualize the results in a new window</span>    model<span class="token punctuation">.</span>show_result<span class="token punctuation">(</span>img<span class="token punctuation">,</span> result<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># or save the visualization results to image files</span>    model<span class="token punctuation">.</span>show_result<span class="token punctuation">(</span>img<span class="token punctuation">,</span> result<span class="token punctuation">,</span> out_file<span class="token operator">=</span><span class="token string">'result.jpg'</span><span class="token punctuation">)</span>asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿è¡Œèµ·æ¥æœ‰ä¸€äº›æŠ¥é”™ï¼Œå› ä¸ºæˆ‘ç›®å‰å¯¹è¿™äº›ä¸œè¥¿ä¹Ÿä¸æ˜¯ç‰¹åˆ«äº†è§£ï¼Œæ‰€ä»¥ç›®å‰æ²¡æœ‰åŠæ³•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè€Œä¸”ä¼¼ä¹æˆ‘ä»¬åœ¨IPython, <a href="https://stackoverflow.com/questions/55409641/asyncio-run-cannot-be-called-from-a-running-event-loop" target="_blank" rel="noopener">Jupyter notebook</a>, .pyæ–‡ä»¶ä¸­è¿è¡Œçš„æ–¹å¼éƒ½ä¸ä¸€æ ·ï¼Œæœ‰æ—¶é—´å¯ä»¥æ¢ç´¢ä¸€ä¸‹ã€‚</p><h4 id="Demos"><a href="#Demos" class="headerlink" title="Demos"></a>Demos</h4><p>We also provide three demo scripts, implemented with high-level APIs and supporting functionality codes. Source codes are available <a href="https://github.com/open-mmlab/mmdetection/tree/master/demo" target="_blank" rel="noopener">here</a>.</p><h5 id="Image-demo"><a href="#Image-demo" class="headerlink" title="Image demo"></a>Image demo</h5><p>This script performs inference on a single image.</p><pre class="line-numbers language-shell"><code class="language-shell">python demo/image_demo.py \    ${IMAGE_FILE} \    ${CONFIG_FILE} \    ${CHECKPOINT_FILE} \    [--device ${GPU_ID}] \    [--score-thr ${SCORE_THR}]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="Examples"><a href="#Examples" class="headerlink" title="Examples:"></a>Examples:</h5><pre class="line-numbers language-shell"><code class="language-shell">python demo/image_demo.py demo/demo.jpg \    configs/faster_rcnn/faster_rcnn_r50_fpn_1x_coco.py \    checkpoints/faster_rcnn_r50_fpn_1x_coco_20200130-047c8118.pth \    --device cpu<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h5 id="Webcam-demo"><a href="#Webcam-demo" class="headerlink" title="Webcam demo"></a>Webcam demo</h5><p>This is a live demo from a webcam.</p><pre class="line-numbers language-shell"><code class="language-shell">python demo/webcam_demo.py \    ${CONFIG_FILE} \    ${CHECKPOINT_FILE} \    [--device ${GPU_ID}] \    [--camera-id ${CAMERA-ID}] \    [--score-thr ${SCORE_THR}]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Examples:</p><pre class="line-numbers language-shell"><code class="language-shell">python demo/webcam_demo.py \    configs/faster_rcnn/faster_rcnn_r50_fpn_1x_coco.py \    checkpoints/faster_rcnn_r50_fpn_1x_coco_20200130-047c8118.pth<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h5 id="Video-demo"><a href="#Video-demo" class="headerlink" title="Video demo"></a>Video demo</h5><p>This script performs inference on a video.</p><pre class="line-numbers language-shell"><code class="language-shell">python demo/video_demo.py \    ${VIDEO_FILE} \    ${CONFIG_FILE} \    ${CHECKPOINT_FILE} \    [--device ${GPU_ID}] \    [--score-thr ${SCORE_THR}] \    [--out ${OUT_FILE}] \    [--show] \    [--wait-time ${WAIT_TIME}]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Examples:</p><pre class="line-numbers language-shell"><code class="language-shell">python demo/video_demo.py demo/demo.mp4 \    configs/faster_rcnn/faster_rcnn_r50_fpn_1x_coco.py \    checkpoints/faster_rcnn_r50_fpn_1x_coco_20200130-047c8118.pth \    --out result.mp4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ä¸‹æ¥ä¸€ç¯‡åšå®¢å°†ä¼šæ¢ç´¢ä¸€ä¸‹ä»–ç»™å‡ºçš„ä¸‰ä¸ªdemoçš„ä»£ç è§£æä¸ç†è§£ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç›®æ ‡æ£€æµ‹ </tag>
            
            <tag> mmdet </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>YOLOv1ç²¾è¯»</title>
      <link href="/2021/09/30/yolov1-jing-du/"/>
      <url>/2021/09/30/yolov1-jing-du/</url>
      
        <content type="html"><![CDATA[<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>YOLOv1å®é™…ä¸Šå·²ç»çœ‹è¿‡äº†ï¼Œä¹Ÿè®°è¿‡ç¬”è®°äº†ï¼Œä½†æ˜¯ä»£ç éƒ¨åˆ†æ€»æ˜¯çœ‹å¾—æ¯”è¾ƒæ¨¡æ¨¡ç³Šç³Šçš„æ„Ÿè§‰ã€‚è¿˜æ˜¯ç®—æ³•åŸç†è¿™éƒ¨åˆ†æ²¡æœ‰å®Œå…¨æŒæ¡å®é™…ä¸Šã€‚å¦å¤–æ·±åº¦å­¦ä¹ å­¦ç€å­¦ç€æ˜æ˜¾å¯ä»¥æ„Ÿè§‰åˆ°å®é™…ä¸Šä¹‹å‰çš„åŸºç¡€å­¦å¾—è¿˜æ˜¯ä¸å¤ªå¥½ã€‚ä»¥åæœ‰æ—¶é—´éœ€è¦å¤šé‡å¤åˆ·ä¸€åˆ·æå®æ¯…å’Œå´æ©è¾¾ï¼Œ</p><blockquote><p> æå®æ¯…è§†é¢‘æœ‰ä¸€ä½å¤§ä½¬è®°çš„ç¬”è®°éå¸¸å¥½ï¼š<a href="https://sakura-gh.github.io/ML-notes/" target="_blank" rel="noopener">https://sakura-gh.github.io/ML-notes/</a></p></blockquote><p>å¦å¤–å°±æ˜¯æˆ‘ä»¬çš„å…³äºè®ºæ–‡ç²¾åº¦ï¼Œæœ¬äººæ‰“ç®—è·Ÿç€Bç«™åŒæµå¤§ä½¬å­¦ä¹ ï¼Œä»–å‘å¸ƒäº†å¾ˆå¤šç²¾åº¦AIè®ºæ–‡çš„è§†é¢‘ï¼ŒçœŸæ˜¯<strong>å®è—UPä¸»</strong>ï¼ï¼ï¼ˆå®é™…ä¸Šçœ‹å®Œè§†é¢‘æ‰å‘ç°è¯¥UPä¸»è®²çš„ä¸æ˜¯é‚£ä¹ˆæ¸…æ™°è‡³å°‘åœ¨å‰é¢ç®—æ³•ç²¾è®²é˜¶æ®µï¼Œä¸è¿‡ç®—æ³•ç²¾è®²é˜¶æ®µç»™æˆ‘å¸¦æ¥æœ€å¤§æ”¶è·å¯èƒ½å°±æ˜¯é¢˜ç›®ï¼š<strong>æˆ‘ä»¬éœ€è¦è®²ç®—æ³•åˆ†ä¸ºé¢„æµ‹å’Œè®­ç»ƒä¸¤ä¸ªé˜¶æ®µ</strong>ã€‚ è¯¥è§†é¢‘è¿˜æ˜¯å€¼å¾—ä¸€çœ‹çš„ã€‚èƒ½äº†è§£è®¸å¤šå…³äºYOLOçš„èŠ±çµ®ã€‚</p><p>æˆ‘ä¹Ÿæ˜¯çœ‹å®Œè¿™ä¸ªè§†é¢‘æ‰å‘ç°æˆ‘å®é™…ä¸Šå¾ˆå¤šYOLOåŸºç¡€å†…å®¹å­¦çš„å…¶å®ä¹Ÿè¿˜ç®—æ‰å®äº†ï¼Œæ²¡å¿…è¦å†çœ‹ä¸€éäº†ã€‚</p><blockquote><p>UPä¸»YOLOv1è§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV15w411Z7LG?p=4&amp;spm_id_from=pageDriver" target="_blank" rel="noopener">https://www.bilibili.com/video/BV15w411Z7LG?p=4&amp;spm_id_from=pageDriver</a></p></blockquote><h1 id="ç›®æ ‡æ£€æµ‹ç»¼è¿°"><a href="#ç›®æ ‡æ£€æµ‹ç»¼è¿°" class="headerlink" title="ç›®æ ‡æ£€æµ‹ç»¼è¿°"></a>ç›®æ ‡æ£€æµ‹ç»¼è¿°</h1><p>è®¡ç®—æœºè§†è§‰è§£å†³é—®é¢˜ï¼Œåˆ†ç±»ã€æ£€æµ‹ã€åˆ†å‰²ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20210930212438.png" alt="Computer Vision tasks"></p><p>æˆ‘ä»¬æ¥ç€çœ‹ï¼š</p><p>å›¾åƒåˆ†ç±»æ˜¯è¾“å…¥å›¾ç‰‡ï¼Œè¾“å‡ºåˆ†ç±»ã€‚ç›®æ ‡æ£€æµ‹æ˜¯ è¾“å…¥å›¾ç‰‡è¾“å‡ºå›¾ç‰‡ä¸­çš„æ¯ä¸€ä¸ªç‰©ä½“ç±»åˆ«å¹¶æŠŠæ‰€æœ‰çš„æ¯ä¸€ä¸ªç‰©ä½“éƒ½æ¡†å‡ºæ¥ã€‚åˆ†å‰²åˆ†ä¸ºä¸¤ç§ï¼šåˆ†ä¸ºSemantic Segmentationè¯­ä¹‰åˆ†å‰²ä¸Instance Segementationå®ä¾‹åˆ†å‰²ã€‚è¯­ä¹‰åˆ†å‰²å°±æ˜¯å¯¹æ¯ä¸€ä¸ªåƒç´ åˆ†ç±»ï¼Œæˆ‘ä¸ç®¡è¿™ä¸ªåƒç´ pixelæ˜¯å±äºå“ªä¸€ä¸ªç‰©ä½“çš„ï¼Œæˆ‘åªç®¡è¿™ä¸ªåƒç´ æ˜¯å“ªä¸€ä¸ªç±»åˆ«çš„ï¼Œæœ‰ç‚¹åƒç²¾ç¡®åˆ°åƒç´ çš„åˆ†ç±»ï¼Œä¸ä¼šå»åŒºåˆ†åŒä¸€ç±»ç‰©ä½“çš„ä¸åŒå®ä¾‹ã€‚è€Œæˆ‘ä»¬å®ä¾‹åˆ†å‰²è¦æŠŠåŒä¸€ä¸ªç±»åˆ«çš„ä¸åŒå®ä¾‹æ¥åˆ†å‰²åŒºåˆ«å‡ºæ¥ã€‚å¯ä»¥çœ‹ä¸€å¼ å›¾è¾…åŠ©ç†è§£ä¸‹ä»¥ä¸Šæ¦‚å¿µï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20210930212838.png" alt></p><p>å½“ç„¶å¯èƒ½çœ‹å®Œè¿™å¼ å¯¹æ¯”å›¾å¯¹äºè¯­ä¹‰åˆ†å‰²å®ä¾‹åˆ†å‰²çš„åŒºåˆ«è¿˜æ˜¯ä¸æ˜¯ç‰¹åˆ«æ¸…æ¥šï¼Œæˆ‘ä»¬å¯ä»¥æ¥ç€çœ‹ä¸€ä¸‹æ¥ä¸‹æ¥è¿™å¼ å›¾ï¼š</p><p><a href="https://imgtu.com/i/4ovPgO" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/09/30/4ovPgO.png" alt></a></p><p>æœ‰ä¸€ç¯‡è®²çš„éå¸¸å¥½çš„æ–‡ä»¶ç»¼è¿°ï¼š<em>Object Detection in 20 Years: A Survey</em>. åœ°å€åœ¨è¿™é‡Œï¼š<a href="https://arxiv.org/pdf/1905.05055.pdf" target="_blank" rel="noopener">https://arxiv.org/pdf/1905.05055.pdf</a> æ˜¯æˆ‘ä»¬ä¸­å›½äººå†™çš„ï¼Œå¯ä»¥è¯»ä¸€ä¸‹æ²¡äº‹çš„æ—¶å€™ã€‚æ€»ç»“äº†ä¸€ä¸‹ç›®æ ‡æ£€æµ‹çš„å‘å±•ã€‚</p><p>ç›®æ ‡æ£€æµ‹åˆ†ä¸ºä¸¤ä¸ªæ¨¡å—ï¼šä¸¤é˜¶æ®µï¼ˆ<em>tow-stage<em>ï¼‰å’Œå•é˜¶æ®µ(</em>one-stage</em>).è¿™ä¸ªå·²ç»éå¸¸ç†Ÿæ‚‰äº†ï¼Œä¸å¤šè®²äº†ã€‚ä¸¤é˜¶æ®µå°±æ˜¯å…ˆæå–å€™é€‰æ¡†åœ¨è¿›è¡Œåˆ†ç±»å®šä½ã€‚è€Œå•é˜¶æ®µå°±æ˜¯ç›´æ¥ç«¯åˆ°ç«¯å°±OKã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20210930214045.png" alt="Milestones"></p><p>ä¹‹å‰æ€»è¯´å•é˜¶æ®µå°ç›®æ ‡ã€å¤šç›®æ ‡ä¸å¤ªå¥½ï¼Œä½†é‚£æ˜¯ä¹‹å‰äº†ã€‚ç°åœ¨æ¥çœ‹ï¼Œæˆ‘ä»¬çš„yolov5å·²ç»éå¸¸å¥½äº†æ£€æµ‹æ¥çœ‹ã€‚</p><p>ä»¥ä¸‹è¿™å¼ å›¾æ˜¯YOLOv1çš„æå‡ºè€…åœ¨å­¦æœ¯ä¼šè®®ä¸Šå¯¹æ¯”äº†å½“æ—¶çš„DPMä¸RCNNç³»åˆ—ç®—æ³•ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20210930214304.png" alt="image-20210930214301910"></p><p>DPMæ˜¯åŸºäºä¼ ç»Ÿçš„æ–¹æ³•è¯†åˆ«ç‰¹å¾ï¼ŒåŸºäºæ¨¡æ¿çš„ï¼Œäººå·¥è®¾è®¡ç„¶ååˆ©ç”¨æ»‘åŠ¨çª—å£æ¥å¾€æ¨¡å‹ä¸Šå¥—ï¼Œæ˜æ˜¾äººå·¥è®¾è®¡è€Œä¸”æ»‘åŠ¨çª—å£åˆæ…¢å¹¶ä¸”é²æ£’æ€§åˆå·®ï¼Œæ•ˆæœä¸æ˜¯ç‰¹åˆ«å¥½ã€‚</p><p>RCNNå°±æ˜¯two-stageç®—æ³•ã€‚å…ˆä»å›¾åƒä¸­æå–2kä¸ªå€™é€‰æ¡†ï¼Œç„¶åæŠŠæ¯ä¸€ä¸ªæ¡†éƒ½æ”¾åˆ°è¿›å»è¯†åˆ«ï¼Œè™½ç„¶æ¯”è¾ƒæ…¢ï¼Œä½†æ˜¯å‡†ç¡®ç‡è¿˜å¯ä»¥ã€‚è¿™ä¸€ç³»åˆ—çš„ç®—æ³•å®é™…ä¸Šè¿˜å¯ä»¥ï¼Œä¹‹å‰åšå®¢ä¹Ÿä»‹ç»è¿‡äº†ï¼Œæºç ä¹Ÿä»‹ç»è¿‡äº†ã€‚</p><h1 id="ç®—æ³•ç²¾è®²ä¹‹é¢„æµ‹é˜¶æ®µï¼ˆå‰å‘æ¨æ–­ï¼‰"><a href="#ç®—æ³•ç²¾è®²ä¹‹é¢„æµ‹é˜¶æ®µï¼ˆå‰å‘æ¨æ–­ï¼‰" class="headerlink" title="ç®—æ³•ç²¾è®²ä¹‹é¢„æµ‹é˜¶æ®µï¼ˆå‰å‘æ¨æ–­ï¼‰"></a>ç®—æ³•ç²¾è®²ä¹‹é¢„æµ‹é˜¶æ®µï¼ˆå‰å‘æ¨æ–­ï¼‰</h1><p>å®é™…ä¸Šè®¸å¤šåšå®¢éƒ½æŠŠè®­ç»ƒé˜¶æ®µå’Œé¢„æµ‹é˜¶æ®µæ··ä¸ºä¸€è°ˆï¼Œæˆ‘ä»¬å…ˆçœ‹é¢„æµ‹é˜¶æ®µã€‚</p><p><strong>é¢„æµ‹é˜¶æ®µï¼š</strong> æ­¤æ—¶æˆ‘ä»¬æ¨¡å‹å·²ç»è®­ç»ƒå¥½äº†ï¼Œåªéœ€è¦è¿›è¡Œå‰å‘ä¼ æ’­ï¼Œä¸éœ€è¦åå‘ä¼ æ’­ã€‚å…ˆçœ‹ä¸€ä¸‹æˆ‘ä»¬çš„é¢„æµ‹é˜¶æ®µã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20210930215037.png" alt="YOLO AND YOLO-Tiny"></p><p>YOLO-Tinyè®ºæ–‡ä¸­æåˆ°è¿‡ï¼Œå°±æ˜¯ä¸€ä¸ªæ¯”è¾ƒå°ï¼Œæ¯”è¾ƒå¿«çš„ä¸€ä¸ªæ¨¡å‹ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20210930224106.png" alt="image-20210930224101536"></p><p>æˆ‘ä»¬è¾“å…¥ä¸€ä¸ªå›¾åƒï¼Œè¾“å‡ºä¸€ä¸ª7Ã—7Ã—30çš„ä¸€ä¸ªå¼ é‡ã€‚</p><p>å…³äº7Ã—7Ã—30ï¼Œåº”è¯¥ä¹Ÿä¸ç”¨å¤šè¯´äº†ï¼Œå› ä¸ºå·²ç»ç†Ÿæ‚‰çš„ä¸èƒ½å†ç†Ÿæ‚‰äº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20210930224219.png" alt="image-20210930224218188"></p><h1 id="ç®—æ³•ç²¾è®²ä¹‹è®­ç»ƒé˜¶æ®µ"><a href="#ç®—æ³•ç²¾è®²ä¹‹è®­ç»ƒé˜¶æ®µ" class="headerlink" title="ç®—æ³•ç²¾è®²ä¹‹è®­ç»ƒé˜¶æ®µ"></a>ç®—æ³•ç²¾è®²ä¹‹è®­ç»ƒé˜¶æ®µ</h1><p>ç›‘ç£å­¦ä¹ æ˜¯é€šè¿‡åå‘ä¼ æ’­ã€æ¢¯åº¦ä¸‹é™çš„æ–¹æ³•è¿›è¡Œè¿­ä»£å»å¾®è°ƒæƒé‡ä½¿å¾—æŸå¤±å‡½æ•°æœ€å°åŒ–çš„è¿‡ç¨‹ã€‚</p><p>æˆ‘ä»¬è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå·²ç»æœ‰ç›¸åº”çš„æ ‡æ³¨labelæ¥æ¡†å‡ºç‰©ä½“ï¼Œè€Œæˆ‘ä»¬å°±æ˜¯è¦å¯¹è¿™ä¸ªè¿›è¡Œç›¸åº”çš„é¢„æµ‹å»å°½å¯èƒ½åœ°ä½¿æˆ‘ä»¬çš„é¢„æµ‹ç»“æœå°½å¯èƒ½æ¥è¿‘è¿™ä¸ªæ¡†ã€‚</p><p>æ¯ä¸ªgrid cellåªèƒ½é¢„æµ‹å‡ºä¸€ä¸ªç±»åˆ«ç‰©ä½“ã€‚</p><ul><li>é¦–å…ˆï¼Œç”ŸæˆSÃ—Sä¸ª<code>grid cell</code>. </li><li>å¦‚æœæˆ‘ä»¬çš„ç‰©ä½“è½åœ¨æˆ‘ä»¬çš„æŸä¸ªgrid cellä¸­äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¼šé€‰æ‹©è¯¥grid cellè´Ÿè´£è¯¥ç‰©ä½“çš„é¢„æµ‹ã€‚æ¯ä¸ªgrid cellç”ŸæˆBä¸ªbbox, æ¯ä¸ªbboxéƒ½æœ‰4ä¸ªå‚æ•°ï¼š<em>x, y, w, h</em>, å¦å¤–è¿˜æœ‰ä¸€ä¸ªconfidence ,ç½®ä¿¡åº¦ï¼Œç”¨æ¥è¡¨ç¤ºè¯¥bboxå†…å«ç‰©ä½“çš„æ¦‚ç‡ã€‚ç½®ä¿¡åº¦çš„è®¡ç®—æ–¹å¼è¿˜æ¯”è¾ƒç®€å•ï¼šå¦‚æœæˆ‘ä»¬çš„ç‰©ä½“ä¸­å¿ƒç‚¹æ²¡æœ‰è½åœ¨è¯¥grid cellä¸­ï¼Œé‚£ä¹ˆè¯¥ç½®ä¿¡åº¦å®é™…ä¸Šåº”è¯¥ä¸º0ï¼Œæˆ‘ä»¬å°±åº”è¯¥è®©æˆ‘ä»¬çš„è®­ç»ƒç»“æœé€¼è¿‘äº0ï¼Œå¦‚æœè½åœ¨è¯¥grid cellç§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åº”è¯¥è®©è¯¥ç½®ä¿¡åº¦å°±é€¼è¿‘äºä¸GTçš„IOUã€‚è¿™ä¹ˆè¯´å¯èƒ½æœ‰äº›éš¾ç†è§£ï¼Œå°±æ˜¯ï¼Œæˆ‘ä»¬çš„confidenceçš„è®­ç»ƒç›®æ ‡å°±æ˜¯å¦‚æœä¸å«ç‰©ä½“é‚£ä¹ˆè®©å®ƒæ¥è¿‘äº0ï¼Œå¦‚æœå«ç›®æ ‡é‚£ä¹ˆå°±è®©å®ƒæ¥è¿‘ä¸GTçš„IOUã€‚</li><li>æ¥ç€æˆ‘ä»¬æŒ‰ç…§ç½®ä¿¡åº¦æ¥å†³å®šå“ªä¸ªæ¡†ç”¨æ¥å†³å®šæˆ‘ä»¬çš„åˆ†ç±»ç§ç±»çš„å‘é‡ï¼Œæ¯”æ–¹è¯´ä¸¤ä¸ªbboxï¼Œç¬¬äºŒä¸ªbboxçš„Confidenceå€¼æ›´å¤§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¼šé€‰æ‹©è®©æˆ‘ä»¬çš„å€¼æ›´å¤§çš„é‚£ä¸ªæ¥é¢„æµ‹æˆ‘ä»¬çš„20ç±»çš„æ¦‚ç‡å€¼ã€‚</li><li>æ‰€ä»¥æˆ‘ä»¬æœ€åå°±å¾—åˆ°äº†ä¸€ä¸ªSÃ—SÃ—(BÃ—5+C)çš„ä¸€ä¸ªtensorã€‚æˆ‘ä»¬å°±æ˜¯è¦æ‹¿è¿™ä¸ª tensoræ¥è¿›è¡ŒæŸå¤±çš„è®¡ç®—ï¼ŒæŸå¤±å‡½æ•°å¦‚ä¸‹ï¼š</li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211001103524.png" alt="YOLO loss function"></p><ul><li>å®é™…ä¸ŠæŸå¤±å‡½æ•°ä¹Ÿæ˜¯åšäº†å¾ˆå¤šå¾ˆç²¾å·§çš„è€ƒè™‘å’Œä¼˜åŒ–çš„ï¼š<ul><li>å¯ä»¥çœ‹åˆ°ç¬¬ä¸€è¡Œæˆ‘ä»¬å¯¹æ‰€æœ‰çš„bboxçš„åæ ‡ä¸­å¿ƒç‚¹çš„æŸå¤±è¿›è¡Œäº†ç´¯åŠ ï¼Œä½†å®é™…ä¸Šï¼Œç”±äºæˆ‘ä»¬é‚£ä¸ªç¬¦å·èŠ±ä½“1çš„å­˜åœ¨ä»–åªä¼šè€ƒè™‘è´Ÿè´£æ£€æµ‹é‚£ä¸ªç‰©ä½“çš„æ¡†çš„åæ ‡æŸå¤±ã€‚è€Œç¬¬ä¸€è¡Œå…¬å¼çš„$\lambda_{coord}$çš„å­˜åœ¨æ˜¯ä¸ºäº†æé«˜æˆ‘ä»¬å®šä½è¯¯å·®å æ€»è¯¯å·®çš„æƒé‡ã€‚</li><li>ç¬¬äºŒè¡Œçš„å…¬å¼æ˜¯æˆ‘ä»¬çš„å®½é«˜è¯¯å·®ï¼Œå¯ä»¥çœ‹å‡ºä¹Ÿæ˜¯é€šè¿‡çš„æˆ‘ä»¬çš„é«˜å®½çš„æŸå¤±å‡½æ•°ï¼Œä½†æ˜¯è¿™é‡Œç”¨åˆ°äº†æ ¹å·ï¼Œå› ä¸ºä½œè€…è€ƒè™‘åˆ°è¿™é‡Œå¯èƒ½å¤§ç‰©ä½“çš„é«˜å®½å’Œå°ç‰©ä½“çš„é«˜å®½è¯¯å·®å¯èƒ½æ•°å€¼æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯å½±å“å´å®Œå…¨ä¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä¸ºäº†éƒ¨åˆ†ç¼“è§£è¿™æ–¹é¢çš„è€ƒè™‘ï¼Œè¿›è¡Œäº†ç›¸å…³çš„æ ¹å·å¤„ç†ï¼Œä½¿å¾—å°æ¡†å¯¹è¯¯å·®æ›´æ•æ„Ÿï¼Œå½“ç„¶è¿™é‡Œåªæ˜¯ä¸€ä¸ªéƒ¨åˆ†çš„è§£å†³æ–¹æ¡ˆã€‚</li><li>ç¬¬ä¸‰è¡Œæ˜¯æˆ‘ä»¬çš„ç›¸å…³çš„Confidenceçš„è¯¯å·®æŸå¤±å‡½æ•°ã€‚è¿™é‡Œé¢ä¹Ÿæ˜¯åŒæ ·åªè®¡ç®—äº†æˆ‘ä»¬çš„è´Ÿè´£æ£€æµ‹ç‰©ä½“çš„bboxçš„è¯¯å·®æŸå¤±ã€‚æ³¨æ„çš„ä¸€ç‚¹å°±æ˜¯æˆ‘ä»¬è¿™é‡Œçš„æŸå¤±çš„$\hat{C_{i}}$â€‹ æŒ‡çš„æ˜¯æˆ‘ä»¬çš„bboxä¸GTçš„IOUã€‚æˆ‘ä»¬çš„$C_i$å°±æ˜¯æˆ‘ä»¬é¢„æµ‹å€¼ï¼Œè¦åŠªåŠ›å»é€¼è¿‘è¿™ä¸ªå€¼ã€‚</li><li>ç¬¬å››è¡Œä¹Ÿæ˜¯æˆ‘ä»¬çš„ç›¸å…³Confidenceè¯¯å·®æŸå¤±å‡½æ•°ã€‚è¿™é‡Œé¢æ˜¯åªè€ƒè™‘äº†æ‰€æœ‰ä¸è´Ÿè´£é¢„æµ‹ç‰©ä½“ç»“æœçš„bbox,æˆ‘ä»¬è¦åŠªåŠ›å°½é‡åœ°è®©æˆ‘ä»¬çš„è¿™é‡Œé¢„æµ‹å€¼$C_i$æ¥è¿‘äº0ï¼Œ ä¹Ÿå°±æ˜¯æˆ‘ä»¬è¿™é‡Œçš„$\hat{C_i}$.  å› ä¸ºå¤§å¤šæ•°æ¡†éƒ½æ˜¯æ²¡æœ‰ä¸è´Ÿè´£é¢„æµ‹ç‰©ä½“ç»“æœçš„ï¼Œæ‰€ä»¥å®é™…ä¸Šå¦‚æœæˆ‘ä»¬ä¸åŠ ä¸Šå‰é¢çš„ç³»æ•°$\lambda_{noobj}$ï¼Œç»“æœå°±æ˜¯æˆ‘ä»¬çš„confidenceé¢„æµ‹æƒé‡å¯èƒ½æ›´å¤šçš„å°±ä¼šè®­ç»ƒbboxçš„éƒ¨åˆ†ï¼Œå› ä¸ºæˆ‘ä»¬å«é¢„æµ‹ç‰©ä½“çš„bboxçš„æ ·æœ¬é‡å¤ªå°äº†ï¼Œæ‰€ä»¥æœ€åå¯èƒ½ä¼šä½¿å¾—æˆ‘ä»¬çš„æƒé‡å…¨éƒ½ä¸º0ï¼Œæ‰€ä»¥æˆ‘ä»¬åŠ äº†ä¸€ä¸ªç³»æ•°$\lambda_{noobj}$â€‹â€‹ï¼Œè¿™æ ·ä¸€æ¥å°±é˜²æ­¢æˆ‘ä»¬çš„æƒé‡æœ€åå…¨é›¶çš„æƒ…å†µï¼Œè®ºæ–‡åŸè¯æ˜¯ï¼š<em>Also, in every image many grid cells do not contain any object. This pushes the â€œconfidenceâ€ scores of those cells towards zero, often overpowering the gradient from cells that do contain objects. This can lead to model instability, causing training to diverge early on.</em></li><li>æœ€åä¸€è¡Œæ˜¯æˆ‘ä»¬çš„åˆ†ç±»è¯¯å·®ï¼Œclassificationè¯¯å·®ï¼Œ$S^2$ä¸ª<code>grid cell</code>ï¼Œ æˆ‘ä»¬åŒæ ·åªå…³å¿ƒè´Ÿè´£é¢„æµ‹ç‰©ä½“çš„<code>grid cell</code>. å°†æˆ‘ä»¬é¢„æµ‹çš„ç±»åˆ«æ¦‚ç‡ä½¿ç”¨å¹³æ–¹å’Œè¯¯å·®åŠ èµ·æ¥ã€‚</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> YOLO </tag>
            
            <tag> è®ºæ–‡è§£è¯» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>9.29æ¬§å† å°ç»„èµ›æ„Ÿæƒ³</title>
      <link href="/2021/09/29/9-29-ou-guan-xiao-zu-sai-gan-xiang/"/>
      <url>/2021/09/29/9-29-ou-guan-xiao-zu-sai-gan-xiang/</url>
      
        <content type="html"><![CDATA[<h1 id="æ­å–œæ¢…è¥¿ï¼"><a href="#æ­å–œæ¢…è¥¿ï¼" class="headerlink" title="æ­å–œæ¢…è¥¿ï¼"></a>æ­å–œæ¢…è¥¿ï¼</h1><p>æ­å–œæ¢…è¥¿æ‰“å…¥å·´é»å¤„å­çƒ ï¼æ°å¦‚å…¶åˆ†çš„è¿›çƒï¼åœ¨å¦‚æ­¤ä¸€ä¸ªé‡è¦çš„æ¯”èµ›ä¸­ï¼Œé¢å¯¹è¿™æ ·ä¸€ä¸ªå¼ºæ•Œï¼Œæ¢…è¥¿ä»¥ä¸€ä¸ªéå¸¸æ¼‚äº®çš„ä¸–ç•Œæ³¢ï¼Œä¸å§†å·´ä½©ä¸€ä¸ªç»å¦™çš„é…åˆæ‰“å…¥äº†è¿™æ ·ä¸€ç²’æä¸ºç²¾å½©çš„è¿›çƒï¼Œä¹ŸæˆåŠŸæ€æ­»äº†æ¯”èµ›ï¼</p><p><a href="https://imgtu.com/i/45yjmR" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/09/29/45yjmR.png" alt="first goal"></a></p><h1 id="ä»Šå¤©æ˜¯ä¸ªå¥½æ—¥å­"><a href="#ä»Šå¤©æ˜¯ä¸ªå¥½æ—¥å­" class="headerlink" title="ä»Šå¤©æ˜¯ä¸ªå¥½æ—¥å­"></a>ä»Šå¤©æ˜¯ä¸ªå¥½æ—¥å­</h1><p>ä»Šå¤©æ¢…è¥¿æ‰“å…¥äº†ä¸€è®°ææ¼‚äº®çš„è¿›çƒï¼Œå¹¶ä¸”æ˜¯é¢å¯¹æ›¼åŸã€‚çš‡é©¬è¢«ç»æ€äº†ï¼è‹ç‰™ä¹Ÿç»æ€äº†ï¼ä¸å¾—ä¸è¯´çœŸæ˜¯ä¸€ä¸ªå¥½æ—¥å­å“ˆå“ˆå“ˆã€‚</p><blockquote><p> å·´é»èµ¢çƒï¼Œæ¢…è¥¿è¿›çƒï¼Œçš‡é©¬è¾“ç»™è°¢é‡Œå¤«ï¼Œè‹äºšé›·æ–¯ç»æ€ï¼Œå¸ƒé²æ—¥èµ¢äº†è±æ¯”é”¡ï¼Œå“ˆå“ˆ</p></blockquote><h1 id="å…³äºç±³å…°"><a href="#å…³äºç±³å…°" class="headerlink" title="å…³äºç±³å…°"></a>å…³äºç±³å…°</h1><p>ä¸å¾—ä¸è¯´Aç±³çœŸæ˜¯æ¬§å† æœ‰åŠ æˆå•Šï¼Œè¿™ä¹ˆå¼±çš„é˜µå®¹ç«Ÿç„¶å’Œé©¬æ¡¶ã€é©¬ç«æ‰“å¾—æœ‰æ¥æœ‰å›ï¼Œè™½è´¥çŠ¹è£å•Šç¡®å®ã€‚</p><h1 id="ä¸€ç‚¹çœ‹è¶³çƒçš„çœ‹æ³•"><a href="#ä¸€ç‚¹çœ‹è¶³çƒçš„çœ‹æ³•" class="headerlink" title="ä¸€ç‚¹çœ‹è¶³çƒçš„çœ‹æ³•"></a>ä¸€ç‚¹çœ‹è¶³çƒçš„çœ‹æ³•</h1><p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘åˆæƒ³èµ·äº†é‚£æ®µç»å…¸çš„è§£è¯´è¯ï¼š</p><blockquote><p>â€œè¥¿ç­ç‰™é˜Ÿçš„çƒå‘˜ä»¬å®Œå…¨ä¸ç”¨ä¸ºæ­¤æ„Ÿåˆ°æŠ±æ­‰ï¼Œå› ä¸ºä»–ä»¬å·²ç»åˆ°è¿‡å¾ˆå¤šäººæ— æ³•ä¼åŠçš„é«˜åº¦ã€‚ä½œä¸ºä»–ä»¬çš„çƒè¿·å½“ç„¶æ˜¯å¾—åˆ°äº†æ»¡è¶³ï¼Œè¿˜æƒ³è¦åˆ°æ›´å¤šçš„æ»¡è¶³è¿™æ— å¯åšéã€‚ä½†æ˜¯è¿™ç§è¦æ±‚å…¶å®å¹¶ä¸å®é™…ï¼Œå› ä¸ºè‡ªå¤æ‰“å¤©ä¸‹éš¾å®ˆå¤©ä¸‹æ›´éš¾ã€‚æ²¡æœ‰äººå¯ä»¥æ°¸è¿œç«™åœ¨é¡¶å³°ï¼Œå³ä½¿ä½ å¯ä»¥åšåˆ°å±…å®‰æ€å±ï¼Œæœªé›¨ç»¸ç¼ªï¼Œä½†æ˜¯ä½ èº«è¾¹å…¨éƒ½æ˜¯å’Œä½ å½“å¹´ä¸€æ ·çš„å……æ»¡é‡å¿ƒï¼Œå……æ»¡æ¿€æƒ…å’Œå……æ»¡æ¸´æœ›çš„å¹´è½»äººï¼Œä»–ä»¬æŠŠä½ çš„é•¿å¤„å’ŒçŸ­å¤„æ”¾åœ¨æ˜¾å¾®é•œä¸‹å»ç ”ç©¶ï¼Œä»¥ä½ ä¸ºæ ‡é¶ï¼Œä½ è¯´ä½ å®ˆå¤©ä¸‹éš¾ä¸éš¾ã€‚</p><p>äººç”Ÿå½“ä¸­æˆåŠŸåªæ˜¯ä¸€æ—¶çš„ï¼Œå¤±è´¥å´æ˜¯ä¸»æ—‹å¾‹ã€‚ä½†æ˜¯å¦‚ä½•é¢å¯¹å¤±è´¥ï¼Œå´æŠŠäººåˆ†æˆäº†ä¸åŒçš„æ ·å­ã€‚æœ‰çš„äººä¼šè¢«å¤±è´¥å‡»å®ï¼Œæœ‰çš„äººèƒ½å¤Ÿä¸æ–­çš„çˆ¬èµ·æ¥ç»§ç»­å‘å‰ã€‚æ¾³å¤§åˆ©äºšé˜Ÿæ˜¯å¦‚æ­¤ï¼Œè¥¿ç­ç‰™é˜Ÿä¹Ÿæ˜¯å¦‚æ­¤ã€‚æˆ‘æƒ³çœŸæ­£çš„æˆç†Ÿåº”è¯¥å¹¶ä¸æ˜¯è¿½æ±‚å®Œç¾ï¼Œè€Œæ˜¯ç›´é¢è‡ªå·±çš„ç¼ºæ†¾ï¼Œè¿™æ‰æ˜¯ç”Ÿæ´»çš„æœ¬è´¨ã€‚</p><p>ç½—æ›¼ç½—å…°è¯´è¿‡çš„ï¼Œè¿™ä¸ªä¸–ç•Œä¸Šåªæœ‰ä¸€ç§çœŸæ­£çš„è‹±é›„ä¸»ä¹‰ï¼Œé‚£å°±æ˜¯è®¤æ¸…ç”Ÿæ´»çš„çœŸç›¸ï¼Œå¹¶ä¸”ä»ç„¶çƒ­çˆ±å®ƒã€‚è¥¿ç­ç‰™é˜Ÿä»å¤´å†æ¥å§ï¼éš¾é“å‘ä¸Šæ”€çˆ¬çš„é‚£æ¡è·¯ï¼Œä¸æ˜¯æ¯”ç«™åœ¨é¡¶å³°æ›´è®©äººçƒ­è¡€æ¾æ¹ƒå—ï¼â€</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> å†™ç»™è‡ªå·±çš„æ•£æ–‡è¯— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è¶³çƒ </tag>
            
            <tag> æ¢…è¥¿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>a Barcode Reader in Python</title>
      <link href="/2021/09/28/python-tiao-xing-ma-shi-bie/"/>
      <url>/2021/09/28/python-tiao-xing-ma-shi-bie/</url>
      
        <content type="html"><![CDATA[<h1 id="è¿˜æ²¡å†™å®Œå‘¢-ç­‰Dianæ‹›æ–°å®Œäº†å†æ›´æ–°"><a href="#è¿˜æ²¡å†™å®Œå‘¢-ç­‰Dianæ‹›æ–°å®Œäº†å†æ›´æ–°" class="headerlink" title="è¿˜æ²¡å†™å®Œå‘¢,ç­‰Dianæ‹›æ–°å®Œäº†å†æ›´æ–°"></a>è¿˜æ²¡å†™å®Œå‘¢,ç­‰Dianæ‹›æ–°å®Œäº†å†æ›´æ–°</h1><h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>æ¡å½¢ç å¯ä»¥è¢«ä¸€ä¸ªå…‰å­¦æ¡å½¢ç æ‰«æå™¨è¯»å–ã€‚æˆ‘ä»¬è¿™é‡Œå°†ä¼šä½¿ç”¨pythonä»£ç æ¥read and decode ç»™å®šçš„æ¡å½¢ç ã€‚å¦å¤–ä¹Ÿèƒ½æç»˜å‡ºç»™å®šä¸€ä¸ªå›¾ç‰‡æ¡å½¢ç çš„ä½ç½®ã€‚</p><p>æˆ‘ä»¬æ‰“ç®—å°†æ¯ä¸€ä¸ªåŠŸèƒ½éƒ½æ”¾åˆ°ä¸€ä¸ªå®šä¹‰çš„å‡½æ•°ä¸­ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ…¢æ…¢çœ‹ã€‚</p><h1 id="å®‰è£…æœ‰å…³åº“"><a href="#å®‰è£…æœ‰å…³åº“" class="headerlink" title="å®‰è£…æœ‰å…³åº“"></a>å®‰è£…æœ‰å…³åº“</h1><p>é¦–å…ˆéœ€è¦å®‰è£…ç›¸åº”çš„åº“ä¾èµ–ï¼ŒLinuxç›´æ¥å‡ æ¡æŒ‡ä»¤å°±OKï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">pip install pyzbarsudo apt-get install libzbar-dev<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å®é™…ä¸Šå¥½åƒè¿˜éœ€è¦ä¸€ä¸ªè¿™ä¸ªï¼Œä¸è¿‡æˆ‘æ²¡æœ‰å®‰è£…æˆåŠŸï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">pip install zbar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦å¤–éœ€è¦æœ‰opencvåº“ï¼š</p><pre class="line-numbers language-python"><code class="language-python">pip intall opencv<span class="token operator">-</span>python<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="Pyzbaråº“"><a href="#Pyzbaråº“" class="headerlink" title="Pyzbaråº“"></a>Pyzbaråº“</h1><blockquote><p>å‚è€ƒæ–‡æ¡£ï¼š<a href="https://www.thepythoncode.com/article/making-a-barcode-scanner-in-python" target="_blank" rel="noopener">https://www.thepythoncode.com/article/making-a-barcode-scanner-in-python</a></p></blockquote><h2 id="åˆæ­¥å°è¯•"><a href="#åˆæ­¥å°è¯•" class="headerlink" title="åˆæ­¥å°è¯•"></a>åˆæ­¥å°è¯•</h2><p>è¿™ä¸ªåº“æˆ‘å°è¯•äº†ä¸€ä¸‹ï¼Œæ„Ÿè§‰æ•ˆæœè¿˜å¯ä»¥ï¼ŒåŸºæœ¬çš„å›¾åƒéƒ½èƒ½æ¡†å‡ºæ¥ï¼Œå‡†ç¡®ç‡è¿˜å¯ä»¥ï¼Œæ¯”å¦‚è¯´ï¼š</p><p><a href="https://imgtu.com/i/4h45m4" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/09/29/4h45m4.png" alt="barcode reader"></a></p><p>å½“ç„¶è¿™éƒ½æ˜¯éå¸¸åŸºç¡€çš„åº“ï¼Œå¯èƒ½ä¹Ÿè¯´æ˜ä¸äº†ä»€ä¹ˆï¼Œä½†æ˜¯æˆ‘è§‰å¾—è¿™ä¸ªè¯†åˆ«æ°´å¹³è¿˜æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯æˆ‘ç›®å‰è¿˜ä¸çŸ¥é“è¯¥åº“çš„ç®—æ³•åº•å±‚æ˜¯æ€ä¹ˆæ ·çš„ã€‚è¿›ä¸€æ­¥æ¥çœ‹å§ã€‚</p><p>è¿›ä¸€æ­¥æ¥çœ‹ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨è¯¾æœ¬ã€æˆ–æ˜¯ç‰©ä½“ä¸Šçš„æ¡å½¢ç ï¼Œè¿™å°±ä¸æ˜¯éå¸¸å¥½äº†ï¼Œæœ‰çš„åªèƒ½æ¡†å‡ºæ¥ä¸€ä¸ªï¼Œæœ‰çš„æ¡†å‡ºæ¥ä¸¤ä¸ªä½†æ˜¯éƒ½æ˜¯åŒä¸€ä¸ªæ¡å½¢ç ï¼Œå…¶ä¸­ä¸€ä¸ªè¿˜æ˜¯é”™çš„ã€‚</p><p><a href="https://imgtu.com/i/4h5l90" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/09/29/4h5l90.png" alt="barcode reader"></a></p><h2 id="æµ‹è¯•é›†ç»“æœ"><a href="#æµ‹è¯•é›†ç»“æœ" class="headerlink" title="æµ‹è¯•é›†ç»“æœ"></a>æµ‹è¯•é›†ç»“æœ</h2><h2 id="ç®—æ³•åŸç†"><a href="#ç®—æ³•åŸç†" class="headerlink" title="ç®—æ³•åŸç†"></a>ç®—æ³•åŸç†</h2>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> Barcode Reader </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pytorch_tutorial of TorchVision Object Detection Finetuning Tutorial</title>
      <link href="/2021/09/25/pytorch-tutorial-of-torchvision-object-detection-finetuning-tutorial/"/>
      <url>/2021/09/25/pytorch-tutorial-of-torchvision-object-detection-finetuning-tutorial/</url>
      
        <content type="html"><![CDATA[<h3 id="fine-tuning"><a href="#fine-tuning" class="headerlink" title="fine-tuning"></a>fine-tuning</h3><p>fine-tuningæ˜¯å¾®è°ƒçš„æ„æ€ï¼Œæ˜¯ç”¨åˆ«äººè®­ç»ƒå¥½çš„æ¨¡å‹(å³pre-trained model)ï¼ŒåŠ ä¸Šæˆ‘ä»¬è‡ªå·±çš„æ•°æ®ï¼Œæ¥è®­ç»ƒæ–°çš„æ¨¡å‹ã€‚fine tuneç›¸å½“äºä½¿ç”¨åˆ«äººçš„æ¨¡å‹çš„å‰å‡ å±‚ï¼Œæ¥æå–æµ…å±‚ç‰¹å¾ï¼Œç„¶ååœ¨æœ€åå†è½å…¥æˆ‘ä»¬è‡ªå·±çš„åˆ†ç±»ä¸­ã€‚</p><p>ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬è‡ªå·±éœ€è¦åšçš„æ–¹å‘ï¼Œæ¯”å¦‚åœ¨ä¸€äº›ç‰¹å®šçš„é¢†åŸŸçš„è¯†åˆ«åˆ†ç±»ä¸­ï¼Œæˆ‘ä»¬å¾ˆéš¾æ‹¿åˆ°å¤§é‡çš„æ•°æ®ã€‚å› ä¸ºåƒåœ¨ImageNetä¸Šæ¯•ç«Ÿæ˜¯ä¸€ä¸ªåƒä¸‡çº§çš„å›¾åƒæ•°æ®åº“ï¼Œé€šå¸¸æˆ‘ä»¬å¯èƒ½åªèƒ½æ‹¿åˆ°å‡ åƒå¼ æˆ–è€…å‡ ä¸‡å¼ æŸä¸€ç‰¹å®šé¢†åŸŸçš„å›¾åƒï¼Œæ¯”å¦‚è¯†åˆ«è¡£æœå•Šã€æ ‡å¿—å•Šã€ç”Ÿç‰©ç§ç±»ç­‰ç­‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹é‡æ–°è®­ç»ƒä¸€ä¸ªæ–°çš„ç½‘ç»œæ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œè€Œä¸”å‚æ•°ä¸å¥½è°ƒæ•´ï¼Œæ•°æ®é‡ä¹Ÿä¸å¤Ÿï¼Œå› æ­¤fine-tuningå¾®è°ƒå°±æ˜¯ä¸€ä¸ªæ¯”è¾ƒç†æƒ³çš„é€‰æ‹©ã€‚</p><p>å¦‚æœæƒ³ç½‘ç»œä¸­æŸå‡ å±‚å‚æ•°ä¸å˜ï¼Œå¯ä»¥è®¾ç½®å¯¹åº”learning rateä¸º0è®©è¿™äº›å±‚çš„å‚æ•°ä¸å­¦ä¹ </p><p>å…³äºfine-tuningä¸¤ä¸ªæ¯”è¾ƒå¥½çš„åšå®¢ï¼š</p><p><a href="http://www.cnblogs.com/louyihang-loves-baiyan/p/5038758.html" target="_blank" rel="noopener">http://www.cnblogs.com/louyihang-loves-baiyan/p/5038758.html</a></p><p><a href="http://www.cnblogs.com/alexcai/p/5469478.html" target="_blank" rel="noopener">http://www.cnblogs.com/alexcai/p/5469478.html</a></p><p>çŸ¥ä¹ä¸Šçš„ä¸€ä¸ªé—®é¢˜ï¼š</p><p><a href="https://www.zhihu.com/question/35754716" target="_blank" rel="noopener">https://www.zhihu.com/question/35754716</a></p><h2 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h2><p>è¿™ç¯‡<a href="https://pytorch.org/tutorials/intermediate/torchvision_tutorial.html" target="_blank" rel="noopener">tutorial</a>å°±æ˜¯ä¸ºäº†è®©æˆ‘ä»¬finetuning ä¸€ä¸ªpre-trainedçš„Mask R-CNNæ¨¡å‹ã€‚åŸºäº<a href="https://www.cis.upenn.edu/~jshi/ped_html/" target="_blank" rel="noopener">æ•°æ®é›†è¡Œäººæ£€æµ‹åˆ†å‰²</a>. è¯¥æ•°æ®é›†åŒ…æ‹¬äº†179å¼ å›¾ç‰‡ä»¥åŠ345ä¸ªè¡Œäººå®ä¾‹ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨å®ƒæ¥æç»˜å¦‚ä½•ä½¿ç”¨torchvisionä¸­çš„æ–°ç‰¹æ€§æ¥ä¸€ä¸ªè‡ªå®šä¹‰æ•°æ®é›†ä¸Šè®­ç»ƒæˆ‘ä»¬çš„æ£€æµ‹åˆ†å‰²ã€‚</p><h2 id="Defining-the-Dataset"><a href="#Defining-the-Dataset" class="headerlink" title="Defining the Dataset"></a>Defining the Dataset</h2><blockquote><p>query 1. n. a question, especially one addressed to an official or organization. *â€a spokeswoman said queries could not be answered until Mondayâ€*  2. v. ask a question about something, especially in order to express oneâ€™s doubts about it or to check its validity or accuracy. *â€many people queried whether any harm had been doneâ€*</p></blockquote><p>è¯¥å‚è€ƒçš„ä»£ç å—è„šæœ¬å¯ä»¥ç”¨æ¥ç®€å•æ”¯æŒæˆ‘ä»¬åŠ å…¥æ–°çš„è‡ªå®šä¹‰æ•°æ®é›†æ¥è®­ç»ƒç›®æ ‡æ£€æµ‹å’Œå®åŠ›åˆ†å‰²ã€è¡Œäººå…³é”®ç‚¹æ£€æµ‹ç­‰ã€‚è¯¥æ•°æ®é›†åº”è¯¥ç»§æ‰¿è‡ªåº“æ ‡å‡†ç±»<code>torch.utils.data.Dataset</code>ï¼Œ å¹¶ä¸”ä½¿ç”¨åˆ°æ–¹æ³• <code>__len__</code>, <code>__getitem__</code>.</p><p>å”¯ä¸€éœ€è¦æˆ‘ä»¬æ³¨æ„çš„ç‰¹æ€§å°±æ˜¯æ–¹æ³•<code>__getitem__</code>éœ€è¦è¿”å›ï¼š</p><ul><li>image: a PIL Image of size <code>(H, W)</code></li><li>target: a dict containing the following fields<ul><li><code>boxes (FloatTensor[N, 4])</code>: the coordinates of the <code>N</code> bounding boxes in <code>[x0, y0, x1, y1]</code> format, ranging from <code>0</code> to <code>W</code> and <code>0</code> to <code>H</code></li><li><code>labels (Int64Tensor[N])</code>: the label for each bounding box. <code>0</code> represents always the background class.</li><li><code>image_id (Int64Tensor[1])</code>: an image identifier. It should be unique between all the images in the dataset, and is used during evaluation</li><li><code>area (Tensor[N])</code>: The area of the bounding box. This is used during evaluation with the COCO metric, to separate the metric scores between small, medium and large boxes.</li><li><code>iscrowd (UInt8Tensor[N])</code>: instances with iscrowd=True will be ignored during evaluation.</li><li>(optionally) <code>masks (UInt8Tensor[N, H, W])</code>: The segmentation masks for each one of the objects</li><li>(optionally) <code>keypoints (FloatTensor[N, K, 3])</code>: For each one of the N objects, it contains the K keypoints in <code>[x, y, visibility]</code> format, defining the object. visibility=0 means that the keypoint is not visible. Note that for data augmentation, the notion of flipping a keypoint is dependent on the data representation, and you should probably adapt <code>references/detection/transforms.py</code> for your new keypoint representation</li></ul></li></ul><p>å¦‚æœæˆ‘ä»¬çš„modelè¿”å›ä»¥ä¸Šæ–¹æ³•ï¼Œæˆ‘ä»¬ä¼šä½¿è¯¥æ–¹æ³•é€‚ç”¨äºè®­ç»ƒå’Œè¯„ä¼°ï¼Œä¹Ÿä¼šuse the evaluation scripts from <code>pycocotools</code> which can be installed with <code>pip install pycocotools</code>.</p><p>ä¸€ä¸ªéœ€è¦å¼ºè°ƒçš„æ˜¯æˆ‘ä»¬çš„<code>labels</code>, æˆ‘ä»¬çš„æ¨¡å‹ä¼šé»˜è®¤0ä½œä¸ºæˆ‘ä»¬çš„èƒŒæ™¯ï¼Œå¦‚æœæˆ‘ä»¬çš„æ•°æ®é›†ä¸åŒ…æ‹¬èƒŒæ™¯ç±»ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„<code>labels</code>ä¸åº”è¯¥åŒ…æ‹¬0. ä¾‹å¦‚ï¼Œæˆ‘ä»¬ç›®å‰æœ‰2ç±»ï¼šçŒ«å’Œç‹—ã€‚æˆ‘ä»¬å¯ä»¥è®¾å®š1ä¸ºçŒ«ï¼Œ2ä¸ºç‹—ã€‚æ‰€ä»¥ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬ä¸€ä¸ªå›¾ç‰‡è¿™ä¸¤ç±»éƒ½æœ‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ <code>labels</code>çš„tensoråº”è¯¥å°±æ˜¯<code>[1, 2]</code>.</p><p>å¦å¤–ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦ä½¿ç”¨é«˜å®½æ¯”é›†åˆå¼åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼ˆç”¨æ¥æ–¹ä¾¿æˆ‘ä»¬æ¯ä¸ªbatchéƒ½æ˜¯ç›¸è¿‘é«˜å®½çš„å›¾ç‰‡ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€‰æ‹©ä½¿ç”¨æ–¹æ³•<code>get_height_and_width</code> ï¼Œå¯ä»¥è¿”å›æˆ‘ä»¬å›¾ç‰‡çš„é«˜å®½ã€‚å¦‚æœæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬å°±ä¼šé€šè¿‡<code>__getitem__</code>è®¿é—®æ•°æ®é›†çš„æ‰€æœ‰å…ƒç´ ,è¿™æ ·ä¼šåœ¨å†…å­˜ä¸­åŠ è½½å›¾ç‰‡å¹¶ä¸”æ¯”æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªä¸Šé¢çš„æ–¹æ³•åŠ è½½è¦æ…¢å¾ˆå¤šã€‚</p><h2 id="Writing-a-custom-dataset-for-PennFudan"><a href="#Writing-a-custom-dataset-for-PennFudan" class="headerlink" title="Writing a custom dataset for PennFudan"></a>Writing a custom dataset for PennFudan</h2><p>æˆ‘ä»¬éœ€è¦ä¸ºPennFudanæ¥å†™ä¸€ä¸ªæ•°æ®ç±»ã€‚é¦–å…ˆæˆ‘ä»¬è¦å…ˆä¸‹è½½PennFudanæ•°æ®é›†  <a href="https://www.cis.upenn.edu/~jshi/ped_html/PennFudanPed.zip" target="_blank" rel="noopener">downloading and extracting the zip file</a>, å½“ç„¶æˆ‘ä»¬ä¸‹è½½æ–‡ä»¶å¯ä»¥é€‰æ‹©ä½¿ç”¨wgetä¸‹è½½ç½‘ç»œä¸Šçš„æ–‡ä»¶ï¼š </p><p><code>wget -c https://www.cis.upenn.edu/~jshi/ped_html/PennFudanPed.zip</code></p><p>æˆ‘ä»¬å…ˆçœ‹çœ‹å›¾ç‰‡æ–‡ä»¶ç»“æ„ï¼š</p><blockquote><p>PennFudanPed/<br>  PedMasks/<br>    FudanPed00001_mask.png<br>    FudanPed00002_mask.png<br>    FudanPed00003_mask.png<br>    FudanPed00004_mask.png<br>    â€¦<br>  PNGImages/<br>    FudanPed00001.png<br>    FudanPed00002.png<br>    FudanPed00003.png<br>    FudanPed00004.png</p></blockquote><p>è¿™é‡Œæœ‰ç›¸å…³çš„ä¸€ä¸ªä¾‹å­å…³äºä¸€å¯¹å›¾ç‰‡å’Œåˆ†å‰²masks:</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pytorch.org/tutorials/_static/img/tv_tutorial/tv_image01.png" alt="one example of a pair of images and segmentation masks"></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pytorch.org/tutorials/_static/img/tv_tutorial/tv_image02.png" alt="one example of a pair of images and segmentation masks"></p><p>æ‰€ä»¥æˆ‘ä»¬æ¯ä¸€ä¸ªå›¾ç‰‡éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„åˆ†å‰²maskï¼ˆsegementation mask)ï¼Œæ¯ä¸€ä¸ªä¸åŒçš„coloréƒ½å¯¹åº”ä¸€ä¸ªä¸åŒçš„å®ä¾‹ã€‚æˆ‘ä»¬æ¥ä¸‹æ¥å†™ä¸€ä¸ªç±»<code>torch.utils.data.Dataset</code> class ä¸ºè¯¥æ•°æ®é›†ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> os<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> torch<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image<span class="token keyword">class</span> <span class="token class-name">PennFudanDataset</span><span class="token punctuation">(</span>torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>Dataset<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> root<span class="token punctuation">,</span> transforms<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>root <span class="token operator">=</span> root        self<span class="token punctuation">.</span>transforms <span class="token operator">=</span> transforms        <span class="token comment" spellcheck="true"># load all image files, sorting them to</span>        <span class="token comment" spellcheck="true"># ensure that they are aligned</span>        self<span class="token punctuation">.</span>imgs <span class="token operator">=</span> list<span class="token punctuation">(</span>sorted<span class="token punctuation">(</span>os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>root<span class="token punctuation">,</span> <span class="token string">"PNGImages"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>masks <span class="token operator">=</span> list<span class="token punctuation">(</span>sorted<span class="token punctuation">(</span>os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>root<span class="token punctuation">,</span> <span class="token string">"PedMasks"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> idx<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># load images and masks</span>        img_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>self<span class="token punctuation">.</span>root<span class="token punctuation">,</span> <span class="token string">"PNGImages"</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>imgs<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span>        mask_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>self<span class="token punctuation">.</span>root<span class="token punctuation">,</span> <span class="token string">"PedMasks"</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>masks<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span>        img <span class="token operator">=</span> Image<span class="token punctuation">.</span>open<span class="token punctuation">(</span>img_path<span class="token punctuation">)</span><span class="token punctuation">.</span>convert<span class="token punctuation">(</span><span class="token string">"RGB"</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># note that we haven't converted the mask to RGB,</span>        <span class="token comment" spellcheck="true"># because each color corresponds to a different instance</span>        <span class="token comment" spellcheck="true"># with 0 being background</span>        mask <span class="token operator">=</span> Image<span class="token punctuation">.</span>open<span class="token punctuation">(</span>mask_path<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># convert the PIL Image into a numpy array</span>        mask <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>mask<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># instances are encoded as different colors</span>        obj_ids <span class="token operator">=</span> np<span class="token punctuation">.</span>unique<span class="token punctuation">(</span>mask<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># first id is the background, so remove it</span>        obj_ids <span class="token operator">=</span> obj_ids<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># split the color-encoded mask into a set</span>        <span class="token comment" spellcheck="true"># of binary masks</span>        masks <span class="token operator">=</span> mask <span class="token operator">==</span> obj_ids<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> None<span class="token punctuation">,</span> None<span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># get bounding box coordinates for each mask</span>        num_objs <span class="token operator">=</span> len<span class="token punctuation">(</span>obj_ids<span class="token punctuation">)</span>        boxes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>num_objs<span class="token punctuation">)</span><span class="token punctuation">:</span>            pos <span class="token operator">=</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>masks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            xmin <span class="token operator">=</span> np<span class="token punctuation">.</span>min<span class="token punctuation">(</span>pos<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            xmax <span class="token operator">=</span> np<span class="token punctuation">.</span>max<span class="token punctuation">(</span>pos<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            ymin <span class="token operator">=</span> np<span class="token punctuation">.</span>min<span class="token punctuation">(</span>pos<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            ymax <span class="token operator">=</span> np<span class="token punctuation">.</span>max<span class="token punctuation">(</span>pos<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            boxes<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>xmin<span class="token punctuation">,</span> ymin<span class="token punctuation">,</span> xmax<span class="token punctuation">,</span> ymax<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># convert everything into a torch.Tensor</span>        boxes <span class="token operator">=</span> torch<span class="token punctuation">.</span>as_tensor<span class="token punctuation">(</span>boxes<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># there is only one class</span>        labels <span class="token operator">=</span> torch<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span>num_objs<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>int64<span class="token punctuation">)</span>        masks <span class="token operator">=</span> torch<span class="token punctuation">.</span>as_tensor<span class="token punctuation">(</span>masks<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>        image_id <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span>        area <span class="token operator">=</span> <span class="token punctuation">(</span>boxes<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> boxes<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>boxes<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> boxes<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># suppose all instances are not crowd</span>        iscrowd <span class="token operator">=</span> torch<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>num_objs<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>int64<span class="token punctuation">)</span>        target <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        target<span class="token punctuation">[</span><span class="token string">"boxes"</span><span class="token punctuation">]</span> <span class="token operator">=</span> boxes        target<span class="token punctuation">[</span><span class="token string">"labels"</span><span class="token punctuation">]</span> <span class="token operator">=</span> labels        target<span class="token punctuation">[</span><span class="token string">"masks"</span><span class="token punctuation">]</span> <span class="token operator">=</span> masks        target<span class="token punctuation">[</span><span class="token string">"image_id"</span><span class="token punctuation">]</span> <span class="token operator">=</span> image_id        target<span class="token punctuation">[</span><span class="token string">"area"</span><span class="token punctuation">]</span> <span class="token operator">=</span> area        target<span class="token punctuation">[</span><span class="token string">"iscrowd"</span><span class="token punctuation">]</span> <span class="token operator">=</span> iscrowd        <span class="token keyword">if</span> self<span class="token punctuation">.</span>transforms <span class="token keyword">is</span> <span class="token operator">not</span> None<span class="token punctuation">:</span>            img<span class="token punctuation">,</span> target <span class="token operator">=</span> self<span class="token punctuation">.</span>transforms<span class="token punctuation">(</span>img<span class="token punctuation">,</span> target<span class="token punctuation">)</span>        <span class="token keyword">return</span> img<span class="token punctuation">,</span> target    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> len<span class="token punctuation">(</span>self<span class="token punctuation">.</span>imgs<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬å¯ä»¥è¯¦ç»†çœ‹ä¸€çœ‹æˆ‘ä»¬è¿™ä¸ªç±»éƒ½å®šä¹‰äº†ä»€ä¹ˆï¼Œç»†ç»†å±•å¼€çœ‹ä¸€çœ‹ï¼š</p><h3 id="init"><a href="#init" class="headerlink" title="__init__"></a><code>__init__</code></h3><p>é¦–å…ˆæ˜¯æˆ‘ä»¬çš„<code>__init__</code>ç±»ï¼š</p><pre class="line-numbers language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> root<span class="token punctuation">,</span> transforms<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>root <span class="token operator">=</span> root        self<span class="token punctuation">.</span>transforms <span class="token operator">=</span> transforms        <span class="token comment" spellcheck="true"># load all image files, sorting them to</span>        <span class="token comment" spellcheck="true"># ensure that they are aligned</span>        self<span class="token punctuation">.</span>imgs <span class="token operator">=</span> list<span class="token punctuation">(</span>sorted<span class="token punctuation">(</span>os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>root<span class="token punctuation">,</span> <span class="token string">"PNGImages"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>masks <span class="token operator">=</span> list<span class="token punctuation">(</span>sorted<span class="token punctuation">(</span>os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>root<span class="token punctuation">,</span> <span class="token string">"PedMasks"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é¦–å…ˆrootæ˜¯æˆ‘ä»¬çš„è·¯å¾„ï¼Œç„¶åæ˜¯ä¸€ä¸ªå›¾ç‰‡çš„é¢„å¤„ç†transformsã€‚æ¥ç€æˆ‘ä»¬åªæ˜¯å°†æˆ‘ä»¬è·¯å¾„çš„æ–‡ä»¶å›¾ç‰‡å’Œmaskéƒ½åˆ†åˆ«æ”¾åˆ°äº†ä¸€ä¸ªåˆ—è¡¨ä¸­ï¼Œè¿™ä¸ªæ˜¯ä¸ºäº†å°†æˆ‘ä»¬çš„ä¸¤è€…ä¸€ä¸€å¯¹åº”ï¼ˆaligned).æ³¨æ„<code>__init__</code>é‡Œé¢ä¸å¯ä»¥åŠ è½½å›¾ç‰‡ï¼Œè¿™é‡Œé¢åªèƒ½è¿›è¡Œä¸€äº›ç›¸åº”çš„è·¯å¾„æ“ä½œï¼Œå¦‚æœåŠ è½½å›¾ç‰‡äº†ä¼šè¿è¡Œçš„éå¸¸ç¼“æ…¢ã€‚</p><h3 id="getitem"><a href="#getitem" class="headerlink" title="__getitem__"></a><code>__getitem__</code></h3><p>é¦–å…ˆåŠ è½½æˆ‘ä»¬çš„å›¾ç‰‡ä¸mask<strong>æŒ‰ç…§æˆ‘ä»¬çš„ç´¢å¼•ï¼Œæ¯æ¬¡åªåŠ è½½ä¸€å¼ </strong>ã€‚éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬å°†æˆ‘ä»¬çš„å›¾ç‰‡å˜ä¸ºRGBäº†ï¼Œä½†æ˜¯æˆ‘ä»¬çš„maskå¹¶æ²¡æœ‰å˜æˆRGBã€‚å› ä¸ºæ¯ä¸€ç§é¢œè‰²å¯¹åº”ä¸€ä¸ªä¸åŒçš„å®ä¾‹ï¼Œ0æ˜¯æˆ‘ä»¬çš„èƒŒæ™¯ã€‚</p><pre class="line-numbers language-python"><code class="language-python">        <span class="token comment" spellcheck="true"># load images and masks</span>        img_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>self<span class="token punctuation">.</span>root<span class="token punctuation">,</span> <span class="token string">"PNGImages"</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>imgs<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span>        mask_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>self<span class="token punctuation">.</span>root<span class="token punctuation">,</span> <span class="token string">"PedMasks"</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>masks<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span>        img <span class="token operator">=</span> Image<span class="token punctuation">.</span>open<span class="token punctuation">(</span>img_path<span class="token punctuation">)</span><span class="token punctuation">.</span>convert<span class="token punctuation">(</span><span class="token string">"RGB"</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># note that we haven't converted the mask to RGB,</span>        <span class="token comment" spellcheck="true"># because each color corresponds to a different instance</span>        <span class="token comment" spellcheck="true"># with 0 being background</span>        mask <span class="token operator">=</span> Image<span class="token punctuation">.</span>open<span class="token punctuation">(</span>mask_path<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ç€æˆ‘ä»¬é€‰æ‹©å°†maskçš„PIL Imageå½¢å¼è½¬åŒ–ä¸ºnumpyçš„arrayå½¢å¼ï¼š</p><pre class="line-numbers language-python"><code class="language-python">        <span class="token comment" spellcheck="true"># convert the PIL Image into a numpy array</span>        mask <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>mask<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ¥ç€ä¸åŒç§ç±»çš„å®ä¾‹æŒ‰ç…§ä¸åŒçš„é¢œè‰²è¿›è¡Œç¼–ç encode:</p><pre class="line-numbers language-python"><code class="language-python">        <span class="token comment" spellcheck="true"># instances are encoded as different colors</span>        obj_ids <span class="token operator">=</span> np<span class="token punctuation">.</span>unique<span class="token punctuation">(</span>mask<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç”±äºç¬¬ä¸€ä¸ªidæ˜¯æˆ‘ä»¬çš„èƒŒæ™¯0ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©å»é™¤æ‰å®ƒï¼š</p><pre class="line-numbers language-python"><code class="language-python">        <span class="token comment" spellcheck="true"># first id is the background, so remove it</span>        obj_ids <span class="token operator">=</span> obj_ids<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ¥ç€æˆ‘ä»¬é€‰æ‹©æ¯ä¸€ä¸ªå®ä¾‹éƒ½æ ‡æ³¨å‡ºæ¥ï¼ˆTrueä¸ºæ ‡è®°å‡ºæ¥çš„å®ä¾‹ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨æˆ‘ä»¬çš„<code>mask</code>å’Œ<code>obj[:, None, None]</code>è¿›è¡Œä¸€ä¸ªç­‰äºç­‰äºæ“ä½œã€‚å‡è®¾è¯´æˆ‘ä»¬åŸæœ¬çš„å›¾ç‰‡maskæ ‡è®°shapeæ˜¯<code>[536,559]</code>, é‚£ä¹ˆæˆ‘ä»¬é‡Œé¢æœ‰2ä¸ªå®ä¾‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„obj_idsçš„shapeæ˜¯<code>[2]</code>, é‚£ä¹ˆæˆ‘ä»¬çš„obj_idsçš„shapeå°±æ˜¯<code>[2, 1, 1]</code>,æ¥ç€æˆ‘ä»¬æ¥å¯¹è¿™ä¸¤è€…è¿›è¡Œä¸€ä¸ª<code>==</code>æ“ä½œå¾—åˆ°çš„å®é™…ä¸Šå°±æ˜¯Trueå’ŒFalseçš„çŸ©é˜µã€‚å¹¶ä¸”æ¥çœ‹æˆ‘ä»¬çš„æœ€ç»ˆå¾—åˆ°çš„çŸ©é˜µshapeä¸º<code>[2, 536, 559]</code>, å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æœ€ç»ˆçš„ç›®çš„å°±æ˜¯å¾—åˆ°æ¯ä¸€ä¸ªå®ä¾‹,åœ¨åŸæ¥å›¾ç‰‡çš„åƒç´ æ ‡è®°ã€‚</p><pre class="line-numbers language-python"><code class="language-python">        <span class="token comment" spellcheck="true"># split the color-encoded mask into a set</span>        <span class="token comment" spellcheck="true"># of binary masks</span>        masks <span class="token operator">=</span> mask <span class="token operator">==</span> obj_ids<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> None<span class="token punctuation">,</span> None<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ ¹æ®ä¸åŒçš„å®ä¾‹æ¥å¾—åˆ°ä¸åŒçš„ä½ç½®çš„bboxï¼š</p><p>é¦–å…ˆæ˜¯å®ä¾‹çš„ä¸€ä¸ªå¾ªç¯ï¼Œæ‰€æœ‰å®ä¾‹è¿›è¡Œä¸€ä¸ªå¾ªç¯ï¼Œboxesæ˜¯æ‰€æœ‰ç‰©ä½“åæ ‡çš„é›†åˆã€‚</p><pre class="line-numbers language-python"><code class="language-python">        <span class="token comment" spellcheck="true"># get bounding box coordinates for each mask</span>        num_objs <span class="token operator">=</span> len<span class="token punctuation">(</span>obj_ids<span class="token punctuation">)</span>        boxes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>num_objs<span class="token punctuation">)</span><span class="token punctuation">:</span>            pos <span class="token operator">=</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>masks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            xmin <span class="token operator">=</span> np<span class="token punctuation">.</span>min<span class="token punctuation">(</span>pos<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            xmax <span class="token operator">=</span> np<span class="token punctuation">.</span>max<span class="token punctuation">(</span>pos<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            ymin <span class="token operator">=</span> np<span class="token punctuation">.</span>min<span class="token punctuation">(</span>pos<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            ymax <span class="token operator">=</span> np<span class="token punctuation">.</span>max<span class="token punctuation">(</span>pos<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            boxes<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>xmin<span class="token punctuation">,</span> ymin<span class="token punctuation">,</span> xmax<span class="token punctuation">,</span> ymax<span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>pos = np.where(masks[i])</code>æ˜¯ä¸ºäº†å¾—åˆ°æˆ‘ä»¬ç¬¬iä¸ªå®ä¾‹çš„ä½ç½®ï¼Œä»¥ä¸‹æ¼”ç¤ºå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å¾—åˆ°äº†é«˜çš„ä¸€ä¸ªarrayå’Œå®½çš„ä¸€ä¸ªarrayã€‚</p><p><a href="https://imgtu.com/i/4y7XGD" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/09/26/4y7XGD.md.png" alt="test by lry"></a></p><p>éšåçš„åæ ‡å¾—åˆ°æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯éå¸¸ç®€å•çš„å¯»æ‰¾å·¦ä¸Šè§’å’Œå³ä¸‹è§’ã€‚ä½†æ˜¯è¿™ä¸€ç‚¹å¾ˆå®¹æ˜“å‡ºé”™ï¼Œå› ä¸ºxè½´ä¸yè½´ã€åŒ…æ‹¬åŸç‚¹ä½ç½®è¯·æ³¨æ„å¥½ã€‚</p><p>æ¥ç€æˆ‘ä»¬éœ€è¦å°†æˆ‘ä»¬è¿™äº›æ“ä½œå¾—åˆ°çš„arrayè½¬åŒ–ä¸ºTensor:</p><pre class="line-numbers language-python"><code class="language-python">        <span class="token comment" spellcheck="true"># convert everything into a torch.Tensor</span>        boxes <span class="token operator">=</span> torch<span class="token punctuation">.</span>as_tensor<span class="token punctuation">(</span>boxes<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># there is only one class</span>        labels <span class="token operator">=</span> torch<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span>num_objs<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>int64<span class="token punctuation">)</span>        masks <span class="token operator">=</span> torch<span class="token punctuation">.</span>as_tensor<span class="token punctuation">(</span>masks<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å­˜ä¸€ä¸‹å›¾ç‰‡çš„idï¼Œ æ‰€å¾—ç§ç±»çš„é¢ç§¯ï¼Œ å‡è®¾æ‰€æœ‰çš„å®ä¾‹éƒ½æ˜¯ä¸æŒ¤çš„ã€‚</p><pre class="line-numbers language-python"><code class="language-python">        image_id <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span>        area <span class="token operator">=</span> <span class="token punctuation">(</span>boxes<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> boxes<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>boxes<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> boxes<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># suppose all instances are not crowd</span>        iscrowd <span class="token operator">=</span> torch<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>num_objs<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>int64<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å­˜åœ¨å­—å…¸é‡Œé¢ï¼š</p><pre class="line-numbers language-python"><code class="language-python">        target <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        target<span class="token punctuation">[</span><span class="token string">"boxes"</span><span class="token punctuation">]</span> <span class="token operator">=</span> boxes        target<span class="token punctuation">[</span><span class="token string">"labels"</span><span class="token punctuation">]</span> <span class="token operator">=</span> labels        target<span class="token punctuation">[</span><span class="token string">"masks"</span><span class="token punctuation">]</span> <span class="token operator">=</span> masks        target<span class="token punctuation">[</span><span class="token string">"image_id"</span><span class="token punctuation">]</span> <span class="token operator">=</span> image_id        target<span class="token punctuation">[</span><span class="token string">"area"</span><span class="token punctuation">]</span> <span class="token operator">=</span> area        target<span class="token punctuation">[</span><span class="token string">"iscrowd"</span><span class="token punctuation">]</span> <span class="token operator">=</span> iscrowd<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åé¢çš„transformæ˜¯æ¥è½¬æ¢çš„ï¼š</p><pre class="line-numbers language-python"><code class="language-python">        <span class="token keyword">if</span> self<span class="token punctuation">.</span>transforms <span class="token keyword">is</span> <span class="token operator">not</span> None<span class="token punctuation">:</span>            img<span class="token punctuation">,</span> target <span class="token operator">=</span> self<span class="token punctuation">.</span>transforms<span class="token punctuation">(</span>img<span class="token punctuation">,</span> target<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æœ€åè¿”å›ï¼š</p><pre class="line-numbers language-python"><code class="language-python">        <span class="token keyword">return</span> img<span class="token punctuation">,</span> target<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="len"><a href="#len" class="headerlink" title="__len__"></a><code>__len__</code></h3><p>å°±æ˜¯è¿”å›æˆ‘ä»¬çš„æ‰€æœ‰çš„å›¾ç‰‡çš„ä¸ªæ•°ã€‚</p><pre class="line-numbers language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> len<span class="token punctuation">(</span>self<span class="token punctuation">.</span>imgs<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="Defining-your-model"><a href="#Defining-your-model" class="headerlink" title="Defining your model"></a>Defining your model</h2><p>åœ¨è¿™ä¸ªæ–‡æ¡£ï¼ˆtutorialï¼‰ä¸­,æˆ‘ä»¬å°†ä¼šä½¿ç”¨<code>Mask RCNN</code>, è¿™ä¸ªæ˜¯å»ºç«‹åœ¨æˆ‘ä»¬çš„<code>Faster RCNN</code>ä¹‹ä¸Šã€‚<code>Faster RCNN</code>læ˜¯ä¸€ä¸ªæ—¢é¢„æµ‹æˆ‘ä»¬çš„bboxåˆé¢„æµ‹æˆ‘ä»¬çš„æ¯ä¸€ç±»çš„å¾—åˆ†çš„ä¸€ä¸ªmodelã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pytorch.org/tutorials/_static/img/tv_tutorial/tv_image03.png" alt="Faster RCNN"></p><p><code>Mask RCNN</code>åŠ äº†ä¸€ä¸ªé¢å¤–çš„åˆ†æ”¯åˆ°<code>Faster RCNN</code>ä¸­ä¸Šå»ã€‚è¯¥åˆ†æ”¯ä¹Ÿé¢„æµ‹æˆ‘ä»¬çš„åˆ†å‰²çš„maskäº†å¯¹äºæ¯ä¸€ä¸ªå®ä¾‹ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pytorch.org/tutorials/_static/img/tv_tutorial/tv_image04.png" alt="Mask RCNN"></p><p>å½“æˆ‘ä»¬æƒ³è¦ä»torch visionåº“ä¸­æ¥é€‰å–ä¸€ä¸ªmodelæ¥è¿›è¡Œå¾®è°ƒä¿®é¥°è°ƒæ•´çš„æ—¶å€™ï¼Œä¸€èˆ¬ä¼šæœ‰ä¸¤ç§å¸¸è§çš„æƒ…å†µï¼šç¬¬ä¸€ç§å°±æ˜¯æˆ‘ä»¬æƒ³è¦ä»ä¸€ä¸ªé¢„è®­ç»ƒå¥½çš„æ¨¡å‹å¼€å§‹ï¼Œä»…ä»…flinetuneæœ€åä¸€å±‚ã€‚å¦ä¸€ç§å°±æ˜¯æˆ‘ä»¬æƒ³è¦ç”¨ä¸€ä¸ªä¸åŒçš„backboneæ¥å–ä»£æˆ‘ä»¬çš„åŸæ¥æ¨¡å‹çš„backboneï¼ˆä¾‹å¦‚ä¸ºäº†æ›´é«˜çš„ç²¾åº¦ç­‰ï¼‰ã€‚</p><h3 id="1-Finetuning-from-a-pretained-model"><a href="#1-Finetuning-from-a-pretained-model" class="headerlink" title="1-Finetuning from a pretained model"></a>1-Finetuning from a pretained model</h3><p>æˆ‘ä»¬å…ˆçœ‹å¦‚æœæˆ‘ä»¬äº†ä»ä¸€ä¸ªåœ¨COCOæ•°æ®é›†ä¸Šé¢„è®­ç»ƒå¥½çš„modelã€‚ç„¶åæˆ‘ä»¬æƒ³è¦å¯¹æˆ‘ä»¬çš„ç±»åˆ«è¿›è¡Œfinetuningï¼Œä»¥ä¸‹ä»£ç å°±æ˜¯ä¸€ä¸ªå¯èƒ½æˆ‘ä»¬å¯ä»¥å‚è€ƒçš„æ–¹å¼ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> torchvision<span class="token keyword">from</span> torchvision<span class="token punctuation">.</span>models<span class="token punctuation">.</span>detection<span class="token punctuation">.</span>faster_rcnn <span class="token keyword">import</span> FastRCNNPredictor<span class="token comment" spellcheck="true"># load a model pre-trained pre-trained on COCO</span>model <span class="token operator">=</span> torchvision<span class="token punctuation">.</span>models<span class="token punctuation">.</span>detection<span class="token punctuation">.</span>fasterrcnn_resnet50_fpn<span class="token punctuation">(</span>pretrained<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># replace the classifier with a new one, that has</span><span class="token comment" spellcheck="true"># num_classes which is user-defined</span>num_classes <span class="token operator">=</span> <span class="token number">2</span>  <span class="token comment" spellcheck="true"># 1 class (person) + background</span><span class="token comment" spellcheck="true"># get number of input features for the classifier</span>in_features <span class="token operator">=</span> model<span class="token punctuation">.</span>roi_heads<span class="token punctuation">.</span>box_predictor<span class="token punctuation">.</span>cls_score<span class="token punctuation">.</span>in_features<span class="token comment" spellcheck="true"># replace the pre-trained head with a new one</span>model<span class="token punctuation">.</span>roi_heads<span class="token punctuation">.</span>box_predictor <span class="token operator">=</span> FastRCNNPredictor<span class="token punctuation">(</span>in_features<span class="token punctuation">,</span> num_classes<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œå®é™…ä¸Šå‘ç°äº†ä¸€ä¸ªç›²ç‚¹ï¼FPNç«Ÿç„¶ä¹Ÿåœ¨è¿™é‡Œå‡ºç°äº†ï¼è¿™ä¸ªæ˜¯ç›®æ ‡æ£€æµ‹å¿…é¡»è¦æœ‰çš„ï¼Œæ²¡æœ‰çš„è¯èƒ½åšä¸ªæ¯›çº¿ï¼Œè¿™é‡Œæœ‰è®ºæ–‡åœ°å€ï¼Œä¸çŸ¥é“çš„è¯è‡ªå·±å»æœï¼Œåæ­£è¿™ä¸ªä¸œè¥¿æ˜¯éå¸¸é‡è¦çš„ï¼Œå…³æ³¨ä¸€ä¸‹çœ‹ï¼Œè™½ç„¶è¯´ç›®å‰è¯¥ç¯å¢ƒä¹‹ä¸‹ä¸äº†è§£è¿™ä¸ªä¸œè¥¿æ²¡ä»€ä¹ˆå¤§ç¢ã€‚</p><blockquote><p>FPNè®ºæ–‡åœ°å€ï¼šè®ºæ–‡ï¼š<a href="https://arxiv.org/pdf/1612.03144.pdf" target="_blank" rel="noopener">https://arxiv.org/pdf/1612.03144.pdf</a></p></blockquote><p>é¦–å…ˆæˆ‘ä»¬æ‰¾åˆ°äº†æˆ‘ä»¬çš„æ¨¡å‹ï¼Œä»torch visionåº“ä¸­æ‰¾åˆ°äº†æˆ‘ä»¬çš„ä¸€ä¸ªé¢„è®­ç»ƒæ¨¡å‹ã€‚æ¥ç€æˆ‘ä»¬å®šä¹‰ç±»ä¸º2ï¼Œå®é™…ä¸Šæˆ‘ä»¬ç›®æ ‡å°±æ˜¯æ£€æµ‹å‡ºäººå°±OKäº†ã€‚äºº+èƒŒæ™¯å°±æ˜¯ä¸¤ç±»ã€‚éšåæˆ‘ä»¬å®é™…ä¸Šå°±æ˜¯ä¸ºæˆ‘è¿›é—¨çš„åˆ†ç±»å™¨å¾—åˆ°äº†<code>in_features</code>.äº†éšåæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªæ–°çš„<code>pre-trained head</code>æ¥ä»£æ›¿ä¹‹å‰çš„ã€‚</p><h3 id="2-Modifying-the-model-to-add-a-different-backbone"><a href="#2-Modifying-the-model-to-add-a-different-backbone" class="headerlink" title="2-Modifying the model  to add a different backbone"></a>2-Modifying the model  to add a different backbone</h3><p>ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> torchvision<span class="token keyword">from</span> torchvision<span class="token punctuation">.</span>models<span class="token punctuation">.</span>detection <span class="token keyword">import</span> FasterRCNN<span class="token keyword">from</span> torchvision<span class="token punctuation">.</span>models<span class="token punctuation">.</span>detection<span class="token punctuation">.</span>rpn <span class="token keyword">import</span> AnchorGenerator<span class="token comment" spellcheck="true"># load a pre-trained model for classification and return</span><span class="token comment" spellcheck="true"># only the features</span>backbone <span class="token operator">=</span> torchvision<span class="token punctuation">.</span>models<span class="token punctuation">.</span>mobilenet_v2<span class="token punctuation">(</span>pretrained<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>features<span class="token comment" spellcheck="true"># FasterRCNN needs to know the number of</span><span class="token comment" spellcheck="true"># output channels in a backbone. For mobilenet_v2, it's 1280</span><span class="token comment" spellcheck="true"># so we need to add it here</span>backbone<span class="token punctuation">.</span>out_channels <span class="token operator">=</span> <span class="token number">1280</span><span class="token comment" spellcheck="true"># let's make the RPN generate 5 x 3 anchors per spatial</span><span class="token comment" spellcheck="true"># location, with 5 different sizes and 3 different aspect</span><span class="token comment" spellcheck="true"># ratios. We have a Tuple[Tuple[int]] because each feature</span><span class="token comment" spellcheck="true"># map could potentially have different sizes and</span><span class="token comment" spellcheck="true"># aspect ratios</span>anchor_generator <span class="token operator">=</span> AnchorGenerator<span class="token punctuation">(</span>sizes<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                                   aspect_ratios<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># let's define what are the feature maps that we will</span><span class="token comment" spellcheck="true"># use to perform the region of interest cropping, as well as</span><span class="token comment" spellcheck="true"># the size of the crop after rescaling.</span><span class="token comment" spellcheck="true"># if your backbone returns a Tensor, featmap_names is expected to</span><span class="token comment" spellcheck="true"># be [0]. More generally, the backbone should return an</span><span class="token comment" spellcheck="true"># OrderedDict[Tensor], and in featmap_names you can choose which</span><span class="token comment" spellcheck="true"># feature maps to use.</span>roi_pooler <span class="token operator">=</span> torchvision<span class="token punctuation">.</span>ops<span class="token punctuation">.</span>MultiScaleRoIAlign<span class="token punctuation">(</span>featmap_names<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'0'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                                                output_size<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span>                                                sampling_ratio<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># put the pieces together inside a FasterRCNN model</span>model <span class="token operator">=</span> FasterRCNN<span class="token punctuation">(</span>backbone<span class="token punctuation">,</span>                   num_classes<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>                   rpn_anchor_generator<span class="token operator">=</span>anchor_generator<span class="token punctuation">,</span>                   box_roi_pool<span class="token operator">=</span>roi_pooler<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><p>é¦–å…ˆæˆ‘ä»¬å¯¼å…¥å‡½æ•°åº“</p></li><li><p>æ¥ç€æˆ‘ä»¬é€‰æ‹©åŠ è½½ä¸€ä¸ªé¢„è®­ç»ƒæ¨¡å‹å…³äºæˆ‘ä»¬çš„åˆ†ç±»é—®é¢˜çš„æ¨¡å‹</p></li><li><p>å› ä¸ºæˆ‘ä»¬éœ€è¦çŸ¥é“backboneçš„<code>output_channels</code>ï¼Œ å¯¹äºmobilenet_v2æ¥è¯´ï¼Œè¿™ä¸ªæ˜¯1280,æ‰€ä»¥æˆ‘ä»¬éœ€è¦åŠ ä¸Šè¿™ä¸ªå‚æ•°ã€</p></li><li><p>ç„¶åæˆ‘ä»¬è¿›è¡ŒRPNç›¸å…³éƒ¨åˆ†ã€‚æ¯ä¸ªç©ºé—´éƒ½ç”Ÿæˆ5Ã—3ä¸ªanchorsï¼ŒæŒ‡5ä¸ªä¸åŒçš„å¤§å°ç„¶å3ç§ä¸åŒçš„é«˜å®½æ¯”ã€‚æˆ‘ä»¬æœ‰ä¸€ä¸ªå…ƒç»„å› ä¸ºæ¯ä¸ªfeature mapå¯éƒ½å¯èƒ½äº§ç”Ÿä¸åŒå¤§å°å’Œé«˜å®½æ¯”ã€‚</p></li><li></li><li><p>æœ€åæˆ‘ä»¬åªéœ€æŠŠè¿™äº›ä¸œè¥¿éƒ½åŠ åˆ°ä¸€ä¸ª<code>Faster RCNN</code>ä¸­å°±è¡Œäº†ã€‚</p></li></ul><h2 id="A-Instance-segmentation-model-for-PennFudan-Dataset"><a href="#A-Instance-segmentation-model-for-PennFudan-Dataset" class="headerlink" title="A Instance segmentation model for PennFudan Dataset"></a>A Instance segmentation model for PennFudan Dataset</h2><p>åœ¨æˆ‘ä»¬ç›®å‰çš„æƒ…å†µä¸‹ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„æ•°æ®é›†éå¸¸å°ï¼Œæˆ‘ä»¬æƒ³è¦å»fine-tuneä¸€ä¸ªé¢„è®­ç»ƒçš„æ¨¡å‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†ä¼šé€‰æ‹©ä»¥ä¸Šçš„æ–¹æ³•ä¸€ã€‚</p><p>æ¥ç€æˆ‘ä»¬æƒ³è¦è®¡ç®—å®ä¾‹çš„segmentation masksï¼Œæ‰€ä»¥æˆ‘ä»¬å°†ä¼šä½¿ç”¨ <code>Mask R-CNN</code>:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> torchvision<span class="token keyword">from</span> torchvision<span class="token punctuation">.</span>models<span class="token punctuation">.</span>detection<span class="token punctuation">.</span>faster_rcnn <span class="token keyword">import</span> FastRCNNPredictor<span class="token keyword">from</span> torchvision<span class="token punctuation">.</span>models<span class="token punctuation">.</span>detection<span class="token punctuation">.</span>mask_rcnn <span class="token keyword">import</span> MaskRCNNPredictor<span class="token keyword">def</span> <span class="token function">get_model_instance_segmentation</span><span class="token punctuation">(</span>num_classes<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># load an instance segmentation model pre-trained pre-trained on COCO</span>    model <span class="token operator">=</span> torchvision<span class="token punctuation">.</span>models<span class="token punctuation">.</span>detection<span class="token punctuation">.</span>maskrcnn_resnet50_fpn<span class="token punctuation">(</span>pretrained<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># get number of input features for the classifier</span>    in_features <span class="token operator">=</span> model<span class="token punctuation">.</span>roi_heads<span class="token punctuation">.</span>box_predictor<span class="token punctuation">.</span>cls_score<span class="token punctuation">.</span>in_features    <span class="token comment" spellcheck="true"># replace the pre-trained head with a new one</span>    model<span class="token punctuation">.</span>roi_heads<span class="token punctuation">.</span>box_predictor <span class="token operator">=</span> FastRCNNPredictor<span class="token punctuation">(</span>in_features<span class="token punctuation">,</span> num_classes<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># now get the number of input features for the mask classifier</span>    in_features_mask <span class="token operator">=</span> model<span class="token punctuation">.</span>roi_heads<span class="token punctuation">.</span>mask_predictor<span class="token punctuation">.</span>conv5_mask<span class="token punctuation">.</span>in_channels    hidden_layer <span class="token operator">=</span> <span class="token number">256</span>    <span class="token comment" spellcheck="true"># and replace the mask predictor with a new one</span>    model<span class="token punctuation">.</span>roi_heads<span class="token punctuation">.</span>mask_predictor <span class="token operator">=</span> MaskRCNNPredictor<span class="token punctuation">(</span>in_features_mask<span class="token punctuation">,</span>                                                       hidden_layer<span class="token punctuation">,</span>                                                       num_classes<span class="token punctuation">)</span>    <span class="token keyword">return</span> model<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ°æ­¤æˆ‘ä»¬åŸºæœ¬çš„ä»»åŠ¡æ¨¡å‹æ¶æ„å°±å®šä¹‰æ¸…æ¥šäº†ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†ä¼šè®©æ¨¡å‹è¢«è®­ç»ƒç„¶ååœ¨æˆ‘ä»¬çš„è‡ªå®šä¹‰æ•°æ®é›†ä¸Šè¿›è¡Œè¯„ä¼°ã€‚</p><h2 id="Putting-everything-together"><a href="#Putting-everything-together" class="headerlink" title="Putting everything together"></a>Putting everything together</h2><p>è¿™é‡Œå®é™…ä¸Šå°±æ˜¯è®²äº†ä¸‹ä½œè€…åœ¨è¿™é‡Œé¢å®šä¹‰äº†è®¸è®¸å¤šå¤šçš„è‡ªå·±å†™çš„å‡½æ•°ä»¥æ–¹ä¾¿æˆ‘ä»¬è¿›ä¸€æ­¥çš„è®­ç»ƒå’Œè¯„ä¼°ã€‚å¦‚æœæˆ‘ä»¬è¦ä¸‹è½½è¿™äº›ä¸œè¥¿ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©åˆ°GitHubçš„visionä»“åº“é‡Œé¢çš„<code>references/detection</code>ä¸­è¿›è¡Œç›¸å…³çš„ä¸‹è½½ã€‚</p><p>è¿™äº›æ˜¯æˆ‘ä»¬çš„å¸®åŠ©å‡½æ•°æ–¹ä¾¿æˆ‘ä»¬è¿›è¡Œç›¸å…³çš„æ•°æ®å¢å¼ºï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> transforms <span class="token keyword">as</span> T<span class="token keyword">def</span> <span class="token function">get_transform</span><span class="token punctuation">(</span>train<span class="token punctuation">)</span><span class="token punctuation">:</span>    transforms <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    transforms<span class="token punctuation">.</span>append<span class="token punctuation">(</span>T<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> train<span class="token punctuation">:</span>        transforms<span class="token punctuation">.</span>append<span class="token punctuation">(</span>T<span class="token punctuation">.</span>RandomHorizontalFlip<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> T<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span>transforms<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Testing-forward-method-Optional"><a href="#Testing-forward-method-Optional" class="headerlink" title="Testing  forward() method (Optional)"></a>Testing  <code>forward()</code> method (Optional)</h2><p>åœ¨æˆ‘ä»¬çš„datasetä¸Šè¿­ä»£ä¹‹å‰ï¼Œä¸€ä¸ªæ¯”è¾ƒå¥½çš„ä¹ æƒ¯å°±æ˜¯æˆ‘ä»¬çœ‹çœ‹modelåœ¨è®­ç»ƒsample datgaè¿‡ç¨‹å’Œè¿›ä¸€æ­¥inferenceçš„æ—¶é—´.</p><pre class="line-numbers language-python"><code class="language-python">model <span class="token operator">=</span> torchvision<span class="token punctuation">.</span>models<span class="token punctuation">.</span>detection<span class="token punctuation">.</span>fasterrcnn_resnet50_fpn<span class="token punctuation">(</span>pretrained<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>dataset <span class="token operator">=</span> PennFudanDataset<span class="token punctuation">(</span><span class="token string">'PennFudanPed'</span><span class="token punctuation">,</span> get_transform<span class="token punctuation">(</span>train<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>data_loader <span class="token operator">=</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span> dataset<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> num_workers<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> collate_fn<span class="token operator">=</span>utils<span class="token punctuation">.</span>collate_fn<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># For Training</span>images<span class="token punctuation">,</span>targets <span class="token operator">=</span> next<span class="token punctuation">(</span>iter<span class="token punctuation">(</span>data_loader<span class="token punctuation">)</span><span class="token punctuation">)</span>images <span class="token operator">=</span> list<span class="token punctuation">(</span>image <span class="token keyword">for</span> image <span class="token keyword">in</span> images<span class="token punctuation">)</span>targets <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>k<span class="token punctuation">:</span> v <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> t<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token keyword">for</span> t <span class="token keyword">in</span> targets<span class="token punctuation">]</span>output <span class="token operator">=</span> model<span class="token punctuation">(</span>images<span class="token punctuation">,</span>targets<span class="token punctuation">)</span>   <span class="token comment" spellcheck="true"># Returns losses and detections</span><span class="token comment" spellcheck="true"># For inference</span>model<span class="token punctuation">.</span>eval<span class="token punctuation">(</span><span class="token punctuation">)</span>x <span class="token operator">=</span> <span class="token punctuation">[</span>torch<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">,</span> torch<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">]</span>predictions <span class="token operator">=</span> model<span class="token punctuation">(</span>x<span class="token punctuation">)</span>           <span class="token comment" spellcheck="true"># Returns predictions</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ç€æˆ‘ä»¬å†™ä¸€ä¸‹æˆ‘ä»¬è®­ç»ƒå’Œvalidationçš„ä¸»å‡½æ•°ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> engine <span class="token keyword">import</span> train_one_epoch<span class="token punctuation">,</span> evaluate<span class="token keyword">import</span> utils<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># train on the GPU or on the CPU, if a GPU is not available</span>    device <span class="token operator">=</span> torch<span class="token punctuation">.</span>device<span class="token punctuation">(</span><span class="token string">'cuda'</span><span class="token punctuation">)</span> <span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> torch<span class="token punctuation">.</span>device<span class="token punctuation">(</span><span class="token string">'cpu'</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># our dataset has two classes only - background and person</span>    num_classes <span class="token operator">=</span> <span class="token number">2</span>    <span class="token comment" spellcheck="true"># use our dataset and defined transformations</span>    dataset <span class="token operator">=</span> PennFudanDataset<span class="token punctuation">(</span><span class="token string">'PennFudanPed'</span><span class="token punctuation">,</span> get_transform<span class="token punctuation">(</span>train<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    dataset_test <span class="token operator">=</span> PennFudanDataset<span class="token punctuation">(</span><span class="token string">'PennFudanPed'</span><span class="token punctuation">,</span> get_transform<span class="token punctuation">(</span>train<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># split the dataset in train and test set</span>    indices <span class="token operator">=</span> torch<span class="token punctuation">.</span>randperm<span class="token punctuation">(</span>len<span class="token punctuation">(</span>dataset<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>    dataset <span class="token operator">=</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>Subset<span class="token punctuation">(</span>dataset<span class="token punctuation">,</span> indices<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    dataset_test <span class="token operator">=</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>Subset<span class="token punctuation">(</span>dataset_test<span class="token punctuation">,</span> indices<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">50</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># define training and validation data loaders</span>    data_loader <span class="token operator">=</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>        dataset<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> num_workers<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>        collate_fn<span class="token operator">=</span>utils<span class="token punctuation">.</span>collate_fn<span class="token punctuation">)</span>    data_loader_test <span class="token operator">=</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>        dataset_test<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> num_workers<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>        collate_fn<span class="token operator">=</span>utils<span class="token punctuation">.</span>collate_fn<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># get the model using our helper function</span>    model <span class="token operator">=</span> get_model_instance_segmentation<span class="token punctuation">(</span>num_classes<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># move model to the right device</span>    model<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># construct an optimizer</span>    params <span class="token operator">=</span> <span class="token punctuation">[</span>p <span class="token keyword">for</span> p <span class="token keyword">in</span> model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> p<span class="token punctuation">.</span>requires_grad<span class="token punctuation">]</span>    optimizer <span class="token operator">=</span> torch<span class="token punctuation">.</span>optim<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span>params<span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.005</span><span class="token punctuation">,</span>                                momentum<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span> weight_decay<span class="token operator">=</span><span class="token number">0.0005</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># and a learning rate scheduler</span>    lr_scheduler <span class="token operator">=</span> torch<span class="token punctuation">.</span>optim<span class="token punctuation">.</span>lr_scheduler<span class="token punctuation">.</span>StepLR<span class="token punctuation">(</span>optimizer<span class="token punctuation">,</span>                                                   step_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>                                                   gamma<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># let's train it for 10 epochs</span>    num_epochs <span class="token operator">=</span> <span class="token number">10</span>    <span class="token keyword">for</span> epoch <span class="token keyword">in</span> range<span class="token punctuation">(</span>num_epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># train for one epoch, printing every 10 iterations</span>        train_one_epoch<span class="token punctuation">(</span>model<span class="token punctuation">,</span> optimizer<span class="token punctuation">,</span> data_loader<span class="token punctuation">,</span> device<span class="token punctuation">,</span> epoch<span class="token punctuation">,</span> print_freq<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># update the learning rate</span>        lr_scheduler<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># evaluate on the test dataset</span>        evaluate<span class="token punctuation">(</span>model<span class="token punctuation">,</span> data_loader_test<span class="token punctuation">,</span> device<span class="token operator">=</span>device<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"That's it!"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæ˜¯è®­ç»ƒäº†10ä¸ªepochï¼Œè€Œæˆ‘ä»¬å¦‚æœè¿è¡Œäº†ç¬¬ä¸€ä¸ªepochï¼Œå°±èƒ½çœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹çš„ç»“æœï¼š</p><pre class="line-numbers language-python"><code class="language-python">Epoch<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token punctuation">[</span> <span class="token number">0</span><span class="token operator">/</span><span class="token number">60</span><span class="token punctuation">]</span>  eta<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">01</span><span class="token punctuation">:</span><span class="token number">18</span>  lr<span class="token punctuation">:</span> <span class="token number">0.000090</span>  loss<span class="token punctuation">:</span> <span class="token number">2.5213</span> <span class="token punctuation">(</span><span class="token number">2.5213</span><span class="token punctuation">)</span>  loss_classifier<span class="token punctuation">:</span> <span class="token number">0.8025</span> <span class="token punctuation">(</span><span class="token number">0.8025</span><span class="token punctuation">)</span>  loss_box_reg<span class="token punctuation">:</span> <span class="token number">0.2634</span> <span class="token punctuation">(</span><span class="token number">0.2634</span><span class="token punctuation">)</span>  loss_mask<span class="token punctuation">:</span> <span class="token number">1.4265</span> <span class="token punctuation">(</span><span class="token number">1.4265</span><span class="token punctuation">)</span>  loss_objectness<span class="token punctuation">:</span> <span class="token number">0.0190</span> <span class="token punctuation">(</span><span class="token number">0.0190</span><span class="token punctuation">)</span>  loss_rpn_box_reg<span class="token punctuation">:</span> <span class="token number">0.0099</span> <span class="token punctuation">(</span><span class="token number">0.0099</span><span class="token punctuation">)</span>  time<span class="token punctuation">:</span> <span class="token number">1.3121</span>  data<span class="token punctuation">:</span> <span class="token number">0.3024</span>  max mem<span class="token punctuation">:</span> <span class="token number">3485</span>Epoch<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token punctuation">[</span><span class="token number">10</span><span class="token operator">/</span><span class="token number">60</span><span class="token punctuation">]</span>  eta<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">20</span>  lr<span class="token punctuation">:</span> <span class="token number">0.000936</span>  loss<span class="token punctuation">:</span> <span class="token number">1.3007</span> <span class="token punctuation">(</span><span class="token number">1.5313</span><span class="token punctuation">)</span>  loss_classifier<span class="token punctuation">:</span> <span class="token number">0.3979</span> <span class="token punctuation">(</span><span class="token number">0.4719</span><span class="token punctuation">)</span>  loss_box_reg<span class="token punctuation">:</span> <span class="token number">0.2454</span> <span class="token punctuation">(</span><span class="token number">0.2272</span><span class="token punctuation">)</span>  loss_mask<span class="token punctuation">:</span> <span class="token number">0.6089</span> <span class="token punctuation">(</span><span class="token number">0.7953</span><span class="token punctuation">)</span>  loss_objectness<span class="token punctuation">:</span> <span class="token number">0.0197</span> <span class="token punctuation">(</span><span class="token number">0.0228</span><span class="token punctuation">)</span>  loss_rpn_box_reg<span class="token punctuation">:</span> <span class="token number">0.0121</span> <span class="token punctuation">(</span><span class="token number">0.0141</span><span class="token punctuation">)</span>  time<span class="token punctuation">:</span> <span class="token number">0.4198</span>  data<span class="token punctuation">:</span> <span class="token number">0.0298</span>  max mem<span class="token punctuation">:</span> <span class="token number">5081</span>Epoch<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token punctuation">[</span><span class="token number">20</span><span class="token operator">/</span><span class="token number">60</span><span class="token punctuation">]</span>  eta<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">15</span>  lr<span class="token punctuation">:</span> <span class="token number">0.001783</span>  loss<span class="token punctuation">:</span> <span class="token number">0.7567</span> <span class="token punctuation">(</span><span class="token number">1.1056</span><span class="token punctuation">)</span>  loss_classifier<span class="token punctuation">:</span> <span class="token number">0.2221</span> <span class="token punctuation">(</span><span class="token number">0.3319</span><span class="token punctuation">)</span>  loss_box_reg<span class="token punctuation">:</span> <span class="token number">0.2002</span> <span class="token punctuation">(</span><span class="token number">0.2106</span><span class="token punctuation">)</span>  loss_mask<span class="token punctuation">:</span> <span class="token number">0.2904</span> <span class="token punctuation">(</span><span class="token number">0.5332</span><span class="token punctuation">)</span>  loss_objectness<span class="token punctuation">:</span> <span class="token number">0.0146</span> <span class="token punctuation">(</span><span class="token number">0.0176</span><span class="token punctuation">)</span>  loss_rpn_box_reg<span class="token punctuation">:</span> <span class="token number">0.0094</span> <span class="token punctuation">(</span><span class="token number">0.0123</span><span class="token punctuation">)</span>  time<span class="token punctuation">:</span> <span class="token number">0.3293</span>  data<span class="token punctuation">:</span> <span class="token number">0.0035</span>  max mem<span class="token punctuation">:</span> <span class="token number">5081</span>Epoch<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token punctuation">[</span><span class="token number">30</span><span class="token operator">/</span><span class="token number">60</span><span class="token punctuation">]</span>  eta<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">11</span>  lr<span class="token punctuation">:</span> <span class="token number">0.002629</span>  loss<span class="token punctuation">:</span> <span class="token number">0.4705</span> <span class="token punctuation">(</span><span class="token number">0.8935</span><span class="token punctuation">)</span>  loss_classifier<span class="token punctuation">:</span> <span class="token number">0.0991</span> <span class="token punctuation">(</span><span class="token number">0.2517</span><span class="token punctuation">)</span>  loss_box_reg<span class="token punctuation">:</span> <span class="token number">0.1578</span> <span class="token punctuation">(</span><span class="token number">0.1957</span><span class="token punctuation">)</span>  loss_mask<span class="token punctuation">:</span> <span class="token number">0.1970</span> <span class="token punctuation">(</span><span class="token number">0.4204</span><span class="token punctuation">)</span>  loss_objectness<span class="token punctuation">:</span> <span class="token number">0.0061</span> <span class="token punctuation">(</span><span class="token number">0.0140</span><span class="token punctuation">)</span>  loss_rpn_box_reg<span class="token punctuation">:</span> <span class="token number">0.0075</span> <span class="token punctuation">(</span><span class="token number">0.0118</span><span class="token punctuation">)</span>  time<span class="token punctuation">:</span> <span class="token number">0.3403</span>  data<span class="token punctuation">:</span> <span class="token number">0.0044</span>  max mem<span class="token punctuation">:</span> <span class="token number">5081</span>Epoch<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token punctuation">[</span><span class="token number">40</span><span class="token operator">/</span><span class="token number">60</span><span class="token punctuation">]</span>  eta<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">07</span>  lr<span class="token punctuation">:</span> <span class="token number">0.003476</span>  loss<span class="token punctuation">:</span> <span class="token number">0.3901</span> <span class="token punctuation">(</span><span class="token number">0.7568</span><span class="token punctuation">)</span>  loss_classifier<span class="token punctuation">:</span> <span class="token number">0.0648</span> <span class="token punctuation">(</span><span class="token number">0.2022</span><span class="token punctuation">)</span>  loss_box_reg<span class="token punctuation">:</span> <span class="token number">0.1207</span> <span class="token punctuation">(</span><span class="token number">0.1736</span><span class="token punctuation">)</span>  loss_mask<span class="token punctuation">:</span> <span class="token number">0.1705</span> <span class="token punctuation">(</span><span class="token number">0.3585</span><span class="token punctuation">)</span>  loss_objectness<span class="token punctuation">:</span> <span class="token number">0.0018</span> <span class="token punctuation">(</span><span class="token number">0.0113</span><span class="token punctuation">)</span>  loss_rpn_box_reg<span class="token punctuation">:</span> <span class="token number">0.0075</span> <span class="token punctuation">(</span><span class="token number">0.0112</span><span class="token punctuation">)</span>  time<span class="token punctuation">:</span> <span class="token number">0.3407</span>  data<span class="token punctuation">:</span> <span class="token number">0.0044</span>  max mem<span class="token punctuation">:</span> <span class="token number">5081</span>Epoch<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token punctuation">[</span><span class="token number">50</span><span class="token operator">/</span><span class="token number">60</span><span class="token punctuation">]</span>  eta<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">03</span>  lr<span class="token punctuation">:</span> <span class="token number">0.004323</span>  loss<span class="token punctuation">:</span> <span class="token number">0.3237</span> <span class="token punctuation">(</span><span class="token number">0.6703</span><span class="token punctuation">)</span>  loss_classifier<span class="token punctuation">:</span> <span class="token number">0.0474</span> <span class="token punctuation">(</span><span class="token number">0.1731</span><span class="token punctuation">)</span>  loss_box_reg<span class="token punctuation">:</span> <span class="token number">0.1109</span> <span class="token punctuation">(</span><span class="token number">0.1561</span><span class="token punctuation">)</span>  loss_mask<span class="token punctuation">:</span> <span class="token number">0.1658</span> <span class="token punctuation">(</span><span class="token number">0.3201</span><span class="token punctuation">)</span>  loss_objectness<span class="token punctuation">:</span> <span class="token number">0.0015</span> <span class="token punctuation">(</span><span class="token number">0.0093</span><span class="token punctuation">)</span>  loss_rpn_box_reg<span class="token punctuation">:</span> <span class="token number">0.0093</span> <span class="token punctuation">(</span><span class="token number">0.0116</span><span class="token punctuation">)</span>  time<span class="token punctuation">:</span> <span class="token number">0.3379</span>  data<span class="token punctuation">:</span> <span class="token number">0.0043</span>  max mem<span class="token punctuation">:</span> <span class="token number">5081</span>Epoch<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token punctuation">[</span><span class="token number">59</span><span class="token operator">/</span><span class="token number">60</span><span class="token punctuation">]</span>  eta<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span>  lr<span class="token punctuation">:</span> <span class="token number">0.005000</span>  loss<span class="token punctuation">:</span> <span class="token number">0.2540</span> <span class="token punctuation">(</span><span class="token number">0.6082</span><span class="token punctuation">)</span>  loss_classifier<span class="token punctuation">:</span> <span class="token number">0.0309</span> <span class="token punctuation">(</span><span class="token number">0.1526</span><span class="token punctuation">)</span>  loss_box_reg<span class="token punctuation">:</span> <span class="token number">0.0463</span> <span class="token punctuation">(</span><span class="token number">0.1405</span><span class="token punctuation">)</span>  loss_mask<span class="token punctuation">:</span> <span class="token number">0.1568</span> <span class="token punctuation">(</span><span class="token number">0.2945</span><span class="token punctuation">)</span>  loss_objectness<span class="token punctuation">:</span> <span class="token number">0.0012</span> <span class="token punctuation">(</span><span class="token number">0.0083</span><span class="token punctuation">)</span>  loss_rpn_box_reg<span class="token punctuation">:</span> <span class="token number">0.0093</span> <span class="token punctuation">(</span><span class="token number">0.0123</span><span class="token punctuation">)</span>  time<span class="token punctuation">:</span> <span class="token number">0.3489</span>  data<span class="token punctuation">:</span> <span class="token number">0.0042</span>  max mem<span class="token punctuation">:</span> <span class="token number">5081</span>Epoch<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> Total time<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">21</span> <span class="token punctuation">(</span><span class="token number">0.3570</span> s <span class="token operator">/</span> it<span class="token punctuation">)</span>creating index<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>index created!Test<span class="token punctuation">:</span>  <span class="token punctuation">[</span> <span class="token number">0</span><span class="token operator">/</span><span class="token number">50</span><span class="token punctuation">]</span>  eta<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">19</span>  model_time<span class="token punctuation">:</span> <span class="token number">0.2152</span> <span class="token punctuation">(</span><span class="token number">0.2152</span><span class="token punctuation">)</span>  evaluator_time<span class="token punctuation">:</span> <span class="token number">0.0133</span> <span class="token punctuation">(</span><span class="token number">0.0133</span><span class="token punctuation">)</span>  time<span class="token punctuation">:</span> <span class="token number">0.4000</span>  data<span class="token punctuation">:</span> <span class="token number">0.1701</span>  max mem<span class="token punctuation">:</span> <span class="token number">5081</span>Test<span class="token punctuation">:</span>  <span class="token punctuation">[</span><span class="token number">49</span><span class="token operator">/</span><span class="token number">50</span><span class="token punctuation">]</span>  eta<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span>  model_time<span class="token punctuation">:</span> <span class="token number">0.0628</span> <span class="token punctuation">(</span><span class="token number">0.0687</span><span class="token punctuation">)</span>  evaluator_time<span class="token punctuation">:</span> <span class="token number">0.0039</span> <span class="token punctuation">(</span><span class="token number">0.0064</span><span class="token punctuation">)</span>  time<span class="token punctuation">:</span> <span class="token number">0.0735</span>  data<span class="token punctuation">:</span> <span class="token number">0.0022</span>  max mem<span class="token punctuation">:</span> <span class="token number">5081</span>Test<span class="token punctuation">:</span> Total time<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">04</span> <span class="token punctuation">(</span><span class="token number">0.0828</span> s <span class="token operator">/</span> it<span class="token punctuation">)</span>Averaged stats<span class="token punctuation">:</span> model_time<span class="token punctuation">:</span> <span class="token number">0.0628</span> <span class="token punctuation">(</span><span class="token number">0.0687</span><span class="token punctuation">)</span>  evaluator_time<span class="token punctuation">:</span> <span class="token number">0.0039</span> <span class="token punctuation">(</span><span class="token number">0.0064</span><span class="token punctuation">)</span>Accumulating evaluation results<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>DONE <span class="token punctuation">(</span>t<span class="token operator">=</span><span class="token number">0.</span>01s<span class="token punctuation">)</span><span class="token punctuation">.</span>Accumulating evaluation results<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>DONE <span class="token punctuation">(</span>t<span class="token operator">=</span><span class="token number">0.</span>01s<span class="token punctuation">)</span><span class="token punctuation">.</span>IoU metric<span class="token punctuation">:</span> bbox Average Precision  <span class="token punctuation">(</span>AP<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span>   all <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.606</span> Average Precision  <span class="token punctuation">(</span>AP<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span>      <span class="token operator">|</span> area<span class="token operator">=</span>   all <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.984</span> Average Precision  <span class="token punctuation">(</span>AP<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.75</span>      <span class="token operator">|</span> area<span class="token operator">=</span>   all <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.780</span> Average Precision  <span class="token punctuation">(</span>AP<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span> small <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.313</span> Average Precision  <span class="token punctuation">(</span>AP<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span>medium <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.582</span> Average Precision  <span class="token punctuation">(</span>AP<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span> large <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.612</span> Average Recall     <span class="token punctuation">(</span>AR<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span>   all <span class="token operator">|</span> maxDets<span class="token operator">=</span>  <span class="token number">1</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.270</span> Average Recall     <span class="token punctuation">(</span>AR<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span>   all <span class="token operator">|</span> maxDets<span class="token operator">=</span> <span class="token number">10</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.672</span> Average Recall     <span class="token punctuation">(</span>AR<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span>   all <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.672</span> Average Recall     <span class="token punctuation">(</span>AR<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span> small <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.650</span> Average Recall     <span class="token punctuation">(</span>AR<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span>medium <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.755</span> Average Recall     <span class="token punctuation">(</span>AR<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span> large <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.664</span>IoU metric<span class="token punctuation">:</span> segm Average Precision  <span class="token punctuation">(</span>AP<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span>   all <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.704</span> Average Precision  <span class="token punctuation">(</span>AP<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span>      <span class="token operator">|</span> area<span class="token operator">=</span>   all <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.979</span> Average Precision  <span class="token punctuation">(</span>AP<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.75</span>      <span class="token operator">|</span> area<span class="token operator">=</span>   all <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.871</span> Average Precision  <span class="token punctuation">(</span>AP<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span> small <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.325</span> Average Precision  <span class="token punctuation">(</span>AP<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span>medium <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.488</span> Average Precision  <span class="token punctuation">(</span>AP<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span> large <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.727</span> Average Recall     <span class="token punctuation">(</span>AR<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span>   all <span class="token operator">|</span> maxDets<span class="token operator">=</span>  <span class="token number">1</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.316</span> Average Recall     <span class="token punctuation">(</span>AR<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span>   all <span class="token operator">|</span> maxDets<span class="token operator">=</span> <span class="token number">10</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.748</span> Average Recall     <span class="token punctuation">(</span>AR<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span>   all <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.749</span> Average Recall     <span class="token punctuation">(</span>AR<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span> small <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.650</span> Average Recall     <span class="token punctuation">(</span>AR<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span>medium <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.673</span> Average Recall     <span class="token punctuation">(</span>AR<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span> large <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.758</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»ç¬¬ä¸€ä¸ªepochçš„è®­ç»ƒè¿™é‡Œé¢å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬*â€obtain a COCO-style mAP of 60.6, and a mask mAP of 70.4.â€*</p><p>åœ¨è®­ç»ƒ10ä¸ªepochä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä»¥ä¸‹æŒ‡æ ‡ï¼ˆmetricsï¼‰:</p><pre class="line-numbers language-python"><code class="language-python">IoU metric<span class="token punctuation">:</span> bbox Average Precision  <span class="token punctuation">(</span>AP<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span>   all <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.799</span> Average Precision  <span class="token punctuation">(</span>AP<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span>      <span class="token operator">|</span> area<span class="token operator">=</span>   all <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.969</span> Average Precision  <span class="token punctuation">(</span>AP<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.75</span>      <span class="token operator">|</span> area<span class="token operator">=</span>   all <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.935</span> Average Precision  <span class="token punctuation">(</span>AP<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span> small <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.349</span> Average Precision  <span class="token punctuation">(</span>AP<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span>medium <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.592</span> Average Precision  <span class="token punctuation">(</span>AP<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span> large <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.831</span> Average Recall     <span class="token punctuation">(</span>AR<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span>   all <span class="token operator">|</span> maxDets<span class="token operator">=</span>  <span class="token number">1</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.324</span> Average Recall     <span class="token punctuation">(</span>AR<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span>   all <span class="token operator">|</span> maxDets<span class="token operator">=</span> <span class="token number">10</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.844</span> Average Recall     <span class="token punctuation">(</span>AR<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span>   all <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.844</span> Average Recall     <span class="token punctuation">(</span>AR<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span> small <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.400</span> Average Recall     <span class="token punctuation">(</span>AR<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span>medium <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.777</span> Average Recall     <span class="token punctuation">(</span>AR<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span> large <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.870</span>IoU metric<span class="token punctuation">:</span> segm Average Precision  <span class="token punctuation">(</span>AP<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span>   all <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.761</span> Average Precision  <span class="token punctuation">(</span>AP<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span>      <span class="token operator">|</span> area<span class="token operator">=</span>   all <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.969</span> Average Precision  <span class="token punctuation">(</span>AP<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.75</span>      <span class="token operator">|</span> area<span class="token operator">=</span>   all <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.919</span> Average Precision  <span class="token punctuation">(</span>AP<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span> small <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.341</span> Average Precision  <span class="token punctuation">(</span>AP<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span>medium <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.464</span> Average Precision  <span class="token punctuation">(</span>AP<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span> large <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.788</span> Average Recall     <span class="token punctuation">(</span>AR<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span>   all <span class="token operator">|</span> maxDets<span class="token operator">=</span>  <span class="token number">1</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.303</span> Average Recall     <span class="token punctuation">(</span>AR<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span>   all <span class="token operator">|</span> maxDets<span class="token operator">=</span> <span class="token number">10</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.799</span> Average Recall     <span class="token punctuation">(</span>AR<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span>   all <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.799</span> Average Recall     <span class="token punctuation">(</span>AR<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span> small <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.400</span> Average Recall     <span class="token punctuation">(</span>AR<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span>medium <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.769</span> Average Recall     <span class="token punctuation">(</span>AR<span class="token punctuation">)</span> @<span class="token punctuation">[</span> IoU<span class="token operator">=</span><span class="token number">0.50</span><span class="token punctuation">:</span><span class="token number">0.95</span> <span class="token operator">|</span> area<span class="token operator">=</span> large <span class="token operator">|</span> maxDets<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.818</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬å¯ä»¥çœ‹çœ‹ç»“æœç©¶ç«Ÿæ€ä¹ˆæ ·ï¼Œé€‰ä¸€å¼ å›¾ç‰‡æ¥çœ‹ï¼š</p><p>But what do the predictions look like? Letâ€™s take one image in the dataset and verify</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pytorch.org/tutorials/_static/img/tv_tutorial/tv_image05.png" alt="intermediate/../../_static/img/tv_tutorial/tv_image05.png"></p><p>The trained model predicts 9 instances of person in this image, letâ€™s see a couple of them:</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pytorch.org/tutorials/_static/img/tv_tutorial/tv_image06.png" alt="intermediate/../../_static/img/tv_tutorial/tv_image06.png"> <img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pytorch.org/tutorials/_static/img/tv_tutorial/tv_image07.png" alt="intermediate/../../_static/img/tv_tutorial/tv_image07.png"></p><p>The results look pretty good!</p><h2 id="Wrapping-up"><a href="#Wrapping-up" class="headerlink" title="Wrapping up"></a>Wrapping up</h2><p>In this tutorial, you have learned how to create your own training pipeline for instance segmentation models, on a custom dataset. For that, you wrote a <code>torch.utils.data.Dataset</code> class that returns the images and the ground truth boxes and segmentation masks. You also leveraged a Mask R-CNN model pre-trained on COCO train2017 in order to perform transfer learning on this new dataset.</p><p>For a more complete example, which includes multi-machine / multi-gpu training, check <code>references/detection/train.py</code>, which is present in the torchvision repo.</p><p>You can download a full source file for this tutorial <a href="https://pytorch.org/tutorials/_static/tv-training-code.py" target="_blank" rel="noopener">here</a>.</p>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pytorch </tag>
            
            <tag> Mask-RCNN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxç¬”è®°ï¼ˆæŒç»­æ›´æ–°ï¼‰</title>
      <link href="/2021/09/24/linux-bi-ji/"/>
      <url>/2021/09/24/linux-bi-ji/</url>
      
        <content type="html"><![CDATA[<p>4å¼ 2080Tiï¼ï¼æˆ‘è¿æ¥äº†Dianå›¢é˜Ÿçš„æœåŠ¡å™¨ä¹‹åï¼Œç»ˆäºä¸ç”¨å†æ‹…å¿ƒç®—åŠ›çš„é—®é¢˜äº†ğŸ˜­ï¼ä¹‹å‰æ€»æ˜¯é kaggleã€colabè¿™äº›ç™½å«–GPUï¼Œç°åœ¨å®Œå…¨ä¸ç”¨æ‹…å¿ƒè¿™äº›é—®é¢˜ï¼Œç›´æ¥è¿æ¥åˆ°Diançš„æœåŠ¡å™¨ï¼Œç®—åŠ›åè¶³ã€‚è¿™ä¹Ÿæ­£å¥½è®©æˆ‘å¼€å§‹æ¥è§¦åˆ°äº†Linuxï¼Œä»»åŠ¡é©±åŠ¨ä¹‹ä¸‹ï¼Œä¹Ÿä¸å¾—ä¸å­¦ä¸€äº›Linuxå‘½ä»¤ï¼Œæ­£å¥½å®é™…ä¸Šæˆ‘å¯¹è¿™ä¸ªä¸œè¥¿ä¹ŸæŒºå¥½å¥‡çš„ï¼Œè¿™é‡Œå¼€ä¸€ç¯‡åšå®¢è®°å½•ä¸€ä¸‹ã€‚</p><p><strong>ç¬”è®°è®°å¾—ä¼šéå¸¸æ²¡æœ‰ç« æ³•ï¼Œä½†æ˜¯è¿™ç®—æ˜¯ä¸€ä¸ªå­¦ä¹ çš„è¿‡ç¨‹ã€‚è¿™ç¯‡æ–‡ç« å¯èƒ½ä¸æ˜¯æŒ‰ç…§é¡ºåºç†è§£çš„</strong></p><p>å¶ç„¶åœ¨GitHubä¸Šçœ‹åˆ°äº†ä¸€ä¸ªå¾ˆç®€å•çš„ä»“åº“å…³äºshellå‘½ä»¤çš„ä¸€äº›çŸ¥è¯†ï¼Œä¸€ä¸ªreadmeæ–‡æ¡£æœ‰ç©ºå¯ä»¥çœ‹çœ‹ï¼š<a href="https://github.com/jlevy/the-art-of-command-line/blob/master/README-zh.md" target="_blank" rel="noopener">å‘½ä»¤è¡Œçš„è‰ºæœ¯</a></p><h2 id="æŸ¥çœ‹æ˜¾å¡çš„å‹å·ã€ä¿¡æ¯-ç½®é¡¶"><a href="#æŸ¥çœ‹æ˜¾å¡çš„å‹å·ã€ä¿¡æ¯-ç½®é¡¶" class="headerlink" title="æŸ¥çœ‹æ˜¾å¡çš„å‹å·ã€ä¿¡æ¯(ç½®é¡¶)"></a>æŸ¥çœ‹æ˜¾å¡çš„å‹å·ã€ä¿¡æ¯(ç½®é¡¶)</h2><pre class="line-numbers language-shell"><code class="language-shell">nvidia-smi -L<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åº·åº·Diançš„æœåŠ¡å™¨çš„4å¼ 2080Tiï¼š</p><p><a href="https://imgtu.com/i/4rdY0f" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/09/25/4rdY0f.png" alt="nvidia"></a></p><p>åœ¨ Linux ä¸­ç›®å‰æœ‰å‡ ä¸ªå‘½ä»¤å¯ä»¥ç”¨æ¥è·å–ç¡¬ä»¶ä¿¡æ¯ï¼Œå…¶ä¸­ lspic å‘½ä»¤è¡Œå·¥å…·ä¾¿å¯ç”¨æ¥è·å–æ˜¾å¡çš„ç¡¬ä»¶ä¿¡æ¯ã€‚</p><p>è¿™é‡Œç›®å‰ä¸å¤ªèƒ½ç”¨åˆ°ï¼Œä»¥åç”¨åˆ°å†è¯´ã€‚å¯ä»¥çœ‹çœ‹è¿™ä¸ªåšå®¢ï¼š<a href="https://www.sysgeek.cn/graphics-card-information-linux/ã€‚" target="_blank" rel="noopener">https://www.sysgeek.cn/graphics-card-information-linux/ã€‚</a></p><p>æŸ¥çœ‹CPUä¿¡æ¯ï¼ˆå‹å·ï¼‰</p><pre class="line-numbers language-shell"><code class="language-shell">cat /proc/cpuinfo | grep name | cut -f2 -d: | uniq -c<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŸ¥çœ‹å†…å­˜ä¿¡æ¯</p><p># cat /proc/meminfo</p><p>å¦‚ä½•æŸ¥çœ‹Linux å†…æ ¸<br>uname -a<br>cat /proc/version</p><p>æŸ¥çœ‹æœºå™¨å‹å·ï¼ˆæœºå™¨ç¡¬ä»¶å‹å·ï¼‰</p><p>dmidecode | grep â€œProduct Nameâ€<br>dmidecode</p><p>å¦‚ä½•æŸ¥çœ‹linux ç³»ç»Ÿç‰ˆæœ¬<br>cat /etc/redhat-release<br>lsb_release -a<br>cat /etc/issue</p><p>å¦‚ä½•æŸ¥çœ‹linuxç³»ç»Ÿå’ŒCPUå‹å·ï¼Œç±»å‹å’Œå¤§å°<br>cat /proc/cpuinfo</p><p>å¦‚ä½•æŸ¥çœ‹linux ç³»ç»Ÿå†…å­˜å¤§å°çš„ä¿¡æ¯ï¼Œå¯ä»¥æŸ¥çœ‹æ€»å†…å­˜ï¼Œå‰©ä½™å†…å­˜ï¼Œå¯ä½¿ç”¨å†…å­˜ç­‰ä¿¡æ¯<br>cat /proc/meminfo</p><h2 id="é¦–å…ˆç®€å•ä»‹ç»ä¸€ä¸‹SSH"><a href="#é¦–å…ˆç®€å•ä»‹ç»ä¸€ä¸‹SSH" class="headerlink" title="é¦–å…ˆç®€å•ä»‹ç»ä¸€ä¸‹SSH"></a>é¦–å…ˆç®€å•ä»‹ç»ä¸€ä¸‹SSH</h2><blockquote><p>è¯¥éƒ¨åˆ†é€‰è‡ªï¼šé˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—<a href="https://www.ruanyifeng.com/blog/2011/12/ssh_remote_login.html" target="_blank" rel="noopener">https://www.ruanyifeng.com/blog/2011/12/ssh_remote_login.html</a></p></blockquote><h3 id="ä¸€ã€ä»€ä¹ˆæ˜¯SSHï¼Ÿ"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯SSHï¼Ÿ" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯SSHï¼Ÿ"></a><strong>ä¸€ã€ä»€ä¹ˆæ˜¯SSHï¼Ÿ</strong></h3><p>ç®€å•è¯´ï¼ŒSSHæ˜¯ä¸€ç§ç½‘ç»œåè®®ï¼Œç”¨äºè®¡ç®—æœºä¹‹é—´çš„åŠ å¯†ç™»å½•ã€‚</p><p>å¦‚æœä¸€ä¸ªç”¨æˆ·ä»æœ¬åœ°è®¡ç®—æœºï¼Œä½¿ç”¨SSHåè®®ç™»å½•å¦ä¸€å°è¿œç¨‹è®¡ç®—æœºï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¤ä¸ºï¼Œè¿™ç§ç™»å½•æ˜¯å®‰å…¨çš„ï¼Œå³ä½¿è¢«ä¸­é€”æˆªè·ï¼Œå¯†ç ä¹Ÿä¸ä¼šæ³„éœ²ã€‚</p><p>æœ€æ—©çš„æ—¶å€™ï¼Œäº’è”ç½‘é€šä¿¡éƒ½æ˜¯æ˜æ–‡é€šä¿¡ï¼Œä¸€æ—¦è¢«æˆªè·ï¼Œå†…å®¹å°±æš´éœ²æ— ç–‘ã€‚1995å¹´ï¼ŒèŠ¬å…°å­¦è€…Tatu Ylonenè®¾è®¡äº†SSHåè®®ï¼Œå°†ç™»å½•ä¿¡æ¯å…¨éƒ¨åŠ å¯†ï¼Œæˆä¸ºäº’è”ç½‘å®‰å…¨çš„ä¸€ä¸ªåŸºæœ¬è§£å†³æ–¹æ¡ˆï¼Œè¿…é€Ÿåœ¨å…¨ä¸–ç•Œè·å¾—æ¨å¹¿ï¼Œç›®å‰å·²ç»æˆä¸ºLinuxç³»ç»Ÿçš„æ ‡å‡†é…ç½®ã€‚</p><p>éœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼ŒSSHåªæ˜¯ä¸€ç§åè®®ï¼Œå­˜åœ¨å¤šç§å®ç°ï¼Œæ—¢æœ‰å•†ä¸šå®ç°ï¼Œä¹Ÿæœ‰å¼€æºå®ç°ã€‚æœ¬æ–‡é’ˆå¯¹çš„å®ç°æ˜¯<a href="https://www.openssh.com/" target="_blank" rel="noopener">OpenSSH</a>ï¼Œå®ƒæ˜¯è‡ªç”±è½¯ä»¶ï¼Œåº”ç”¨éå¸¸å¹¿æ³›ã€‚</p><p>æ­¤å¤–ï¼Œæœ¬æ–‡åªè®¨è®ºSSHåœ¨Linux Shellä¸­çš„ç”¨æ³•ã€‚å¦‚æœè¦åœ¨Windowsç³»ç»Ÿä¸­ä½¿ç”¨SSHï¼Œä¼šç”¨åˆ°å¦ä¸€ç§è½¯ä»¶<a href="http://www.chiark.greenend.org.uk/~sgtatham/putty" target="_blank" rel="noopener">PuTTY</a>ï¼Œè¿™éœ€è¦å¦æ–‡ä»‹ç»ã€‚</p><h3 id="äºŒã€æœ€åŸºæœ¬çš„ç”¨æ³•"><a href="#äºŒã€æœ€åŸºæœ¬çš„ç”¨æ³•" class="headerlink" title="äºŒã€æœ€åŸºæœ¬çš„ç”¨æ³•"></a><strong>äºŒã€æœ€åŸºæœ¬çš„ç”¨æ³•</strong></h3><p>SSHä¸»è¦ç”¨äºè¿œç¨‹ç™»å½•ã€‚å‡å®šä½ è¦ä»¥ç”¨æˆ·åuserï¼Œç™»å½•è¿œç¨‹ä¸»æœºhostï¼Œåªè¦ä¸€æ¡ç®€å•å‘½ä»¤å°±å¯ä»¥äº†ã€‚</p><blockquote><p>ã€€ã€€$ ssh user@host</p></blockquote><p>å¦‚æœæœ¬åœ°ç”¨æˆ·åä¸è¿œç¨‹ç”¨æˆ·åä¸€è‡´ï¼Œç™»å½•æ—¶å¯ä»¥çœç•¥ç”¨æˆ·åã€‚</p><blockquote><p>ã€€ã€€$ ssh host</p></blockquote><p>SSHçš„é»˜è®¤ç«¯å£æ˜¯22ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä½ çš„ç™»å½•è¯·æ±‚ä¼šé€è¿›è¿œç¨‹ä¸»æœºçš„22ç«¯å£ã€‚ä½¿ç”¨på‚æ•°ï¼Œå¯ä»¥ä¿®æ”¹è¿™ä¸ªç«¯å£ã€‚</p><blockquote><p>ã€€ã€€$ ssh -p 2222 user@host</p></blockquote><p>ä¸Šé¢è¿™æ¡å‘½ä»¤è¡¨ç¤ºï¼Œsshç›´æ¥è¿æ¥è¿œç¨‹ä¸»æœºçš„2222ç«¯å£ã€‚</p><h2 id="è¿æ¥åˆ°æœåŠ¡å™¨"><a href="#è¿æ¥åˆ°æœåŠ¡å™¨" class="headerlink" title="è¿æ¥åˆ°æœåŠ¡å™¨"></a>è¿æ¥åˆ°æœåŠ¡å™¨</h2><pre class="line-numbers language-shell"><code class="language-shell">ssh 43004 ssh lry@192.168.0.75 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä½†æ˜¯ä¸€èˆ¬æ¥è¯´ä¸ºäº†å®‰å…¨èµ·è§ï¼Œç«¯å£å·ç­‰ä¸€äº›å‚æ•°å¹¶ä¸ä¼šä½¿ç”¨é»˜è®¤å€¼ã€‚è¿™æ ·çš„è¯å‘½ä»¤å°±å˜æˆè¿™æ ·ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">ssh ç”¨æˆ·å@IPåœ°å€ -p ç«¯å£å·<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="å¯†é’¥ç™»å½•-å…å¯†ç "><a href="#å¯†é’¥ç™»å½•-å…å¯†ç " class="headerlink" title="å¯†é’¥ç™»å½•(å…å¯†ç )"></a>å¯†é’¥ç™»å½•(å…å¯†ç )</h2><p>æ¯æ¬¡ç™»å½•SHéƒ½éœ€è¦è¾“å…¥å¯†ç å¾ˆéº»çƒ¦ï¼Œè€Œä¸”å¯èƒ½ä¸å¤ªå®‰å…¨ã€‚SSHè¿˜èƒ½ä½¿ç”¨å¦å¤–ä¸€ç§ç™»å½•æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨å¯†é’¥ç™»å½•ã€‚è¿™ç§ç™»å½•æ–¹å¼éœ€è¦å®¢æˆ·ç«¯ç”Ÿæˆä¸€å †å…¬é’¥ç§é’¥å¯¹ï¼Œç„¶åå°†å…¬é’¥æ·»åŠ åˆ°æœåŠ¡å™¨ä¸­ï¼Œè¿™æ ·ä¸‹æ¬¡å°±å¯ä»¥ç›´æ¥ç™»å½•äº†ã€‚</p><p>é¦–å…ˆç”ŸæˆSSHå¯†é’¥ï¼Œä¾ç…§æç¤ºè¾“å…¥ä¿¡æ¯å³å¯ã€‚é»˜è®¤ç”Ÿæˆåœ¨ç”¨æˆ·ä¸»ç›®å½•ä¸­çš„.sshæ–‡ä»¶å¤¹ä¸­ã€‚å¸¦pubçš„æ˜¯å…¬é’¥ï¼Œæ¥ä¸‹æ¥éœ€è¦æ·»åŠ åˆ°æœåŠ¡å™¨ä¸­ã€‚</p><pre class="line-numbers language-shell"><code class="language-shell">ssh-keygen<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åå°†æœ¬åœ°å…¬é’¥æ·»åŠ åˆ°æœåŠ¡å™¨ä¸­ï¼Œéœ€è¦ä½¿ç”¨å¦ä¸€ä¸ªå‘½ä»¤ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">scp -P ç«¯å£å· æœ¬åœ°æ–‡ä»¶è·¯å¾„ ç”¨æˆ·å@è¿œç¨‹æœåŠ¡å™¨åœ°å€:è¿œç¨‹è·¯å¾„<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åç™»é™†æœåŠ¡å™¨ï¼Œæ‰¾åˆ°å¤åˆ¶è¿›å»çš„å…¬é’¥ï¼Œå°†å…¬é’¥åå­—æ”¹ä¸ºauthorized_keyså¹¶æ·»åŠ åˆ°å¯¹åº”çš„.sshæ–‡ä»¶å¤¹ä¸­ã€‚ç„¶åé€€å‡ºSSHé‡æ–°ç™»é™†è¯•è¯•ï¼ŒæˆåŠŸçš„è¯ä¸éœ€è¦è¾“å…¥å¯†ç å°±ä¼šç›´æ¥è¿›å…¥è¿œç¨‹æœåŠ¡å™¨ã€‚</p><h2 id="Linux-ç³»ç»Ÿç›®å½•ç»“æ„"><a href="#Linux-ç³»ç»Ÿç›®å½•ç»“æ„" class="headerlink" title="Linux ç³»ç»Ÿç›®å½•ç»“æ„"></a>Linux ç³»ç»Ÿç›®å½•ç»“æ„</h2><blockquote><p>é€‰è‡ªèœé¸Ÿæ•™ç¨‹ï¼š<a href="https://www.runoob.com/linux/linux-system-contents.html" target="_blank" rel="noopener">https://www.runoob.com/linux/linux-system-contents.html</a></p></blockquote><p>ç™»é™†ç³»ç»Ÿåè¾“å…¥å‘½ä»¤ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">ls \<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½ ä¼šçœ‹åˆ°å¦‚ä¸‹å›¾æ‰€ç¤º:</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.runoob.com/wp-content/uploads/2014/06/4_20.png" alt="files"></p><p>æ ‘çŠ¶ç›®å½•ç»“æ„ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.runoob.com/wp-content/uploads/2014/06/d0c50-linux2bfile2bsystem2bhierarchy.jpg" alt="structure"></p><p>ä»¥ä¸‹æ˜¯å¯¹è¿™äº›ç›®å½•çš„è§£é‡Šï¼š</p><ul><li><p><strong>/bin</strong>ï¼š<br>bin æ˜¯ Binaries (äºŒè¿›åˆ¶æ–‡ä»¶) çš„ç¼©å†™, è¿™ä¸ªç›®å½•å­˜æ”¾ç€æœ€ç»å¸¸ä½¿ç”¨çš„å‘½ä»¤ã€‚</p></li><li><p><strong>/bootï¼š</strong><br>è¿™é‡Œå­˜æ”¾çš„æ˜¯å¯åŠ¨ Linux æ—¶ä½¿ç”¨çš„ä¸€äº›æ ¸å¿ƒæ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸€äº›è¿æ¥æ–‡ä»¶ä»¥åŠé•œåƒæ–‡ä»¶ã€‚</p></li><li><p><strong>/dev ï¼š</strong><br>dev æ˜¯ Device(è®¾å¤‡) çš„ç¼©å†™, è¯¥ç›®å½•ä¸‹å­˜æ”¾çš„æ˜¯ Linux çš„å¤–éƒ¨è®¾å¤‡ï¼Œåœ¨ Linux ä¸­è®¿é—®è®¾å¤‡çš„æ–¹å¼å’Œè®¿é—®æ–‡ä»¶çš„æ–¹å¼æ˜¯ç›¸åŒçš„ã€‚</p></li><li><p><strong>/etcï¼š</strong><br>etc æ˜¯ Etcetera(ç­‰ç­‰) çš„ç¼©å†™,è¿™ä¸ªç›®å½•ç”¨æ¥å­˜æ”¾æ‰€æœ‰çš„ç³»ç»Ÿç®¡ç†æ‰€éœ€è¦çš„é…ç½®æ–‡ä»¶å’Œå­ç›®å½•ã€‚</p></li><li><p><strong>/home</strong>ï¼š<br>ç”¨æˆ·çš„ä¸»ç›®å½•ï¼Œåœ¨ Linux ä¸­ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„ç›®å½•ï¼Œä¸€èˆ¬è¯¥ç›®å½•åæ˜¯ä»¥ç”¨æˆ·çš„è´¦å·å‘½åçš„ï¼Œå¦‚ä¸Šå›¾ä¸­çš„ aliceã€bob å’Œ eveã€‚</p></li><li><p><strong>/lib</strong>ï¼š<br>lib æ˜¯ Library(åº“) çš„ç¼©å†™è¿™ä¸ªç›®å½•é‡Œå­˜æ”¾ç€ç³»ç»Ÿæœ€åŸºæœ¬çš„åŠ¨æ€è¿æ¥å…±äº«åº“ï¼Œå…¶ä½œç”¨ç±»ä¼¼äº Windows é‡Œçš„ DLL æ–‡ä»¶ã€‚å‡ ä¹æ‰€æœ‰çš„åº”ç”¨ç¨‹åºéƒ½éœ€è¦ç”¨åˆ°è¿™äº›å…±äº«åº“ã€‚</p></li><li><p><strong>/lost+found</strong>ï¼š<br>è¿™ä¸ªç›®å½•ä¸€èˆ¬æƒ…å†µä¸‹æ˜¯ç©ºçš„ï¼Œå½“ç³»ç»Ÿéæ³•å…³æœºåï¼Œè¿™é‡Œå°±å­˜æ”¾äº†ä¸€äº›æ–‡ä»¶ã€‚</p></li><li><p><strong>/media</strong>ï¼š<br>linux ç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«ä¸€äº›è®¾å¤‡ï¼Œä¾‹å¦‚Uç›˜ã€å…‰é©±ç­‰ç­‰ï¼Œå½“è¯†åˆ«åï¼ŒLinux ä¼šæŠŠè¯†åˆ«çš„è®¾å¤‡æŒ‚è½½åˆ°è¿™ä¸ªç›®å½•ä¸‹ã€‚</p></li><li><p><strong>/mnt</strong>ï¼š<br>ç³»ç»Ÿæä¾›è¯¥ç›®å½•æ˜¯ä¸ºäº†è®©ç”¨æˆ·ä¸´æ—¶æŒ‚è½½åˆ«çš„æ–‡ä»¶ç³»ç»Ÿçš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…‰é©±æŒ‚è½½åœ¨ /mnt/ ä¸Šï¼Œç„¶åè¿›å…¥è¯¥ç›®å½•å°±å¯ä»¥æŸ¥çœ‹å…‰é©±é‡Œçš„å†…å®¹äº†ã€‚</p></li><li><p><strong>/opt</strong>ï¼š<br>opt æ˜¯ optional(å¯é€‰) çš„ç¼©å†™ï¼Œè¿™æ˜¯ç»™ä¸»æœºé¢å¤–å®‰è£…è½¯ä»¶æ‰€æ‘†æ”¾çš„ç›®å½•ã€‚æ¯”å¦‚ä½ å®‰è£…ä¸€ä¸ªORACLEæ•°æ®åº“åˆ™å°±å¯ä»¥æ”¾åˆ°è¿™ä¸ªç›®å½•ä¸‹ã€‚é»˜è®¤æ˜¯ç©ºçš„ã€‚</p></li><li><p><strong>/proc</strong>ï¼š<br>proc æ˜¯ Processes(è¿›ç¨‹) çš„ç¼©å†™ï¼Œ/proc æ˜¯ä¸€ç§ä¼ªæ–‡ä»¶ç³»ç»Ÿï¼ˆä¹Ÿå³è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼‰ï¼Œå­˜å‚¨çš„æ˜¯å½“å‰å†…æ ¸è¿è¡ŒçŠ¶æ€çš„ä¸€ç³»åˆ—ç‰¹æ®Šæ–‡ä»¶ï¼Œè¿™ä¸ªç›®å½•æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„ç›®å½•ï¼Œå®ƒæ˜¯ç³»ç»Ÿå†…å­˜çš„æ˜ å°„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç›´æ¥è®¿é—®è¿™ä¸ªç›®å½•æ¥è·å–ç³»ç»Ÿä¿¡æ¯ã€‚<br>è¿™ä¸ªç›®å½•çš„å†…å®¹ä¸åœ¨ç¡¬ç›˜ä¸Šè€Œæ˜¯åœ¨å†…å­˜é‡Œï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹é‡Œé¢çš„æŸäº›æ–‡ä»¶ï¼Œæ¯”å¦‚å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æ¥å±è”½ä¸»æœºçš„pingå‘½ä»¤ï¼Œä½¿åˆ«äººæ— æ³•pingä½ çš„æœºå™¨ï¼š</p><pre><code>echo 1 &gt; /proc/sys/net/ipv4/icmp_echo_ignore_all</code></pre></li><li><p><strong>/root</strong>ï¼š<br>è¯¥ç›®å½•ä¸ºç³»ç»Ÿç®¡ç†å‘˜ï¼Œä¹Ÿç§°ä½œè¶…çº§æƒé™è€…çš„ç”¨æˆ·ä¸»ç›®å½•ã€‚</p></li><li><p><strong>/sbin</strong>ï¼š<br>s å°±æ˜¯ Super User çš„æ„æ€ï¼Œæ˜¯ Superuser Binaries (è¶…çº§ç”¨æˆ·çš„äºŒè¿›åˆ¶æ–‡ä»¶) çš„ç¼©å†™ï¼Œè¿™é‡Œå­˜æ”¾çš„æ˜¯ç³»ç»Ÿç®¡ç†å‘˜ä½¿ç”¨çš„ç³»ç»Ÿç®¡ç†ç¨‹åºã€‚</p></li><li><p><strong>/selinux</strong>ï¼š<br> è¿™ä¸ªç›®å½•æ˜¯ Redhat/CentOS æ‰€ç‰¹æœ‰çš„ç›®å½•ï¼ŒSelinux æ˜¯ä¸€ä¸ªå®‰å…¨æœºåˆ¶ï¼Œç±»ä¼¼äº windows çš„é˜²ç«å¢™ï¼Œä½†æ˜¯è¿™å¥—æœºåˆ¶æ¯”è¾ƒå¤æ‚ï¼Œè¿™ä¸ªç›®å½•å°±æ˜¯å­˜æ”¾selinuxç›¸å…³çš„æ–‡ä»¶çš„ã€‚</p></li><li><p><strong>/srv</strong>ï¼š<br> è¯¥ç›®å½•å­˜æ”¾ä¸€äº›æœåŠ¡å¯åŠ¨ä¹‹åéœ€è¦æå–çš„æ•°æ®ã€‚</p></li><li><p><strong>/sys</strong>ï¼š</p><p>è¿™æ˜¯ Linux2.6 å†…æ ¸çš„ä¸€ä¸ªå¾ˆå¤§çš„å˜åŒ–ã€‚è¯¥ç›®å½•ä¸‹å®‰è£…äº† 2.6 å†…æ ¸ä¸­æ–°å‡ºç°çš„ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ sysfs ã€‚</p><p>sysfs æ–‡ä»¶ç³»ç»Ÿé›†æˆäº†ä¸‹é¢3ç§æ–‡ä»¶ç³»ç»Ÿçš„ä¿¡æ¯ï¼šé’ˆå¯¹è¿›ç¨‹ä¿¡æ¯çš„ proc æ–‡ä»¶ç³»ç»Ÿã€é’ˆå¯¹è®¾å¤‡çš„ devfs æ–‡ä»¶ç³»ç»Ÿä»¥åŠé’ˆå¯¹ä¼ªç»ˆç«¯çš„ devpts æ–‡ä»¶ç³»ç»Ÿã€‚</p><p>è¯¥æ–‡ä»¶ç³»ç»Ÿæ˜¯å†…æ ¸è®¾å¤‡æ ‘çš„ä¸€ä¸ªç›´è§‚åæ˜ ã€‚</p><p>å½“ä¸€ä¸ªå†…æ ¸å¯¹è±¡è¢«åˆ›å»ºçš„æ—¶å€™ï¼Œå¯¹åº”çš„æ–‡ä»¶å’Œç›®å½•ä¹Ÿåœ¨å†…æ ¸å¯¹è±¡å­ç³»ç»Ÿä¸­è¢«åˆ›å»ºã€‚</p></li><li><p><strong>/tmp</strong>ï¼š<br>tmp æ˜¯ temporary(ä¸´æ—¶) çš„ç¼©å†™è¿™ä¸ªç›®å½•æ˜¯ç”¨æ¥å­˜æ”¾ä¸€äº›ä¸´æ—¶æ–‡ä»¶çš„ã€‚</p></li><li><p><strong>/usr</strong>ï¼š<br> usr æ˜¯ unix shared resources(å…±äº«èµ„æº) çš„ç¼©å†™ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç›®å½•ï¼Œç”¨æˆ·çš„å¾ˆå¤šåº”ç”¨ç¨‹åºå’Œæ–‡ä»¶éƒ½æ”¾åœ¨è¿™ä¸ªç›®å½•ä¸‹ï¼Œç±»ä¼¼äº windows ä¸‹çš„ program files ç›®å½•ã€‚</p></li><li><p><strong>/usr/binï¼š</strong><br>ç³»ç»Ÿç”¨æˆ·ä½¿ç”¨çš„åº”ç”¨ç¨‹åºã€‚</p></li><li><p><strong>/usr/sbinï¼š</strong><br>è¶…çº§ç”¨æˆ·ä½¿ç”¨çš„æ¯”è¾ƒé«˜çº§çš„ç®¡ç†ç¨‹åºå’Œç³»ç»Ÿå®ˆæŠ¤ç¨‹åºã€‚</p></li><li><p><strong>/usr/srcï¼š</strong><br>å†…æ ¸æºä»£ç é»˜è®¤çš„æ”¾ç½®ç›®å½•ã€‚</p></li><li><p><strong>/var</strong>ï¼š<br>var æ˜¯ variable(å˜é‡) çš„ç¼©å†™ï¼Œè¿™ä¸ªç›®å½•ä¸­å­˜æ”¾ç€åœ¨ä¸æ–­æ‰©å……ç€çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬ä¹ æƒ¯å°†é‚£äº›ç»å¸¸è¢«ä¿®æ”¹çš„ç›®å½•æ”¾åœ¨è¿™ä¸ªç›®å½•ä¸‹ã€‚åŒ…æ‹¬å„ç§æ—¥å¿—æ–‡ä»¶ã€‚</p></li><li><p><strong>/run</strong>ï¼š<br>æ˜¯ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿï¼Œå­˜å‚¨ç³»ç»Ÿå¯åŠ¨ä»¥æ¥çš„ä¿¡æ¯ã€‚å½“ç³»ç»Ÿé‡å¯æ—¶ï¼Œè¿™ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶åº”è¯¥è¢«åˆ æ‰æˆ–æ¸…é™¤ã€‚å¦‚æœä½ çš„ç³»ç»Ÿä¸Šæœ‰ /var/run ç›®å½•ï¼Œåº”è¯¥è®©å®ƒæŒ‡å‘ runã€‚</p></li></ul><p>åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œæœ‰å‡ ä¸ªç›®å½•æ˜¯æ¯”è¾ƒé‡è¦çš„ï¼Œå¹³æ—¶éœ€è¦æ³¨æ„ä¸è¦è¯¯åˆ é™¤æˆ–è€…éšæ„æ›´æ”¹å†…éƒ¨æ–‡ä»¶ã€‚</p><p><strong>/etc</strong>ï¼š ä¸Šè¾¹ä¹Ÿæåˆ°äº†ï¼Œè¿™ä¸ªæ˜¯ç³»ç»Ÿä¸­çš„é…ç½®æ–‡ä»¶ï¼Œå¦‚æœä½ æ›´æ”¹äº†è¯¥ç›®å½•ä¸‹çš„æŸä¸ªæ–‡ä»¶å¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿä¸èƒ½å¯åŠ¨ã€‚</p><p><strong>/bin, /sbin, /usr/bin, /usr/sbin</strong>: è¿™æ˜¯ç³»ç»Ÿé¢„è®¾çš„æ‰§è¡Œæ–‡ä»¶çš„æ”¾ç½®ç›®å½•ï¼Œæ¯”å¦‚ ls å°±æ˜¯åœ¨ /bin/ls ç›®å½•ä¸‹çš„ã€‚</p><p>å€¼å¾—æå‡ºçš„æ˜¯ï¼Œ/bin, /usr/bin æ˜¯ç»™ç³»ç»Ÿç”¨æˆ·ä½¿ç”¨çš„æŒ‡ä»¤ï¼ˆé™¤rootå¤–çš„é€šç”¨æˆ·ï¼‰ï¼Œè€Œ/sbin, /usr/sbin åˆ™æ˜¯ç»™ root ä½¿ç”¨çš„æŒ‡ä»¤ã€‚</p><p><strong>/var</strong>ï¼š è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç›®å½•ï¼Œç³»ç»Ÿä¸Šè·‘äº†å¾ˆå¤šç¨‹åºï¼Œé‚£ä¹ˆæ¯ä¸ªç¨‹åºéƒ½ä¼šæœ‰ç›¸åº”çš„æ—¥å¿—äº§ç”Ÿï¼Œè€Œè¿™äº›æ—¥å¿—å°±è¢«è®°å½•åˆ°è¿™ä¸ªç›®å½•ä¸‹ï¼Œå…·ä½“åœ¨ /var/log ç›®å½•ä¸‹ï¼Œå¦å¤– mail çš„é¢„è®¾æ”¾ç½®ä¹Ÿæ˜¯åœ¨è¿™é‡Œã€‚</p><h2 id="What-is-shell"><a href="#What-is-shell" class="headerlink" title="What is shell?"></a>What is shell?</h2><blockquote><p>è¯¥ç« èŠ‚å‡ ä¹æ‰€æœ‰å†…å®¹æ¥è‡ªäº<a href="https://missing-semester-cn.github.io/2020/course-shell/" target="_blank" rel="noopener">https://missing-semester-cn.github.io/2020/course-shell/</a></p></blockquote><p>å¦‚ä»Šçš„è®¡ç®—æœºæœ‰ç€å¤šç§å¤šæ ·çš„äº¤äº’æ¥å£è®©æˆ‘ä»¬å¯ä»¥è¿›è¡ŒæŒ‡ä»¤çš„çš„è¾“å…¥ï¼Œä»ç‚«é…·çš„å›¾åƒç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰ï¼Œè¯­éŸ³è¾“å…¥ç”šè‡³æ˜¯ AR/VR éƒ½å·²ç»æ— å¤„ä¸åœ¨ã€‚ è¿™äº›äº¤äº’æ¥å£å¯ä»¥è¦†ç›– 80% çš„ä½¿ç”¨åœºæ™¯ï¼Œä½†æ˜¯å®ƒä»¬ä¹Ÿä»æ ¹æœ¬ä¸Šé™åˆ¶äº†æ‚¨çš„æ“ä½œæ–¹å¼â€”â€”ä½ ä¸èƒ½ç‚¹å‡»ä¸€ä¸ªä¸å­˜åœ¨çš„æŒ‰é’®æˆ–è€…æ˜¯ç”¨è¯­éŸ³è¾“å…¥ä¸€ä¸ªè¿˜æ²¡æœ‰è¢«å½•å…¥çš„æŒ‡ä»¤ã€‚ ä¸ºäº†å……åˆ†åˆ©ç”¨è®¡ç®—æœºçš„èƒ½åŠ›ï¼Œæˆ‘ä»¬ä¸å¾—ä¸å›åˆ°æœ€æ ¹æœ¬çš„æ–¹å¼ï¼Œä½¿ç”¨æ–‡å­—æ¥å£ï¼šShell</p><p>å‡ ä¹æ‰€æœ‰æ‚¨èƒ½å¤Ÿæ¥è§¦åˆ°çš„å¹³å°éƒ½æ”¯æŒæŸç§å½¢å¼çš„ shellï¼Œæœ‰äº›ç”šè‡³è¿˜æä¾›äº†å¤šç§ shell ä¾›æ‚¨é€‰æ‹©ã€‚è™½ç„¶å®ƒä»¬ä¹‹é—´æœ‰äº›ç»†èŠ‚ä¸Šçš„å·®å¼‚ï¼Œä½†æ˜¯å…¶æ ¸å¿ƒåŠŸèƒ½éƒ½æ˜¯ä¸€æ ·çš„ï¼šå®ƒå…è®¸ä½ æ‰§è¡Œç¨‹åºï¼Œè¾“å…¥å¹¶è·å–æŸç§åŠç»“æ„åŒ–çš„è¾“å‡ºã€‚</p><p>æœ¬æ¬¡æˆ‘ä»¬ä¼šä½¿ç”¨ Bourne Again SHell, ç®€ç§° â€œbashâ€ ã€‚ è¿™æ˜¯è¢«æœ€å¹¿æ³›ä½¿ç”¨çš„ä¸€ç§ shellï¼Œå®ƒçš„è¯­æ³•å’Œå…¶ä»–çš„ shell éƒ½æ˜¯ç±»ä¼¼çš„ã€‚æ‰“å¼€shell <em>æç¤ºç¬¦*ï¼ˆæ‚¨è¾“å…¥æŒ‡ä»¤çš„åœ°æ–¹ï¼‰ï¼Œæ‚¨é¦–å…ˆéœ€è¦æ‰“å¼€ *ç»ˆç«¯</em> ã€‚æ‚¨çš„è®¾å¤‡é€šå¸¸éƒ½å·²ç»å†…ç½®äº†ç»ˆç«¯ï¼Œæˆ–è€…æ‚¨ä¹Ÿå¯ä»¥å®‰è£…ä¸€ä¸ªï¼Œéå¸¸ç®€å•ã€‚</p><p>shellçš„åŠŸèƒ½æ›´åŠ å¼ºå¤§ï¼Œç›¸æ¯”äºæˆ‘ä»¬çš„GUIç¨‹åºæ¥è¯´ã€‚å¹¶ä¸”æˆ‘ä»¬å¯ä»¥å®‰è£…æ–°çš„ç»ˆç«¯ï¼Œæ¯”å¦‚è¯´ç›®å‰æˆ‘ç”¨çš„å°±æ˜¯gitçš„bash, å½“ç„¶ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ä½¿ç”¨åˆ«çš„å¦‚power shellã€cmdç­‰ç­‰ã€‚æˆ–è€…windows terminalè¿™ç§ã€‚</p><h3 id="ä½¿ç”¨-shell"><a href="#ä½¿ç”¨-shell" class="headerlink" title="ä½¿ç”¨ shell"></a>ä½¿ç”¨ shell</h3><p>å½“æ‚¨æ‰“å¼€ç»ˆç«¯æ—¶ï¼Œæ‚¨ä¼šçœ‹åˆ°ä¸€ä¸ªæç¤ºç¬¦ï¼Œå®ƒçœ‹èµ·æ¥ä¸€èˆ¬æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š</p><pre><code>missing:~$ </code></pre><p>è¿™æ˜¯ shell æœ€ä¸»è¦çš„æ–‡æœ¬æ¥å£ã€‚å®ƒå‘Šè¯‰ä½ ï¼Œä½ çš„ä¸»æœºåæ˜¯ <code>missing</code> å¹¶ä¸”æ‚¨å½“å‰çš„å·¥ä½œç›®å½•ï¼ˆâ€current working directoryâ€ï¼‰æˆ–è€…è¯´æ‚¨å½“å‰æ‰€åœ¨çš„ä½ç½®æ˜¯ <code>~</code> (è¡¨ç¤º â€œhomeâ€)ã€‚ <code>$</code> ç¬¦å·è¡¨ç¤ºæ‚¨ç°åœ¨çš„èº«ä»½ä¸æ˜¯ root ç”¨æˆ·ï¼ˆç¨åä¼šä»‹ç»ï¼‰ã€‚åœ¨è¿™ä¸ªæç¤ºç¬¦ä¸­ï¼Œæ‚¨å¯ä»¥è¾“å…¥ <em>å‘½ä»¤</em> ï¼Œå‘½ä»¤æœ€ç»ˆä¼šè¢« shell è§£æã€‚æœ€ç®€å•çš„å‘½ä»¤æ˜¯æ‰§è¡Œä¸€ä¸ªç¨‹åºï¼š</p><pre><code>missing:~$ dateFri 10 Jan 2020 11:49:31 AM ESTmissing:~$ </code></pre><p>è¿™é‡Œï¼Œæˆ‘ä»¬æ‰§è¡Œäº† <code>date</code> è¿™ä¸ªç¨‹åºï¼Œä¸å‡ºæ„æ–™åœ°ï¼Œå®ƒæ‰“å°å‡ºäº†å½“å‰çš„æ—¥å‰å’Œæ—¶é—´ã€‚ç„¶åï¼Œshell ç­‰å¾…æˆ‘ä»¬è¾“å…¥å…¶ä»–å‘½ä»¤ã€‚æˆ‘ä»¬å¯ä»¥åœ¨æ‰§è¡Œå‘½ä»¤çš„åŒæ—¶å‘ç¨‹åºä¼ é€’ <em>å‚æ•°</em> ï¼š</p><pre><code>missing:~$ echo hellohello</code></pre><p>ä¸Šä¾‹ä¸­ï¼Œæˆ‘ä»¬è®© shell æ‰§è¡Œ <code>echo</code> ï¼ŒåŒæ—¶æŒ‡å®šå‚æ•° <code>hello</code>ã€‚<code>echo</code> ç¨‹åºå°†è¯¥å‚æ•°æ‰“å°å‡ºæ¥ã€‚ shell åŸºäºç©ºæ ¼åˆ†å‰²å‘½ä»¤å¹¶è¿›è¡Œè§£æï¼Œç„¶åæ‰§è¡Œç¬¬ä¸€ä¸ªå•è¯ä»£è¡¨çš„ç¨‹åºï¼Œå¹¶å°†åç»­çš„å•è¯ä½œä¸ºç¨‹åºå¯ä»¥è®¿é—®çš„å‚æ•°ã€‚å¦‚æœæ‚¨å¸Œæœ›ä¼ é€’çš„å‚æ•°ä¸­åŒ…å«ç©ºæ ¼ï¼ˆä¾‹å¦‚ä¸€ä¸ªåä¸º My Photos çš„æ–‡ä»¶å¤¹ï¼‰ï¼Œæ‚¨è¦ä¹ˆç”¨ä½¿ç”¨å•å¼•å·ï¼ŒåŒå¼•å·å°†å…¶åŒ…è£¹èµ·æ¥ï¼Œè¦ä¹ˆä½¿ç”¨è½¬ä¹‰ç¬¦å· <code>\</code> è¿›è¡Œå¤„ç†ï¼ˆ<code>My\ Photos</code>ï¼‰ã€‚</p><p>ä½†æ˜¯ï¼Œshell æ˜¯å¦‚ä½•çŸ¥é“å»å“ªé‡Œå¯»æ‰¾ <code>date</code> æˆ– <code>echo</code> çš„å‘¢ï¼Ÿå…¶å®ï¼Œç±»ä¼¼äº Python æˆ– Rubyï¼Œshell æ˜¯ä¸€ä¸ªç¼–ç¨‹ç¯å¢ƒï¼Œæ‰€ä»¥å®ƒå…·å¤‡å˜é‡ã€æ¡ä»¶ã€å¾ªç¯å’Œå‡½æ•°ï¼ˆä¸‹ä¸€è¯¾è¿›è¡Œè®²è§£ï¼‰ã€‚å½“ä½ åœ¨ shell ä¸­æ‰§è¡Œå‘½ä»¤æ—¶ï¼Œæ‚¨å®é™…ä¸Šæ˜¯åœ¨æ‰§è¡Œä¸€æ®µ shell å¯ä»¥è§£é‡Šæ‰§è¡Œçš„ç®€çŸ­ä»£ç ã€‚å¦‚æœä½ è¦æ±‚ shell æ‰§è¡ŒæŸä¸ªæŒ‡ä»¤ï¼Œä½†æ˜¯è¯¥æŒ‡ä»¤å¹¶ä¸æ˜¯ shell æ‰€äº†è§£çš„ç¼–ç¨‹å…³é”®å­—ï¼Œé‚£ä¹ˆå®ƒä¼šå»å’¨è¯¢ <em>ç¯å¢ƒå˜é‡</em> <code>$PATH</code>ï¼Œå®ƒä¼šåˆ—å‡ºå½“ shell æ¥åˆ°æŸæ¡æŒ‡ä»¤æ—¶ï¼Œè¿›è¡Œç¨‹åºæœç´¢çš„è·¯å¾„ï¼š</p><pre><code>missing:~$ echo $PATH/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/binmissing:~$ which echo/bin/echomissing:~$ /bin/echo $PATH/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</code></pre><p>å½“æˆ‘ä»¬æ‰§è¡Œ <code>echo</code> å‘½ä»¤æ—¶ï¼Œshell äº†è§£åˆ°éœ€è¦æ‰§è¡Œ <code>echo</code> è¿™ä¸ªç¨‹åºï¼Œéšåå®ƒä¾¿ä¼šåœ¨ <code>$PATH</code> ä¸­æœç´¢ç”± <code>:</code> æ‰€åˆ†å‰²çš„ä¸€ç³»åˆ—ç›®å½•ï¼ŒåŸºäºåå­—æœç´¢è¯¥ç¨‹åºã€‚å½“æ‰¾åˆ°è¯¥ç¨‹åºæ—¶ä¾¿æ‰§è¡Œï¼ˆå‡å®šè¯¥æ–‡ä»¶æ˜¯ <em>å¯æ‰§è¡Œç¨‹åº</em>ï¼Œåç»­è¯¾ç¨‹å°†è¯¦ç»†è®²è§£ï¼‰ã€‚ç¡®å®šæŸä¸ªç¨‹åºåä»£è¡¨çš„æ˜¯å“ªä¸ªå…·ä½“çš„ç¨‹åºï¼Œå¯ä»¥ä½¿ç”¨ <code>which</code> ç¨‹åºã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç»•è¿‡ <code>$PATH</code>ï¼Œé€šè¿‡ç›´æ¥æŒ‡å®šéœ€è¦æ‰§è¡Œçš„ç¨‹åºçš„è·¯å¾„æ¥æ‰§è¡Œè¯¥ç¨‹åº</p><h3 id="åœ¨shellä¸­å¯¼èˆª"><a href="#åœ¨shellä¸­å¯¼èˆª" class="headerlink" title="åœ¨shellä¸­å¯¼èˆª"></a>åœ¨shellä¸­å¯¼èˆª</h3><p>shell ä¸­çš„è·¯å¾„æ˜¯ä¸€ç»„è¢«åˆ†å‰²çš„ç›®å½•ï¼Œåœ¨ Linux å’Œ macOS ä¸Šä½¿ç”¨ <code>/</code> åˆ†å‰²ï¼Œè€Œåœ¨Windowsä¸Šæ˜¯ <code>\</code>ã€‚è·¯å¾„ <code>/</code> ä»£è¡¨çš„æ˜¯ç³»ç»Ÿçš„æ ¹ç›®å½•ï¼Œæ‰€æœ‰çš„æ–‡ä»¶å¤¹éƒ½åŒ…æ‹¬åœ¨è¿™ä¸ªè·¯å¾„ä¹‹ä¸‹ï¼Œåœ¨Windowsä¸Šæ¯ä¸ªç›˜éƒ½æœ‰ä¸€ä¸ªæ ¹ç›®å½•ï¼ˆä¾‹å¦‚ï¼š <code>C:\</code>ï¼‰ã€‚ æˆ‘ä»¬å‡è®¾æ‚¨åœ¨å­¦ä¹ æœ¬è¯¾ç¨‹æ—¶ä½¿ç”¨çš„æ˜¯ Linux æ–‡ä»¶ç³»ç»Ÿã€‚å¦‚æœæŸä¸ªè·¯å¾„ä»¥ <code>/</code> å¼€å¤´ï¼Œé‚£ä¹ˆå®ƒæ˜¯ä¸€ä¸ª <em>ç»å¯¹è·¯å¾„*ï¼Œå…¶ä»–çš„éƒ½æ˜¯ *ç›¸å¯¹è·¯å¾„</em> ã€‚ç›¸å¯¹è·¯å¾„æ˜¯æŒ‡ç›¸å¯¹äºå½“å‰å·¥ä½œç›®å½•çš„è·¯å¾„ï¼Œå½“å‰å·¥ä½œç›®å½•å¯ä»¥ä½¿ç”¨ <code>pwd</code> å‘½ä»¤æ¥è·å–ã€‚æ­¤å¤–ï¼Œåˆ‡æ¢ç›®å½•éœ€è¦ä½¿ç”¨ <code>cd</code> å‘½ä»¤ã€‚åœ¨è·¯å¾„ä¸­ï¼Œ<code>.</code> è¡¨ç¤ºçš„æ˜¯å½“å‰ç›®å½•ï¼Œè€Œ <code>..</code> è¡¨ç¤ºä¸Šçº§ç›®å½•ï¼š</p><pre><code>missing:~$ pwd/home/missingmissing:~$ cd /homemissing:/home$ pwd/homemissing:/home$ cd ..missing:/$ pwd/missing:/$ cd ./homemissing:/home$ pwd/homemissing:/home$ cd missingmissing:~$ pwd/home/missingmissing:~$ ../../bin/echo hellohello</code></pre><p>æ³¨æ„ï¼Œshell ä¼šå®æ—¶æ˜¾ç¤ºå½“å‰çš„è·¯å¾„ä¿¡æ¯ã€‚æ‚¨å¯ä»¥é€šè¿‡é…ç½® shell æç¤ºç¬¦æ¥æ˜¾ç¤ºå„ç§æœ‰ç”¨çš„ä¿¡æ¯ï¼Œè¿™ä¸€å†…å®¹æˆ‘ä»¬ä¼šåœ¨åé¢çš„è¯¾ç¨‹ä¸­è¿›è¡Œè®¨è®ºã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œå½“æˆ‘ä»¬è¿è¡Œä¸€ä¸ªç¨‹åºæ—¶ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰æŒ‡å®šè·¯å¾„ï¼Œåˆ™è¯¥ç¨‹åºä¼šåœ¨å½“å‰ç›®å½•ä¸‹æ‰§è¡Œã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¸¸å¸¸ä¼šæœç´¢æ–‡ä»¶ï¼Œå¹¶åœ¨éœ€è¦æ—¶åˆ›å»ºæ–‡ä»¶ã€‚</p><p>ä¸ºäº†æŸ¥çœ‹æŒ‡å®šç›®å½•ä¸‹åŒ…å«å“ªäº›æ–‡ä»¶ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>ls</code> å‘½ä»¤ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">missing:~$ lsmissing:~$ cd ..missing:/home$ lsmissingmissing:/home$ cd ..missing:/$ lsbinbootdevetchome...<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é™¤éæˆ‘ä»¬åˆ©ç”¨ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šç›®å½•ï¼Œå¦åˆ™ <code>ls</code> ä¼šæ‰“å°å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚å¤§å¤šæ•°çš„å‘½ä»¤æ¥å—æ ‡è®°å’Œé€‰é¡¹ï¼ˆå¸¦æœ‰å€¼çš„æ ‡è®°ï¼‰ï¼Œå®ƒä»¬ä»¥ <code>-</code> å¼€å¤´ï¼Œå¹¶å¯ä»¥æ”¹å˜ç¨‹åºçš„è¡Œä¸ºã€‚é€šå¸¸ï¼Œåœ¨æ‰§è¡Œç¨‹åºæ—¶ä½¿ç”¨ <code>-h</code> æˆ– <code>--help</code> æ ‡è®°å¯ä»¥æ‰“å°å¸®åŠ©ä¿¡æ¯ï¼Œä»¥ä¾¿äº†è§£æœ‰å“ªäº›å¯ç”¨çš„æ ‡è®°æˆ–é€‰é¡¹ã€‚ä¾‹å¦‚ï¼Œ<code>ls --help</code> çš„è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">  -l                         use a long listing formatmissing:~$ ls -l /homedrwxr-xr-x 1 missing  users  4096 Jun 15  2019 missing<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-shell"><code class="language-shell">drwxr-xr-x 18 gpl  gpl  4096 9æœˆ  23 15:46 gpldrwxr-xr-x  6 gyf  gyf  4096 9æœˆ  21 19:29 gyfdrwxr-xr-x 18 jhy  jhy  4096 9æœˆ  20 15:27 jhydrwxr-xr-x  6 lj   lj   4096 5æœˆ  29 18:15 ljdrwxr-xr-x  6 lry  lry  4096 9æœˆ  24 21:38 lrydrwxr-xr-x 15 lza  lza  4096 9æœˆ  12 17:29 lzadrwxr-xr-x 32 user user 4096 7æœˆ  21 16:42 userdrwxr-xr-x 11 1004 1004 4096 5æœˆ  12 17:03 wqydrwxr-xr-x 11 xyf  xyf  4096 3æœˆ  17  2021 xyfdrwxr-xr-x  6 zn   zn   4096 8æœˆ  19 22:18 zndrwxr-xr-x 13 zwt  zwt  4096 9æœˆ  21 15:24 zwtdrwxr-xr-x 17 zxl  zxl  4096 9æœˆ   9 22:02 zxldrwxr-xr-x 32 zyh  1011 4096 7æœˆ  27 14:50 zyhdrwxr-xr-x  2 zzr  zzr  4096 5æœˆ   7 19:47 zzr<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªå‚æ•°å¯ä»¥æ‰“å°å‡ºæ›´åŠ è¯¦ç»†åœ°åˆ—å‡ºç›®å½•ä¸‹æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„ä¿¡æ¯ã€‚é¦–å…ˆï¼Œæœ¬è¡Œç¬¬ä¸€ä¸ªå­—ç¬¦ <code>d</code> è¡¨ç¤º <code>missing</code> æ˜¯ä¸€ä¸ªç›®å½•ã€‚ç„¶åæ¥ä¸‹æ¥çš„ä¹ä¸ªå­—ç¬¦ï¼Œæ¯ä¸‰ä¸ªå­—ç¬¦æ„æˆä¸€ç»„ã€‚ ï¼ˆ<code>rwx</code>ï¼‰. å®ƒä»¬åˆ†åˆ«ä»£è¡¨äº†æ–‡ä»¶æ‰€æœ‰è€…ï¼ˆ<code>missing</code>ï¼‰ï¼Œç”¨æˆ·ç»„ï¼ˆ<code>users</code>ï¼‰ ä»¥åŠå…¶ä»–æ‰€æœ‰äººå…·æœ‰çš„æƒé™ã€‚å…¶ä¸­ <code>-</code> è¡¨ç¤ºè¯¥ç”¨æˆ·ä¸å…·å¤‡ç›¸åº”çš„æƒé™ã€‚ä»ä¸Šé¢çš„ä¿¡æ¯æ¥çœ‹ï¼Œåªæœ‰æ–‡ä»¶æ‰€æœ‰è€…å¯ä»¥ä¿®æ”¹ï¼ˆ<code>w</code>ï¼‰ï¼Œ<code>missing</code> æ–‡ä»¶å¤¹ ï¼ˆä¾‹å¦‚ï¼Œæ·»åŠ æˆ–åˆ é™¤æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶ï¼‰ã€‚ä¸ºäº†è¿›å…¥æŸä¸ªæ–‡ä»¶å¤¹ï¼Œç”¨æˆ·éœ€è¦å…·å¤‡è¯¥æ–‡ä»¶å¤¹ä»¥åŠå…¶çˆ¶æ–‡ä»¶å¤¹çš„â€œæœç´¢â€æƒé™ï¼ˆä»¥â€œå¯æ‰§è¡Œâ€ï¼š<code>x</code>ï¼‰æƒé™è¡¨ç¤ºã€‚ä¸ºäº†åˆ—å‡ºå®ƒçš„åŒ…å«çš„å†…å®¹ï¼Œç”¨æˆ·å¿…é¡»å¯¹è¯¥æ–‡ä»¶å¤¹å…·å¤‡è¯»æƒé™ï¼ˆ<code>r</code>ï¼‰ã€‚å¯¹äºæ–‡ä»¶æ¥è¯´ï¼Œæƒé™çš„æ„ä¹‰ä¹Ÿæ˜¯ç±»ä¼¼çš„ã€‚æ³¨æ„ï¼Œ<code>/bin</code> ç›®å½•ä¸‹çš„ç¨‹åºåœ¨æœ€åä¸€ç»„ï¼Œå³è¡¨ç¤ºæ‰€æœ‰äººçš„ç”¨æˆ·ç»„ä¸­ï¼Œå‡åŒ…å« <code>x</code> æƒé™ï¼Œä¹Ÿå°±æ˜¯è¯´ä»»ä½•äººéƒ½å¯ä»¥æ‰§è¡Œè¿™äº›ç¨‹åºã€‚</p><p>åœ¨è¿™ä¸ªé˜¶æ®µï¼Œè¿˜æœ‰å‡ ä¸ªè¶æ‰‹çš„å‘½ä»¤æ˜¯æ‚¨éœ€è¦æŒæ¡çš„ï¼Œä¾‹å¦‚ <code>mv</code>ï¼ˆç”¨äºé‡å‘½åæˆ–ç§»åŠ¨æ–‡ä»¶ï¼‰ã€ <code>cp</code>ï¼ˆæ‹·è´æ–‡ä»¶ï¼‰ä»¥åŠ <code>mkdir</code>ï¼ˆæ–°å»ºæ–‡ä»¶å¤¹ï¼‰ã€‚</p><p>å¦‚æœæ‚¨æƒ³è¦çŸ¥é“å…³äºç¨‹åºå‚æ•°ã€è¾“å…¥è¾“å‡ºçš„ä¿¡æ¯ï¼Œäº¦æˆ–æ˜¯æƒ³è¦äº†è§£å®ƒä»¬çš„å·¥ä½œæ–¹å¼ï¼Œè¯·è¯•è¯• <code>man</code> è¿™ä¸ªç¨‹åºã€‚å®ƒä¼šæ¥å—ä¸€ä¸ªç¨‹åºåä½œä¸ºå‚æ•°ï¼Œç„¶åå°†å®ƒçš„æ–‡æ¡£ï¼ˆç”¨æˆ·æ‰‹å†Œï¼‰å±•ç°ç»™æ‚¨ã€‚æ³¨æ„ï¼Œä½¿ç”¨ <code>q</code> å¯ä»¥é€€å‡ºè¯¥ç¨‹åºã€‚</p><pre class="line-numbers language-shell"><code class="language-shell">missing:~$ man ls<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p><strong>synopsis</strong>:  n. a brief summary or general survey of something.    â€œa synopsis of the accidentâ€</p><p><strong>manual</strong>  :  1. adj. relating to or done with the hands. 2. a book of instructions, especially for operating a machine or learning a subject; a handbook.</p></blockquote><p> <a href="https://imgtu.com/i/4DLfD1" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/09/24/4DLfD1.md.png" alt="result of man ls"></a></p><h3 id="åœ¨ç¨‹åºé—´åˆ›å»ºè¿æ¥"><a href="#åœ¨ç¨‹åºé—´åˆ›å»ºè¿æ¥" class="headerlink" title="åœ¨ç¨‹åºé—´åˆ›å»ºè¿æ¥"></a>åœ¨ç¨‹åºé—´åˆ›å»ºè¿æ¥</h3><p>åœ¨ shell ä¸­ï¼Œç¨‹åºæœ‰ä¸¤ä¸ªä¸»è¦çš„â€œæµâ€ï¼šå®ƒä»¬çš„è¾“å…¥æµå’Œè¾“å‡ºæµã€‚ å½“ç¨‹åºå°è¯•è¯»å–ä¿¡æ¯æ—¶ï¼Œå®ƒä»¬ä¼šä»è¾“å…¥æµä¸­è¿›è¡Œè¯»å–ï¼Œå½“ç¨‹åºæ‰“å°ä¿¡æ¯æ—¶ï¼Œå®ƒä»¬ä¼šå°†ä¿¡æ¯è¾“å‡ºåˆ°è¾“å‡ºæµä¸­ã€‚ é€šå¸¸ï¼Œä¸€ä¸ªç¨‹åºçš„è¾“å…¥è¾“å‡ºæµéƒ½æ˜¯æ‚¨çš„ç»ˆç«¯ã€‚ä¹Ÿå°±æ˜¯ï¼Œæ‚¨çš„é”®ç›˜ä½œä¸ºè¾“å…¥ï¼Œæ˜¾ç¤ºå™¨ä½œä¸ºè¾“å‡ºã€‚ ä½†æ˜¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é‡å®šå‘è¿™äº›æµï¼</p><p>æœ€ç®€å•çš„é‡å®šå‘æ˜¯ <code>&lt; file</code> å’Œ <code>&gt; file</code>ã€‚è¿™ä¸¤ä¸ªå‘½ä»¤å¯ä»¥å°†ç¨‹åºçš„è¾“å…¥è¾“å‡ºæµåˆ†åˆ«é‡å®šå‘åˆ°æ–‡ä»¶ï¼š</p><pre><code>missing:~$ echo hello &gt; hello.txtmissing:~$ cat hello.txthellomissing:~$ cat &lt; hello.txthellomissing:~$ cat &lt; hello.txt &gt; hello2.txtmissing:~$ cat hello2.txthello</code></pre><blockquote><p><strong>The <em>cat</em> Command</strong>, <a href="https://www.baeldung.com/linux/cat-writing-file" target="_blank" rel="noopener">https://www.baeldung.com/linux/cat-writing-file</a></p><p>The <em>cat</em> command is a utility command in Linux. One of its most commonly known usages is to print the content of a file onto the standard output stream. Other than that, the <em>cat</em> command also allows us to write some texts into a file.</p></blockquote><p>æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ <code>&gt;&gt;</code> æ¥å‘ä¸€ä¸ªæ–‡ä»¶è¿½åŠ å†…å®¹ã€‚ä½¿ç”¨ç®¡é“ï¼ˆ <em>pipes</em> ï¼‰ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ›´å¥½çš„åˆ©ç”¨æ–‡ä»¶é‡å®šå‘ã€‚ <code>|</code> æ“ä½œç¬¦å…è®¸æˆ‘ä»¬å°†ä¸€ä¸ªç¨‹åºçš„è¾“å‡ºå’Œå¦å¤–ä¸€ä¸ªç¨‹åºçš„è¾“å…¥è¿æ¥èµ·æ¥ï¼š</p><pre><code>missing:~$ ls -l / | tail -n1drwxr-xr-x 1 root  root  4096 Jun 20  2019 varmissing:~$ curl --head --silent google.com | grep --ignore-case content-length | cut --delimiter=&#39; &#39; -f2219</code></pre><p>æˆ‘ä»¬ä¼šåœ¨æ•°æ®æ¸…ç†ä¸€ç« ä¸­æ›´åŠ è¯¦ç»†çš„æ¢è®¨å¦‚ä½•æ›´å¥½çš„åˆ©ç”¨ç®¡é“ã€‚</p><h3 id="ä¸€ä¸ªåŠŸèƒ½å…¨é¢åˆå¼ºå¤§çš„å·¥å…·"><a href="#ä¸€ä¸ªåŠŸèƒ½å…¨é¢åˆå¼ºå¤§çš„å·¥å…·" class="headerlink" title="ä¸€ä¸ªåŠŸèƒ½å…¨é¢åˆå¼ºå¤§çš„å·¥å…·"></a>ä¸€ä¸ªåŠŸèƒ½å…¨é¢åˆå¼ºå¤§çš„å·¥å…·</h3><p>å¯¹äºå¤§å¤šæ•°çš„ç±» Unix ç³»ç»Ÿï¼Œæœ‰ä¸€ç±»ç”¨æˆ·æ˜¯éå¸¸ç‰¹æ®Šçš„ï¼Œé‚£å°±æ˜¯ï¼šæ ¹ç”¨æˆ·ï¼ˆroot userï¼‰ã€‚ æ‚¨åº”è¯¥å·²ç»æ³¨æ„åˆ°äº†ï¼Œåœ¨ä¸Šé¢çš„è¾“å‡ºç»“æœä¸­ï¼Œæ ¹ç”¨æˆ·å‡ ä¹ä¸å—ä»»ä½•é™åˆ¶ï¼Œä»–å¯ä»¥åˆ›å»ºã€è¯»å–ã€æ›´æ–°å’Œåˆ é™¤ç³»ç»Ÿä¸­çš„ä»»ä½•æ–‡ä»¶ã€‚ é€šå¸¸åœ¨æˆ‘ä»¬å¹¶ä¸ä¼šä»¥æ ¹ç”¨æˆ·çš„èº«ä»½ç›´æ¥ç™»å½•ç³»ç»Ÿï¼Œå› ä¸ºè¿™æ ·å¯èƒ½ä¼šå› ä¸ºæŸäº›é”™è¯¯çš„æ“ä½œè€Œç ´åç³»ç»Ÿã€‚ å–è€Œä»£ä¹‹çš„æ˜¯æˆ‘ä»¬ä¼šåœ¨éœ€è¦çš„æ—¶å€™ä½¿ç”¨ <code>sudo</code> å‘½ä»¤ã€‚é¡¾åæ€ä¹‰ï¼Œå®ƒçš„ä½œç”¨æ˜¯è®©æ‚¨å¯ä»¥ä»¥ suï¼ˆsuper user æˆ– root çš„ç®€å†™ï¼‰çš„èº«ä»½æ‰§è¡Œä¸€äº›æ“ä½œã€‚ å½“æ‚¨é‡åˆ°æ‹’ç»è®¿é—®ï¼ˆpermission deniedï¼‰çš„é”™è¯¯æ—¶ï¼Œé€šå¸¸æ˜¯å› ä¸ºæ­¤æ—¶æ‚¨å¿…é¡»æ˜¯æ ¹ç”¨æˆ·æ‰èƒ½æ“ä½œã€‚ç„¶è€Œï¼Œè¯·å†æ¬¡ç¡®è®¤æ‚¨æ˜¯çœŸçš„è¦æ‰§è¡Œæ­¤æ“ä½œã€‚</p><p>æœ‰ä¸€ä»¶äº‹æƒ…æ˜¯æ‚¨å¿…é¡»ä½œä¸ºæ ¹ç”¨æˆ·æ‰èƒ½åšçš„ï¼Œé‚£å°±æ˜¯å‘ <code>sysfs</code> æ–‡ä»¶å†™å…¥å†…å®¹ã€‚ç³»ç»Ÿè¢«æŒ‚è½½åœ¨ <code>/sys</code> ä¸‹ï¼Œ<code>sysfs</code> æ–‡ä»¶åˆ™æš´éœ²äº†ä¸€äº›å†…æ ¸ï¼ˆkernelï¼‰å‚æ•°ã€‚ å› æ­¤ï¼Œæ‚¨ä¸éœ€è¦å€ŸåŠ©ä»»ä½•ä¸“ç”¨çš„å·¥å…·ï¼Œå°±å¯ä»¥è½»æ¾åœ°åœ¨è¿è¡ŒæœŸé—´é…ç½®ç³»ç»Ÿå†…æ ¸ã€‚<strong>æ³¨æ„ Windows å’Œ macOS æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶</strong></p><p>ä¾‹å¦‚ï¼Œæ‚¨ç¬”è®°æœ¬ç”µè„‘çš„å±å¹•äº®åº¦å†™åœ¨ <code>brightness</code> æ–‡ä»¶ä¸­ï¼Œå®ƒä½äº</p><pre><code>/sys/class/backlight</code></pre><p>é€šè¿‡å°†æ•°å€¼å†™å…¥è¯¥æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥æ”¹å˜å±å¹•çš„äº®åº¦ã€‚ç°åœ¨ï¼Œè¹¦åˆ°æ‚¨è„‘è¢‹é‡Œçš„ç¬¬ä¸€ä¸ªæƒ³æ³•å¯èƒ½æ˜¯ï¼š</p><pre><code>$ sudo find -L /sys/class/backlight -maxdepth 2 -name &#39;*brightness*&#39;/sys/class/backlight/thinkpad_screen/brightness$ cd /sys/class/backlight/thinkpad_screen$ sudo echo 3 &gt; brightnessAn error occurred while redirecting file &#39;brightness&#39;open: Permission denied</code></pre><p>å‡ºä¹æ„æ–™çš„æ˜¯ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¾—åˆ°äº†ä¸€ä¸ªé”™è¯¯ä¿¡æ¯ã€‚æ¯•ç«Ÿï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨äº† <code>sudo</code> å‘½ä»¤ï¼å…³äº shellï¼Œæœ‰ä»¶äº‹æˆ‘ä»¬å¿…é¡»è¦çŸ¥é“ã€‚<code>|</code>ã€<code>&gt;</code>ã€å’Œ <code>&lt;</code> æ˜¯é€šè¿‡ shell æ‰§è¡Œçš„ï¼Œè€Œä¸æ˜¯è¢«å„ä¸ªç¨‹åºå•ç‹¬æ‰§è¡Œã€‚ <code>echo</code> ç­‰ç¨‹åºå¹¶ä¸çŸ¥é“ <code>|</code> çš„å­˜åœ¨ï¼Œå®ƒä»¬åªçŸ¥é“ä»è‡ªå·±çš„è¾“å…¥è¾“å‡ºæµä¸­è¿›è¡Œè¯»å†™ã€‚ å¯¹äºä¸Šé¢è¿™ç§æƒ…å†µï¼Œ <em>shell</em> (æƒé™ä¸ºæ‚¨çš„å½“å‰ç”¨æˆ·) åœ¨è®¾ç½® <code>sudo echo</code> å‰å°è¯•æ‰“å¼€ brightness æ–‡ä»¶å¹¶å†™å…¥ï¼Œä½†æ˜¯ç³»ç»Ÿæ‹’ç»äº† shell çš„æ“ä½œå› ä¸ºæ­¤æ—¶ shell ä¸æ˜¯æ ¹ç”¨æˆ·ã€‚</p><p>æ˜ç™½è¿™ä¸€ç‚¹åï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·æ“ä½œï¼š</p><pre><code>$ echo 3 | sudo tee brightness</code></pre><p>å› ä¸ºæ‰“å¼€ <code>/sys</code> æ–‡ä»¶çš„æ˜¯ <code>tee</code> è¿™ä¸ªç¨‹åºï¼Œå¹¶ä¸”è¯¥ç¨‹åºä»¥ <code>root</code> æƒé™åœ¨è¿è¡Œï¼Œå› æ­¤æ“ä½œå¯ä»¥è¿›è¡Œã€‚ è¿™æ ·æ‚¨å°±å¯ä»¥åœ¨ <code>/sys</code> ä¸­æ„‰å¿«åœ°ç©è€äº†ï¼Œä¾‹å¦‚ä¿®æ”¹ç³»ç»Ÿä¸­å„ç§LEDçš„çŠ¶æ€ï¼ˆè·¯å¾„å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼‰ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">$ echo 1 | sudo tee /sys/class/leds/input6::scrolllock/brightness<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="æ¥ä¸‹æ¥â€¦"><a href="#æ¥ä¸‹æ¥â€¦" class="headerlink" title="æ¥ä¸‹æ¥â€¦.."></a>æ¥ä¸‹æ¥â€¦..</h3><p>å­¦åˆ°è¿™é‡Œï¼Œæ‚¨æŒæ¡çš„ shell çŸ¥è¯†å·²ç»å¯ä»¥å®Œæˆä¸€äº›åŸºç¡€çš„ä»»åŠ¡äº†ã€‚æ‚¨åº”è¯¥å·²ç»å¯ä»¥æŸ¥æ‰¾æ„Ÿå…´è¶£çš„æ–‡ä»¶å¹¶ä½¿ç”¨å¤§å¤šæ•°ç¨‹åºçš„åŸºæœ¬åŠŸèƒ½äº†ã€‚ åœ¨ä¸‹ä¸€åœºè®²åº§ä¸­ï¼Œæˆ‘ä»¬ä¼šæ¢è®¨å¦‚ä½•åˆ©ç”¨ shell åŠå…¶ä»–å·¥å…·æ‰§è¡Œå¹¶è‡ªåŠ¨åŒ–æ›´å¤æ‚çš„ä»»åŠ¡ã€‚</p><h2 id="å…¬ç½‘è®¿é—®æ–¹å¼"><a href="#å…¬ç½‘è®¿é—®æ–¹å¼" class="headerlink" title="å…¬ç½‘è®¿é—®æ–¹å¼"></a>å…¬ç½‘è®¿é—®æ–¹å¼</h2><p>ä¹‹å‰æˆ‘ä»¥ä¸ºæˆ‘ä»¬åªèƒ½å†…ç½‘è®¿é—®ï¼Œä½†æ˜¯ç°åœ¨å‘ç°è¿˜å¯ä»¥å…¬ç½‘è®¿é—®è¯¥æ–‡ä»¶ã€‚ç»è¿‡æˆ‘ä»¬ä¼˜ç§€ç»„é•¿è’‹æµ©æ‡¿çš„æŒ‡ç‚¹ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š</p><p>é¦–å…ˆè¾“å…¥æˆ‘ä»¬çš„è¿™æ ·ä¸€ä¸²ä»£ç ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">ssh jump<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ¥ç€æˆ‘ä»¬å°±éœ€è¦è¾“å…¥å…¬ç½‘çš„å¯†ç äº†ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">****(ç»è¿‡åŠ å¯†ä¸äºˆæ˜¾ç¤º)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åæˆ‘ä»¬æ¥ç€å°±å¯ä»¥ä½¿ç”¨å†…ç½‘çš„è¿æ¥æ–¹å¼äº†ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆssh 43004ä¸è¡Œï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">ssh lry@192.168.0.75<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ¥ç€è¾“å…¥è‡ªå·±çš„å¯†ç å°±OKã€‚</p><h2 id="é…ç½®ç¯å¢ƒ"><a href="#é…ç½®ç¯å¢ƒ" class="headerlink" title="é…ç½®ç¯å¢ƒ"></a>é…ç½®ç¯å¢ƒ</h2><p>é…ç½®ç›¸åº”çš„æœºå™¨å­¦ä¹ ç¯å¢ƒçœŸéº»çƒ¦ï¼Œæˆ‘æ„Ÿè§‰åˆè¦é…ä¸€æ•´å¤©â€¦â€¦</p><h3 id="å®‰è£…miniconda"><a href="#å®‰è£…miniconda" class="headerlink" title="å®‰è£…miniconda"></a>å®‰è£…miniconda</h3><blockquote><p>å‚è€ƒåšå®¢ï¼š<a href="https://blog.csdn.net/qq_41795565/article/details/114181048#:~:text=%E6%89%BE%E5%88%B0MiniConda%20%E5%AE%98%E7%BD%91%E8%BF%9E%E6%8E%A5%E6%89%BE%E5%88%B0,%E5%90%8E%E9%9D%A2%E5%85%A8%E9%83%A8yes%E9%80%9A%E8%BF%87%E5%AE%89%E8%A3%85%E3%80%82" target="_blank" rel="noopener">https://blog.csdn.net/qq_41795565/article/details/114181048#:~:text=%E6%89%BE%E5%88%B0MiniConda%20%E5%AE%98%E7%BD%91%E8%BF%9E%E6%8E%A5%E6%89%BE%E5%88%B0,%E5%90%8E%E9%9D%A2%E5%85%A8%E9%83%A8yes%E9%80%9A%E8%BF%87%E5%AE%89%E8%A3%85%E3%80%82</a></p></blockquote><p>æŒ‡ä»¤ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell"># step 1: è·å–å®‰è£…shellè„šæœ¬æ–‡ä»¶wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh# step 2: æ‰§è¡Œè„šæœ¬æ–‡ä»¶å®‰è£…bash Miniconda3-latest-Linux-x86_64.sh# step 3: æ¿€æ´»source ~/.bashrc<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>æ³¨æ„ï¼Œç¬¬ä¸‰æ­¥æ¿€æ´»ä¸åŒçš„äººè·¯å¾„ä¸ä¸€æ ·ï¼Œæ¯”å¦‚è¯´æˆ‘çš„è·¯å¾„å°±æ˜¯~/.zshrc, è¿™ä¸€ç‚¹è¯·æ ¼å¤–æ³¨æ„ä¸€ä¸‹ã€‚</strong></li><li><a href="https://imgtu.com/i/4r6PQe" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/09/25/4r6PQe.md.png" alt="zshrc"></a></li><li>å¦å¤–ç¬¬äºŒæ­¥çš„è·¯å¾„å¯ä»¥è‡ªå·±é€‰ï¼Œåˆ°æ—¶å€™è®©é€‰locationçš„æ—¶å€™æ³¨æ„è‡ªå·±è¾“å…¥è·¯å¾„å°±OKäº†ã€‚</li></ul><h3 id="æ¥ç€å®‰è£…æˆ‘ä»¬æ·±åº¦å­¦ä¹ å…¶ä»–ç¯å¢ƒ"><a href="#æ¥ç€å®‰è£…æˆ‘ä»¬æ·±åº¦å­¦ä¹ å…¶ä»–ç¯å¢ƒ" class="headerlink" title="æ¥ç€å®‰è£…æˆ‘ä»¬æ·±åº¦å­¦ä¹ å…¶ä»–ç¯å¢ƒ"></a>æ¥ç€å®‰è£…æˆ‘ä»¬æ·±åº¦å­¦ä¹ å…¶ä»–ç¯å¢ƒ</h3><p>æˆ‘å‘ç°è¿™ä¸€ç¯‡åšå®¢å†™å¾—éå¸¸å¥½ï¼Œå¸Œæœ›å¯¹å„ä½æœ‰å¸®åŠ©ï¼Œè‡³å°‘å¯¹æˆ‘å¸®åŠ©éå¸¸å¤§ï¼</p><p><a href="https://bartek-blog.github.io/python/pytorch/conda/2018/11/12/install-pytorch-with-conda.html" target="_blank" rel="noopener">https://bartek-blog.github.io/python/pytorch/conda/2018/11/12/install-pytorch-with-conda.html</a></p><p>å‘œå‘œå‘œï¼Œä¸ç”¨è£…äº†ä¸ç”¨è£…äº†ï¼Œç›®å‰å·²ç»æœ‰é…å¥½çš„ç¯å¢ƒå¯ä¾›æˆ‘ä½¿ç”¨äº†ï¼Œå„ä½è¯·å‚è€ƒä¸Šé¢çš„åšå®¢ï¼Œç¥ä½ ä»¬æˆåŠŸï¼</p><p>åˆéœ€è¦è£…äº†ğŸ˜…ï¼Œä½†å®é™…ä¸Šä¹Ÿå¹¶ä¸éš¾ï¼Œè¿™ä¹ˆæ¥ï¼š</p><p>ipythonå’Œjupyternotebook:<a href="https://zhuanlan.zhihu.com/p/369612671" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/369612671</a></p><p>è®°ä½ä¿å­˜å¯†æ–‡ï¼š<code>&#39;argon2:$argon2id$v=19$m=10240,t=10,p=8$iXHYQd2WrThQvARAuNV8Mg$Ip+Au2KT0QfmfOqvpmYpiA&#39;</code></p><p>å¦å¤–å…³äºjupyter notebookå†…æ ¸é—®é¢˜ï¼Œå¦‚æœåœ¨vscodeæ‰¾ä¸åˆ°å†…æ ¸äº†ï¼Œæˆ‘ä»¬å°±ç›´æ¥</p><p><a href="https://imgtu.com/i/4fo6a9" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/09/28/4fo6a9.png" alt></a></p><p>ç„¶åç›´æ¥ç‚¹è¿™ä¸ªåœ°æ–¹ï¼š<a href="https://imgtu.com/i/4fowvT" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/09/28/4fowvT.png" alt></a></p><p>ç„¶åè¾“å…¥æˆ‘ä»¬çš„å¤åˆ¶çš„é“¾æ¥ï¼Œæ¥ç€å°±å¯ä»¥ç”¨äº†ï¼Œç®¡ä¸äº†è¿™ä¹ˆå¤šï¼Œå°±è¿™ä¹ˆç”¨å°±OKã€‚</p><h2 id="ä¸‹è½½å’Œè§£å‹ã€å‹ç¼©æ–‡ä»¶"><a href="#ä¸‹è½½å’Œè§£å‹ã€å‹ç¼©æ–‡ä»¶" class="headerlink" title="ä¸‹è½½å’Œè§£å‹ã€å‹ç¼©æ–‡ä»¶"></a>ä¸‹è½½å’Œè§£å‹ã€å‹ç¼©æ–‡ä»¶</h2><h3 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h3><p>wgetæ˜¯linuxä¸‹ä¸€ä¸ªä»ç½‘ç»œä¸Šè‡ªåŠ¨ä¸‹è½½æ–‡ä»¶çš„å¸¸ç”¨è‡ªç”±å·¥å…·ã€‚å®ƒæ”¯æŒHTTPï¼ŒHTTPSå’ŒFTPåè®®ï¼Œå¯ä»¥ä½¿ç”¨HTTPä»£ç†ã€‚ä¸€èˆ¬çš„ä½¿ç”¨æ–¹æ³•æ˜¯: wget + ç©ºæ ¼ + å‚æ•° + è¦ä¸‹è½½æ–‡ä»¶çš„urlè·¯å¾„ï¼Œä¾‹å¦‚ï¼š</p><p>wget -c <a href="http://apache.opencas.org/tomcat/tomcat-7/v7.0.67/bin/apache-tomcat-7.0.67.zip" target="_blank" rel="noopener">http://apache.opencas.org/tomcat/tomcat-7/v7.0.67/bin/apache-tomcat-7.0.67.zip</a><br>-cå‚æ•°, è¿™ä¸ªä¹Ÿéå¸¸å¸¸è§, å¯ä»¥æ–­ç‚¹ç»­ä¼ , å¦‚æœä¸å°å¿ƒç»ˆæ­¢äº†, å¯ä»¥ç»§ç»­ä½¿ç”¨å‘½ä»¤æ¥ç€ä¸‹è½½ã€‚</p><p>Wgetå¸¸ç”¨å‚æ•°</p><p>-bï¼šåå°ä¸‹è½½ï¼ŒWgeté»˜è®¤çš„æ˜¯æŠŠæ–‡ä»¶ä¸‹è½½åˆ°å½“å‰ç›®å½•ã€‚</p><p>-Oï¼šå°†æ–‡ä»¶ä¸‹è½½åˆ°æŒ‡å®šçš„ç›®å½•ä¸­ã€‚</p><p>-Pï¼šä¿å­˜æ–‡ä»¶ä¹‹å‰å…ˆåˆ›å»ºæŒ‡å®šåç§°çš„ç›®å½•ã€‚</p><p>-tï¼šå°è¯•è¿æ¥æ¬¡æ•°ï¼Œå½“Wgetæ— æ³•ä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥æ—¶ï¼Œå°è¯•è¿æ¥å¤šå°‘æ¬¡ã€‚</p><p>-cï¼šæ–­ç‚¹ç»­ä¼ ï¼Œå¦‚æœä¸‹è½½ä¸­æ–­ï¼Œé‚£ä¹ˆè¿æ¥æ¢å¤æ—¶ä¼šä»ä¸Šæ¬¡æ–­ç‚¹å¼€å§‹ä¸‹è½½ã€‚</p><p>-rï¼šä½¿ç”¨é€’å½’ä¸‹è½½</p><h3 id="è§£å‹"><a href="#è§£å‹" class="headerlink" title="è§£å‹"></a>è§£å‹</h3><p>1.zipå‘½ä»¤<br>zip -r myfile.zip ./*<br>å°†å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹å…¨éƒ¨å‹ç¼©æˆmyfile.zipæ–‡ä»¶,ï¼rè¡¨ç¤ºé€’å½’å‹ç¼©å­ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶.</p><p>2.unzipå‘½ä»¤<br>unzip -o -d /home/sunny myfile.zip<br>æŠŠmyfile.zipæ–‡ä»¶è§£å‹åˆ° /home/sunny/<br>-o:ä¸æç¤ºçš„æƒ…å†µä¸‹è¦†ç›–æ–‡ä»¶ï¼›<br>-d:-d /home/sunny æŒ‡æ˜å°†æ–‡ä»¶è§£å‹ç¼©åˆ°/home/sunnyç›®å½•ä¸‹ï¼›</p><p>3.å…¶ä»–<br>zip -d myfile.zip smart.txt<br>åˆ é™¤å‹ç¼©æ–‡ä»¶ä¸­smart.txtæ–‡ä»¶<br>zip -m myfile.zip ./rpm_info.txt<br>å‘å‹ç¼©æ–‡ä»¶ä¸­myfile.zipä¸­æ·»åŠ rpm_info.txtæ–‡ä»¶</p><p>è¦ä½¿ç”¨ zip æ¥å‹ç¼©æ–‡ä»¶ï¼Œåœ¨ shell æç¤ºä¸‹é”®å…¥ä¸‹é¢çš„å‘½ä»¤ï¼š</p><p>zip -r filename.zip filesdir<br>åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œfilename.zip ä»£è¡¨ä½ åˆ›å»ºçš„æ–‡ä»¶ï¼Œfilesdir ä»£è¡¨ä½ æƒ³æ”¾ç½®æ–° zip æ–‡ä»¶çš„ç›®å½•ã€‚-r é€‰é¡¹æŒ‡å®šä½ æƒ³é€’å½’åœ°ï¼ˆrecursivelyï¼‰åŒ…æ‹¬æ‰€æœ‰åŒ…æ‹¬åœ¨ filesdir ç›®å½•ä¸­çš„æ–‡ä»¶ã€‚<br>è¦æŠ½å– zip æ–‡ä»¶çš„å†…å®¹ï¼Œé”®å…¥ä»¥ä¸‹å‘½ä»¤ï¼š<br>unzip filename.zip</p><p>ä½ å¯ä»¥ä½¿ç”¨ zip å‘½ä»¤åŒæ—¶å¤„ç†å¤šä¸ªæ–‡ä»¶å’Œç›®å½•ï¼Œæ–¹æ³•æ˜¯å°†å®ƒä»¬é€ä¸€åˆ—å‡ºï¼Œå¹¶ç”¨ç©ºæ ¼é—´éš”ï¼š</p><p>zip -r filename.zip file1 file2 file3 /usr/work/school<br>ä¸Šé¢çš„å‘½ä»¤æŠŠ file1ã€file2ã€ file3ã€ä»¥åŠ /usr/work/school ç›®å½•çš„å†…å®¹ï¼ˆå‡è®¾è¿™ä¸ªç›®å½•å­˜åœ¨ï¼‰å‹ç¼©èµ·æ¥ï¼Œç„¶åæ”¾å…¥ filename.zip æ–‡ä»¶ä¸­ã€‚</p><h2 id="linux-å¦‚ä½•ä»¥æ ‘å½¢ç»“æ„æ˜¾ç¤ºæ–‡ä»¶ç›®å½•ç»“æ„"><a href="#linux-å¦‚ä½•ä»¥æ ‘å½¢ç»“æ„æ˜¾ç¤ºæ–‡ä»¶ç›®å½•ç»“æ„" class="headerlink" title="linux å¦‚ä½•ä»¥æ ‘å½¢ç»“æ„æ˜¾ç¤ºæ–‡ä»¶ç›®å½•ç»“æ„"></a>linux å¦‚ä½•ä»¥æ ‘å½¢ç»“æ„æ˜¾ç¤ºæ–‡ä»¶ç›®å½•ç»“æ„</h2><p>å¯ä»¥ç”¨ tree å‘½ä»¤</p><p>å®‰è£…ï¼š</p><p>sudo apt-get install tree</p><p>åŠŸèƒ½è¯´æ˜ï¼šä»¥æ ‘çŠ¶å›¾åˆ—å‡ºç›®å½•çš„å†…å®¹ã€‚</p><p>å¦‚ï¼š</p><p>tree ä»¥æ ‘çŠ¶å›¾æ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶</p><p>tree -L N ä»¥æ ‘çŠ¶å›¾æ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶ï¼Œå­æ–‡ä»¶å¤¹æ˜¾ç¤ºåˆ°ç¬¬ N å±‚</p><h2 id="å…³äºapt-get"><a href="#å…³äºapt-get" class="headerlink" title="å…³äºapt-get"></a>å…³äºapt-get</h2><p>apt-getæ˜¯linuxä¸­å¸¸ç”¨çš„shellå‘½ä»¤ï¼Œé€‚ç”¨äºdebåŒ…ç®¡ç†å¼çš„æ“ä½œç³»ç»Ÿï¼Œä¸»è¦ç”¨äºè‡ªåŠ¨ä»äº’è”ç½‘çš„è½¯ä»¶ä»“åº“ä¸­æœç´¢ã€å®‰è£…ã€å‡çº§ã€å¸è½½è½¯ä»¶æˆ–æ“ä½œç³»ç»Ÿã€‚apt-getå‘½ä»¤ä¸€èˆ¬éœ€è¦rootæƒé™æ‰§è¡Œï¼Œæ‰€ä»¥å‰è¾¹ä¸€èˆ¬è·Ÿç€sudoå‘½ä»¤ã€‚</p><h2 id="è¿œç¨‹æœåŠ¡å™¨æœ¬åœ°è¿æ¥scp"><a href="#è¿œç¨‹æœåŠ¡å™¨æœ¬åœ°è¿æ¥scp" class="headerlink" title="è¿œç¨‹æœåŠ¡å™¨æœ¬åœ°è¿æ¥scp"></a>è¿œç¨‹æœåŠ¡å™¨æœ¬åœ°è¿æ¥scp</h2><h3 id="ä¸€ï¼šscpå¸¸è§„çš„ä½¿ç”¨æ–¹å¼ï¼š"><a href="#ä¸€ï¼šscpå¸¸è§„çš„ä½¿ç”¨æ–¹å¼ï¼š" class="headerlink" title="ä¸€ï¼šscpå¸¸è§„çš„ä½¿ç”¨æ–¹å¼ï¼š"></a><strong>ä¸€ï¼šscpå¸¸è§„çš„ä½¿ç”¨æ–¹å¼ï¼š</strong></h3><p>scpå¯ä»¥è¿›è¡Œç®€å•çš„è¿œç¨‹å¤åˆ¶æ–‡ä»¶çš„åŠŸèƒ½ã€‚å®ƒæ˜¯ä¸€ä¸ªåœ¨å„ä¸ªä¸»æœºä¹‹é—´è¿›è¡Œå¤åˆ¶æˆ–æ–‡ä»¶ä¼ è¾“çš„ä¸€ä¸ªå‘½ä»¤å·¥å…·ã€‚å®ƒä½¿ç”¨ä¸€ç§åŒsshä¸€æ ·çš„å®‰å…¨æœºåˆ¶æ¥è¿›è¡Œæ–‡ä»¶çš„ä¼ è¾“ã€‚</p><p><strong>æ³¨æ„ï¼šä¸‹é¢å®šä¹‰çš„è¿œç¨‹è®¡ç®—æœºçš„ä¸»æœºåŸŸåæ˜¯ 192.168.1.104ï¼Œ ä¸Šä¼ æ–‡ä»¶çš„è·¯å¾„æ˜¯ /usr/local/nginx/html/webs ä¸‹é¢çš„æ–‡ä»¶ï¼›ä¸” æœåŠ¡å™¨çš„è´¦å·æ˜¯ rootï¼Œ é‚£ä¹ˆå¯†ç éœ€è¦è‡ªå·±è¾“å…¥è‡ªå·±çš„å¯†ç å³å¯ã€‚</strong></p><p>\1. ä»æœ¬åœ°ä¸Šä¼ æ–‡ä»¶åˆ°è¿œç¨‹è®¡ç®—æœºæˆ–æœåŠ¡å™¨çš„å‘½ä»¤å¦‚ä¸‹ï¼š<br>å…ˆè¿›å…¥æœ¬åœ°ç›®å½•ä¸‹ï¼Œç„¶åè¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š<br><strong>scp my_local_file.zip <a href="mailto:root@192.168.1.104" target="_blank" rel="noopener">root@192.168.1.104</a>:/usr/local/nginx/html/webs</strong></p><p>\2. ä»è¿œç¨‹ä¸»æœºå¤åˆ¶æ–‡ä»¶åˆ°æœ¬åœ°ä¸»æœº(ä¸‹è½½)çš„å‘½ä»¤å¦‚ä¸‹ï¼šï¼ˆå‡å¦‚è¿œç¨‹æ–‡ä»¶æ˜¯about.zipï¼‰<br>å…ˆè¿›å…¥æœ¬åœ°ç›®å½•ä¸‹ï¼Œç„¶åè¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š<br><strong>scp <a href="mailto:root@192.168.1.104" target="_blank" rel="noopener">root@192.168.1.104</a>:/usr/local/nginx/html/webs/about.zip .</strong></p><h3 id="äºŒï¼š-å¤šæ–‡ä»¶ä¼ è¾“"><a href="#äºŒï¼š-å¤šæ–‡ä»¶ä¼ è¾“" class="headerlink" title="äºŒï¼š å¤šæ–‡ä»¶ä¼ è¾“"></a><strong>äºŒï¼š å¤šæ–‡ä»¶ä¼ è¾“</strong></h3><p>2-1 ä»æœ¬åœ°æ–‡ä»¶å¤åˆ¶å¤šä¸ªæ–‡ä»¶åˆ°è¿œç¨‹ä¸»æœºï¼ˆå¤šä¸ªæ–‡ä»¶ä½¿ç”¨ç©ºæ ¼åˆ†éš”å¼€ï¼‰<br>å…ˆè¿›å…¥æœ¬åœ°ç›®å½•ä¸‹ï¼Œç„¶åè¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š<br><strong>scp index.css json.js <a href="mailto:root@192.168.1.104" target="_blank" rel="noopener">root@192.168.1.104</a>:/usr/local/nginx/html/webs</strong></p><p>2-2 ä»è¿œç¨‹ä¸»æœºå¤åˆ¶å¤šä¸ªæ–‡ä»¶åˆ°å½“å‰ç›®å½•<br>å…ˆè¿›å…¥æœ¬åœ°ç›®å½•ä¸‹ï¼Œç„¶åè¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š<br><strong>scp <a href="mailto:root@192.168.1.104" target="_blank" rel="noopener">root@192.168.1.104</a>:/usr/local/nginx/html/webs/{index.css,json.js} .</strong></p><h3 id="ä¸‰ï¼šå¤åˆ¶æ•´ä¸ªæ–‡ä»¶å¤¹-ä½¿ç”¨r-switch-å¹¶ä¸”æŒ‡å®šç›®å½•"><a href="#ä¸‰ï¼šå¤åˆ¶æ•´ä¸ªæ–‡ä»¶å¤¹-ä½¿ç”¨r-switch-å¹¶ä¸”æŒ‡å®šç›®å½•" class="headerlink" title="ä¸‰ï¼šå¤åˆ¶æ•´ä¸ªæ–‡ä»¶å¤¹(ä½¿ç”¨r switch å¹¶ä¸”æŒ‡å®šç›®å½•)"></a><strong>ä¸‰ï¼šå¤åˆ¶æ•´ä¸ªæ–‡ä»¶å¤¹(ä½¿ç”¨r switch å¹¶ä¸”æŒ‡å®šç›®å½•)</strong></h3><p>3-1 ä»æœ¬åœ°æ–‡ä»¶å¤åˆ¶æ•´ä¸ªæ–‡ä»¶å¤¹åˆ°è¿œç¨‹ä¸»æœºä¸Šï¼ˆæ–‡ä»¶å¤¹å‡å¦‚æ˜¯diffï¼‰<br>å…ˆè¿›å…¥æœ¬åœ°ç›®å½•ä¸‹ï¼Œç„¶åè¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š<br><strong>scp -v -r diff <a href="mailto:root@192.168.1.104" target="_blank" rel="noopener">root@192.168.1.104</a>:/usr/local/nginx/html/webs</strong></p><p>3-2 ä»è¿œç¨‹ä¸»æœºå¤åˆ¶æ•´ä¸ªæ–‡ä»¶å¤¹åˆ°æœ¬åœ°ç›®å½•ä¸‹ï¼ˆæ–‡ä»¶å¤¹å‡å¦‚æ˜¯diffï¼‰<br>å…ˆè¿›å…¥æœ¬åœ°ç›®å½•ä¸‹ï¼Œç„¶åè¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š<br><strong>scp -r <a href="mailto:root@192.168.1.104" target="_blank" rel="noopener">root@192.168.1.104</a>:/usr/local/nginx/html/webs/diff .</strong></p><h3 id="å››ï¼šåœ¨ä¸¤ä¸ªè¿œç¨‹ä¸»æœºä¹‹é—´å¤åˆ¶æ–‡ä»¶"><a href="#å››ï¼šåœ¨ä¸¤ä¸ªè¿œç¨‹ä¸»æœºä¹‹é—´å¤åˆ¶æ–‡ä»¶" class="headerlink" title="å››ï¼šåœ¨ä¸¤ä¸ªè¿œç¨‹ä¸»æœºä¹‹é—´å¤åˆ¶æ–‡ä»¶"></a><strong>å››ï¼šåœ¨ä¸¤ä¸ªè¿œç¨‹ä¸»æœºä¹‹é—´å¤åˆ¶æ–‡ä»¶</strong></h3><p>scpä¹Ÿå¯ä»¥æŠŠæ–‡ä»¶ä»ä¸€ä¸ªè¿œç¨‹ä¸»æœºå¤åˆ¶åˆ°å¦ä¸€ä¸ªè¿œç¨‹ä¸»æœºä¸Šã€‚<br>å¦‚ä¸‹å‘½ä»¤ï¼š<br><strong>scp <a href="mailto:root@192.168.1.104" target="_blank" rel="noopener">root@192.168.1.104</a>:/usr/local/nginx/html/webs/xx.txt <a href="mailto:root@192.168.1.105" target="_blank" rel="noopener">root@192.168.1.105</a>:/usr/local/nginx/html/webs/</strong></p><h3 id="äº”ï¼šä½¿ç”¨å‹ç¼©æ¥åŠ å¿«ä¼ è¾“"><a href="#äº”ï¼šä½¿ç”¨å‹ç¼©æ¥åŠ å¿«ä¼ è¾“" class="headerlink" title="äº”ï¼šä½¿ç”¨å‹ç¼©æ¥åŠ å¿«ä¼ è¾“"></a><strong>äº”ï¼šä½¿ç”¨å‹ç¼©æ¥åŠ å¿«ä¼ è¾“</strong></h3><p>åœ¨æ–‡ä»¶ä¼ è¾“çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‹ç¼©æ–‡ä»¶æ¥åŠ å¿«æ–‡ä»¶ä¼ è¾“ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Cé€‰é¡¹æ¥å¯ç”¨å‹ç¼©åŠŸèƒ½ï¼Œè¯¥æ–‡ä»¶åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­è¢«å‹ç¼©ï¼Œåœ¨ç›®çš„ä¸»æœºä¸Šè¢«è§£å‹ç¼©ã€‚</p><p>å¦‚ä¸‹å‘½ä»¤ï¼š<br><strong>scp -vrC diff <a href="mailto:root@192.168.1.104" target="_blank" rel="noopener">root@192.168.1.104</a>:/usr/local/nginx/html/webs</strong></p><h2 id="å¤åˆ¶ã€ç§»åŠ¨ã€åˆ é™¤æ–‡ä»¶å‘½ä»¤"><a href="#å¤åˆ¶ã€ç§»åŠ¨ã€åˆ é™¤æ–‡ä»¶å‘½ä»¤" class="headerlink" title="å¤åˆ¶ã€ç§»åŠ¨ã€åˆ é™¤æ–‡ä»¶å‘½ä»¤"></a>å¤åˆ¶ã€ç§»åŠ¨ã€åˆ é™¤æ–‡ä»¶å‘½ä»¤</h2><p>linuxä¸‹æ–‡ä»¶çš„å¤åˆ¶ã€ç§»åŠ¨ä¸åˆ é™¤å‘½ä»¤ä¸ºï¼šcpï¼Œmvï¼Œrm<br>ä¸€ã€æ–‡ä»¶å¤åˆ¶å‘½ä»¤cp</p><pre class="line-numbers language-shell"><code class="language-shell">å‘½ä»¤æ ¼å¼ï¼šcp [-adfilprsu] æºæ–‡ä»¶(source) ç›®æ ‡æ–‡ä»¶(destination)cp [option] source1 source2 source3 ... directory<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å‚æ•°è¯´æ˜ï¼š<br>-a:æ˜¯æŒ‡archiveçš„æ„æ€ï¼Œä¹Ÿè¯´æ˜¯æŒ‡å¤åˆ¶æ‰€æœ‰çš„ç›®å½•<br>-d:è‹¥æºæ–‡ä»¶ä¸ºè¿æ¥æ–‡ä»¶(link file)ï¼Œåˆ™å¤åˆ¶è¿æ¥æ–‡ä»¶å±æ€§è€Œéæ–‡ä»¶æœ¬èº«<br>-f:å¼ºåˆ¶(force)ï¼Œè‹¥æœ‰é‡å¤æˆ–å…¶å®ƒç–‘é—®æ—¶ï¼Œä¸ä¼šè¯¢é—®ç”¨æˆ·ï¼Œè€Œå¼ºåˆ¶å¤åˆ¶<br>-i:è‹¥ç›®æ ‡æ–‡ä»¶(destination)å·²å­˜åœ¨ï¼Œåœ¨è¦†ç›–æ—¶ä¼šå…ˆè¯¢é—®æ˜¯å¦çœŸçš„æ“ä½œ<br>-l:å»ºç«‹ç¡¬è¿æ¥(hard link)çš„è¿æ¥æ–‡ä»¶ï¼Œè€Œéå¤åˆ¶æ–‡ä»¶æœ¬èº«<br>-p:ä¸æ–‡ä»¶çš„å±æ€§ä¸€èµ·å¤åˆ¶ï¼Œè€Œéä½¿ç”¨é»˜è®¤å±æ€§<br>-r:é€’å½’å¤åˆ¶ï¼Œç”¨äºç›®å½•çš„å¤åˆ¶æ“ä½œ<br>-s:å¤åˆ¶æˆç¬¦å·è¿æ¥æ–‡ä»¶(symbolic link)ï¼Œå³â€œå¿«æ·æ–¹å¼â€æ–‡ä»¶<br>-u:è‹¥ç›®æ ‡æ–‡ä»¶æ¯”æºæ–‡ä»¶æ—§ï¼Œæ›´æ–°ç›®æ ‡æ–‡ä»¶ </p><p>å¦‚å°†/test1ç›®å½•ä¸‹çš„file1å¤åˆ¶åˆ°/test3ç›®å½•ï¼Œå¹¶å°†æ–‡ä»¶åæ”¹ä¸ºfile2,å¯è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š<br>cp /test1/file1 /test3/file2</p><p>äºŒã€æ–‡ä»¶ç§»åŠ¨å‘½ä»¤mv</p><pre class="line-numbers language-shell"><code class="language-shell">å‘½ä»¤æ ¼å¼ï¼šmv [-fiv] source destination<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å‚æ•°è¯´æ˜ï¼š<br>-f:forceï¼Œå¼ºåˆ¶ç›´æ¥ç§»åŠ¨è€Œä¸è¯¢é—®<br>-i:è‹¥ç›®æ ‡æ–‡ä»¶(destination)å·²ç»å­˜åœ¨ï¼Œå°±ä¼šè¯¢é—®æ˜¯å¦è¦†ç›–<br>-u:è‹¥ç›®æ ‡æ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œä¸”æºæ–‡ä»¶æ¯”è¾ƒæ–°ï¼Œæ‰ä¼šæ›´æ–°</p><p>å¦‚å°†/test1ç›®å½•ä¸‹çš„file1å¤åˆ¶åˆ°/test3 ç›®å½•ï¼Œå¹¶å°†æ–‡ä»¶åæ”¹ä¸ºfile2,å¯è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š<br>mv /test1/file1 /test3/file2</p><p>ä¸‰ã€æ–‡ä»¶åˆ é™¤å‘½ä»¤rm</p><pre class="line-numbers language-shell"><code class="language-shell">å‘½ä»¤æ ¼å¼ï¼šrm [fir] æ–‡ä»¶æˆ–ç›®å½•<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å‚æ•°è¯´æ˜ï¼š<br>-f:å¼ºåˆ¶åˆ é™¤<br>-i:äº¤äº’æ¨¡å¼ï¼Œåœ¨åˆ é™¤å‰è¯¢é—®ç”¨æˆ·æ˜¯å¦æ“ä½œ<br>-r:é€’å½’åˆ é™¤ï¼Œå¸¸ç”¨åœ¨ç›®å½•çš„åˆ é™¤</p><p>å¦‚åˆ é™¤/testç›®å½•ä¸‹çš„file1æ–‡ä»¶ï¼Œå¯ä»¥è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š<br>rm -i /test/file1</p><pre class="line-numbers language-shell"><code class="language-shell">CPå‘½ä»¤æ ¼å¼: CP [é€‰é¡¹]  æºæ–‡ä»¶æˆ–ç›®å½•   ç›®çš„æ–‡ä»¶æˆ–ç›®å½•é€‰é¡¹è¯´æ˜:-b åŒå,å¤‡åˆ†åŸæ¥çš„æ–‡ä»¶        -f å¼ºåˆ¶è¦†ç›–åŒåæ–‡ä»¶        -r  æŒ‰é€’å½’æ–¹å¼ä¿ç•™åŸç›®å½•ç»“æ„å¤åˆ¶æ–‡ä»¶cp -Rf /home/user1/* /root/temp/å°† /home/user1ç›®å½•ä¸‹çš„æ‰€æœ‰ä¸œè¥¿æ‹·åˆ°/root/temp/ä¸‹è€Œä¸æ‹·è´user1ç›®å½•æœ¬èº«ã€‚å³æ ¼å¼ä¸ºï¼šcp -Rf åŸè·¯å¾„/ ç›®çš„è·¯å¾„/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ç§»åŠ¨ï¼š</strong></p><pre class="line-numbers language-shell"><code class="language-shell">mv ./WorkReport/web.xml ./WorkReport/WEB-INF/æ³¨ï¼šç§»åŠ¨/WorkReport/web.xmlæ–‡ä»¶åˆ°/WorkReport/WEB-INF/mv /data/new /data/old/æ³¨ï¼šç§»åŠ¨/data/new åˆ°/data/old/æ–‡ä»¶å¤¹ä¸‹æ³¨æ„ç‚¹ï¼šç§»åŠ¨æ–‡ä»¶å¤¹çš„è¯å°±ä¸è¦å†åŠ  / äº†å¦‚æœæ˜¯ç§»åŠ¨æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶çš„è¯å°±å¯ä»¥æ–‡ä»¶å¤¹åé¢è·Ÿä¸Š /* mv /data/new/* /data/old/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="linux-è½¯è¿æ¥çš„ä½¿ç”¨"><a href="#linux-è½¯è¿æ¥çš„ä½¿ç”¨" class="headerlink" title="linux è½¯è¿æ¥çš„ä½¿ç”¨"></a><a href="https://www.cnblogs.com/sueyyyy/p/10985443.html" target="_blank" rel="noopener">linux è½¯è¿æ¥çš„ä½¿ç”¨</a></h2><blockquote><p>è½¬è‡ªåšå®¢å›­ï¼š<a href="https://www.cnblogs.com/sueyyyy/p/10985443.html" target="_blank" rel="noopener">https://www.cnblogs.com/sueyyyy/p/10985443.html</a></p></blockquote><p>è½¯è¿æ¥æ˜¯linuxä¸­ä¸€ä¸ªå¸¸ç”¨å‘½ä»¤ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯ä¸ºæŸä¸€ä¸ªæ–‡ä»¶åœ¨å¦å¤–ä¸€ä¸ªä½ç½®å»ºç«‹ä¸€ä¸ªåŒä¸çš„é“¾æ¥ã€‚</p><p>å…·ä½“ç”¨æ³•æ˜¯ï¼šln -s æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶ã€‚ </p><p>å½“ æˆ‘ä»¬éœ€è¦åœ¨ä¸åŒçš„ç›®å½•ï¼Œç”¨åˆ°ç›¸åŒçš„æ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬ä¸éœ€è¦åœ¨æ¯ä¸€ä¸ªéœ€è¦çš„ç›®å½•ä¸‹éƒ½æ”¾ä¸€ä¸ªå¿…é¡»ç›¸åŒçš„æ–‡ä»¶ï¼Œæˆ‘ä»¬åªè¦åœ¨å…¶å®ƒçš„ ç›®å½•ä¸‹ç”¨lnå‘½ä»¤é“¾æ¥ï¼ˆlinkï¼‰å°±å¯ä»¥ï¼Œä¸å¿…é‡å¤çš„å ç”¨ç£ç›˜ç©ºé—´ã€‚</p><p>ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">ln -s /usr/local/mysql/bin/mysql /usr/bin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ ·æˆ‘ä»¬å°±å¯¹/usr/binç›®å½•ä¸‹çš„mysqlå‘½ä»¤åˆ›å»ºäº†è½¯è¿æ¥ </p><p>ã€ç¡¬è¿æ¥ã€‘<br>ç¡¬è¿æ¥æŒ‡é€šè¿‡ç´¢å¼•èŠ‚ç‚¹æ¥è¿›è¡Œè¿æ¥ã€‚åœ¨Linuxçš„æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œä¿å­˜åœ¨ç£ç›˜åˆ†åŒºä¸­çš„æ–‡ä»¶ä¸ç®¡æ˜¯ä»€ä¹ˆç±»å‹éƒ½ç»™å®ƒåˆ†é…ä¸€ä¸ªç¼–å·ï¼Œç§°ä¸ºç´¢å¼•èŠ‚ç‚¹å·(Inode Index)ã€‚åœ¨Linuxä¸­ï¼Œå¤šä¸ªæ–‡ä»¶åæŒ‡å‘åŒä¸€ç´¢å¼•èŠ‚ç‚¹æ˜¯å­˜åœ¨çš„ã€‚ä¸€èˆ¬è¿™ç§è¿æ¥å°±æ˜¯ç¡¬è¿æ¥ã€‚ç¡¬è¿æ¥çš„ä½œç”¨æ˜¯å…è®¸ä¸€ä¸ªæ–‡ä»¶æ‹¥æœ‰å¤šä¸ªæœ‰æ•ˆè·¯å¾„åï¼Œè¿™æ ·ç”¨æˆ·å°±å¯ä»¥å»ºç«‹ç¡¬è¿æ¥åˆ°é‡è¦æ–‡ä»¶ï¼Œä»¥é˜²æ­¢â€œè¯¯åˆ â€çš„åŠŸèƒ½ã€‚å…¶åŸå› å¦‚ä¸Šæ‰€è¿°ï¼Œå› ä¸ºå¯¹åº”è¯¥ç›®å½•çš„ç´¢å¼•èŠ‚ç‚¹æœ‰ä¸€ä¸ªä»¥ä¸Šçš„è¿æ¥ã€‚åªåˆ é™¤ä¸€ä¸ªè¿æ¥å¹¶ä¸å½±å“ç´¢å¼•èŠ‚ç‚¹æœ¬èº«å’Œå…¶å®ƒçš„è¿æ¥ï¼Œåªæœ‰å½“æœ€åä¸€ä¸ªè¿æ¥è¢«åˆ é™¤åï¼Œæ–‡ä»¶çš„æ•°æ®å—åŠç›®å½•çš„è¿æ¥æ‰ä¼šè¢«é‡Šæ”¾ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ–‡ä»¶çœŸæ­£åˆ é™¤çš„æ¡ä»¶æ˜¯ä¸ä¹‹ç›¸å…³çš„æ‰€æœ‰ç¡¬è¿æ¥æ–‡ä»¶å‡è¢«åˆ é™¤ã€‚</p><p>ã€è½¯è¿æ¥ã€‘<br>å¦å¤–ä¸€ç§è¿æ¥ç§°ä¹‹ä¸ºç¬¦å·è¿æ¥ï¼ˆSymbolic Linkï¼‰ï¼Œä¹Ÿå«è½¯è¿æ¥ã€‚è½¯é“¾æ¥æ–‡ä»¶æœ‰ç±»ä¼¼äºWindowsçš„å¿«æ·æ–¹å¼ã€‚å®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ–‡ä»¶ã€‚åœ¨ç¬¦å·è¿æ¥ä¸­ï¼Œæ–‡ä»¶å®é™…ä¸Šæ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«çš„æœ‰å¦ä¸€æ–‡ä»¶çš„ä½ç½®ä¿¡æ¯ã€‚</p><p><strong>ä½¿ç”¨æ–¹å¼</strong></p><p>åˆ›å»ºè½¯é“¾æ¥</p><p>ln  -s [æºæ–‡ä»¶æˆ–ç›®å½•] [ç›®æ ‡æ–‡ä»¶æˆ–ç›®å½•]</p><p>ä¾‹ï¼š</p><p>å½“å‰è·¯å¾„åˆ›å»ºtest å¼•å‘/var/www/test æ–‡ä»¶å¤¹ </p><pre class="line-numbers language-shell"><code class="language-shell">ln â€“s /var/www/test test<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åˆ›å»º/var/test å¼•å‘/var/www/test æ–‡ä»¶å¤¹ </p><pre class="line-numbers language-shell"><code class="language-shell">ln â€“s /var/www/test /var/test<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åˆ é™¤è½¯é“¾æ¥</p><p>å’Œåˆ é™¤æ™®é€šçš„æ–‡ä»¶æ˜¯ä¸€æ ·çš„ï¼Œåˆ é™¤éƒ½æ˜¯ä½¿ç”¨rmæ¥è¿›è¡Œæ“ä½œ</p><p>ä¾‹ï¼š</p><p>åˆ é™¤test</p><pre class="line-numbers language-shell"><code class="language-shell">rm â€“rf test<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¿®æ”¹è½¯é“¾æ¥</p><p>ln â€“snf  [æ–°çš„æºæ–‡ä»¶æˆ–ç›®å½•] [ç›®æ ‡æ–‡ä»¶æˆ–ç›®å½•]</p><p>è¿™å°†ä¼šä¿®æ”¹åŸæœ‰çš„é“¾æ¥åœ°å€ä¸ºæ–°çš„åœ°å€</p><p>ä¾‹å¦‚ï¼š</p><p>åˆ›å»ºä¸€ä¸ªè½¯é“¾æ¥</p><pre class="line-numbers language-shell"><code class="language-shell">ln â€“s /var/www/test /var/test<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¿®æ”¹æŒ‡å‘çš„æ–°è·¯å¾„</p><pre class="line-numbers language-shell"><code class="language-shell">ln â€“snf /var/www/test1 /var/test<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>å¸¸ç”¨å‚æ•°ï¼š</strong></p><pre class="line-numbers language-shell"><code class="language-shell">ã€€ã€€-f : é“¾ç»“æ—¶å…ˆå°†ä¸ dist åŒæ¡£åçš„æ¡£æ¡ˆåˆ é™¤ã€€ã€€-d : å…è®¸ç³»ç»Ÿç®¡ç†è€…ç¡¬é“¾ç»“è‡ªå·±çš„ç›®å½•ã€€ã€€-i : åœ¨åˆ é™¤ä¸ dist åŒæ¡£åçš„æ¡£æ¡ˆæ—¶å…ˆè¿›è¡Œè¯¢é—®ã€€ã€€-n : åœ¨è¿›è¡Œè½¯è¿ç»“æ—¶ï¼Œå°† dist è§†ä¸ºä¸€èˆ¬çš„æ¡£æ¡ˆã€€ã€€-s : è¿›è¡Œè½¯é“¾ç»“(symbolic link)ã€€ã€€-v : åœ¨è¿ç»“ä¹‹å‰æ˜¾ç¤ºå…¶æ¡£åã€€ã€€-b : å°†åœ¨é“¾ç»“æ—¶ä¼šè¢«è¦†å†™æˆ–åˆ é™¤çš„æ¡£æ¡ˆè¿›è¡Œå¤‡ä»½ã€€ã€€-S SUFFIX : å°†å¤‡ä»½çš„æ¡£æ¡ˆéƒ½åŠ ä¸Š SUFFIX çš„å­—å°¾ã€€ã€€-V METHOD : æŒ‡å®šå¤‡ä»½çš„æ–¹å¼ã€€ã€€--help : æ˜¾ç¤ºè¾…åŠ©è¯´æ˜ã€€ã€€--version : æ˜¾ç¤ºç‰ˆæœ¬<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å¥½ç”¨çš„Linuxç»ˆç«¯shell"><a href="#å¥½ç”¨çš„Linuxç»ˆç«¯shell" class="headerlink" title="å¥½ç”¨çš„Linuxç»ˆç«¯shell"></a>å¥½ç”¨çš„Linuxç»ˆç«¯shell</h2><p>æœ€è¿‘æ‰¾äº†å‡ æ¬¾æ¯”è¾ƒä¼˜ç§€çš„terminalï¼š<br>ä¸€æ¬¾æ˜¯å¾®è½¯è‡ªå®¶çš„Terminus:<br>ä¸‹è½½åœ°å€ï¼š<a href="https://www.termius.com/windows" target="_blank" rel="noopener">https://www.termius.com/windows</a><br>ç®€å•é…ç½®æ•™ç¨‹ï¼š<a href="https://zhuanlan.zhihu.com/p/105025848" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/105025848</a><br>æ„Ÿè§‰è¿˜å¯ä»¥ï¼Œä¸è¿‡è®¸å¤šæ˜¯ä»˜è´¹çš„åŠŸèƒ½ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘è¿˜æ‰¾åˆ°å¦ä¸€æ¬¾ï¼š<br><a href="https://github.com/Eugeny/tabby" target="_blank" rel="noopener">https://github.com/Eugeny/tabby</a><br>ä¸è¿‡è¿™ä¸€æ¬¾æ²¡æœ‰ftpåŠŸèƒ½ï¼Œå…è´¹çš„æ€»æ˜¯ï¼Œå”‰ã€‚</p><h2 id="tmuxä¸€äº›ç®€å•åº”ç”¨"><a href="#tmuxä¸€äº›ç®€å•åº”ç”¨" class="headerlink" title="tmuxä¸€äº›ç®€å•åº”ç”¨"></a>tmuxä¸€äº›ç®€å•åº”ç”¨</h2><p>æ¥ä¸‹æ¥äº†è§£ä¸€ä¸‹å…³äºtmuxçš„ä¸€äº›æ“ä½œã€‚<br>è¿™é‡Œæ˜¯ä¸€äº›å‚è€ƒé“¾æ¥ï¼š</p><ul><li><a href="https://www.ruanyifeng.com/blog/2019/10/tmux.html" target="_blank" rel="noopener">https://www.ruanyifeng.com/blog/2019/10/tmux.html</a></li><li><a href="https://zhuanlan.zhihu.com/p/43687973" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/43687973</a></li><li><a href="https://www.jianshu.com/p/c217318a9380" target="_blank" rel="noopener">https://www.jianshu.com/p/c217318a9380</a></li></ul><p>tmuxæ˜¯ä¸€æ¬¾ç»ˆç«¯å¤ç”¨å‘½ä»¤è¡Œå·¥å…·ï¼Œä¸€èˆ¬ç”¨äºTerminalçš„çª—å£ç®¡ç†ã€‚</p><p>å…³äºä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ç”¨Tmuxè¿™ä¸€ä»¶äº‹ï¼Œæˆ‘è®¤ä¸ºçŸ¥ä¹æœ‰ä¸€ä½ç”¨æˆ·è¯´çš„éå¸¸å¥½ï¼šä¸ºä»€ä¹ˆè¦ä½¿ç”¨ tmux ï¼Ÿ</p><p><em>å¾ˆå¤šå¼€å‘è€…ç»å¸¸ç™»å½•åˆ°æœåŠ¡å™¨éƒ½é‡åˆ°è¿™äº›å°´å°¬ï¼š</em></p><ul><li><em>æƒ³åŒæ—¶æ‰“å¼€å¤šä¸ªç›®å½•ä¸å¾—ä¸å¼€å¾ˆå¤šç»ˆç«¯æ ‡ç­¾æ¥å›åˆ‡æ¢</em></li><li><em>å¼€äº†ä¸€ä¸ª vim çª—å£ä¹‹åï¼Œæƒ³åˆ‡åˆ°å…¶ä»–ç›®å½•ä¸å¾—ä¸é‡æ–°æ‰“å¼€ä¸ªä¸€ä¸ªç»ˆç«¯çª—å£ ssh åˆ°æœåŠ¡å™¨</em></li><li><em>è¿è¡Œä¸€ä¸ªè„šæœ¬ï¼ŒæœåŠ¡å™¨æ–­æ‰å¤±è”ä¹‹åå½“å‰è¿›ç¨‹è¢«æœåŠ¡å™¨ç»™æ— æƒ…åœ°æ€æ‰ï¼Œä¸å¾—ä¸ç”¨ nohup ç­‰æ–¹å¼è®©è„šæœ¬åœ¨åå°è·‘</em></li><li><em>æ¯æ¬¡ ssh åˆ°æœåŠ¡å™¨éƒ½è¦é‡æ–°åˆ‡åˆ°å·¥ä½œç›®å½•ï¼Œæ‰“å¼€å¤šä¸ªè¿›ç¨‹ç­‰ï¼Œä¹‹å‰çš„å·¥ä½œè®°å½•ä¼šä¸¢å¤±</em></li><li><em>é¼ æ ‡æ˜¯ä¸ªä¼Ÿå¤§çš„å‘æ˜ï¼Œä½†ä¸å¹¸çš„æ˜¯ï¼Œå¼€å‘è€…ä½¿ç”¨ç»ˆç«¯çš„æ—¶å€™åœ¨é¼ æ ‡å’Œé”®ç›˜ä¹‹é—´æ¥å›ç§»åŠ¨å’Œå®šä½ï¼Œä¸ä»…æµªè´¹æ—¶é—´ï¼Œè¿˜å¯èƒ½ä¼šå½±å“ä½ çš„æ€è·¯</em></li><li><em>â€¦â€¦</em></li></ul><p><em>ä»Šå¤©ä»‹ç»çš„ tmux å¯ä»¥è¯´å¾ˆå¥½åœ°è§£å†³äº†è¿™äº›é—®é¢˜ï¼Œå¹¶ä¸”èƒ½å¤Ÿè§£æ”¾æˆ‘ä»¬çš„åŒæ‰‹ï¼Œåœ¨ç»ˆç«¯ä¸‹æ‘†è„±å¯¹é¼ æ ‡çš„ä¾èµ–ã€‚ä½¿ç”¨ tmux çš„ä¼šè¯åŠŸèƒ½å¯ä»¥ä¿ç•™å·¥ä½œåŒºï¼Œé‡æ–° ssh ä¹‹åå¿«é€Ÿæ¢å¤ä¸Šå»ï¼Œå·¥ä½œè®°å½•ä¸ä¼šä¸¢å¤±ã€‚(tmux å¯¹åº”çš„æ˜¯ screen ä¹‹ç±»çš„ç»ˆç«¯å¤ç”¨è½¯ä»¶ï¼Œå’Œ iterm2/sourceCRT ä¸æ˜¯ä¸€ç±»è½¯ä»¶ï¼‰</em></p><p>å°è¯•ç”¨äº†ç”¨ï¼Œæ„Ÿè§‰ç¡®å®éå¸¸ä¸é”™ï¼Œæœ¬äººç”¨å¾—æ„Ÿè§‰éå¸¸èˆ’æœï¼Œç”¨æ³•ç®€ä»‹å°±æŠ„è¢­ä¸€ä¸‹é˜®ä¸€å³°å¤§ä½¬çš„æ–‡ç« ï¼Œå¤§å®¶å¯ä»¥å»ä»–æœ¬äººåšå®¢çœ‹ä½“éªŒæˆ–è®¸æ›´ä½³ï¼š<br><a href="https://www.ruanyifeng.com/blog/2019/10/tmux.html" target="_blank" rel="noopener">https://www.ruanyifeng.com/blog/2019/10/tmux.html</a><br>ä¸€ã€Tmux æ˜¯ä»€ä¹ˆï¼Ÿ<br>1.1 ä¼šè¯ä¸è¿›ç¨‹<br>å‘½ä»¤è¡Œçš„å…¸å‹ä½¿ç”¨æ–¹å¼æ˜¯ï¼Œæ‰“å¼€ä¸€ä¸ªç»ˆç«¯çª—å£ï¼ˆterminal windowï¼Œä»¥ä¸‹ç®€ç§°â€çª—å£â€ï¼‰ï¼Œåœ¨é‡Œé¢è¾“å…¥å‘½ä»¤ã€‚ç”¨æˆ·ä¸è®¡ç®—æœºçš„è¿™ç§ä¸´æ—¶çš„äº¤äº’ï¼Œç§°ä¸ºä¸€æ¬¡â€ä¼šè¯â€ï¼ˆsessionï¼‰ ã€‚</p><p>ä¼šè¯çš„ä¸€ä¸ªé‡è¦ç‰¹ç‚¹æ˜¯ï¼Œçª—å£ä¸å…¶ä¸­å¯åŠ¨çš„è¿›ç¨‹æ˜¯è¿åœ¨ä¸€èµ·çš„ã€‚æ‰“å¼€çª—å£ï¼Œä¼šè¯å¼€å§‹ï¼›å…³é—­çª—å£ï¼Œä¼šè¯ç»“æŸï¼Œä¼šè¯å†…éƒ¨çš„è¿›ç¨‹ä¹Ÿä¼šéšä¹‹ç»ˆæ­¢ï¼Œä¸ç®¡æœ‰æ²¡æœ‰è¿è¡Œå®Œã€‚</p><p>ä¸€ä¸ªå…¸å‹çš„ä¾‹å­å°±æ˜¯ï¼ŒSSH ç™»å½•è¿œç¨‹è®¡ç®—æœºï¼Œæ‰“å¼€ä¸€ä¸ªè¿œç¨‹çª—å£æ‰§è¡Œå‘½ä»¤ã€‚è¿™æ—¶ï¼Œç½‘ç»œçªç„¶æ–­çº¿ï¼Œå†æ¬¡ç™»å½•çš„æ—¶å€™ï¼Œæ˜¯æ‰¾ä¸å›ä¸Šä¸€æ¬¡æ‰§è¡Œçš„å‘½ä»¤çš„ã€‚å› ä¸ºä¸Šä¸€æ¬¡ SSH ä¼šè¯å·²ç»ç»ˆæ­¢äº†ï¼Œé‡Œé¢çš„è¿›ç¨‹ä¹Ÿéšä¹‹æ¶ˆå¤±äº†ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¼šè¯ä¸çª—å£å¯ä»¥â€è§£ç»‘â€ï¼šçª—å£å…³é—­æ—¶ï¼Œä¼šè¯å¹¶ä¸ç»ˆæ­¢ï¼Œè€Œæ˜¯ç»§ç»­è¿è¡Œï¼Œç­‰åˆ°ä»¥åéœ€è¦çš„æ—¶å€™ï¼Œå†è®©ä¼šè¯â€ç»‘å®šâ€å…¶ä»–çª—å£ã€‚</p><p>1.2 Tmux çš„ä½œç”¨<br>Tmux å°±æ˜¯ä¼šè¯ä¸çª—å£çš„â€è§£ç»‘â€å·¥å…·ï¼Œå°†å®ƒä»¬å½»åº•åˆ†ç¦»ã€‚</p><p>ï¼ˆ1ï¼‰å®ƒå…è®¸åœ¨å•ä¸ªçª—å£ä¸­ï¼ŒåŒæ—¶è®¿é—®å¤šä¸ªä¼šè¯ã€‚è¿™å¯¹äºåŒæ—¶è¿è¡Œå¤šä¸ªå‘½ä»¤è¡Œç¨‹åºå¾ˆæœ‰ç”¨ã€‚</p><p>ï¼ˆ2ï¼‰ å®ƒå¯ä»¥è®©æ–°çª—å£â€æ¥å…¥â€å·²ç»å­˜åœ¨çš„ä¼šè¯ã€‚</p><p>ï¼ˆ3ï¼‰å®ƒå…è®¸æ¯ä¸ªä¼šè¯æœ‰å¤šä¸ªè¿æ¥çª—å£ï¼Œå› æ­¤å¯ä»¥å¤šäººå®æ—¶å…±äº«ä¼šè¯ã€‚</p><p>ï¼ˆ4ï¼‰å®ƒè¿˜æ”¯æŒçª—å£ä»»æ„çš„å‚ç›´å’Œæ°´å¹³æ‹†åˆ†ã€‚</p><p>ç±»ä¼¼çš„ç»ˆç«¯å¤ç”¨å™¨è¿˜æœ‰ GNU Screenã€‚Tmux ä¸å®ƒåŠŸèƒ½ç›¸ä¼¼ï¼Œä½†æ˜¯æ›´æ˜“ç”¨ï¼Œä¹Ÿæ›´å¼ºå¤§ã€‚</p><p>äºŒã€åŸºæœ¬ç”¨æ³•<br>2.1 å®‰è£…<br>Tmux ä¸€èˆ¬éœ€è¦è‡ªå·±å®‰è£…ã€‚</p><p>** Ubuntu æˆ– Debian**<br>$ sudo apt-get install tmux</p><p><strong>CentOS æˆ– Fedora</strong></p><p>$ sudo yum install tmux</p><p>Mac</p><p>$ brew install tmux<br>2.2 å¯åŠ¨ä¸é€€å‡º<br>å®‰è£…å®Œæˆåï¼Œé”®å…¥tmuxå‘½ä»¤ï¼Œå°±è¿›å…¥äº† Tmux çª—å£ã€‚</p><p>$ tmux<br>ä¸Šé¢å‘½ä»¤ä¼šå¯åŠ¨ Tmux çª—å£ï¼Œåº•éƒ¨æœ‰ä¸€ä¸ªçŠ¶æ€æ ã€‚çŠ¶æ€æ çš„å·¦ä¾§æ˜¯çª—å£ä¿¡æ¯ï¼ˆç¼–å·å’Œåç§°ï¼‰ï¼Œå³ä¾§æ˜¯ç³»ç»Ÿä¿¡æ¯ã€‚</p><p>æŒ‰ä¸‹Ctrl+dæˆ–è€…æ˜¾å¼è¾“å…¥exitå‘½ä»¤ï¼Œå°±å¯ä»¥é€€å‡º Tmux çª—å£ã€‚</p><p>$ exit<br>2.3 å‰ç¼€é”®<br>Tmux çª—å£æœ‰å¤§é‡çš„å¿«æ·é”®ã€‚æ‰€æœ‰å¿«æ·é”®éƒ½è¦é€šè¿‡å‰ç¼€é”®å”¤èµ·ã€‚é»˜è®¤çš„å‰ç¼€é”®æ˜¯Ctrl+bï¼Œå³å…ˆæŒ‰ä¸‹Ctrl+bï¼Œå¿«æ·é”®æ‰ä¼šç”Ÿæ•ˆã€‚</p><p>ä¸¾ä¾‹æ¥è¯´ï¼Œå¸®åŠ©å‘½ä»¤çš„å¿«æ·é”®æ˜¯Ctrl+b ?ã€‚å®ƒçš„ç”¨æ³•æ˜¯ï¼Œåœ¨ Tmux çª—å£ä¸­ï¼Œå…ˆæŒ‰ä¸‹Ctrl+bï¼Œå†æŒ‰ä¸‹?ï¼Œå°±ä¼šæ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ã€‚</p><p>ç„¶åï¼ŒæŒ‰ä¸‹ ESC é”®æˆ–qé”®ï¼Œå°±å¯ä»¥é€€å‡ºå¸®åŠ©ã€‚</p><p>ä¸‰ã€ä¼šè¯ç®¡ç†<br>3.1 æ–°å»ºä¼šè¯<br>ç¬¬ä¸€ä¸ªå¯åŠ¨çš„ Tmux çª—å£ï¼Œç¼–å·æ˜¯0ï¼Œç¬¬äºŒä¸ªçª—å£çš„ç¼–å·æ˜¯1ï¼Œä»¥æ­¤ç±»æ¨ã€‚è¿™äº›çª—å£å¯¹åº”çš„ä¼šè¯ï¼Œå°±æ˜¯ 0 å·ä¼šè¯ã€1 å·ä¼šè¯ã€‚</p><p>ä½¿ç”¨ç¼–å·åŒºåˆ†ä¼šè¯ï¼Œä¸å¤ªç›´è§‚ï¼Œæ›´å¥½çš„æ–¹æ³•æ˜¯ä¸ºä¼šè¯èµ·åã€‚</p><p>$ tmux new -s <session-name><br>ä¸Šé¢å‘½ä»¤æ–°å»ºä¸€ä¸ªæŒ‡å®šåç§°çš„ä¼šè¯ã€‚</session-name></p><p>3.2 åˆ†ç¦»ä¼šè¯<br>åœ¨ Tmux çª—å£ä¸­ï¼ŒæŒ‰ä¸‹Ctrl+b dæˆ–è€…è¾“å…¥tmux detachå‘½ä»¤ï¼Œå°±ä¼šå°†å½“å‰ä¼šè¯ä¸çª—å£åˆ†ç¦»ã€‚</p><p>$ tmux detach<br>ä¸Šé¢å‘½ä»¤æ‰§è¡Œåï¼Œå°±ä¼šé€€å‡ºå½“å‰ Tmux çª—å£ï¼Œä½†æ˜¯ä¼šè¯å’Œé‡Œé¢çš„è¿›ç¨‹ä»ç„¶åœ¨åå°è¿è¡Œã€‚</p><p>tmux lså‘½ä»¤å¯ä»¥æŸ¥çœ‹å½“å‰æ‰€æœ‰çš„ Tmux ä¼šè¯ã€‚</p><p>$ tmux ls</p><p>or</p><p>$ tmux list-session<br>3.3 æ¥å…¥ä¼šè¯<br>tmux attachå‘½ä»¤ç”¨äºé‡æ–°æ¥å…¥æŸä¸ªå·²å­˜åœ¨çš„ä¼šè¯ã€‚</p><p>ä½¿ç”¨ä¼šè¯ç¼–å·</p><p>$ tmux attach -t 0</p><p>ä½¿ç”¨ä¼šè¯åç§°</p><p>$ tmux attach -t <session-name><br>3.4 æ€æ­»ä¼šè¯<br>tmux kill-sessionå‘½ä»¤ç”¨äºæ€æ­»æŸä¸ªä¼šè¯ã€‚</session-name></p><p>ä½¿ç”¨ä¼šè¯ç¼–å·</p><p>$ tmux kill-session -t 0</p><p>ä½¿ç”¨ä¼šè¯åç§°</p><p>$ tmux kill-session -t <session-name><br>3.5 åˆ‡æ¢ä¼šè¯<br>tmux switchå‘½ä»¤ç”¨äºåˆ‡æ¢ä¼šè¯ã€‚</session-name></p><p>ä½¿ç”¨ä¼šè¯ç¼–å·</p><p>$ tmux switch -t 0</p><p>ä½¿ç”¨ä¼šè¯åç§°</p><p>$ tmux switch -t <session-name><br>3.6 é‡å‘½åä¼šè¯<br>tmux rename-sessionå‘½ä»¤ç”¨äºé‡å‘½åä¼šè¯ã€‚</session-name></p><p>$ tmux rename-session -t 0 <new-name><br>ä¸Šé¢å‘½ä»¤å°†0å·ä¼šè¯é‡å‘½åã€‚</new-name></p><p>3.7 ä¼šè¯å¿«æ·é”®<br>ä¸‹é¢æ˜¯ä¸€äº›ä¼šè¯ç›¸å…³çš„å¿«æ·é”®ã€‚</p><p>Ctrl+b dï¼šåˆ†ç¦»å½“å‰ä¼šè¯ã€‚<br>Ctrl+b sï¼šåˆ—å‡ºæ‰€æœ‰ä¼šè¯ã€‚<br>Ctrl+b $ï¼šé‡å‘½åå½“å‰ä¼šè¯ã€‚<br>å››ã€æœ€ç®€æ“ä½œæµç¨‹<br>ç»¼ä¸Šæ‰€è¿°ï¼Œä»¥ä¸‹æ˜¯ Tmux çš„æœ€ç®€æ“ä½œæµç¨‹ã€‚</p><p>æ–°å»ºä¼šè¯tmux new -s my_sessionã€‚<br>åœ¨ Tmux çª—å£è¿è¡Œæ‰€éœ€çš„ç¨‹åºã€‚<br>æŒ‰ä¸‹å¿«æ·é”®Ctrl+b då°†ä¼šè¯åˆ†ç¦»ã€‚<br>ä¸‹æ¬¡ä½¿ç”¨æ—¶ï¼Œé‡æ–°è¿æ¥åˆ°ä¼šè¯tmux attach-session -t my_sessionã€‚<br>äº”ã€çª—æ ¼æ“ä½œ<br>Tmux å¯ä»¥å°†çª—å£åˆ†æˆå¤šä¸ªçª—æ ¼ï¼ˆpaneï¼‰ï¼Œæ¯ä¸ªçª—æ ¼è¿è¡Œä¸åŒçš„å‘½ä»¤ã€‚ä»¥ä¸‹å‘½ä»¤éƒ½æ˜¯åœ¨ Tmux çª—å£ä¸­æ‰§è¡Œã€‚</p><p>5.1 åˆ’åˆ†çª—æ ¼<br>tmux split-windowå‘½ä»¤ç”¨æ¥åˆ’åˆ†çª—æ ¼ã€‚</p><p>åˆ’åˆ†ä¸Šä¸‹ä¸¤ä¸ªçª—æ ¼</p><p>$ tmux split-window</p><p>åˆ’åˆ†å·¦å³ä¸¤ä¸ªçª—æ ¼</p><p>$ tmux split-window -h</p><p>5.2 ç§»åŠ¨å…‰æ ‡<br>tmux select-paneå‘½ä»¤ç”¨æ¥ç§»åŠ¨å…‰æ ‡ä½ç½®ã€‚</p><p>å…‰æ ‡åˆ‡æ¢åˆ°ä¸Šæ–¹çª—æ ¼</p><p>$ tmux select-pane -U</p><p>å…‰æ ‡åˆ‡æ¢åˆ°ä¸‹æ–¹çª—æ ¼</p><p>$ tmux select-pane -D</p><p>å…‰æ ‡åˆ‡æ¢åˆ°å·¦è¾¹çª—æ ¼</p><p>$ tmux select-pane -L</p><p>å…‰æ ‡åˆ‡æ¢åˆ°å³è¾¹çª—æ ¼</p><p>$ tmux select-pane -R<br>5.3 äº¤æ¢çª—æ ¼ä½ç½®<br>tmux swap-paneå‘½ä»¤ç”¨æ¥äº¤æ¢çª—æ ¼ä½ç½®ã€‚</p><p>å½“å‰çª—æ ¼ä¸Šç§»</p><p>$ tmux swap-pane -U</p><p>å½“å‰çª—æ ¼ä¸‹ç§»</p><p>$ tmux swap-pane -D<br>5.4 çª—æ ¼å¿«æ·é”®<br>ä¸‹é¢æ˜¯ä¸€äº›çª—æ ¼æ“ä½œçš„å¿«æ·é”®ã€‚</p><p>Ctrl+b %ï¼šåˆ’åˆ†å·¦å³ä¸¤ä¸ªçª—æ ¼ã€‚<br>Ctrl+b â€œï¼šåˆ’åˆ†ä¸Šä¸‹ä¸¤ä¸ªçª—æ ¼ã€‚<br>Ctrl+b <arrow key>ï¼šå…‰æ ‡åˆ‡æ¢åˆ°å…¶ä»–çª—æ ¼ã€‚<arrow key>æ˜¯æŒ‡å‘è¦åˆ‡æ¢åˆ°çš„çª—æ ¼çš„æ–¹å‘é”®ï¼Œæ¯”å¦‚åˆ‡æ¢åˆ°ä¸‹æ–¹çª—æ ¼ï¼Œå°±æŒ‰æ–¹å‘é”®â†“ã€‚<br>Ctrl+b ;ï¼šå…‰æ ‡åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªçª—æ ¼ã€‚<br>Ctrl+b oï¼šå…‰æ ‡åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªçª—æ ¼ã€‚<br>Ctrl+b {ï¼šå½“å‰çª—æ ¼ä¸ä¸Šä¸€ä¸ªçª—æ ¼äº¤æ¢ä½ç½®ã€‚<br>Ctrl+b }ï¼šå½“å‰çª—æ ¼ä¸ä¸‹ä¸€ä¸ªçª—æ ¼äº¤æ¢ä½ç½®ã€‚<br>Ctrl+b Ctrl+oï¼šæ‰€æœ‰çª—æ ¼å‘å‰ç§»åŠ¨ä¸€ä¸ªä½ç½®ï¼Œç¬¬ä¸€ä¸ªçª—æ ¼å˜æˆæœ€åä¸€ä¸ªçª—æ ¼ã€‚<br>Ctrl+b Alt+oï¼šæ‰€æœ‰çª—æ ¼å‘åç§»åŠ¨ä¸€ä¸ªä½ç½®ï¼Œæœ€åä¸€ä¸ªçª—æ ¼å˜æˆç¬¬ä¸€ä¸ªçª—æ ¼ã€‚<br>Ctrl+b xï¼šå…³é—­å½“å‰çª—æ ¼ã€‚<br>Ctrl+b !ï¼šå°†å½“å‰çª—æ ¼æ‹†åˆ†ä¸ºä¸€ä¸ªç‹¬ç«‹çª—å£ã€‚<br>Ctrl+b zï¼šå½“å‰çª—æ ¼å…¨å±æ˜¾ç¤ºï¼Œå†ä½¿ç”¨ä¸€æ¬¡ä¼šå˜å›åŸæ¥å¤§å°ã€‚<br>Ctrl+b Ctrl+<arrow key>ï¼šæŒ‰ç®­å¤´æ–¹å‘è°ƒæ•´çª—æ ¼å¤§å°ã€‚<br>Ctrl+b qï¼šæ˜¾ç¤ºçª—æ ¼ç¼–å·ã€‚<br>å…­ã€çª—å£ç®¡ç†<br>é™¤äº†å°†ä¸€ä¸ªçª—å£åˆ’åˆ†æˆå¤šä¸ªçª—æ ¼ï¼ŒTmux ä¹Ÿå…è®¸æ–°å»ºå¤šä¸ªçª—å£ã€‚</arrow></arrow></arrow></p><p>6.1 æ–°å»ºçª—å£<br>tmux new-windowå‘½ä»¤ç”¨æ¥åˆ›å»ºæ–°çª—å£ã€‚</p><p>$ tmux new-window</p><p>æ–°å»ºä¸€ä¸ªæŒ‡å®šåç§°çš„çª—å£</p><p>$ tmux new-window -n <window-name><br>6.2 åˆ‡æ¢çª—å£<br>tmux select-windowå‘½ä»¤ç”¨æ¥åˆ‡æ¢çª—å£ã€‚</window-name></p><p>åˆ‡æ¢åˆ°æŒ‡å®šç¼–å·çš„çª—å£</p><p>$ tmux select-window -t <window-number></window-number></p><p>åˆ‡æ¢åˆ°æŒ‡å®šåç§°çš„çª—å£</p><p>$ tmux select-window -t <window-name><br>6.3 é‡å‘½åçª—å£<br>tmux rename-windowå‘½ä»¤ç”¨äºä¸ºå½“å‰çª—å£èµ·åï¼ˆæˆ–é‡å‘½åï¼‰ã€‚</window-name></p><p>$ tmux rename-window <new-name><br>6.4 çª—å£å¿«æ·é”®<br>ä¸‹é¢æ˜¯ä¸€äº›çª—å£æ“ä½œçš„å¿«æ·é”®ã€‚</new-name></p><p>Ctrl+b cï¼šåˆ›å»ºä¸€ä¸ªæ–°çª—å£ï¼ŒçŠ¶æ€æ ä¼šæ˜¾ç¤ºå¤šä¸ªçª—å£çš„ä¿¡æ¯ã€‚<br>Ctrl+b pï¼šåˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªçª—å£ï¼ˆæŒ‰ç…§çŠ¶æ€æ ä¸Šçš„é¡ºåºï¼‰ã€‚<br>Ctrl+b nï¼šåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªçª—å£ã€‚<br>Ctrl+b <number>ï¼šåˆ‡æ¢åˆ°æŒ‡å®šç¼–å·çš„çª—å£ï¼Œå…¶ä¸­çš„<number>æ˜¯çŠ¶æ€æ ä¸Šçš„çª—å£ç¼–å·ã€‚<br>Ctrl+b wï¼šä»åˆ—è¡¨ä¸­é€‰æ‹©çª—å£ã€‚<br>Ctrl+b ,ï¼šçª—å£é‡å‘½åã€‚<br>ä¸ƒã€å…¶ä»–å‘½ä»¤<br>ä¸‹é¢æ˜¯ä¸€äº›å…¶ä»–å‘½ä»¤ã€‚</number></number></p><p>åˆ—å‡ºæ‰€æœ‰å¿«æ·é”®ï¼ŒåŠå…¶å¯¹åº”çš„ Tmux å‘½ä»¤</p><p>$ tmux list-keys</p><p>åˆ—å‡ºæ‰€æœ‰ Tmux å‘½ä»¤åŠå…¶å‚æ•°</p><p>$ tmux list-commands</p><p>åˆ—å‡ºå½“å‰æ‰€æœ‰ Tmux ä¼šè¯çš„ä¿¡æ¯</p><p>$ tmux info</p><p>é‡æ–°åŠ è½½å½“å‰çš„ Tmux é…ç½®</p><p>$ tmux source-file ~/.tmux.conf</p><h2 id="å…³äºè®­ç»ƒæ—¶å®æ—¶æŸ¥çœ‹GPUä½¿ç”¨æƒ…å†µ"><a href="#å…³äºè®­ç»ƒæ—¶å®æ—¶æŸ¥çœ‹GPUä½¿ç”¨æƒ…å†µ" class="headerlink" title="å…³äºè®­ç»ƒæ—¶å®æ—¶æŸ¥çœ‹GPUä½¿ç”¨æƒ…å†µ"></a>å…³äºè®­ç»ƒæ—¶å®æ—¶æŸ¥çœ‹GPUä½¿ç”¨æƒ…å†µ</h2><p>å½“æ—¶è·‘æ•°æ®é›†çš„æ—¶å€™å‘è’‹ç»„é•¿å­¦åˆ°äº†ä¸€äº›å…³äºæ€ä¹ˆå®æ—¶ç›‘æ§æ˜¾å¡ä»¥åŠæ€ä¹ˆæŒ‡å®šå•å¡è®­ç»ƒçš„æ–¹æ³•ï¼š</p><p>æŒ‡å®šç›‘æ§å•å¡è®­ç»ƒï¼Œå®é™…ä¸Šåªéœ€è¦åœ¨æˆ‘ä»¬çš„pythonå‘½ä»¤å‰é¢è¾“å…¥ä¸€ä¸ª<code>CUDA_VISIBLE=1</code>ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">CUDA_VISIBLE_DEVICES=1 python tools/test.py configs/fenghuo/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_fenghuo.py work_dirs/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_fenghuo/latest.pth  --eval bbox segm<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å…³äº<code>CUDA_VISIBLE_DEVICES=1</code>ä»€ä¹ˆæ„æ€ï¼Œç›®å‰è¿˜ä¸æ˜¯éå¸¸æ¸…æ¥šï¼Œç­‰åˆ°ä¹‹åæ…¢æ…¢æ¥çœ‹<a href="https://www.jianshu.com/p/0816c3a5fa5c" target="_blank" rel="noopener">https://www.jianshu.com/p/0816c3a5fa5c</a></p><blockquote><p>2021.12.3å·æ¥è€ƒå¤ï¼Œç°åœ¨çŸ¥é“äº†ï¼Œè¿™ä¸ªæ„æ€æ˜¯ä½¿ç”¨CUDAï¼š1ï¼Œæœ‰æ—¶å€™è¦ä½¿ç”¨å¤šå¼ å¡å¹¶è¡Œå¯ä»¥é€‰æ‹©ä½¿ç”¨é€—å·åˆ†å¼€ä¸¤å¼ å¡ï¼Œä¾‹å¦‚ï¼šCUDA_VISIBLE_DEVICES=1, 2</p></blockquote><p>è¿™æ ·åšä¹‹åæ¨¡å‹ä¼šè¿›è¡Œå•å¡è®­ç»ƒï¼Œå¦å¤–å½“æˆ‘ä»¬è¦è¿›è¡Œå®æ—¶ç›‘æ§æ˜¾å­˜å’Œè¿›ç¨‹ç›¸å…³ä½¿ç”¨çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨<code>watch</code>å‘½ä»¤ï¼Œæ¯”å¦‚è¯´ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p><pre class="line-numbers language-python"><code class="language-python">watch <span class="token operator">-</span>n <span class="token number">1</span> nvidia<span class="token operator">-</span>smi<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™ä¸ªä»£è¡¨æ¯ä¸€ç§’åˆ·æ–°ä¸€æ¬¡æ˜¾å¡ä½¿ç”¨æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹æ£€æµ‹ç»“æœï¼š<br><a href="https://imagelol.com/image/Ixor6p" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://s6.jpg.cm/2021/11/17/Ixor6p.png" alt></a></p><p>æœ€ä¸‹é¢æ˜¯ç›¸å…³è¿›ç¨‹ä½¿ç”¨æƒ…å†µã€‚</p><p>å¦å¤–æ˜¯å…³äºwatchçš„ä¸€äº›å‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨man watchæ¥äº†è§£ã€‚</p><h2 id="æŸ¥çœ‹å„æ–‡ä»¶ç£ç›˜å ç”¨ã€å„æ–‡ä»¶å¤§å°"><a href="#æŸ¥çœ‹å„æ–‡ä»¶ç£ç›˜å ç”¨ã€å„æ–‡ä»¶å¤§å°" class="headerlink" title="æŸ¥çœ‹å„æ–‡ä»¶ç£ç›˜å ç”¨ã€å„æ–‡ä»¶å¤§å°"></a>æŸ¥çœ‹å„æ–‡ä»¶ç£ç›˜å ç”¨ã€å„æ–‡ä»¶å¤§å°</h2><blockquote><p><a href="https://blog.csdn.net/ouyang_peng/article/details/10414499" target="_blank" rel="noopener">https://blog.csdn.net/ouyang_peng/article/details/10414499</a></p></blockquote><p>å¿«è¯»ä½¿ç”¨ï¼š</p><pre class="line-numbers language-python"><code class="language-python">du <span class="token operator">-</span>h <span class="token operator">-</span><span class="token operator">-</span>max<span class="token operator">-</span>depth<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">/</span>data<span class="token operator">/</span>home<span class="token operator">/</span> <span class="token comment" spellcheck="true"># è¿™ä¸ªæ˜¯æŒ‡å®šæŸæ–‡ä»¶å¤¹</span>du <span class="token operator">-</span>h <span class="token operator">-</span><span class="token operator">-</span>max<span class="token operator">-</span>depth<span class="token operator">=</span><span class="token number">1</span>  <span class="token comment" spellcheck="true"># è¿™ä¸ªæ˜¯å½“å‰æ–‡ä»¶å¤¹</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>du [-abcDhHklmsSx] [-L &lt;ç¬¦å·è¿æ¥&gt;][-X &lt;æ–‡ä»¶&gt;][â€“block-size][â€“exclude=&lt;ç›®å½•æˆ–æ–‡ä»¶&gt;] [â€“max-depth=&lt;ç›®å½•å±‚æ•°&gt;][â€“help][â€“version][ç›®å½•æˆ–æ–‡ä»¶]<br>å¸¸ç”¨å‚æ•°ï¼š<br>-aæˆ–-all ä¸ºæ¯ä¸ªæŒ‡å®šæ–‡ä»¶æ˜¾ç¤ºç£ç›˜ä½¿ç”¨æƒ…å†µï¼Œæˆ–è€…ä¸ºç›®å½•ä¸­æ¯ä¸ªæ–‡ä»¶æ˜¾ç¤ºå„è‡ªç£ç›˜ä½¿ç”¨æƒ…å†µã€‚<br>-bæˆ–-bytes æ˜¾ç¤ºç›®å½•æˆ–æ–‡ä»¶å¤§å°æ—¶ï¼Œä»¥byteä¸ºå•ä½ã€‚<br>-cæˆ–â€“total é™¤äº†æ˜¾ç¤ºç›®å½•æˆ–æ–‡ä»¶çš„å¤§å°å¤–ï¼ŒåŒæ—¶ä¹Ÿæ˜¾ç¤ºæ‰€æœ‰ç›®å½•æˆ–æ–‡ä»¶çš„æ€»å’Œã€‚<br>-Dæˆ–â€“dereference-args æ˜¾ç¤ºæŒ‡å®šç¬¦å·è¿æ¥çš„æºæ–‡ä»¶å¤§å°ã€‚<br>-hæˆ–â€“human-readable ä»¥Kï¼ŒMï¼ŒGä¸ºå•ä½ï¼Œæé«˜ä¿¡æ¯çš„å¯è¯»æ€§ã€‚<br>-Hæˆ–â€“si ä¸-hå‚æ•°ç›¸åŒï¼Œä½†æ˜¯Kï¼ŒMï¼ŒGæ˜¯ä»¥1000ä¸ºæ¢ç®—å•ä½,è€Œä¸æ˜¯ä»¥1024ä¸ºæ¢ç®—å•ä½ã€‚<br>-kæˆ–â€“kilobytes ä»¥1024 bytesä¸ºå•ä½ã€‚<br>-læˆ–â€“count-links é‡å¤è®¡ç®—ç¡¬ä»¶è¿æ¥çš„æ–‡ä»¶ã€‚<br>-L&lt;ç¬¦å·è¿æ¥&gt;æˆ–â€“dereference&lt;ç¬¦å·è¿æ¥&gt; æ˜¾ç¤ºé€‰é¡¹ä¸­æ‰€æŒ‡å®šç¬¦å·è¿æ¥çš„æºæ–‡ä»¶å¤§å°ã€‚<br>-mæˆ–â€“megabytes ä»¥1MBä¸ºå•ä½ã€‚<br>-sæˆ–â€“summarize ä»…æ˜¾ç¤ºæ€»è®¡ï¼Œå³å½“å‰ç›®å½•çš„å¤§å°ã€‚<br>-Sæˆ–â€“separate-dirs æ˜¾ç¤ºæ¯ä¸ªç›®å½•çš„å¤§å°æ—¶ï¼Œå¹¶ä¸å«å…¶å­ç›®å½•çš„å¤§å°ã€‚<br>-xæˆ–â€“one-file-xystem ä»¥ä¸€å¼€å§‹å¤„ç†æ—¶çš„æ–‡ä»¶ç³»ç»Ÿä¸ºå‡†ï¼Œè‹¥é‡ä¸Šå…¶å®ƒä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿç›®å½•åˆ™ç•¥è¿‡ã€‚<br>-X&lt;æ–‡ä»¶&gt;æˆ–â€“exclude-from=&lt;æ–‡ä»¶&gt; åœ¨&lt;æ–‡ä»¶&gt;æŒ‡å®šç›®å½•æˆ–æ–‡ä»¶ã€‚<br>â€“exclude=&lt;ç›®å½•æˆ–æ–‡ä»¶&gt; ç•¥è¿‡æŒ‡å®šçš„ç›®å½•æˆ–æ–‡ä»¶ã€‚<br>â€“max-depth=&lt;ç›®å½•å±‚æ•°&gt; è¶…è¿‡æŒ‡å®šå±‚æ•°çš„ç›®å½•åï¼Œäºˆä»¥å¿½ç•¥ã€‚<br>â€“help æ˜¾ç¤ºå¸®åŠ©ã€‚<br>â€“version æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ã€‚</p><p>1&gt; è¦æ˜¾ç¤ºä¸€ä¸ªç›®å½•æ ‘åŠå…¶æ¯ä¸ªå­æ ‘çš„ç£ç›˜ä½¿ç”¨æƒ…å†µ<br>du /home/linux<br>è¿™åœ¨/home/linuxç›®å½•åŠå…¶æ¯ä¸ªå­ç›®å½•ä¸­æ˜¾ç¤ºäº†ç£ç›˜å—æ•°ã€‚</p><p>2&gt; è¦é€šè¿‡ä»¥1024å­—èŠ‚ä¸ºå•ä½æ˜¾ç¤ºä¸€ä¸ªç›®å½•æ ‘åŠå…¶æ¯ä¸ªå­æ ‘çš„ç£ç›˜ä½¿ç”¨æƒ…å†µ<br>du -k /home/linux<br>è¿™åœ¨/home/linuxç›®å½•åŠå…¶æ¯ä¸ªå­ç›®å½•ä¸­æ˜¾ç¤ºäº† 1024 å­—èŠ‚ç£ç›˜å—æ•°ã€‚</p><p>3&gt; ä»¥MBä¸ºå•ä½æ˜¾ç¤ºä¸€ä¸ªç›®å½•æ ‘åŠå…¶æ¯ä¸ªå­æ ‘çš„ç£ç›˜ä½¿ç”¨æƒ…å†µ<br>du -m /home/linux<br>è¿™åœ¨/home/linuxç›®å½•åŠå…¶æ¯ä¸ªå­ç›®å½•ä¸­æ˜¾ç¤ºäº† MB ç£ç›˜å—æ•°ã€‚</p><p>4&gt; ä»¥GBä¸ºå•ä½æ˜¾ç¤ºä¸€ä¸ªç›®å½•æ ‘åŠå…¶æ¯ä¸ªå­æ ‘çš„ç£ç›˜ä½¿ç”¨æƒ…å†µ<br>du -g /home/linux<br>è¿™åœ¨/home/linuxç›®å½•åŠå…¶æ¯ä¸ªå­ç›®å½•ä¸­æ˜¾ç¤ºäº† GB ç£ç›˜å—æ•°ã€‚</p><p>5&gt;æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ‰€æœ‰ç›®å½•ä»¥åŠå­ç›®å½•çš„å¤§å°ï¼š<br>du -h .<br>â€œ.â€ä»£è¡¨å½“å‰ç›®å½•ä¸‹ã€‚ä¹Ÿå¯ä»¥æ¢æˆä¸€ä¸ªæ˜ç¡®çš„è·¯å¾„<br>-hè¡¨ç¤ºç”¨Kã€Mã€Gçš„äººæ€§åŒ–å½¢å¼æ˜¾ç¤º</p><p>6&gt;æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹userç›®å½•çš„å¤§å°ï¼Œå¹¶ä¸æƒ³çœ‹å…¶ä»–ç›®å½•ä»¥åŠå…¶å­ç›®å½•ï¼š<br>du -sh user<br>-sè¡¨ç¤ºæ€»ç»“çš„æ„æ€ï¼Œå³åªåˆ—å‡ºä¸€ä¸ªæ€»ç»“çš„å€¼<br>du -h â€“max-depth=0 user<br>â€“max-depth=nè¡¨ç¤ºåªæ·±å…¥åˆ°ç¬¬nå±‚ç›®å½•ï¼Œæ­¤å¤„è®¾ç½®ä¸º0ï¼Œå³è¡¨ç¤ºä¸æ·±å…¥åˆ°å­ç›®å½•ã€‚</p><p>7&gt;åˆ—å‡ºuserç›®å½•åŠå…¶å­ç›®å½•ä¸‹æ‰€æœ‰ç›®å½•å’Œæ–‡ä»¶çš„å¤§å°ï¼š<br>du -ah user<br>-aè¡¨ç¤ºåŒ…æ‹¬ç›®å½•å’Œæ–‡ä»¶</p><p>8&gt;åˆ—å‡ºå½“å‰ç›®å½•ä¸­çš„ç›®å½•åä¸åŒ…æ‹¬xyzå­—ç¬¦ä¸²çš„ç›®å½•çš„å¤§å°ï¼š<br>du -h â€“exclude=â€™<em>xyz</em>â€˜</p><p>9&gt;æƒ³åœ¨ä¸€ä¸ªå±å¹•ä¸‹åˆ—å‡ºæ›´å¤šçš„å…³äºuserç›®å½•åŠå­ç›®å½•å¤§å°çš„ä¿¡æ¯ï¼š<br>du -0h user<br>-0ï¼ˆæ é›¶ï¼‰è¡¨ç¤ºæ¯åˆ—å‡ºä¸€ä¸ªç›®å½•çš„ä¿¡æ¯ï¼Œä¸æ¢è¡Œï¼Œè€Œæ˜¯ç›´æ¥è¾“å‡ºä¸‹ä¸€ä¸ªç›®å½•çš„ä¿¡æ¯ã€‚</p><p>10&gt;åªæ˜¾ç¤ºä¸€ä¸ªç›®å½•æ ‘çš„å…¨éƒ¨ç£ç›˜ä½¿ç”¨æƒ…å†µ<br>du -s /home/linux</p><p>11&gt;æŸ¥çœ‹å„æ–‡ä»¶å¤¹å¤§å°:du -h â€“max-depth=1</p><p>æŸ¥çœ‹æŒ‡å®šç›®å½•ï¼š<br>ä»£ç å¦‚ä¸‹ï¼š  å…¶ä¸­ /pathè¡¨ç¤ºè·¯å¾„<br>du -h â€“max-depth=1 /path<br>å…·ä½“å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p>root@ubuntu4146:~# du -h â€“max-depth=1 /data/<br>1.1G    /data/gitlabDataa<br>8.0K    /data/test<br>241G    /data/gitlabData<br>809G    /data/home<br>15G    /data/OpenGrok<br>16K    /data/lost+found<br>1.1T    /data/</p><pre><code>   æˆ‘ä»¬å‘ç°  /data/home/ ç›®å½•å ç”¨æœ€å¤šï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç»§ç»­çœ‹é‚£ä¸ªç›®å½•å ç”¨çš„æœ€å¤šï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</code></pre><p>root@ubuntu4146:/data/home# du -h â€“max-depth=1 /data/home/<br>141G    /data/home/wzm<br>62G    /data/home/lwc<br>421G    /data/home/hcy<br>16K    /data/home/zzp<br>16K    /data/home/zl<br>54G    /data/home/drj<br>122G    /data/home/sjq<br>4.1G    /data/home/ljs<br>6.7G    /data/home/ywm<br>809G    /data/home/<br>root@ubuntu4146:/data/home# </p><p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<br>ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€Œæ¬§é˜³é¹ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚<br>åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/ouyang_peng/article/details/10414499" target="_blank" rel="noopener">https://blog.csdn.net/ouyang_peng/article/details/10414499</a></p>]]></content>
      
      
      <categories>
          
          <category> æŒ‡ä»¤é›† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ˜¾å¡ </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŸºäºPseudo-LiDARçš„çº¯è§†è§‰3Dç‰©ä½“æ£€æµ‹ç®—æ³•</title>
      <link href="/2021/09/21/kang-nai-er-wang-yan-bo-shi-xian-shang-talk-ji-lu/"/>
      <url>/2021/09/21/kang-nai-er-wang-yan-bo-shi-xian-shang-talk-ji-lu/</url>
      
        <content type="html"><![CDATA[<h2 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h2><p>ä½•ç¨è€å¸ˆç»™æˆ‘ä»¬3Dç›®æ ‡æ£€æµ‹å°ç»„é‚€è¯·åˆ°äº†åº·å¥ˆå°”å¤§å­¦3Dæ·±åº¦æ£€æµ‹æ–¹é¢çš„åšå£«ç”Ÿç‹å²©åšå£«æ¥åšçº¿ä¸Štalkï¼Œè¿™é‡Œç®€å•è®°å½•ä¸€äº›å…³äº3Dç›®æ ‡æ£€æµ‹æ–¹é¢çš„è®²çš„ä¸€äº›slideså’Œä¸€äº›ç¬”è®°ï¼Œå½“ç„¶ï¼Œè¿™äº›éƒ½æ˜¯å¾ˆæ‚ä¹±çš„ï¼Œä¸æ˜¯å¾ˆè§„çŸ©ï¼Œç”šè‡³æœ‰äº›å¯èƒ½æ˜¯é”™çš„ï¼Œä½†æ˜¯è¿™äº›éƒ½æ˜¯å¾ˆå¥½çš„éƒ¨åˆ†ï¼Œä»¥ä¾›ä¹‹åè¿›ä¸€æ­¥å­¦ä¹ ã€‚</p><h2 id="ä¼šè®®ä¸»é¢˜ï¼šKunHeé¢„å®šçš„ä¼šè®®"><a href="#ä¼šè®®ä¸»é¢˜ï¼šKunHeé¢„å®šçš„ä¼šè®®" class="headerlink" title="ä¼šè®®ä¸»é¢˜ï¼šKunHeé¢„å®šçš„ä¼šè®®"></a>ä¼šè®®ä¸»é¢˜ï¼šKunHeé¢„å®šçš„ä¼šè®®</h2><p>ä¼šè®®å·<code>********</code></p><p>3Dæ£€æµ‹</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373563371477362833.png/mid?sign=f85702658eb93a758c876da9646c875c&t=1632190721" alt="img"></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373563429191008897.jpg/mid?sign=af50831678201588b08538735b97e188&t=1632190755" alt="img"></p><p>å¦‚æœæˆ‘æƒ³ç”¨ç›¸æœºæ¥å¸®åŠ©lidarï¼Œé‚£æ˜¯åšä¸åˆ°çš„ã€‚</p><p>æ¿€å…‰é›·è¾¾é€šè¿‡ç‰©ç†æ¥æ„Ÿè§‰æ·±åº¦ï¼Œä½†æ˜¯ç¥ç»ç½‘ç»œæ˜¯æ„Ÿå—é¢„æµ‹æ·±åº¦ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373563531380989863.jpg/mid?sign=667b84d50d6b5996022f70d31fa50451&t=1632190816" alt="img"></p><p>è¿™ä¸ªé¢„æµ‹çš„æ˜¯éå¸¸å‡†çš„ï¼Œå¦‚æœæœ‰äº†è¿™ä¸ªé›·è¾¾å’Œï¼Œæˆ‘ä»¬å¯ä»¥é¢„æµ‹å‡ºï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373563589480488871.jpg/mid?sign=4c50fe57275decebe21e91d23989ddef&t=1632190850" alt="img"></p><p>å¯¹äºæ¯ä¸ªåƒç´ ï¼Œæˆ‘ä»¬æœ‰è¿™ä¸ªå…¬å¼ï¼š</p><p>Intri å’Œ extriæ˜¯ç›¸æœºçš„å¤–å‚ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373563619159402641.jpg/mid?sign=77040c7546420a8218f598e0b027ae12&t=1632190868" alt="img"></p><p>uvå°±æ˜¯ç‚¹çš„åæ ‡ï¼Œè€Œä¸”é‚£ä¸ªæ˜¯è½¬æ¢å…¬å¼ï¼Œæ¯ä¸ªpixeléƒ½å¯ä»¥ç”Ÿæˆä¸€ä¸ªç‚¹äº‘åæ ‡</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373563727473156717.jpg/mid?sign=b95cc6c5d5ecb5b35748c1a3e2294d33&t=1632190933" alt="img"></p><p>ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬æŠŠæ·±åº¦å­¦ä¹ çš„å’Œé›·è¾¾é¢„æµ‹çš„æ˜¯å·®ä¸å¤šçš„ã€‚</p><p>å·ç§¯ç¥ç»ç½‘ç»œä¼šæœ‰é—®é¢˜ï¼Œå®ƒä¼šå’Œå¯¹åº”åƒç´ çš„ç›¸ä¹˜ï¼Œå®ƒä¼šå°†èƒŒæ™¯å’Œå‰æ™¯çš„ç‚¹åŠ åœ¨äº†ä¸€èµ·ï¼Œæ‰€ä»¥å°±ä¼šæœ‰ä¸€ä¸ªè¯¯å·®ï¼Œå°†è¿œè·ç¦»çš„ç‚¹å’Œè¿‘è·ç¦»çš„ç‚¹åŠ åˆ°äº†ä¸€èµ·ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373563799363461032.jpg/mid?sign=81a3a539d2802bf0747c989eb8c0df8e&t=1632190975" alt="img"></p><p>å¯ä»¥çœ‹å‡ºè¿™ä¹ˆä¸€ä¸ªå›¾ï¼Œ è¿™ä¸ªç‰©ä½“çš„ç‚¹ä¼šæ‰©æ•£å¼€äº†ï¼ŒåŸå› æˆ‘ä»¬å°†ç‰©ä½“çš„ç‚¹å’ŒèƒŒæ™¯çš„ç‚¹åŠ åœ¨äº†ä¸€èµ·ï¼Œç‚¹æ‰©æ•£å¼€æ¥äº†ï¼Œæ‰€ä»¥æ·±åº¦å›¾çš„æ˜¯ä¸é€‚ç”¨äº3Dæ£€æµ‹çš„</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373563989046683793.jpg/mid?sign=22790871074816fb6e942619394b6fd3&t=1632191088" alt="img"></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373563924269834862.jpg/mid?sign=71c44e31e3a8e7e450c28bba4e4af50e&t=1632191050" alt="img"></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373563900647579560.jpg/mid?sign=1af18889e667456278d386e92df1c895&t=1632191036" alt="img"></p><p>æˆ‘ä»¬æœ¬æ¥æ˜¯å¾—åˆ°æ·±åº¦å›¾è½¬åŒ–æˆpoint cloudï¼Œæ‰€ä»¥æˆ‘ä»¬æƒ³è¦ä½¿ç”¨æ¿€å…‰é›·è¾¾çš„ç½‘ç»œæ¥å¤„ç†ä¼ªæ¿€å…‰é›·è¾¾æ¥å¤„ç†bbox</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373564036979171239.jpg/mid?sign=4e6d2b9ca674952b474dc811771c9c5d&t=1632191117" alt="img"></p><p>å¯ä»¥çœ‹å‡ºæ¥æ€§èƒ½ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373564141299984530.jpg/mid?sign=16567d6d93a874dbf04561079906e120&t=1632191179" alt="img"></p><p>è¿™ä¸ªå‡†ç¡®åº¦ä»20å‡åˆ°äº†57äº†ã€‚æå‡äº†2.9å€ã€‚</p><p>è¿™è¿˜æ˜¯ä¸€äº›é¢„æµ‹ï¼Œå³ä¸Šæ˜¯ä¼ªæ¿€å…‰é›·è¾¾ï¼Œçº¢è‰²æ ‡è®°ï¼Œç»¿è‰²é¢„æµ‹ã€‚</p><p>ä¸‹è¾¹åˆ†åˆ«æ˜¯æ¿€å…‰é›·è¾¾ã€ä¼ªæ¿€å…‰é›·è¾¾ã€æ·±åº¦å›¾çš„ç»“æœï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373564190457184897.jpg/mid?sign=735bba7a7ef84875a2008b614c7ab464&t=1632191209" alt="img"></p><p>ä¼ªæ¿€å…‰é›·è¾¾ä¼šç”¨point netè¿™ç§å·ç§¯ã€‚</p><p>åŒç›®éƒ½èƒ½predictå¯¹ï¼Œå…¶ä»–çš„éƒ½ä¸å¤ªå¥½ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373564420523102044.jpg/mid?sign=cccbf12c722ec945801ff21e1940cc84&t=1632191346" alt="img"></p><p>è¯¥è§†é¢‘æ˜¾ç¤º</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373564485031502446.jpg/mid?sign=638cd4bb3deac650d15eb2e6541f4037&t=1632191384" alt="img"></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373564507680744046.jpg/mid?sign=de38e35ff8878d8d7563f8a62bfdea79&t=1632191398" alt="img"></p><p>å°æ€»ç»“ï¼Œå¯ä»¥çœ‹å‡ºå®é™…ä¸Šæœ¬æ¥å·®è·æ˜¯ä¸å¤ªå¤§çš„ï¼Œä¸»è¦å·®è·æ˜¯åœ¨äºæ·±åº¦å‡†ä¸å‡†ç¡®ï¼Œè€Œæœ€ä¸»è¦çš„å°±æ˜¯æˆ‘ä»¬æ·±åº¦çš„å‡†ç¡®åº¦ï¼Œå°±æ˜¯hardéš¾åº¦ã€‚</p><p>åŒç›®æ‘„åƒå¤´çš„æ·±åº¦ä¼°è®¡ï¼š</p><p>ä¸‰è§’å‡ ä½•ï¼Œpæ˜¯ä¸‰å¼Ÿç©ºé—´çš„ä¸€ä¸ªç‚¹ï¼Œè€Œè¿™ä¸ªp1,p2æ˜¯æŠ•å½±çš„å¸¦ä½ ï¼Œè€Œ</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373564616732648046.jpg/mid?sign=502e36f37c488c8075724d0e85ad7a41&t=1632191463" alt="img"></p><p>è¿™ä¸ªZå®é™…ä¸Šå°±æ˜¯æ·±åº¦ã€‚åŸç†æ˜¯ç›¸ä¼¼ä¸‰è§’å½¢</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373564963601606801.jpg/mid?sign=fe21a47a82bd91e4639c39fff35c3f8d&t=1632191670" alt="img"></p><p>å¦‚ä½•é¢„æµ‹disparityï¼š</p><p>åªéœ€è¦åœ¨xè½´æœç´¢ï¼Œè€Œyæ˜¯ä¸å˜çš„ï¼Œè¿™ä¸ªdisparityæ˜¯ç”¨æ¥ä¼°è®¡æ·±åº¦çš„ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373565139561025372.jpg/mid?sign=d894be5c1af3b524d13a3f86599159f7&t=1632191774" alt="img"></p><p>å•ç›®æ·±åº¦ä¼°è®¡ï¼š</p><p>ä¸¤ç§æ–¹å¼ï¼šç¬¬ä¸€ç§æœ‰æ‰‹æœºæ‹ç…§ç‰‡ï¼Œç”±ä¸€äº›å…ˆéªŒçŸ¥è¯†</p><p>ç¬¬äºŒç§æ˜¯ä¸€æ®µvideoé€šè¿‡å‰åå…³ç³»æ¥é¢„æµ‹æ·±åº¦ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373565208213397415.jpg/mid?sign=0ddb9a597597f2c62b6a765ffc786cbb&t=1632191815" alt="img"></p><p>äº†è§£äº†å•ç›®å’ŒåŒç›®æ¥é¢„æµ‹æ·±åº¦ã€‚ä¸‹é¢å¦‚ä½•æå‡è¿™ä¸ªæ·±åº¦ä¼°è®¡ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373565719197126491.jpg/mid?sign=fd2f485c549d5b7a0a89c9e246ca3f66&t=1632192120" alt="img"></p><p>å·¦å›¾çš„pixelç›¸å¯¹äºå³å›¾çš„pixelç§»åŠ¨äº†å¤šå°‘ä¸œè¥¿ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373565764193577105.jpg/mid?sign=0650569da5a79e02037c658fdb50296d&t=1632192146" alt="img"></p><p>å‰é¢ä¹Ÿæåˆ°äº†ï¼Œå°±æ˜¯ä¸€ä¸ªä¸ªçš„pixelçš„æ‰¾ä¸æ–­è®¡ç®—å‡ºç›¸ä¼¼åº¦ï¼Œå†æ‰¾å‡ºæœ€å¥½çš„é‚£ä¸ªpixel</p><p>é¦–å…ˆæˆ‘ä»¬ç”¨åˆ°å·¦å›¾çš„ç¥ç»ç½‘ç»œå¾—åˆ°feature mapï¼Œç„¶åbuildä¸€ä¸ªï¼Œä¸€ä¸ªæ˜¯é•¿å’Œå®½ï¼Œå¦å¤–çš„å°±æ˜¯æˆ‘ä»¬çš„ç›¸ä¼¼åº¦ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373565813787008935.jpg/mid?sign=7eb3b86f9285e96b83197cbaf65231a5&t=1632192176" alt="img"></p><p>æ·±åº¦å’ŒDisparityæ˜¯æœ‰ä¸€ä¸ªåæ¯”å…³ç³»ã€‚å¦‚æœé¢„æµ‹é”™äº†ä¸€ä¸ªdisparityï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±é¢„æµ‹å‡ ç™¾ç±³çš„è·ç¦»ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373566040547861102.jpg/mid?sign=51df53b8318786a6206ae7dd32a39e20&t=1632192311" alt="img"></p><p>m</p><p>å¯ä»¥çœ‹ä¸€ä¸‹è¯¯å·®æå‡çš„è¿˜æŒºå¥½ï¼Œåšäº†ä¸€ä¸ªdepth volumeçš„åˆ›æ–°</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373566288582240401.jpg/mid?sign=01b714c3e9c293ff9997d3ff5c0fa14e&t=1632192459" alt="img"></p><p>å¯¹äºæˆ‘ä»¬çš„ç»“æœæ¥çœ‹ï¼Œå®é™…ä¸Šæ˜¯æœ‰æŒºå¤§æå‡çš„ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373566359617019816.jpg/mid?sign=ed5d95d950492990e990b2922e866e6a&t=1632192501" alt="img"></p><p>moderateä»56-64ï¼Œæå‡8ä¸ªç‚¹ï¼Œæå‡è¿˜æ˜¯éå¸¸å‡†çš„ã€‚</p><h2 id="é€Ÿåº¦"><a href="#é€Ÿåº¦" class="headerlink" title="é€Ÿåº¦"></a><strong>é€Ÿåº¦</strong></h2><p>å¯ä»¥çœ‹å‡ºé¢„æµ‹æ·±åº¦æ˜¯éå¸¸æ…¢äº†ã€‚å¯èƒ½æˆ‘å·²ç»æ’è½¦æ‰ç®—å‡ºæ¥è­¦æŠ¥</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373566470313044113.jpg/mid?sign=da8dee0514eddb5c2f784a17b58c3eec&t=1632192568" alt="img"></p><p>æˆ‘ä»¬ä¸»è¦æ…¢åœ¨è¿™é‡Œï¼Œè¿™ä¸ªæ·±åº¦å›¾æ·±åº¦ä¼°è®¡ï¼Œdepth disparityï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373566587418058663.jpg/mid?sign=962b38dbc84336b4c8679883ce9368d8&t=1632192637" alt="img"></p><p>è¿œè·ç¦»ä¼°è®¡ä¸å‡†æ˜¯å› ä¸ºé™ç»´ã€‚</p><p>è€Œè¿™é‡Œç”¨çš„éƒ½æ˜¯ä¸€äº›å¾ˆå°çš„å›¾ç‰‡ï¼Œå¯¹äº4k,8k.</p><p>æ€»ç»“ä¸€ä¸‹æ·±åº¦ä¼°è®¡çš„é—®é¢˜ï¼Œè¿‘è·ç¦»ç‚¹å¤šï¼Œè€Œè¿œè·ç¦»çš„ç‚¹å°±æ¯”è¾ƒå°‘ï¼Œè€Œè¿™æ ·çš„è¯ä¼˜åŒ–æ¥çœ‹è¿œè·ç¦»çš„ç‚¹ä¼˜åŒ–çš„æ¯”è¾ƒå°‘ã€‚</p><p>è€Œç©ºé—´ä¸Šï¼Œè¿‘è·ç¦»åœ°è½¦å¾ˆå¤§ï¼Œè¿œè·ç¦»çš„è½¦å°±å¾ˆå°ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å°±æƒ³è¦è·³è¿‡æ·±åº¦ä¼°è®¡ï¼Œè€Œæ˜¯ä»…ä»…ç›´æ¥å¾—åˆ°point cloudã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373566712190190209.jpg/mid?sign=18453c1280a570268b19abbdfd9ca646&t=1632192712" alt="img"></p><p>å¯ä»¥çœ‹ä¸€ä¸‹å¾—åˆ°æ–¹å¼ï¼š</p><p>ç”±ä¹‹å‰å¾—åˆ°çš„è½¬æ¢æ–¹å¼ï¼Œç›´æ¥copyè¿‡æ¥å°±OKã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373566901621690203.jpg/mid?sign=eeff7f35175c3c3639d48d05478db681&t=1632192825" alt="img"></p><p>å¯ä»¥çœ‹ä¸€ä¸‹æ€§èƒ½ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373566980105511534.jpg/mid?sign=26ae9bcd5294b906b73e492aba2545b0&t=1632192871" alt="img"></p><p>å¯¹æ¯”ç»“æœï¼š</p><p>ç”¨äº†æœ€æ–°æŠ€æœ¯åå°±å–å¾—äº†å¾ˆå¤§çš„æå‡ï¼Œè€Œeasyéƒ¨åˆ†å°±å·²ç»æ¥è¿‘ladaräº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373567031645118376.jpg/mid?sign=3e430f6f594d96cb4506e151fb45e8c7&t=1632192902" alt="img"></p><p>æˆ‘ä»¬ç”¨æ›´å¤§çš„å›¾ç‰‡å°±ä¸ä¼šå¢åŠ 3Då·ç§¯çš„æ—¶é—´ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373567166349381467.jpg/mid?sign=f2d84e67d5d00ba8088bc7ffd7a71b5f&t=1632192983" alt="img"></p><p>LiDARæ¿€å…‰é›·è¾¾åªèƒ½é¢„æµ‹200ç±³ä¹‹å†…çš„ï¼Œæ‰€ä»¥è¿™ä¸ªå°±æœ‰å±€é™ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373567178546422382.jpg/mid?sign=5f608619a73d35b2c3c980e03ab7ed39&t=1632192990" alt="img"></p><p>ä¸šç•Œä¹ŸæˆåŠŸä½¿ç”¨äº†è¿™ä¸ªæ–¹æ³•ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373567258053649005.jpg/mid?sign=b62afe4c5cfc11642d107c38303c2b51&t=1632193037" alt="img"></p><p>ä¹‹å‰å¤§å®¶åšåŒç›®æ£€æµ‹é¢„æµ‹çš„æ˜¯disparityï¼Œä¸»è¦æ˜¯åšå®¤å†…çš„ï¼Œæ‰€ä»¥è¿œçš„ä¸å¤ªå…³å¿ƒã€‚ä½†æ˜¯æ— äººé©¾é©¶éœ€è¦è¿œè·ç¦»çš„é¢„æµ‹ä¹Ÿéå¸¸å‡†æ‰€ä»¥æ‰å¼€å§‹è€ƒè™‘è¿™ä¸ªé—®é¢˜ã€‚</p><p>å‰é¢è®²çš„éƒ½æ˜¯ç›¸æœºæ¥é¢„æµ‹ç‰©ä½“ã€‚ä½†æ˜¯æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨åˆ°LiDAR.</p><p>è™½ç„¶æ¯”è¾ƒè´µï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥è€ƒè™‘ç”¨åˆ°ä¸€ä¸ªè¾ƒä¸ºä¾¿å®œçš„å››çº¿é›·è¾¾ï¼Œå¯ä»¥çœ‹å‡ºæµ‹è¯•ç»“æœä¸å¤ªå¥½ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373567747881247342.jpg/mid?sign=6643c5981bd30fbbe0bee01408f2a393&t=1632193335" alt="img"></p><p>çœ‹ä¸€ä¸‹è¿™ä¸ªï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373567928437641052.jpg/mid?sign=c3d30582bc892819e8553d108b22d6bb&t=1632193437" alt="img"></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373568326141667144.jpg/origin?sign=45e07af3b4669ad766df804abeffd703&t=1632193674" alt="img"></p><p>ä¸€äº›å¯åšæ–¹å‘ï¼š</p><p>\1. ç¼©å°gap</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373568839927013288.jpg/mid?sign=d2ee7c37cd77d4732296cc9f0bead990&t=1632193980" alt="img"></p><p>\2. é«˜é€Ÿä¸Šé€Ÿåº¦å¾ˆå¿«çš„è¯200ç±³å°±ä¸å¤Ÿäº†ï¼Œæ‰€ä»¥è¿™é‡Œå°±æ˜¯å…³äºä¸ä¸€æ ·çš„æ·±åº¦è·ç¦»ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373568860965637979.jpg/mid?sign=f09dcf3373b99df01fa8570b3c5fbbd6&t=1632193992" alt="img"></p><p>\3. åœºæ™¯çš„é—®é¢˜</p><p>é›¨å¤©å‘€ï¼Œå¤œæ™šå‘€è¿™ç§ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373569039676612519.jpg/mid?sign=394e6fd9b5b5f478a949c4cfdfa275a5&t=1632194099" alt="img"></p><p>\4. </p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373569084320850542.jpg/mid?sign=0dafe26179c772d30ad147340cd125cc&t=1632194125" alt="img"></p><p>åšç ”ç©¶</p><p>ç ”ç©¶æ–¹å‘</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373569391259886189.jpg/origin?sign=58cc1595de25c1f992237b3dacc9f21c&t=1632196398" alt="img"></p><p>æ·±åº¦ä¼°è®¡</p><p>å¤šè·Ÿä¸åŒæ–¹å‘çš„äººè®¨è®ºï¼Œç„¶åå°±å¯ä»¥æœ‰ä¸€äº›å¾ˆä¸é”™çš„åˆä½œè€…å‘€ï¼Œæ€è·¯å‘€ã€‚</p><p>é˜…è¯»å¤§é‡çš„æ–‡ç« ï¼Œäº†è§£è¿™ä¸ªé¢†åŸŸï¼Œå¤šå‚åŠ çº¿ä¸Šè®¨è®ºä¼šï¼Œå¯ä»¥ç›´æ¥é—®ç ”ç©¶è€…é—®é¢˜ã€‚</p><p>æ‰¾ä¸€äº›å¼€æºä»£ç å¤ç°baselineï¼Œåœ¨ä¸Šé¢æ”¹ï¼ŒåŸºäºåˆ«äººå·¥ä½œ</p><p>é¿å…å¼€å§‹æ—¶å°±æ­éå¸¸å¤æ‚çš„æ¨¡å‹ï¼Œç„¶åæµªè´¹æ—¶é—´ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373569863353962331.jpg/origin?sign=b778bb310d5a60f756770853a429c3ba&t=1632196398" alt="img"></p><p>å¦‚ä½•è®¾è®¡æ¨¡å‹</p><p>åˆ†è§£åˆ«äººæ¨¡å‹ï¼Œæ‰¾åˆ°æœ€ç»ˆéƒ¨åˆ†ï¼Œä»¥æ­¤å¼€å§‹ï¼Œå› ä¸ºå¤§é‡è®ºæ–‡å®é™…ä¸Šæäº†å¾ˆå¤šç‚¹ï¼Œä½†æ˜¯æœ‰ç”¨çš„å°±1ã€2ä¸ªç‚¹work</p><p>è®¾è®¡æ–°æ–¹æ³•ï¼Œä»æœ€ç®€å•çš„å¼€å§‹</p><p>ç®€åŒ–æ¨¡å‹ï¼Œæ‰¾åˆ°æœ€é‡è¦çš„ç‚¹æ¥å†™æ–‡ç« ã€‚æ¨¡å‹è¶Šç®€å•è¶Šå®¹æ˜“è¢«å¼•ç”¨ï¼Œå¯ä»¥å¾€ä¸ŠåŠ ä¸œè¥¿ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://wemeet-idea-prod-1258344699.file.myqcloud.com/wemeet_idea/200000001/144115231173702441/images/373570050872960840.jpg/origin?sign=f650d13d785b4b12ba2d312bab12dc7e&t=1632196398" alt="img"></p><p>å‡†å¤‡è‹±è¯­å’ŒGPAï¼Œæå‡ç§‘ç ”èƒŒæ™¯</p><p>ç”³è¯·ææ–™ï¼šæ–‡ç« ç§‘ç ”ï¼Œ ç„¶åæ˜¯æ¨èä¿¡ï¼ˆå¯èƒ½æ¯”æ–‡ç« é‡è¦ï¼‰ï¼Œç›®å‰ç”³ç¾æœºä¼šå˜å¤§äº†ã€‚</p><p>ä»ç‚¹äº‘åˆ°3Dç›®æ ‡æ£€æµ‹è¿™ä¸€å—ï¼Œæå‡å·²ç»ä¸å¤§äº†ï¼Œå·²ç»å¿«é¥±å’Œäº†ã€‚</p><p>ä½†æ˜¯ï¼Œä»å›¾åƒå¾—åˆ°ç‚¹äº‘ï¼Œæå‡å°±è¿˜æ˜¯å¾ˆæœ‰ç©ºé—´çš„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç›®æ ‡æ£€æµ‹ </tag>
            
            <tag> çº¿ä¸Štalk </tag>
            
            <tag> 3D </tag>
            
            <tag> åº·å¥ˆå°”å¤§å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆè¯•RNN</title>
      <link href="/2021/09/20/chu-shi-rnn/"/>
      <url>/2021/09/20/chu-shi-rnn/</url>
      
        <content type="html"><![CDATA[<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>æ˜¨å¤©è·Ÿä¸€å¸†å­¦äº†ä¸€äº›å…³äºRNNçš„å†…å®¹ï¼Œæˆ‘ä»¬ä¸¤ä¸ªä¸€èµ·è¿è¡Œäº†å®˜ç½‘çš„ä¸€äº›ä»£ç ï¼Œåæ¥å‘ç°æœºå™¨ç¿»è¯‘å®é™…ä¸Šæ•ˆæœä¸å¤ªå¥½ï¼Œå¯èƒ½æ¨¡å‹çš„æ•°æ®é›†å¤ªå°äº†ï¼Œè®­ç»ƒæ¬ æ‹Ÿåˆï¼Œæ²¡åŠæ³•ï¼Œå³ä½¿æ˜¯è¿™ä¹ˆå°çš„æ•°æ®é›†æˆ‘ä»¬ä¹Ÿåœ¨kaggleä¸Šè¿è¡Œäº†20å¤šåˆ†é’Ÿã€‚æˆ‘ä¸ªäººå¯¹äºè¿™äº›ç¿»è¯‘è¿˜æ˜¯æ„Ÿè§‰éå¸¸ç¥å¥‡çš„ï¼Œå±…ç„¶è¿™é‡Œé¢æœ‰ä¸¤ä¸ªç½‘ç»œï¼Œä¸€ä¸ªç¼–ç ï¼Œä¸€ä¸ªè§£ç ã€‚ç¡®å®éå¸¸å¥‡å¦™ï¼ŒNLPè¿™äº›ä¸œè¥¿<del>æˆ‘ä¹‹åæœ‰æ—¶é—´</del>ä¸€å®šè¦è®¤çœŸç ”ç©¶ä¸€ä¸‹ã€‚åæ¥å°±æ˜¯å…³äºä¿å­˜æ¨¡å‹è¿™äº›äº†ï¼Œå……åˆ†å¸å–æˆ‘ä¹‹å‰è®­ç»ƒäº†é‚£ä¹ˆå¤šCNNä½†æ˜¯æœ€ç»ˆæ²¡æœ‰ä¿å­˜æ¨¡å‹çš„æ•™è®­ğŸ˜­ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token operator">%</span>matplotlib inline<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>NLP From Scratch: Translation with a Sequence to Sequence Network and Attention</p><hr><p><strong>Author</strong>: <code>Sean Robertson &lt;https://github.com/spro/practical-pytorch&gt;</code>_</p><p>for better reading experience,  <a href="https://pytorch.org/tutorials/intermediate/seq2seq_translation_tutorial.html" target="_blank" rel="noopener"><code>here</code></a> </p><p>This is the third and final tutorial on doing â€œNLP From Scratchâ€, where we<br>write our own classes and functions to preprocess the data to do our NLP<br>modeling tasks. We hope after you complete this tutorial that youâ€™ll proceed to<br>learn how <code>torchtext</code> can handle much of this preprocessing for you in the<br>three tutorials immediately following this one.</p><p>In this project we will be teaching a neural network to translate from<br>French to English.</p><p>::</p><pre><code>[KEY: &gt; input, = target, &lt; output]&gt; il est en train de peindre un tableau .= he is painting a picture .&lt; he is painting a picture .&gt; pourquoi ne pas essayer ce vin delicieux ?= why not try that delicious wine ?&lt; why not try that delicious wine ?&gt; elle n est pas poete mais romanciere .= she is not a poet but a novelist .&lt; she not not a poet but a novelist .&gt; vous etes trop maigre .= you re too skinny .&lt; you re all alone .</code></pre><p>â€¦ to varying degrees of success.</p><p>This is made possible by the simple but powerful idea of the <code>sequenceto sequence network &lt;https://arxiv.org/abs/1409.3215&gt;</code>__, in which two<br>recurrent neural networks work together to transform one sequence to<br>another. An encoder network condenses an input sequence into a vector,<br>and a decoder network unfolds that vector into a new sequence.</p><p>.. figure:: /_static/img/seq-seq-images/seq2seq.png<br>   :alt:</p><p>To improve upon this model weâ€™ll use an <code>attentionmechanism &lt;https://arxiv.org/abs/1409.0473&gt;</code>__, which lets the decoder<br>learn to focus over a specific range of the input sequence.</p><p><strong>Recommended Reading:</strong></p><p>I assume you have at least installed PyTorch, know Python, and<br>understand Tensors:</p><ul><li><a href="https://pytorch.org/" target="_blank" rel="noopener">https://pytorch.org/</a> For installation instructions</li><li>:doc:<code>/beginner/deep_learning_60min_blitz</code> to get started with PyTorch in general</li><li>:doc:<code>/beginner/pytorch_with_examples</code> for a wide and deep overview</li><li>:doc:<code>/beginner/former_torchies_tutorial</code> if you are former Lua Torch user</li></ul><p>It would also be useful to know about Sequence to Sequence networks and<br>how they work:</p><ul><li><code>Learning Phrase Representations using RNN Encoder-Decoder forStatistical Machine Translation &lt;https://arxiv.org/abs/1406.1078&gt;</code>__</li><li><code>Sequence to Sequence Learning with NeuralNetworks &lt;https://arxiv.org/abs/1409.3215&gt;</code>__</li><li><code>Neural Machine Translation by Jointly Learning to Align andTranslate &lt;https://arxiv.org/abs/1409.0473&gt;</code>__</li><li><code>A Neural Conversational Model &lt;https://arxiv.org/abs/1506.05869&gt;</code>__</li></ul><p>You will also find the previous tutorials on<br>:doc:<code>/intermediate/char_rnn_classification_tutorial</code><br>and :doc:<code>/intermediate/char_rnn_generation_tutorial</code><br>helpful as those concepts are very similar to the Encoder and Decoder<br>models, respectively.</p><p><strong>Requirements</strong></p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> unicode_literals<span class="token punctuation">,</span> print_function<span class="token punctuation">,</span> division<span class="token keyword">from</span> io <span class="token keyword">import</span> open<span class="token keyword">import</span> unicodedata<span class="token keyword">import</span> string<span class="token keyword">import</span> re<span class="token keyword">import</span> random<span class="token keyword">import</span> torch<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn<span class="token keyword">from</span> torch <span class="token keyword">import</span> optim<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>functional <span class="token keyword">as</span> Fdevice <span class="token operator">=</span> torch<span class="token punctuation">.</span>device<span class="token punctuation">(</span><span class="token string">"cuda"</span> <span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">"cpu"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="Loading-data-files"><a href="#Loading-data-files" class="headerlink" title="Loading data files"></a>Loading data files</h1><p>The data for this project is a set of many thousands of English to<br>French translation pairs.</p><p><code>This question on Open Data StackExchange &lt;https://opendata.stackexchange.com/questions/3888/dataset-of-sentences-translated-into-many-languages&gt;</code>__<br>pointed me to the open translation site <a href="https://tatoeba.org/" target="_blank" rel="noopener">https://tatoeba.org/</a> which has<br>downloads available at <a href="https://tatoeba.org/eng/downloads" target="_blank" rel="noopener">https://tatoeba.org/eng/downloads</a> - and better<br>yet, someone did the extra work of splitting language pairs into<br>individual text files here: <a href="https://www.manythings.org/anki/" target="_blank" rel="noopener">https://www.manythings.org/anki/</a></p><p>The English to French pairs are too big to include in the repo, so<br>download to <code>data/eng-fra.txt</code> before continuing. The file is a tab<br>separated list of translation pairs:</p><p>::</p><pre><code>I am cold.    J&#39;ai froid.</code></pre><p>.. Note::<br>   Download the data from<br>   <code>here &lt;https://download.pytorch.org/tutorial/data.zip&gt;</code>_<br>   and extract it to the current directory.</p><p>Similar to the character encoding used in the character-level RNN<br>tutorials, we will be representing each word in a language as a one-hot<br>vector, or giant vector of zeros except for a single one (at the index<br>of the word). Compared to the dozens of characters that might exist in a<br>language, there are many many more words, so the encoding vector is much<br>larger. We will however cheat a bit and trim the data to only use a few<br>thousand words per language.</p><p>.. figure:: /_static/img/seq-seq-images/word-encoding.png<br>   :alt:</p><p>Weâ€™ll need a unique index per word to use as the inputs and targets of<br>the networks later. To keep track of all this we will use a helper class<br>called <code>Lang</code> which has word â†’ index (<code>word2index</code>) and index â†’ word<br>(<code>index2word</code>) dictionaries, as well as a count of each word<br><code>word2count</code> which will be used to replace rare words later.</p><pre class="line-numbers language-python"><code class="language-python">SOS_token <span class="token operator">=</span> <span class="token number">0</span>EOS_token <span class="token operator">=</span> <span class="token number">1</span><span class="token keyword">class</span> <span class="token class-name">Lang</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name        self<span class="token punctuation">.</span>word2index <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        self<span class="token punctuation">.</span>word2count <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        self<span class="token punctuation">.</span>index2word <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">"SOS"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">"EOS"</span><span class="token punctuation">}</span>        self<span class="token punctuation">.</span>n_words <span class="token operator">=</span> <span class="token number">2</span>  <span class="token comment" spellcheck="true"># Count SOS and EOS</span>    <span class="token keyword">def</span> <span class="token function">addSentence</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> sentence<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> word <span class="token keyword">in</span> sentence<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>addWord<span class="token punctuation">(</span>word<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">addWord</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> word<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> word <span class="token operator">not</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>word2index<span class="token punctuation">:</span>            self<span class="token punctuation">.</span>word2index<span class="token punctuation">[</span>word<span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>n_words            self<span class="token punctuation">.</span>word2count<span class="token punctuation">[</span>word<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>            self<span class="token punctuation">.</span>index2word<span class="token punctuation">[</span>self<span class="token punctuation">.</span>n_words<span class="token punctuation">]</span> <span class="token operator">=</span> word            self<span class="token punctuation">.</span>n_words <span class="token operator">+=</span> <span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>word2count<span class="token punctuation">[</span>word<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>The files are all in Unicode, to simplify we will turn Unicode<br>characters to ASCII, make everything lowercase, and trim most<br>punctuation.</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Turn a Unicode string to plain ASCII, thanks to</span><span class="token comment" spellcheck="true"># https://stackoverflow.com/a/518232/2809427</span><span class="token keyword">def</span> <span class="token function">unicodeToAscii</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>        c <span class="token keyword">for</span> c <span class="token keyword">in</span> unicodedata<span class="token punctuation">.</span>normalize<span class="token punctuation">(</span><span class="token string">'NFD'</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span>        <span class="token keyword">if</span> unicodedata<span class="token punctuation">.</span>category<span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">'Mn'</span>    <span class="token punctuation">)</span><span class="token comment" spellcheck="true"># Lowercase, trim, and remove non-letter characters</span><span class="token keyword">def</span> <span class="token function">normalizeString</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>    s <span class="token operator">=</span> unicodeToAscii<span class="token punctuation">(</span>s<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    s <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span>r<span class="token string">"([.!?])"</span><span class="token punctuation">,</span> r<span class="token string">" \1"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span>    s <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span>r<span class="token string">"[^a-zA-Z.!?]+"</span><span class="token punctuation">,</span> r<span class="token string">" "</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span>    <span class="token keyword">return</span> s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>To read the data file we will split the file into lines, and then split<br>lines into pairs. The files are all English â†’ Other Language, so if we<br>want to translate from Other Language â†’ English I added the <code>reverse</code><br>flag to reverse the pairs.</p><pre class="line-numbers language-python"><code class="language-python">cd input<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>/kaggle/input</code></pre><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">readLangs</span><span class="token punctuation">(</span>lang1<span class="token punctuation">,</span> lang2<span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Reading lines..."</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># Read the file and split into lines</span>    lines <span class="token operator">=</span> open<span class="token punctuation">(</span><span class="token string">'engfratxt0/%s-%s.txt'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>lang1<span class="token punctuation">,</span> lang2<span class="token punctuation">)</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>\        read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># Split every line into pairs and normalize</span>    pairs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>normalizeString<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">for</span> s <span class="token keyword">in</span> l<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\t'</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> l <span class="token keyword">in</span> lines<span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># Reverse pairs, make Lang instances</span>    <span class="token keyword">if</span> reverse<span class="token punctuation">:</span>        pairs <span class="token operator">=</span> <span class="token punctuation">[</span>list<span class="token punctuation">(</span>reversed<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> p <span class="token keyword">in</span> pairs<span class="token punctuation">]</span>        input_lang <span class="token operator">=</span> Lang<span class="token punctuation">(</span>lang2<span class="token punctuation">)</span>        output_lang <span class="token operator">=</span> Lang<span class="token punctuation">(</span>lang1<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        input_lang <span class="token operator">=</span> Lang<span class="token punctuation">(</span>lang1<span class="token punctuation">)</span>        output_lang <span class="token operator">=</span> Lang<span class="token punctuation">(</span>lang2<span class="token punctuation">)</span>    <span class="token keyword">return</span> input_lang<span class="token punctuation">,</span> output_lang<span class="token punctuation">,</span> pairs<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Since there are a <em>lot</em> of example sentences and we want to train<br>something quickly, weâ€™ll trim the data set to only relatively short and<br>simple sentences. Here the maximum length is 10 words (that includes<br>ending punctuation) and weâ€™re filtering to sentences that translate to<br>the form â€œI amâ€ or â€œHe isâ€ etc. (accounting for apostrophes replaced<br>earlier).</p><pre class="line-numbers language-python"><code class="language-python">MAX_LENGTH <span class="token operator">=</span> <span class="token number">10</span>eng_prefixes <span class="token operator">=</span> <span class="token punctuation">(</span>    <span class="token string">"i am "</span><span class="token punctuation">,</span> <span class="token string">"i m "</span><span class="token punctuation">,</span>    <span class="token string">"he is"</span><span class="token punctuation">,</span> <span class="token string">"he s "</span><span class="token punctuation">,</span>    <span class="token string">"she is"</span><span class="token punctuation">,</span> <span class="token string">"she s "</span><span class="token punctuation">,</span>    <span class="token string">"you are"</span><span class="token punctuation">,</span> <span class="token string">"you re "</span><span class="token punctuation">,</span>    <span class="token string">"we are"</span><span class="token punctuation">,</span> <span class="token string">"we re "</span><span class="token punctuation">,</span>    <span class="token string">"they are"</span><span class="token punctuation">,</span> <span class="token string">"they re "</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">filterPair</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> len<span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> MAX_LENGTH <span class="token operator">and</span> \        len<span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> MAX_LENGTH <span class="token operator">and</span> \        p<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>startswith<span class="token punctuation">(</span>eng_prefixes<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">filterPairs</span><span class="token punctuation">(</span>pairs<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token punctuation">[</span>pair <span class="token keyword">for</span> pair <span class="token keyword">in</span> pairs <span class="token keyword">if</span> filterPair<span class="token punctuation">(</span>pair<span class="token punctuation">)</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>The full process for preparing the data is:</p><ul><li>Read text file and split into lines, split lines into pairs</li><li>Normalize text, filter by length and content</li><li>Make word lists from sentences in pairs</li></ul><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">prepareData</span><span class="token punctuation">(</span>lang1<span class="token punctuation">,</span> lang2<span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    input_lang<span class="token punctuation">,</span> output_lang<span class="token punctuation">,</span> pairs <span class="token operator">=</span> readLangs<span class="token punctuation">(</span>lang1<span class="token punctuation">,</span> lang2<span class="token punctuation">,</span> reverse<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Read %s sentence pairs"</span> <span class="token operator">%</span> len<span class="token punctuation">(</span>pairs<span class="token punctuation">)</span><span class="token punctuation">)</span>    pairs <span class="token operator">=</span> filterPairs<span class="token punctuation">(</span>pairs<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Trimmed to %s sentence pairs"</span> <span class="token operator">%</span> len<span class="token punctuation">(</span>pairs<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Counting words..."</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> pair <span class="token keyword">in</span> pairs<span class="token punctuation">:</span>        input_lang<span class="token punctuation">.</span>addSentence<span class="token punctuation">(</span>pair<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        output_lang<span class="token punctuation">.</span>addSentence<span class="token punctuation">(</span>pair<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Counted words:"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>input_lang<span class="token punctuation">.</span>name<span class="token punctuation">,</span> input_lang<span class="token punctuation">.</span>n_words<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>output_lang<span class="token punctuation">.</span>name<span class="token punctuation">,</span> output_lang<span class="token punctuation">.</span>n_words<span class="token punctuation">)</span>    <span class="token keyword">return</span> input_lang<span class="token punctuation">,</span> output_lang<span class="token punctuation">,</span> pairsinput_lang<span class="token punctuation">,</span> output_lang<span class="token punctuation">,</span> pairs <span class="token operator">=</span> prepareData<span class="token punctuation">(</span><span class="token string">'eng'</span><span class="token punctuation">,</span> <span class="token string">'fra'</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>pairs<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>Reading lines...Read 135842 sentence pairsTrimmed to 10599 sentence pairsCounting words...Counted words:fra 4345eng 2803[&#39;c est un fondu de musique .&#39;, &#39;he is mad about music .&#39;]</code></pre><h1 id="The-Seq2Seq-Model"><a href="#The-Seq2Seq-Model" class="headerlink" title="The Seq2Seq Model"></a>The Seq2Seq Model</h1><p>A Recurrent Neural Network, or RNN, is a network that operates on a<br>sequence and uses its own output as input for subsequent steps.</p><p>A <code>Sequence to Sequence network &lt;https://arxiv.org/abs/1409.3215&gt;</code><strong>, or<br>seq2seq network, or <code>Encoder Decodernetwork &lt;https://arxiv.org/pdf/1406.1078v3.pdf&gt;</code></strong>, is a model<br>consisting of two RNNs called the encoder and decoder. The encoder reads<br>an input sequence and outputs a single vector, and the decoder reads<br>that vector to produce an output sequence.</p><p>.. figure:: /_static/img/seq-seq-images/seq2seq.png<br>   :alt:</p><p>Unlike sequence prediction with a single RNN, where every input<br>corresponds to an output, the seq2seq model frees us from sequence<br>length and order, which makes it ideal for translation between two<br>languages.</p><p>Consider the sentence â€œJe ne suis pas le chat noirâ€ â†’ â€œI am not the<br>black catâ€. Most of the words in the input sentence have a direct<br>translation in the output sentence, but are in slightly different<br>orders, e.g. â€œchat noirâ€ and â€œblack catâ€. Because of the â€œne/pasâ€<br>construction there is also one more word in the input sentence. It would<br>be difficult to produce a correct translation directly from the sequence<br>of input words.</p><p>With a seq2seq model the encoder creates a single vector which, in the<br>ideal case, encodes the â€œmeaningâ€ of the input sequence into a single<br>vector â€” a single point in some N dimensional space of sentences.</p><h2 id="The-Encoder"><a href="#The-Encoder" class="headerlink" title="The Encoder"></a>The Encoder</h2><p>The encoder of a seq2seq network is a RNN that outputs some value for<br>every word from the input sentence. For every input word the encoder<br>outputs a vector and a hidden state, and uses the hidden state for the<br>next input word.</p><p>.. figure:: /_static/img/seq-seq-images/encoder-network.png<br>   :alt:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">EncoderRNN</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_size<span class="token punctuation">,</span> hidden_size<span class="token punctuation">)</span><span class="token punctuation">:</span>        super<span class="token punctuation">(</span>EncoderRNN<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>hidden_size <span class="token operator">=</span> hidden_size        self<span class="token punctuation">.</span>embedding <span class="token operator">=</span> nn<span class="token punctuation">.</span>Embedding<span class="token punctuation">(</span>input_size<span class="token punctuation">,</span> hidden_size<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>gru <span class="token operator">=</span> nn<span class="token punctuation">.</span>GRU<span class="token punctuation">(</span>hidden_size<span class="token punctuation">,</span> hidden_size<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input<span class="token punctuation">,</span> hidden<span class="token punctuation">)</span><span class="token punctuation">:</span>        embedded <span class="token operator">=</span> self<span class="token punctuation">.</span>embedding<span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>        output <span class="token operator">=</span> embedded        output<span class="token punctuation">,</span> hidden <span class="token operator">=</span> self<span class="token punctuation">.</span>gru<span class="token punctuation">(</span>output<span class="token punctuation">,</span> hidden<span class="token punctuation">)</span>        <span class="token keyword">return</span> output<span class="token punctuation">,</span> hidden    <span class="token keyword">def</span> <span class="token function">initHidden</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> torch<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>hidden_size<span class="token punctuation">,</span> device<span class="token operator">=</span>device<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="The-Decoder"><a href="#The-Decoder" class="headerlink" title="The Decoder"></a>The Decoder</h2><p>The decoder is another RNN that takes the encoder output vector(s) and<br>outputs a sequence of words to create the translation.</p><p>Simple Decoder<br>^^^^^^^^^^^^^^</p><p>In the simplest seq2seq decoder we use only last output of the encoder.<br>This last output is sometimes called the <em>context vector</em> as it encodes<br>context from the entire sequence. This context vector is used as the<br>initial hidden state of the decoder.</p><p>At every step of decoding, the decoder is given an input token and<br>hidden state. The initial input token is the start-of-string <code>&lt;SOS&gt;</code><br>token, and the first hidden state is the context vector (the encoderâ€™s<br>last hidden state).</p><p>.. figure:: /_static/img/seq-seq-images/decoder-network.png<br>   :alt:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">DecoderRNN</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> hidden_size<span class="token punctuation">,</span> output_size<span class="token punctuation">)</span><span class="token punctuation">:</span>        super<span class="token punctuation">(</span>DecoderRNN<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>hidden_size <span class="token operator">=</span> hidden_size        self<span class="token punctuation">.</span>embedding <span class="token operator">=</span> nn<span class="token punctuation">.</span>Embedding<span class="token punctuation">(</span>output_size<span class="token punctuation">,</span> hidden_size<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>gru <span class="token operator">=</span> nn<span class="token punctuation">.</span>GRU<span class="token punctuation">(</span>hidden_size<span class="token punctuation">,</span> hidden_size<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>out <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>hidden_size<span class="token punctuation">,</span> output_size<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>softmax <span class="token operator">=</span> nn<span class="token punctuation">.</span>LogSoftmax<span class="token punctuation">(</span>dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input<span class="token punctuation">,</span> hidden<span class="token punctuation">)</span><span class="token punctuation">:</span>        output <span class="token operator">=</span> self<span class="token punctuation">.</span>embedding<span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>        output <span class="token operator">=</span> F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>output<span class="token punctuation">)</span>        output<span class="token punctuation">,</span> hidden <span class="token operator">=</span> self<span class="token punctuation">.</span>gru<span class="token punctuation">(</span>output<span class="token punctuation">,</span> hidden<span class="token punctuation">)</span>        output <span class="token operator">=</span> self<span class="token punctuation">.</span>softmax<span class="token punctuation">(</span>self<span class="token punctuation">.</span>out<span class="token punctuation">(</span>output<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> output<span class="token punctuation">,</span> hidden    <span class="token keyword">def</span> <span class="token function">initHidden</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> torch<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>hidden_size<span class="token punctuation">,</span> device<span class="token operator">=</span>device<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>I encourage you to train and observe the results of this model, but to<br>save space weâ€™ll be going straight for the gold and introducing the<br>Attention Mechanism.</p><p>Attention Decoder<br>^^^^^^^^^^^^^^^^^</p><p>If only the context vector is passed between the encoder and decoder,<br>that single vector carries the burden of encoding the entire sentence.</p><p>Attention allows the decoder network to â€œfocusâ€ on a different part of<br>the encoderâ€™s outputs for every step of the decoderâ€™s own outputs. First<br>we calculate a set of <em>attention weights</em>. These will be multiplied by<br>the encoder output vectors to create a weighted combination. The result<br>(called <code>attn_applied</code> in the code) should contain information about<br>that specific part of the input sequence, and thus help the decoder<br>choose the right output words.</p><p>.. figure:: <a href="https://i.imgur.com/1152PYf.png" target="_blank" rel="noopener">https://i.imgur.com/1152PYf.png</a><br>   :alt:</p><p>Calculating the attention weights is done with another feed-forward<br>layer <code>attn</code>, using the decoderâ€™s input and hidden state as inputs.<br>Because there are sentences of all sizes in the training data, to<br>actually create and train this layer we have to choose a maximum<br>sentence length (input length, for encoder outputs) that it can apply<br>to. Sentences of the maximum length will use all the attention weights,<br>while shorter sentences will only use the first few.</p><p>.. figure:: /_static/img/seq-seq-images/attention-decoder-network.png<br>   :alt:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">AttnDecoderRNN</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> hidden_size<span class="token punctuation">,</span> output_size<span class="token punctuation">,</span> dropout_p<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span> max_length<span class="token operator">=</span>MAX_LENGTH<span class="token punctuation">)</span><span class="token punctuation">:</span>        super<span class="token punctuation">(</span>AttnDecoderRNN<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>hidden_size <span class="token operator">=</span> hidden_size        self<span class="token punctuation">.</span>output_size <span class="token operator">=</span> output_size        self<span class="token punctuation">.</span>dropout_p <span class="token operator">=</span> dropout_p        self<span class="token punctuation">.</span>max_length <span class="token operator">=</span> max_length        self<span class="token punctuation">.</span>embedding <span class="token operator">=</span> nn<span class="token punctuation">.</span>Embedding<span class="token punctuation">(</span>self<span class="token punctuation">.</span>output_size<span class="token punctuation">,</span> self<span class="token punctuation">.</span>hidden_size<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>attn <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>self<span class="token punctuation">.</span>hidden_size <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>max_length<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>attn_combine <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>self<span class="token punctuation">.</span>hidden_size <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>hidden_size<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>dropout <span class="token operator">=</span> nn<span class="token punctuation">.</span>Dropout<span class="token punctuation">(</span>self<span class="token punctuation">.</span>dropout_p<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>gru <span class="token operator">=</span> nn<span class="token punctuation">.</span>GRU<span class="token punctuation">(</span>self<span class="token punctuation">.</span>hidden_size<span class="token punctuation">,</span> self<span class="token punctuation">.</span>hidden_size<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>out <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>self<span class="token punctuation">.</span>hidden_size<span class="token punctuation">,</span> self<span class="token punctuation">.</span>output_size<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input<span class="token punctuation">,</span> hidden<span class="token punctuation">,</span> encoder_outputs<span class="token punctuation">)</span><span class="token punctuation">:</span>        embedded <span class="token operator">=</span> self<span class="token punctuation">.</span>embedding<span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>        embedded <span class="token operator">=</span> self<span class="token punctuation">.</span>dropout<span class="token punctuation">(</span>embedded<span class="token punctuation">)</span>        attn_weights <span class="token operator">=</span> F<span class="token punctuation">.</span>softmax<span class="token punctuation">(</span>            self<span class="token punctuation">.</span>attn<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span><span class="token punctuation">(</span>embedded<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> hidden<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>        attn_applied <span class="token operator">=</span> torch<span class="token punctuation">.</span>bmm<span class="token punctuation">(</span>attn_weights<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                                 encoder_outputs<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        output <span class="token operator">=</span> torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span><span class="token punctuation">(</span>embedded<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> attn_applied<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>        output <span class="token operator">=</span> self<span class="token punctuation">.</span>attn_combine<span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>        output <span class="token operator">=</span> F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>output<span class="token punctuation">)</span>        output<span class="token punctuation">,</span> hidden <span class="token operator">=</span> self<span class="token punctuation">.</span>gru<span class="token punctuation">(</span>output<span class="token punctuation">,</span> hidden<span class="token punctuation">)</span>        output <span class="token operator">=</span> F<span class="token punctuation">.</span>log_softmax<span class="token punctuation">(</span>self<span class="token punctuation">.</span>out<span class="token punctuation">(</span>output<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> output<span class="token punctuation">,</span> hidden<span class="token punctuation">,</span> attn_weights    <span class="token keyword">def</span> <span class="token function">initHidden</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> torch<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>hidden_size<span class="token punctuation">,</span> device<span class="token operator">=</span>device<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="alert alert-info"><h4>Note</h4><p>There are other forms of attention that work around the length  limitation by using a relative position approach. Read about "local  attention" in `Effective Approaches to Attention-based Neural Machine  Translation <https: arxiv.org abs 1508.04025>`__.</https:></p></div><h1 id="Training"><a href="#Training" class="headerlink" title="Training"></a>Training</h1><h2 id="Preparing-Training-Data"><a href="#Preparing-Training-Data" class="headerlink" title="Preparing Training Data"></a>Preparing Training Data</h2><p>To train, for each pair we will need an input tensor (indexes of the<br>words in the input sentence) and target tensor (indexes of the words in<br>the target sentence). While creating these vectors we will append the<br>EOS token to both sequences.</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">indexesFromSentence</span><span class="token punctuation">(</span>lang<span class="token punctuation">,</span> sentence<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token punctuation">[</span>lang<span class="token punctuation">.</span>word2index<span class="token punctuation">[</span>word<span class="token punctuation">]</span> <span class="token keyword">for</span> word <span class="token keyword">in</span> sentence<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">tensorFromSentence</span><span class="token punctuation">(</span>lang<span class="token punctuation">,</span> sentence<span class="token punctuation">)</span><span class="token punctuation">:</span>    indexes <span class="token operator">=</span> indexesFromSentence<span class="token punctuation">(</span>lang<span class="token punctuation">,</span> sentence<span class="token punctuation">)</span>    indexes<span class="token punctuation">.</span>append<span class="token punctuation">(</span>EOS_token<span class="token punctuation">)</span>    <span class="token keyword">return</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>indexes<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>long<span class="token punctuation">,</span> device<span class="token operator">=</span>device<span class="token punctuation">)</span><span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">tensorsFromPair</span><span class="token punctuation">(</span>pair<span class="token punctuation">)</span><span class="token punctuation">:</span>    input_tensor <span class="token operator">=</span> tensorFromSentence<span class="token punctuation">(</span>input_lang<span class="token punctuation">,</span> pair<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    target_tensor <span class="token operator">=</span> tensorFromSentence<span class="token punctuation">(</span>output_lang<span class="token punctuation">,</span> pair<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>input_tensor<span class="token punctuation">,</span> target_tensor<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Training-the-Model"><a href="#Training-the-Model" class="headerlink" title="Training the Model"></a>Training the Model</h2><p>To train we run the input sentence through the encoder, and keep track<br>of every output and the latest hidden state. Then the decoder is given<br>the <code>&lt;SOS&gt;</code> token as its first input, and the last hidden state of the<br>encoder as its first hidden state.</p><p>â€œTeacher forcingâ€ is the concept of using the real target outputs as<br>each next input, instead of using the decoderâ€™s guess as the next input.<br>Using teacher forcing causes it to converge faster but <code>when the trainednetwork is exploited, it may exhibitinstability &lt;http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.378.4095&amp;rep=rep1&amp;type=pdf&gt;</code>__.</p><p>You can observe outputs of teacher-forced networks that read with<br>coherent grammar but wander far from the correct translation -<br>intuitively it has learned to represent the output grammar and can â€œpick<br>upâ€ the meaning once the teacher tells it the first few words, but it<br>has not properly learned how to create the sentence from the translation<br>in the first place.</p><p>Because of the freedom PyTorchâ€™s autograd gives us, we can randomly<br>choose to use teacher forcing or not with a simple if statement. Turn<br><code>teacher_forcing_ratio</code> up to use more of it.</p><pre class="line-numbers language-python"><code class="language-python">teacher_forcing_ratio <span class="token operator">=</span> <span class="token number">0.</span><span class="token number">5def</span> train<span class="token punctuation">(</span>input_tensor<span class="token punctuation">,</span> target_tensor<span class="token punctuation">,</span> encoder<span class="token punctuation">,</span> decoder<span class="token punctuation">,</span> encoder_optimizer<span class="token punctuation">,</span> decoder_optimizer<span class="token punctuation">,</span> criterion<span class="token punctuation">,</span> max_length<span class="token operator">=</span>MAX_LENGTH<span class="token punctuation">)</span><span class="token punctuation">:</span>    encoder_hidden <span class="token operator">=</span> encoder<span class="token punctuation">.</span>initHidden<span class="token punctuation">(</span><span class="token punctuation">)</span>    encoder_optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>    decoder_optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>    input_length <span class="token operator">=</span> input_tensor<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    target_length <span class="token operator">=</span> target_tensor<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    encoder_outputs <span class="token operator">=</span> torch<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>max_length<span class="token punctuation">,</span> encoder<span class="token punctuation">.</span>hidden_size<span class="token punctuation">,</span> device<span class="token operator">=</span>device<span class="token punctuation">)</span>    loss <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> ei <span class="token keyword">in</span> range<span class="token punctuation">(</span>input_length<span class="token punctuation">)</span><span class="token punctuation">:</span>        encoder_output<span class="token punctuation">,</span> encoder_hidden <span class="token operator">=</span> encoder<span class="token punctuation">(</span>            input_tensor<span class="token punctuation">[</span>ei<span class="token punctuation">]</span><span class="token punctuation">,</span> encoder_hidden<span class="token punctuation">)</span>        encoder_outputs<span class="token punctuation">[</span>ei<span class="token punctuation">]</span> <span class="token operator">=</span> encoder_output<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>    decoder_input <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span>SOS_token<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> device<span class="token operator">=</span>device<span class="token punctuation">)</span>    decoder_hidden <span class="token operator">=</span> encoder_hidden    use_teacher_forcing <span class="token operator">=</span> <span class="token boolean">True</span> <span class="token keyword">if</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> teacher_forcing_ratio <span class="token keyword">else</span> <span class="token boolean">False</span>    <span class="token keyword">if</span> use_teacher_forcing<span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># Teacher forcing: Feed the target as the next input        for di in range(target_length):            decoder_output, decoder_hidden, decoder_attention = decoder(                decoder_input, decoder_hidden, encoder_outputs)            loss += criterion(decoder_output, target_tensor[di])            decoder_input = target_tensor[di]  # Teacher forcing    else:        # Without teacher forcing: use its own predictions as the next input        for di in range(target_length):            decoder_output, decoder_hidden, decoder_attention = decoder(                decoder_input, decoder_hidden, encoder_outputs)            topv, topi = decoder_output.topk(1)            decoder_input = topi.squeeze().detach()  # detach from history as input            loss += criterion(decoder_output, target_tensor[di])            if decoder_input.item() == EOS_token:                break    loss.backward()    encoder_optimizer.step()    decoder_optimizer.step()    return loss.item() / target_length</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>This is a helper function to print time elapsed and estimated time<br>remaining given the current time and progress %.</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> timeimport mathdef asMinutes<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>    m <span class="token operator">=</span> math<span class="token punctuation">.</span>floor<span class="token punctuation">(</span>s <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">)</span>    s <span class="token operator">-=</span> m <span class="token operator">*</span> <span class="token number">60</span>    <span class="token keyword">return</span> <span class="token string">'%dm %ds'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>m<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token keyword">def</span> timeSince<span class="token punctuation">(</span>since<span class="token punctuation">,</span> percent<span class="token punctuation">)</span><span class="token punctuation">:</span>    now <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    s <span class="token operator">=</span> now <span class="token operator">-</span> since    es <span class="token operator">=</span> s <span class="token operator">/</span> <span class="token punctuation">(</span>percent<span class="token punctuation">)</span>    rs <span class="token operator">=</span> es <span class="token operator">-</span> s    <span class="token keyword">return</span> <span class="token string">'%s (- %s)'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>asMinutes<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> asMinutes<span class="token punctuation">(</span>rs<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>The whole training process looks like this:</p><ul><li>Start a timer</li><li>Initialize optimizers and criterion</li><li>Create set of training pairs</li><li>Start empty losses array for plotting</li></ul><p>Then we call <code>train</code> many times and occasionally print the progress (%<br>of examples, time so far, estimated time) and average loss.</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">trainIters</span><span class="token punctuation">(</span>encoder<span class="token punctuation">,</span> decoder<span class="token punctuation">,</span> n_iters<span class="token punctuation">,</span> print_every<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span> plot_every<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> learning_rate<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    plot_losses <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    print_loss_total <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment" spellcheck="true"># Reset every print_every</span>    plot_loss_total <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment" spellcheck="true"># Reset every plot_every</span>    encoder_optimizer <span class="token operator">=</span> optim<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span>encoder<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span>learning_rate<span class="token punctuation">)</span>    decoder_optimizer <span class="token operator">=</span> optim<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span>decoder<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span>learning_rate<span class="token punctuation">)</span>    training_pairs <span class="token operator">=</span> <span class="token punctuation">[</span>tensorsFromPair<span class="token punctuation">(</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>pairs<span class="token punctuation">)</span><span class="token punctuation">)</span>                      <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>n_iters<span class="token punctuation">)</span><span class="token punctuation">]</span>    criterion <span class="token operator">=</span> nn<span class="token punctuation">.</span>NLLLoss<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> iter <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> n_iters <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        training_pair <span class="token operator">=</span> training_pairs<span class="token punctuation">[</span>iter <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>        input_tensor <span class="token operator">=</span> training_pair<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        target_tensor <span class="token operator">=</span> training_pair<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        loss <span class="token operator">=</span> train<span class="token punctuation">(</span>input_tensor<span class="token punctuation">,</span> target_tensor<span class="token punctuation">,</span> encoder<span class="token punctuation">,</span>                     decoder<span class="token punctuation">,</span> encoder_optimizer<span class="token punctuation">,</span> decoder_optimizer<span class="token punctuation">,</span> criterion<span class="token punctuation">)</span>        print_loss_total <span class="token operator">+=</span> loss        plot_loss_total <span class="token operator">+=</span> loss        <span class="token keyword">if</span> iter <span class="token operator">%</span> print_every <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            print_loss_avg <span class="token operator">=</span> print_loss_total <span class="token operator">/</span> print_every            print_loss_total <span class="token operator">=</span> <span class="token number">0</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'%s (%d %d%%) %.4f'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>timeSince<span class="token punctuation">(</span>start<span class="token punctuation">,</span> iter <span class="token operator">/</span> n_iters<span class="token punctuation">)</span><span class="token punctuation">,</span>                                         iter<span class="token punctuation">,</span> iter <span class="token operator">/</span> n_iters <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span> print_loss_avg<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> iter <span class="token operator">%</span> plot_every <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            plot_loss_avg <span class="token operator">=</span> plot_loss_total <span class="token operator">/</span> plot_every            plot_losses<span class="token punctuation">.</span>append<span class="token punctuation">(</span>plot_loss_avg<span class="token punctuation">)</span>            plot_loss_total <span class="token operator">=</span> <span class="token number">0</span>    showPlot<span class="token punctuation">(</span>plot_losses<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Plotting-results"><a href="#Plotting-results" class="headerlink" title="Plotting results"></a>Plotting results</h2><p>Plotting is done with matplotlib, using the array of loss values<br><code>plot_losses</code> saved while training.</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> pltplt<span class="token punctuation">.</span>switch_backend<span class="token punctuation">(</span><span class="token string">'agg'</span><span class="token punctuation">)</span><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>ticker <span class="token keyword">as</span> ticker<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">def</span> <span class="token function">showPlot</span><span class="token punctuation">(</span>points<span class="token punctuation">)</span><span class="token punctuation">:</span>    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>    fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># this locator puts ticks at regular intervals</span>    loc <span class="token operator">=</span> ticker<span class="token punctuation">.</span>MultipleLocator<span class="token punctuation">(</span>base<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span>    ax<span class="token punctuation">.</span>yaxis<span class="token punctuation">.</span>set_major_locator<span class="token punctuation">(</span>loc<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>points<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="Evaluation"><a href="#Evaluation" class="headerlink" title="Evaluation"></a>Evaluation</h1><p>Evaluation is mostly the same as training, but there are no targets so<br>we simply feed the decoderâ€™s predictions back to itself for each step.<br>Every time it predicts a word we add it to the output string, and if it<br>predicts the EOS token we stop there. We also store the decoderâ€™s<br>attention outputs for display later.</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">evaluate</span><span class="token punctuation">(</span>encoder<span class="token punctuation">,</span> decoder<span class="token punctuation">,</span> sentence<span class="token punctuation">,</span> max_length<span class="token operator">=</span>MAX_LENGTH<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        input_tensor <span class="token operator">=</span> tensorFromSentence<span class="token punctuation">(</span>input_lang<span class="token punctuation">,</span> sentence<span class="token punctuation">)</span>        input_length <span class="token operator">=</span> input_tensor<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        encoder_hidden <span class="token operator">=</span> encoder<span class="token punctuation">.</span>initHidden<span class="token punctuation">(</span><span class="token punctuation">)</span>        encoder_outputs <span class="token operator">=</span> torch<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>max_length<span class="token punctuation">,</span> encoder<span class="token punctuation">.</span>hidden_size<span class="token punctuation">,</span> device<span class="token operator">=</span>device<span class="token punctuation">)</span>        <span class="token keyword">for</span> ei <span class="token keyword">in</span> range<span class="token punctuation">(</span>input_length<span class="token punctuation">)</span><span class="token punctuation">:</span>            encoder_output<span class="token punctuation">,</span> encoder_hidden <span class="token operator">=</span> encoder<span class="token punctuation">(</span>input_tensor<span class="token punctuation">[</span>ei<span class="token punctuation">]</span><span class="token punctuation">,</span>                                                     encoder_hidden<span class="token punctuation">)</span>            encoder_outputs<span class="token punctuation">[</span>ei<span class="token punctuation">]</span> <span class="token operator">+=</span> encoder_output<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>        decoder_input <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span>SOS_token<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> device<span class="token operator">=</span>device<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># SOS        decoder_hidden = encoder_hidden        decoded_words = []        decoder_attentions = torch.zeros(max_length, max_length)        for di in range(max_length):            decoder_output, decoder_hidden, decoder_attention = decoder(                decoder_input, decoder_hidden, encoder_outputs)            decoder_attentions[di] = decoder_attention.data            topv, topi = decoder_output.data.topk(1)            if topi.item() == EOS_token:                decoded_words.append('&lt;EOS>')                break            else:                decoded_words.append(output_lang.index2word[topi.item()])            decoder_input = topi.squeeze().detach()        return decoded_words, decoder_attentions[:di + 1]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>We can evaluate random sentences from the training set and print out the<br>input, target, and output to make some subjective quality judgements:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">evaluateRandomly</span><span class="token punctuation">(</span>encoder<span class="token punctuation">,</span> decoder<span class="token punctuation">,</span> n<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>        pair <span class="token operator">=</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>pairs<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'>'</span><span class="token punctuation">,</span> pair<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'='</span><span class="token punctuation">,</span> pair<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        output_words<span class="token punctuation">,</span> attentions <span class="token operator">=</span> evaluate<span class="token punctuation">(</span>encoder<span class="token punctuation">,</span> decoder<span class="token punctuation">,</span> pair<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        output_sentence <span class="token operator">=</span> <span class="token string">' '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>output_words<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'&lt;'</span><span class="token punctuation">,</span> output_sentence<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="Training-and-Evaluating"><a href="#Training-and-Evaluating" class="headerlink" title="Training and Evaluating"></a>Training and Evaluating</h1><p>With all these helper functions in place (it looks like extra work, but<br>it makes it easier to run multiple experiments) we can actually<br>initialize a network and start training.</p><p>Remember that the input sentences were heavily filtered. For this small<br>dataset we can use relatively small networks of 256 hidden nodes and a<br>single GRU layer. After about 40 minutes on a MacBook CPU weâ€™ll get some<br>reasonable results.</p><p>.. Note::<br>   If you run this notebook you can train, interrupt the kernel,<br>   evaluate, and continue training later. Comment out the lines where the<br>   encoder and decoder are initialized and run <code>trainIters</code> again.</p><pre class="line-numbers language-python"><code class="language-python">hidden_size <span class="token operator">=</span> 256encoder1 <span class="token operator">=</span> EncoderRNN<span class="token punctuation">(</span>input_lang<span class="token punctuation">.</span>n_words<span class="token punctuation">,</span> hidden_size<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>attn_decoder1 <span class="token operator">=</span> AttnDecoderRNN<span class="token punctuation">(</span>hidden_size<span class="token punctuation">,</span> output_lang<span class="token punctuation">.</span>n_words<span class="token punctuation">,</span> dropout_p<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>trainIters<span class="token punctuation">(</span>encoder1<span class="token punctuation">,</span> attn_decoder1<span class="token punctuation">,</span> <span class="token number">75000</span><span class="token punctuation">,</span> print_every<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>1m 42s (- 23m 50s) (5000 6%) 2.89263m 20s (- 21m 44s) (10000 13%) 2.28444m 58s (- 19m 54s) (15000 20%) 1.95386m 37s (- 18m 13s) (20000 26%) 1.70868m 15s (- 16m 31s) (25000 33%) 1.51529m 53s (- 14m 50s) (30000 40%) 1.332411m 32s (- 13m 11s) (35000 46%) 1.221113m 11s (- 11m 32s) (40000 53%) 1.080514m 50s (- 9m 53s) (45000 60%) 0.964816m 29s (- 8m 14s) (50000 66%) 0.884618m 8s (- 6m 35s) (55000 73%) 0.779919m 47s (- 4m 56s) (60000 80%) 0.708521m 25s (- 3m 17s) (65000 86%) 0.654823m 5s (- 1m 38s) (70000 93%) 0.568424m 44s (- 0m 0s) (75000 100%) 0.5322</code></pre><pre class="line-numbers language-python"><code class="language-python">evaluateRandomly<span class="token punctuation">(</span>encoder1<span class="token punctuation">,</span> attn_decoder1<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>&gt; je reste avec toi .= i m staying with you .&lt; i m staying with you . &lt;EOS&gt;&gt; je ne suis plus ce que j etais .= i m not what i used to be .&lt; i m not what i have two . &lt;EOS&gt;&gt; il est derriere moi .= he s after me .&lt; he s after me . &lt;EOS&gt;&gt; tu es la meilleure .= you re the best .&lt; you re the best . &lt;EOS&gt;&gt; je vais a un concert la semaine prochaine .= i am going to a concert next week .&lt; i am going to go next next week . &lt;EOS&gt;&gt; je suis en pause dejeuner .= i m on my lunch break .&lt; i m on my lunch . &lt;EOS&gt;&gt; tu as tort dans ce cas .= you re wrong in this case .&lt; you re wrong in this case . &lt;EOS&gt;&gt; je m y habitue .= i m getting used to it .&lt; i m getting on it . &lt;EOS&gt;&gt; je suis dispose a faire mes excuses .= i m willing to apologize .&lt; i m willing to go all . &lt;EOS&gt;&gt; il est habile a trouver des pretextes .= he is clever at making excuses .&lt; he is at certain of us . &lt;EOS&gt;</code></pre><p>â€‹    </p><h2 id="Visualizing-Attention"><a href="#Visualizing-Attention" class="headerlink" title="Visualizing Attention"></a>Visualizing Attention</h2><p>A useful property of the attention mechanism is its highly interpretable<br>outputs. Because it is used to weight specific encoder outputs of the<br>input sequence, we can imagine looking where the network is focused most<br>at each time step.</p><p>You could simply run <code>plt.matshow(attentions)</code> to see attention output<br>displayed as a matrix, with the columns being input steps and rows being<br>output steps:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token operator">%</span>matplotlib inlineoutput_words<span class="token punctuation">,</span> attentions <span class="token operator">=</span> evaluate<span class="token punctuation">(</span>    encoder1<span class="token punctuation">,</span> attn_decoder1<span class="token punctuation">,</span> <span class="token string">"elle a cinq ans de moins que moi ."</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>matshow<span class="token punctuation">(</span>attentions<span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>&lt;matplotlib.image.AxesImage at 0x7fd35181a810&gt;</code></pre><p>â€‹<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="seq2seq_translation_files/seq2seq_translation_43_1.png" alt="png"><br>â€‹    </p><p>For a better viewing experience we will do the extra work of adding axes<br>and labels:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">showAttention</span><span class="token punctuation">(</span>input_sentence<span class="token punctuation">,</span> output_words<span class="token punctuation">,</span> attentions<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># Set up figure with colorbar</span>    fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>    ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span>    cax <span class="token operator">=</span> ax<span class="token punctuation">.</span>matshow<span class="token punctuation">(</span>attentions<span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'bone'</span><span class="token punctuation">)</span>    fig<span class="token punctuation">.</span>colorbar<span class="token punctuation">(</span>cax<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># Set up axes</span>    ax<span class="token punctuation">.</span>set_xticklabels<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">''</span><span class="token punctuation">]</span> <span class="token operator">+</span> input_sentence<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span> <span class="token operator">+</span>                       <span class="token punctuation">[</span><span class="token string">'&lt;EOS>'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rotation<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">)</span>    ax<span class="token punctuation">.</span>set_yticklabels<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">''</span><span class="token punctuation">]</span> <span class="token operator">+</span> output_words<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># Show label at every tick</span>    ax<span class="token punctuation">.</span>xaxis<span class="token punctuation">.</span>set_major_locator<span class="token punctuation">(</span>ticker<span class="token punctuation">.</span>MultipleLocator<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    ax<span class="token punctuation">.</span>yaxis<span class="token punctuation">.</span>set_major_locator<span class="token punctuation">(</span>ticker<span class="token punctuation">.</span>MultipleLocator<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">evaluateAndShowAttention</span><span class="token punctuation">(</span>input_sentence<span class="token punctuation">)</span><span class="token punctuation">:</span>    output_words<span class="token punctuation">,</span> attentions <span class="token operator">=</span> evaluate<span class="token punctuation">(</span>        encoder1<span class="token punctuation">,</span> attn_decoder1<span class="token punctuation">,</span> input_sentence<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'input ='</span><span class="token punctuation">,</span> input_sentence<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'output ='</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>output_words<span class="token punctuation">)</span><span class="token punctuation">)</span>    showAttention<span class="token punctuation">(</span>input_sentence<span class="token punctuation">,</span> output_words<span class="token punctuation">,</span> attentions<span class="token punctuation">)</span>evaluateAndShowAttention<span class="token punctuation">(</span><span class="token string">"elle a cinq ans de moins que moi ."</span><span class="token punctuation">)</span>evaluateAndShowAttention<span class="token punctuation">(</span><span class="token string">"elle est trop petit ."</span><span class="token punctuation">)</span>evaluateAndShowAttention<span class="token punctuation">(</span><span class="token string">"je ne crains pas de mourir ."</span><span class="token punctuation">)</span>evaluateAndShowAttention<span class="token punctuation">(</span><span class="token string">"c est un jeune directeur plein de talent ."</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>input = elle a cinq ans de moins que moi .output = she s five years younger than i am . &lt;EOS&gt;input = elle est trop petit .output = she is too slow . &lt;EOS&gt;input = je ne crains pas de mourir .output = i m not afraid that to die . &lt;EOS&gt;/opt/conda/lib/python3.7/site-packages/ipykernel_launcher.py:10: UserWarning: FixedFormatter should only be used together with FixedLocator  # Remove the CWD from sys.path while we load stuff./opt/conda/lib/python3.7/site-packages/ipykernel_launcher.py:11: UserWarning: FixedFormatter should only be used together with FixedLocator  # This is added back by InteractiveShellApp.init_path()input = c est un jeune directeur plein de talent .output = he s a talented young . &lt;EOS&gt;</code></pre><h1 id="Exercises"><a href="#Exercises" class="headerlink" title="Exercises"></a>Exercises</h1><ul><li><p>Try with a different dataset</p><ul><li>Another language pair</li><li>Human â†’ Machine (e.g. IOT commands)</li><li>Chat â†’ Response</li><li>Question â†’ Answer</li></ul></li><li><p>Replace the embeddings with pre-trained word embeddings such as word2vec or<br>GloVe</p></li><li><p>Try with more layers, more hidden units, and more sentences. Compare<br>the training time and results.</p></li><li><p>If you use a translation file where pairs have two of the same phrase<br>(<code>I am test \t I am test</code>), you can use this as an autoencoder. Try<br>this:</p><ul><li>Train as an autoencoder</li><li>Save only the Encoder network</li><li>Train a new Decoder for translation from there</li></ul></li></ul><pre class="line-numbers language-python"><code class="language-python">evaluateAndShowAttention<span class="token punctuation">(</span><span class="token string">"je vous aime"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>input = je vous aimeoutput = i m losing it &lt;EOS&gt;/opt/conda/lib/python3.7/site-packages/ipykernel_launcher.py:10: UserWarning: FixedFormatter should only be used together with FixedLocator  # Remove the CWD from sys.path while we load stuff./opt/conda/lib/python3.7/site-packages/ipykernel_launcher.py:11: UserWarning: FixedFormatter should only be used together with FixedLocator  # This is added back by InteractiveShellApp.init_path()</code></pre><pre class="line-numbers language-python"><code class="language-python">evaluateAndShowAttention<span class="token punctuation">(</span><span class="token string">"elle a cinq ans de moins que moi"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>input = elle a cinq ans de moins que moioutput = she s five years younger than i am . &lt;EOS&gt;/opt/conda/lib/python3.7/site-packages/ipykernel_launcher.py:10: UserWarning: FixedFormatter should only be used together with FixedLocator  # Remove the CWD from sys.path while we load stuff./opt/conda/lib/python3.7/site-packages/ipykernel_launcher.py:11: UserWarning: FixedFormatter should only be used together with FixedLocator  # This is added back by InteractiveShellApp.init_path()</code></pre><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># æ¨¡å‹ä¿å­˜</span>torch<span class="token punctuation">.</span>save<span class="token punctuation">(</span>encoder1<span class="token punctuation">,</span> <span class="token string">'/kaggle/working/encoder1.pkl'</span><span class="token punctuation">)</span>torch<span class="token punctuation">.</span>save<span class="token punctuation">(</span>attn_decoder1<span class="token punctuation">,</span> <span class="token string">'/kaggle/working/attn_decoder1.pkl'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python"><code class="language-python"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NLP </tag>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> seq2seq_translation </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>latexå¸¸ç”¨å…¬å¼ï¼ˆé¾Ÿé€Ÿæ›´æ–°ï¼‰</title>
      <link href="/2021/09/18/latex-chang-yong-gong-shi-gui-su-geng-xin/"/>
      <url>/2021/09/18/latex-chang-yong-gong-shi-gui-su-geng-xin/</url>
      
        <content type="html"><![CDATA[<h2 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h2><p>å®é™…ä¸Šlatexå…¬å¼å°±åƒmarkdownä¸€æ ·ï¼Œä¸éœ€è¦æ ¼å¤–å»è®°ï¼Œä½†æ˜¯æƒ³æ‰¾çš„æ—¶å€™æœ‰æ—¶å€™å¹¶ä¸å®¹æ˜“æ‰¾ã€‚æ‰€ä»¥è¿™é‡Œå°±ä½¿ç”¨è¿™ä¸ªæ¥è®°å½•ä¸€ä¸‹latexæœ‰å…³å…¬å¼ï¼Œä»¥é˜²å¿˜è®°ã€‚</p><p>å¦å¤–è¿™ä¸€ç¯‡åšæ–‡å…¶å®æ•´ç†çš„æä¸ºè¯¦ç»†äº†ï¼š<a href="https://blog.csdn.net/NSJim/article/details/109045914" target="_blank" rel="noopener">https://blog.csdn.net/NSJim/article/details/109045914</a></p><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><ol><li>ä½¿ç”¨<code>$</code>ï¼Œå³è¡Œä¸­å…¬å¼æ—¶ï¼Œæ•°å­¦å…¬å¼ä¸<code>$</code>è¿æ¥å¤„ä¸è¦æœ‰ç©ºæ ¼ï¼Œå¦åˆ™å…¬å¼ä¸ä¼šæ˜¾ç¤ºã€‚å³<code>$</code>  æ•°å­¦å…¬å¼  <code>$</code> ä¸æ˜¾ç¤ºå…¬å¼ã€‚</li><li>ä½¿ç”¨<code>$$</code>ï¼Œå³å±…ä¸­å…¬å¼æ—¶ï¼Œæ•°å­¦å…¬å¼ä¸<code>$$</code>è¿æ¥å¤„å¯ä»¥æœ‰ç©ºæ ¼ã€‚</li><li>ä½¿ç”¨<code>$$</code>æ—¶ï¼Œä¸Šæ–¹è¦ç©ºä¸€è¡Œã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> æŒ‡ä»¤é›† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> latex </tag>
            
            <tag> å…¬å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>backbone neck and head</title>
      <link href="/2021/09/16/backbone-neck-and-head/"/>
      <url>/2021/09/16/backbone-neck-and-head/</url>
      
        <content type="html"><![CDATA[<p>åŸºäºæ·±åº¦å­¦ä¹ çš„ç°åœ¨ç›®æ ‡æ£€æµ‹ç®—æ³•ä¸­æœ‰ä¸‰ä¸ªç»„ä»¶ï¼šBackboneã€Neckå’ŒHeadï¼Œä¹ä¸€çœ‹å¾ˆè®©äººä¸ç†è§£ï¼š</p><ul><li>Backbone, è¯‘ä½œéª¨å¹²ç½‘ç»œï¼Œä¸»è¦æŒ‡ç”¨äºç‰¹å¾æå–çš„ï¼Œå·²åœ¨å¤§å‹æ•°æ®é›†(ä¾‹å¦‚ImageNet|COCOç­‰)ä¸Šå®Œæˆé¢„è®­ç»ƒï¼Œæ‹¥æœ‰é¢„è®­ç»ƒå‚æ•°çš„å·ç§¯ç¥ç»ç½‘ç»œï¼Œä¾‹å¦‚ï¼šResNet-50ã€Darknet53ç­‰</li><li>Headï¼Œè¯‘ä½œæ£€æµ‹å¤´ï¼Œä¸»è¦ç”¨äºé¢„æµ‹ç›®æ ‡çš„ç§ç±»å’Œä½ç½®(bounding boxes)</li><li>åœ¨Backoneå’ŒHeadä¹‹é—´ï¼Œä¼šæ·»åŠ ä¸€äº›ç”¨äºæ”¶é›†ä¸åŒé˜¶æ®µä¸­ç‰¹å¾å›¾çš„ç½‘ç»œå±‚ï¼Œé€šå¸¸ç§°ä¸ºNeckã€‚</li></ul><p>ç®€è€Œè¨€ä¹‹ï¼ŒåŸºäºæ·±åº¦å­¦ä¹ çš„ç›®æ ‡æ£€æµ‹æ¨¡å‹çš„ç»“æ„æ˜¯è¿™æ ·çš„ï¼šè¾“å…¥-&gt;ä¸»å¹²-&gt;è„–å­-&gt;å¤´-&gt;è¾“å‡ºã€‚ä¸»å¹²ç½‘ç»œæå–ç‰¹å¾ï¼Œè„–å­æå–ä¸€äº›æ›´å¤æ‚çš„ç‰¹å¾ï¼Œç„¶åå¤´éƒ¨è®¡ç®—é¢„æµ‹è¾“å‡º</p><p><a href="https://imgtu.com/i/4u9aYF" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/09/16/4u9aYF.png" alt="ç›®æ ‡æ£€æµ‹çš„ç½‘ç»œç»“æ„"></a></p><p>ä½œè€…ï¼šLabVIEW_Python<br>é“¾æ¥ï¼š<a href="https://www.jianshu.com/p/014e76d3b614" target="_blank" rel="noopener">https://www.jianshu.com/p/014e76d3b614</a><br>æ¥æºï¼šç®€ä¹¦<br>è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç›®æ ‡æ£€æµ‹ </tag>
            
            <tag> åè¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®ºæ–‡ä¹‹YOLOç³»åˆ—</title>
      <link href="/2021/09/16/lun-wen-zhi-yolo-xi-lie/"/>
      <url>/2021/09/16/lun-wen-zhi-yolo-xi-lie/</url>
      
        <content type="html"><![CDATA[<p>æœ¬åšå®¢è®°å½•äº†è‡ªå·±çš„ä¸€äº›YOLOè®ºæ–‡çš„é˜…è¯»ã€‚</p><h1 id="YOLOv1"><a href="#YOLOv1" class="headerlink" title="YOLOv1"></a>YOLOv1</h1><blockquote><p>è®ºæ–‡åœ°å€ï¼š<a href="https://arxiv.org/abs/1506.02640" target="_blank" rel="noopener">https://arxiv.org/abs/1506.02640</a></p><p>è®ºæ–‡ç¿»è¯‘ç‰ˆï¼š<a href="https://zhuanlan.zhihu.com/p/35416826" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/35416826</a></p><p>å°±éšä¾¿è®°å½•ä¸€äº›æƒ³æ³•ã€‚</p></blockquote><h2 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h2><p>ä½œè€…å¤§è‡´å¹äº†ä¸€ä¸‹ï¼Œæˆ‘çœ‹å¾—æ—©äº†ï¼Œæ²¡æœ‰è®°å½•ã€‚</p><h2 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h2><p>å‰é¢çš„ä¹Ÿçœ‹è¿‡å»äº†ï¼Œæ²¡æœ‰æ¥å¾—åŠè®°å½•ï¼ŒçŸ¥é“åæ¥çœ‹åˆ°äº†å…³äºseveral benefits over traditional methods of object detectionçš„ä¸€äº›ä¸œè¥¿æ‰å¼€å§‹è®°å½•ã€‚</p><p>First,  YOLO is very fast. Since they frame detection as a regression problem, they donâ€™t need a pipeline. The simply run their neural network on a new image at test time to predict. ä»–ä»¬å¯ä»¥å®æ—¶å¤„ç†å›¾ç‰‡ã€‚å°äº25millisecondsçš„å»¶è¿Ÿã€‚ç„¶åå¦å¤–å°±æ˜¯2å€çš„å¹³å‡å‡†ç¡®ç‡æ¯”èµ·å…¶ä»–çš„ç³»ç»Ÿã€‚åœ¨Titan X GPUä¸Šå¯ä»¥å¤„ç†45 frames per second. ä¸€ä¸ªå¿«é€Ÿçš„ç‰ˆæœ¬å¯ä»¥å¤„ç†è¶…è¿‡150fpsã€‚</p><p>Second, ä¸åŒäºä¼ ç»Ÿçš„æ»‘åŠ¨çª—å£ä¸åŒºåŸŸæ£€æµ‹æŠ€æœ¯ï¼ŒYOLOæ›´åŠ å…·æœ‰å…¨å±€æ€§ï¼ˆ<del>æˆ‘çç¼–çš„</del>ï¼‰ï¼Ÿå°±æ˜¯æ›´å®¹æ˜“è¿èµ·ä¸Šä¸‹æ¯”è¾ƒè¿è´¯çš„ï¼ˆcontextualï¼‰å›¾åƒä¿¡æ¯ã€‚ç‰¹æ„æåˆ°äº†å…³äºFast RCNN,å®ƒä¼šå°†ä¸€äº›èƒŒæ™¯å—ï¼ˆbackground patchesï¼‰é”™è¯¯çš„è®¤ä¸ºæ˜¯ç‰©ä½“ç›®æ ‡ï¼ˆobjectsï¼‰ã€‚å› ä¸ºFastRCNNä¸èƒ½å¤Ÿçœ‹åˆ°æ›´åŠ å¤§å—çš„ç‰©ä½“ä¿¡æ¯ã€‚å…³äºè¿™ç§çš„é”™è¯¯ç‡æ¯”Fast RCNN<strong>å°‘äº†ä¸€åŠ</strong>ï¼<strong><del>å°å°åæ§½ä¸€ä¸‹ï¼Œæœç„¶å¤§å®¶å‘è®ºæ–‡éƒ½ä¼šæ ¼å¤–å¼ºè°ƒåˆ«äººçš„ç¼ºç‚¹ï¼Œæ”¾å¤§è‡ªå·±çš„ä¼˜ç‚¹â€¦â€¦</del></strong></p><blockquote><p>coordinate   n.åæ ‡,å¥—è£…  v.ä½¿åè°ƒï¼Œæ­é…   contextual ä¸Šä¸‹æ–‡çš„ ï¼Œè¿è´¯çš„  patches n.å—ï¼Œè¡¥ä¸</p></blockquote><p>Third, æ›´å¥½çš„æ³›åŒ–èƒ½åŠ›ï¼Œè¿™ä¸ªæ®µè½æœ€å¥½æ‡‚ã€‚åœ¨è‡ªç„¶å›¾åƒä¸Šè®­ç»ƒç„¶åå†è‰ºæœ¯å“ä¸Šæµ‹è¯•çš„æ—¶å€™ï¼ŒYOLO outperforms top detection methods like DPM and R-CNN <strong>by a wide margin</strong>.çœ‹æ¥RCNNåå¤è¢«é­å°¸â€¦â€¦</p><p>Lastï¼Œ ç»ˆäºå¼€å§‹æ‰¿è®¤è‡ªå·±çš„ä¸è¶³äº†ï¼šå‡†ç¡®ç‡è½åäºSOTAï¼Œlags behind stoa detection systems in accuracy.  å°½ç®¡å¯ä»¥å¿«é€Ÿè®¤å‡ºç‰©ä½“ä½†æ˜¯å¾ˆå›°éš¾ç²¾ç¡®å®šä½åˆ°ä¸€äº›ç‰©ä½“ï¼Œå°¤å…¶æ˜¯å°ç‰©ä½“ï¼ˆstuggles to precisely localize some objects, especially small ones.)  , ä½œè€…ä¹Ÿè¯´åˆ°ä»¥åä¼šåšä¸€äº›è¿›ä¸€æ­¥çš„tradeoffsã€‚</p><h2 id="2-Unified-Detection"><a href="#2-Unified-Detection" class="headerlink" title="2. Unified Detection"></a>2. Unified Detection</h2><ul><li>å°†å›¾åƒåˆ†ä¸ºSÃ—Sçš„ç½‘æ ¼åŒºåŸŸï¼ˆgrids)ï¼Œå¦‚æœä¸€ä¸ªç‰©ä½“ä¸­å¿ƒå†æŸæ ¼ä¸­åˆ™è¯¥gridè´Ÿè´£é¢„æµ‹è¯¥ç‰©ä½“ã€‚</li></ul><blockquote><p>simultaneously adv.åŒæ—¶åœ°ï¼Œä¸€å£</p></blockquote><ul><li>æ¯ä¸ªgrid cellsé¢„æµ‹Bä¸ªbboxesäºconfidence scores(reflect how confident the model is that the box contains an object and also how accurate it thinks the box is that it predicts )</li><li>æ¯ä¸ªbboxåŒ…å«5ä¸ªpredictions: x, y, w, h and confidence. The (x, y) coordinates represent the center of the box. The  width and height are predicted relative to the whole image. Finally the confidence prediction  represents the IOU(Intersection over union between predicted box and the  ground box)</li><li>æ¯ä¸ªgrid cellå•å…ƒæ ¼åªé€‰å–ä¸€ä¸ªbboxæ¥é¢„æµ‹å†…å«ç‰©ä½“çš„ç±»åˆ«ï¼Œregardless of the number of boxes B.</li><li>æœ€åæµ‹è¯•ç¯èŠ‚æˆ‘ä»¬ä½¿ç”¨ç±»åˆ«æ¦‚ç‡ï¼ˆthe conditional class probabilitiesï¼‰å’Œæ¡†æ¦‚ç‡ï¼ˆ and the individual box confidence predictionsï¼‰çš„ä¹˜ç§¯æ¥è¯„ä¼°ï¼š<ul><li>$$Pr(Class | Object) * Pr(Object) * IOU(truth, pred)  = Pr(Class_i) * IOU(truth, pred)$$â€‹</li><li>è¿™ä¸ªscoreså¯ä»¥æ­£å¥½çš„æ¶µç›–äº†ç±»åˆ«å‡ºç°åœ¨è¯¥boxè¿˜æœ‰é¢„æµ‹çš„æ¡†çš„é€‚åº”èƒ½åŠ›ã€‚ï¼ˆencode both the probability of that class appearing in the box and how well the predicted box fits the objectï¼‰</li></ul></li></ul><p><a href="https://imgtu.com/i/4MhVzD" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/09/17/4MhVzD.png" alt="Figure 2: The Model"></a></p><p>Our system models detection as a regression problem. It divides the image into an S Ã— S grid and for each<br>grid cell predicts B bounding boxes, confidence for those boxes, and C class probabilities. These predictions are encoded as an S Ã— S Ã— (B âˆ— 5 + C) tensor.</p><ul><li><p>ä»¥ä¸Šçš„è¯è¯´å¾—éå¸¸æ˜æ˜¾äº†ï¼ŒæŒ‡çš„æ˜¯æˆ‘ä»¬æ¯ä¸ªgrid celléƒ½ä¼šè´Ÿè´£ä¸€ä¸ªé¢„æµ‹çš„åŒºåŸŸï¼Œç„¶åè¿™é‡Œåˆ†ä¸ºSÃ—Sä¸ªgrid cell, æœ€åå¾—åˆ°çš„tensorå½¢çŠ¶ä¸º S Ã— S Ã— (B âˆ— 5 + C) ï¼Œè¿™æ ·ä¸€æ¥æˆ‘ä»¬çš„æœ€ç»ˆç»“æœå°±å¾—åˆ°äº†ã€‚</p></li><li><p>å½“ç„¶æœ€åä¹Ÿç»™å‡ºäº†å¯¹äºä¸åŒæ•°æ®é›†çš„ä¸åŒSï¼Œ Cï¼ŒBçš„å–å€¼ï¼šFor evaluating YOLO on PASCAL VOC, we use S = 7, B = 2. PASCAL VOC has 20 labelled classes so C = 20. Our final prediction is a 7 Ã— 7 Ã— 30 tensor.</p></li></ul><h2 id="2-1-Network-Design"><a href="#2-1-Network-Design" class="headerlink" title="2.1 Network Design"></a>2.1 Network Design</h2><ul><li>Evaluate it on the PASCAL VOC detection dataset.</li><li>the initial  convolutional layers of the  network extract features from the image  while the fully connected layers predict the out put probabilities and coordinates</li><li>inspired by the GoogLeNet model for image classification. The network has 24 convolutional layers followed by 2 fully connected layers.</li><li>No Inception modules!</li></ul><p><a href="https://imgtu.com/i/4l6uCD" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/09/18/4l6uCD.png" alt="NetWork"></a></p><ul><li>The final output of the network is the 7Ã—7Ã—30 tensor of predictions.</li></ul><p>è¾“å…¥å›¾åƒå¤§å°ä¸º448<em>448ï¼Œç»è¿‡è‹¥å¹²ä¸ªå·ç§¯å±‚ä¸æ± åŒ–å±‚ï¼Œå˜ä¸º7</em>7<em>1024å¼ é‡ï¼ˆå›¾ä¸€ä¸­å€’æ•°ç¬¬ä¸‰ä¸ªç«‹æ–¹ä½“ï¼‰ï¼Œæœ€åç»è¿‡ä¸¤å±‚å…¨è¿æ¥å±‚ï¼Œè¾“å‡ºå¼ é‡ç»´åº¦ä¸º7</em>7<em>30ï¼Œè¿™å°±æ˜¯Yolo v1çš„æ•´ä¸ªç¥ç»ç½‘ç»œç»“æ„ï¼Œå’Œä¸€èˆ¬çš„å·ç§¯ç‰©ä½“åˆ†ç±»ç½‘ç»œæ²¡æœ‰å¤ªå¤šåŒºåˆ«ï¼Œæœ€å¤§çš„ä¸åŒå°±æ˜¯ï¼šåˆ†ç±»ç½‘ç»œæœ€åçš„å…¨è¿æ¥å±‚ï¼Œä¸€èˆ¬è¿æ¥äºä¸€ä¸ªä¸€ç»´å‘é‡ï¼Œå‘é‡çš„ä¸åŒä½ä»£è¡¨ä¸åŒç±»åˆ«ï¼Œè€Œè¿™é‡Œçš„è¾“å‡ºå‘é‡æ˜¯ä¸€ä¸ªä¸‰ç»´çš„å¼ é‡ï¼ˆ7</em>7*30ï¼‰ã€‚ä¸Šå›¾ä¸­Yoloçš„backboneç½‘ç»œç»“æ„ï¼Œå—å¯å‘äºGoogLeNetï¼Œä¹Ÿæ˜¯v2ã€v3ä¸­Darknetçš„å…ˆé”‹ã€‚æœ¬è´¨ä¸Šæ¥è¯´æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«ï¼Œæ²¡æœ‰ä½¿ç”¨BNå±‚ï¼Œç”¨äº†ä¸€å±‚Dropoutã€‚é™¤äº†æœ€åä¸€å±‚çš„è¾“å‡ºä½¿ç”¨äº†çº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œå…¶ä»–å±‚å…¨éƒ¨ä½¿ç”¨Leaky Reluæ¿€æ´»å‡½æ•°ã€‚ç½‘ç»œç»“æ„æ²¡æœ‰ç‰¹åˆ«çš„ä¸œè¥¿ï¼Œä¸å†èµ˜è¿°ã€‚</p><h2 id="2-2Training"><a href="#2-2Training" class="headerlink" title="2.2Training"></a>2.2Training</h2><blockquote><p><strong>denote</strong> v.æ ‡å¿—ï¼Œ è¡¨ç¤º    </p><p><strong>penalize</strong>  v.æƒ©ç½š</p><p><strong>fine-grained</strong>: (chiefly of wood) having a fine or delicate arrangement of fibers.</p><ul><li><p>(chiefly of rock) consisting of small particles.</p></li><li><p>involving great attention to detail.</p><p>*â€fine-grained analysisâ€*</p></li></ul><p><strong>parametrize</strong> v. describe or represent in terms of a parameter or parameters.  *â€the nuclear charge distribution can be parameterized directly using a suitable mathematical formâ€*</p><p><strong>align</strong> v. 1.å¯¹é½place or arrange (things) in a straight line.  2. give support to (a person, organization, or cause).</p><p><strong>diverge</strong>  v. (of a road, route, or line) separate from another route, especially a main one, and go in a different direction.  *â€the flight path diverged from the original flight planâ€*</p><p><strong>early on</strong>: phrase of early, at an initial stage in a particular time or period. *â€they discovered early on that the published data were wrongâ€*</p><p><strong>remedy</strong>: v. set right (an undesirable situation).*â€by the time a problem becomes patently obvious, it may be almost too late to remedy itâ€*</p><p><strong>coefficient:</strong> n. a numerical or constant quantity placed before and multiplying the variable in an algebraic expression (e.g. 4 in 4x y).</p><p><strong>saturation</strong>: n. (é¥±å’Œ)the state or process that occurs when no more of something can be absorbed, combined with, or added. *â€the springs on the left slope of the hill lie below the level of permanent saturationâ€*</p></blockquote><ul><li>è¿™é‡Œçœ‹åˆ°äº†pretraining, é¢„è®­ç»ƒè¿™ä¸ªæ¦‚å¿µï¼Œæ‰€ä»¥æŸ¥äº†æŸ¥ï¼Œçœ‹<a href="https://blog.csdn.net/qq_41821678/article/details/106113870" target="_blank" rel="noopener">è¿™é‡Œ</a></li><li>é¦–å…ˆä½œè€…èŠ±äº†ä¸€å‘¨çš„æ—¶é—´è®­ç»ƒå‰20ä¸ªå·ç§¯å±‚å¹¶ä¸”åœ¨ImageNet 2012éªŒè¯é›†ä¸Šè·å¾—äº†å•ä¸€è£å‰ªå›¾åƒ88%çš„top-5å‡†ç¡®ç‡ï¼Œä¸Caffeæ¨¡å‹æ± ä¸­çš„GoogLeNetæ¨¡å‹ç›¸å½“ã€‚</li><li>æ¥ç€å¯¹è¯¥é¢„è®­ç»ƒæ¨¡å‹è¿ç§»åˆ°æˆ‘ä»¬çš„ç›®æ ‡æ£€æµ‹ä¸­å»(convert the model to perform detection)</li><li>å› ä¸ºç›®æ ‡æ£€æµ‹ä¸€äº›â€fine-grainedâ€è§†è§‰ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠè¿™ä¸ªè¾“å…¥å›¾åƒåˆ†è¾¨ç‡ä»224Ã—224æå‡è‡³448Ã—448</li><li>æ¨¡å‹çš„æœ€åä¸€å±‚é¢„æµ‹ç±»æ¦‚ç‡å’Œè¾¹ç•Œæ¡†åæ ‡ã€‚æˆ‘ä»¬é€šè¿‡å›¾åƒå®½åº¦å’Œé«˜åº¦æ¥è§„èŒƒè¾¹ç•Œæ¡†çš„å®½åº¦å’Œé«˜åº¦ï¼Œä½¿å®ƒä»¬è½åœ¨0å’Œ1ä¹‹é—´ã€‚æˆ‘ä»¬å°†è¾¹ç•Œæ¡†xå’Œyåæ ‡å‚æ•°åŒ–ä¸ºç‰¹å®šç½‘æ ¼å•å…ƒä½ç½®çš„åç§»é‡ï¼Œæ‰€ä»¥å®ƒä»¬çš„å€¼è¢«é™å®šåœ¨åœ¨0å’Œ1ä¹‹é—´ã€‚</li><li>æ¨¡å‹çš„æœ€åä¸€å±‚ä½¿ç”¨çº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œè€Œæ‰€æœ‰å…¶å®ƒçš„å±‚ä½¿ç”¨ä¸‹é¢çš„leaky rectified activationï¼š</li><li><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic3.zhimg.com/80/v2-e75e88cd05e31c1c0c2575397cf8a46a_1440w.jpg" alt="leaky linear activation"></li><li>æˆ‘ä»¬å¯¹æ¨¡å‹è¾“å‡ºçš„å¹³æ–¹å’Œè¯¯å·®(sum-squared error)è¿›è¡Œä¼˜åŒ–ã€‚æˆ‘ä»¬é€‰æ‹©ä½¿ç”¨å¹³æ–¹å’Œè¯¯å·®ï¼Œæ˜¯å› ä¸ºå®ƒæ˜“äºä¼˜åŒ–(optimize)ï¼Œä½†æ˜¯å®ƒå¹¶ä¸å®Œå…¨ç¬¦åˆ(not perfectly align with)æœ€å¤§åŒ–å¹³å‡ç²¾åº¦ï¼ˆaverage precisionï¼‰çš„ç›®æ ‡ã€‚å®ƒç»™åˆ†ç±»è¯¯å·®(classification)ä¸å®šä½(localization)è¯¯å·®çš„æƒé‡æ˜¯ä¸€æ ·çš„ï¼Œè¿™ç‚¹å¯èƒ½å¹¶ä¸ç†æƒ³ã€‚å¦å¤–ï¼Œæ¯ä¸ªå›¾åƒéƒ½æœ‰å¾ˆå¤šç½‘æ ¼å•å…ƒå¹¶æ²¡æœ‰åŒ…å«ä»»ä½•ç›®æ ‡ï¼Œè¿™å°†è¿™äº›å•å…ƒæ ¼çš„â€œç½®ä¿¡åº¦â€åˆ†æ•°æ¨å‘é›¶ï¼Œé€šå¸¸å‹åˆ¶äº†åŒ…å«ç›®æ ‡çš„å•å…ƒæ ¼çš„æ¢¯åº¦ã€‚è¿™å¯èƒ½å¯¼è‡´æ¨¡å‹ä¸ç¨³å®šï¼Œä»è€Œå¯¼è‡´è®­ç»ƒåœ¨æ—©æœŸå°±å‘æ•£ã€‚</li><li>ä¸ºäº†å¼¥è¡¥è¿™ä¸ªæƒ…å†µï¼ˆto remedy this)ï¼Œæˆ‘ä»¬é€‰æ‹©å¢åŠ æˆ‘ä»¬çš„å®šä½è¯¯å·®æŸå¤±ï¼Œç„¶åé™ä½æˆ‘ä»¬çš„åˆ†ç±»æŸå¤±ã€‚æˆ‘ä»¬ä½¿ç”¨äº†ä¸¤ä¸ªparametersï¼Œ $Î»<em>{coord} = 5, \lambda</em>{noobj} = .5$</li><li>å¹³æ–¹å’Œè¯¯å·®å¯¹å¤§æ¡†å’Œå°æ¡†çš„è¯¯å·®æƒè¡¡æ˜¯ä¸€æ ·çš„ï¼Œè€Œæˆ‘ä»¬çš„é”™è¯¯æŒ‡æ ‡åº”è¯¥è¦ä½“ç°å‡ºï¼Œå¤§æ¡†çš„å°åå·®çš„é‡è¦æ€§ä¸å¦‚å°æ¡†çš„å°åå·®çš„é‡è¦æ€§(<em>small deviations in large boxes matter less than in small boxes</em>)ã€‚ä¸ºäº†éƒ¨åˆ†è§£å†³(<em>partially address this</em>)è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ç›´æ¥é¢„æµ‹è¾¹ç•Œæ¡†å®½åº¦å’Œé«˜åº¦çš„å¹³æ–¹æ ¹(the square root)ï¼Œè€Œä¸æ˜¯å®½åº¦å’Œé«˜åº¦ã€‚</li><li>YOLOæ¯ä¸ªgrid cellé¢„æµ‹å¾ˆå¤šä¸ªbboxï¼Œè®­ç»ƒæ—¶æˆ‘ä»¬ä¸æ˜¯æ‰€æœ‰çš„bboxéƒ½ä¼šè´Ÿè´£ç‰©ä½“ï¼Œè€Œæ˜¯åªæœ‰ä¸€ä¸ªä¼šè´Ÿè´£ç‰©ä½“çš„æ£€æµ‹ï¼Œè¿™é‡Œå°±ä¼šé€‰ç”¨æˆ‘ä»¬å’ŒGTçš„IOUæœ€é«˜çš„bboxæ‰¿æ‹…æ£€æµ‹ç‰©ä½“çš„ä»»åŠ¡ã€‚</li><li>æŸå¤±å‡½æ•°æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªmulti-partçš„loss function:<a href="https://imgtu.com/i/43icpq" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/09/19/43icpq.png" alt="Loss Function"></a></li></ul><ul><li>è¿™é‡Œçš„loss functionæ¯”è¾ƒå¤æ‚ï¼Œ<strong>åŒæ—¶ä¹Ÿæ˜¯éå¸¸é‡è¦çš„è¯·è®¤çœŸç ”ç©¶ä¸€ä¸‹</strong>ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºè¿™é‡Œçš„ç¬¦å·èŠ±ä½“$1_{i}^{obj}$denotes  if object appears in cell $i$, and $1_{ij}^{obj}$ denotes that the $j$th bbox predictor in cell $i$â€‹ is â€œresponsibleâ€ for that prediction.</li><li>å’Œç»„é•¿è®¨è®ºäº†è®¨è®ºï¼Œæ³¨æ„ï¼Œè¿™é‡Œè®ºæ–‡é‡Œçš„æŸå¤±å‡½æ•°è¿™ä¸ªå…¬å¼æ²¡æœ‰ä»»ä½•åºŸè¯ï¼Œå…¨éƒ½æ˜¯éå¸¸å…³é”®çš„ç¬¦å·ã€‚è¿™äº›ä¸œè¥¿å’Œå‰é¢å¾ˆå¤šä½ çœ‹ç€æ¯”è¾ƒæ™•ã€æˆ–è€…çœ‹çš„æ¯”è¾ƒä¸ç†è§£çš„åœ°æ–¹éƒ½è”ç³»ä¸Šäº†ï¼Œå¯ä»¥è¯´è¿™ä¸ªæ˜¯â€œéå¸¸æœ‰é“ç†â€çš„ä¸€ä¸ªæŸå¤±å‡½æ•°ã€‚åŒæ—¶ä¹Ÿæ˜¯ç»è¿‡ç²¾å¿ƒè®¾è®¡ã€å¾ˆå·§å¦™åœ°ä¸€ä¸ªå‡½æ•°ã€‚</li><li>è™½ç„¶æˆ‘ç›®å‰æ²¡æœ‰å®Œå…¨ç†è§£ï¼Œä½†æ˜¯ç†è§£äº†ä¸ªå¤§éƒ¨åˆ†ï¼Œå‰©ä¸‹çš„éƒ¨åˆ†å¯èƒ½ç›®å‰è¿˜æœ‰ä¸€äº›å›°éš¾ï¼Œéœ€è¦è¿›ä¸€æ­¥çš„äº†è§£ï¼Œå¦å¤–ï¼Œå…³äºæˆ‘ä»¬localization error å’Œ classification errorçš„éƒ¨åˆ†ä»ç„¶éœ€è¦è¿›ä¸€æ­¥å»æ¢ç©¶ï¼ˆ<del>è¿™éƒ¨åˆ†æˆ‘æ‰¾åˆ°äº†å››ç¯‡æ–‡ç« <a href="https://stats.stackexchange.com/questions/481332/yolo-v1-why-we-weigh-localization-error-more-than-classification-error" target="_blank" rel="noopener">1</a>, <a href="https://stats.stackexchange.com/questions/481956/yolo-v1-how-gradients-in-grids-with-no-objects-overpower" target="_blank" rel="noopener">2</a>, <a href="https://stackoverflow.com/questions/49535301/understanding-the-loss-function-in-yolo-v1-research-paper" target="_blank" rel="noopener">3</a>ï¼Œ ä¸ªäººè®¤ä¸ºç¬¬<a href="https://medium.com/adventures-with-deep-learning/yolo-v1-part3-78f22bd97de4" target="_blank" rel="noopener">4</a>ç¯‡æ›´å…·æœ‰å¯è¯»æ€§</del>ï¼‰ï¼Œä»¥åŠè¯¥æŸå¤±å‡½æ•°$C_i$ç©¶ç«Ÿä»£è¡¨ä»€ä¹ˆè¿™äº›ä¸œè¥¿ï¼Œ æœ€åçš„å…³äº$p_i(c)$çš„è¿™ä¸ªæŸå¤±å‡½æ•°ï¼Œéƒ½æœ‰å¾…è¿›ä¸€æ­¥å»ç ”ç©¶è®¨è®ºã€‚</li><li>æœ€ç»ˆç»ˆäºç†è§£äº†ï¼è¿™é‡Œé¢ä¸»è¦æ˜¯åˆçœ‹äº†çœ‹ä¸Šè¾¹çš„ç¬¬å››ç¯‡æ–‡ç« ä»¥åŠæˆ‘ä»¬çš„è¿™ä¸€ç¯‡<a href="https://www.cnblogs.com/sddai/p/14760055.html" target="_blank" rel="noopener">ä¸­æ–‡åšå®¢</a>, è¿™ä¸€ç¯‡åšå®¢ä¸»è¦å¸¦ç»™æˆ‘çš„æ”¶è·å°±æ˜¯å…³äºè¿™ä¸ªCå®é™…ä¸Šä»£è¡¨çš„æ‰æ˜¯ç½®ä¿¡åº¦ï¼Œè€Œpä»£è¡¨çš„æ‰æ˜¯æˆ‘ä»¬çš„é‚£ä¸ªå…³äºæ¯ä¸€ç±»çš„é‚£ä¸ªæ¦‚ç‡çš„é¢„æµ‹ã€‚å…¶ä»–çš„å°±æ˜¯å†è¯»ä¸€éå‰å‰ååå…³äºè¿™ä¸ªå‡½æ•°çš„ä»‹ç»ä»¥åŠå‰é¢çš„ä¸€äº›ä¸œè¥¿ï¼Œé¡¿æ—¶å°±æœ‰äº†ä¸€ç§èŒ…å¡é¡¿å¼€çš„æ„Ÿè§‰ï¼Œè¿™ç§æ„Ÿè§‰è¿˜æ˜¯éå¸¸å¥½çš„ğŸˆ</li></ul><ul><li><p>è§£å†³äº†loss function çš„é—®é¢˜ä¹‹ååé¢å°±æ˜¯æœ‰å…³è®­ç»ƒçš„è¿‡ç¨‹äº†ï¼Œå®é™…ä¸Šè¿™æ–¹é¢è¿˜æ˜¯éå¸¸ç®€å•çš„ï¼Œè¿™é‡Œç›´æ¥æ‘˜å½•åŸæ–‡å°±ğŸ†—</p></li><li><blockquote><p>We train the network for about 135 epochs on the train-<br>ing and validation data sets from PASCAL VOC 2007 and 2012</p><p>When testing on 2012 we also include the VOC 2007<br>test data for training. Throughout training we use a batch<br>size of 64, a momentum of 0.9 and a decay of 0.0005.<br>Our learning rate schedule is as follows: For the first<br>epochs we slowly raise the learning rate from  $10^{âˆ’3}$ to  $10^{âˆ’2}$.<br>If we start at a high learning rate our model often diverges<br>due to unstable gradients. We continue training with $10^{âˆ’2}$<br>for 75 epochs, then 10âˆ’3 for 30 epochs, and finally $10^{âˆ’4}$<br>for 30 epochs.<br>To avoid overfitting we use dropout and extensive data<br>augmentation. A dropout layer with rate = .5 after the first<br>connected layer prevents co-adaptation between layers [18].<br>For data augmentation we introduce random scaling and<br>translations of up to 20% of the original image size. We<br>also randomly adjust the exposure and saturation of the im-<br>age by up to a factor of 1.5 in the HSV color space.</p></blockquote></li></ul><h2 id="2-3Inference"><a href="#2-3Inference" class="headerlink" title="2.3Inference"></a>2.3Inference</h2><blockquote><p><strong>inference</strong>: n. a conclusion reached on the basis of evidence and reasoning.   *â€researchers are entrusted with drawing inferences from the dataâ€*</p><p><strong>spatial:</strong> adj. relating to or occupying space.  *â€the spatial distribution of populationâ€*</p></blockquote><ul><li>YOLOéå¸¸å¿«ï¼Œå› ä¸ºå®ƒåªéœ€è¦ä¸€ä¸ªç½‘ç»œçš„è¯„ä¼°ï¼Œä¸åƒæ˜¯RCNNç³»åˆ—çš„ç®—æ³•ã€‚</li><li>å¦å¤–ä½œè€…è¿˜ç‰¹æ„æåˆ°äº†ï¼Œæ¯ä¸€ä¸ªç‰©ä½“æœ€ååŸºæœ¬ä¸Šéƒ½ä¼šæœ‰ä¸€ä¸ªgrid cellæ¥è´Ÿè´£é¢„æµ‹ï¼Œ ä½†æ˜¯æœ‰æ—¶å€™ï¼Œæ¯”å¦‚è¯´ç‰©ä½“æœ¬èº«æ¯”è¾ƒå¤§çš„æ—¶å€™æˆ–è€…æ˜¯ä¸€äº›æ¨ªè·¨å¤šä¸ªgrid cellçš„æ—¶å€™ï¼Œå°±ä¼šæœ‰ç€è®¸å¤šçš„grid cellæ¥é¢„æµ‹è¿™ä¸ªæ¡†ï¼Œè¿™æ ·çš„è¯æˆ‘ä»¬å¯ä»¥é€‰ç”¨NMSï¼</li><li>NMS, Non-maximal suppressionå¯ä»¥ç”¨æ¥å‰ªæ‰å¤šä½™çš„å¤šä¸ªæ£€æµ‹æ¡†ã€‚ä½†æ˜¯è¿™é‡Œå¯ä»¥çœ‹å‡ºå®é™…ä¸ŠNMSå°±æ˜¯ä¸ªè¡¥å……è€Œå·²ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªæˆ‘ä»¬è¯´æ˜¯å¿…é¡»çš„ï¼Œå°±åƒåœ¨R-CNNæˆ–æ˜¯DPMè¿™é‡Œä¸€æ ·ã€‚éæå¤§æŠ‘åˆ¶æœ€å¤šå¢åŠ 2-3%mAPè¿™ç§ã€‚</li></ul><h2 id="Limitations-of-YOLO"><a href="#Limitations-of-YOLO" class="headerlink" title="Limitations of YOLO"></a>Limitations of YOLO</h2><blockquote><p><strong>constraints</strong>: n. a limitation or restriction. *â€time constraints make it impossible to do everythingâ€*</p><p><strong>aspect ratio:</strong> n. é•¿å®½æ¯”</p><p><strong>generalizeï¼š</strong> v. 1. make a general or broad statement by inferring from specific cases. *â€it is not easy to generalize about the poorâ€* 2. make (something) more widespread or widely applicable. *â€attempts to generalize an elite educationâ€*</p><p><strong>configurations:</strong> n.  (é…ç½®)an arrangement of elements in a particular form, figure, or combination *â€the broad configuration of the economy remains capitalistâ€* </p><p><strong>coarse:</strong> adj. rough or loose in texture or grain.</p><p><strong>off-the-shelfï¼š</strong> adj. (ç°æˆçš„)not designed or made to order but taken from existing stock or supplies.  <strong>â€œoff-the-shelf software packagesâ€</strong></p></blockquote><blockquote><p><strong>So What Does Aspect Ratio(é•¿å®½æ¯”) Mean?</strong></p><p>An aspect ratio is an attribute that describes the relationship between the width and height of an image. Aspect ratio is expressed by the symbolic notation: X:Y. The values of X and Y are not the actual width and height of the image, but describe the relationship between them.</p></blockquote><ul><li>å› ä¸ºYOLOå¯¹äºæˆ‘ä»¬çš„é¢„æµ‹bboxçš„çº¦æŸ(strong spatial constraints)è¿˜æ˜¯å¾ˆå¼ºçš„ï¼Œæ¯ä¸ªgrid cellåªå¯ä»¥é¢„æµ‹ä¸¤ä¸ªbbox(Bé€šå¸¸ä¸º2)å¹¶ä¸”åªå¯ä»¥é¢„æµ‹ä¸€ä¸ªç§ç±»ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªç‰©ä½“ã€‚è¿™å°±çº¦æŸäº†æˆ‘ä»¬ç›¸é‚»çš„ä¸€äº›ç‰©ä½“ï¼Œå¯¹äºç¦»å¾—å¾ˆè¿‘çš„ç‰©ä½“ï¼Œå®ƒçš„é¢„æµ‹å°±æ¯”è¾ƒéš¾åŠã€‚è¯¥æ¨¡å‹å› æ­¤ä¹Ÿå¾ˆéš¾æ£€æµ‹æˆ‘ä»¬çš„æˆç¾¤çš„å°ç‰©ä½“ï¼Œæ¯”å¦‚è¯´æˆç¾¤çš„é¸Ÿï¼ˆflocks of bird)</li><li>å¦å¤–ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æˆ‘ä»¬çš„å…³äºå­¦ä¹ ç›¸å…³çš„bboxæ˜¯æ ¹æ®çš„æˆ‘ä»¬çš„æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬è‚¯å®šä¼šå¯¹ä¸€äº›ä¸å¯»å¸¸é•¿å®½æ¯”ï¼ˆaspect ratioï¼‰æˆ–æ˜¯é…ç½®ï¼ˆconfigurationï¼‰ä¸å¤ªå¯»å¸¸çš„ç‰©ä½“å¾ˆéš¾è¯†åˆ«æ¸…æ¥š.</li><li>å¦å¤–ä¸€ç‚¹å°±æ˜¯æˆ‘ä»¬çš„æ¨¡å‹ä»æ—§ä½¿ç”¨ç›¸å¯¹æ¯”è¾ƒç²—ç³™çš„ç‰¹å¾æ¥è®­ç»ƒbboxï¼Œå› ä¸ºæˆ‘ä»¬æœ‰ç€å¤ªå¤šçš„downsamplingå±‚åœ¨è¿™é‡Œäº†ï¼Œå¦‚æœè¿‡åˆ†ä¸‹é‡‡æ ·çš„è¯æˆ‘ä»¬çš„æ¨¡å‹å®¹æ˜“é¢„æµ‹çš„ä¸æ˜¯å¾ˆå¥½ï¼Œè¿™ä¸€ç‚¹å½“ç„¶å¯ä»¥ç†è§£ï¼Œä½†æ˜¯è®ºæ–‡çš„æ„æ€ä¼¼ä¹æ˜¯å¦ä¸€ä¸ªæ–¹é¢çš„æ„æ€ï¼Œè¿™å‡ ä¸ªéœ€è¦è¿›ä¸€æ­¥çš„å»æ€è€ƒã€‚</li><li>æœ€åä¸€ç‚¹æˆ‘ä»¬è®­ç»ƒlosså¹³ç­‰å¯¹å¾…å°bboxå’Œå¤§bboxï¼Œ ä¸»è¦erroræ¥æºæ˜¯é”™è¯¯çš„ä½ç½®ã€‚</li></ul><p>æ€»ç»“YOLOv1è¦ç‚¹ï¼š</p><ul><li><p>YOLO: 45 FPSï¼ŒFast YOLO: 155 FPS</p></li><li><p>å°†å›¾åƒåˆ†æˆS*Sçš„ç½‘æ ¼ï¼Œæ¯ä¸ªç½‘æ ¼é¢„æµ‹Bä¸ªbboxï¼Œå¯¹æ¯ä¸ªbboxé¢„æµ‹å…¶ç½®ä¿¡åº¦confidenceï¼ˆIOUï¼‰</p></li><li><p>æ¯ä¸ªç½‘æ ¼é¢„æµ‹Cä¸ªæ¡ä»¶ç±»åˆ«æ¦‚ç‡ï¼ŒCæ˜¯ç±»åˆ«æ•°ç›®ï¼Œä¹‹é¢„æµ‹ä¸€ç»„Cä¸ªæ¡ä»¶æ¦‚ç‡ï¼Œæ— è®ºBçš„å–å€¼ä¸ºå¤šå°‘</p></li><li><p>å¯¹VOCï¼ŒS=7ï¼ŒB=2ï¼ŒC=20ï¼Œç½‘ç»œè¾“å‡ºä¸º7<em>7</em>30ï¼Œå…¶ä¸­30=20+ï¼ˆxywh+confidenceï¼‰*B</p></li><li><p>24å·ç§¯+2å…¨è¿æ¥</p></li><li><p>è®­ç»ƒå’Œæµ‹è¯•é˜¶æ®µçš„åˆ†è¾¨ç‡ä¸åŒï¼šdetectionéœ€è¦ç»†ç²’åº¦çš„è§†è§‰ä¿¡æ¯ï¼Œå› æ­¤æŠŠè¾“å…¥åˆ†è¾¨ç‡ä»224<em>224æé«˜åˆ°448</em>448</p></li><li><p>leaky RELU</p></li><li><p>lambdaå‚æ•°å¯¹lossè¿›è¡ŒåŠ æƒï¼šå¢åŠ bounding boxåæ ‡äº§ç”Ÿçš„lossï¼Œå‡å°‘ä¸åŒ…å«ç‰©ä½“çš„é¢„æµ‹ç»“æœlossï¼Œä¸ºä¸¤ä¸ªlossæ·»åŠ æƒé‡</p></li><li><p>é¢„æµ‹bounding boxçš„hï¼Œwçš„å¹³æ–¹æ ¹ï¼Œè€Œä¸æ˜¯ç›´æ¥é¢„æµ‹bboxï¼Œå¹³æ–¹å’Œå°†å¤§boxå’Œå°boxçš„errorçœ‹åšå¹³ç­‰çš„</p></li><li><p>æ•°æ®å¢å¼ºå’ŒNMS</p></li></ul><h1 id="YOLOv1ç²¾ç®€æ€»ç»“ç‰ˆ"><a href="#YOLOv1ç²¾ç®€æ€»ç»“ç‰ˆ" class="headerlink" title="YOLOv1ç²¾ç®€æ€»ç»“ç‰ˆ"></a>YOLOv1ç²¾ç®€æ€»ç»“ç‰ˆ</h1><h2 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h2><p>YOLOv1å®é™…ä¸Šå·²ç»çœ‹è¿‡äº†ï¼Œä¹Ÿè®°è¿‡ç¬”è®°äº†ï¼Œä½†æ˜¯ä»£ç éƒ¨åˆ†æ€»æ˜¯çœ‹å¾—æ¯”è¾ƒæ¨¡æ¨¡ç³Šç³Šçš„æ„Ÿè§‰ã€‚è¿˜æ˜¯ç®—æ³•åŸç†è¿™éƒ¨åˆ†æ²¡æœ‰å®Œå…¨æŒæ¡å®é™…ä¸Šã€‚å¦å¤–æ·±åº¦å­¦ä¹ å­¦ç€å­¦ç€æ˜æ˜¾å¯ä»¥æ„Ÿè§‰åˆ°å®é™…ä¸Šä¹‹å‰çš„åŸºç¡€å­¦å¾—è¿˜æ˜¯ä¸å¤ªå¥½ã€‚ä»¥åæœ‰æ—¶é—´éœ€è¦å¤šé‡å¤åˆ·ä¸€åˆ·æå®æ¯…å’Œå´æ©è¾¾ï¼Œ</p><blockquote><p> æå®æ¯…è§†é¢‘æœ‰ä¸€ä½å¤§ä½¬è®°çš„ç¬”è®°éå¸¸å¥½ï¼š<a href="https://sakura-gh.github.io/ML-notes/" target="_blank" rel="noopener">https://sakura-gh.github.io/ML-notes/</a></p></blockquote><p>å¦å¤–å°±æ˜¯æˆ‘ä»¬çš„å…³äºè®ºæ–‡ç²¾åº¦ï¼Œæœ¬äººæ‰“ç®—è·Ÿç€Bç«™åŒæµå¤§ä½¬å­¦ä¹ ï¼Œä»–å‘å¸ƒäº†å¾ˆå¤šç²¾åº¦AIè®ºæ–‡çš„è§†é¢‘ï¼ŒçœŸæ˜¯<strong>å®è—UPä¸»</strong>ï¼ï¼ï¼ˆå®é™…ä¸Šçœ‹å®Œè§†é¢‘æ‰å‘ç°è¯¥UPä¸»è®²çš„ä¸æ˜¯é‚£ä¹ˆæ¸…æ™°è‡³å°‘åœ¨å‰é¢ç®—æ³•ç²¾è®²é˜¶æ®µï¼Œä¸è¿‡ç®—æ³•ç²¾è®²é˜¶æ®µç»™æˆ‘å¸¦æ¥æœ€å¤§æ”¶è·å¯èƒ½å°±æ˜¯é¢˜ç›®ï¼š<strong>æˆ‘ä»¬éœ€è¦è®²ç®—æ³•åˆ†ä¸ºé¢„æµ‹å’Œè®­ç»ƒä¸¤ä¸ªé˜¶æ®µ</strong>ã€‚ è¯¥è§†é¢‘è¿˜æ˜¯å€¼å¾—ä¸€çœ‹çš„ã€‚èƒ½äº†è§£è®¸å¤šå…³äºYOLOçš„èŠ±çµ®ã€‚</p><p>æˆ‘ä¹Ÿæ˜¯çœ‹å®Œè¿™ä¸ªè§†é¢‘æ‰å‘ç°æˆ‘å®é™…ä¸Šå¾ˆå¤šYOLOåŸºç¡€å†…å®¹å­¦çš„å…¶å®ä¹Ÿè¿˜ç®—æ‰å®äº†ï¼Œæ²¡å¿…è¦å†çœ‹ä¸€éäº†ã€‚</p><blockquote><p>UPä¸»YOLOv1è§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV15w411Z7LG?p=4&amp;spm_id_from=pageDriver" target="_blank" rel="noopener">https://www.bilibili.com/video/BV15w411Z7LG?p=4&amp;spm_id_from=pageDriver</a></p></blockquote><h2 id="ç›®æ ‡æ£€æµ‹ç»¼è¿°"><a href="#ç›®æ ‡æ£€æµ‹ç»¼è¿°" class="headerlink" title="ç›®æ ‡æ£€æµ‹ç»¼è¿°"></a>ç›®æ ‡æ£€æµ‹ç»¼è¿°</h2><p>è®¡ç®—æœºè§†è§‰è§£å†³é—®é¢˜ï¼Œåˆ†ç±»ã€æ£€æµ‹ã€åˆ†å‰²ã€‚</p><p><a href="https://imgtu.com/i/5EEXmF" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/10/10/5EEXmF.png" alt="Computer Vision tasks"></a></p><p>æˆ‘ä»¬æ¥ç€çœ‹ï¼š</p><p>å›¾åƒåˆ†ç±»æ˜¯è¾“å…¥å›¾ç‰‡ï¼Œè¾“å‡ºåˆ†ç±»ã€‚ç›®æ ‡æ£€æµ‹æ˜¯ è¾“å…¥å›¾ç‰‡è¾“å‡ºå›¾ç‰‡ä¸­çš„æ¯ä¸€ä¸ªç‰©ä½“ç±»åˆ«å¹¶æŠŠæ‰€æœ‰çš„æ¯ä¸€ä¸ªç‰©ä½“éƒ½æ¡†å‡ºæ¥ã€‚åˆ†å‰²åˆ†ä¸ºä¸¤ç§ï¼šåˆ†ä¸ºSemantic Segmentationè¯­ä¹‰åˆ†å‰²ä¸Instance Segementationå®ä¾‹åˆ†å‰²ã€‚è¯­ä¹‰åˆ†å‰²å°±æ˜¯å¯¹æ¯ä¸€ä¸ªåƒç´ åˆ†ç±»ï¼Œæˆ‘ä¸ç®¡è¿™ä¸ªåƒç´ pixelæ˜¯å±äºå“ªä¸€ä¸ªç‰©ä½“çš„ï¼Œæˆ‘åªç®¡è¿™ä¸ªåƒç´ æ˜¯å“ªä¸€ä¸ªç±»åˆ«çš„ï¼Œæœ‰ç‚¹åƒç²¾ç¡®åˆ°åƒç´ çš„åˆ†ç±»ï¼Œä¸ä¼šå»åŒºåˆ†åŒä¸€ç±»ç‰©ä½“çš„ä¸åŒå®ä¾‹ã€‚è€Œæˆ‘ä»¬å®ä¾‹åˆ†å‰²è¦æŠŠåŒä¸€ä¸ªç±»åˆ«çš„ä¸åŒå®ä¾‹æ¥åˆ†å‰²åŒºåˆ«å‡ºæ¥ã€‚å¯ä»¥çœ‹ä¸€å¼ å›¾è¾…åŠ©ç†è§£ä¸‹ä»¥ä¸Šæ¦‚å¿µï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20210930212838.png" alt></p><p>å½“ç„¶å¯èƒ½çœ‹å®Œè¿™å¼ å¯¹æ¯”å›¾å¯¹äºè¯­ä¹‰åˆ†å‰²å®ä¾‹åˆ†å‰²çš„åŒºåˆ«è¿˜æ˜¯ä¸æ˜¯ç‰¹åˆ«æ¸…æ¥šï¼Œæˆ‘ä»¬å¯ä»¥æ¥ç€çœ‹ä¸€ä¸‹æ¥ä¸‹æ¥è¿™å¼ å›¾ï¼š</p><p><a href="https://imgtu.com/i/4ovPgO" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/09/30/4ovPgO.png" alt></a></p><p>æœ‰ä¸€ç¯‡è®²çš„éå¸¸å¥½çš„æ–‡ä»¶ç»¼è¿°ï¼š<em>Object Detection in 20 Years: A Survey</em>. åœ°å€åœ¨è¿™é‡Œï¼š<a href="https://arxiv.org/pdf/1905.05055.pdf" target="_blank" rel="noopener">https://arxiv.org/pdf/1905.05055.pdf</a> æ˜¯æˆ‘ä»¬ä¸­å›½äººå†™çš„ï¼Œå¯ä»¥è¯»ä¸€ä¸‹æ²¡äº‹çš„æ—¶å€™ã€‚æ€»ç»“äº†ä¸€ä¸‹ç›®æ ‡æ£€æµ‹çš„å‘å±•ã€‚</p><p>ç›®æ ‡æ£€æµ‹åˆ†ä¸ºä¸¤ä¸ªæ¨¡å—ï¼šä¸¤é˜¶æ®µï¼ˆ<em>tow-stage<em>ï¼‰å’Œå•é˜¶æ®µ(</em>one-stage</em>).è¿™ä¸ªå·²ç»éå¸¸ç†Ÿæ‚‰äº†ï¼Œä¸å¤šè®²äº†ã€‚ä¸¤é˜¶æ®µå°±æ˜¯å…ˆæå–å€™é€‰æ¡†åœ¨è¿›è¡Œåˆ†ç±»å®šä½ã€‚è€Œå•é˜¶æ®µå°±æ˜¯ç›´æ¥ç«¯åˆ°ç«¯å°±OKã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20210930214045.png" alt="Milestones"></p><p>ä¹‹å‰æ€»è¯´å•é˜¶æ®µå°ç›®æ ‡ã€å¤šç›®æ ‡ä¸å¤ªå¥½ï¼Œä½†é‚£æ˜¯ä¹‹å‰äº†ã€‚ç°åœ¨æ¥çœ‹ï¼Œæˆ‘ä»¬çš„yolov5å·²ç»éå¸¸å¥½äº†æ£€æµ‹æ¥çœ‹ã€‚</p><p>ä»¥ä¸‹è¿™å¼ å›¾æ˜¯YOLOv1çš„æå‡ºè€…åœ¨å­¦æœ¯ä¼šè®®ä¸Šå¯¹æ¯”äº†å½“æ—¶çš„DPMä¸RCNNç³»åˆ—ç®—æ³•ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20210930214304.png" alt="image-20210930214301910"></p><p>DPMæ˜¯åŸºäºä¼ ç»Ÿçš„æ–¹æ³•è¯†åˆ«ç‰¹å¾ï¼ŒåŸºäºæ¨¡æ¿çš„ï¼Œäººå·¥è®¾è®¡ç„¶ååˆ©ç”¨æ»‘åŠ¨çª—å£æ¥å¾€æ¨¡å‹ä¸Šå¥—ï¼Œæ˜æ˜¾äººå·¥è®¾è®¡è€Œä¸”æ»‘åŠ¨çª—å£åˆæ…¢å¹¶ä¸”é²æ£’æ€§åˆå·®ï¼Œæ•ˆæœä¸æ˜¯ç‰¹åˆ«å¥½ã€‚</p><p>RCNNå°±æ˜¯two-stageç®—æ³•ã€‚å…ˆä»å›¾åƒä¸­æå–2kä¸ªå€™é€‰æ¡†ï¼Œç„¶åæŠŠæ¯ä¸€ä¸ªæ¡†éƒ½æ”¾åˆ°è¿›å»è¯†åˆ«ï¼Œè™½ç„¶æ¯”è¾ƒæ…¢ï¼Œä½†æ˜¯å‡†ç¡®ç‡è¿˜å¯ä»¥ã€‚è¿™ä¸€ç³»åˆ—çš„ç®—æ³•å®é™…ä¸Šè¿˜å¯ä»¥ï¼Œä¹‹å‰åšå®¢ä¹Ÿä»‹ç»è¿‡äº†ï¼Œæºç ä¹Ÿä»‹ç»è¿‡äº†ã€‚</p><h2 id="ç®—æ³•ç²¾è®²ä¹‹é¢„æµ‹é˜¶æ®µï¼ˆå‰å‘æ¨æ–­ï¼‰"><a href="#ç®—æ³•ç²¾è®²ä¹‹é¢„æµ‹é˜¶æ®µï¼ˆå‰å‘æ¨æ–­ï¼‰" class="headerlink" title="ç®—æ³•ç²¾è®²ä¹‹é¢„æµ‹é˜¶æ®µï¼ˆå‰å‘æ¨æ–­ï¼‰"></a>ç®—æ³•ç²¾è®²ä¹‹é¢„æµ‹é˜¶æ®µï¼ˆå‰å‘æ¨æ–­ï¼‰</h2><p>å®é™…ä¸Šè®¸å¤šåšå®¢éƒ½æŠŠè®­ç»ƒé˜¶æ®µå’Œé¢„æµ‹é˜¶æ®µæ··ä¸ºä¸€è°ˆï¼Œæˆ‘ä»¬å…ˆçœ‹é¢„æµ‹é˜¶æ®µã€‚</p><p><strong>é¢„æµ‹é˜¶æ®µï¼š</strong> æ­¤æ—¶æˆ‘ä»¬æ¨¡å‹å·²ç»è®­ç»ƒå¥½äº†ï¼Œåªéœ€è¦è¿›è¡Œå‰å‘ä¼ æ’­ï¼Œä¸éœ€è¦åå‘ä¼ æ’­ã€‚å…ˆçœ‹ä¸€ä¸‹æˆ‘ä»¬çš„é¢„æµ‹é˜¶æ®µã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20210930215037.png" alt="YOLO AND YOLO-Tiny"></p><p>YOLO-Tinyè®ºæ–‡ä¸­æåˆ°è¿‡ï¼Œå°±æ˜¯ä¸€ä¸ªæ¯”è¾ƒå°ï¼Œæ¯”è¾ƒå¿«çš„ä¸€ä¸ªæ¨¡å‹ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20210930224106.png" alt="image-20210930224101536"></p><p>æˆ‘ä»¬è¾“å…¥ä¸€ä¸ªå›¾åƒï¼Œè¾“å‡ºä¸€ä¸ª7Ã—7Ã—30çš„ä¸€ä¸ªå¼ é‡ã€‚</p><p>å…³äº7Ã—7Ã—30ï¼Œåº”è¯¥ä¹Ÿä¸ç”¨å¤šè¯´äº†ï¼Œå› ä¸ºå·²ç»ç†Ÿæ‚‰çš„ä¸èƒ½å†ç†Ÿæ‚‰äº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20210930224219.png" alt="image-20210930224218188"></p><h2 id="ç®—æ³•ç²¾è®²ä¹‹è®­ç»ƒé˜¶æ®µ"><a href="#ç®—æ³•ç²¾è®²ä¹‹è®­ç»ƒé˜¶æ®µ" class="headerlink" title="ç®—æ³•ç²¾è®²ä¹‹è®­ç»ƒé˜¶æ®µ"></a>ç®—æ³•ç²¾è®²ä¹‹è®­ç»ƒé˜¶æ®µ</h2><p>ç›‘ç£å­¦ä¹ æ˜¯é€šè¿‡åå‘ä¼ æ’­ã€æ¢¯åº¦ä¸‹é™çš„æ–¹æ³•è¿›è¡Œè¿­ä»£å»å¾®è°ƒæƒé‡ä½¿å¾—æŸå¤±å‡½æ•°æœ€å°åŒ–çš„è¿‡ç¨‹ã€‚</p><p>æˆ‘ä»¬è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå·²ç»æœ‰ç›¸åº”çš„æ ‡æ³¨labelæ¥æ¡†å‡ºç‰©ä½“ï¼Œè€Œæˆ‘ä»¬å°±æ˜¯è¦å¯¹è¿™ä¸ªè¿›è¡Œç›¸åº”çš„é¢„æµ‹å»å°½å¯èƒ½åœ°ä½¿æˆ‘ä»¬çš„é¢„æµ‹ç»“æœå°½å¯èƒ½æ¥è¿‘è¿™ä¸ªæ¡†ã€‚</p><p>æ¯ä¸ªgrid cellåªèƒ½é¢„æµ‹å‡ºä¸€ä¸ªç±»åˆ«ç‰©ä½“ã€‚</p><ul><li>é¦–å…ˆï¼Œç”ŸæˆSÃ—Sä¸ª<code>grid cell</code>. </li><li>å¦‚æœæˆ‘ä»¬çš„ç‰©ä½“è½åœ¨æˆ‘ä»¬çš„æŸä¸ªgrid cellä¸­äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¼šé€‰æ‹©è¯¥grid cellè´Ÿè´£è¯¥ç‰©ä½“çš„é¢„æµ‹ã€‚æ¯ä¸ªgrid cellç”ŸæˆBä¸ªbbox, æ¯ä¸ªbboxéƒ½æœ‰4ä¸ªå‚æ•°ï¼š<em>x, y, w, h</em>, å¦å¤–è¿˜æœ‰ä¸€ä¸ªconfidence ,ç½®ä¿¡åº¦ï¼Œç”¨æ¥è¡¨ç¤ºè¯¥bboxå†…å«ç‰©ä½“çš„æ¦‚ç‡ã€‚ç½®ä¿¡åº¦çš„è®¡ç®—æ–¹å¼è¿˜æ¯”è¾ƒç®€å•ï¼šå¦‚æœæˆ‘ä»¬çš„ç‰©ä½“ä¸­å¿ƒç‚¹æ²¡æœ‰è½åœ¨è¯¥grid cellä¸­ï¼Œé‚£ä¹ˆè¯¥ç½®ä¿¡åº¦å®é™…ä¸Šåº”è¯¥ä¸º0ï¼Œæˆ‘ä»¬å°±åº”è¯¥è®©æˆ‘ä»¬çš„è®­ç»ƒç»“æœé€¼è¿‘äº0ï¼Œå¦‚æœè½åœ¨è¯¥grid cellç§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åº”è¯¥è®©è¯¥ç½®ä¿¡åº¦å°±é€¼è¿‘äºä¸GTçš„IOUã€‚è¿™ä¹ˆè¯´å¯èƒ½æœ‰äº›éš¾ç†è§£ï¼Œå°±æ˜¯ï¼Œæˆ‘ä»¬çš„confidenceçš„è®­ç»ƒç›®æ ‡å°±æ˜¯å¦‚æœä¸å«ç‰©ä½“é‚£ä¹ˆè®©å®ƒæ¥è¿‘äº0ï¼Œå¦‚æœå«ç›®æ ‡é‚£ä¹ˆå°±è®©å®ƒæ¥è¿‘ä¸GTçš„IOUã€‚</li><li>æ¥ç€æˆ‘ä»¬æŒ‰ç…§ç½®ä¿¡åº¦æ¥å†³å®šå“ªä¸ªæ¡†ç”¨æ¥å†³å®šæˆ‘ä»¬çš„åˆ†ç±»ç§ç±»çš„å‘é‡ï¼Œæ¯”æ–¹è¯´ä¸¤ä¸ªbboxï¼Œç¬¬äºŒä¸ªbboxçš„Confidenceå€¼æ›´å¤§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¼šé€‰æ‹©è®©æˆ‘ä»¬çš„å€¼æ›´å¤§çš„é‚£ä¸ªæ¥é¢„æµ‹æˆ‘ä»¬çš„20ç±»çš„æ¦‚ç‡å€¼ã€‚</li><li>æ‰€ä»¥æˆ‘ä»¬æœ€åå°±å¾—åˆ°äº†ä¸€ä¸ªSÃ—SÃ—(BÃ—5+C)çš„ä¸€ä¸ªtensorã€‚æˆ‘ä»¬å°±æ˜¯è¦æ‹¿è¿™ä¸ª tensoræ¥è¿›è¡ŒæŸå¤±çš„è®¡ç®—ï¼ŒæŸå¤±å‡½æ•°å¦‚ä¸‹ï¼š</li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20211001103524.png" alt="YOLO loss function"></p><ul><li>å®é™…ä¸ŠæŸå¤±å‡½æ•°ä¹Ÿæ˜¯åšäº†å¾ˆå¤šå¾ˆç²¾å·§çš„è€ƒè™‘å’Œä¼˜åŒ–çš„ï¼š<ul><li>å¯ä»¥çœ‹åˆ°ç¬¬ä¸€è¡Œæˆ‘ä»¬å¯¹æ‰€æœ‰çš„bboxçš„åæ ‡ä¸­å¿ƒç‚¹çš„æŸå¤±è¿›è¡Œäº†ç´¯åŠ ï¼Œä½†å®é™…ä¸Šï¼Œç”±äºæˆ‘ä»¬é‚£ä¸ªç¬¦å·èŠ±ä½“1çš„å­˜åœ¨ä»–åªä¼šè€ƒè™‘è´Ÿè´£æ£€æµ‹é‚£ä¸ªç‰©ä½“çš„æ¡†çš„åæ ‡æŸå¤±ã€‚è€Œç¬¬ä¸€è¡Œå…¬å¼çš„$\lambda_{coord}$çš„å­˜åœ¨æ˜¯ä¸ºäº†æé«˜æˆ‘ä»¬å®šä½è¯¯å·®å æ€»è¯¯å·®çš„æƒé‡ã€‚</li><li>ç¬¬äºŒè¡Œçš„å…¬å¼æ˜¯æˆ‘ä»¬çš„å®½é«˜è¯¯å·®ï¼Œå¯ä»¥çœ‹å‡ºä¹Ÿæ˜¯é€šè¿‡çš„æˆ‘ä»¬çš„é«˜å®½çš„æŸå¤±å‡½æ•°ï¼Œä½†æ˜¯è¿™é‡Œç”¨åˆ°äº†æ ¹å·ï¼Œå› ä¸ºä½œè€…è€ƒè™‘åˆ°è¿™é‡Œå¯èƒ½å¤§ç‰©ä½“çš„é«˜å®½å’Œå°ç‰©ä½“çš„é«˜å®½è¯¯å·®å¯èƒ½æ•°å€¼æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯å½±å“å´å®Œå…¨ä¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä¸ºäº†éƒ¨åˆ†ç¼“è§£è¿™æ–¹é¢çš„è€ƒè™‘ï¼Œè¿›è¡Œäº†ç›¸å…³çš„æ ¹å·å¤„ç†ï¼Œä½¿å¾—å°æ¡†å¯¹è¯¯å·®æ›´æ•æ„Ÿï¼Œå½“ç„¶è¿™é‡Œåªæ˜¯ä¸€ä¸ªéƒ¨åˆ†çš„è§£å†³æ–¹æ¡ˆã€‚</li><li>ç¬¬ä¸‰è¡Œæ˜¯æˆ‘ä»¬çš„ç›¸å…³çš„Confidenceçš„è¯¯å·®æŸå¤±å‡½æ•°ã€‚è¿™é‡Œé¢ä¹Ÿæ˜¯åŒæ ·åªè®¡ç®—äº†æˆ‘ä»¬çš„è´Ÿè´£æ£€æµ‹ç‰©ä½“çš„bboxçš„è¯¯å·®æŸå¤±ã€‚æ³¨æ„çš„ä¸€ç‚¹å°±æ˜¯æˆ‘ä»¬è¿™é‡Œçš„æŸå¤±çš„$\hat{C_{i}}$â€‹ æŒ‡çš„æ˜¯æˆ‘ä»¬çš„bboxä¸GTçš„IOUã€‚æˆ‘ä»¬çš„$C_i$å°±æ˜¯æˆ‘ä»¬é¢„æµ‹å€¼ï¼Œè¦åŠªåŠ›å»é€¼è¿‘è¿™ä¸ªå€¼ã€‚</li><li>ç¬¬å››è¡Œä¹Ÿæ˜¯æˆ‘ä»¬çš„ç›¸å…³Confidenceè¯¯å·®æŸå¤±å‡½æ•°ã€‚è¿™é‡Œé¢æ˜¯åªè€ƒè™‘äº†æ‰€æœ‰ä¸è´Ÿè´£é¢„æµ‹ç‰©ä½“ç»“æœçš„bbox,æˆ‘ä»¬è¦åŠªåŠ›å°½é‡åœ°è®©æˆ‘ä»¬çš„è¿™é‡Œé¢„æµ‹å€¼$C_i$æ¥è¿‘äº0ï¼Œ ä¹Ÿå°±æ˜¯æˆ‘ä»¬è¿™é‡Œçš„$\hat{C_i}$.  å› ä¸ºå¤§å¤šæ•°æ¡†éƒ½æ˜¯æ²¡æœ‰ä¸è´Ÿè´£é¢„æµ‹ç‰©ä½“ç»“æœçš„ï¼Œæ‰€ä»¥å®é™…ä¸Šå¦‚æœæˆ‘ä»¬ä¸åŠ ä¸Šå‰é¢çš„ç³»æ•°$\lambda_{noobj}$ï¼Œç»“æœå°±æ˜¯æˆ‘ä»¬çš„confidenceé¢„æµ‹æƒé‡å¯èƒ½æ›´å¤šçš„å°±ä¼šè®­ç»ƒbboxçš„éƒ¨åˆ†ï¼Œå› ä¸ºæˆ‘ä»¬å«é¢„æµ‹ç‰©ä½“çš„bboxçš„æ ·æœ¬é‡å¤ªå°äº†ï¼Œæ‰€ä»¥æœ€åå¯èƒ½ä¼šä½¿å¾—æˆ‘ä»¬çš„æƒé‡å…¨éƒ½ä¸º0ï¼Œæ‰€ä»¥æˆ‘ä»¬åŠ äº†ä¸€ä¸ªç³»æ•°$\lambda_{noobj}$â€‹â€‹ï¼Œè¿™æ ·ä¸€æ¥å°±é˜²æ­¢æˆ‘ä»¬çš„æƒé‡æœ€åå…¨é›¶çš„æƒ…å†µï¼Œè®ºæ–‡åŸè¯æ˜¯ï¼š<em>Also, in every image many grid cells do not contain any object. This pushes the â€œconfidenceâ€ scores of those cells towards zero, often overpowering the gradient from cells that do contain objects. This can lead to model instability, causing training to diverge early on.</em></li><li>æœ€åä¸€è¡Œæ˜¯æˆ‘ä»¬çš„åˆ†ç±»è¯¯å·®ï¼Œclassificationè¯¯å·®ï¼Œ$S^2$ä¸ª<code>grid cell</code>ï¼Œ æˆ‘ä»¬åŒæ ·åªå…³å¿ƒè´Ÿè´£é¢„æµ‹ç‰©ä½“çš„<code>grid cell</code>. å°†æˆ‘ä»¬é¢„æµ‹çš„ç±»åˆ«æ¦‚ç‡ä½¿ç”¨å¹³æ–¹å’Œè¯¯å·®åŠ èµ·æ¥ã€‚</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> YOLO </tag>
            
            <tag> è®ºæ–‡è§£è¯» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>faster rcnnçš„ç¼–è§£ç è¿‡ç¨‹</title>
      <link href="/2021/09/16/faster-rcnn-de-bian-jie-ma-guo-cheng/"/>
      <url>/2021/09/16/faster-rcnn-de-bian-jie-ma-guo-cheng/</url>
      
        <content type="html"><![CDATA[<blockquote><p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<br>ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€Œshuyeahã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚<br>åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/weixin_43227526/article/details/108018271" target="_blank" rel="noopener">https://blog.csdn.net/weixin_43227526/article/details/108018271</a></p></blockquote><h1 id="Faster-RCNNç½‘ç»œçš„è§£ç è¿‡ç¨‹å’Œç¼–ç è¿‡ç¨‹"><a href="#Faster-RCNNç½‘ç»œçš„è§£ç è¿‡ç¨‹å’Œç¼–ç è¿‡ç¨‹" class="headerlink" title="Faster RCNNç½‘ç»œçš„è§£ç è¿‡ç¨‹å’Œç¼–ç è¿‡ç¨‹"></a>Faster RCNNç½‘ç»œçš„è§£ç è¿‡ç¨‹å’Œç¼–ç è¿‡ç¨‹</h1><h2 id="Faster-RCNNç½‘ç»œçš„æ•´ä½“æ€è·¯ï¼š"><a href="#Faster-RCNNç½‘ç»œçš„æ•´ä½“æ€è·¯ï¼š" class="headerlink" title="Faster RCNNç½‘ç»œçš„æ•´ä½“æ€è·¯ï¼š"></a>Faster RCNNç½‘ç»œçš„æ•´ä½“æ€è·¯ï¼š</h2><p>Faster RCNNç½‘ç»œæ˜¯ä¸€ç§two-stageçš„ç›®æ ‡æ£€æµ‹ç®—æ³•ã€‚<br>ç®—æ³•å®ç°æ€è·¯é¦–å…ˆå°†è¾“å…¥çš„å›¾ç‰‡resizeæˆçŸ­è¾¹ä¸º600çš„å¤§å°ï¼Œä¼ å…¥åˆ°ä¸»å¹²ç‰¹å¾æå–ç½‘ç»œä¸­ï¼Œï¼ˆä¸»å¹²ç‰¹å¾æå–ç½‘ç»œå¯ä»¥ä½¿ç”¨ResNetã€VGGã€AlexNetç­‰ï¼‰ï¼Œæå–åˆ°çš„ç‰¹å¾å±‚å¯ä»¥çœ‹åšæ˜¯åœ¨åŸå›¾åƒä¸Šåˆ’åˆ†ä¸åŒçš„ç½‘æ ¼(ä¾‹å¦‚ï¼Œè¾“å…¥å›¾ç‰‡å¤§å°ä¸º600Ã—600ï¼Œå¾—åˆ°ç‰¹å¾å±‚å¤§å°ä¸º38Ã—38ï¼Œå¯ä»¥çœ‹åšåœ¨åŸå›¾ç‰‡ä¸Šåˆ’åˆ†æˆ38Ã—38çš„ç½‘æ ¼)ã€‚RPNç½‘ç»œï¼ˆåŒºåŸŸå»ºè®®ç½‘ç»œï¼‰å¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ª3Ã—3çš„å·ç§¯è¿›è¡Œç‰¹å¾æå–ï¼Œå°†ç‰¹å¾æå–çš„ç»“æœåˆ†åˆ«ç»è¿‡ä¸€ä¸ª1Ã—1çš„å·ç§¯é€šé“æ•°æ˜¯9ï¼Œè¿˜æœ‰ä¸€ä¸ª1Ã—1çš„å·ç§¯é€šé“æ•°æ˜¯36ã€‚è¿™ä¸¤ä¸ªå·ç§¯è¾“å‡ºçš„ç»“æœåˆ†åˆ«è¡¨ç¤ºçš„æ˜¯æ¯ä¸€ä¸ªç½‘æ ¼å¯¹åº”9ä¸ªå…ˆéªŒæ¡†ï¼Œæ¯ä¸€ä¸ªå…ˆéªŒæ¡†ä¸­æ˜¯å¦åŒ…å«ç‰©ä½“è¿˜æœ‰æ¯ä¸€ä¸ªå…ˆéªŒæ¡†çš„è°ƒæ•´å‚æ•°ã€‚<br>è°ƒæ•´ä»¥åçš„å…ˆéªŒæ¡†ç§°ä¸ºå»ºè®®æ¡†ï¼Œä¹Ÿå°±æ˜¯ç²—ç•¥çš„ç­›é€‰ï¼Œæ¥ç€å°†å»ºè®®æ¡†è¾“å…¥åˆ°Roipoolingç½‘ç»œä¸­è¿›è¡Œç²¾ç»†çš„ç­›é€‰ã€‚åˆ©ç”¨å»ºè®®æ¡†åœ¨å…±äº«ç‰¹å¾å±‚ä¸Šè¿›è¡Œæˆªå–ï¼Œè®²è§£å»åˆ°çš„å±€éƒ¨ç‰¹å¾å±‚resizeæˆç›¸åŒçš„å¤§å°ï¼Œç”¨åˆ†ç±»bbox_predç½‘ç»œå’Œå›å½’ç½‘ç»œcls_predï¼Œåˆ¤æ–­å»ºè®®æ¡†ä¸­æ˜¯å¦å­˜åœ¨ç‰©ä½“è¿˜æœ‰å»ºè®®æ¡†çš„è°ƒæ•´å‚æ•°ï¼Œå¾—åˆ°æœ€ç»ˆçš„é¢„æµ‹ç»“æœã€‚</p><h2 id="1ã€è§£ç è¿‡ç¨‹-é¢„æµ‹è¿‡ç¨‹"><a href="#1ã€è§£ç è¿‡ç¨‹-é¢„æµ‹è¿‡ç¨‹" class="headerlink" title="1ã€è§£ç è¿‡ç¨‹(é¢„æµ‹è¿‡ç¨‹)"></a>1ã€è§£ç è¿‡ç¨‹(é¢„æµ‹è¿‡ç¨‹)</h2><h3 id="è§£ç è¿‡ç¨‹åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š"><a href="#è§£ç è¿‡ç¨‹åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š" class="headerlink" title="è§£ç è¿‡ç¨‹åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š"></a>è§£ç è¿‡ç¨‹åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š</h3><p>å¯¹å…ˆéªŒæ¡†è¿›è¡Œè°ƒæ•´çš„è§£ç è¿‡ç¨‹</p><p>å¯¹å»ºè®®æ¡†è¿›è¡Œè°ƒæ•´çš„è§£ç è¿‡ç¨‹</p><h4 id="1-å¯¹å…ˆéªŒæ¡†è¿›è¡Œè°ƒæ•´"><a href="#1-å¯¹å…ˆéªŒæ¡†è¿›è¡Œè°ƒæ•´" class="headerlink" title="1.å¯¹å…ˆéªŒæ¡†è¿›è¡Œè°ƒæ•´"></a>1.å¯¹å…ˆéªŒæ¡†è¿›è¡Œè°ƒæ•´</h4><p>RPNç½‘ç»œçš„è¾“å‡ºç»“æœè¿›è¡Œè§£ç ï¼Œå¯¹å…ˆéªŒæ¡†è¿›è¡Œè°ƒæ•´å¾—åˆ°å»ºè®®æ¡†ã€‚<br>é¦–å…ˆæå–åŸå§‹å›¾ç‰‡çš„å®½é«˜ã€å¤åˆ¶åŸå§‹å›¾ç‰‡ã€‚æŠŠå›¾ç‰‡çš„è¾ƒçŸ­è¾¹å›ºå®šä¸º600 å¤§å°ï¼Œå¯¹å›¾ç‰‡è¿›è¡Œresizeæ“ä½œï¼Œå¹¶ä¸”è¿›è¡Œå½’ä¸€åŒ–é¢„å¤„ç†æ“ä½œï¼Œå°†åŸå§‹å›¾ç‰‡è½¬åŒ–æˆnumpy çš„æ ¼å¼ã€‚<br>åœ¨å‡½æ•°detection_outå‡½æ•°ä¸­å°†rpnç½‘ç»œçš„è¾“å‡ºç»“æœè¿›è¡Œè§£ç ï¼šé¦–å…ˆé€šè¿‡ç½®ä¿¡åº¦å¯¹å…ˆéªŒæ¡†è¿›è¡Œç­›é€‰ï¼›åœ¨å‡½æ•°ä¸­è°ƒç”¨decode_boxeså‡½æ•°è§£ç ï¼Œdecode_boxeså‡½æ•°é¦–å…ˆæå–å‡ºå…ˆéªŒæ¡†çš„ä¸­å¿ƒç‚¹åæ ‡å’Œå®½é«˜ï¼Œç„¶åå¯¹rpnç½‘ç»œçš„è¾“å‡ºç»“æœä¸­çš„è°ƒæ•´å‚æ•°è§£ç ï¼Œä½œç”¨äºå…ˆéªŒæ¡†ï¼Œå¾—åˆ°è°ƒæ•´ä»¥åçš„å…ˆéªŒæ¡†ã€‚æŠŠå…ˆéªŒæ¡†çš„æ ¼å¼è½¬åŒ–æˆå·¦ä¸Šè§’å’Œå³ä¸‹è§’åæ ‡çš„æ ¼å¼å †å ï¼Œå®Œæˆè§£ç ã€‚<br>å¯¹äºå»ºè®®æ¡†ï¼Œç”¨ç½®ä¿¡åº¦å’Œioué‡åˆç¨‹åº¦æ¥ç­›é€‰ï¼Œè¿”å›çš„ç»“æœè½¬åŒ–æˆå°æ•°çš„å½¢å¼å­˜æ”¾åœ¨Rä¸­ã€‚</p><h4 id="2-å¯¹å»ºè®®æ¡†è¿›è¡Œè°ƒæ•´"><a href="#2-å¯¹å»ºè®®æ¡†è¿›è¡Œè°ƒæ•´" class="headerlink" title="2.å¯¹å»ºè®®æ¡†è¿›è¡Œè°ƒæ•´"></a>2.å¯¹å»ºè®®æ¡†è¿›è¡Œè°ƒæ•´</h4><p>åˆ©ç”¨classifierç½‘ç»œçš„è¾“å‡ºç»“æœå¯¹å»ºè®®æ¡†è¿›è¡Œè°ƒæ•´å¾—åˆ°æœ€ç»ˆçš„é¢„æµ‹æ¡†ã€‚<br>Rä¸­å­˜æ”¾çš„æ˜¯å»ºè®®æ¡†ï¼Œæ¯æ¬¡è¾“å…¥åˆ°ROI_Poolingç½‘ç»œçš„å»ºè®®æ¡†æ•°é‡ä¸º32ï¼Œä¸èƒ½è¢«32æ•´é™¤çš„ç”¨0æ¥è¡¥å…¨ã€‚<br>ç”¨ç½®ä¿¡åº¦å¯¹å»ºè®®æ¡†ç­›é€‰ï¼Œç”¨å»ºè®®æ¡†å’Œå…±äº«ç‰¹å¾å±‚å¾—åˆ°æœ€ç»ˆçš„é¢„æµ‹æ¡†ç»“æœã€‚classifierç½‘ç»œè¾“å‡ºç»“æœä¸­çš„è°ƒæ•´å‚æ•°è§£ç ï¼Œè®¡ç®—å‡ºä¸­ç‚¹åæ ‡å’Œå®½é«˜çš„è°ƒæ•´å‚æ•°ï¼Œä½œç”¨äºå»ºè®®æ¡†ï¼Œå¾—åˆ°æœ€ç»ˆçš„é¢„æµ‹æ¡†ã€‚<br>å°†æœ€ç»ˆé¢„æµ‹æ¡†çš„ç»“æœè½¬åŒ–ä¸ºå°æ•°å½¢å¼ï¼Œç”¨éæå¤§å€¼æŠ‘åˆ¶è¿›è¡Œç­›é€‰ï¼Œç»“æœå­˜æ”¾åœ¨resultä¸­ã€‚</p><h2 id="2ã€ç¼–ç è¿‡ç¨‹ï¼ˆè®­ç»ƒè¿‡ç¨‹ï¼‰"><a href="#2ã€ç¼–ç è¿‡ç¨‹ï¼ˆè®­ç»ƒè¿‡ç¨‹ï¼‰" class="headerlink" title="2ã€ç¼–ç è¿‡ç¨‹ï¼ˆè®­ç»ƒè¿‡ç¨‹ï¼‰"></a>2ã€ç¼–ç è¿‡ç¨‹ï¼ˆè®­ç»ƒè¿‡ç¨‹ï¼‰</h2><p>ç¼–ç è¿‡ç¨‹åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š</p><p>rpnç½‘ç»œçš„è®­ç»ƒè¿‡ç¨‹<br>classifierç½‘ç»œçš„è®­ç»ƒè¿‡ç¨‹<br>åœ¨è®­ç»ƒè¿‡ç¨‹ç”¨åˆ°ç¼–ç è¿‡ç¨‹ã€‚<br>åœ¨è§£ç è¿‡ç¨‹ä¸­æ˜¯å¯¹å…ˆéªŒæ¡†è¿›è¡Œè°ƒæ•´å¾—åˆ°å»ºè®®æ¡†ï¼Œç„¶åå¯¹å»ºè®®æ¡†è¿›è¡Œè°ƒæ•´å¾—åˆ°æœ€ç»ˆçš„é¢„æµ‹æ¡†ã€‚<br>è®­ç»ƒè¿‡ç¨‹å°±éœ€è¦å°†çœŸå®æ¡†ç¼–ç æˆå»ºè®®æ¡†ç½‘ç»œï¼ˆRPNï¼‰å’Œclassifierç½‘ç»œçš„é¢„æµ‹ç»“æœçš„æ ¼å¼ã€‚</p><h4 id="1-rpnç½‘ç»œçš„è®­ç»ƒè¿‡ç¨‹"><a href="#1-rpnç½‘ç»œçš„è®­ç»ƒè¿‡ç¨‹" class="headerlink" title="1.rpnç½‘ç»œçš„è®­ç»ƒè¿‡ç¨‹"></a>1.rpnç½‘ç»œçš„è®­ç»ƒè¿‡ç¨‹</h4><p>åœ¨å‡½æ•°assign_boxesä¸­ï¼Œé¦–å…ˆè®¡ç®—å…ˆéªŒæ¡†çš„ä¸ªæ•°ï¼Œ<br>æ„å»ºä¸€ä¸ª0çŸ©é˜µï¼Œç¬¬ä¸€ä¸ªç»´åº¦æ˜¯å…ˆéªŒæ¡†çš„ä¸ªæ•°ã€ç¬¬äºŒä¸ªç»´åº¦æ˜¯å…ˆéªŒæ¡†çš„ä½ç½®å’Œå…ˆéªŒæ¡†ä¸­æ˜¯éƒ½å­˜åœ¨ç‰©ä½“ã€‚è®¡ç®—çœŸå®æ¡†å’Œæ‰€æœ‰å…ˆéªŒæ¡†çš„é‡åˆç¨‹åº¦ï¼Œä¿ç•™é‡åˆç¨‹åº¦è¾ƒé«˜çš„å…ˆéªŒæ¡†ä½œä¸ºæ­£æ ·æœ¬ï¼Œï¼ˆè¿™äº›å…ˆéªŒæ¡†å’ŒçœŸå®æ¡†çš„é‡åˆç¨‹åº¦è¾ƒé«˜ï¼Œå¯ä»¥é€šè¿‡è°ƒæ•´å¾—åˆ°çœŸå®æ¡†ï¼‰ã€‚<br>åœ¨å‡½æ•°encode_boxesä¸­ï¼Œåˆ©ç”¨ç­›é€‰åçš„å…ˆéªŒæ¡†å’ŒçœŸå®æ¡†è¿›è¡Œç¼–ç ã€‚å¾—åˆ°RPNç½‘ç»œåº”æœ‰çš„é¢„æµ‹ç»“æœã€‚</p><p>è¿™é‡Œç¼–ç å’Œè§£ç è¿‡ç¨‹å¯ä»¥çœ‹åšä¸€ä¸ªé€†è¿‡ç¨‹ï¼Œä¹˜/é™¤ã€æŒ‡æ•°/å¯¹æ•°</p><p>ç„¶åå¹³è¡¡æ­£è´Ÿæ ·æœ¬ï¼Œè´Ÿæ ·æœ¬çš„æ•°é‡è¿œå¤§äºæ­£æ ·æœ¬çš„æ•°é‡ï¼Œè¿™é‡Œèˆå¼ƒä¸€éƒ¨åˆ†çš„è´Ÿæ ·æœ¬ï¼Œå°†æ­£è´Ÿæ ·æœ¬çš„æ•°é‡è§„å®šåœ¨ä¸€ä¸ªå¸¸æ•°å€¼ã€‚</p><h4 id="2-classifierç½‘ç»œçš„è®­ç»ƒè¿‡ç¨‹"><a href="#2-classifierç½‘ç»œçš„è®­ç»ƒè¿‡ç¨‹" class="headerlink" title="2.classifierç½‘ç»œçš„è®­ç»ƒè¿‡ç¨‹"></a>2.classifierç½‘ç»œçš„è®­ç»ƒè¿‡ç¨‹</h4><p>åˆ©ç”¨å»ºè®®æ¡†å’Œå…±äº«ç‰¹å¾å±‚å¾—åˆ°æœ€ç»ˆçš„é¢„æµ‹ç»“æœã€‚<br>è®¡ç®—å»ºè®®æ¡†å’ŒçœŸå®æ¡†çš„é‡åˆç¨‹åº¦ï¼Œé‡åˆç¨‹åº¦å¤§äº0.5è§†ä¸ºæ­£æ ·æœ¬ï¼Œé‡åˆç¨‹åº¦0.1&lt;x&lt;0.5è§†ä¸ºè´Ÿæ ·æœ¬ï¼Œx&lt;0.5çš„æƒ…å†µèˆå¼ƒæ ·æœ¬ã€‚<br>åœ¨å‡½æ•°calc_iouä¸­ï¼ŒæŠŠå»ºè®®æ¡†å’ŒçœŸå®æ¡†è¿›è¡Œç¼–ç ï¼Œå¾—åˆ°classifierç½‘ç»œåº”æœ‰çš„é¢„æµ‹ç»“æœã€‚åœ¨å¹³è¡¡æ­£è´Ÿæ ·æœ¬ï¼Œå°†æ­£è´Ÿæ ·æœ¬è¾“å…¥åˆ°ç½‘ç»œä¸­è¿›è¡Œè®­ç»ƒã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> Faster RCNN </tag>
            
            <tag> cv </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æˆ‘çœ‹ä»Šå¤©è°è¿˜æ•¢ä¹°å°ç±³æ——èˆ°ï¼</title>
      <link href="/2021/09/16/wo-kan-jin-tian-shui-huan-gan-mai-xiao-mi-qi-jian/"/>
      <url>/2021/09/16/wo-kan-jin-tian-shui-huan-gan-mai-xiao-mi-qi-jian/</url>
      
        <content type="html"><![CDATA[<p>æ˜¨å¤©å‡Œæ™¨æˆ‘å’Œæˆ‘å®¤å‹èŠå¤©ï¼Œçªç„¶èŠåˆ°äº†å°ç±³çš„ä¸€äº›é—®é¢˜ï¼Œç„¶åçªç„¶ä¸€ä½æ¥äº†å‡ å¥â€œæˆ‘çœ‹ä»Šå¤©è°è¿˜æ•¢ä¹°å°ç±³æ——èˆ°ï¼ï¼ï¼â€ï¼Œä»–ä¸€é¡¿ç ´éŸ³æˆ‘ä»¬èµ¶å¿™è®©ä»–å°ç‚¹å£°ï¼Œæ¯•ç«Ÿå‡Œæ™¨ä¸€ç‚¹å¤šäº†ï¼Œ<del>æˆ‘ä»¬å¯ä¸æ•¢å†è¢«éš”å£å®¿èˆä¸¾æŠ¥ä¸€æ¬¡</del>ã€‚ç„¶åå¦ä¸€ä½å®¤å‹å°±è®©æˆ‘ä»¬çœ‹äº†ä¸€ä¸‹æ‰€è°“çš„â€œå°ç±³åœ£ç»â€ã€‚wocï¼Œè¿™å£°è°ƒé…ä¸Šè¿™æ ·æ§½ç‚¹æ»¡æ»¡çš„å°ç±³ï¼Œç®€ç›´äº†ï¼Œæˆ‘ä»¬å®¿èˆç‹‚ç¬‘ä¸æ­¢ã€‚è€Œåæˆ‘ä»Šå¤©åˆæ¸©ä¹ äº†è¿™ä¸€â€œç»å…¸â€ï¼Œè¿å¸¦ç€çœ‹äº†è®¸è®¸å¤šå¤šçš„å…¶ä»–UPä¸»ä¾æ¬¡ä¸ºç´ æåˆ›ä½œçš„å…¶ä»–çš„ä½œå“ï¼Œç®€ç›´ç¬‘æ­»äº†ã€‚è€Œåçœ‹åˆ°äº†æœ‰å…³çš„ä¸€äº›æ–‡å­—è®°å½•ï¼Œè§‰å¾—è¿™ä¹ˆæœ‰æ„æ€çš„ä¸œè¥¿éå¸¸å€¼å¾—è®°å½•ä¸‹æ¥ï¼Œå°±è½¬è½½äº†åˆ«äººè®°å½•çš„åŸæ–‡ï¼Œå¦‚ä¸‹ï¼š</p><p>æˆ‘çœŸçš„æ˜¯æœäº†å°ç±³äº†ï¼</p><p>ä»– ä»Š åŸæœ¬æˆ‘ä»Šå¤©æ™šä¸Šä¸€ç‚¹äº‹éƒ½æ²¡æœ‰</p><p>ä»Šå¤©æ™šä¸Šå¶ç„¶æˆ‘çš„æœ‹å‹è·Ÿæˆ‘ é—®æˆ‘</p><p>K40çš„ï¼ˆMIUIï¼‰12.5.5 çš„é‚£ä¸ª</p><p>å…¬12.10ï¼ˆå£è¯¯ï¼‰</p><p>é‚£ä¸ªå¢å¼ºç‰ˆä¸ºä»€ä¹ˆè¿˜æ²¡ä¸Šï¼Ÿ </p><p>å¥½å˜›ï¼æˆ‘æ‰“å¼€å°ç±³ç¤¾åŒºä¸€çœ‹</p><p>å‘ç°å®ƒè«åå…¶å¦™å¼¹äº†ä¸ªé€šçŸ¥</p><p>è·Ÿæˆ‘è¯´è¿™ä¸ª</p><p>K40å¼€å‘ç‰ˆå†…æµ‹ç”³è¯·å·²é€šè¿‡</p><p>æˆ‘æƒ³ç€å“ï¼Ÿæˆ‘æ²¡æœ‰</p><p>è¿™ä¸ªK40å¼€å‘ç‰ˆå†…æµ‹çš„æƒé™</p><p>æˆ‘æ²¡æœ‰ç»™ä»–æŠ¥åå•Šï¼Ÿ</p><p>ç„¶åæˆ‘å°±ç‚¹è¿›æ¥ä¸€çœ‹ï¼Œçœ‹åˆ°å“ï¼Ÿ</p><p>æˆ‘è«åå…¶å¦™å¤šå‡ºæ¥ä¸€ä¸ªK40çš„å†…æµ‹</p><p>ç„¶åæˆ‘çœ‹ä¸€ä¸‹</p><p>å“ä¸å¯¹å•Š</p><p>æˆ‘å°ç±³10è‡³å°Šç‰ˆçš„å¼€å‘ç‰ˆå…¬æµ‹å‘¢ï¼Ÿ</p><p>ä¸ºä»€ä¹ˆæ²¡æœ‰äº†å‘€ï¼Ÿ</p><p>ä¸ºä»€ä¹ˆè¿™é‡Œå…¨å˜æˆç”³è¯·äº†å‘€ï¼Ÿ</p><p>æˆ‘åŸæœ¬300å¤šçš„å†…æµ‹åˆ†æ€ä¹ˆå˜æˆ55äº†å‘€ï¼Ÿ</p><p>å®Œè›‹äº†å‘€ï¼</p><p>ç„¶åæˆ‘è¿™è¾¹çœ‹äº†ä¸€ä¸‹æˆ‘çš„ä¿¡æ¯ï¼Œ</p><p>æˆ‘ä»¬é—æ†¾çš„é€šçŸ¥æ‚¨</p><p>ç”±äºæ‚¨åœ¨2021å¹´æœªå®Œæˆå†…æµ‹è€ƒæ ¸</p><p>æ‚¨åœ¨è¯¥ä¸Šé¢å†…æµ‹èµ„æ ¼å·²è¢«å–æ¶ˆ</p><p>æ˜¯ï¼å–æ¶ˆäº†æ²¡å…³ç³»</p><p>é—®é¢˜æ˜¯ï¼ </p><p>æˆ‘æ ¹æœ¬æ²¡æœ‰Note8Proçš„æ‰‹æœº</p><p>æˆ‘æ›¾ç»æœ‰ä¸€å°Note8Proçš„æ‰‹æœº</p><p>åæ¥æˆ‘æŠŠå®ƒäºŒæ‰‹å‡ºæ‰äº†ï¼</p><p>ç°åœ¨æ˜¯æ€ä¹ˆæ ·ï¼Œ</p><p>æˆ‘å¿˜è®°å–æ¶ˆäº†</p><p>æ»¡æ„äº†å—ï¼</p><p>æˆ‘å¿˜è®°å–æ¶ˆäº†ä½†æ˜¯æˆ‘ä¹‹å‰æœ‰</p><p>ä¹‹å‰è¿™ä¸ªå°ç±³ç¤¾åŒº3.0æ—¶å€™,</p><p>å®ƒå¥½åƒå†…æµ‹åªå…è®¸ä¸‰å°è®¾å¤‡</p><p>æˆ‘å°±æŠŠæˆ‘12345678</p><p>æˆ‘æ˜¯æˆ‘åœ¨å°ç±³è¿™é‡Œä¹°äº†ä¸æ­¢å</p><p>æˆ‘åœ¨å°ç±³è¿™é‡Œå¯èƒ½ä¹°äº†åå‡ ã€äºŒåå°æ‰‹æœº</p><p>åœ¨ä»¥å‰å¼€å‘ç‰ˆ</p><p>éšä¾¿åˆ·çš„æ—¶å€™</p><p>æˆ‘æŠŠæˆ‘çš„æ¯ä¸€å°å°ç±³è®¾å¤‡çœ‹åˆ°äº†å—ï¼</p><p>è¿™19,000çš„æ¶ˆè´¹é‡‘é¢ï¼</p><p>çœ‹åˆ°äº†å—ï¼</p><p>è¿™ä¹ˆå¤šçš„çº¿ä¸Šé—¨åº—æˆ‘ä¹°æˆ‘</p><p>å®è¯è¯´æˆ‘ç¡®å®æ˜¯ç±³ç²‰ï¼æˆ‘å°±æ˜¯ä¸ªå‚»é€¼ï¼</p><p>æ»¡æ„äº†å—ï¼</p><p>æˆ‘ä»–å¦ˆåˆ·å¼€å‘ç‰ˆåˆ·äº†ï¼Œæ•°</p><p>æ²¡åˆ·æ²¡åˆ·æ²¡åˆ·æœ‰ï¼ˆå£è¯¯ï¼‰</p><p>äº”å…­åæ¬¡äºŒä¸‰åæ¬¡éƒ½æœ‰äº†ï¼</p><p>æˆ‘æŠŠå°ç±³10å…¨ç³»åˆ—ä¹°äº†ä¸€éï¼</p><p>10ã€10Proã€10Sã€10Ultraæˆ‘å…¨ä¹°äº†</p><p>è¿™æ˜¯æˆ‘çš„ç¬¬äºŒå°10Ultra</p><p>æˆ‘å°±æƒ³è€è€å®å®ç”¨å¼€å‘ç‰ˆå…¬æµ‹å…»ä¸ªè€</p><p>ä½ å°ç±³ç‰›é€¼ï¼</p><p>å¥½å§ï¼æŠŠæˆ‘å†…æµ‹åˆ†300å¤šçš„å†…æµ‹åˆ†</p><p>ç»™æˆ‘ç¡¬ç”Ÿç”Ÿæ‰£åˆ°55ï¼Œç‰›é€¼ï¼</p><p>ä½ çŸ¥é“æˆ‘æ€ä¹ˆåˆ·</p><p>å•Šï¼Ÿæˆ‘ä¸€çœ‹é€šçŸ¥æˆ‘æ²¡å®Œæˆä»»åŠ¡</p><p>é‚£æˆ‘ä¹‹å‰ä¸ºä»€ä¹ˆ</p><p>æˆ‘ä¹‹å‰æ²¡å®Œæˆä»»åŠ¡çš„æ—¶å€™</p><p>ä½ ä¸æŠŠæˆ‘å¼€å‘ç‰ˆå†…æµ‹ç‰ˆåŠ åˆ°æˆ‘è¿™ä¹ˆåˆ·ä¸Šæ¥å•Šï¼Ÿ</p><p>è·‘åˆ°ç°åœ¨è¿™ä¸ªæ—¶å€™è·‘åˆ°ä»Šå¤©ï¼</p><p>ä»Šå¤©8æœˆ16å·</p><p>å¼€å§‹è·Ÿæˆ‘è¯´å†…æµ‹èµ„æ ¼æœªå®¡æ ¸é€šè¿‡</p><p>æ‰¾å®¢æœåˆæ‰¾ä¸åˆ°è¿™ä¸ªä»€ä¹ˆåƒåœ¾</p><p>å°ç±³ç¤¾åŒº3.0Appå•Š!</p><p>è¿ä¸ªå®¢æœé€šé“éƒ½æ²¡æœ‰å•Šï¼Ÿ</p><p>æˆ‘å°±å¥½å¥‡äº†?</p><p>æˆ‘èŠ±è¿™ä¹ˆå¤šçš„é’±ä¹°ä¸€ä¸ªå°ç±³</p><p>ä½ ç±³ç”¨åƒåœ¾å°±ç®—äº†!</p><p>æˆ‘åˆ·å¼€å‘æ¿å…»è€</p><p>å› ä¸ºå¼€å‘æ¿æ¯”ç¨³å®šç‰ˆç¨³å®š!</p><p>æˆ‘å¿äº†å¥½å—?</p><p>ä½†æ˜¯ä½ ç°åœ¨æ˜¯æ€ä¹ˆæ ·ï¼Ÿ</p><p>ä½ ç›´æ¥ä»–å¦ˆç»æˆ‘å!</p><p>æˆ‘å…¬æµ‹èµ„æ ¼æ²¡äº†ä½ çœ‹åˆ°äº†å—ï¼Ÿ</p><p>é›·å†›ï¼</p><p>é‡‘å‡¡ï¼</p><p>çœ‹åˆ°äº†å—ï¼ </p><p>ä»€ä¹ˆå¼±æ™ºå•Šï¼å•Šï¼Ÿ</p><p>æˆ‘ä»Šå¤©å°±è¦è¯´å°ç±³çš„ä¸å¥½äº†ï¼Œå¥½å§æˆ‘ã€‚</p><p>æˆ‘ã€æˆ‘è§‰å¾—æˆ‘æœ‰</p><p>æˆ‘è§‰å¾—æˆ‘å¯ä»¥æˆ‘å°±æœ‰èµ„æ ¼è¯´å°ç±³ä¸å¥½ï¼</p><p>çœ‹åˆ°è¿™å››åƒå¤šçš„ç±³é‡‘äº†å—ï¼Ÿå•Šï¼Ÿ</p><p>æˆ‘çœŸçš„ä¸æ˜¯ï¼Œä¸æ˜¯æˆ‘å¹ï¼</p><p>æˆ‘ä¹°å°ç±³çš„è®¾å¤‡çœŸçš„ä¹°äº†éå¸¸çš„å¤šï¼</p><p>æˆ‘çœŸçš„éå¸¸æ”¯æŒå°ç±³ï¼</p><p>ä½ çœ‹ä»Šå¹´8æœˆ16æ—¥</p><p>æˆ‘å°ç±³å¹³æ¿è™½ç„¶æ˜¯åœ¨äº¬ä¸œé¢„å®šçš„ï¼Œ</p><p>ä½†æˆ‘èµ·ç ä¹Ÿæ˜¯æ”¯æŒäº†ä¸€ä¸‹é›·æ€»çš„ã€‚</p><p>æ‰€è°“çš„é«˜ç«¯æ¢¦</p><p>å°ç±³11æˆ‘ä¹Ÿä¹°äº†ï¼Œæˆ‘è¿˜ä¹°äº†ä¸¤å°</p><p>ç»“æœä½ ç»™æˆ‘çƒ§wifi</p><p>è¿™ä¸ªæˆ‘ä¹Ÿå°±ç®—äº†</p><p>æ¯•ç«Ÿæˆ‘ç°åœ¨ç”¨çš„æ˜¯10Ultra</p><p>å¥½å§æˆ‘æ¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼Œ</p><p>çœ‹ç¬¬ä¸€ä¸ªï¼Œæ˜Ÿè¾°çœ‹åˆ°æ²¡æœ‰ï¼</p><p>æ˜Ÿè¾°ï¼Œæˆ‘æœ‰èµ„æ ¼è¯´å§ï¼Ÿ</p><p>æˆ‘æœ‰èµ„æ ¼ï¼Œ</p><p>è¯´æˆ‘æœ‰ã€æˆ‘æœ‰èµ„æ ¼è¯„ä»·ä¸€ä¸‹å°ç±³å§ï¼</p><p>æˆ‘æ˜¯ä¸ªç±³ç²‰å§ï¼æˆ‘ä¸æ˜¯é‚£ä»€ä¹ˆå¤§é»‘çš„ï¼</p><p>æ˜Ÿè¾°ï¼</p><p>çœ‹çœ‹å‡çº§ä»¬è¿˜è¦å¤šå°‘</p><p>è¦1000ï¼</p><p>çœ‹åˆ°äº†å—ï¼Ÿ</p><p>1,000ï¼</p><p>çœ‹åˆ°æ²¡ç±³é‡‘æŠ½å¥–160çš„å¹¸è¿å€¼ï¼</p><p>æˆ‘é‚£å¤©æˆ‘ä¸çŸ¥é“åœ¨æŠ½ä»€ä¹ˆé£ã€‚</p><p>æˆ‘å°±æ‹¿ç€è¿™äºŒåç±³é‡‘</p><p>å› ä¸ºæˆ‘å½“æ—¶æœ‰ä¸€ä¸‡å¤šçš„ç±³é‡‘ï¼</p><p>æˆ‘å°±ç‚¹å•Šç‚¹å•Šç‚¹åˆ°å¹¸è¿å€¼160ï¼</p><p>é€æˆ‘è®°å¾—æˆ‘æŠ½äº†å·®ä¸å¤š20ä¸ªæŒ‡ç”²åˆ€ï¼</p><p>çœ‹åˆ°äº†å—ï¼</p><p>è¿™20ä¸ªæŒ‡ç”²åˆ€ä¹Ÿåƒä¸ªå¼±æ™ºä¸€æ ·çš„ï¼</p><p>è¿™æŒ‡ç”²åˆ€ä¸€æŠŠä¹å—ä¹ï¼</p><p>ä½ ä¹°äº†ï¼Œä½ è¦ä»˜ä¸€åˆ†é’±çš„é‚®è´¹ï¼</p><p>ä¸ï¼Œä½ è¦ä»˜ä¸€åˆ†é’±çš„é’±ï¼</p><p>ä¸€åˆ†é’±çš„é’±ç®—äº†ï¼</p><p>ä½ çº¿ä¸‹å°ç±³ä¹‹å®¶å…‘æ¢ä¸äº†æ˜¯å§ï¼</p><p>ä½ çº¿ä¸Šä¹°è¿™ä¸ªæŒ‡ç”²åˆ€ï¼</p><p>è¿˜è¦é¢å¤–ä»˜10å—é’±è¿è´¹ï¼</p><p>è€Œä¸”è¿™ä¸ªä¼˜æƒ å·è¿˜ä¸èƒ½å åˆ°ä¸€èµ·ï¼</p><p>å°±æ˜¯è¯´æˆ‘èŠ±10.01å—é’±</p><p>ä¹°ä½ ä¸€æŠŠä¹å—ä¹çš„æŒ‡ç”²åˆ€</p><p>ä½ å½“æˆ‘æ˜¯å‚»å­å—ï¼Ÿ</p><p>æˆ‘ä»¬å†ç‚¹å¼€æ¥è¿™ä¸ªè®¾å¤‡ç§¯åˆ†ï¼</p><p>æˆ‘ç¬¬ä¸€æ¬¡ç‚¹å¼€æ¥æˆ‘æ•´ä¸ªäººéƒ½å‚»äº†ï¼</p><p>ä½ çŸ¥é“å—ï¼Ÿ</p><p>è¶…99.9%çš„ç”¨æˆ·ï¼</p><p>æˆ‘éƒ½æ€€ç–‘ï¼Œæˆ‘å°±è¿™ä¹ˆã€Šç®€ç®€å•å•ã€‹ä¹°å‡ å°è®¾å¤‡ï¼</p><p>æ€ä¹ˆå¯èƒ½è¶…99%çš„ç”¨æˆ·ï¼</p><p>æˆ‘çœŸçš„æ˜¯ï¼æˆ‘æœäº†æˆ‘ï¼</p><p>é‚£ä¸€ç‚¹ä¸€ç‚¹æˆ‘æ”¯æŒå°ç±³æ”¯æŒäº†è¿™ä¹ˆä¹…ï¼Œ</p><p>ä½ ç°åœ¨å€’å¥½ï¼</p><p>è¿™ä¸ªå°ç±³ç‰¹æƒï¼</p><p>éšéšä¾¿ä¾¿å°±æŠŠæˆ‘å¼€å‘ç‰ˆç»™åœæ‰äº†ï¼</p><p>ä½ è‡ªå·±çœ‹æˆ‘ï¼</p><p>æˆ‘çš„å°ç±³10Ultra</p><p>ä¸æ˜¯å¼€å‘ç‰ˆå—ï¼Ÿ</p><p>éš¾é“æ˜¯å‡çš„å—ï¼Ÿ</p><p>æˆ‘è¯´æ€ä¹ˆæ”¶ä¸åˆ°æ›´æ–°æ¨é€ï¼Ÿ</p><p>ä½ è‡ªå·±å·å·æ‘¸æ‘¸çš„æŠŠæˆ‘çš„å¼€å‘ç‰ˆæƒé™</p><p>å–æ¶ˆæ‰äº†ï¼</p><p>å–æ¶ˆæ‰å°±ç®—äº†ï¼</p><p>æˆ‘300å¤šçš„å†…æµ‹åˆ†ï¼</p><p>ä½ è¿˜ç»™æˆ‘ç¡¬ç”Ÿç”Ÿçš„è°ƒåˆ°50ï¼</p><p>å•Šï¼Ÿå¾ˆæœ‰æ„æ€å—ï¼</p><p>ä½ è‡ªå·±çœ‹çœ‹ä½ è®¾ç½®çš„ä»€ä¹ˆå¼±æ™ºä¸œè¥¿å•Šï¼</p><p>ä¿®æ”¹å¤´åƒåŠ 20åˆ†ï¼ä¿®æ”¹æ˜µç§°åŠ 20åˆ†ï¼</p><p>ä¿®æ”¹ä¸ªæ€§ç­¾ååŠ 20åˆ†ï¼</p><p>ç‚¹èµæ¯æ—¥3å¤©5æ¬¡å†åŠ 1åˆ†ï¼</p><p>æˆ‘ç«Ÿç„¶æŠŠè¿™ä¸Šé¢è¿™å‰é¢ä¸‰ä¸ªå…¨éƒ¨åšå®Œï¼</p><p>ä½ èƒ½ç»™æˆ‘åŠ å¤šå°‘åˆ†ä¸€å¤©ï¼Ÿ</p><p>ä¸€å¤©æ˜¯ä¸æ˜¯åŠ 16åˆ†ï¼Ÿ</p><p>ä½ è·Ÿæˆ‘ç®—ä¸€ä¸‹</p><p>300å‡55é™¤ä»¥16</p><p>æˆ‘è¦åšå¤šå°‘å¤©ï¼Ÿ</p><p>æˆ‘å°±çœŸçš„æœäº†è¿™äº›å°ç±³äº†ï¼</p><p>ä¸ºä»€ä¹ˆä½ ä¹‹å‰çš„ä¸œè¥¿ä¸å¸®æˆ‘å¤„ç†å¥½ï¼Ÿ</p><p>ååè¿™ä¸ªæ—¶å€™æ¥å¸®æˆ‘å¤„ç†ï¼</p><p>å¸®æˆ‘æŠŠè¿™ä¸ªä¸œè¥¿å°ç¦æ‰ï¼</p><p>å¦‚æœä¸æ˜¯æˆ‘çœ‹åˆ°ï¼</p><p>æˆ‘è¿™æ‰€è°“çš„ä»€ä¹ˆK40å¼€å‘ç‰ˆå†…æµ‹é€šè¿‡</p><p>æˆ‘ä¸¥é‡æ€€ç–‘ä½ ä»¬è¿™ä¸ªä»€ä¹ˆç»„ç»‡ï¼Ÿ</p><p>å°±æ˜¯æœ‰bugï¼</p><p>æŠŠæˆ‘å…¶ä»–é‚£ä¸ªå…¨åˆ äº†ï¼</p><p>å”¯ç‹¬ç»™æˆ‘ç•™äº†ä¸€ä¸ªæˆ‘æ²¡æœ‰K40</p><p>ä½ æœ‰æ¯’å§ä½ ä»¬ï¼</p><p>æˆ‘è¿˜èƒ½ç‚¹è¿›å»ï¼</p><p>55åˆ†çš„å†…æµ‹åˆ†æˆ‘èƒ½ç‚¹è¿›å»ï¼Ÿ</p><p>é‚£æˆ‘ä¸ºä»€ä¹ˆä¸èƒ½æ‹¥æœ‰å°ç±³10è‡³å°Šç‰ˆçš„å¼€å‘ç‰ˆå…¬æµ‹å•Šï¼</p><p>æˆ‘æœ¬æ¥å°±æœ‰å°ç±³10è‡³å°Šç‰ˆçš„å¼€å‘ç‰ˆå…¬æµ‹ï¼</p><p>ç‚¹è¿›å»å†…æµ‹åˆ†ä¸è¶³300ï¼Ÿ</p><p>æˆ‘æœ¬æ¥å°±æœ‰350å¤š360å¤šï¼</p><p>æˆ‘å°±ç”¨ä¸ªå¼€å‘ç‰ˆå…»è€æ€ä¹ˆäº†ï¼Ÿ</p><p>ä»¥å‰ä¸æ˜¯å¯ä»¥ç”¨å¼€å‘ç‰ˆå—ç°åœ¨ä¸å¯ä»¥ï¼</p><p>å•Šï¼Ÿ</p><p>ä½ ç”³è¯·å°ç±³è¿™ä¸ªç¤¾åŒº3.0å¤šä¹…äº†ï¼Ÿ</p><p>æœ‰ä¸€ä¸ªæœˆäº†å§ï¼Ÿ</p><p>ä¸€ä¸ªæœˆäº†ç°åœ¨æ‰å¼€å§‹ï¼</p><p>ä½ æ²¡æœ‰å®Œæˆè¿™ä¸ªæœˆçš„ä»»åŠ¡ï¼</p><p>æ‰€ä»¥æˆ‘è¦æŠŠä½ å†…æµ‹å–æ¶ˆäº†ï¼</p><p>æˆ‘è¿˜è¦æ‰£ä½ çš„åˆ†ï¼</p><p>è®©ä½ æ²¡æ³•å†ç»§ç»­ç”³è¯·ï¼</p><p>ä½ æ˜¯å‚»çš„å—ï¼Ÿ</p><p>ä¸€å †äººåˆ·å¼€å‘ç‰ˆå°±æ˜¯ä¸ºäº†å…»è€ï¼</p><p>è°æ¥å…‰é¡¾ä½ è¿™é¬¼ä¸œè¥¿å•Šï¼</p><p>ä»€ä¹ˆä¸œè¥¿éƒ½ï¼Œä»€ä¹ˆä¸œè¥¿éƒ½å¾€å…¬æµ‹é‡Œé¢åŠ ï¼</p><p>ä»€ä¹ˆä¸œè¥¿éƒ½å¾€å†…æµ‹é‡Œé¢åŠ ï¼</p><p>ä½ çœ‹çœ‹è¿™äº›ææ¡ˆï¼</p><p>å»ºè®®ä¸­å¿ƒã€åé¦ˆä¸­å¿ƒéƒ½æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Ÿ</p><p>è¶…çº§å£çº¸æ¯å±æ˜¾ç¤ºï¼Œæ”¯æŒæ˜¾ç¤ºæ­¥æ•°ä¿¡æ¯ï¼</p><p>æˆ‘è¦è¿™ä¸ªä¸œè¥¿æ¥å¹²ä»€ä¹ˆï¼</p><p>æˆ‘ä»–å¦ˆä¸€ä¸ªåå°ä¸€å›å·¦é£ä¸€å›å³é£ï¼</p><p>æˆ‘è¦ä½ ä¸€ä¸ªè¶…çº§å£çº¸å§“åï¼</p><p>æ”¯æŒæ˜¾ç¤ºæ­¥æ•°å¹²ä»€ä¹ˆï¼Ÿ</p><p>å•Šï¼Ÿ</p><p>è¿˜æœ‰è¿™ä¸ªå¢åŠ 90Hzåˆ·æ–°ç‡ï¼</p><p>æˆ‘ç”¨10Ultraæˆ‘å°±å–œæ¬¢122Hzï¼</p><p>ä½ å–œæ¬¢90Hz</p><p>ä½ è‡ªå·±éƒ½æ˜¯å¼€å‘ç‰ˆçš„</p><p>ä½ ä¸ºä»€ä¹ˆä¸æ•¢Rootï¼Ÿ</p><p>åˆ·ä¸€ä¸ªé¢å…·è¿›å»ä¸å°±èƒ½90HzçŸ¥é“å—ï¼Ÿ</p><p>è¿˜æœ‰è¿™ä¸ªå†…å­˜èåˆæŠ€æœ¯å¥½ï¼</p><p>è¿™ä¸ªæ˜¯å¾ˆå¥½ç”¨ï¼</p><p>ä½ çœ‹çœ‹éš”å£iQOOä»€ä¹ˆçš„ï¼Œ</p><p>ä»–å†…å­˜èåˆæ˜¯ä»€ä¹ˆå¯ä»¥è°ƒçš„ï¼</p><p>ä½ ç»™çš„æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>å¼„çš„æ—¶å€™ä½ å°±ç»™2Gï¼</p><p>ä¸¤ä¸ªGçš„å†…å­˜èåˆï¼</p><p>æˆ‘è§‰å¾—ä½ å°±ç»™ä¸‰ä¸ªGï¼</p><p>æ•¢æƒ…ä½ 8+3=11æ˜¯å—?</p><p>11Gå†…å­˜æ‰“å¾—è¿‡å…¶ä»–äººæ˜¯å—?</p><p>åšåˆåšä¸å®Œ,å°±æä¾›ä¸€ä¸ªå¼€å…³!</p><p>è¿˜ä¸ç»™ç”¨æˆ·é€‰æ‹©.</p><p>æˆ‘æœäº†!</p><p>ä½ çœ‹çœ‹è¿™äº›é¢˜æ¡ˆéƒ½æ˜¯ä»€ä¹ˆé¬¼ä¸œè¥¿?</p><p>ç›¸æœºæ”¯æŒè‡ªåŠ¨æ£€æµ‹å¹¶æ‰“å¼€å¾®è·æ¨¡å¼</p><p>æˆ‘çœŸçš„çƒ¦æ­»å°ç±³10Ultraè¿™ä¸ªå¾®è·æ¨¡å¼äº†ï¼</p><p>æˆ‘ä»–å¦ˆï¼å¯¹å‡†15å˜ç±³çš„æ—¶å€™èƒ½æ‰“å¼€å¾®è·æ¨¡å¼ï¼</p><p>é‚£ä¸ªç…§ç‰‡ç³Šçš„åƒä¸€å¨å±ä¸€æ ·ï¼</p><p>å®ƒè¿˜å¥½æ„æ€è°ƒå‡ºæ¥å¾®è·æ¨¡å¼ï¼</p><p>å¥½æ„æ€å—ï¼Ÿ</p><p>ä¸æ˜¯æˆ‘è¯´ï¼Œæˆ‘å¿è¿™ä¸ªMIUIå¾ˆä¹…äº†å¥½å—ï¼</p><p>ä½ å¡ã€å¡ã€å¡ä½ åƒåœ¾ï¼åƒåœ¾ï¼</p><p>æˆ‘é»˜é»˜çš„åœ¨æ”¯æŒä½ ï¼Œæˆ‘ä¸ç¦»ä¸å¼ƒã€‚</p><p>å¥½å—ï¼Ÿä½ ï¼Œä½ å¤§å®¶å¯¹ä½ ï¼Œä½ ç”¨åƒåœ¾ï¼</p><p>ä½ ç”¨è¿™ä¸ªç³»ç»Ÿåƒåœ¾ï¼Œå£å‡ºç¬”é˜€çš„æ—¶å€™</p><p>è¡Œï¼Œæˆ‘æ”¯æŒä½ ã€‚</p><p>æˆ‘è§‰å¾—ä½ ä¼šæ”¹ï¼Œ</p><p>æˆ‘ç»§ç»­æ”¯æŒä¸€ä¸‹ä½ çš„æ——èˆ°10Ultraï¼</p><p>å¥½ï¼Œç„¶åæˆ‘ä¹°çš„10Ultraæ˜¯æ€ä¹ˆæ ·å‘¢ï¼Ÿ</p><p>æ‹ç…§5ç§’ä¸€å¡ï¼</p><p>å¤œæ™¯æ¨¡å¼åœ¨é‚£é‡Œè½¬åœˆåœˆè½¬äº†ä¸€åˆ†é’Ÿï¼</p><p>ä¸€å¼ ç…§ç‰‡éƒ½æ²¡ä¿å­˜ä¸‹æ¥ï¼</p><p>æ‹ç…§8K,</p><p>äº”åˆ†é’Ÿå®ƒå°±å‘çƒ­ç»™æˆ‘å¼„æ²¡äº†ï¼</p><p>æˆ‘è§†é¢‘å‘¢ï¼Ÿ</p><p>åˆ«äººçš„888æ€ä¹ˆä¸ä¼šè¿™æ ·ï¼Ÿ</p><p>ä½ çš„888å°±ä¼šè¿™æ ·ï¼</p><p>éš¾æ€ªä½ å‘ä¸€ä¸ªä»€ä¹ˆé»‘é²¨2Pro</p><p>ä¸–ç•Œç¬¬ä¸€çš„æ•£çƒ­èƒŒå¤¹ï¼</p><p>ä½ è‡ªå·±æ‹8Kè§†é¢‘5åˆ†é’Ÿå°±æ²¡äº†ï¼</p><p>ä½ è¦ä¸ªæ•£çƒ­èƒŒå¤¹</p><p>éš¾é“ä½ æ‹è§†é¢‘çš„æ—¶å€™è¿˜è¦åé¢ç²˜ä¸ªæ•£çƒ­èƒŒå¤¹å—ï¼Ÿ</p><p>æˆ‘è·Ÿä½ è¯´çš„å»ºè®®ä¸­å¿ƒç«‹æ¡ˆçš„1ä¸‡å¤šæ¡ç«‹é¡¹ï¼Œ</p><p>èƒ½æœ‰1,000å¤šæ¡æ˜¯ç”¨äºè¿™ä¸ªç³»ç»Ÿbugçš„</p><p>æˆ‘éƒ½ç»™ä½ ä»Šæ™šç£•ä¸ªå¤´ï¼</p><p>æˆ‘è·Ÿä½ è¯´é‡‘å‡¡ï¼</p><p>è¿™æ˜¯åœ¨ä½ ç”¨12.5ä¸Šé¢è¯´çš„é‚£ä¸ªä»€ä¹ˆå•Šï¼</p><p>æˆ‘ä»¬ç»™ä¼˜å…ˆï¼Œä¼˜å…ˆç»™åº”ç”¨æœºåˆ¶ï¼</p><p>ä½ ç”¨9ä¸æ˜¯æ—©å°±ç”¨äº†å—ï¼Ÿå•Šï¼</p><p>æˆ‘çœŸçš„æ˜¯æœäº†æˆ‘ï¼</p><p>çœŸçš„æˆ‘å¾ˆç”Ÿæ°”éå¸¸ç”Ÿæ°”ï¼</p><p>é‚£å°ç±³å°±æ˜¯ä¸ªåƒåœ¾ï¼</p><p>æˆ‘çœ‹ä»Šå¤©è°æ•¢ä¹°å°ç±³ï¼ˆå¥‡è¿¹ï¼‰æ——èˆ°ï¼ ä½œè€…ï¼šæˆ‘è§‰å½³ãµå½³äº <a href="https://www.bilibili.com/read/cv12777949" target="_blank" rel="noopener">https://www.bilibili.com/read/cv12777949</a> å‡ºå¤„ï¼šbilibili</p><p>æœ‰å…³è§†é¢‘è¯·çœ‹ï¼š<a href="https://www.bilibili.com/video/BV1kU4y1E7y4/?spm_id_from=autoNext" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1kU4y1E7y4/?spm_id_from=autoNext</a></p>]]></content>
      
      
      <categories>
          
          <category> äº’è”ç½‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å°ç±³ </tag>
            
            <tag> äº’è”ç½‘ </tag>
            
            <tag> æ‰‹æœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Pandas</title>
      <link href="/2021/09/11/pandas/"/>
      <url>/2021/09/11/pandas/</url>
      
        <content type="html"><![CDATA[<p>pandasæ˜¯æœ¬ä¹¦åç»­å†…å®¹çš„é¦–é€‰åº“ã€‚å®ƒå«æœ‰ä½¿æ•°æ®æ¸…æ´—å’Œåˆ†æå·¥ä½œå˜å¾—æ›´å¿«æ›´ç®€å•çš„æ•°æ®ç»“æ„å’Œæ“ä½œå·¥å…·ã€‚pandasç»å¸¸å’Œå…¶å®ƒå·¥å…·ä¸€åŒä½¿ç”¨ï¼Œå¦‚æ•°å€¼è®¡ç®—å·¥å…·NumPyå’ŒSciPyï¼Œåˆ†æåº“statsmodelså’Œscikit-learnï¼Œå’Œæ•°æ®å¯è§†åŒ–åº“matplotlibã€‚pandasæ˜¯åŸºäºNumPyæ•°ç»„æ„å»ºçš„ï¼Œç‰¹åˆ«æ˜¯åŸºäºæ•°ç»„çš„å‡½æ•°å’Œä¸ä½¿ç”¨forå¾ªç¯çš„æ•°æ®å¤„ç†ã€‚</p><p>è™½ç„¶pandasé‡‡ç”¨äº†å¤§é‡çš„NumPyç¼–ç é£æ ¼ï¼Œä½†äºŒè€…æœ€å¤§çš„ä¸åŒæ˜¯pandasæ˜¯ä¸“é—¨ä¸ºå¤„ç†è¡¨æ ¼å’Œæ··æ‚æ•°æ®è®¾è®¡çš„ã€‚è€ŒNumPyæ›´é€‚åˆå¤„ç†ç»Ÿä¸€çš„æ•°å€¼æ•°ç»„æ•°æ®ã€‚</p><p>è‡ªä»2010å¹´pandaså¼€æºä»¥æ¥ï¼Œpandasé€æ¸æˆé•¿ä¸ºä¸€ä¸ªéå¸¸å¤§çš„åº“ï¼Œåº”ç”¨äºè®¸å¤šçœŸå®æ¡ˆä¾‹ã€‚å¼€å‘è€…ç¤¾åŒºå·²ç»æœ‰äº†800ä¸ªç‹¬ç«‹çš„è´¡çŒ®è€…ï¼Œä»–ä»¬åœ¨è§£å†³æ—¥å¸¸æ•°æ®é—®é¢˜çš„åŒæ—¶ä¸ºè¿™ä¸ªé¡¹ç›®æä¾›è´¡çŒ®ã€‚</p><p>åœ¨æœ¬ä¹¦åç»­éƒ¨åˆ†ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨ä¸‹é¢è¿™æ ·çš„pandaså¼•å…¥çº¦å®šï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å› æ­¤ï¼Œåªè¦ä½ åœ¨ä»£ç ä¸­çœ‹åˆ°pd.ï¼Œå°±å¾—æƒ³åˆ°è¿™æ˜¯pandasã€‚å› ä¸ºSerieså’ŒDataFrameç”¨çš„æ¬¡æ•°éå¸¸å¤šï¼Œæ‰€ä»¥å°†å…¶å¼•å…¥æœ¬åœ°å‘½åç©ºé—´ä¸­ä¼šæ›´æ–¹ä¾¿ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">from</span> pandas <span class="token keyword">import</span> Series<span class="token punctuation">,</span> DataFrame<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="5-1-pandasçš„æ•°æ®ç»“æ„ä»‹ç»"><a href="#5-1-pandasçš„æ•°æ®ç»“æ„ä»‹ç»" class="headerlink" title="5.1 pandasçš„æ•°æ®ç»“æ„ä»‹ç»"></a>5.1 pandasçš„æ•°æ®ç»“æ„ä»‹ç»</h1><p>è¦ä½¿ç”¨pandasï¼Œä½ é¦–å…ˆå°±å¾—ç†Ÿæ‚‰å®ƒçš„ä¸¤ä¸ªä¸»è¦æ•°æ®ç»“æ„ï¼šSerieså’ŒDataFrameã€‚è™½ç„¶å®ƒä»¬å¹¶ä¸èƒ½è§£å†³æ‰€æœ‰é—®é¢˜ï¼Œä½†å®ƒä»¬ä¸ºå¤§å¤šæ•°åº”ç”¨æä¾›äº†ä¸€ç§å¯é çš„ã€æ˜“äºä½¿ç”¨çš„åŸºç¡€ã€‚</p><h2 id="Series"><a href="#Series" class="headerlink" title="Series"></a>Series</h2><p>Seriesæ˜¯ä¸€ç§ç±»ä¼¼äºä¸€ç»´æ•°ç»„çš„å¯¹è±¡ï¼Œå®ƒç”±ä¸€ç»„æ•°æ®ï¼ˆå„ç§NumPyæ•°æ®ç±»å‹ï¼‰ä»¥åŠä¸€ç»„ä¸ä¹‹ç›¸å…³çš„æ•°æ®æ ‡ç­¾ï¼ˆå³ç´¢å¼•ï¼‰ç»„æˆã€‚ä»…ç”±ä¸€ç»„æ•°æ®å³å¯äº§ç”Ÿæœ€ç®€å•çš„Seriesï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">:</span> objOut<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">0</span>    <span class="token number">4</span><span class="token number">1</span>    <span class="token number">7</span><span class="token number">2</span>   <span class="token operator">-</span><span class="token number">5</span><span class="token number">3</span>    <span class="token number">3</span>dtype<span class="token punctuation">:</span> int64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Seriesçš„å­—ç¬¦ä¸²è¡¨ç°å½¢å¼ä¸ºï¼šç´¢å¼•åœ¨å·¦è¾¹ï¼Œå€¼åœ¨å³è¾¹ã€‚ç”±äºæˆ‘ä»¬æ²¡æœ‰ä¸ºæ•°æ®æŒ‡å®šç´¢å¼•ï¼Œäºæ˜¯ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª0åˆ°N-1ï¼ˆNä¸ºæ•°æ®çš„é•¿åº¦ï¼‰çš„æ•´æ•°å‹ç´¢å¼•ã€‚ä½ å¯ä»¥é€šè¿‡Series çš„valueså’Œindexå±æ€§è·å–å…¶æ•°ç»„è¡¨ç¤ºå½¢å¼å’Œç´¢å¼•å¯¹è±¡ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj<span class="token punctuation">.</span>valuesOut<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj<span class="token punctuation">.</span>index  <span class="token comment" spellcheck="true"># like range(4)</span>Out<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">:</span> RangeIndex<span class="token punctuation">(</span>start<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> stop<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> step<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šå¸¸ï¼Œæˆ‘ä»¬å¸Œæœ›æ‰€åˆ›å»ºçš„Serieså¸¦æœ‰ä¸€ä¸ªå¯ä»¥å¯¹å„ä¸ªæ•°æ®ç‚¹è¿›è¡Œæ ‡è®°çš„ç´¢å¼•ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj2Out<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">:</span> d    <span class="token number">4</span>b    <span class="token number">7</span>a   <span class="token operator">-</span><span class="token number">5</span>c    <span class="token number">3</span>dtype<span class="token punctuation">:</span> int64In <span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj2<span class="token punctuation">.</span>indexOut<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">:</span> Index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'object'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸æ™®é€šNumPyæ•°ç»„ç›¸æ¯”ï¼Œä½ å¯ä»¥é€šè¿‡ç´¢å¼•çš„æ–¹å¼é€‰å–Seriesä¸­çš„å•ä¸ªæˆ–ä¸€ç»„å€¼ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj2<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">5</span>In <span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj2<span class="token punctuation">[</span><span class="token string">'d'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">6</span>In <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj2<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">:</span> c    <span class="token number">3</span>a   <span class="token operator">-</span><span class="token number">5</span>d    <span class="token number">6</span>dtype<span class="token punctuation">:</span> int64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>[â€˜câ€™, â€˜aâ€™, â€˜dâ€™]æ˜¯ç´¢å¼•åˆ—è¡¨ï¼Œå³ä½¿å®ƒåŒ…å«çš„æ˜¯å­—ç¬¦ä¸²è€Œä¸æ˜¯æ•´æ•°ã€‚</p><p>ä½¿ç”¨NumPyå‡½æ•°æˆ–ç±»ä¼¼NumPyçš„è¿ç®—ï¼ˆå¦‚æ ¹æ®å¸ƒå°”å‹æ•°ç»„è¿›è¡Œè¿‡æ»¤ã€æ ‡é‡ä¹˜æ³•ã€åº”ç”¨æ•°å­¦å‡½æ•°ç­‰ï¼‰éƒ½ä¼šä¿ç•™ç´¢å¼•å€¼çš„é“¾æ¥ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj2<span class="token punctuation">[</span>obj2 <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">:</span> d    <span class="token number">6</span>b    <span class="token number">7</span>c    <span class="token number">3</span>dtype<span class="token punctuation">:</span> int64In <span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj2 <span class="token operator">*</span> <span class="token number">2</span>Out<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">:</span>d    <span class="token number">12</span>b    <span class="token number">14</span>a   <span class="token operator">-</span><span class="token number">10</span>c     <span class="token number">6</span>dtype<span class="token punctuation">:</span> int64In <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>obj2<span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">:</span> d     <span class="token number">403.428793</span>b    <span class="token number">1096.633158</span>a       <span class="token number">0.006738</span>c      <span class="token number">20.085537</span>dtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿˜å¯ä»¥å°†Seriesçœ‹æˆæ˜¯ä¸€ä¸ªå®šé•¿çš„æœ‰åºå­—å…¸ï¼Œå› ä¸ºå®ƒæ˜¯ç´¢å¼•å€¼åˆ°æ•°æ®å€¼çš„ä¸€ä¸ªæ˜ å°„ã€‚å®ƒå¯ä»¥ç”¨åœ¨è®¸å¤šåŸæœ¬éœ€è¦å­—å…¸å‚æ•°çš„å‡½æ•°ä¸­ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'b'</span> <span class="token keyword">in</span> obj2Out<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token boolean">True</span>In <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'e'</span> <span class="token keyword">in</span> obj2Out<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœæ•°æ®è¢«å­˜æ”¾åœ¨ä¸€ä¸ªPythonå­—å…¸ä¸­ï¼Œä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡è¿™ä¸ªå­—å…¸æ¥åˆ›å»ºSeriesï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">:</span> sdata <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'Ohio'</span><span class="token punctuation">:</span> <span class="token number">35000</span><span class="token punctuation">,</span> <span class="token string">'Texas'</span><span class="token punctuation">:</span> <span class="token number">71000</span><span class="token punctuation">,</span> <span class="token string">'Oregon'</span><span class="token punctuation">:</span> <span class="token number">16000</span><span class="token punctuation">,</span> <span class="token string">'Utah'</span><span class="token punctuation">:</span> <span class="token number">5000</span><span class="token punctuation">}</span>In <span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj3 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>sdata<span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj3Out<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">:</span> Ohio      <span class="token number">35000</span>Oregon    <span class="token number">16000</span>Texas     <span class="token number">71000</span>Utah       <span class="token number">5000</span>dtype<span class="token punctuation">:</span> int64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœåªä¼ å…¥ä¸€ä¸ªå­—å…¸ï¼Œåˆ™ç»“æœSeriesä¸­çš„ç´¢å¼•å°±æ˜¯åŸå­—å…¸çš„é”®ï¼ˆæœ‰åºæ’åˆ—ï¼‰ã€‚ä½ å¯ä»¥ä¼ å…¥æ’å¥½åºçš„å­—å…¸çš„é”®ä»¥æ”¹å˜é¡ºåºï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token punctuation">:</span> states <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'California'</span><span class="token punctuation">,</span> <span class="token string">'Ohio'</span><span class="token punctuation">,</span> <span class="token string">'Oregon'</span><span class="token punctuation">,</span> <span class="token string">'Texas'</span><span class="token punctuation">]</span>In <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj4 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>sdata<span class="token punctuation">,</span> index<span class="token operator">=</span>states<span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj4Out<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">:</span> California        NaNOhio          <span class="token number">35000.0</span>Oregon        <span class="token number">16000.0</span>Texas         <span class="token number">71000.0</span>dtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œsdataä¸­è·Ÿstatesç´¢å¼•ç›¸åŒ¹é…çš„é‚£3ä¸ªå€¼ä¼šè¢«æ‰¾å‡ºæ¥å¹¶æ”¾åˆ°ç›¸åº”çš„ä½ç½®ä¸Šï¼Œä½†ç”±äºâ€Californiaâ€æ‰€å¯¹åº”çš„sdataå€¼æ‰¾ä¸åˆ°ï¼Œæ‰€ä»¥å…¶ç»“æœå°±ä¸ºNaNï¼ˆå³â€œéæ•°å­—â€ï¼ˆnot a numberï¼‰ï¼Œåœ¨pandasä¸­ï¼Œå®ƒç”¨äºè¡¨ç¤ºç¼ºå¤±æˆ–NAå€¼ï¼‰ã€‚å› ä¸ºâ€˜Utahâ€™ä¸åœ¨statesä¸­ï¼Œå®ƒè¢«ä»ç»“æœä¸­é™¤å»ã€‚</p><p>æˆ‘å°†ä½¿ç”¨ç¼ºå¤±ï¼ˆmissingï¼‰æˆ–NAè¡¨ç¤ºç¼ºå¤±æ•°æ®ã€‚pandasçš„isnullå’Œnotnullå‡½æ•°å¯ç”¨äºæ£€æµ‹ç¼ºå¤±æ•°æ®ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">:</span> pd<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span>obj4<span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">:</span> California     <span class="token boolean">True</span>Ohio          <span class="token boolean">False</span>Oregon        <span class="token boolean">False</span>Texas         <span class="token boolean">False</span>dtype<span class="token punctuation">:</span> boolIn <span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span><span class="token punctuation">:</span> pd<span class="token punctuation">.</span>notnull<span class="token punctuation">(</span>obj4<span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span><span class="token punctuation">:</span> California    <span class="token boolean">False</span>Ohio           <span class="token boolean">True</span>Oregon         <span class="token boolean">True</span>Texas          <span class="token boolean">True</span>dtype<span class="token punctuation">:</span> bool<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Seriesä¹Ÿæœ‰ç±»ä¼¼çš„å®ä¾‹æ–¹æ³•ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj4<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">:</span> California     <span class="token boolean">True</span>Ohio          <span class="token boolean">False</span>Oregon        <span class="token boolean">False</span>Texas         <span class="token boolean">False</span>dtype<span class="token punctuation">:</span> bool<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘å°†åœ¨ç¬¬7ç« è¯¦ç»†è®²è§£å¦‚ä½•å¤„ç†ç¼ºå¤±æ•°æ®ã€‚</p><p>å¯¹äºè®¸å¤šåº”ç”¨è€Œè¨€ï¼ŒSeriesæœ€é‡è¦çš„ä¸€ä¸ªåŠŸèƒ½æ˜¯ï¼Œå®ƒä¼šæ ¹æ®è¿ç®—çš„ç´¢å¼•æ ‡ç­¾è‡ªåŠ¨å¯¹é½æ•°æ®ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj3Out<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">:</span> Ohio      <span class="token number">35000</span>Oregon    <span class="token number">16000</span>Texas     <span class="token number">71000</span>Utah       <span class="token number">5000</span>dtype<span class="token punctuation">:</span> int64In <span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj4Out<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">:</span> California        NaNOhio          <span class="token number">35000.0</span>Oregon        <span class="token number">16000.0</span>Texas         <span class="token number">71000.0</span>dtype<span class="token punctuation">:</span> float64In <span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj3 <span class="token operator">+</span> obj4Out<span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span><span class="token punctuation">:</span> California         NaNOhio           <span class="token number">70000.0</span>Oregon         <span class="token number">32000.0</span>Texas         <span class="token number">142000.0</span>Utah               NaNdtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ•°æ®å¯¹é½åŠŸèƒ½å°†åœ¨åé¢è¯¦ç»†è®²è§£ã€‚å¦‚æœä½ ä½¿ç”¨è¿‡æ•°æ®åº“ï¼Œä½ å¯ä»¥è®¤ä¸ºæ˜¯ç±»ä¼¼joinçš„æ“ä½œã€‚</p><p>Serieså¯¹è±¡æœ¬èº«åŠå…¶ç´¢å¼•éƒ½æœ‰ä¸€ä¸ªnameå±æ€§ï¼Œè¯¥å±æ€§è·Ÿpandaså…¶ä»–çš„å…³é”®åŠŸèƒ½å…³ç³»éå¸¸å¯†åˆ‡ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj4<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'population'</span>In <span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj4<span class="token punctuation">.</span>index<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'state'</span>In <span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj4Out<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">:</span> stateCalifornia        NaNOhio          <span class="token number">35000.0</span>Oregon        <span class="token number">16000.0</span>Texas         <span class="token number">71000.0</span>Name<span class="token punctuation">:</span> population<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Seriesçš„ç´¢å¼•å¯ä»¥é€šè¿‡èµ‹å€¼çš„æ–¹å¼å°±åœ°ä¿®æ”¹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">:</span> objOut<span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">0</span>    <span class="token number">4</span><span class="token number">1</span>    <span class="token number">7</span><span class="token number">2</span>   <span class="token operator">-</span><span class="token number">5</span><span class="token number">3</span>    <span class="token number">3</span>dtype<span class="token punctuation">:</span> int64In <span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj<span class="token punctuation">.</span>index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token string">'Steve'</span><span class="token punctuation">,</span> <span class="token string">'Jeff'</span><span class="token punctuation">,</span> <span class="token string">'Ryan'</span><span class="token punctuation">]</span>In <span class="token punctuation">[</span><span class="token number">43</span><span class="token punctuation">]</span><span class="token punctuation">:</span> objOut<span class="token punctuation">[</span><span class="token number">43</span><span class="token punctuation">]</span><span class="token punctuation">:</span> Bob      <span class="token number">4</span>Steve    <span class="token number">7</span>Jeff    <span class="token operator">-</span><span class="token number">5</span>Ryan     <span class="token number">3</span>dtype<span class="token punctuation">:</span> int64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="DataFrame"><a href="#DataFrame" class="headerlink" title="DataFrame"></a>DataFrame</h2><p>DataFrameæ˜¯ä¸€ä¸ªè¡¨æ ¼å‹çš„æ•°æ®ç»“æ„ï¼Œå®ƒå«æœ‰ä¸€ç»„æœ‰åºçš„åˆ—ï¼Œæ¯åˆ—å¯ä»¥æ˜¯ä¸åŒçš„å€¼ç±»å‹ï¼ˆæ•°å€¼ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ç­‰ï¼‰ã€‚DataFrameæ—¢æœ‰è¡Œç´¢å¼•ä¹Ÿæœ‰åˆ—ç´¢å¼•ï¼Œå®ƒå¯ä»¥è¢«çœ‹åšç”±Seriesç»„æˆçš„å­—å…¸ï¼ˆå…±ç”¨åŒä¸€ä¸ªç´¢å¼•ï¼‰ã€‚DataFrameä¸­çš„æ•°æ®æ˜¯ä»¥ä¸€ä¸ªæˆ–å¤šä¸ªäºŒç»´å—å­˜æ”¾çš„ï¼ˆè€Œä¸æ˜¯åˆ—è¡¨ã€å­—å…¸æˆ–åˆ«çš„ä¸€ç»´æ•°æ®ç»“æ„ï¼‰ã€‚æœ‰å…³DataFrameå†…éƒ¨çš„æŠ€æœ¯ç»†èŠ‚è¿œè¿œè¶…å‡ºäº†æœ¬ä¹¦æ‰€è®¨è®ºçš„èŒƒå›´ã€‚</p><blockquote><p>ç¬”è®°ï¼šè™½ç„¶DataFrameæ˜¯ä»¥äºŒç»´ç»“æ„ä¿å­˜æ•°æ®çš„ï¼Œä½†ä½ ä»ç„¶å¯ä»¥è½»æ¾åœ°å°†å…¶è¡¨ç¤ºä¸ºæ›´é«˜ç»´åº¦çš„æ•°æ®ï¼ˆå±‚æ¬¡åŒ–ç´¢å¼•çš„è¡¨æ ¼å‹ç»“æ„ï¼Œè¿™æ˜¯pandasä¸­è®¸å¤šé«˜çº§æ•°æ®å¤„ç†åŠŸèƒ½çš„å…³é”®è¦ç´ ï¼Œæˆ‘ä»¬ä¼šåœ¨ç¬¬8ç« è®¨è®ºè¿™ä¸ªé—®é¢˜ï¼‰ã€‚</p></blockquote><p>å»ºDataFrameçš„åŠæ³•æœ‰å¾ˆå¤šï¼Œæœ€å¸¸ç”¨çš„ä¸€ç§æ˜¯ç›´æ¥ä¼ å…¥ä¸€ä¸ªç”±ç­‰é•¿åˆ—è¡¨æˆ–NumPyæ•°ç»„ç»„æˆçš„å­—å…¸ï¼š</p><pre class="line-numbers language-python"><code class="language-python">data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'state'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Ohio'</span><span class="token punctuation">,</span> <span class="token string">'Ohio'</span><span class="token punctuation">,</span> <span class="token string">'Ohio'</span><span class="token punctuation">,</span> <span class="token string">'Nevada'</span><span class="token punctuation">,</span> <span class="token string">'Nevada'</span><span class="token punctuation">,</span> <span class="token string">'Nevada'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token string">'year'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">2000</span><span class="token punctuation">,</span> <span class="token number">2001</span><span class="token punctuation">,</span> <span class="token number">2002</span><span class="token punctuation">,</span> <span class="token number">2001</span><span class="token punctuation">,</span> <span class="token number">2002</span><span class="token punctuation">,</span> <span class="token number">2003</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token string">'pop'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token number">1.7</span><span class="token punctuation">,</span> <span class="token number">3.6</span><span class="token punctuation">,</span> <span class="token number">2.4</span><span class="token punctuation">,</span> <span class="token number">2.9</span><span class="token punctuation">,</span> <span class="token number">3.2</span><span class="token punctuation">]</span><span class="token punctuation">}</span>frame <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ç»“æœDataFrameä¼šè‡ªåŠ¨åŠ ä¸Šç´¢å¼•ï¼ˆè·ŸSeriesä¸€æ ·ï¼‰ï¼Œä¸”å…¨éƒ¨åˆ—ä¼šè¢«æœ‰åºæ’åˆ—ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">45</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frameOut<span class="token punctuation">[</span><span class="token number">45</span><span class="token punctuation">]</span><span class="token punctuation">:</span>    pop   state  year<span class="token number">0</span>  <span class="token number">1.5</span>    Ohio  <span class="token number">2000</span><span class="token number">1</span>  <span class="token number">1.7</span>    Ohio  <span class="token number">2001</span><span class="token number">2</span>  <span class="token number">3.6</span>    Ohio  <span class="token number">2002</span><span class="token number">3</span>  <span class="token number">2.4</span>  Nevada  <span class="token number">2001</span><span class="token number">4</span>  <span class="token number">2.9</span>  Nevada  <span class="token number">2002</span><span class="token number">5</span>  <span class="token number">3.2</span>  Nevada  <span class="token number">2003</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯Jupyter notebookï¼Œpandas DataFrameå¯¹è±¡ä¼šä»¥å¯¹æµè§ˆå™¨å‹å¥½çš„HTMLè¡¨æ ¼çš„æ–¹å¼å‘ˆç°ã€‚</p><p>å¯¹äºç‰¹åˆ«å¤§çš„DataFrameï¼Œheadæ–¹æ³•ä¼šé€‰å–å‰äº”è¡Œï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">46</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">46</span><span class="token punctuation">]</span><span class="token punctuation">:</span>    pop   state  year<span class="token number">0</span>  <span class="token number">1.5</span>    Ohio  <span class="token number">2000</span><span class="token number">1</span>  <span class="token number">1.7</span>    Ohio  <span class="token number">2001</span><span class="token number">2</span>  <span class="token number">3.6</span>    Ohio  <span class="token number">2002</span><span class="token number">3</span>  <span class="token number">2.4</span>  Nevada  <span class="token number">2001</span><span class="token number">4</span>  <span class="token number">2.9</span>  Nevada  <span class="token number">2002</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœæŒ‡å®šäº†åˆ—åºåˆ—ï¼Œåˆ™DataFrameçš„åˆ—å°±ä¼šæŒ‰ç…§æŒ‡å®šé¡ºåºè¿›è¡Œæ’åˆ—ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">47</span><span class="token punctuation">]</span><span class="token punctuation">:</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'year'</span><span class="token punctuation">,</span> <span class="token string">'state'</span><span class="token punctuation">,</span> <span class="token string">'pop'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">47</span><span class="token punctuation">]</span><span class="token punctuation">:</span>    year   state  pop<span class="token number">0</span>  <span class="token number">2000</span>    Ohio  <span class="token number">1.5</span><span class="token number">1</span>  <span class="token number">2001</span>    Ohio  <span class="token number">1.7</span><span class="token number">2</span>  <span class="token number">2002</span>    Ohio  <span class="token number">3.6</span><span class="token number">3</span>  <span class="token number">2001</span>  Nevada  <span class="token number">2.4</span><span class="token number">4</span>  <span class="token number">2002</span>  Nevada  <span class="token number">2.9</span><span class="token number">5</span>  <span class="token number">2003</span>  Nevada  <span class="token number">3.2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœä¼ å…¥çš„åˆ—åœ¨æ•°æ®ä¸­æ‰¾ä¸åˆ°ï¼Œå°±ä¼šåœ¨ç»“æœä¸­äº§ç”Ÿç¼ºå¤±å€¼ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'year'</span><span class="token punctuation">,</span> <span class="token string">'state'</span><span class="token punctuation">,</span> <span class="token string">'pop'</span><span class="token punctuation">,</span> <span class="token string">'debt'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>                       index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'three'</span><span class="token punctuation">,</span> <span class="token string">'four'</span><span class="token punctuation">,</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>                              <span class="token string">'five'</span><span class="token punctuation">,</span> <span class="token string">'six'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">49</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame2Out<span class="token punctuation">[</span><span class="token number">49</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        year   state  pop debtone    <span class="token number">2000</span>    Ohio  <span class="token number">1.5</span>  NaNtwo    <span class="token number">2001</span>    Ohio  <span class="token number">1.7</span>  NaNthree  <span class="token number">2002</span>    Ohio  <span class="token number">3.6</span>  NaNfour   <span class="token number">2001</span>  Nevada  <span class="token number">2.4</span>  NaNfive   <span class="token number">2002</span>  Nevada  <span class="token number">2.9</span>  NaNsix    <span class="token number">2003</span>  Nevada  <span class="token number">3.2</span>  NaNIn <span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame2<span class="token punctuation">.</span>columnsOut<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">:</span> Index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'year'</span><span class="token punctuation">,</span> <span class="token string">'state'</span><span class="token punctuation">,</span> <span class="token string">'pop'</span><span class="token punctuation">,</span> <span class="token string">'debt'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'object'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡ç±»ä¼¼å­—å…¸æ ‡è®°çš„æ–¹å¼æˆ–å±æ€§çš„æ–¹å¼ï¼Œå¯ä»¥å°†DataFrameçš„åˆ—è·å–ä¸ºä¸€ä¸ªSeriesï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">51</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame2<span class="token punctuation">[</span><span class="token string">'state'</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">51</span><span class="token punctuation">]</span><span class="token punctuation">:</span> one        Ohiotwo        Ohiothree      Ohiofour     Nevadafive     Nevadasix      NevadaName<span class="token punctuation">:</span> state<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> objectIn <span class="token punctuation">[</span><span class="token number">52</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame2<span class="token punctuation">.</span>yearOut<span class="token punctuation">[</span><span class="token number">52</span><span class="token punctuation">]</span><span class="token punctuation">:</span> one      <span class="token number">2000</span>two      <span class="token number">2001</span>three    <span class="token number">2002</span>four     <span class="token number">2001</span>five     <span class="token number">2002</span>six      <span class="token number">2003</span>Name<span class="token punctuation">:</span> year<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> int64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>ç¬”è®°ï¼šIPythonæä¾›äº†ç±»ä¼¼å±æ€§çš„è®¿é—®ï¼ˆå³frame2.yearï¼‰å’Œtabè¡¥å…¨ã€‚<br>frame2[column]é€‚ç”¨äºä»»ä½•åˆ—çš„åï¼Œä½†æ˜¯frame2.columnåªæœ‰åœ¨åˆ—åæ˜¯ä¸€ä¸ªåˆç†çš„Pythonå˜é‡åæ—¶æ‰é€‚ç”¨ã€‚</p></blockquote><p>æ³¨æ„ï¼Œè¿”å›çš„Seriesæ‹¥æœ‰åŸDataFrameç›¸åŒçš„ç´¢å¼•ï¼Œä¸”å…¶nameå±æ€§ä¹Ÿå·²ç»è¢«ç›¸åº”åœ°è®¾ç½®å¥½äº†ã€‚</p><p>è¡Œä¹Ÿå¯ä»¥é€šè¿‡ä½ç½®æˆ–åç§°çš„æ–¹å¼è¿›è¡Œè·å–ï¼Œæ¯”å¦‚ç”¨locå±æ€§ï¼ˆç¨åå°†å¯¹æ­¤è¿›è¡Œè¯¦ç»†è®²è§£ï¼‰ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame2<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'three'</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">]</span><span class="token punctuation">:</span> year     <span class="token number">2002</span>state    Ohiopop       <span class="token number">3.6</span>debt      NaNName<span class="token punctuation">:</span> three<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> object<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ—å¯ä»¥é€šè¿‡èµ‹å€¼çš„æ–¹å¼è¿›è¡Œä¿®æ”¹ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ç»™é‚£ä¸ªç©ºçš„â€debtâ€åˆ—èµ‹ä¸Šä¸€ä¸ªæ ‡é‡å€¼æˆ–ä¸€ç»„å€¼ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">54</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame2<span class="token punctuation">[</span><span class="token string">'debt'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">16.5</span>In <span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame2Out<span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        year   state  pop  debtone    <span class="token number">2000</span>    Ohio  <span class="token number">1.5</span>  <span class="token number">16.5</span>two    <span class="token number">2001</span>    Ohio  <span class="token number">1.7</span>  <span class="token number">16.5</span>three  <span class="token number">2002</span>    Ohio  <span class="token number">3.6</span>  <span class="token number">16.5</span>four   <span class="token number">2001</span>  Nevada  <span class="token number">2.4</span>  <span class="token number">16.5</span>five   <span class="token number">2002</span>  Nevada  <span class="token number">2.9</span>  <span class="token number">16.5</span>six    <span class="token number">2003</span>  Nevada  <span class="token number">3.2</span>  <span class="token number">16.5</span>In <span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame2<span class="token punctuation">[</span><span class="token string">'debt'</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">.</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">57</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame2Out<span class="token punctuation">[</span><span class="token number">57</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        year   state  pop  debtone    <span class="token number">2000</span>    Ohio  <span class="token number">1.5</span>   <span class="token number">0.0</span>two    <span class="token number">2001</span>    Ohio  <span class="token number">1.7</span>   <span class="token number">1.0</span>three  <span class="token number">2002</span>    Ohio  <span class="token number">3.6</span>   <span class="token number">2.0</span>four   <span class="token number">2001</span>  Nevada  <span class="token number">2.4</span>   <span class="token number">3.0</span>five   <span class="token number">2002</span>  Nevada  <span class="token number">2.9</span>   <span class="token number">4.0</span>six    <span class="token number">2003</span>  Nevada  <span class="token number">3.2</span>   <span class="token number">5.0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°†åˆ—è¡¨æˆ–æ•°ç»„èµ‹å€¼ç»™æŸä¸ªåˆ—æ—¶ï¼Œå…¶é•¿åº¦å¿…é¡»è·ŸDataFrameçš„é•¿åº¦ç›¸åŒ¹é…ã€‚å¦‚æœèµ‹å€¼çš„æ˜¯ä¸€ä¸ªSeriesï¼Œå°±ä¼šç²¾ç¡®åŒ¹é…DataFrameçš„ç´¢å¼•ï¼Œæ‰€æœ‰çš„ç©ºä½éƒ½å°†è¢«å¡«ä¸Šç¼ºå¤±å€¼ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">58</span><span class="token punctuation">]</span><span class="token punctuation">:</span> val <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1.2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'four'</span><span class="token punctuation">,</span> <span class="token string">'five'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame2<span class="token punctuation">[</span><span class="token string">'debt'</span><span class="token punctuation">]</span> <span class="token operator">=</span> valIn <span class="token punctuation">[</span><span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame2Out<span class="token punctuation">[</span><span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        year   state  pop  debtone    <span class="token number">2000</span>    Ohio  <span class="token number">1.5</span>   NaNtwo    <span class="token number">2001</span>    Ohio  <span class="token number">1.7</span>  <span class="token operator">-</span><span class="token number">1.2</span>three  <span class="token number">2002</span>    Ohio  <span class="token number">3.6</span>   NaNfour   <span class="token number">2001</span>  Nevada  <span class="token number">2.4</span>  <span class="token operator">-</span><span class="token number">1.5</span>five   <span class="token number">2002</span>  Nevada  <span class="token number">2.9</span>  <span class="token operator">-</span><span class="token number">1.7</span>six    <span class="token number">2003</span>  Nevada  <span class="token number">3.2</span>   NaN<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸ºä¸å­˜åœ¨çš„åˆ—èµ‹å€¼ä¼šåˆ›å»ºå‡ºä¸€ä¸ªæ–°åˆ—ã€‚å…³é”®å­—delç”¨äºåˆ é™¤åˆ—ã€‚</p><p>ä½œä¸ºdelçš„ä¾‹å­ï¼Œæˆ‘å…ˆæ·»åŠ ä¸€ä¸ªæ–°çš„å¸ƒå°”å€¼çš„åˆ—ï¼Œstateæ˜¯å¦ä¸ºâ€™Ohioâ€™ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">61</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame2<span class="token punctuation">[</span><span class="token string">'eastern'</span><span class="token punctuation">]</span> <span class="token operator">=</span> frame2<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token string">'Ohio'</span>In <span class="token punctuation">[</span><span class="token number">62</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame2Out<span class="token punctuation">[</span><span class="token number">62</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        year   state  pop  debt  easternone    <span class="token number">2000</span>    Ohio  <span class="token number">1.5</span>   NaN     <span class="token boolean">True</span>two    <span class="token number">2001</span>    Ohio  <span class="token number">1.7</span>  <span class="token operator">-</span><span class="token number">1.2</span>     <span class="token boolean">True</span>three  <span class="token number">2002</span>    Ohio  <span class="token number">3.6</span>   NaN     <span class="token boolean">True</span>four   <span class="token number">2001</span>  Nevada  <span class="token number">2.4</span>  <span class="token operator">-</span><span class="token number">1.5</span>    <span class="token boolean">False</span>five   <span class="token number">2002</span>  Nevada  <span class="token number">2.9</span>  <span class="token operator">-</span><span class="token number">1.7</span>    <span class="token boolean">False</span>six    <span class="token number">2003</span>  Nevada  <span class="token number">3.2</span>   NaN    <span class="token boolean">False</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æ³¨æ„ï¼šä¸èƒ½ç”¨frame2.easternåˆ›å»ºæ–°çš„åˆ—ã€‚</p></blockquote><p>delæ–¹æ³•å¯ä»¥ç”¨æ¥åˆ é™¤è¿™åˆ—ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">del</span> frame2<span class="token punctuation">[</span><span class="token string">'eastern'</span><span class="token punctuation">]</span>In <span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame2<span class="token punctuation">.</span>columnsOut<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">:</span> Index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'year'</span><span class="token punctuation">,</span> <span class="token string">'state'</span><span class="token punctuation">,</span> <span class="token string">'pop'</span><span class="token punctuation">,</span> <span class="token string">'debt'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'object'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æ³¨æ„ï¼šé€šè¿‡ç´¢å¼•æ–¹å¼è¿”å›çš„åˆ—åªæ˜¯ç›¸åº”æ•°æ®çš„è§†å›¾è€Œå·²ï¼Œå¹¶ä¸æ˜¯å‰¯æœ¬ã€‚å› æ­¤ï¼Œå¯¹è¿”å›çš„Seriesæ‰€åšçš„ä»»ä½•å°±åœ°ä¿®æ”¹å…¨éƒ½ä¼šåæ˜ åˆ°æºDataFrameä¸Šã€‚é€šè¿‡Seriesçš„copyæ–¹æ³•å³å¯æŒ‡å®šå¤åˆ¶åˆ—ã€‚</p></blockquote><p>å¦ä¸€ç§å¸¸è§çš„æ•°æ®å½¢å¼æ˜¯åµŒå¥—å­—å…¸ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">65</span><span class="token punctuation">]</span><span class="token punctuation">:</span> pop <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'Nevada'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token number">2001</span><span class="token punctuation">:</span> <span class="token number">2.4</span><span class="token punctuation">,</span> <span class="token number">2002</span><span class="token punctuation">:</span> <span class="token number">2.9</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>        <span class="token string">'Ohio'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token number">2000</span><span class="token punctuation">:</span> <span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token number">2001</span><span class="token punctuation">:</span> <span class="token number">1.7</span><span class="token punctuation">,</span> <span class="token number">2002</span><span class="token punctuation">:</span> <span class="token number">3.6</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¦‚æœåµŒå¥—å­—å…¸ä¼ ç»™DataFrameï¼Œpandaså°±ä¼šè¢«è§£é‡Šä¸ºï¼šå¤–å±‚å­—å…¸çš„é”®ä½œä¸ºåˆ—ï¼Œå†…å±‚é”®åˆ™ä½œä¸ºè¡Œç´¢å¼•ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">66</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame3 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>pop<span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">67</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame3Out<span class="token punctuation">[</span><span class="token number">67</span><span class="token punctuation">]</span><span class="token punctuation">:</span>       Nevada  Ohio<span class="token number">2000</span>     NaN   <span class="token number">1.5</span><span class="token number">2001</span>     <span class="token number">2.4</span>   <span class="token number">1.7</span><span class="token number">2002</span>     <span class="token number">2.9</span>   <span class="token number">3.6</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ç±»ä¼¼NumPyæ•°ç»„çš„æ–¹æ³•ï¼Œå¯¹DataFrameè¿›è¡Œè½¬ç½®ï¼ˆäº¤æ¢è¡Œå’Œåˆ—ï¼‰ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">68</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame3<span class="token punctuation">.</span>TOut<span class="token punctuation">[</span><span class="token number">68</span><span class="token punctuation">]</span><span class="token punctuation">:</span>         <span class="token number">2000</span>  <span class="token number">2001</span>  <span class="token number">2002</span>Nevada   NaN   <span class="token number">2.4</span>   <span class="token number">2.9</span>Ohio     <span class="token number">1.5</span>   <span class="token number">1.7</span>   <span class="token number">3.6</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å†…å±‚å­—å…¸çš„é”®ä¼šè¢«åˆå¹¶ã€æ’åºä»¥å½¢æˆæœ€ç»ˆçš„ç´¢å¼•ã€‚å¦‚æœæ˜ç¡®æŒ‡å®šäº†ç´¢å¼•ï¼Œåˆ™ä¸ä¼šè¿™æ ·ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">69</span><span class="token punctuation">]</span><span class="token punctuation">:</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>pop<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">2001</span><span class="token punctuation">,</span> <span class="token number">2002</span><span class="token punctuation">,</span> <span class="token number">2003</span><span class="token punctuation">]</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">69</span><span class="token punctuation">]</span><span class="token punctuation">:</span>       Nevada  Ohio<span class="token number">2001</span>     <span class="token number">2.4</span>   <span class="token number">1.7</span><span class="token number">2002</span>     <span class="token number">2.9</span>   <span class="token number">3.6</span><span class="token number">2003</span>     NaN   NaN<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”±Seriesç»„æˆçš„å­—å…¸å·®ä¸å¤šä¹Ÿæ˜¯ä¸€æ ·çš„ç”¨æ³•ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">70</span><span class="token punctuation">]</span><span class="token punctuation">:</span> pdata <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'Ohio'</span><span class="token punctuation">:</span> frame3<span class="token punctuation">[</span><span class="token string">'Ohio'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>          <span class="token string">'Nevada'</span><span class="token punctuation">:</span> frame3<span class="token punctuation">[</span><span class="token string">'Nevada'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">}</span>In <span class="token punctuation">[</span><span class="token number">71</span><span class="token punctuation">]</span><span class="token punctuation">:</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>pdata<span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">71</span><span class="token punctuation">]</span><span class="token punctuation">:</span>       Nevada  Ohio<span class="token number">2000</span>     NaN   <span class="token number">1.5</span><span class="token number">2001</span>     <span class="token number">2.4</span>   <span class="token number">1.7</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¡¨5-1åˆ—å‡ºäº†DataFrameæ„é€ å‡½æ•°æ‰€èƒ½æ¥å—çš„å„ç§æ•°æ®ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://upload-images.jianshu.io/upload_images/7178691-106835b28c0cea5a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><p>å¦‚æœè®¾ç½®äº†DataFrameçš„indexå’Œcolumnsçš„nameå±æ€§ï¼Œåˆ™è¿™äº›ä¿¡æ¯ä¹Ÿä¼šè¢«æ˜¾ç¤ºå‡ºæ¥ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">72</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame3<span class="token punctuation">.</span>index<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'year'</span><span class="token punctuation">;</span> frame3<span class="token punctuation">.</span>columns<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'state'</span>In <span class="token punctuation">[</span><span class="token number">73</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame3Out<span class="token punctuation">[</span><span class="token number">73</span><span class="token punctuation">]</span><span class="token punctuation">:</span> state  Nevada  Ohioyear<span class="token number">2000</span>      NaN   <span class="token number">1.5</span><span class="token number">2001</span>      <span class="token number">2.4</span>   <span class="token number">1.7</span><span class="token number">2002</span>      <span class="token number">2.9</span>   <span class="token number">3.6</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è·ŸSeriesä¸€æ ·ï¼Œvalueså±æ€§ä¹Ÿä¼šä»¥äºŒç»´ndarrayçš„å½¢å¼è¿”å›DataFrameä¸­çš„æ•°æ®ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">74</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame3<span class="token punctuation">.</span>valuesOut<span class="token punctuation">[</span><span class="token number">74</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> nan<span class="token punctuation">,</span>  <span class="token number">1.5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">2.4</span><span class="token punctuation">,</span>  <span class="token number">1.7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">2.9</span><span class="token punctuation">,</span>  <span class="token number">3.6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœDataFrameå„åˆ—çš„æ•°æ®ç±»å‹ä¸åŒï¼Œåˆ™å€¼æ•°ç»„çš„dtypeå°±ä¼šé€‰ç”¨èƒ½å…¼å®¹æ‰€æœ‰åˆ—çš„æ•°æ®ç±»å‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">75</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame2<span class="token punctuation">.</span>valuesOut<span class="token punctuation">[</span><span class="token number">75</span><span class="token punctuation">]</span><span class="token punctuation">:</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2000</span><span class="token punctuation">,</span> <span class="token string">'Ohio'</span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">,</span> nan<span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">2001</span><span class="token punctuation">,</span> <span class="token string">'Ohio'</span><span class="token punctuation">,</span> <span class="token number">1.7</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">2002</span><span class="token punctuation">,</span> <span class="token string">'Ohio'</span><span class="token punctuation">,</span> <span class="token number">3.6</span><span class="token punctuation">,</span> nan<span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">2001</span><span class="token punctuation">,</span> <span class="token string">'Nevada'</span><span class="token punctuation">,</span> <span class="token number">2.4</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">2002</span><span class="token punctuation">,</span> <span class="token string">'Nevada'</span><span class="token punctuation">,</span> <span class="token number">2.9</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">2003</span><span class="token punctuation">,</span> <span class="token string">'Nevada'</span><span class="token punctuation">,</span> <span class="token number">3.2</span><span class="token punctuation">,</span> nan<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>object<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç´¢å¼•å¯¹è±¡"><a href="#ç´¢å¼•å¯¹è±¡" class="headerlink" title="ç´¢å¼•å¯¹è±¡"></a>ç´¢å¼•å¯¹è±¡</h2><p>pandasçš„ç´¢å¼•å¯¹è±¡è´Ÿè´£ç®¡ç†è½´æ ‡ç­¾å’Œå…¶ä»–å…ƒæ•°æ®ï¼ˆæ¯”å¦‚è½´åç§°ç­‰ï¼‰ã€‚æ„å»ºSeriesæˆ–DataFrameæ—¶ï¼Œæ‰€ç”¨åˆ°çš„ä»»ä½•æ•°ç»„æˆ–å…¶ä»–åºåˆ—çš„æ ‡ç­¾éƒ½ä¼šè¢«è½¬æ¢æˆä¸€ä¸ªIndexï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">76</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>range<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">77</span><span class="token punctuation">]</span><span class="token punctuation">:</span> index <span class="token operator">=</span> obj<span class="token punctuation">.</span>indexIn <span class="token punctuation">[</span><span class="token number">78</span><span class="token punctuation">]</span><span class="token punctuation">:</span> indexOut<span class="token punctuation">[</span><span class="token number">78</span><span class="token punctuation">]</span><span class="token punctuation">:</span> Index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'object'</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">79</span><span class="token punctuation">]</span><span class="token punctuation">:</span> index<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">79</span><span class="token punctuation">]</span><span class="token punctuation">:</span> Index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'object'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Indexå¯¹è±¡æ˜¯ä¸å¯å˜çš„ï¼Œå› æ­¤ç”¨æˆ·ä¸èƒ½å¯¹å…¶è¿›è¡Œä¿®æ”¹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">index<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'d'</span>  <span class="token comment" spellcheck="true"># TypeError</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸å¯å˜å¯ä»¥ä½¿Indexå¯¹è±¡åœ¨å¤šä¸ªæ•°æ®ç»“æ„ä¹‹é—´å®‰å…¨å…±äº«ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">80</span><span class="token punctuation">]</span><span class="token punctuation">:</span> labels <span class="token operator">=</span> pd<span class="token punctuation">.</span>Index<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">81</span><span class="token punctuation">]</span><span class="token punctuation">:</span> labelsOut<span class="token punctuation">[</span><span class="token number">81</span><span class="token punctuation">]</span><span class="token punctuation">:</span> Int64Index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'int64'</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">82</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span>labels<span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">83</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj2Out<span class="token punctuation">[</span><span class="token number">83</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">0</span>    <span class="token number">1.51</span>   <span class="token operator">-</span><span class="token number">2.52</span>    <span class="token number">0.</span>0dtype<span class="token punctuation">:</span> float64In <span class="token punctuation">[</span><span class="token number">84</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj2<span class="token punctuation">.</span>index <span class="token keyword">is</span> labelsOut<span class="token punctuation">[</span><span class="token number">84</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>æ³¨æ„ï¼šè™½ç„¶ç”¨æˆ·ä¸éœ€è¦ç»å¸¸ä½¿ç”¨Indexçš„åŠŸèƒ½ï¼Œä½†æ˜¯å› ä¸ºä¸€äº›æ“ä½œä¼šç”ŸæˆåŒ…å«è¢«ç´¢å¼•åŒ–çš„æ•°æ®ï¼Œç†è§£å®ƒä»¬çš„å·¥ä½œåŸç†æ˜¯å¾ˆé‡è¦çš„ã€‚</p></blockquote><p>é™¤äº†ç±»ä¼¼äºæ•°ç»„ï¼ŒIndexçš„åŠŸèƒ½ä¹Ÿç±»ä¼¼ä¸€ä¸ªå›ºå®šå¤§å°çš„é›†åˆï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">85</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame3Out<span class="token punctuation">[</span><span class="token number">85</span><span class="token punctuation">]</span><span class="token punctuation">:</span> state  Nevada  Ohioyear               <span class="token number">2000</span>      NaN   <span class="token number">1.5</span><span class="token number">2001</span>      <span class="token number">2.4</span>   <span class="token number">1.7</span><span class="token number">2002</span>      <span class="token number">2.9</span>   <span class="token number">3.6</span>In <span class="token punctuation">[</span><span class="token number">86</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame3<span class="token punctuation">.</span>columnsOut<span class="token punctuation">[</span><span class="token number">86</span><span class="token punctuation">]</span><span class="token punctuation">:</span> Index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Nevada'</span><span class="token punctuation">,</span> <span class="token string">'Ohio'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'object'</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'state'</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">87</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'Ohio'</span> <span class="token keyword">in</span> frame3<span class="token punctuation">.</span>columnsOut<span class="token punctuation">[</span><span class="token number">87</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token boolean">True</span>In <span class="token punctuation">[</span><span class="token number">88</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">2003</span> <span class="token keyword">in</span> frame3<span class="token punctuation">.</span>indexOut<span class="token punctuation">[</span><span class="token number">88</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸pythonçš„é›†åˆä¸åŒï¼Œpandasçš„Indexå¯ä»¥åŒ…å«é‡å¤çš„æ ‡ç­¾ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">89</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dup_labels <span class="token operator">=</span> pd<span class="token punctuation">.</span>Index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">90</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dup_labelsOut<span class="token punctuation">[</span><span class="token number">90</span><span class="token punctuation">]</span><span class="token punctuation">:</span> Index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'object'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>é€‰æ‹©é‡å¤çš„æ ‡ç­¾ï¼Œä¼šæ˜¾ç¤ºæ‰€æœ‰çš„ç»“æœã€‚</p><p>æ¯ä¸ªç´¢å¼•éƒ½æœ‰ä¸€äº›æ–¹æ³•å’Œå±æ€§ï¼Œå®ƒä»¬å¯ç”¨äºè®¾ç½®é€»è¾‘å¹¶å›ç­”æœ‰å…³è¯¥ç´¢å¼•æ‰€åŒ…å«çš„æ•°æ®çš„å¸¸è§é—®é¢˜ã€‚è¡¨5-2åˆ—å‡ºäº†è¿™äº›å‡½æ•°ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://upload-images.jianshu.io/upload_images/7178691-5499d14f0e2cd639.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h1 id="5-2-åŸºæœ¬åŠŸèƒ½"><a href="#5-2-åŸºæœ¬åŠŸèƒ½" class="headerlink" title="5.2 åŸºæœ¬åŠŸèƒ½"></a>5.2 åŸºæœ¬åŠŸèƒ½</h1><p>æœ¬èŠ‚ä¸­ï¼Œæˆ‘å°†ä»‹ç»æ“ä½œSerieså’ŒDataFrameä¸­çš„æ•°æ®çš„åŸºæœ¬æ‰‹æ®µã€‚åç»­ç« èŠ‚å°†æ›´åŠ æ·±å…¥åœ°æŒ–æ˜pandasåœ¨æ•°æ®åˆ†æå’Œå¤„ç†æ–¹é¢çš„åŠŸèƒ½ã€‚æœ¬ä¹¦ä¸æ˜¯pandasåº“çš„è¯¦å°½æ–‡æ¡£ï¼Œä¸»è¦å…³æ³¨çš„æ˜¯æœ€é‡è¦çš„åŠŸèƒ½ï¼Œé‚£äº›ä¸å¤§å¸¸ç”¨çš„å†…å®¹ï¼ˆä¹Ÿå°±æ˜¯é‚£äº›æ›´æ·±å¥¥çš„å†…å®¹ï¼‰å°±äº¤ç»™ä½ è‡ªå·±å»æ‘¸ç´¢å§ã€‚</p><h2 id="é‡æ–°ç´¢å¼•"><a href="#é‡æ–°ç´¢å¼•" class="headerlink" title="é‡æ–°ç´¢å¼•"></a>é‡æ–°ç´¢å¼•</h2><p>pandaså¯¹è±¡çš„ä¸€ä¸ªé‡è¦æ–¹æ³•æ˜¯reindexï¼Œå…¶ä½œç”¨æ˜¯åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå®ƒçš„æ•°æ®ç¬¦åˆæ–°çš„ç´¢å¼•ã€‚çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">91</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4.5</span><span class="token punctuation">,</span> <span class="token number">7.2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5.3</span><span class="token punctuation">,</span> <span class="token number">3.6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">92</span><span class="token punctuation">]</span><span class="token punctuation">:</span> objOut<span class="token punctuation">[</span><span class="token number">92</span><span class="token punctuation">]</span><span class="token punctuation">:</span> d    <span class="token number">4.</span><span class="token number">5b</span>    <span class="token number">7.</span><span class="token number">2a</span>   <span class="token operator">-</span><span class="token number">5.</span><span class="token number">3c</span>    <span class="token number">3.</span>6dtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç”¨è¯¥Seriesçš„reindexå°†ä¼šæ ¹æ®æ–°ç´¢å¼•è¿›è¡Œé‡æ’ã€‚å¦‚æœæŸä¸ªç´¢å¼•å€¼å½“å‰ä¸å­˜åœ¨ï¼Œå°±å¼•å…¥ç¼ºå¤±å€¼ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">93</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj2 <span class="token operator">=</span> obj<span class="token punctuation">.</span>reindex<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">94</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj2Out<span class="token punctuation">[</span><span class="token number">94</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a   <span class="token operator">-</span><span class="token number">5.</span><span class="token number">3b</span>    <span class="token number">7.</span><span class="token number">2c</span>    <span class="token number">3.</span><span class="token number">6d</span>    <span class="token number">4.</span><span class="token number">5e</span>    NaNdtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯¹äºæ—¶é—´åºåˆ—è¿™æ ·çš„æœ‰åºæ•°æ®ï¼Œé‡æ–°ç´¢å¼•æ—¶å¯èƒ½éœ€è¦åšä¸€äº›æ’å€¼å¤„ç†ã€‚methodé€‰é¡¹å³å¯è¾¾åˆ°æ­¤ç›®çš„ï¼Œä¾‹å¦‚ï¼Œä½¿ç”¨ffillå¯ä»¥å®ç°å‰å‘å€¼å¡«å……ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">95</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj3 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'blue'</span><span class="token punctuation">,</span> <span class="token string">'purple'</span><span class="token punctuation">,</span> <span class="token string">'yellow'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">96</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj3Out<span class="token punctuation">[</span><span class="token number">96</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">0</span>      blue2    purple4    yellowdtype<span class="token punctuation">:</span> objectIn <span class="token punctuation">[</span><span class="token number">97</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj3<span class="token punctuation">.</span>reindex<span class="token punctuation">(</span>range<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token string">'ffill'</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">97</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">0</span>      blue1      blue2    purple3    purple4    yellow5    yellowdtype<span class="token punctuation">:</span> object<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å€ŸåŠ©DataFrameï¼Œreindexå¯ä»¥ä¿®æ”¹ï¼ˆè¡Œï¼‰ç´¢å¼•å’Œåˆ—ã€‚åªä¼ é€’ä¸€ä¸ªåºåˆ—æ—¶ï¼Œä¼šé‡æ–°ç´¢å¼•ç»“æœçš„è¡Œï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">98</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>                      index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>                      columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Ohio'</span><span class="token punctuation">,</span> <span class="token string">'Texas'</span><span class="token punctuation">,</span> <span class="token string">'California'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">99</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frameOut<span class="token punctuation">[</span><span class="token number">99</span><span class="token punctuation">]</span><span class="token punctuation">:</span>    Ohio  Texas  Californiaa     <span class="token number">0</span>      <span class="token number">1</span>           <span class="token number">2c</span>     <span class="token number">3</span>      <span class="token number">4</span>           <span class="token number">5d</span>     <span class="token number">6</span>      <span class="token number">7</span>           8In <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame2 <span class="token operator">=</span> frame<span class="token punctuation">.</span>reindex<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame2Out<span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">]</span><span class="token punctuation">:</span>    Ohio  Texas  Californiaa   <span class="token number">0.0</span>    <span class="token number">1.0</span>         <span class="token number">2.</span><span class="token number">0b</span>   NaN    NaN         NaNc   <span class="token number">3.0</span>    <span class="token number">4.0</span>         <span class="token number">5.</span><span class="token number">0d</span>   <span class="token number">6.0</span>    <span class="token number">7.0</span>         <span class="token number">8.0</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åˆ—å¯ä»¥ç”¨columnså…³é”®å­—é‡æ–°ç´¢å¼•ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">102</span><span class="token punctuation">]</span><span class="token punctuation">:</span> states <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Texas'</span><span class="token punctuation">,</span> <span class="token string">'Utah'</span><span class="token punctuation">,</span> <span class="token string">'California'</span><span class="token punctuation">]</span>In <span class="token punctuation">[</span><span class="token number">103</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame<span class="token punctuation">.</span>reindex<span class="token punctuation">(</span>columns<span class="token operator">=</span>states<span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">103</span><span class="token punctuation">]</span><span class="token punctuation">:</span>    Texas  Utah  Californiaa      <span class="token number">1</span>   NaN           <span class="token number">2c</span>      <span class="token number">4</span>   NaN           <span class="token number">5d</span>      <span class="token number">7</span>   NaN           <span class="token number">8</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¡¨5-3åˆ—å‡ºäº†reindexå‡½æ•°çš„å„å‚æ•°åŠè¯´æ˜ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://upload-images.jianshu.io/upload_images/7178691-efa3dbd4b83c61ec.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h2 id="ä¸¢å¼ƒæŒ‡å®šè½´ä¸Šçš„é¡¹"><a href="#ä¸¢å¼ƒæŒ‡å®šè½´ä¸Šçš„é¡¹" class="headerlink" title="ä¸¢å¼ƒæŒ‡å®šè½´ä¸Šçš„é¡¹"></a>ä¸¢å¼ƒæŒ‡å®šè½´ä¸Šçš„é¡¹</h2><p>ä¸¢å¼ƒæŸæ¡è½´ä¸Šçš„ä¸€ä¸ªæˆ–å¤šä¸ªé¡¹å¾ˆç®€å•ï¼Œåªè¦æœ‰ä¸€ä¸ªç´¢å¼•æ•°ç»„æˆ–åˆ—è¡¨å³å¯ã€‚ç”±äºéœ€è¦æ‰§è¡Œä¸€äº›æ•°æ®æ•´ç†å’Œé›†åˆé€»è¾‘ï¼Œæ‰€ä»¥dropæ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªåœ¨æŒ‡å®šè½´ä¸Šåˆ é™¤äº†æŒ‡å®šå€¼çš„æ–°å¯¹è±¡ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">105</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">106</span><span class="token punctuation">]</span><span class="token punctuation">:</span> objOut<span class="token punctuation">[</span><span class="token number">106</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a    <span class="token number">0.0</span>b    <span class="token number">1.0</span>c    <span class="token number">2.0</span>d    <span class="token number">3.0</span>e    <span class="token number">4.0</span>dtype<span class="token punctuation">:</span> float64In <span class="token punctuation">[</span><span class="token number">107</span><span class="token punctuation">]</span><span class="token punctuation">:</span> new_obj <span class="token operator">=</span> obj<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">'c'</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">108</span><span class="token punctuation">]</span><span class="token punctuation">:</span> new_objOut<span class="token punctuation">[</span><span class="token number">108</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a    <span class="token number">0.0</span>b    <span class="token number">1.0</span>d    <span class="token number">3.0</span>e    <span class="token number">4.0</span>dtype<span class="token punctuation">:</span> float64In <span class="token punctuation">[</span><span class="token number">109</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">109</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a    <span class="token number">0.0</span>b    <span class="token number">1.0</span>e    <span class="token number">4.0</span>dtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯¹äºDataFrameï¼Œå¯ä»¥åˆ é™¤ä»»æ„è½´ä¸Šçš„ç´¢å¼•å€¼ã€‚ä¸ºäº†æ¼”ç¤ºï¼Œå…ˆæ–°å»ºä¸€ä¸ªDataFrameä¾‹å­ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">110</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>                     index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Ohio'</span><span class="token punctuation">,</span> <span class="token string">'Colorado'</span><span class="token punctuation">,</span> <span class="token string">'Utah'</span><span class="token punctuation">,</span> <span class="token string">'New York'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>                     columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'three'</span><span class="token punctuation">,</span> <span class="token string">'four'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">111</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dataOut<span class="token punctuation">[</span><span class="token number">111</span><span class="token punctuation">]</span><span class="token punctuation">:</span>           one  two  three  fourOhio        <span class="token number">0</span>    <span class="token number">1</span>      <span class="token number">2</span>     3Colorado    <span class="token number">4</span>    <span class="token number">5</span>      <span class="token number">6</span>     7Utah        <span class="token number">8</span>    <span class="token number">9</span>     <span class="token number">10</span>    11New York   <span class="token number">12</span>   <span class="token number">13</span>     <span class="token number">14</span>    <span class="token number">15</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç”¨æ ‡ç­¾åºåˆ—è°ƒç”¨dropä¼šä»è¡Œæ ‡ç­¾ï¼ˆaxis 0ï¼‰åˆ é™¤å€¼ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">112</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Colorado'</span><span class="token punctuation">,</span> <span class="token string">'Ohio'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">112</span><span class="token punctuation">]</span><span class="token punctuation">:</span>           one  two  three  fourUtah        <span class="token number">8</span>    <span class="token number">9</span>     <span class="token number">10</span>    11New York   <span class="token number">12</span>   <span class="token number">13</span>     <span class="token number">14</span>    <span class="token number">15</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é€šè¿‡ä¼ é€’axis=1æˆ–axis=â€™columnsâ€™å¯ä»¥åˆ é™¤åˆ—çš„å€¼ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">113</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">'two'</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">113</span><span class="token punctuation">]</span><span class="token punctuation">:</span>           one  three  fourOhio        <span class="token number">0</span>      <span class="token number">2</span>     <span class="token number">3</span>Colorado    <span class="token number">4</span>      <span class="token number">6</span>     <span class="token number">7</span>Utah        <span class="token number">8</span>     <span class="token number">10</span>    <span class="token number">11</span>New York   <span class="token number">12</span>     <span class="token number">14</span>    <span class="token number">15</span>In <span class="token punctuation">[</span><span class="token number">114</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'four'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token string">'columns'</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">114</span><span class="token punctuation">]</span><span class="token punctuation">:</span>           one  threeOhio        <span class="token number">0</span>      <span class="token number">2</span>Colorado    <span class="token number">4</span>      <span class="token number">6</span>Utah        <span class="token number">8</span>     <span class="token number">10</span>New York   <span class="token number">12</span>     <span class="token number">14</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è®¸å¤šå‡½æ•°ï¼Œå¦‚dropï¼Œä¼šä¿®æ”¹Seriesæˆ–DataFrameçš„å¤§å°æˆ–å½¢çŠ¶ï¼Œå¯ä»¥å°±åœ°ä¿®æ”¹å¯¹è±¡ï¼Œä¸ä¼šè¿”å›æ–°çš„å¯¹è±¡ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">115</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">'c'</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">116</span><span class="token punctuation">]</span><span class="token punctuation">:</span> objOut<span class="token punctuation">[</span><span class="token number">116</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a    <span class="token number">0.0</span>b    <span class="token number">1.0</span>d    <span class="token number">3.0</span>e    <span class="token number">4.0</span>dtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°å¿ƒä½¿ç”¨inplaceï¼Œå®ƒä¼šé”€æ¯æ‰€æœ‰è¢«åˆ é™¤çš„æ•°æ®ã€‚</p><h2 id="ç´¢å¼•ã€é€‰å–å’Œè¿‡æ»¤"><a href="#ç´¢å¼•ã€é€‰å–å’Œè¿‡æ»¤" class="headerlink" title="ç´¢å¼•ã€é€‰å–å’Œè¿‡æ»¤"></a>ç´¢å¼•ã€é€‰å–å’Œè¿‡æ»¤</h2><p>Seriesç´¢å¼•ï¼ˆobj[â€¦]ï¼‰çš„å·¥ä½œæ–¹å¼ç±»ä¼¼äºNumPyæ•°ç»„çš„ç´¢å¼•ï¼Œåªä¸è¿‡Seriesçš„ç´¢å¼•å€¼ä¸åªæ˜¯æ•´æ•°ã€‚ä¸‹é¢æ˜¯å‡ ä¸ªä¾‹å­ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">117</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">118</span><span class="token punctuation">]</span><span class="token punctuation">:</span> objOut<span class="token punctuation">[</span><span class="token number">118</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a    <span class="token number">0.0</span>b    <span class="token number">1.0</span>c    <span class="token number">2.0</span>d    <span class="token number">3.0</span>dtype<span class="token punctuation">:</span> float64In <span class="token punctuation">[</span><span class="token number">119</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">119</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">1.0</span>In <span class="token punctuation">[</span><span class="token number">120</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">120</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">1.0</span>In <span class="token punctuation">[</span><span class="token number">121</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">121</span><span class="token punctuation">]</span><span class="token punctuation">:</span> c    <span class="token number">2.0</span>d    <span class="token number">3.0</span>dtype<span class="token punctuation">:</span> float64In <span class="token punctuation">[</span><span class="token number">122</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">122</span><span class="token punctuation">]</span><span class="token punctuation">:</span>b    <span class="token number">1.0</span>a    <span class="token number">0.0</span>d    <span class="token number">3.0</span>dtype<span class="token punctuation">:</span> float64In <span class="token punctuation">[</span><span class="token number">123</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">123</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b    <span class="token number">1.0</span>d    <span class="token number">3.0</span>dtype<span class="token punctuation">:</span> float64In <span class="token punctuation">[</span><span class="token number">124</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj<span class="token punctuation">[</span>obj <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">124</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a    <span class="token number">0.0</span>b    <span class="token number">1.0</span>dtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ©ç”¨æ ‡ç­¾çš„åˆ‡ç‰‡è¿ç®—ä¸æ™®é€šçš„Pythonåˆ‡ç‰‡è¿ç®—ä¸åŒï¼Œå…¶æœ«ç«¯æ˜¯åŒ…å«çš„ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">125</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">:</span><span class="token string">'c'</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">125</span><span class="token punctuation">]</span><span class="token punctuation">:</span>b    <span class="token number">1.0</span>c    <span class="token number">2.0</span>dtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”¨åˆ‡ç‰‡å¯ä»¥å¯¹Seriesçš„ç›¸åº”éƒ¨åˆ†è¿›è¡Œè®¾ç½®ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">126</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">:</span><span class="token string">'c'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">5</span>In <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">]</span><span class="token punctuation">:</span> objOut<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a    <span class="token number">0.0</span>b    <span class="token number">5.0</span>c    <span class="token number">5.0</span>d    <span class="token number">3.0</span>dtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”¨ä¸€ä¸ªå€¼æˆ–åºåˆ—å¯¹DataFrameè¿›è¡Œç´¢å¼•å…¶å®å°±æ˜¯è·å–ä¸€ä¸ªæˆ–å¤šä¸ªåˆ—ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>                     index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Ohio'</span><span class="token punctuation">,</span> <span class="token string">'Colorado'</span><span class="token punctuation">,</span> <span class="token string">'Utah'</span><span class="token punctuation">,</span> <span class="token string">'New York'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>                     columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'three'</span><span class="token punctuation">,</span> <span class="token string">'four'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">129</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dataOut<span class="token punctuation">[</span><span class="token number">129</span><span class="token punctuation">]</span><span class="token punctuation">:</span>           one  two  three  fourOhio        <span class="token number">0</span>    <span class="token number">1</span>      <span class="token number">2</span>     3Colorado    <span class="token number">4</span>    <span class="token number">5</span>      <span class="token number">6</span>     7Utah        <span class="token number">8</span>    <span class="token number">9</span>     <span class="token number">10</span>    11New York   <span class="token number">12</span>   <span class="token number">13</span>     <span class="token number">14</span>    15In <span class="token punctuation">[</span><span class="token number">130</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data<span class="token punctuation">[</span><span class="token string">'two'</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">130</span><span class="token punctuation">]</span><span class="token punctuation">:</span> Ohio         1Colorado     5Utah         9New York    13Name<span class="token punctuation">:</span> two<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> int64In <span class="token punctuation">[</span><span class="token number">131</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'three'</span><span class="token punctuation">,</span> <span class="token string">'one'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">131</span><span class="token punctuation">]</span><span class="token punctuation">:</span>           three  oneOhio          <span class="token number">2</span>    0Colorado      <span class="token number">6</span>    4Utah         <span class="token number">10</span>    8New York     <span class="token number">14</span>   <span class="token number">12</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™ç§ç´¢å¼•æ–¹å¼æœ‰å‡ ä¸ªç‰¹æ®Šçš„æƒ…å†µã€‚é¦–å…ˆé€šè¿‡åˆ‡ç‰‡æˆ–å¸ƒå°”å‹æ•°ç»„é€‰å–æ•°æ®ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">132</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">132</span><span class="token punctuation">]</span><span class="token punctuation">:</span>           one  two  three  fourOhio        <span class="token number">0</span>    <span class="token number">1</span>      <span class="token number">2</span>     3Colorado    <span class="token number">4</span>    <span class="token number">5</span>      <span class="token number">6</span>     7In <span class="token punctuation">[</span><span class="token number">133</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data<span class="token punctuation">[</span>data<span class="token punctuation">[</span><span class="token string">'three'</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">5</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">133</span><span class="token punctuation">]</span><span class="token punctuation">:</span>           one  two  three  fourColorado    <span class="token number">4</span>    <span class="token number">5</span>      <span class="token number">6</span>     7Utah        <span class="token number">8</span>    <span class="token number">9</span>     <span class="token number">10</span>    11New York   <span class="token number">12</span>   <span class="token number">13</span>     <span class="token number">14</span>    <span class="token number">15</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é€‰å–è¡Œçš„è¯­æ³•data[:2]ååˆ†æ–¹ä¾¿ã€‚å‘[ ]ä¼ é€’å•ä¸€çš„å…ƒç´ æˆ–åˆ—è¡¨ï¼Œå°±å¯é€‰æ‹©åˆ—ã€‚</p><p>å¦ä¸€ç§ç”¨æ³•æ˜¯é€šè¿‡å¸ƒå°”å‹DataFrameï¼ˆæ¯”å¦‚ä¸‹é¢è¿™ä¸ªç”±æ ‡é‡æ¯”è¾ƒè¿ç®—å¾—å‡ºçš„ï¼‰è¿›è¡Œç´¢å¼•ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">134</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data <span class="token operator">&lt;</span> 5Out<span class="token punctuation">[</span><span class="token number">134</span><span class="token punctuation">]</span><span class="token punctuation">:</span>             one    two  three   fourOhio       <span class="token boolean">True</span>   <span class="token boolean">True</span>   <span class="token boolean">True</span>   TrueColorado   <span class="token boolean">True</span>  <span class="token boolean">False</span>  <span class="token boolean">False</span>  FalseUtah      <span class="token boolean">False</span>  <span class="token boolean">False</span>  <span class="token boolean">False</span>  FalseNew York  <span class="token boolean">False</span>  <span class="token boolean">False</span>  <span class="token boolean">False</span>  FalseIn <span class="token punctuation">[</span><span class="token number">135</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data<span class="token punctuation">[</span>data <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> 0In <span class="token punctuation">[</span><span class="token number">136</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dataOut<span class="token punctuation">[</span><span class="token number">136</span><span class="token punctuation">]</span><span class="token punctuation">:</span>           one  two  three  fourOhio        <span class="token number">0</span>    <span class="token number">0</span>      <span class="token number">0</span>     0Colorado    <span class="token number">0</span>    <span class="token number">5</span>      <span class="token number">6</span>     7Utah        <span class="token number">8</span>    <span class="token number">9</span>     <span class="token number">10</span>    11New York   <span class="token number">12</span>   <span class="token number">13</span>     <span class="token number">14</span>    <span class="token number">15</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™ä½¿å¾—DataFrameçš„è¯­æ³•ä¸NumPyäºŒç»´æ•°ç»„çš„è¯­æ³•å¾ˆåƒã€‚</p><h2 id="ç”¨locå’Œilocè¿›è¡Œé€‰å–"><a href="#ç”¨locå’Œilocè¿›è¡Œé€‰å–" class="headerlink" title="ç”¨locå’Œilocè¿›è¡Œé€‰å–"></a>ç”¨locå’Œilocè¿›è¡Œé€‰å–</h2><p>å¯¹äºDataFrameçš„è¡Œçš„æ ‡ç­¾ç´¢å¼•ï¼Œæˆ‘å¼•å…¥äº†ç‰¹æ®Šçš„æ ‡ç­¾è¿ç®—ç¬¦locå’Œilocã€‚å®ƒä»¬å¯ä»¥è®©ä½ ç”¨ç±»ä¼¼NumPyçš„æ ‡è®°ï¼Œä½¿ç”¨è½´æ ‡ç­¾ï¼ˆlocï¼‰æˆ–æ•´æ•°ç´¢å¼•ï¼ˆilocï¼‰ï¼Œä»DataFrameé€‰æ‹©è¡Œå’Œåˆ—çš„å­é›†ã€‚</p><p>ä½œä¸ºä¸€ä¸ªåˆæ­¥ç¤ºä¾‹ï¼Œè®©æˆ‘ä»¬é€šè¿‡æ ‡ç­¾é€‰æ‹©ä¸€è¡Œå’Œå¤šåˆ—ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">137</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'Colorado'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'three'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">137</span><span class="token punctuation">]</span><span class="token punctuation">:</span> two      5three    6Name<span class="token punctuation">:</span> Colorado<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> int64<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åç”¨ilocå’Œæ•´æ•°è¿›è¡Œé€‰å–ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">138</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">138</span><span class="token punctuation">]</span><span class="token punctuation">:</span> four    11one      8two      9Name<span class="token punctuation">:</span> Utah<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> int64In <span class="token punctuation">[</span><span class="token number">139</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">139</span><span class="token punctuation">]</span><span class="token punctuation">:</span> one       8two       9three    10four     11Name<span class="token punctuation">:</span> Utah<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> int64In <span class="token punctuation">[</span><span class="token number">140</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">140</span><span class="token punctuation">]</span><span class="token punctuation">:</span>           four  one  twoColorado     <span class="token number">7</span>    <span class="token number">0</span>    5Utah        <span class="token number">11</span>    <span class="token number">8</span>    <span class="token number">9</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™ä¸¤ä¸ªç´¢å¼•å‡½æ•°ä¹Ÿé€‚ç”¨äºä¸€ä¸ªæ ‡ç­¾æˆ–å¤šä¸ªæ ‡ç­¾çš„åˆ‡ç‰‡ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">141</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token string">'Utah'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">141</span><span class="token punctuation">]</span><span class="token punctuation">:</span> Ohio        0Colorado    5Utah        9Name<span class="token punctuation">:</span> two<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> int64In <span class="token punctuation">[</span><span class="token number">142</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span>data<span class="token punctuation">.</span>three <span class="token operator">></span> <span class="token number">5</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">142</span><span class="token punctuation">]</span><span class="token punctuation">:</span>           one  two  threeColorado    <span class="token number">0</span>    <span class="token number">5</span>      6Utah        <span class="token number">8</span>    <span class="token number">9</span>     10New York   <span class="token number">12</span>   <span class="token number">13</span>     <span class="token number">14</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰€ä»¥ï¼Œåœ¨pandasä¸­ï¼Œæœ‰å¤šä¸ªæ–¹æ³•å¯ä»¥é€‰å–å’Œé‡æ–°ç»„åˆæ•°æ®ã€‚å¯¹äºDataFrameï¼Œè¡¨5-4è¿›è¡Œäº†æ€»ç»“ã€‚åé¢ä¼šçœ‹åˆ°ï¼Œè¿˜æœ‰æ›´å¤šçš„æ–¹æ³•è¿›è¡Œå±‚çº§åŒ–ç´¢å¼•ã€‚</p><blockquote><p>ç¬”è®°ï¼šåœ¨ä¸€å¼€å§‹è®¾è®¡pandasæ—¶ï¼Œæˆ‘è§‰å¾—ç”¨frame[:, col]é€‰å–åˆ—è¿‡äºç¹çï¼ˆä¹Ÿå®¹æ˜“å‡ºé”™ï¼‰ï¼Œå› ä¸ºåˆ—çš„é€‰æ‹©æ˜¯éå¸¸å¸¸è§çš„æ“ä½œã€‚æˆ‘åšäº†äº›å–èˆï¼Œå°†èŠ±å¼ç´¢å¼•çš„åŠŸèƒ½ï¼ˆæ ‡ç­¾å’Œæ•´æ•°ï¼‰æ”¾åˆ°äº†ixè¿ç®—ç¬¦ä¸­ã€‚åœ¨å®è·µä¸­ï¼Œè¿™ä¼šå¯¼è‡´è®¸å¤šè¾¹ç¼˜æƒ…å†µï¼Œæ•°æ®çš„è½´æ ‡ç­¾æ˜¯æ•´æ•°ï¼Œæ‰€ä»¥pandaså›¢é˜Ÿå†³å®šåˆ›é€ locå’Œilocè¿ç®—ç¬¦åˆ†åˆ«å¤„ç†ä¸¥æ ¼åŸºäºæ ‡ç­¾å’Œæ•´æ•°çš„ç´¢å¼•ã€‚<br>ixè¿ç®—ç¬¦ä»ç„¶å¯ç”¨ï¼Œä½†å¹¶ä¸æ¨èã€‚</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://upload-images.jianshu.io/upload_images/7178691-64354f2ab777bd8c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è¡¨5-4 DataFrameçš„ç´¢å¼•é€‰é¡¹"></p><h2 id="æ•´æ•°ç´¢å¼•"><a href="#æ•´æ•°ç´¢å¼•" class="headerlink" title="æ•´æ•°ç´¢å¼•"></a>æ•´æ•°ç´¢å¼•</h2><p>å¤„ç†æ•´æ•°ç´¢å¼•çš„pandaså¯¹è±¡å¸¸å¸¸éš¾ä½æ–°æ‰‹ï¼Œå› ä¸ºå®ƒä¸Pythonå†…ç½®çš„åˆ—è¡¨å’Œå…ƒç»„çš„ç´¢å¼•è¯­æ³•ä¸åŒã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½ä¸è®¤ä¸ºä¸‹é¢çš„ä»£ç ä¼šå‡ºé”™ï¼š</p><pre class="line-numbers language-python"><code class="language-python">ser <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">)</span>serser<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™é‡Œï¼Œpandaså¯ä»¥å‹‰å¼ºè¿›è¡Œæ•´æ•°ç´¢å¼•ï¼Œä½†æ˜¯ä¼šå¯¼è‡´å°bugã€‚æˆ‘ä»¬æœ‰åŒ…å«0,1,2çš„ç´¢å¼•ï¼Œä½†æ˜¯å¼•å…¥ç”¨æˆ·æƒ³è¦çš„ä¸œè¥¿ï¼ˆåŸºäºæ ‡ç­¾æˆ–ä½ç½®çš„ç´¢å¼•ï¼‰å¾ˆéš¾ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">144</span><span class="token punctuation">]</span><span class="token punctuation">:</span> serOut<span class="token punctuation">[</span><span class="token number">144</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">0</span>    <span class="token number">0.01</span>    <span class="token number">1.02</span>    <span class="token number">2.</span>0dtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦å¤–ï¼Œå¯¹äºéæ•´æ•°ç´¢å¼•ï¼Œä¸ä¼šäº§ç”Ÿæ­§ä¹‰ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">145</span><span class="token punctuation">]</span><span class="token punctuation">:</span> ser2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">146</span><span class="token punctuation">]</span><span class="token punctuation">:</span> ser2<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">146</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">2.0</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸ºäº†è¿›è¡Œç»Ÿä¸€ï¼Œå¦‚æœè½´ç´¢å¼•å«æœ‰æ•´æ•°ï¼Œæ•°æ®é€‰å–æ€»ä¼šä½¿ç”¨æ ‡ç­¾ã€‚ä¸ºäº†æ›´å‡†ç¡®ï¼Œè¯·ä½¿ç”¨locï¼ˆæ ‡ç­¾ï¼‰æˆ–ilocï¼ˆæ•´æ•°ï¼‰ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">147</span><span class="token punctuation">]</span><span class="token punctuation">:</span> ser<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">147</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">0</span>    <span class="token number">0.</span>0dtype<span class="token punctuation">:</span> float64In <span class="token punctuation">[</span><span class="token number">148</span><span class="token punctuation">]</span><span class="token punctuation">:</span> ser<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">148</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">0</span>    <span class="token number">0.01</span>    <span class="token number">1.</span>0dtype<span class="token punctuation">:</span> float64In <span class="token punctuation">[</span><span class="token number">149</span><span class="token punctuation">]</span><span class="token punctuation">:</span> ser<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">149</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">0</span>    <span class="token number">0.</span>0dtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç®—æœ¯è¿ç®—å’Œæ•°æ®å¯¹é½"><a href="#ç®—æœ¯è¿ç®—å’Œæ•°æ®å¯¹é½" class="headerlink" title="ç®—æœ¯è¿ç®—å’Œæ•°æ®å¯¹é½"></a>ç®—æœ¯è¿ç®—å’Œæ•°æ®å¯¹é½</h2><p>pandasæœ€é‡è¦çš„ä¸€ä¸ªåŠŸèƒ½æ˜¯ï¼Œå®ƒå¯ä»¥å¯¹ä¸åŒç´¢å¼•çš„å¯¹è±¡è¿›è¡Œç®—æœ¯è¿ç®—ã€‚åœ¨å°†å¯¹è±¡ç›¸åŠ æ—¶ï¼Œå¦‚æœå­˜åœ¨ä¸åŒçš„ç´¢å¼•å¯¹ï¼Œåˆ™ç»“æœçš„ç´¢å¼•å°±æ˜¯è¯¥ç´¢å¼•å¯¹çš„å¹¶é›†ã€‚å¯¹äºæœ‰æ•°æ®åº“ç»éªŒçš„ç”¨æˆ·ï¼Œè¿™å°±åƒåœ¨ç´¢å¼•æ ‡ç­¾ä¸Šè¿›è¡Œè‡ªåŠ¨å¤–è¿æ¥ã€‚çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">150</span><span class="token punctuation">]</span><span class="token punctuation">:</span> s1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">7.3</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.5</span><span class="token punctuation">,</span> <span class="token number">3.4</span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">151</span><span class="token punctuation">]</span><span class="token punctuation">:</span> s2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2.1</span><span class="token punctuation">,</span> <span class="token number">3.6</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3.1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>                index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">,</span> <span class="token string">'f'</span><span class="token punctuation">,</span> <span class="token string">'g'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">152</span><span class="token punctuation">]</span><span class="token punctuation">:</span> s1Out<span class="token punctuation">[</span><span class="token number">152</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a    <span class="token number">7.3</span>c   <span class="token operator">-</span><span class="token number">2.5</span>d    <span class="token number">3.4</span>e    <span class="token number">1.5</span>dtype<span class="token punctuation">:</span> float64In <span class="token punctuation">[</span><span class="token number">153</span><span class="token punctuation">]</span><span class="token punctuation">:</span> s2Out<span class="token punctuation">[</span><span class="token number">153</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a   <span class="token operator">-</span><span class="token number">2.1</span>c    <span class="token number">3.6</span>e   <span class="token operator">-</span><span class="token number">1.5</span>f    <span class="token number">4.0</span>g    <span class="token number">3.1</span>dtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°†å®ƒä»¬ç›¸åŠ å°±ä¼šäº§ç”Ÿï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">154</span><span class="token punctuation">]</span><span class="token punctuation">:</span> s1 <span class="token operator">+</span> s2Out<span class="token punctuation">[</span><span class="token number">154</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a    <span class="token number">5.2</span>c    <span class="token number">1.1</span>d    NaNe    <span class="token number">0.0</span>f    NaNg    NaNdtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è‡ªåŠ¨çš„æ•°æ®å¯¹é½æ“ä½œåœ¨ä¸é‡å çš„ç´¢å¼•å¤„å¼•å…¥äº†NAå€¼ã€‚ç¼ºå¤±å€¼ä¼šåœ¨ç®—æœ¯è¿ç®—è¿‡ç¨‹ä¸­ä¼ æ’­ã€‚</p><p>å¯¹äºDataFrameï¼Œå¯¹é½æ“ä½œä¼šåŒæ—¶å‘ç”Ÿåœ¨è¡Œå’Œåˆ—ä¸Šï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">155</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span>list<span class="token punctuation">(</span><span class="token string">'bcd'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>                    index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Ohio'</span><span class="token punctuation">,</span> <span class="token string">'Texas'</span><span class="token punctuation">,</span> <span class="token string">'Colorado'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">156</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span>list<span class="token punctuation">(</span><span class="token string">'bde'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>                    index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Utah'</span><span class="token punctuation">,</span> <span class="token string">'Ohio'</span><span class="token punctuation">,</span> <span class="token string">'Texas'</span><span class="token punctuation">,</span> <span class="token string">'Oregon'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">157</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df1Out<span class="token punctuation">[</span><span class="token number">157</span><span class="token punctuation">]</span><span class="token punctuation">:</span>             b    c    dOhio      <span class="token number">0.0</span>  <span class="token number">1.0</span>  <span class="token number">2.0</span>Texas     <span class="token number">3.0</span>  <span class="token number">4.0</span>  <span class="token number">5.0</span>Colorado  <span class="token number">6.0</span>  <span class="token number">7.0</span>  <span class="token number">8.0</span>In <span class="token punctuation">[</span><span class="token number">158</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df2Out<span class="token punctuation">[</span><span class="token number">158</span><span class="token punctuation">]</span><span class="token punctuation">:</span>           b     d     eUtah    <span class="token number">0.0</span>   <span class="token number">1.0</span>   <span class="token number">2.0</span>Ohio    <span class="token number">3.0</span>   <span class="token number">4.0</span>   <span class="token number">5.0</span>Texas   <span class="token number">6.0</span>   <span class="token number">7.0</span>   <span class="token number">8.0</span>Oregon  <span class="token number">9.0</span>  <span class="token number">10.0</span>  <span class="token number">11.0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æŠŠå®ƒä»¬ç›¸åŠ åå°†ä¼šè¿”å›ä¸€ä¸ªæ–°çš„DataFrameï¼Œå…¶ç´¢å¼•å’Œåˆ—ä¸ºåŸæ¥é‚£ä¸¤ä¸ªDataFrameçš„å¹¶é›†ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">159</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df1 <span class="token operator">+</span> df2Out<span class="token punctuation">[</span><span class="token number">159</span><span class="token punctuation">]</span><span class="token punctuation">:</span>             b   c     d   eColorado  NaN NaN   NaN NaNOhio      <span class="token number">3.0</span> NaN   <span class="token number">6.0</span> NaNOregon    NaN NaN   NaN NaNTexas     <span class="token number">9.0</span> NaN  <span class="token number">12.0</span> NaNUtah      NaN NaN   NaN NaN<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å› ä¸ºâ€™câ€™å’Œâ€™eâ€™åˆ—å‡ä¸åœ¨ä¸¤ä¸ªDataFrameå¯¹è±¡ä¸­ï¼Œåœ¨ç»“æœä¸­ä»¥ç¼ºçœå€¼å‘ˆç°ã€‚è¡Œä¹Ÿæ˜¯åŒæ ·ã€‚</p><p>å¦‚æœDataFrameå¯¹è±¡ç›¸åŠ ï¼Œæ²¡æœ‰å…±ç”¨çš„åˆ—æˆ–è¡Œæ ‡ç­¾ï¼Œç»“æœéƒ½ä¼šæ˜¯ç©ºï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">160</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'A'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">161</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'B'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">162</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df1Out<span class="token punctuation">[</span><span class="token number">162</span><span class="token punctuation">]</span><span class="token punctuation">:</span>    A<span class="token number">0</span>  <span class="token number">1</span><span class="token number">1</span>  <span class="token number">2</span>In <span class="token punctuation">[</span><span class="token number">163</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df2Out<span class="token punctuation">[</span><span class="token number">163</span><span class="token punctuation">]</span><span class="token punctuation">:</span>    B<span class="token number">0</span>  <span class="token number">3</span><span class="token number">1</span>  <span class="token number">4</span>In <span class="token punctuation">[</span><span class="token number">164</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df1 <span class="token operator">-</span> df2Out<span class="token punctuation">[</span><span class="token number">164</span><span class="token punctuation">]</span><span class="token punctuation">:</span>     A   B<span class="token number">0</span> NaN NaN<span class="token number">1</span> NaN NaN<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="åœ¨ç®—æœ¯æ–¹æ³•ä¸­å¡«å……å€¼"><a href="#åœ¨ç®—æœ¯æ–¹æ³•ä¸­å¡«å……å€¼" class="headerlink" title="åœ¨ç®—æœ¯æ–¹æ³•ä¸­å¡«å……å€¼"></a>åœ¨ç®—æœ¯æ–¹æ³•ä¸­å¡«å……å€¼</h2><p>åœ¨å¯¹ä¸åŒç´¢å¼•çš„å¯¹è±¡è¿›è¡Œç®—æœ¯è¿ç®—æ—¶ï¼Œä½ å¯èƒ½å¸Œæœ›å½“ä¸€ä¸ªå¯¹è±¡ä¸­æŸä¸ªè½´æ ‡ç­¾åœ¨å¦ä¸€ä¸ªå¯¹è±¡ä¸­æ‰¾ä¸åˆ°æ—¶å¡«å……ä¸€ä¸ªç‰¹æ®Šå€¼ï¼ˆæ¯”å¦‚0ï¼‰ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">165</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>                    columns<span class="token operator">=</span>list<span class="token punctuation">(</span><span class="token string">'abcd'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">166</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>                    columns<span class="token operator">=</span>list<span class="token punctuation">(</span><span class="token string">'abcde'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">167</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df2<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>nanIn <span class="token punctuation">[</span><span class="token number">168</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df1Out<span class="token punctuation">[</span><span class="token number">168</span><span class="token punctuation">]</span><span class="token punctuation">:</span>      a    b     c     d<span class="token number">0</span>  <span class="token number">0.0</span>  <span class="token number">1.0</span>   <span class="token number">2.0</span>   <span class="token number">3.0</span><span class="token number">1</span>  <span class="token number">4.0</span>  <span class="token number">5.0</span>   <span class="token number">6.0</span>   <span class="token number">7.0</span><span class="token number">2</span>  <span class="token number">8.0</span>  <span class="token number">9.0</span>  <span class="token number">10.0</span>  <span class="token number">11.0</span>In <span class="token punctuation">[</span><span class="token number">169</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df2Out<span class="token punctuation">[</span><span class="token number">169</span><span class="token punctuation">]</span><span class="token punctuation">:</span>       a     b     c     d     e<span class="token number">0</span>   <span class="token number">0.0</span>   <span class="token number">1.0</span>   <span class="token number">2.0</span>   <span class="token number">3.0</span>   <span class="token number">4.0</span><span class="token number">1</span>   <span class="token number">5.0</span>   NaN   <span class="token number">7.0</span>   <span class="token number">8.0</span>   <span class="token number">9.0</span><span class="token number">2</span>  <span class="token number">10.0</span>  <span class="token number">11.0</span>  <span class="token number">12.0</span>  <span class="token number">13.0</span>  <span class="token number">14.0</span><span class="token number">3</span>  <span class="token number">15.0</span>  <span class="token number">16.0</span>  <span class="token number">17.0</span>  <span class="token number">18.0</span>  <span class="token number">19.0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°†å®ƒä»¬ç›¸åŠ æ—¶ï¼Œæ²¡æœ‰é‡å çš„ä½ç½®å°±ä¼šäº§ç”ŸNAå€¼ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">170</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df1 <span class="token operator">+</span> df2Out<span class="token punctuation">[</span><span class="token number">170</span><span class="token punctuation">]</span><span class="token punctuation">:</span>       a     b     c     d   e<span class="token number">0</span>   <span class="token number">0.0</span>   <span class="token number">2.0</span>   <span class="token number">4.0</span>   <span class="token number">6.0</span> NaN<span class="token number">1</span>   <span class="token number">9.0</span>   NaN  <span class="token number">13.0</span>  <span class="token number">15.0</span> NaN<span class="token number">2</span>  <span class="token number">18.0</span>  <span class="token number">20.0</span>  <span class="token number">22.0</span>  <span class="token number">24.0</span> NaN<span class="token number">3</span>   NaN   NaN   NaN   NaN NaN<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨df1çš„addæ–¹æ³•ï¼Œä¼ å…¥df2ä»¥åŠä¸€ä¸ªfill_valueå‚æ•°ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">171</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df1<span class="token punctuation">.</span>add<span class="token punctuation">(</span>df2<span class="token punctuation">,</span> fill_value<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">171</span><span class="token punctuation">]</span><span class="token punctuation">:</span>       a     b     c     d     e0   <span class="token number">0.0</span>   <span class="token number">2.0</span>   <span class="token number">4.0</span>   <span class="token number">6.0</span>   <span class="token number">4.01</span>   <span class="token number">9.0</span>   <span class="token number">5.0</span>  <span class="token number">13.0</span>  <span class="token number">15.0</span>   <span class="token number">9.02</span>  <span class="token number">18.0</span>  <span class="token number">20.0</span>  <span class="token number">22.0</span>  <span class="token number">24.0</span>  <span class="token number">14.03</span>  <span class="token number">15.0</span>  <span class="token number">16.0</span>  <span class="token number">17.0</span>  <span class="token number">18.0</span>  <span class="token number">19.0</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¡¨5-5åˆ—å‡ºäº†Serieså’ŒDataFrameçš„ç®—æœ¯æ–¹æ³•ã€‚å®ƒä»¬æ¯ä¸ªéƒ½æœ‰ä¸€ä¸ªå‰¯æœ¬ï¼Œä»¥å­—æ¯rå¼€å¤´ï¼Œå®ƒä¼šç¿»è½¬å‚æ•°ã€‚å› æ­¤è¿™ä¸¤ä¸ªè¯­å¥æ˜¯ç­‰ä»·çš„ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">172</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">1</span> <span class="token operator">/</span> df1Out<span class="token punctuation">[</span><span class="token number">172</span><span class="token punctuation">]</span><span class="token punctuation">:</span>           a         b         c         d0       inf  <span class="token number">1.000000</span>  <span class="token number">0.500000</span>  <span class="token number">0.3333331</span>  <span class="token number">0.250000</span>  <span class="token number">0.200000</span>  <span class="token number">0.166667</span>  <span class="token number">0.1428572</span>  <span class="token number">0.125000</span>  <span class="token number">0.111111</span>  <span class="token number">0.100000</span>  <span class="token number">0.</span>090909In <span class="token punctuation">[</span><span class="token number">173</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df1<span class="token punctuation">.</span>rdiv<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">173</span><span class="token punctuation">]</span><span class="token punctuation">:</span>           a         b         c         d0       inf  <span class="token number">1.000000</span>  <span class="token number">0.500000</span>  <span class="token number">0.3333331</span>  <span class="token number">0.250000</span>  <span class="token number">0.200000</span>  <span class="token number">0.166667</span>  <span class="token number">0.1428572</span>  <span class="token number">0.125000</span>  <span class="token number">0.111111</span>  <span class="token number">0.100000</span>  <span class="token number">0.090909</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://upload-images.jianshu.io/upload_images/7178691-16857a1021f98d1f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è¡¨5-5 çµæ´»çš„ç®—æœ¯æ–¹æ³•"></p><p>ä¸æ­¤ç±»ä¼¼ï¼Œåœ¨å¯¹Seriesæˆ–DataFrameé‡æ–°ç´¢å¼•æ—¶ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šä¸€ä¸ªå¡«å……å€¼ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">174</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df1<span class="token punctuation">.</span>reindex<span class="token punctuation">(</span>columns<span class="token operator">=</span>df2<span class="token punctuation">.</span>columns<span class="token punctuation">,</span> fill_value<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">174</span><span class="token punctuation">]</span><span class="token punctuation">:</span>      a    b     c     d  e0  <span class="token number">0.0</span>  <span class="token number">1.0</span>   <span class="token number">2.0</span>   <span class="token number">3.0</span>  <span class="token number">01</span>  <span class="token number">4.0</span>  <span class="token number">5.0</span>   <span class="token number">6.0</span>   <span class="token number">7.0</span>  <span class="token number">02</span>  <span class="token number">8.0</span>  <span class="token number">9.0</span>  <span class="token number">10.0</span>  <span class="token number">11.0</span>  <span class="token number">0</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="DataFrameå’ŒSeriesä¹‹é—´çš„è¿ç®—"><a href="#DataFrameå’ŒSeriesä¹‹é—´çš„è¿ç®—" class="headerlink" title="DataFrameå’ŒSeriesä¹‹é—´çš„è¿ç®—"></a>DataFrameå’ŒSeriesä¹‹é—´çš„è¿ç®—</h2><p>è·Ÿä¸åŒç»´åº¦çš„NumPyæ•°ç»„ä¸€æ ·ï¼ŒDataFrameå’ŒSeriesä¹‹é—´ç®—æœ¯è¿ç®—ä¹Ÿæ˜¯æœ‰æ˜ç¡®è§„å®šçš„ã€‚å…ˆæ¥çœ‹ä¸€ä¸ªå…·æœ‰å¯å‘æ€§çš„ä¾‹å­ï¼Œè®¡ç®—ä¸€ä¸ªäºŒç»´æ•°ç»„ä¸å…¶æŸè¡Œä¹‹é—´çš„å·®ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">175</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">176</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arrOut<span class="token punctuation">[</span><span class="token number">176</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span>   <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span>   <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span>   <span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span>  <span class="token number">4</span><span class="token punctuation">.</span><span class="token punctuation">,</span>   <span class="token number">5</span><span class="token punctuation">.</span><span class="token punctuation">,</span>   <span class="token number">6</span><span class="token punctuation">.</span><span class="token punctuation">,</span>   <span class="token number">7</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span>  <span class="token number">8</span><span class="token punctuation">.</span><span class="token punctuation">,</span>   <span class="token number">9</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">10</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">11</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">177</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">177</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">178</span><span class="token punctuation">]</span><span class="token punctuation">:</span> arr <span class="token operator">-</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">178</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">8</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å½“æˆ‘ä»¬ä»arrå‡å»arr[0]ï¼Œæ¯ä¸€è¡Œéƒ½ä¼šæ‰§è¡Œè¿™ä¸ªæ“ä½œã€‚è¿™å°±å«åšå¹¿æ’­ï¼ˆbroadcastingï¼‰ï¼Œé™„å½•Aå°†å¯¹æ­¤è¿›è¡Œè¯¦ç»†è®²è§£ã€‚DataFrameå’ŒSeriesä¹‹é—´çš„è¿ç®—å·®ä¸å¤šä¹Ÿæ˜¯å¦‚æ­¤ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">179</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>                      columns<span class="token operator">=</span>list<span class="token punctuation">(</span><span class="token string">'bde'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>                      index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Utah'</span><span class="token punctuation">,</span> <span class="token string">'Ohio'</span><span class="token punctuation">,</span> <span class="token string">'Texas'</span><span class="token punctuation">,</span> <span class="token string">'Oregon'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">180</span><span class="token punctuation">]</span><span class="token punctuation">:</span> series <span class="token operator">=</span> frame<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>In <span class="token punctuation">[</span><span class="token number">181</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frameOut<span class="token punctuation">[</span><span class="token number">181</span><span class="token punctuation">]</span><span class="token punctuation">:</span>           b     d     eUtah    <span class="token number">0.0</span>   <span class="token number">1.0</span>   <span class="token number">2.</span>0Ohio    <span class="token number">3.0</span>   <span class="token number">4.0</span>   <span class="token number">5.</span>0Texas   <span class="token number">6.0</span>   <span class="token number">7.0</span>   <span class="token number">8.</span>0Oregon  <span class="token number">9.0</span>  <span class="token number">10.0</span>  <span class="token number">11.</span>0In <span class="token punctuation">[</span><span class="token number">182</span><span class="token punctuation">]</span><span class="token punctuation">:</span> seriesOut<span class="token punctuation">[</span><span class="token number">182</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b    <span class="token number">0.</span><span class="token number">0d</span>    <span class="token number">1.</span><span class="token number">0e</span>    <span class="token number">2.</span>0Name<span class="token punctuation">:</span> Utah<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒDataFrameå’ŒSeriesä¹‹é—´çš„ç®—æœ¯è¿ç®—ä¼šå°†Seriesçš„ç´¢å¼•åŒ¹é…åˆ°DataFrameçš„åˆ—ï¼Œç„¶åæ²¿ç€è¡Œä¸€ç›´å‘ä¸‹å¹¿æ’­ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">183</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame <span class="token operator">-</span> seriesOut<span class="token punctuation">[</span><span class="token number">183</span><span class="token punctuation">]</span><span class="token punctuation">:</span>           b    d    eUtah    <span class="token number">0.0</span>  <span class="token number">0.0</span>  <span class="token number">0.</span>0Ohio    <span class="token number">3.0</span>  <span class="token number">3.0</span>  <span class="token number">3.</span>0Texas   <span class="token number">6.0</span>  <span class="token number">6.0</span>  <span class="token number">6.</span>0Oregon  <span class="token number">9.0</span>  <span class="token number">9.0</span>  <span class="token number">9.0</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœæŸä¸ªç´¢å¼•å€¼åœ¨DataFrameçš„åˆ—æˆ–Seriesçš„ç´¢å¼•ä¸­æ‰¾ä¸åˆ°ï¼Œåˆ™å‚ä¸è¿ç®—çš„ä¸¤ä¸ªå¯¹è±¡å°±ä¼šè¢«é‡æ–°ç´¢å¼•ä»¥å½¢æˆå¹¶é›†ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">184</span><span class="token punctuation">]</span><span class="token punctuation">:</span> series2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>range<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">,</span> <span class="token string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">185</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame <span class="token operator">+</span> series2Out<span class="token punctuation">[</span><span class="token number">185</span><span class="token punctuation">]</span><span class="token punctuation">:</span>           b   d     e   fUtah    <span class="token number">0.0</span> NaN   <span class="token number">3.0</span> NaNOhio    <span class="token number">3.0</span> NaN   <span class="token number">6.0</span> NaNTexas   <span class="token number">6.0</span> NaN   <span class="token number">9.0</span> NaNOregon  <span class="token number">9.0</span> NaN  <span class="token number">12.0</span> NaN<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœä½ å¸Œæœ›åŒ¹é…è¡Œä¸”åœ¨åˆ—ä¸Šå¹¿æ’­ï¼Œåˆ™å¿…é¡»ä½¿ç”¨ç®—æœ¯è¿ç®—æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">186</span><span class="token punctuation">]</span><span class="token punctuation">:</span> series3 <span class="token operator">=</span> frame<span class="token punctuation">[</span><span class="token string">'d'</span><span class="token punctuation">]</span>In <span class="token punctuation">[</span><span class="token number">187</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frameOut<span class="token punctuation">[</span><span class="token number">187</span><span class="token punctuation">]</span><span class="token punctuation">:</span>           b     d     eUtah    <span class="token number">0.0</span>   <span class="token number">1.0</span>   <span class="token number">2.0</span>Ohio    <span class="token number">3.0</span>   <span class="token number">4.0</span>   <span class="token number">5.0</span>Texas   <span class="token number">6.0</span>   <span class="token number">7.0</span>   <span class="token number">8.0</span>Oregon  <span class="token number">9.0</span>  <span class="token number">10.0</span>  <span class="token number">11.0</span>In <span class="token punctuation">[</span><span class="token number">188</span><span class="token punctuation">]</span><span class="token punctuation">:</span> series3Out<span class="token punctuation">[</span><span class="token number">188</span><span class="token punctuation">]</span><span class="token punctuation">:</span> Utah       <span class="token number">1.0</span>Ohio       <span class="token number">4.0</span>Texas      <span class="token number">7.0</span>Oregon    <span class="token number">10.0</span>Name<span class="token punctuation">:</span> d<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> float64In <span class="token punctuation">[</span><span class="token number">189</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame<span class="token punctuation">.</span>sub<span class="token punctuation">(</span>series3<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token string">'index'</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">189</span><span class="token punctuation">]</span><span class="token punctuation">:</span>           b    d    eUtah   <span class="token operator">-</span><span class="token number">1.0</span>  <span class="token number">0.0</span>  <span class="token number">1.0</span>Ohio   <span class="token operator">-</span><span class="token number">1.0</span>  <span class="token number">0.0</span>  <span class="token number">1.0</span>Texas  <span class="token operator">-</span><span class="token number">1.0</span>  <span class="token number">0.0</span>  <span class="token number">1.0</span>Oregon <span class="token operator">-</span><span class="token number">1.0</span>  <span class="token number">0.0</span>  <span class="token number">1.0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¼ å…¥çš„è½´å·å°±æ˜¯å¸Œæœ›åŒ¹é…çš„è½´ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯åŒ¹é…DataFrameçš„è¡Œç´¢å¼•ï¼ˆaxis=â€™indexâ€™ or axis=0ï¼‰å¹¶è¿›è¡Œå¹¿æ’­ã€‚</p><h2 id="å‡½æ•°åº”ç”¨å’Œæ˜ å°„"><a href="#å‡½æ•°åº”ç”¨å’Œæ˜ å°„" class="headerlink" title="å‡½æ•°åº”ç”¨å’Œæ˜ å°„"></a>å‡½æ•°åº”ç”¨å’Œæ˜ å°„</h2><p>NumPyçš„ufuncsï¼ˆå…ƒç´ çº§æ•°ç»„æ–¹æ³•ï¼‰ä¹Ÿå¯ç”¨äºæ“ä½œpandaså¯¹è±¡ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">190</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span>list<span class="token punctuation">(</span><span class="token string">'bde'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>                      index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Utah'</span><span class="token punctuation">,</span> <span class="token string">'Ohio'</span><span class="token punctuation">,</span> <span class="token string">'Texas'</span><span class="token punctuation">,</span> <span class="token string">'Oregon'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">191</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frameOut<span class="token punctuation">[</span><span class="token number">191</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                b         d         eUtah   <span class="token operator">-</span><span class="token number">0.204708</span>  <span class="token number">0.478943</span> <span class="token operator">-</span><span class="token number">0.519439</span>Ohio   <span class="token operator">-</span><span class="token number">0.555730</span>  <span class="token number">1.965781</span>  <span class="token number">1.393406</span>Texas   <span class="token number">0.092908</span>  <span class="token number">0.281746</span>  <span class="token number">0.769023</span>Oregon  <span class="token number">1.246435</span>  <span class="token number">1.007189</span> <span class="token operator">-</span><span class="token number">1.296221</span>In <span class="token punctuation">[</span><span class="token number">192</span><span class="token punctuation">]</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>abs<span class="token punctuation">(</span>frame<span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">192</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                b         d         eUtah    <span class="token number">0.204708</span>  <span class="token number">0.478943</span>  <span class="token number">0.519439</span>Ohio    <span class="token number">0.555730</span>  <span class="token number">1.965781</span>  <span class="token number">1.393406</span>Texas   <span class="token number">0.092908</span>  <span class="token number">0.281746</span>  <span class="token number">0.769023</span>Oregon  <span class="token number">1.246435</span>  <span class="token number">1.007189</span>  <span class="token number">1.296221</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦ä¸€ä¸ªå¸¸è§çš„æ“ä½œæ˜¯ï¼Œå°†å‡½æ•°åº”ç”¨åˆ°ç”±å„åˆ—æˆ–è¡Œæ‰€å½¢æˆçš„ä¸€ç»´æ•°ç»„ä¸Šã€‚DataFrameçš„applyæ–¹æ³•å³å¯å®ç°æ­¤åŠŸèƒ½ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">193</span><span class="token punctuation">]</span><span class="token punctuation">:</span> f <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>max<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> x<span class="token punctuation">.</span>min<span class="token punctuation">(</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">194</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame<span class="token punctuation">.</span>apply<span class="token punctuation">(</span>f<span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">194</span><span class="token punctuation">]</span><span class="token punctuation">:</span> b    <span class="token number">1.</span><span class="token number">802165d</span>    <span class="token number">1.</span><span class="token number">684034e</span>    <span class="token number">2.</span>689627dtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™é‡Œçš„å‡½æ•°fï¼Œè®¡ç®—äº†ä¸€ä¸ªSeriesçš„æœ€å¤§å€¼å’Œæœ€å°å€¼çš„å·®ï¼Œåœ¨frameçš„æ¯åˆ—éƒ½æ‰§è¡Œäº†ä¸€æ¬¡ã€‚ç»“æœæ˜¯ä¸€ä¸ªSeriesï¼Œä½¿ç”¨frameçš„åˆ—ä½œä¸ºç´¢å¼•ã€‚</p><p>å¦‚æœä¼ é€’axis=â€™columnsâ€™åˆ°applyï¼Œè¿™ä¸ªå‡½æ•°ä¼šåœ¨æ¯è¡Œæ‰§è¡Œï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">195</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame<span class="token punctuation">.</span>apply<span class="token punctuation">(</span>f<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token string">'columns'</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">195</span><span class="token punctuation">]</span><span class="token punctuation">:</span>Utah      <span class="token number">0.</span>998382Ohio      <span class="token number">2.</span>521511Texas     <span class="token number">0.</span>676115Oregon    <span class="token number">2.</span>542656dtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è®¸å¤šæœ€ä¸ºå¸¸è§çš„æ•°ç»„ç»Ÿè®¡åŠŸèƒ½éƒ½è¢«å®ç°æˆDataFrameçš„æ–¹æ³•ï¼ˆå¦‚sumå’Œmeanï¼‰ï¼Œå› æ­¤æ— éœ€ä½¿ç”¨applyæ–¹æ³•ã€‚</p><p>ä¼ é€’åˆ°applyçš„å‡½æ•°ä¸æ˜¯å¿…é¡»è¿”å›ä¸€ä¸ªæ ‡é‡ï¼Œè¿˜å¯ä»¥è¿”å›ç”±å¤šä¸ªå€¼ç»„æˆçš„Seriesï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">196</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>     <span class="token keyword">return</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">.</span>min<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x<span class="token punctuation">.</span>max<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'min'</span><span class="token punctuation">,</span> <span class="token string">'max'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">197</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame<span class="token punctuation">.</span>apply<span class="token punctuation">(</span>f<span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">197</span><span class="token punctuation">]</span><span class="token punctuation">:</span>             b         d         emin <span class="token operator">-</span><span class="token number">0.555730</span>  <span class="token number">0.281746</span> <span class="token operator">-</span><span class="token number">1.</span>296221max  <span class="token number">1.246435</span>  <span class="token number">1.965781</span>  <span class="token number">1.393406</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å…ƒç´ çº§çš„Pythonå‡½æ•°ä¹Ÿæ˜¯å¯ä»¥ç”¨çš„ã€‚å‡å¦‚ä½ æƒ³å¾—åˆ°frameä¸­å„ä¸ªæµ®ç‚¹å€¼çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œä½¿ç”¨applymapå³å¯ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">198</span><span class="token punctuation">]</span><span class="token punctuation">:</span> format <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token string">'%.2f'</span> <span class="token operator">%</span> xIn <span class="token punctuation">[</span><span class="token number">199</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame<span class="token punctuation">.</span>applymap<span class="token punctuation">(</span>format<span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">199</span><span class="token punctuation">]</span><span class="token punctuation">:</span>             b     d      eUtah    <span class="token operator">-</span><span class="token number">0.20</span>  <span class="token number">0.48</span>  <span class="token operator">-</span><span class="token number">0.</span>52Ohio    <span class="token operator">-</span><span class="token number">0.56</span>  <span class="token number">1.97</span>   <span class="token number">1.</span>39Texas    <span class="token number">0.09</span>  <span class="token number">0.28</span>   <span class="token number">0.</span>77Oregon   <span class="token number">1.25</span>  <span class="token number">1.01</span>  <span class="token operator">-</span><span class="token number">1.30</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¹‹æ‰€ä»¥å«åšapplymapï¼Œæ˜¯å› ä¸ºSeriesæœ‰ä¸€ä¸ªç”¨äºåº”ç”¨å…ƒç´ çº§å‡½æ•°çš„mapæ–¹æ³•ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame<span class="token punctuation">[</span><span class="token string">'e'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>map<span class="token punctuation">(</span>format<span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">]</span><span class="token punctuation">:</span> Utah      <span class="token operator">-</span><span class="token number">0.</span>52Ohio       <span class="token number">1.</span>39Texas      <span class="token number">0.</span>77Oregon    <span class="token operator">-</span><span class="token number">1.</span>30Name<span class="token punctuation">:</span> e<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> object<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="æ’åºå’Œæ’å"><a href="#æ’åºå’Œæ’å" class="headerlink" title="æ’åºå’Œæ’å"></a>æ’åºå’Œæ’å</h2><p>æ ¹æ®æ¡ä»¶å¯¹æ•°æ®é›†æ’åºï¼ˆsortingï¼‰ä¹Ÿæ˜¯ä¸€ç§é‡è¦çš„å†…ç½®è¿ç®—ã€‚è¦å¯¹è¡Œæˆ–åˆ—ç´¢å¼•è¿›è¡Œæ’åºï¼ˆæŒ‰å­—å…¸é¡ºåºï¼‰ï¼Œå¯ä½¿ç”¨sort_indexæ–¹æ³•ï¼Œå®ƒå°†è¿”å›ä¸€ä¸ªå·²æ’åºçš„æ–°å¯¹è±¡ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">201</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>range<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">202</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">202</span><span class="token punctuation">]</span><span class="token punctuation">:</span>a    <span class="token number">1b</span>    <span class="token number">2c</span>    <span class="token number">3d</span>    0dtype<span class="token punctuation">:</span> int64<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯¹äºDataFrameï¼Œåˆ™å¯ä»¥æ ¹æ®ä»»æ„ä¸€ä¸ªè½´ä¸Šçš„ç´¢å¼•è¿›è¡Œæ’åºï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">203</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>                      index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'three'</span><span class="token punctuation">,</span> <span class="token string">'one'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>                      columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">204</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">204</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        d  a  b  cone    <span class="token number">4</span>  <span class="token number">5</span>  <span class="token number">6</span>  7three  <span class="token number">0</span>  <span class="token number">1</span>  <span class="token number">2</span>  3In <span class="token punctuation">[</span><span class="token number">205</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">205</span><span class="token punctuation">]</span><span class="token punctuation">:</span>       a  b  c  dthree  <span class="token number">1</span>  <span class="token number">2</span>  <span class="token number">3</span>  0one    <span class="token number">5</span>  <span class="token number">6</span>  <span class="token number">7</span>  <span class="token number">4</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ•°æ®é»˜è®¤æ˜¯æŒ‰å‡åºæ’åºçš„ï¼Œä½†ä¹Ÿå¯ä»¥é™åºæ’åºï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">206</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">206</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        d  c  b  athree  <span class="token number">0</span>  <span class="token number">3</span>  <span class="token number">2</span>  <span class="token number">1</span>one    <span class="token number">4</span>  <span class="token number">7</span>  <span class="token number">6</span>  <span class="token number">5</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è‹¥è¦æŒ‰å€¼å¯¹Seriesè¿›è¡Œæ’åºï¼Œå¯ä½¿ç”¨å…¶sort_valuesæ–¹æ³•ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">207</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">208</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">208</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">2</span>   <span class="token operator">-</span><span class="token number">3</span><span class="token number">3</span>    <span class="token number">2</span><span class="token number">0</span>    <span class="token number">4</span><span class="token number">1</span>    <span class="token number">7</span>dtype<span class="token punctuation">:</span> int64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨æ’åºæ—¶ï¼Œä»»ä½•ç¼ºå¤±å€¼é»˜è®¤éƒ½ä¼šè¢«æ”¾åˆ°Seriesçš„æœ«å°¾ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">209</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">210</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">210</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">4</span>   <span class="token operator">-</span><span class="token number">3.0</span><span class="token number">5</span>    <span class="token number">2.0</span><span class="token number">0</span>    <span class="token number">4.0</span><span class="token number">2</span>    <span class="token number">7.0</span><span class="token number">1</span>    NaN<span class="token number">3</span>    NaNdtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å½“æ’åºä¸€ä¸ªDataFrameæ—¶ï¼Œä½ å¯èƒ½å¸Œæœ›æ ¹æ®ä¸€ä¸ªæˆ–å¤šä¸ªåˆ—ä¸­çš„å€¼è¿›è¡Œæ’åºã€‚å°†ä¸€ä¸ªæˆ–å¤šä¸ªåˆ—çš„åå­—ä¼ é€’ç»™sort_valuesçš„byé€‰é¡¹å³å¯è¾¾åˆ°è¯¥ç›®çš„ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">211</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">212</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frameOut<span class="token punctuation">[</span><span class="token number">212</span><span class="token punctuation">]</span><span class="token punctuation">:</span>    a  b<span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">4</span><span class="token number">1</span>  <span class="token number">1</span>  <span class="token number">7</span><span class="token number">2</span>  <span class="token number">0</span> <span class="token operator">-</span><span class="token number">3</span><span class="token number">3</span>  <span class="token number">1</span>  <span class="token number">2</span>In <span class="token punctuation">[</span><span class="token number">213</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'b'</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">213</span><span class="token punctuation">]</span><span class="token punctuation">:</span>    a  b<span class="token number">2</span>  <span class="token number">0</span> <span class="token operator">-</span><span class="token number">3</span><span class="token number">3</span>  <span class="token number">1</span>  <span class="token number">2</span><span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">4</span><span class="token number">1</span>  <span class="token number">1</span>  <span class="token number">7</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¦æ ¹æ®å¤šä¸ªåˆ—è¿›è¡Œæ’åºï¼Œä¼ å…¥åç§°çš„åˆ—è¡¨å³å¯ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">214</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">214</span><span class="token punctuation">]</span><span class="token punctuation">:</span>    a  b<span class="token number">2</span>  <span class="token number">0</span> <span class="token operator">-</span><span class="token number">3</span><span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">4</span><span class="token number">3</span>  <span class="token number">1</span>  <span class="token number">2</span><span class="token number">1</span>  <span class="token number">1</span>  <span class="token number">7</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ’åä¼šä»1å¼€å§‹ä¸€ç›´åˆ°æ•°ç»„ä¸­æœ‰æ•ˆæ•°æ®çš„æ•°é‡ã€‚æ¥ä¸‹æ¥ä»‹ç»Serieså’ŒDataFrameçš„rankæ–¹æ³•ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œrankæ˜¯é€šè¿‡â€œä¸ºå„ç»„åˆ†é…ä¸€ä¸ªå¹³å‡æ’åâ€çš„æ–¹å¼ç ´åå¹³çº§å…³ç³»çš„ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">215</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">216</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj<span class="token punctuation">.</span>rank<span class="token punctuation">(</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">216</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">0</span>    <span class="token number">6.5</span><span class="token number">1</span>    <span class="token number">1.0</span><span class="token number">2</span>    <span class="token number">6.5</span><span class="token number">3</span>    <span class="token number">4.5</span><span class="token number">4</span>    <span class="token number">3.0</span><span class="token number">5</span>    <span class="token number">2.0</span><span class="token number">6</span>    <span class="token number">4.5</span>dtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¹Ÿå¯ä»¥æ ¹æ®å€¼åœ¨åŸæ•°æ®ä¸­å‡ºç°çš„é¡ºåºç»™å‡ºæ’åï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">217</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj<span class="token punctuation">.</span>rank<span class="token punctuation">(</span>method<span class="token operator">=</span><span class="token string">'first'</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">217</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">0</span>    <span class="token number">6.0</span><span class="token number">1</span>    <span class="token number">1.0</span><span class="token number">2</span>    <span class="token number">7.0</span><span class="token number">3</span>    <span class="token number">4.0</span><span class="token number">4</span>    <span class="token number">3.0</span><span class="token number">5</span>    <span class="token number">2.0</span><span class="token number">6</span>    <span class="token number">5.0</span>dtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œï¼Œæ¡ç›®0å’Œ2æ²¡æœ‰ä½¿ç”¨å¹³å‡æ’å6.5ï¼Œå®ƒä»¬è¢«è®¾æˆäº†6å’Œ7ï¼Œå› ä¸ºæ•°æ®ä¸­æ ‡ç­¾0ä½äºæ ‡ç­¾2çš„å‰é¢ã€‚</p><p>ä½ ä¹Ÿå¯ä»¥æŒ‰é™åºè¿›è¡Œæ’åï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Assign tie values the maximum rank in the group</span>In <span class="token punctuation">[</span><span class="token number">218</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj<span class="token punctuation">.</span>rank<span class="token punctuation">(</span>ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token string">'max'</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">218</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">0</span>    <span class="token number">2.0</span><span class="token number">1</span>    <span class="token number">7.0</span><span class="token number">2</span>    <span class="token number">2.0</span><span class="token number">3</span>    <span class="token number">4.0</span><span class="token number">4</span>    <span class="token number">5.0</span><span class="token number">5</span>    <span class="token number">6.0</span><span class="token number">6</span>    <span class="token number">4.0</span>dtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¡¨5-6åˆ—å‡ºäº†æ‰€æœ‰ç”¨äºç ´åå¹³çº§å…³ç³»çš„methodé€‰é¡¹ã€‚DataFrameå¯ä»¥åœ¨è¡Œæˆ–åˆ—ä¸Šè®¡ç®—æ’åï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">219</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4.3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>                       <span class="token string">'c'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.5</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">220</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frameOut<span class="token punctuation">[</span><span class="token number">220</span><span class="token punctuation">]</span><span class="token punctuation">:</span>    a    b    c<span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">4.3</span> <span class="token operator">-</span><span class="token number">2.0</span><span class="token number">1</span>  <span class="token number">1</span>  <span class="token number">7.0</span>  <span class="token number">5.0</span><span class="token number">2</span>  <span class="token number">0</span> <span class="token operator">-</span><span class="token number">3.0</span>  <span class="token number">8.0</span><span class="token number">3</span>  <span class="token number">1</span>  <span class="token number">2.0</span> <span class="token operator">-</span><span class="token number">2.5</span>In <span class="token punctuation">[</span><span class="token number">221</span><span class="token punctuation">]</span><span class="token punctuation">:</span> frame<span class="token punctuation">.</span>rank<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token string">'columns'</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">221</span><span class="token punctuation">]</span><span class="token punctuation">:</span>      a    b    c<span class="token number">0</span>  <span class="token number">2.0</span>  <span class="token number">3.0</span>  <span class="token number">1.0</span><span class="token number">1</span>  <span class="token number">1.0</span>  <span class="token number">3.0</span>  <span class="token number">2.0</span><span class="token number">2</span>  <span class="token number">2.0</span>  <span class="token number">1.0</span>  <span class="token number">3.0</span><span class="token number">3</span>  <span class="token number">2.0</span>  <span class="token number">3.0</span>  <span class="token number">1.0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://upload-images.jianshu.io/upload_images/7178691-7edfab5b4a147581.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è¡¨5-6 æ’åæ—¶ç”¨äºç ´åå¹³çº§å…³ç³»çš„æ–¹æ³•"></p><h2 id="å¸¦æœ‰é‡å¤æ ‡ç­¾çš„è½´ç´¢å¼•"><a href="#å¸¦æœ‰é‡å¤æ ‡ç­¾çš„è½´ç´¢å¼•" class="headerlink" title="å¸¦æœ‰é‡å¤æ ‡ç­¾çš„è½´ç´¢å¼•"></a>å¸¦æœ‰é‡å¤æ ‡ç­¾çš„è½´ç´¢å¼•</h2><p>ç›´åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘æ‰€ä»‹ç»çš„æ‰€æœ‰èŒƒä¾‹éƒ½æœ‰ç€å”¯ä¸€çš„è½´æ ‡ç­¾ï¼ˆç´¢å¼•å€¼ï¼‰ã€‚è™½ç„¶è®¸å¤špandaså‡½æ•°ï¼ˆå¦‚reindexï¼‰éƒ½è¦æ±‚æ ‡ç­¾å”¯ä¸€ï¼Œä½†è¿™å¹¶ä¸æ˜¯å¼ºåˆ¶æ€§çš„ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ä¸‹é¢è¿™ä¸ªç®€å•çš„å¸¦æœ‰é‡å¤ç´¢å¼•å€¼çš„Seriesï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">222</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>range<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">223</span><span class="token punctuation">]</span><span class="token punctuation">:</span> objOut<span class="token punctuation">[</span><span class="token number">223</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a    <span class="token number">0</span>a    <span class="token number">1</span>b    <span class="token number">2</span>b    <span class="token number">3</span>c    <span class="token number">4</span>dtype<span class="token punctuation">:</span> int64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç´¢å¼•çš„is_uniqueå±æ€§å¯ä»¥å‘Šè¯‰ä½ å®ƒçš„å€¼æ˜¯å¦æ˜¯å”¯ä¸€çš„ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">224</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj<span class="token punctuation">.</span>index<span class="token punctuation">.</span>is_uniqueOut<span class="token punctuation">[</span><span class="token number">224</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¯¹äºå¸¦æœ‰é‡å¤å€¼çš„ç´¢å¼•ï¼Œæ•°æ®é€‰å–çš„è¡Œä¸ºå°†ä¼šæœ‰äº›ä¸åŒã€‚å¦‚æœæŸä¸ªç´¢å¼•å¯¹åº”å¤šä¸ªå€¼ï¼Œåˆ™è¿”å›ä¸€ä¸ªSeriesï¼›è€Œå¯¹åº”å•ä¸ªå€¼çš„ï¼Œåˆ™è¿”å›ä¸€ä¸ªæ ‡é‡å€¼ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">225</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">225</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a    <span class="token number">0</span>a    <span class="token number">1</span>dtype<span class="token punctuation">:</span> int64In <span class="token punctuation">[</span><span class="token number">226</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj<span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">226</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">4</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·ä¼šä½¿ä»£ç å˜å¤æ‚ï¼Œå› ä¸ºç´¢å¼•çš„è¾“å‡ºç±»å‹ä¼šæ ¹æ®æ ‡ç­¾æ˜¯å¦æœ‰é‡å¤å‘ç”Ÿå˜åŒ–ã€‚</p><p>å¯¹DataFrameçš„è¡Œè¿›è¡Œç´¢å¼•æ—¶ä¹Ÿæ˜¯å¦‚æ­¤ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">227</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">228</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dfOut<span class="token punctuation">[</span><span class="token number">228</span><span class="token punctuation">]</span><span class="token punctuation">:</span>           <span class="token number">0</span>         <span class="token number">1</span>         <span class="token number">2</span>a  <span class="token number">0.274992</span>  <span class="token number">0.228913</span>  <span class="token number">1.352917</span>a  <span class="token number">0.886429</span> <span class="token operator">-</span><span class="token number">2.001637</span> <span class="token operator">-</span><span class="token number">0.371843</span>b  <span class="token number">1.669025</span> <span class="token operator">-</span><span class="token number">0.438570</span> <span class="token operator">-</span><span class="token number">0.539741</span>b  <span class="token number">0.476985</span>  <span class="token number">3.248944</span> <span class="token operator">-</span><span class="token number">1.021228</span>In <span class="token punctuation">[</span><span class="token number">229</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">229</span><span class="token punctuation">]</span><span class="token punctuation">:</span>           <span class="token number">0</span>         <span class="token number">1</span>         <span class="token number">2</span>b  <span class="token number">1.669025</span> <span class="token operator">-</span><span class="token number">0.438570</span> <span class="token operator">-</span><span class="token number">0.539741</span>b  <span class="token number">0.476985</span>  <span class="token number">3.248944</span> <span class="token operator">-</span><span class="token number">1.021228</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="5-3-æ±‡æ€»å’Œè®¡ç®—æè¿°ç»Ÿè®¡"><a href="#5-3-æ±‡æ€»å’Œè®¡ç®—æè¿°ç»Ÿè®¡" class="headerlink" title="5.3 æ±‡æ€»å’Œè®¡ç®—æè¿°ç»Ÿè®¡"></a>5.3 æ±‡æ€»å’Œè®¡ç®—æè¿°ç»Ÿè®¡</h1><p>pandaså¯¹è±¡æ‹¥æœ‰ä¸€ç»„å¸¸ç”¨çš„æ•°å­¦å’Œç»Ÿè®¡æ–¹æ³•ã€‚å®ƒä»¬å¤§éƒ¨åˆ†éƒ½å±äºçº¦ç®€å’Œæ±‡æ€»ç»Ÿè®¡ï¼Œç”¨äºä»Seriesä¸­æå–å•ä¸ªå€¼ï¼ˆå¦‚sumæˆ–meanï¼‰æˆ–ä»DataFrameçš„è¡Œæˆ–åˆ—ä¸­æå–ä¸€ä¸ªSeriesã€‚è·Ÿå¯¹åº”çš„NumPyæ•°ç»„æ–¹æ³•ç›¸æ¯”ï¼Œå®ƒä»¬éƒ½æ˜¯åŸºäºæ²¡æœ‰ç¼ºå¤±æ•°æ®çš„å‡è®¾è€Œæ„å»ºçš„ã€‚çœ‹ä¸€ä¸ªç®€å•çš„DataFrameï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">230</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1.4</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>nan<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7.1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">4.5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>                    <span class="token punctuation">[</span>np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span> np<span class="token punctuation">.</span>nan<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>                   index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>                   columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">231</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dfOut<span class="token punctuation">[</span><span class="token number">231</span><span class="token punctuation">]</span><span class="token punctuation">:</span>     one  twoa  <span class="token number">1.40</span>  NaNb  <span class="token number">7.10</span> <span class="token operator">-</span><span class="token number">4.5</span>c   NaN  NaNd  <span class="token number">0.75</span> <span class="token operator">-</span><span class="token number">1.3</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è°ƒç”¨DataFrameçš„sumæ–¹æ³•å°†ä¼šè¿”å›ä¸€ä¸ªå«æœ‰åˆ—çš„å’Œçš„Seriesï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">232</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df<span class="token punctuation">.</span>sum<span class="token punctuation">(</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">232</span><span class="token punctuation">]</span><span class="token punctuation">:</span> one    <span class="token number">9.25</span>two   <span class="token operator">-</span><span class="token number">5.80</span>dtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¼ å…¥axis=â€™columnsâ€™æˆ–axis=1å°†ä¼šæŒ‰è¡Œè¿›è¡Œæ±‚å’Œè¿ç®—ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">233</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">233</span><span class="token punctuation">]</span><span class="token punctuation">:</span>a    <span class="token number">1.40</span>b    <span class="token number">2.60</span>c     NaNd   <span class="token operator">-</span><span class="token number">0.55</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>NAå€¼ä¼šè‡ªåŠ¨è¢«æ’é™¤ï¼Œé™¤éæ•´ä¸ªåˆ‡ç‰‡ï¼ˆè¿™é‡ŒæŒ‡çš„æ˜¯è¡Œæˆ–åˆ—ï¼‰éƒ½æ˜¯NAã€‚é€šè¿‡skipnaé€‰é¡¹å¯ä»¥ç¦ç”¨è¯¥åŠŸèƒ½ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">234</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token string">'columns'</span><span class="token punctuation">,</span> skipna<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">234</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a      NaNb    <span class="token number">1.300</span>c      NaNd   <span class="token operator">-</span><span class="token number">0.275</span>dtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¡¨5-7åˆ—å‡ºäº†è¿™äº›çº¦ç®€æ–¹æ³•çš„å¸¸ç”¨é€‰é¡¹ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://upload-images.jianshu.io/upload_images/7178691-af35e3809278410e.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><p>æœ‰äº›æ–¹æ³•ï¼ˆå¦‚idxminå’Œidxmaxï¼‰è¿”å›çš„æ˜¯é—´æ¥ç»Ÿè®¡ï¼ˆæ¯”å¦‚è¾¾åˆ°æœ€å°å€¼æˆ–æœ€å¤§å€¼çš„ç´¢å¼•ï¼‰ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">235</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df<span class="token punctuation">.</span>idxmax<span class="token punctuation">(</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">235</span><span class="token punctuation">]</span><span class="token punctuation">:</span> one    btwo    ddtype<span class="token punctuation">:</span> object<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦ä¸€äº›æ–¹æ³•åˆ™æ˜¯ç´¯è®¡å‹çš„ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">236</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df<span class="token punctuation">.</span>cumsum<span class="token punctuation">(</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">236</span><span class="token punctuation">]</span><span class="token punctuation">:</span>     one  twoa  <span class="token number">1.40</span>  NaNb  <span class="token number">8.50</span> <span class="token operator">-</span><span class="token number">4.5</span>c   NaN  NaNd  <span class="token number">9.25</span> <span class="token operator">-</span><span class="token number">5.8</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼Œå®ƒæ—¢ä¸æ˜¯çº¦ç®€å‹ä¹Ÿä¸æ˜¯ç´¯è®¡å‹ã€‚describeå°±æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œå®ƒç”¨äºä¸€æ¬¡æ€§äº§ç”Ÿå¤šä¸ªæ±‡æ€»ç»Ÿè®¡ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">237</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">237</span><span class="token punctuation">]</span><span class="token punctuation">:</span>             one       twocount  <span class="token number">3.000000</span>  <span class="token number">2.000000</span>mean   <span class="token number">3.083333</span> <span class="token operator">-</span><span class="token number">2.900000</span>std    <span class="token number">3.493685</span>  <span class="token number">2.262742</span>min    <span class="token number">0.750000</span> <span class="token operator">-</span><span class="token number">4.500000</span><span class="token number">25</span><span class="token operator">%</span>    <span class="token number">1.075000</span> <span class="token operator">-</span><span class="token number">3.700000</span><span class="token number">50</span><span class="token operator">%</span>    <span class="token number">1.400000</span> <span class="token operator">-</span><span class="token number">2.900000</span><span class="token number">75</span><span class="token operator">%</span>    <span class="token number">4.250000</span> <span class="token operator">-</span><span class="token number">2.100000</span>max    <span class="token number">7.100000</span> <span class="token operator">-</span><span class="token number">1.300000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯¹äºéæ•°å€¼å‹æ•°æ®ï¼Œdescribeä¼šäº§ç”Ÿå¦å¤–ä¸€ç§æ±‡æ€»ç»Ÿè®¡ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">238</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">239</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">239</span><span class="token punctuation">]</span><span class="token punctuation">:</span> count     <span class="token number">16</span>unique     <span class="token number">3</span>top        afreq       <span class="token number">8</span>dtype<span class="token punctuation">:</span> object<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¡¨5-8åˆ—å‡ºäº†æ‰€æœ‰ä¸æè¿°ç»Ÿè®¡ç›¸å…³çš„æ–¹æ³•ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://upload-images.jianshu.io/upload_images/7178691-11fa967f658ac314.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h2 id="ç›¸å…³ç³»æ•°ä¸åæ–¹å·®"><a href="#ç›¸å…³ç³»æ•°ä¸åæ–¹å·®" class="headerlink" title="ç›¸å…³ç³»æ•°ä¸åæ–¹å·®"></a>ç›¸å…³ç³»æ•°ä¸åæ–¹å·®</h2><p>æœ‰äº›æ±‡æ€»ç»Ÿè®¡ï¼ˆå¦‚ç›¸å…³ç³»æ•°å’Œåæ–¹å·®ï¼‰æ˜¯é€šè¿‡å‚æ•°å¯¹è®¡ç®—å‡ºæ¥çš„ã€‚æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªDataFrameï¼Œå®ƒä»¬çš„æ•°æ®æ¥è‡ªYahoo!Financeçš„è‚¡ç¥¨ä»·æ ¼å’Œæˆäº¤é‡ï¼Œä½¿ç”¨çš„æ˜¯pandas-datareaderåŒ…ï¼ˆå¯ä»¥ç”¨condaæˆ–pipå®‰è£…ï¼‰ï¼š</p><pre class="line-numbers language-python"><code class="language-python">conda install pandas<span class="token operator">-</span>datareader<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ‘ä½¿ç”¨pandas_datareaderæ¨¡å—ä¸‹è½½äº†ä¸€äº›è‚¡ç¥¨æ•°æ®ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas_datareader<span class="token punctuation">.</span>data <span class="token keyword">as</span> weball_data <span class="token operator">=</span> <span class="token punctuation">{</span>ticker<span class="token punctuation">:</span> web<span class="token punctuation">.</span>get_data_yahoo<span class="token punctuation">(</span>ticker<span class="token punctuation">)</span>            <span class="token keyword">for</span> ticker <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">'AAPL'</span><span class="token punctuation">,</span> <span class="token string">'IBM'</span><span class="token punctuation">,</span> <span class="token string">'MSFT'</span><span class="token punctuation">,</span> <span class="token string">'GOOG'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>price <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span>ticker<span class="token punctuation">:</span> data<span class="token punctuation">[</span><span class="token string">'Adj Close'</span><span class="token punctuation">]</span>                     <span class="token keyword">for</span> ticker<span class="token punctuation">,</span> data <span class="token keyword">in</span> all_data<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>volume <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span>ticker<span class="token punctuation">:</span> data<span class="token punctuation">[</span><span class="token string">'Volume'</span><span class="token punctuation">]</span>                      <span class="token keyword">for</span> ticker<span class="token punctuation">,</span> data <span class="token keyword">in</span> all_data<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æ³¨æ„ï¼šæ­¤æ—¶Yahoo! Financeå·²ç»ä¸å­˜åœ¨äº†ï¼Œå› ä¸º2017å¹´Yahoo!è¢«Verizonæ”¶è´­äº†ã€‚å‚é˜…pandas-datareaderæ–‡æ¡£ï¼Œå¯ä»¥å­¦ä¹ æœ€æ–°çš„åŠŸèƒ½ã€‚</p></blockquote><p>ç°åœ¨è®¡ç®—ä»·æ ¼çš„ç™¾åˆ†æ•°å˜åŒ–ï¼Œæ—¶é—´åºåˆ—çš„æ“ä½œä¼šåœ¨ç¬¬11ç« ä»‹ç»ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">242</span><span class="token punctuation">]</span><span class="token punctuation">:</span> returns <span class="token operator">=</span> price<span class="token punctuation">.</span>pct_change<span class="token punctuation">(</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">243</span><span class="token punctuation">]</span><span class="token punctuation">:</span> returns<span class="token punctuation">.</span>tail<span class="token punctuation">(</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">243</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                 AAPL      GOOG       IBM      MSFTDate                                              <span class="token number">2016</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">17</span> <span class="token operator">-</span><span class="token number">0.000680</span>  <span class="token number">0.001837</span>  <span class="token number">0.002072</span> <span class="token operator">-</span><span class="token number">0.003483</span><span class="token number">2016</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">18</span> <span class="token operator">-</span><span class="token number">0.000681</span>  <span class="token number">0.019616</span> <span class="token operator">-</span><span class="token number">0.026168</span>  <span class="token number">0.007690</span><span class="token number">2016</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">19</span> <span class="token operator">-</span><span class="token number">0.002979</span>  <span class="token number">0.007846</span>  <span class="token number">0.003583</span> <span class="token operator">-</span><span class="token number">0.002255</span><span class="token number">2016</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">20</span> <span class="token operator">-</span><span class="token number">0.000512</span> <span class="token operator">-</span><span class="token number">0.005652</span>  <span class="token number">0.001719</span> <span class="token operator">-</span><span class="token number">0.004867</span><span class="token number">2016</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">21</span> <span class="token operator">-</span><span class="token number">0.003930</span>  <span class="token number">0.003011</span> <span class="token operator">-</span><span class="token number">0.012474</span>  <span class="token number">0.042096</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Seriesçš„corræ–¹æ³•ç”¨äºè®¡ç®—ä¸¤ä¸ªSeriesä¸­é‡å çš„ã€éNAçš„ã€æŒ‰ç´¢å¼•å¯¹é½çš„å€¼çš„ç›¸å…³ç³»æ•°ã€‚ä¸æ­¤ç±»ä¼¼ï¼Œcovç”¨äºè®¡ç®—åæ–¹å·®ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">244</span><span class="token punctuation">]</span><span class="token punctuation">:</span> returns<span class="token punctuation">[</span><span class="token string">'MSFT'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>corr<span class="token punctuation">(</span>returns<span class="token punctuation">[</span><span class="token string">'IBM'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">244</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">0.49976361144151144</span>In <span class="token punctuation">[</span><span class="token number">245</span><span class="token punctuation">]</span><span class="token punctuation">:</span> returns<span class="token punctuation">[</span><span class="token string">'MSFT'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cov<span class="token punctuation">(</span>returns<span class="token punctuation">[</span><span class="token string">'IBM'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">245</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">8.8706554797035462e-05</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å› ä¸ºMSTFæ˜¯ä¸€ä¸ªåˆç†çš„Pythonå±æ€§ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç”¨æ›´ç®€æ´çš„è¯­æ³•é€‰æ‹©åˆ—ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">246</span><span class="token punctuation">]</span><span class="token punctuation">:</span> returns<span class="token punctuation">.</span>MSFT<span class="token punctuation">.</span>corr<span class="token punctuation">(</span>returns<span class="token punctuation">.</span>IBM<span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">246</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">0.49976361144151144</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¦ä¸€æ–¹é¢ï¼ŒDataFrameçš„corrå’Œcovæ–¹æ³•å°†ä»¥DataFrameçš„å½¢å¼åˆ†åˆ«è¿”å›å®Œæ•´çš„ç›¸å…³ç³»æ•°æˆ–åæ–¹å·®çŸ©é˜µï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">247</span><span class="token punctuation">]</span><span class="token punctuation">:</span> returns<span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">247</span><span class="token punctuation">]</span><span class="token punctuation">:</span>           AAPL      GOOG       IBM      MSFTAAPL  <span class="token number">1.000000</span>  <span class="token number">0.407919</span>  <span class="token number">0.386817</span>  <span class="token number">0.389695</span>GOOG  <span class="token number">0.407919</span>  <span class="token number">1.000000</span>  <span class="token number">0.405099</span>  <span class="token number">0.465919</span>IBM   <span class="token number">0.386817</span>  <span class="token number">0.405099</span>  <span class="token number">1.000000</span>  <span class="token number">0.499764</span>MSFT  <span class="token number">0.389695</span>  <span class="token number">0.465919</span>  <span class="token number">0.499764</span>  <span class="token number">1.000000</span>In <span class="token punctuation">[</span><span class="token number">248</span><span class="token punctuation">]</span><span class="token punctuation">:</span> returns<span class="token punctuation">.</span>cov<span class="token punctuation">(</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">248</span><span class="token punctuation">]</span><span class="token punctuation">:</span>           AAPL      GOOG       IBM      MSFTAAPL  <span class="token number">0.000277</span>  <span class="token number">0.000107</span>  <span class="token number">0.000078</span>  <span class="token number">0.000095</span>GOOG  <span class="token number">0.000107</span>  <span class="token number">0.000251</span>  <span class="token number">0.000078</span>  <span class="token number">0.000108</span>IBM   <span class="token number">0.000078</span>  <span class="token number">0.000078</span>  <span class="token number">0.000146</span>  <span class="token number">0.000089</span>MSFT  <span class="token number">0.000095</span>  <span class="token number">0.000108</span>  <span class="token number">0.000089</span>  <span class="token number">0.000215</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ©ç”¨DataFrameçš„corrwithæ–¹æ³•ï¼Œä½ å¯ä»¥è®¡ç®—å…¶åˆ—æˆ–è¡Œè·Ÿå¦ä¸€ä¸ªSeriesæˆ–DataFrameä¹‹é—´çš„ç›¸å…³ç³»æ•°ã€‚ä¼ å…¥ä¸€ä¸ªSerieså°†ä¼šè¿”å›ä¸€ä¸ªç›¸å…³ç³»æ•°å€¼Seriesï¼ˆé’ˆå¯¹å„åˆ—è¿›è¡Œè®¡ç®—ï¼‰ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">249</span><span class="token punctuation">]</span><span class="token punctuation">:</span> returns<span class="token punctuation">.</span>corrwith<span class="token punctuation">(</span>returns<span class="token punctuation">.</span>IBM<span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">249</span><span class="token punctuation">]</span><span class="token punctuation">:</span> AAPL    <span class="token number">0.386817</span>GOOG    <span class="token number">0.405099</span>IBM     <span class="token number">1.000000</span>MSFT    <span class="token number">0.499764</span>dtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¼ å…¥ä¸€ä¸ªDataFrameåˆ™ä¼šè®¡ç®—æŒ‰åˆ—åé…å¯¹çš„ç›¸å…³ç³»æ•°ã€‚è¿™é‡Œï¼Œæˆ‘è®¡ç®—ç™¾åˆ†æ¯”å˜åŒ–ä¸æˆäº¤é‡çš„ç›¸å…³ç³»æ•°ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">250</span><span class="token punctuation">]</span><span class="token punctuation">:</span> returns<span class="token punctuation">.</span>corrwith<span class="token punctuation">(</span>volume<span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">250</span><span class="token punctuation">]</span><span class="token punctuation">:</span> AAPL   <span class="token operator">-</span><span class="token number">0.075565</span>GOOG   <span class="token operator">-</span><span class="token number">0.007067</span>IBM    <span class="token operator">-</span><span class="token number">0.204849</span>MSFT   <span class="token operator">-</span><span class="token number">0.092950</span>dtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¼ å…¥axis=â€™columnsâ€™å³å¯æŒ‰è¡Œè¿›è¡Œè®¡ç®—ã€‚æ— è®ºå¦‚ä½•ï¼Œåœ¨è®¡ç®—ç›¸å…³ç³»æ•°ä¹‹å‰ï¼Œæ‰€æœ‰çš„æ•°æ®é¡¹éƒ½ä¼šæŒ‰æ ‡ç­¾å¯¹é½ã€‚</p><h2 id="å”¯ä¸€å€¼ã€å€¼è®¡æ•°ä»¥åŠæˆå‘˜èµ„æ ¼"><a href="#å”¯ä¸€å€¼ã€å€¼è®¡æ•°ä»¥åŠæˆå‘˜èµ„æ ¼" class="headerlink" title="å”¯ä¸€å€¼ã€å€¼è®¡æ•°ä»¥åŠæˆå‘˜èµ„æ ¼"></a>å”¯ä¸€å€¼ã€å€¼è®¡æ•°ä»¥åŠæˆå‘˜èµ„æ ¼</h2><p>è¿˜æœ‰ä¸€ç±»æ–¹æ³•å¯ä»¥ä»ä¸€ç»´Seriesçš„å€¼ä¸­æŠ½å–ä¿¡æ¯ã€‚çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">251</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¬¬ä¸€ä¸ªå‡½æ•°æ˜¯uniqueï¼Œå®ƒå¯ä»¥å¾—åˆ°Seriesä¸­çš„å”¯ä¸€å€¼æ•°ç»„ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">252</span><span class="token punctuation">]</span><span class="token punctuation">:</span> uniques <span class="token operator">=</span> obj<span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">253</span><span class="token punctuation">]</span><span class="token punctuation">:</span> uniquesOut<span class="token punctuation">[</span><span class="token number">253</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>object<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¿”å›çš„å”¯ä¸€å€¼æ˜¯æœªæ’åºçš„ï¼Œå¦‚æœéœ€è¦çš„è¯ï¼Œå¯ä»¥å¯¹ç»“æœå†æ¬¡è¿›è¡Œæ’åºï¼ˆuniques.sort()ï¼‰ã€‚ç›¸ä¼¼çš„ï¼Œvalue_countsç”¨äºè®¡ç®—ä¸€ä¸ªSeriesä¸­å„å€¼å‡ºç°çš„é¢‘ç‡ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">254</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">254</span><span class="token punctuation">]</span><span class="token punctuation">:</span> c    <span class="token number">3</span>a    <span class="token number">3</span>b    <span class="token number">2</span>d    <span class="token number">1</span>dtype<span class="token punctuation">:</span> int64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸ºäº†ä¾¿äºæŸ¥çœ‹ï¼Œç»“æœSeriesæ˜¯æŒ‰å€¼é¢‘ç‡é™åºæ’åˆ—çš„ã€‚value_countsè¿˜æ˜¯ä¸€ä¸ªé¡¶çº§pandasæ–¹æ³•ï¼Œå¯ç”¨äºä»»ä½•æ•°ç»„æˆ–åºåˆ—ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">255</span><span class="token punctuation">]</span><span class="token punctuation">:</span> pd<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span>obj<span class="token punctuation">.</span>values<span class="token punctuation">,</span> sort<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">255</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a    <span class="token number">3</span>b    <span class="token number">2</span>c    <span class="token number">3</span>d    <span class="token number">1</span>dtype<span class="token punctuation">:</span> int64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>isinç”¨äºåˆ¤æ–­çŸ¢é‡åŒ–é›†åˆçš„æˆå‘˜èµ„æ ¼ï¼Œå¯ç”¨äºè¿‡æ»¤Seriesä¸­æˆ–DataFrameåˆ—ä¸­æ•°æ®çš„å­é›†ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">:</span> objOut<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">0</span>    c<span class="token number">1</span>    a<span class="token number">2</span>    d<span class="token number">3</span>    a<span class="token number">4</span>    a<span class="token number">5</span>    b<span class="token number">6</span>    b<span class="token number">7</span>    c<span class="token number">8</span>    cdtype<span class="token punctuation">:</span> objectIn <span class="token punctuation">[</span><span class="token number">257</span><span class="token punctuation">]</span><span class="token punctuation">:</span> mask <span class="token operator">=</span> obj<span class="token punctuation">.</span>isin<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">258</span><span class="token punctuation">]</span><span class="token punctuation">:</span> maskOut<span class="token punctuation">[</span><span class="token number">258</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">0</span>     <span class="token boolean">True</span><span class="token number">1</span>    <span class="token boolean">False</span><span class="token number">2</span>    <span class="token boolean">False</span><span class="token number">3</span>    <span class="token boolean">False</span><span class="token number">4</span>    <span class="token boolean">False</span><span class="token number">5</span>     <span class="token boolean">True</span><span class="token number">6</span>     <span class="token boolean">True</span><span class="token number">7</span>     <span class="token boolean">True</span><span class="token number">8</span>     <span class="token boolean">True</span>dtype<span class="token punctuation">:</span> boolIn <span class="token punctuation">[</span><span class="token number">259</span><span class="token punctuation">]</span><span class="token punctuation">:</span> obj<span class="token punctuation">[</span>mask<span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">259</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">0</span>    c<span class="token number">5</span>    b<span class="token number">6</span>    b<span class="token number">7</span>    c<span class="token number">8</span>    cdtype<span class="token punctuation">:</span> object<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸isinç±»ä¼¼çš„æ˜¯Index.get_indexeræ–¹æ³•ï¼Œå®ƒå¯ä»¥ç»™ä½ ä¸€ä¸ªç´¢å¼•æ•°ç»„ï¼Œä»å¯èƒ½åŒ…å«é‡å¤å€¼çš„æ•°ç»„åˆ°å¦ä¸€ä¸ªä¸åŒå€¼çš„æ•°ç»„ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">260</span><span class="token punctuation">]</span><span class="token punctuation">:</span> to_match <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">261</span><span class="token punctuation">]</span><span class="token punctuation">:</span> unique_vals <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">262</span><span class="token punctuation">]</span><span class="token punctuation">:</span> pd<span class="token punctuation">.</span>Index<span class="token punctuation">(</span>unique_vals<span class="token punctuation">)</span><span class="token punctuation">.</span>get_indexer<span class="token punctuation">(</span>to_match<span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">262</span><span class="token punctuation">]</span><span class="token punctuation">:</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¡¨5-9ç»™å‡ºäº†è¿™å‡ ä¸ªæ–¹æ³•çš„ä¸€äº›å‚è€ƒä¿¡æ¯ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://upload-images.jianshu.io/upload_images/7178691-b53c4a9d65a2db32.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è¡¨5-9 å”¯ä¸€å€¼ã€å€¼è®¡æ•°ã€æˆå‘˜èµ„æ ¼æ–¹æ³•"></p><p>æœ‰æ—¶ï¼Œä½ å¯èƒ½å¸Œæœ›å¾—åˆ°DataFrameä¸­å¤šä¸ªç›¸å…³åˆ—çš„ä¸€å¼ æŸ±çŠ¶å›¾ã€‚ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">263</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Qu1'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>                      <span class="token string">'Qu2'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>                      <span class="token string">'Qu3'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">264</span><span class="token punctuation">]</span><span class="token punctuation">:</span> dataOut<span class="token punctuation">[</span><span class="token number">264</span><span class="token punctuation">]</span><span class="token punctuation">:</span>    Qu1  Qu2  Qu3<span class="token number">0</span>    <span class="token number">1</span>    <span class="token number">2</span>    <span class="token number">1</span><span class="token number">1</span>    <span class="token number">3</span>    <span class="token number">3</span>    <span class="token number">5</span><span class="token number">2</span>    <span class="token number">4</span>    <span class="token number">1</span>    <span class="token number">2</span><span class="token number">3</span>    <span class="token number">3</span>    <span class="token number">2</span>    <span class="token number">4</span><span class="token number">4</span>    <span class="token number">4</span>    <span class="token number">3</span>    <span class="token number">4</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°†pandas.value_countsä¼ ç»™è¯¥DataFrameçš„applyå‡½æ•°ï¼Œå°±ä¼šå‡ºç°ï¼š</p><pre class="line-numbers language-python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">265</span><span class="token punctuation">]</span><span class="token punctuation">:</span> result <span class="token operator">=</span> data<span class="token punctuation">.</span>apply<span class="token punctuation">(</span>pd<span class="token punctuation">.</span>value_counts<span class="token punctuation">)</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">266</span><span class="token punctuation">]</span><span class="token punctuation">:</span> resultOut<span class="token punctuation">[</span><span class="token number">266</span><span class="token punctuation">]</span><span class="token punctuation">:</span>    Qu1  Qu2  Qu3<span class="token number">1</span>  <span class="token number">1.0</span>  <span class="token number">1.0</span>  <span class="token number">1.0</span><span class="token number">2</span>  <span class="token number">0.0</span>  <span class="token number">2.0</span>  <span class="token number">1.0</span><span class="token number">3</span>  <span class="token number">2.0</span>  <span class="token number">2.0</span>  <span class="token number">0.0</span><span class="token number">4</span>  <span class="token number">2.0</span>  <span class="token number">0.0</span>  <span class="token number">2.0</span><span class="token number">5</span>  <span class="token number">0.0</span>  <span class="token number">0.0</span>  <span class="token number">1.0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œï¼Œç»“æœä¸­çš„è¡Œæ ‡ç­¾æ˜¯æ‰€æœ‰åˆ—çš„å”¯ä¸€å€¼ã€‚åé¢çš„é¢‘ç‡å€¼æ˜¯æ¯ä¸ªåˆ—ä¸­è¿™äº›å€¼çš„ç›¸åº”è®¡æ•°ã€‚</p><h1 id="5-4-æ€»ç»“"><a href="#5-4-æ€»ç»“" class="headerlink" title="5.4 æ€»ç»“"></a>5.4 æ€»ç»“</h1><p>åœ¨ä¸‹ä¸€ç« ï¼Œæˆ‘ä»¬å°†è®¨è®ºç”¨pandasè¯»å–ï¼ˆæˆ–åŠ è½½ï¼‰å’Œå†™å…¥æ•°æ®é›†çš„å·¥å…·ã€‚</p><p>ä¹‹åï¼Œæˆ‘ä»¬å°†æ›´æ·±å…¥åœ°ç ”ç©¶ä½¿ç”¨pandasè¿›è¡Œæ•°æ®æ¸…æ´—ã€è§„æ•´ã€åˆ†æå’Œå¯è§†åŒ–å·¥å…·ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åˆ†æ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Pandas </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç‰©ç†å®éªŒæŠ¥å‘Š</title>
      <link href="/2021/09/10/wu-li-shi-yan-bao-gao/"/>
      <url>/2021/09/10/wu-li-shi-yan-bao-gao/</url>
      
        <content type="html"><![CDATA[<h2 id="ç‰©ç†å®éªŒæŠ¥å‘Š"><a href="#ç‰©ç†å®éªŒæŠ¥å‘Š" class="headerlink" title="ç‰©ç†å®éªŒæŠ¥å‘Š"></a>ç‰©ç†å®éªŒæŠ¥å‘Š</h2>]]></content>
      
      
      <categories>
          
          <category> å†™ç»™è‡ªå·±çš„æ•£æ–‡è¯— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®éªŒæŠ¥å‘Š </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Musical reviews of ä»¥åè¦åšçš„äº‹</title>
      <link href="/2021/09/09/musical-reviews-of-yi-hou-yao-zuo-de-shi/"/>
      <url>/2021/09/09/musical-reviews-of-yi-hou-yao-zuo-de-shi/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="ä¼¼ä¹ä¸å¤ªæ­£ç¡®â€¦â€¦ç®—äº†å§ï¼Œæ²¡å•¥å¥½çœ‹çš„" data-whm="æŠ±æ­‰, è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹.">  <script id="hbeData" type="hbeData" data-hmacdigest="d5867644b3f2f4f46d901849bbbf6b6457fb2457e7644e83bc98a441eb3323bc">5de89d89894dfc04df6c90fd52cc9dd0b3f8746dd64ae95603cc2a764f54fbe7b7881ee693fe159bdcd7c2a7b4360966fda5bdfa34c1d9156b8e54c6307ee619925a45b77101c423ca9d995e9d28f5a42e907b7ab161b2a4ce79fb2407590fd64cb359d76165e9ed69b4cbe10285bd95757cb009b1d0ec60c267d002303a06d869676dce200a2b08bf6ff10f947fb45cfc891efbad3ea5c68877b940707bc35f84d6e044f38cbf4d78cfd29871211f6ddb54a3620f893e289b5bdc6817ee1c41f16e3fbdf32483b9101f463df80701f6b3caa4436cbb7ae5e9f62e174baff28274521733321c6644adf91a75301d233abe31552fcae10e7cd822bcea847b6f9e15c40fbed3b1c3483cbeb1901cad8aee11358472121565e9fd0e00d31965b0a87fe48fe478cc301b6075c5d5a179605ca63b225d4709251e93fd09a0ed35c39fe11cd79d2b5212554164547aebc7d41e24b817038643ae6b8461c7a0cf9b7326d04527d61ec3601cc574203b42fe29b5134e6b10f58a0bf768235ae95098a3f4fe0e55058b31c68272be21ae021308b76b8930df009913dcf9456aed290cf6fa3af0a4030f377f9cb71419a4a8c9910e91dc5c653906011094d7b73684ee269668d96ac0002a1e2fc33277549397c545174fc8a87a2c128cd8027ffff98d7e3890cafe5a5237e6cf76782d34a461b3031f87d1873b4e3ac8846af4be2bcfc8105f35134ebead11abef6628bfee87b1ff1faa246caf9dabe722675948694930c24e2fe57b224eb2ab1bf24c6928c80d0ad27b83230c0a50edfd187d01bdd664107b2a6a8f5c29d68e41239320adf9f910a542fae03fb108b7d4186033e6bf723fc85fac2366d1b26c2304a002bc16ca6fbbacfbd6321b335cef693f37ca4e4ae2f51c87795ddecffad11cc3c4ab4b8dc44136d9462fc29dba19681bac1e07b8f77373ef933828e1d0b91d3ef2acf62571c424da698f21e96ef7ac489aad9ac79f083dbd0cb9a25a39c836ae5f26f58b5c0fbb78c839f831ca0a73b9f42190ce5ec20ed25a5a058141c2db7329eb6dee88ee079f944c5e1aaa2c7a08843fc3012f2c8b77bd0fd095c22851692ddceab1280e95db14e191c2918aed34b7f86987b8c52349cdef0294176a176a4be70a22d0f7514ace8d3724927487db5629a37947d146af76ddd53ed81fc1f95834efb82e94fe91f17893cfc38c67f4101eb867f60fb08907e92c063f79ff26966e3c1a79c4e23318ba84fece3ac3b3d36da85bc489498dc0a5eeec43c7e5d2ea1d89183e1c05cb54c1cdea02de5dfa5e3f9530cc892cf5d846e4d5796fead13c5e6e851f2cdfd4159201d1d27857421c2d08aaa263904f8c07f930a7540d0ff57cd71b95c8e82dfd48069dfef52e4105da53ca5f9afcd9fd6b470974d2cc234b2e7cdc53c9576e3f1989a35bc1d7d3767adc261290431488af300f3c8efde4974f4b9fbce149b79b250fc7d024fa79231869c342878ce7300089d56c80f924d88ae07ef1de7b9f25e84ff96d08d88b2959b213c425962b4736c1c8b9fba515bca6954dce5c297c6546c9bd62c7501143b12c5f7efcfd9154acb2653e5291df637359cad1d9fbdc1fac6a8532d9072da8cea26ddbf91ca749f1442a60b1c499e1aa0ded3afbd190345520cae0e97dbb73ea2af306972f3989fb245fb39ca17c8821224ab74384aef125e18bd889fe6c881172a6f478a0cc3cee61a32bbd16e05e15fe6f673c03bcb7bf4c0a78e37ffdea89c43406900c6b341b5befa09a36ae11848aa8f81f005c7feb01682c42f2c50bec05d955da02ac3b4908b2afdd9baba1d2021341eff457dce157dae9510d75219b596a948e3a55d250375a86ae289f0d8b7284ff43628430c408258f392d6f6fb4b463f161a14f327b345c4caad1015c1703fe9b04bc019b365e63a412622b67f470f22412a513e685579ebd43047b389aab983a240d3faf8612266d917e2a8fce0e5b889fe0f62aa1719cc0445490d902a087fca037367ca1a18809a26961583e7ecbf3f88567b0654584d5c4e95adccf08a3878a9b50f997aad4f7d045032187a7ec81a4da3ee598bf868e4ed5619e73435046710f7039e9813ca55fd3b4b93f132bb401f24e75abdaac7c9d952a96f72a48d2dbee95564da78d1d3eb82ef1a7105186e872d21234a6afdd870f1f2198bc89771321ab1518e58ef4911f807aa7a2fccc693e3a1381e082f8a91a4de7df3b55066a996bd97594a9cc37984dcb399ad835d4c9c9b7a28481e1047604bf191813cc2f29df449089413bb4ce9a7539fadcb6e4dbc2b4fc220e8c0693e7290f1726ea783f370bdb08a48509793c4a562e8c0cd29566a121dc23d7b21f6fba8c705b5c71d3a59d5de50643fa6bc8edb0e56ef3dc3b316b5e708376b28f22a27354b391694bb3ac2074d93d58fe899e970a1879dec6dcf28466c7b3849070eb6a9ec2143123ae9f4088e9494b56a7b5eedd362cf515bc976f65ec59299e29620ae62e50b6e63a28e76d4331ed9bfcc62f795d68fa0ca640a2b8b2460b6db81316b5004a9e6579df25e2ed1c183174631701dfdd3a7aa00ea5d51c3810947b44494b0f48593e7857f23a40347e95dc45cdcc9be699518a95da0bba0f2d73db45b0c07d2277a362aa868ce8a86c18ed544749d9b2258f81af203c6bce48f85c788e2fcd043585aa066ee24335de692909936b4097f49360ce793ef47927b25177fc709953d9e9efc81f574feccc51bbfd252cc8ac52151f781d39e3d10b5fae8b044612bc573be7efc08cc9eded3609c0dcf5d97d19d458bfc4ba38ff80846f9712fd1f29b7178a9002fcd00552cb21329d71abfafcaa3b2e1275f0ece681d24aed564ef48ab1b269627a79e3d012c59cb513f98dbc8633c11c0b3841e57c788d9a0267ae81b1c091c010f74632bef650baa28ced4da1faf2113c67c2a5c32a27a750f41e61a2cdf96fe2adcb84baee761bc383266cf17448fbfe014503b0b01d272860aab70c370b2f1cf6da78d95e501365d588eae66f1c8b0aea7eb096ce5ed421ec79b064fdfee4451bd62f14bdeb9a25424a7858de0fab0e67891bdaa9fd4ab0bc81126df796840d5a84360a8c78049b273b60599e26594bad9a68ca5ec390cf0338472b546ec2b92da03a82a6681c4ad4cf158946995c2768e39461f0de36a2daa76962fc95a6b99be28523ff76b77f156aa563517b4aa222943993812e260288f70dd283f69d959d1abfe52db32ec18d0a064366fd4cd01f72a0418cbc5670de52514a6a59979300acb1d65b2414173269e20720bc78be0a239f5d57eb00aee074bd02d91d144f8a16eea3ba79bb35ce366ef706eaf3007f249d3688110544fe95aa3628ba306853db946b8086df8dfe143f692e1a51715d048ed56f56f6a2f37e7ec20630b881328ef83815f6098ef076ff52acfdfab1519c6bf695f19a6e1107a36690fdc9b80c1b71b31da70612808695f324b7dbae7f059739cfcd5cdd8f60cd435d41b140404470357e1c95b5a1c1b97c4f9741054259c4aa2734b868c0b029c42e8bb3339915b6d9c547bcf23088726ba6d2b157d0c36b2975b31b8d0e65e323da90efde3e53966d3290d5d8ed61ae4f08a85e3a9f716baaec0152b891d974bd9bf91be10e7fae2fe70b2aa6bb7f7116cd66a340876c3a7892e05ecdba2221e1139da72fc2dddfa94773c4fbc627682bd289407f069dde7fcc861eccec0c076f5bdae6bf7920f831b4c3f0feed4195adee322545cbd40c6c94314c73cd75ffdafa4a3a5f2efe23bf7a33d18554d118bef33bd97b4e163707f6dd6964c0a1e0ab0c096380eaff19b433f9cebc5eb127ae39c0bf4aedde22c457451a368f33f93ac1d6d918d48192d2b02411973a914244d18efa055903de16cf891025ad18bca0a8bfa69e4c81bca7d6592cedcd9cef806a48c13e92535f130bd426757afeed7ae5264bb66a230351be6917fa7243b765ffb1ec989f9ff3a10ed3a2c88e5af1d67b0a5bb1597767ec6d3df90d5653780dc92d147b51563e3087d69812642d91f9ee35d79d30a8d73c8a2fe1e422e3d65349ed9d8564cefbbdb16dc296c939734755293441a196303989a9d8e77e3dc9aa1ebcc4099dee17d169ca782324f7484f89dca3765599da3169810f76fe3d03c13f5c850123189f21a2d33f94f177acb4b59c05e6d76b8c83af0cf82270462e0645935fce22e1fc228b3fc08d234cc6a376dff3e5d901c725bf08c6545cb822092d337f4562a820bf876cf82a7db581ceaae2ed42c79300ebd1e022b2aceedf2d4e6080c3ac83be58dca6316a68c9d25a25be5b2051aa277b7b35cd6c67e5ee61619d675107fec1ca779e38677bd893bd3d5d5b648b6792d5b9247b1861fb3008e844d04c5390eb5c40d8263fe70ea2bf34b34d0ec76f0e610f6cdb9912b05b0e19554ac6f0a3ffef55345cd6911bae1f57321a86e98d0166cebb4a8b2ad27f5f233dbabf377dac73092abc22606ed101784268f6a45b5c9f403a194569df590e537c187c071ba6098f7bac8a2e6863ef6c1745f64cfdf760f00a5e0a397ffd11db80bb25cc939644913f4cbb7f4dcedbe1c5f3d0f4952f9244764a772cb181134ee98808ad888d18b956f5bfbb8c2b909f0a39ccf2e2278db929a22c12748fd3d79032ea73873ae89aa11733a2888ba3493b7a4a26c36a4e2db1c3b393383b35321d22f028c89bcced8121663ec257108e5cbc41954473da68fd26225bd3afea99e42ab0d3158c18636bb19cbd5a53154a3b0bb0cccce3b2b0f9c7e90fa150d65ac45dfc7139735676f288f29284448580cc07b81a72288a94d7670cf85a658daf116692bc522f11d8ad8d50b1f63db81edc510bb24c84b585cf366e64953f415e954f634d90c9e3dda478fee0b418021c5b02d67bfc5bf2cce66e5e4cccc80e0aa556fb77d3f33ae3b2f603a30ade62d6561afa795b31f55ef6a6e4ce997e9e9dce90229c5fbe390ac8342d09afe5ea571632dd9855606f5183e7181c2ad059983a08d7e075cd4d5a9df8e89bfcfab549507e756c59f31d04568e0e030b2fa2f1fa492ed68126ecd7eba5383753fadfbe846f9019b3d568177c69becb2133792a3aea4a6188decbaeafa0d73f4195b0057376c8b3b86fd5c34e7e5555d7569356980a39208a7e3e7740bd17df84700682a7c08a7c97998b8c5832e50f5fc5f3ca51e77c2a4bc4168f1a07f68f065a73b007cb5ecee53f9ea319ade2555e47755e1c8b5bd99adf248300207e84e97c8c97f0bbf6119202594b8f57db91bebdf14bbd6f6b2c0f8353875d89458b22607bd7814cd9f430dd69a4d5164e702577217c3c9aec9a4c5ac917d3eb319c1d029f4eccd4870924189ec1808e3dff736c969fb201e19b6a45853628b1829eaae962cfb95b60d3896fe6c4bafc4491c4a2178c73a0c3d2aac182d1e49fa57712b0c0a1af13603876b138e915ead885d7e3183d242f921f7f69feeb2587a895835e2220e08716916540fa411df138ccda2d5393b3f3c9223a5efde9f7013a65d5bc79f4126bae6a1bc98f7dd178e901f903f1086ffc76366d87c4efb5ed1f9edf024e32ec8f1ea9391fb7237449c77273ce84c68db99620323e84a17f25019c08b4538362a6b0321510edab5149f1c0b76d621499277964a020c2f1a41b23240c2f1965a9cb2f991e00a5590b80501011201c471d126a3d845b43419514c82f5cd87af9923047e2f9339836e2c8608778806655ad01d0d1b6a82580f1f915d893445abe5e88560cd94031946e6fec3cf70e171b8fe53f94b0624e66e3ef7fe10912914bc62f16f583d12546d2424cf587844128d2798b177b2893bd9d300dbc567b5a2376d0d7cece3c37500c84a643aa4899cd8542de8ce69f7211994e2ac20a6c5489f064df6241d1a5c944dd4f923a501e73f6022f8e7c78c26a32e8186091e19ccbca6affb6e6e9cdd4e9fd02ca7d70bbb3a0ce0e380f7f484ff6c77f8e2b495881492fd376bf7dd64b5b78da8bd6f11f1a1f1510430015a9452c7891c4d50ba81f595f54d5efbaae1840b337d79e97842461e7c3b24bd7a96ec4fe19ebf4af999cde0f6a04c113e21f210102e6e994d1acbe0815bfa8af0c521f7de9a0203fc70b7b8d0372b11e914e07cd9fd626527d924cb3c0643ea724865ec6a5b4768154820dcd6fde42f147eb1400647b05688141f46ad2875312055fd8110f8e284c8401dbd609801009c21bfdd463be0415863590e19d0e7bc63e818142c6547023cf3c1f0a8b35b59e0070694dfbd23cbe7b9774aee34f6f3dc7ccd1bd3a6410588b64a540cee15e93fb989600bd9341b538f546bb2f2ae83e77f92ea8599706f8f8ed7dfb5850aaf040b707085a8a538d9bc21f44e492dbcc228d851b652d160443bc9261d9b1f0533968f53436b3b02d62d6e5f75ca5d18767d1fd5ba267fbfef24461f89275c46f25fd7193490817ce7558dad5a111c443ee99407028acb60bae80af66dd6706e4553c2446156c3425ed690f199ee69f29b7274c63200d85e9caad66747f5a119c2ebaba2973580936d91c024e55a561cf7a39a9c7efc8cc4e29961e7aebe0c906e741b9fe2eec49dcfbaf93308b93615a0d56005bab1d4bfa4386cdf0ee25de7b9da30be38eaca41460e1457d4807b9f9bab1d725444d5361d1eb9f3b356ef7b76ed6d78080574c60b2a6c7b04d3e0b987b28e91bce3f29bdab9b1786b9a1f070bdfb263ffb7200798a5279870ee6ba38b18dfa956af252aea234882c652765316c4088af507d8aff1322e0e7bab290e10ef10cfd41fd3477de443fc7f4f35692c687e8dd49fc0931ff652d5a8a5500c366aa326ac857663acca94acf32cfce7b7c11b51018d86e0a658a4d0daadab27591763c9bdba975</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-shrink">      <input class="hbe hbe-input-field hbe-input-field-shrink" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-shrink" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-shrink">Not IP of Mr.Lu ! enter some words to prove</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> å†™ç»™è‡ªå·±çš„æ•£æ–‡è¯— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å†™ç»™è‡ªå·±çš„æ•£æ–‡è¯— </tag>
            
            <tag> æ—ä¿Šæ° </tag>
            
            <tag> ä¹è¯„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Dianå›¢é˜Ÿåˆä½“éªŒ</title>
      <link href="/2021/09/08/dian-tuan-dui-chu-ti-yan/"/>
      <url>/2021/09/08/dian-tuan-dui-chu-ti-yan/</url>
      
        <content type="html"><![CDATA[<h2 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h2><p>æœ¬æ¥æˆ‘æ˜¯æ€€ç€å¾ˆå¿å¿‘çš„å¿ƒæƒ…æ¥çš„ï¼Œç”šè‡³æ¥éƒ½ä¸æ•¢å•ç‹¬è¿‡æ¥ğŸ˜‘ï¼Œå’Œåˆ«çš„æ–°æ¥çš„åŒå­¦@é«˜ä¸€å¸†çº¦å®šå¥½äº†æ‰å¼€å§‹è¿‡æ¥ã€‚æ„Ÿè§‰ä»é¢è¯•åˆ°ä¹‹åçš„è®²åº§å†åˆ°åæ¥çš„å‘å¸ƒä»»åŠ¡è’‹å­¦é•¿éƒ½æœ‰äº›ä¸¥å‰hhhâ€¦â€¦ä½†æ˜¯åˆ°äº†ä¹‹åæ„Ÿè§‰è’‹å­¦é•¿è¿˜æ˜¯éå¸¸å¹³æ˜“è¿‘äººçš„ï¼å¾ˆè€å¿ƒçš„ç»™æˆ‘ä»¬è§£é‡Šäº†æˆ‘ä»¬çš„äººå‘˜æ³¨å†Œå’Œæˆ‘ä»¬çš„æœ‰å…³é¡¹ç›®å®‰æ’æƒ…å†µã€‚å¦å¤–å°±æ˜¯ç»™æˆ‘ä»¬å®‰æ’åº§ä½æ¥åï¼Œå¹¸è¿çš„æˆ‘ååˆ°äº†è’‹ç»„é•¿ï¼ˆ<del>ä»¥ä¸‹ç»Ÿç§°è’‹ç¥</del>ï¼‰çš„å¯¹é¢ã€‚æˆ‘è§‰å¾—æˆ‘åçš„ä½ç½®ç®—æ˜¯éå¸¸å¥½äº†ï¼Œéå¸¸é é‡Œï¼Œè¿™æ ·ä¸€æ¥æˆ‘å·å·å†™ä½œä¸šå°±æ²¡äººèƒ½å‘ç°äº†ğŸ˜…ã€‚</p><h2 id="æ˜¾ç¤ºå±"><a href="#æ˜¾ç¤ºå±" class="headerlink" title="æ˜¾ç¤ºå±"></a>æ˜¾ç¤ºå±</h2><p>æ˜¾ç¤ºå±æ˜¯æœ€å¤§çš„æƒŠå–œï¼ï¼æ²¡æœ‰ä¹‹ä¸€ï¼æ²¡æœ‰æƒ³åˆ°æˆ‘ä»¬æ¯ä¸ªäººéƒ½èƒ½æœ‰ä¸€ä¸ªæ˜¾ç¤ºå±ï¼Œæˆ‘ä¹‹å‰ä¸€ç›´åæ§½æˆ‘pro13çš„å°å°çš„æ˜¾ç¤ºå±ï¼Œåªæœ‰13.3å¯¸ï¼Œè®©äººä½“éªŒä¸æ˜¯å¾ˆå¥½ï¼Œæˆ‘å°±åšé¢œæ— è€»çš„é€‰äº†ä¸€ä¸ªâ€œçœ‹èµ·æ¥â€ä¸é”™çš„ã€‚</p><p><a href="https://imgtu.com/i/hHjqgA" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/09/08/hHjqgA.jpg" alt="å°±æ˜¯ç”»è´¨æœ‰äº›â€¦â€¦"></a></p><p>å¯æ˜¯å½“æˆ‘è¿å¥½HDMIçº¿çš„æ—¶å€™ï¼Œå‘ç°è¿™ä¸ªæ˜¾ç¤ºå±çš„ç”»è´¨ç€å®â€¦â€¦emmmï¼Œæ˜¾ç¤ºå±ç¡®å®å˜å¤§äº†ï¼Œä½†æ˜¯è¿™ç”»è´¨â€¦â€¦èƒ½æœ‰1080på˜›ğŸ™„ã€‚ä¸è¿‡æ€»æ¯”æ²¡æœ‰å¥½ï¼Œ<del>æ¯•ç«Ÿæ•²ä¸ªä»£ç å˜›ï¼Œæ²¡æœ‰å¿…è¦ç”¨åˆ°è¿™ä¹ˆå¥½çš„æ˜¾ç¤ºå±</del>.è¿™ç¯‡åšå®¢å°±æ˜¯åœ¨Dianå›¢é˜Ÿåœ¨è¿™ä¸€å—æ˜¾ç¤ºå±ä¸Šå†™çš„ã€‚</p><p>æ•´ä½“æ¥è¯´è¿™ä¸ªæ˜¾ç¤ºå±è¿˜æ˜¯è®©äººå¯ä»¥æ¥å—çš„ï¼Œè¿˜ç®—æ˜¯æŒºæ»¡æ„äº†ã€‚</p><h2 id="ä»¥åçš„ä¸€äº›å®‰æ’ï¼ˆé˜²é—å¿˜ï¼‰"><a href="#ä»¥åçš„ä¸€äº›å®‰æ’ï¼ˆé˜²é—å¿˜ï¼‰" class="headerlink" title="ä»¥åçš„ä¸€äº›å®‰æ’ï¼ˆé˜²é—å¿˜ï¼‰"></a>ä»¥åçš„ä¸€äº›å®‰æ’ï¼ˆé˜²é—å¿˜ï¼‰</h2><p>è¿™é‡Œå…ˆè®°ä¸€ä¸‹å§å¤§æ¦‚ï¼š</p><ul><li>æˆ‘ä»¬çš„äººå‘˜æ³¨å†Œéœ€è¦åˆ°åæ¥çš„ç›¸äº’è¯„æµ‹ä¹‹åæ‰èƒ½å¼€å§‹</li><li>å¡çš„æ³¨å†Œæ¿€æ´»éœ€è¦ç­‰åˆ°æ˜å¤©æ‰å¯ä»¥å¼€å§‹</li><li>æˆ‘ä»¬çš„è¾‰ç‘é›·ç”µé¡¹ç›®éœ€è¦ç­‰åˆ°10æœˆï¼Œè¿™å€’æ˜¯ä¸€ä¸ªå¥½æ¶ˆæ¯ï¼Œå› ä¸ºå¬è’‹å­¦é•¿è¯´å›¢é˜Ÿé‡Œé¢èƒ½å¤Ÿæœ‰è¿™æ ·æ¯”è¾ƒå¤§å—çš„æ—¶é—´æ¥å­¦ä¹ ï¼Œè¿™æ ·çš„æ—¶é—´æ˜¯å¾ˆå®è´µçš„ï¼Œæ¯•ç«Ÿå¹³æ—¶ä¼šæ¯”è¾ƒå¿™ï¼Œæœ‰å„ç§å„æ ·çš„ç›¸å…³é¡¹ç›®ä¹‹ç±»çš„ã€‚</li><li>é¡¹ç›®ç»„è¿˜æ˜¯å¾ˆå¿™çš„</li><li><strong>å¹³æ—¶æ˜¯å¯ä»¥åœ¨è¿™é‡Œå†™ä½œä¸šçš„ï¼æˆ‘æ¥ä¹‹å‰ä»¥ä¸ºè¿™é‡Œåªèƒ½åšDiançš„ä»»åŠ¡â€¦â€¦</strong></li><li>æ³¨æ„æˆ‘ä»¬å°½é‡è¦å»å‚åŠ æ¯å‘¨çš„ä¾‹ä¼šï¼Œè¿™ä¸ªå¾ˆé‡è¦ã€‚æ¯å¹´å¥½åƒæœ‰2æ¬¡ä¸å‚åŠ çš„ç†ç”±ï¼Ÿå¥½åƒæ˜¯ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> å†™ç»™è‡ªå·±çš„æ•£æ–‡è¯— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å†™ç»™è‡ªå·±çš„æ•£æ–‡è¯— </tag>
            
            <tag> Dianå›¢é˜Ÿ </tag>
            
            <tag> AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è°­å¿—è™é™¢é•¿è®¿è°ˆ</title>
      <link href="/2021/09/06/tan-zhi-hu-yuan-chang-fang-tan/"/>
      <url>/2021/09/06/tan-zhi-hu-yuan-chang-fang-tan/</url>
      
        <content type="html"><![CDATA[<h1 id="â€œæ¢ç§‘è®¿è®¡â€è°­å¿—è™å‰¯é™¢é•¿è®¿è°ˆ"><a href="#â€œæ¢ç§‘è®¿è®¡â€è°­å¿—è™å‰¯é™¢é•¿è®¿è°ˆ" class="headerlink" title="â€œæ¢ç§‘è®¿è®¡â€è°­å¿—è™å‰¯é™¢é•¿è®¿è°ˆ"></a>â€œæ¢ç§‘è®¿è®¡â€è°­å¿—è™å‰¯é™¢é•¿è®¿è°ˆ</h1><hr><p>7æœˆ10å·ä¸Šåˆï¼Œè®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯å­¦é™¢èµ´åä¸­ç§‘æŠ€å¤§å­¦â€œæ¢ç§‘è®¿è®¡â€æš‘æœŸç¤¾ä¼šå®è·µé˜Ÿé˜Ÿé•¿é€¯æ¶¦é›¨ã€å‰¯é˜Ÿé•¿å§œæ˜±ä»¥åŠå®‰å…¨å‘˜æ¨é‡Šç„¶æ¥åˆ°åä¸­ç§‘æŠ€å¤§å­¦å—ä¸€æ¥¼è°­å‰¯é™¢é•¿åŠå…¬å®¤å¯¹è°­é™¢é•¿è¿›è¡Œäº†ç›¸å…³è®¿è°ˆã€‚</p><h2 id="è®¿è°ˆç­¹å¤‡"><a href="#è®¿è°ˆç­¹å¤‡" class="headerlink" title="è®¿è°ˆç­¹å¤‡"></a>è®¿è°ˆç­¹å¤‡</h2><p>äº‹å…ˆå®Œå…¨æ²¡æœ‰æƒ³åˆ°è®¿è°ˆè¿‡ç¨‹ä¼šå¦‚æ­¤é¡ºåˆ©ï¼Œé‡‡è®¿å‰è¿˜æ‹…å¿ƒä¼šä¸ä¼šè°­é™¢é•¿ä¸æ„¿æ„æ¥å—æˆ‘ä»¬çš„é‚€è¯·ï¼Œä½†æ˜¯å¼ è¾…å¯¼å‘˜é¼“åŠ±æˆ‘ä»¬å»å’Œé™¢é•¿äº¤æµï¼Œè¯´è°­å‰¯é™¢é•¿è¿˜æ˜¯å¾ˆæ¬¢è¿æœ¬ç§‘ç”Ÿæ‰¾ä»–å»äº¤æµçš„ã€‚æœç„¶ç¬¬ä¸€å¤©æ™šä¸Šè”ç³»ï¼Œç¬¬äºŒå¤©å°±ç¡®å®šå¹¶å¼€å§‹äº†è®¿è°ˆã€‚é™¢é•¿å¾ˆçˆ½å¿«çš„æŠ½å‡ºäº†å°†è¿‘ä¸€ä¸Šåˆçš„æ—¶é—´æ¥å—æˆ‘ä»¬çš„è®¿è°ˆå¹¶ä¸”è¿˜å¾ˆç»†è‡´å…¥å¾®è®²è§£æˆ‘ä»¬å­¦é™¢æœªæ¥çš„è§„åˆ’ä¸æ‰“ç®—ã€æˆ‘ä»¬æ¯•ä¸šç”Ÿçš„ä¸€äº›å»ºè®®ä¸å»å‘æ”¿ç­–ã€é™¢é‡Œå¯¹å­¦ç”Ÿæ„è§çš„é‡è§†ã€‚è¿™è¶³å¯è§è°­å‰¯é™¢é•¿çš„å¹³æ˜“è¿‘äººä»¥åŠå¯¹äºæˆ‘ä»¬æœ¬ç§‘ç”Ÿå­¦ä¹ ç”Ÿæ´»çš„é‡è§†ã€‚æœ€åä¹Ÿç»™äº†æˆ‘ä»¬ä¸€ä¸ªæƒŠå–œï¼Œï¼ˆè¿™ä¸ªæƒŠå–œä½œä¸ºå½©è›‹æ”¾åˆ°ä¸‹ä¸€ç¯‡æ–‡æœ«ï¼‰å½“ç„¶äº‹å…ˆæˆ‘ä»¬ä¹Ÿåšäº†å……è¶³çš„ç­¹å¤‡ï¼Œåˆ—å‡ºäº†ä¸€äº›æ–¹é¢è®¡åˆ’ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/2021071012362688.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="è®¿è°ˆè°­å¿—è™å‰¯é™¢é•¿"></p><p>å½“ç„¶ï¼Œä»¥ä¸Šä¹Ÿåªæ˜¯ä¸€äº›æ–¹é¢ã€‚æˆ‘ä»¬è®¿è°ˆå¹¶æœªæŒ‰ç…§è¿™äº›æ–¹é¢æ¥ï¼Œè€Œæ˜¯ç›¸å¯¹å¾ˆè½»æ¾çš„èŠåˆ°å“ªé‡Œè®²å“ªé‡Œã€‚è°­é™¢é•¿å¯è°“å¥è°ˆï¼Œä¹Ÿå¯èƒ½æ˜¯è¿™éƒ½æ˜¯ä»–è‡ªå·±äº²è‡ªå‚ä¸å¹¶å®æ–½çš„è§„åˆ’ï¼Œè°­é™¢é•¿å¾ˆä¹æ„ä¸æˆ‘ä»¬åˆ†äº«ç›®å‰é™¢é‡Œçš„ä¸€äº›é—®é¢˜ä¸è®¡åˆ’ã€‚ä¹Ÿå¸Œæœ›æˆ‘ä»¬å­¦ç”Ÿèƒ½å¤Ÿæ˜¯ä¸€ä¸ªå¾ˆå…³é”®çš„ä¸€ç¯ï¼Œä¸€èµ·æ¥å®Œå–„æˆ‘ä»¬å­¦é™¢çš„å»ºè®¾ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210710123855479.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="å­¦é™¢è¯¾ç¨‹ä½“ç³»ç»“æ„"><a href="#å­¦é™¢è¯¾ç¨‹ä½“ç³»ç»“æ„" class="headerlink" title="å­¦é™¢è¯¾ç¨‹ä½“ç³»ç»“æ„"></a>å­¦é™¢è¯¾ç¨‹ä½“ç³»ç»“æ„</h2><h3 id="æ—©å¹´è¯¾ç¨‹å˜åŒ–"><a href="#æ—©å¹´è¯¾ç¨‹å˜åŒ–" class="headerlink" title="æ—©å¹´è¯¾ç¨‹å˜åŒ–"></a>æ—©å¹´è¯¾ç¨‹å˜åŒ–</h3><p>è°­å‰¯é™¢é•¿ä»æœ¬ç§‘åˆ°ç¡•å£«ï¼Œå†åˆ°åšå£«éƒ½æ˜¯åœ¨åç§‘è¯»çš„ï¼Œå’Œä¸Šæ¬¡é‡‡è®¿çš„é‚µæ•™æˆä¸€æ ·ï¼Œéƒ½æ˜¯æ˜¯åœŸç”ŸåœŸé•¿çš„åä¸­å¤§äººã€‚å¯¹äºåç§‘çš„å˜è¿ã€è¯¾ç¨‹çš„å˜åŒ–å¯ä»¥è¯´æ˜¯éå¸¸ç†Ÿæ‚‰äº†ã€‚è°ˆåˆ°æ—©å¹´è‡ªå·±å­¦ä¹ çš„è¯¾ç¨‹ä¸å½“å‰è¯¾ç¨‹å˜åŒ–ï¼Œè°­æ•™æˆè®²åˆ°å®é™…ä¸Šå˜åŒ–å¹¶æ²¡æœ‰ç‰¹åˆ«å¤§ï¼ŒåŸºç¡€è¯¾éƒ½æ˜¯æ²¡æ€ä¹ˆå˜åŒ–çš„ã€‚å¾®ç§¯åˆ†ã€å¤§å­¦ç‰©ç†è¿™äº›éƒ½æ˜¯å˜åŒ–ä¸å¤§çš„ã€‚å¯èƒ½æ€æ”¿è¯¾ä¼šå°‘ä¸€ç‚¹ï¼ˆæ¯•ç«Ÿâ€œç†è®ºæ˜¯ä¸æ–­å®Œå–„çš„â€ï¼‰ã€‚è€ŒITä¸­å›½è¿™ç§è¯¾ç¨‹ç›¸æ¯”ä¹‹ä¸‹æ›´åŠ å¤šå…ƒåŒ–äº†ï¼Œå¼€çœ¼ç•Œçš„è¯¾ç¨‹ï¼Œä¹‹å‰éƒ½æ˜¯æœ¬é™¢çš„æ•™æˆåœ¨è®²ï¼Œè€Œååˆ°æˆ‘ä»¬è¿™é‡Œä¹Ÿä¼šé‚€è¯·åˆ°å„ä¸ªå·¥ä¸šç•Œã€å­¦æœ¯ç•Œçš„å¤§ç‰›æ¥å¼€è®²åº§äº†ã€‚</p><h3 id="æ•™å­¦ä½“ç³»ç›®å‰æ”¹è¿›ä»¥åŠè®¡åˆ’"><a href="#æ•™å­¦ä½“ç³»ç›®å‰æ”¹è¿›ä»¥åŠè®¡åˆ’" class="headerlink" title="æ•™å­¦ä½“ç³»ç›®å‰æ”¹è¿›ä»¥åŠè®¡åˆ’"></a>æ•™å­¦ä½“ç³»ç›®å‰æ”¹è¿›ä»¥åŠè®¡åˆ’</h3><h4 id="ç°å­˜é—®é¢˜"><a href="#ç°å­˜é—®é¢˜" class="headerlink" title="ç°å­˜é—®é¢˜"></a>ç°å­˜é—®é¢˜</h4><p>æˆ‘ä»¬è¿™ä¸€å±Šè¿˜æœ‰â€œæ¨¡ç”µâ€è¿™é—¨è¢«å¹¿å¤§å­¦é•¿å­¦å§ä»¬åæ§½çš„è¯¾ç¨‹ï¼Œè°ˆåˆ°è¿™é—¨è¯¾ç¨‹ï¼Œè°­é™¢é•¿è®¤ä¸ºä¸Šå‡ å±Šåå“ä¸å¥½çš„åŸå› å®é™…ä¸Šæœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š1. è®¤ä¸ºè¿™ä¸€é—¨è¯¾æ²¡æœ‰ç”¨ï¼Œè®¡ç®—æœºç”¨ä¸åˆ°ã€‚  2. å¯¹äºå­¦åˆ°çš„çŸ¥è¯†ä¸æ»¡æ„ï¼Œè®¤ä¸ºæˆ–è®¸æ˜¯è€å¸ˆè®²å¾—ä¸å¤Ÿç”¨å¿ƒï¼Ÿæ²¡æœ‰å­¦åˆ°çœŸæ­£çš„çŸ¥è¯†ã€‚  3. å ç”¨ä¸“ä¸šè¯¾æ—¶é—´ã€‚</p><p>å®é™…ä¸Šè°­é™¢é•¿ä¹Ÿè¯´åˆ°äº†ï¼Œæˆ‘ä»¬å¤§å­¦ä¸ä¼šè¯´è¿™ä¸€é—¨è¯¾æœ‰æ²¡æœ‰ç”¨ï¼Œæœ¬å°±ä¸æ˜¯å®Œå…¨é¢å‘å°±ä¸šçš„ï¼Œå¤§å­¦ä¸æ˜¯æŠ€æ ¡åŸ¹è®­æœºæ„ï¼Œå¤§å­¦ä¸»è¦è¿˜æ˜¯ç ”ç©¶å¯¼å‘å‹çš„ã€‚å®é™…ä¸Šçš„ç¡®ï¼Œé™¢é•¿æ‰¿è®¤è¿™é—¨è¯¾å¯¹äºæˆ‘ä»¬å°±ä¸šæ–¹é¢çš„ç¡®ç”¨å¤„ä¸å¤§ï¼Œä½†æ˜¯æˆ‘ä»¬æœ¬æ¥å°±ä¸æ˜¯ä¸ºäº†å°±ä¸šåœ¨å¼€è¯¾ç¨‹ã€‚è¿™ä¸ªåœ¨æˆ‘ä»¬å¤§å­¦é‡Œé¢è®¸å¤šæ–¹é¢éƒ½ç”¨å¾—åˆ°ï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬æœºç”²å¤§å¸ˆã€æœºå™¨äººæ–¹é¢ï¼Œç”µä¿¡ã€æœºæ¢°é‚£é‡Œåšå¾—å°±å¾ˆä¸é”™ã€‚å¦‚æœæˆ‘ä»¬æ²¡æœ‰æ•°ç”µæ–¹é¢çš„çŸ¥è¯†ï¼Œå®é™…ä¸Šå°±å¾ˆå åŠ£åŠ¿çš„ã€‚åªä¼šä»£ç ç»¼åˆèƒ½åŠ›ä¸å¤Ÿå¼ºã€‚å½“ç„¶è¿™åªæ˜¯ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œè¿™ä¸ªæ¨¡ç”µæˆ–æ˜¯å…¶ä»–â€œæ²¡ç”¨å­¦ç§‘â€å­¦ä¹ å®é™…ä¸Šå¾ˆå¤§ç¨‹åº¦ä¸Šå¯ä»¥æé«˜æˆ‘ä»¬ä¸€äº›çœ¼ç•Œã€ä¸€äº›ç»¼åˆæ–¹é¢çš„èƒ½åŠ›ã€‚å½“ç„¶æ¨¡ç”µå®é™…ä¸Šå¾ˆå¤šå­¦æ ¡ä¹Ÿå»æ‰äº†ï¼Œé™¤äº†æ¸…åå’Œæˆ‘ä»¬æ ¡ä¸€äº›å°‘æ•°å­¦æ ¡ï¼Œç”±äºæˆ‘ä»¬è¿™ä¸€å±Šåœ¨åŸ¹å…»è®¡åˆ’å†…ï¼Œæ‰€ä»¥æ²¡æœ‰åŠæ³•å»æ‰ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¿˜éœ€è¦å­¦ğŸ˜…ã€‚ä¸‹ä¸€å±Šå¯èƒ½å°±ä¼šè€ƒè™‘å»æ‰ã€‚</p><p>å¦å¤–æˆ‘ä»¬è¿˜åæ˜ äº†è®¡å“ç­çº§â€œä¸€å…ƒå¤šå…ƒåˆ†æå­¦â€è¿™æ–¹é¢çš„é—®é¢˜ï¼Œè®¡å“ç­çº§å®é™…ä¸Šæ²¡æœ‰å¿…è¦å­¦ä¹ è¿™é—¨è¯¾ç¨‹ï¼Œå¯ä»¥å­¦å¾®ç§¯åˆ†ï¼Œä½†æ˜¯å†æ·±ä¸€æ­¥æ•°å­¦åˆ†æå°±ç›¸å½“ä¸å¯å–äº†ï¼Œéš¾åº¦å¤§è€Œä¸”ç¡®å®å¯¹äºè®¡ç®—æœºä¸“ä¸šå¾®ç§¯åˆ†å®Œå…¨å¯ä»¥æ»¡è¶³è¦æ±‚äº†ã€‚è°­é™¢é•¿è¯´è¿™æ˜¯å¯æ˜å­¦é™¢çš„è¦æ±‚ï¼Œä»–å¯ä»¥å¸®åŠ©æˆ‘ä»¬å»äº¤æ¶‰ä¸€ä¸‹ã€‚ï¼ˆç„¶è€Œæˆ‘ä»¬å·²ç»å­¦å®Œäº†ğŸ˜­ï¼‰</p><h4 id="20çº§ç›®å‰ä¸€äº›æ”¹è¿›"><a href="#20çº§ç›®å‰ä¸€äº›æ”¹è¿›" class="headerlink" title="20çº§ç›®å‰ä¸€äº›æ”¹è¿›"></a>20çº§ç›®å‰ä¸€äº›æ”¹è¿›</h4><p>è™½ç„¶20çº§åŸ¹å…»è®¡åˆ’å·²ç»ç¡®å®šï¼Œä½†æ˜¯è¯¾ç¨‹é¡ºåºå¯ä»¥ç»§ç»­è°ƒæ•´ã€‚è°­é™¢é•¿å°†æˆ‘ä»¬æ•°æ®ç»“æ„å‰ç§»è‡³å¤§ä¸€ä¸‹ï¼Œä»¥åŠå°†è®¸å¤šçš„å¤§ä¸‰è¦å­¦çš„ä¸“ä¸šè¯¾å¾€å‰ç§»ï¼Œä»¥å‡è½»æˆ‘ä»¬å¤§ä¸‰å¤§å››å»å®ä¹ çš„å‹åŠ›ã€‚å¦å¤–ä¹Ÿè®²åˆ°äº†è®¸å¤šé€‰ä¿®è¯¾ç¨‹ï¼Œé€‰ä¿®è¯¾ä¹Ÿæ˜¯æˆä½“ç³»çš„ï¼Œæœ‰ç€3æ¡é€‰ä¿®è¯¾çš„ä¸»çº¿ï¼Œä¸€ä¸ªæ˜¯äººå·¥æ™ºèƒ½AIæ–¹é¢æ˜¯äººå·¥æ™ºèƒ½å¯¼è®ºåˆ°æœºå™¨å­¦ä¹ å†åˆ°nlpã€cvã€ç¥ç»ç½‘ç»œå›¾è®ºæ–¹å‘ï¼Œè¿˜æœ‰ä¸€ä¸ªå¤§æ•°æ®åˆ†æã€å¤§æ•°æ®å±•å¼€çš„ä¸€æ¡çº¿ï¼Œä»¥åŠåµŒå…¥å¼çš„ä¸€æ¡çº¿ã€‚æˆ‘ä»¬å¾ˆå¹¸è¿è¿™äº›æˆ‘ä»¬éƒ½å¯ä»¥è‡ªç”±é€‰æ‹©ã€‚å½“ç„¶è¿™äº›è¯¾ç¨‹ç”±äºæ˜¯æ–°å¼€è¯¾ç¨‹ï¼Œéš¾å…ä¼šæœ‰è®¸å¤šä¸è¶³ä¹‹å¤„ï¼Œä½†æ˜¯è¯¾ç¨‹ä½“ç³»éƒ½æ˜¯ä¸€æ­¥ä¸€æ­¥å®Œå–„çš„ï¼Œç›¸ä¿¡ä¼šåœ¨å°è¯•ä¸­ä¸€æ­¥ä¸€æ­¥å˜å¥½ã€‚</p><p>è°ˆåˆ°æ´›è°·é¢˜ï¼Œå®é™…ä¸Šåˆ·æ´›è°·é¢˜å°±æ˜¯ä¸ºäº†æå‡è‡ªå·±çš„ç¼–ç¨‹èƒ½åŠ›ã€‚è¿™ä¸ªå¯¹äºæˆ‘ä»¬æ‰¾å·¥ä½œä¼šæœ‰å¾ˆå¤§çš„å¸®åŠ©ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸ªæ—¶å€™æ¥è§¦å­¦ä¹ ç®—æ³•é¢˜åˆ°ä¸ºåæ¥ä¸ºå°±ä¸šåˆ·å‰‘æŒ‡offerè¿™äº›èŠ‚çœäº†ä¸å°‘æ—¶é—´ã€‚åŒæ—¶æé«˜äº†æˆ‘ä»¬çš„ç¼–ç¨‹æ°´å¹³ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210710123855465.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h4 id="æœªæ¥è®¡åˆ’"><a href="#æœªæ¥è®¡åˆ’" class="headerlink" title="æœªæ¥è®¡åˆ’"></a>æœªæ¥è®¡åˆ’</h4><p>å®é™…ä¸Šæˆ‘ä»¬20å±Šä¹Ÿç›¸å½“äºä¸€ä¸ªè¿‡æ¸¡çš„è¿‡ç¨‹ï¼Œä»¥åå­¦é™¢ä¼šåˆ å‡æœ‰å…³è¯¾ç¨‹ï¼Œä¸ºäº†å‡è½»åæœŸè´Ÿæ‹…ä¹Ÿä¼šå°†ä¸€äº›è¯¾ç¨‹å‰æ”¾ã€‚</p><p>è°­é™¢é•¿è°ˆåˆ°äº†è½¯ä»¶å·¥ç¨‹è¿™é—¨è¯¾ï¼Œä»–æ‰“ç®—è®©æˆ‘ä»¬è¿™é—¨è¯¾ä¸å¤§åˆ›é¡¹ç›®è”ç³»èµ·æ¥ï¼Œè®©æˆ‘ä»¬è‡ªç”±ç»„é˜ŸçœŸæ­£åšä¸€ä¸ªè¾ƒä¸ºå¤æ‚çš„é¡¹ç›®å·¥ç¨‹ã€‚åˆ†å·¥åˆä½œï¼Œæœ€åä¹Ÿèƒ½æœ‰ä¸€ä¸ªæˆåŠŸçš„é¡¹ç›®ç»å†ã€‚æ–¹ä¾¿ä»¥åæ‰¾å·¥ä½œé¢è¯•æ—¶è®²è§£å±•ç¤ºè‡ªå·±çš„ç»å†ã€‚</p><p>å¦å¤–æœ‰å…³æ…•è¯¾è¯¾ç¨‹ä½“ç³»ã€‚è°­é™¢é•¿è®²åˆ°äº†ä¸ºä»€ä¹ˆå“ˆå·¥å¤§çš„æ…•è¯¾ä½“ç³»è¿™ä¹ˆå—æ¬¢è¿ï¼ŒåŸå› å°±åœ¨äºä»¥ä¸‹å‡ ç‚¹ï¼š1. å“ˆå·¥å¤§3ä¸ªæ ¡åŒºä¸åŒå­¦é™¢éƒ½åˆåŠ›è®¤çœŸåŠã€‚ 2. å°†å­¦é™¢è€å¸ˆæœ€å¥½ä¸€é¢å±•ç¤ºå‡ºæ¥ï¼Œè®¸å¤šå…¶ä»–å¤§å­¦è€å¸ˆéƒ½æ˜¯å¾ˆæœºæ¢°çš„å¿µpptä¸»è¦å› ä¸ºä»–ä»¬æ˜¯åˆ°æ£šé‡Œæ‹æ‘„ï¼Œæ¡ä»¶ä¸æ˜¯å¾ˆå¥½ï¼ŒåŒæ—¶æ‘„å½±å…¬å¸ä¹Ÿå›¾æ–¹ä¾¿çœäº‹ï¼Œä»…ä»…è¿½æ±‚å½•äº†è§†é¢‘ã€‚æ²¡æœ‰è¿½æ±‚è´¨é‡ã€‚è€Œå“ˆå·¥å¤§è€å¸ˆæ˜¯è‡ªç”±æ¼”è®²ï¼Œå¹¶ä¸æ˜¯è®©è€å¸ˆåœ¨é‚£é‡Œå¿µPPTã€‚  </p><p>è€Œæˆ‘ä»¬è®¡ç®—æœºç»„æˆåŸç†çš„æ…•è¯¾å°±æ˜¯å¾ˆæˆåŠŸçš„ï¼Œæ²¡æœ‰ç»™è€å¸ˆä»€ä¹ˆé™åˆ¶ï¼Œè®©è€å¸ˆéšæ„å‘æŒ¥ï¼Œè¿™æ ·èƒ½å¤Ÿæœ€å¤§å‘æŒ¥å‡ºè€å¸ˆçš„èƒ½åŠ›ã€‚ä¹Ÿæ˜¯æœ‰æ…•è¯¾è¿™éƒ¨åˆ†çš„çš„åŸå› ï¼Œæˆ‘ä»¬çš„åé¢çš„è®¡ç®—æœºç»„æˆåŸç†è°­é™¢é•¿ä¹Ÿä¸»ç¼–ç¼–å†™äº†ä¸€æœ¬ä¹¦ï¼Œå—åˆ°äº†å¹¿å¤§å¥½è¯„ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210710134715611.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ol><li>æˆ‘ä»¬è¿™ä¸€å±Šè¿˜æœ‰æ¨¡ç”µä¸€äº›è¯¾ç¨‹ã€</li><li>æˆ‘ä»¬è¿‡æ¸¡ï¼ˆåªæ˜¯å‰ç§»ï¼‰</li><li>æœªæ¥è®¡åˆ’è¯¾ç¨‹çš„åˆ å‡å’Œ</li><li>é€æ­¥çº é”™çš„è¿‡ç¨‹</li><li>å­¦é™¢æˆä½“ç³»çš„ç»“æ„è¯¾ç¨‹<ul><li>è½¯ä»¶å·¥ç¨‹<ul><li>å’Œå¤§åˆ›è”ç³»åˆ°ä¸€èµ·ï¼Œè®©æˆ‘ä»¬ç»„é˜ŸçœŸæ­£åšä¸€ä¸ªé¡¹ç›®</li><li>æ¯ä¸ªäººéƒ½æœ‰é¡¹ç›®ç»å†ã€å¤§å­¦å››å¹´æœ‰ç€ä¸€ä¸ªæˆåŠŸçš„é¡¹ç›®å¯ä»¥æ–¹ä¾¿ä»¥åæ‰¾å·¥ä½œé¢è¯•è®²è§£å±•ç¤º</li></ul></li><li>æ…•è¯¾<ul><li>å“ˆå·¥å¤§çš„ä¾‹å­å³å…´æ¼”è®²ã€æŠŠè€å¸ˆæœ€å¥½ä¸€é¢å……åˆ†å±•ç¤ºã€å“ˆå·¥å¤§æ˜¯å¾ˆå¤šé™¢ã€æ ¡åŒºåˆä½œçš„ç»“æœ</li><li>ä¸€äº›ä¸å¥½çš„ï¼šå¿µPPTã€æ—¶é—´ç´§åœ¨æ£šé‡Œå¾ˆæœºæ¢°</li><li>æˆ‘ä»¬è®¡ç»„æ…•è¯¾å°±æ˜¯ç›¸å¯¹è€Œè¨€å¾ˆæˆåŠŸã€è€å¸ˆå¯ä»¥éšæ„å‘æŒ¥ï¼ˆä¹Ÿæ˜¯å› ä¸ºæ…•è¯¾æ‰€ä»¥åé¢è®¡ç»„æ‰æœ‰å‡ºä¹¦ä¹‹ç±»çš„</li></ul></li></ul></li></ol><h3 id="æ•™æä¹¦ä½“ç³»"><a href="#æ•™æä¹¦ä½“ç³»" class="headerlink" title="æ•™æä¹¦ä½“ç³»"></a>æ•™æä¹¦ä½“ç³»</h3><p>å¦å¤–å°±æ˜¯æˆ‘ä»¬çš„æ•™ç§‘ä¹¦ä½“ç³»è®¡åˆ’ã€‚å­˜å‚¨ã€è®¡ç®—æœºç³»ç»Ÿç»“æ„è¿™ä¸€å—å„¿æ˜¯æˆ‘ä»¬å­¦é™¢çš„å¼ºé¡¹ï¼Œè€Œæˆ‘ä»¬å­¦é™¢ä¹Ÿç»è¿‡å¤šå¹´å¯¹äºè¿™æ–¹é¢çš„æ•™å­¦ä½“ç³»ä¹Ÿæ˜¯éå¸¸æˆç†Ÿå®Œå¤‡ï¼Œæ‰€ä»¥æˆ‘ä»¬å­¦é™¢ä»¥æ­¤ä¸ºå§‹æ¥æ‰“é€ å±äºæˆ‘ä»¬åä¸­å¤§çš„æ•™æä½“ç³»ï¼Œæ˜¯éå¸¸åˆé€‚çš„ã€‚</p><h4 id="è®¡ç®—æœºç»„æˆåŸç†"><a href="#è®¡ç®—æœºç»„æˆåŸç†" class="headerlink" title="è®¡ç®—æœºç»„æˆåŸç†"></a>è®¡ç®—æœºç»„æˆåŸç†</h4><p>è¿™æ˜¯è°­é™¢é•¿äº²è‡ªæ‹…ä»»ä¸»ç¼–çš„ä¸€æœ¬ä¹¦ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬ç›®å‰å­¦é™¢æ•™æä½“ç³»ç¬¬ä¸€æœ¬æˆå‹å‡ºç‰ˆå¹¶æŠ•å…¥å¸‚åœºå¹¿å—å¥½è¯„çš„ä¸€æœ¬ä¹¦ã€‚è°ˆåˆ°è¿™æœ¬ä¹¦ç¼–å†™çš„ç¼˜ç”±ï¼Œè°­é™¢é•¿åˆšå¼€å§‹æ˜¯å¸®å¦ä¸€ä½é™¢é•¿é‡å°ä¹¦ç±å®Œå–„çš„æ—¶å€™å¸®å…¶å†™äº†ä¸¤ç« ï¼Œåæ¥é‚£ä½é™¢é•¿ç”±äºç§ç§åŸå› æ²¡æœ‰é‡å°ã€‚ç›®å‰å¸‚é¢ä¸Šçš„ä¸¤æœ¬ä¸»æµä¹¦ä¸€æœ¬é™ˆæ—§æ™¦æ¶©éš¾æ‡‚ã€ä¸€æœ¬å¤ªè¿‡ç®€ç•¥åªæœ‰ç»†èŠ‚ï¼Œç”¨äºæ•™å­¦éƒ½ä¸å¤ªå¥½ã€‚è€Œä¹‹åæ°å·§å‡ºç‰ˆç¤¾çœ‹åˆ°æˆ‘ä»¬å­¦é™¢çš„è®¡ç®—æœºç»„æˆåŸç†æ…•è¯¾åœ¨æ…•è¯¾å¹³å°ä¸Šå¹¿å—å¥½è¯„ï¼Œäºæ˜¯å°±ä¸»åŠ¨è”ç³»äº†è°­é™¢é•¿çº¦ç¨¿å‡ºä¹¦ï¼Œè°­é™¢é•¿è¿™ä¸ªæ—¶å€™åæ­£å·²ç»å†™äº†ä¸¤ç« ï¼Œå¹²è„†ä¸€ä¸åšäºŒä¸ä¼‘ï¼Œå°±ç¼–å†™äº†æ•´æœ¬ä¹¦ã€‚æœŸé—´è°­é™¢é•¿ä¹Ÿè¡¨ç¤ºæ”¶åˆ°äº†è®¸å¤šå­¦ç”Ÿçš„å¸®åŠ©ç¼–å†™ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210710143306399.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æœ¬ä¹¦åœ¨3æœˆ1å·ç‰ˆä¹‹åä¹Ÿæ˜¯å¾—åˆ°äº†è®¸è®¸å¤šå¤šåŒè¡Œä»¬çš„èµèª‰ä¸é‡‡ç”¨ï¼Œä¹¦é”€é‡å·²ç»è¾¾åˆ°3ä¸‡æœ¬ï¼Œäº¬ä¸œä¸Šå¹¿å—å¥½è¯„ã€‚å·²ç»æœ‰50å¤šæ‰€å­¦æ ¡é‡‡ç”¨è¿™ä¸€æœ¬ä¹¦æ•™å­¦ï¼Œè¿™æ— ç–‘æ˜¯éå¸¸å¥½çš„ä¸€ä¸ªæˆç»©ã€‚è°­é™¢é•¿é€éœ²æœ¬ä¹¦å·²ç»è¢«å‡ºç‰ˆç¤¾è¯„ä¸ºå­£åº¦å¥½ä¹¦ï¼Œä¹Ÿå‡†å¤‡åœ¨è¯„å¹´åº¦å¥½ä¹¦ã€‚æ”¶åˆ°åŒè¡Œçš„èµèª‰çš„åŒæ—¶ï¼Œä¹Ÿæ”¶åˆ°äº†è®¸å¤šæœ‰ä»·å€¼çš„åé¦ˆï¼Œè°­é™¢é•¿ä¹Ÿçº æ­£äº†100å¤šä¸ªä¹¦ä¸­çš„é”™è¯¯ï¼Œå‡†å¤‡å†ç‰ˆã€‚</p><h4 id="æ“ä½œç³»ç»ŸåŸç†"><a href="#æ“ä½œç³»ç»ŸåŸç†" class="headerlink" title="æ“ä½œç³»ç»ŸåŸç†"></a>æ“ä½œç³»ç»ŸåŸç†</h4><p>è¿™é‡Œåˆè¦æåˆ°æˆ‘ä»¬ä¹‹å‰é‡‡è®¿è¿‡çš„é‚µå¿—è¿œæ•™æˆäº†ã€‚è°­é™¢é•¿å‘Šè¯‰æˆ‘ä»¬ï¼Œé‚µå¿—è¿œæ•™æˆè´Ÿè´£æœ¬ä¹¦çš„ç¼–å†™ã€‚æ®è°­é™¢é•¿è¯´é‚µæ•™æˆå‰äº›æ—¥å­ç¿»è¯‘äº†ä¸€æœ¬è‹±æ–‡æ“ä½œç³»ç»Ÿä¹¦ç±ï¼Œå‡ºç‰ˆç¤¾è§‰å¾—é‚µæ•™æˆæ–‡ç¬”å¾ˆä¸é”™ã€‚é‚µæ•™æˆæš‘å‡ç­¹å¤‡ç¼–å†™æ“ä½œç³»ç»ŸåŸç†è¿™ä¸€ä¹¦ç±ã€‚ï¼ˆè¿™ä¹Ÿè®©æˆ‘ä»¬æƒ³åˆ°ä¸Šæ¬¡å»é‡‡è®¿é‚µæ•™æˆçš„æ—¶å€™ä»–æ­£åœ¨å¯¹ç€æ˜¾ç¤ºå±ç¼–å†™ä»£ç ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯æˆ‘ä»¬å³å°†åˆ°æ¥çš„æ“ä½œç³»ç»ŸåŸç†å‘¢ï¼Ÿï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210710142753486.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h4 id="æ„¿æ™¯"><a href="#æ„¿æ™¯" class="headerlink" title="æ„¿æ™¯"></a>æ„¿æ™¯</h4><p>è€Œæ•°å­—ç”µè·¯ä¹¦ç±ä¹Ÿæ­£å¤„äºç¼–å†™ä¹‹ä¸­ï¼Œè¿™ä¸€ç³»åˆ—è®¡ç®—æœºç³»ç»Ÿçš„è¯¾ç¨‹ï¼šæ•°å­—é€»è¾‘ã€æ±‡ç¼–è¯­è¨€å†åˆ°æˆ‘ä»¬çš„è®¡ç»„ä»¥åŠä¹‹åçš„ç³»ç»Ÿç»“æ„ã€æ¥å£æŠ€æœ¯å½¢æˆæˆ‘ä»¬å­¦é™¢çš„ç‹ç‰Œè¯¾ç¨‹ä½“ç³»ã€‚å­¦é™¢æ„¿æ™¯æ˜¯éå¸¸å¥½çš„ã€‚ä¹Ÿå¸Œæœ›æˆ‘ä»¬äº«å—åˆ°å­¦é™¢ä½“ç³»åŒæ—¶ä¹Ÿèƒ½ä¸ºå…¶å®Œå–„å‡ºä¸€ä»½åŠ›ï¼</p><ol><li><p>è®¡ç»„çš„çš„ç¼–å†™ï¼ˆ</p><ul><li>ç¼˜ç”± ï¼ˆé‡å°å†™äº†ä¸¤ç« ã€å°åˆ·ç¤¾æ…•è¯¾</li><li>ç°æœ‰ä¸¤æœ¬ä¹¦ä¸æ€ä¹ˆæ ·ï¼ˆå“ˆå·¥å¤§é™ˆæ—§æ™¦æ¶©ã€å¦å¤–ä¸€æœ¬æ–‡ç§‘ä¸€æ ·éå¸¸ç²—ç³™ã€å®Œå…¨æ²¡æœ‰ç»†èŠ‚ï¼‰ã€å­¦é™¢è¿™æ–¹é¢å¾ˆæˆç†Ÿæœ‰ä½“ç³»ï¼Œæ•™å­¦ä¸Šå¾ˆå®Œå¤‡ã€‚</li><li>ä¸å®éªŒç»“åˆéå¸¸å¥½ã€ç»†èŠ‚éå¸¸å®Œå¤‡</li><li>ä¹¦é”€é‡ã€å¸‚åœºå¥½50å„å­¦æ ¡ï¼ˆäº¬ä¸œ 3ä¸‡å†Œã€è¯„å­£åº¦å¥½ä¹¦ã€å‡†å¤‡è¯„å¹´åº¦</li><li>åœ°å¤§çš„é—®é¢˜ï¼ˆå¤§ä¸€å­¦ã€åŸºç¡€ä¸ç‰¢ã€æ— ç¨‹åºè®¾è®¡åŸºç¡€å’Œç”µè·¯ã€æ±‡ç¼–åŸºç¡€éƒ½æ²¡æœ‰</li><li>ç”¨æˆ·åé¦ˆå‡†å¤‡æ”¹è¿›ï¼Œçº æ­£äº†100ä¸ªé”™è¯¯</li></ul></li><li><p>é‚µæ•™æˆæ“ä½œç³»ç»Ÿ</p><ul><li>ä»–è§‰å¾—ç›®å‰æ•™æä¸å¥½</li><li>ç¿»è¯‘äº†ä¸€æœ¬è‹±æ–‡æ“ä½œç³»ç»Ÿï¼Œå‡ºç‰ˆç¤¾è§‰å¾—æ–‡ç¬”å¥½ï¼ˆæˆ‘ä»¬ä¸Šæ¬¡é‡‡è®¿å°±åœ¨é‚£å„¿å†™ä»£ç ï¼ˆæ²¡æƒ³åˆ°æ·±è—ä¸éœ²å•Šï¼‰ï¼‰</li><li>æ“ä½œç³»ç»ŸåŸç†æš‘å‡ç­¹å¤‡ç¼–å†™</li></ul></li></ol><ol start="3"><li><p>æ•°å­—ç”µè·¯ä¹¦æ­£åœ¨ç¼–å†™</p></li><li><p>æ•´ä¸ªä½“ç³»ç»“æ„çš„æµç¨‹å˜åŒ–ï¼ˆå¸Œæœ›æ•°å­—ç”µè·¯ã€è®¡ç»„ã€ç¡¬ä»¶è®¾è®¡æˆä¸ºåç§‘ç‰¹è‰²ä½“ç³»ï¼Œè¿™æ–¹é¢æœ¬å°±æ˜¯æˆ‘ä»¬ä¼˜åŠ¿ï¼šå­˜å‚¨è®¡ç®—æœºç³»ç»Ÿç»“æ„è¿™ä¸€å—å„¿ã€‚</p></li></ol><h3 id="è¯¾ç¨‹è¯„ä»·"><a href="#è¯¾ç¨‹è¯„ä»·" class="headerlink" title="è¯¾ç¨‹è¯„ä»·"></a>è¯¾ç¨‹è¯„ä»·</h3><p>æœ‰å…³è¯¾ç¨‹è¯„ä»·æ–¹é¢ï¼Œè°­é™¢é•¿ä¹Ÿæœ‰è®¸å¤šè‡ªå·±çš„çœ‹æ³•ï¼šä¸€ä¸ªæ˜¯æ•™åŠ¡å¤„çš„ç½‘ä¸Šè¯„æ•™ç³»ç»Ÿï¼Œå¦ä¸€ä¸ªæ˜¯é™¢é•¿è‡ªå·±ä¸»æŒçš„æœŸæœ«è´¨é‡é—®å·ï¼š</p><ol><li>ç½‘ä¸Šè¯„æ•™<ul><li>å®¢è§‚è¯„ä»·</li><li>è¯„æ•™æœ¬èº«å­˜åœ¨ä¸€å®šé—®é¢˜ï¼šæŒ‡æ ‡å¤ªå¤šã€æ•™åŠ¡å¤„ä¸å­¦ç”Ÿé‡å¿ƒä¸åŒ</li></ul></li><li>æœŸæœ«è´¨é‡é—®å·</li></ol><ul><li>ä¸è¦èµ¶æ—¶é—´å°±éšæ„ï¼Œå¸Œæœ›åŒå­¦ä»¬å¯ä»¥è®¤çœŸç¼–å†™</li><li>å°½é‡ç”µè„‘å†™ï¼Œæ‰‹æœºæ‰“å­—ä¸èˆ’æœ</li><li>äººèº«æ”»å‡»ä¸å¯å–</li><li>æœ‰æ„è§ç›´æ¥æï¼ˆä»–ä¼šæ‰¾ä¸æ»¡æ„çš„è€å¸ˆè°ˆè¯ï¼‰</li><li>å¥½çš„è€å¸ˆå‹‡äºå¤¸èµï¼Œé™¢é•¿ä¼šç»™è€å¸ˆå‘è¿™äº›å¥½çš„è¯„ä»·ã€è€å¸ˆå—é¼“èˆï¼Œå½¢æˆè‰¯æ€§å¾ªç¯ã€‚</li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210710123855467.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="æœ¬ç§‘ç”Ÿæœªæ¥æ‰“ç®—"><a href="#æœ¬ç§‘ç”Ÿæœªæ¥æ‰“ç®—" class="headerlink" title="æœ¬ç§‘ç”Ÿæœªæ¥æ‰“ç®—"></a>æœ¬ç§‘ç”Ÿæœªæ¥æ‰“ç®—</h2><h3 id="å®ä¹ "><a href="#å®ä¹ " class="headerlink" title="å®ä¹ "></a>å®ä¹ </h3><h4 id="åå‚¨ç­"><a href="#åå‚¨ç­" class="headerlink" title="åå‚¨ç­"></a>åå‚¨ç­</h4><p>å®ä¹ çš„è¯ï¼Œè°­é™¢é•¿è°ˆåˆ°äº†åä¸ºçš„åå‚¨ç­ï¼Œæˆ‘ä»¬å­¦é™¢ä¸åä¸ºåˆä½œäº†ä¸€ä¸ªåå‚¨ç­å®ä¹ ç­çº§ï¼Œç­‰åˆ°å¤§å››çš„æ—¶å€™ä¼šæœ‰æˆ‘ä»¬å­¦é™¢çš„å­¦ç”Ÿç»„æˆä¸€ä¸ªç­çº§å»åä¸ºä¼ä¸šè¿›è¡Œä¸€ä¸ªä¸ºæœŸä¸€å¹´çš„æ·±å…¥å®ä¹ ï¼Œè¿™å¯æ˜¯ä¸€ä¸ªç»ä½³çš„æœºä¼šï¼Œåä¸ºä¼šå¯¹æˆ‘ä»¬ç­çº§åŒå­¦è¿›è¡Œæ·±å…¥ç»†è‡´çš„åŸ¹è®­ï¼Œç›¸å½“äºä¸€ä¸ªå¾ˆå¥½èå…¥æ¥è§¦å·¥ä¸šç•Œçš„æœºä¼šã€‚è°­é™¢é•¿æåˆ°å®ä¹ è–ªèµ„æ˜¯éå¸¸é«˜çš„ï¼Œ6000ä¸€æœˆï¼Œåä¸ºæœ¬æ„å°±æ˜¯ä¸ºè‡ªå·±ä¼ä¸šåŸ¹å…»å‘˜å·¥ï¼Œç»™å‡ºäº†å¾ˆå¤§çš„è¯šæ„ã€‚</p><p>è°­é™¢é•¿ä¹Ÿé¼“åŠ±æˆ‘ä»¬è®¡å“çš„åŒå­¦éƒ½å»åŠªåŠ›äº‰å–ä¸€ä¸‹è¿™ä¸ªæœºä¼šã€‚å› ä¸ºåˆšå¼€å§‹ä»Šå¹´è¿™ä¸€å±Šåªæ”¶äº†10ä¸ªï¼Œåˆ°æˆ‘ä»¬é‚£ä¸€å±Šï¼Œå°±ä¼šå˜æˆå¾ˆå¤šäººï¼Œåˆ°æ—¶å€™é¢„è®¡æœ€å¤šå¯ä»¥æœ‰80ä¸ªï¼ˆå½“ç„¶å¾ˆä¹è§‚ä¼°è®¡äº†ï¼‰ã€‚</p><h4 id="å“è¶Šç­å®‰æ’"><a href="#å“è¶Šç­å®‰æ’" class="headerlink" title="å“è¶Šç­å®‰æ’"></a>å“è¶Šç­å®‰æ’</h4><p>ç›¸æ¯”ä¹‹ä¸‹å“è¶Šç­æœ‰ä¸€ä¸ªä¼˜åŠ¿å°±æ˜¯å¤§å››æ²¡æœ‰è¯¾ï¼Œå­¦é™¢æœ¬æ¥å®‰æ’å°±æ˜¯è®©å“è¶Šç­çš„åŒå­¦å‡ºå»å®ä¹ ï¼Œè¿™ä¸€å¹´çš„å®ä¹ æ—¶é—´æ˜¯å¾ˆæœ‰ä¼˜åŠ¿çš„ã€‚è°­é™¢é•¿å¸Œæœ›æˆ‘ä»¬èƒ½å¤Ÿå¥½å¥½åˆ©ç”¨è¿™ä¸€å¹´ã€‚è¿‡å»å­¦é™¢æ˜¯ç»™å®‰æ’ï¼Œå»æ­¦æ±‰ä¸€å®¶ä¼ä¸šï¼Œä½†æ˜¯å¾ˆå¤šåŒå­¦ä¼šä¸æ»¡æ„å­¦é™¢ç»™çš„å¹³å°ã€‚ç°å¦‚ä»Šä¸»è¦å°±æ˜¯æˆ‘ä»¬è‡ªå·±æ‰¾å®ä¹ æœºä¼šã€‚</p><h3 id="å‡ºå›½"><a href="#å‡ºå›½" class="headerlink" title="å‡ºå›½"></a>å‡ºå›½</h3><p>è°­é™¢é•¿è°ˆåˆ°äº†å‡ºå›½ä¸»è¦æœ‰ä¸¤æ¡è·¯ï¼Œä¸€ä¸ªæ˜¯è¯»åšï¼Œä¸€ä¸ªæ˜¯è¯»ç¡•ã€‚è¯»ç¡•çš„è¯ï¼Œæ¯”è¾ƒè´µä¸€ç‚¹ï¼Œå°½é‡é€‰ä¸€ä¸ªå¥½å­¦æ ¡ã€‚è¯»åšçš„è¯éœ€è¦å¾…æŒºé•¿æ—¶é—´ã€‚å¦å¤–å‡ºå›½éœ€è¦æˆ‘ä»¬æ—©åšæ‰“ç®—ï¼Œä¸è¦ä¸€å‘³å·åŠ æƒã€‚</p><h3 id="åå‘å°±ä¸šè¿˜æ˜¯åŠ æƒ"><a href="#åå‘å°±ä¸šè¿˜æ˜¯åŠ æƒ" class="headerlink" title="åå‘å°±ä¸šè¿˜æ˜¯åŠ æƒ"></a>åå‘å°±ä¸šè¿˜æ˜¯åŠ æƒ</h3><p>ç›¸æ¯”ä¹‹ä¸‹ï¼š</p><ul><li>æœ¬ç¡•åšç­åç ”ç©¶æ‰€ä»¥è¯¾ç¨‹æ¯”è¾ƒå®½æ¾ã€è€Œä¸”å¸Œæœ›èƒ½å¤Ÿè¿›å®éªŒå®¤åšé¡¹ç›®ç§‘ç ”ã€‚</li><li>å“å·¥ç­åå‘å°±ä¸šã€å·¥ä¸šç•Œäººæ‰æ‰€ä»¥æœ‰å¤§å››ä¸€å¹´æœºä¼šå®ä¹ ã€‚</li><li>æ™®é€šç­çº§çš„è¯è¾ƒä¸ºç»¼åˆä¸€äº›ã€‚</li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210710123855477.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ol><li>å®ä¹ ï¼ˆå“è¶Šç­<ul><li>å“è¶Šç­ä¼˜åŠ¿ï¼ˆå¤§å››ä¸€å¹´ã€</li><li>åå‚¨ç­</li><li>è¿‡å»æ˜¯æ€ä¹ˆå®‰æ’çš„ã€ä¸æ»¡æ„</li><li></li></ul></li><li>å‡ºå›½<ul><li>è¯»åšï¼ˆå…³é”®å¥½è€å¸ˆã€</li><li>è¯»ç¡•ï¼ˆå¥½å­¦æ ¡ï¼Œå­¦è´¹æ¯”è¾ƒè´µã€</li><li>æ—©åšæ‰“ç®—ã€ä¸è¦åªå·åŠ æƒ</li></ul></li><li>å·¥ä½œ</li><li>åå‘å°±ä¸šè¿˜æ˜¯åå‘ç ”ç©¶<ul><li>ç›¸æ¯”ä¹‹ä¸‹ï¼šå“å·¥ç­åå‘å°±ä¸šã€ä¸ºå›½å®¶åŸ¹å…»å·¥ä¸šç•Œäººæ‰ï¼Œæ‰€ä»¥æœ‰å¤§å››ä¸€å¹´æœºä¼šå®ä¹ ã€‚</li><li>æœ¬ç¡•åšç­åç ”ç©¶æ‰€ä»¥è¯¾ç¨‹æ¯”è¾ƒå®½æ¾ã€è€Œä¸”å¸Œæœ›èƒ½å¤Ÿè¿›å®éªŒå®¤åšé¡¹ç›®ç§‘ç ”ï¼Œç›®çš„æ˜¯ä¸ºå›½å®¶åŸ¹å…»ç§‘å­¦å®¶ã€‚</li></ul></li></ol><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210710150424863.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="åˆ›æ–°åˆ›ä¸šæ´»åŠ¨"><a href="#åˆ›æ–°åˆ›ä¸šæ´»åŠ¨" class="headerlink" title="åˆ›æ–°åˆ›ä¸šæ´»åŠ¨"></a>åˆ›æ–°åˆ›ä¸šæ´»åŠ¨</h2><h3 id="å¤§ç–†è®¡åˆ’"><a href="#å¤§ç–†è®¡åˆ’" class="headerlink" title="å¤§ç–†è®¡åˆ’"></a>å¤§ç–†è®¡åˆ’</h3><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://mmbiz.qpic.cn/mmbiz_jpg/ZEDY7NCtoLE0VYWXYxyn8BElkrD9XfdykgGOkknjTGKODYsmLXpSFHd2HE67yUwDN0F2NuOiaMs56pjJibXshYkA/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="å¤§ç–†è®¡åˆ’"></p><p>å¤§ç–†å‡æœŸå¤ä»¤è¥ï¼Œâ€ç–†æ¥è®¡åˆ’â€œå­¦é™¢æœ‰ç›¸å½“å¤šçš„æŠ•å…¥çš„ï¼Œå·²ç»æŠ•å…¥äº†80ä¸‡ï¼Œè€Œä¸”é¢„è®¡è¿˜ä¼šæœ‰åæœŸæŒç»­æŠ•å…¥ã€‚è°­é™¢é•¿ä¹Ÿå¸Œæœ›æˆ‘ä»¬å­¦ç”Ÿä¹Ÿèƒ½å¤Ÿé…åˆå®£ä¼ å‚ä¸ä¸€ä¸‹è¿™ä¸ªé¡¹ç›®ã€‚æ„Ÿå…´è¶£çš„åŒå­¦ï¼Œå¯ä»¥è€ƒåŠ©æ•™èµ„æ ¼è¯ï¼Œåç»­å¯ç»„é˜Ÿå‚åŠ robmasteræœºç”²å¤§èµ›ã€‚è¯¦æƒ…å¯ä»¥å…³æ³¨è¿™ä¸ªé“¾æ¥ï¼š<a href="https://mp.weixin.qq.com/s?__biz=MzkwNDI1Mjg3Mg==&mid=2247484105&idx=1&sn=2bdec2193c6c48f65f1a071d89655d01&chksm=c0889e6ef7ff1778dd6e9b620a19950dcef20822ecceb2eea9875c4d19afcd115338621d01f2&mpshare=1&scene=23&srcid=0706PQD8F6sDi7qwHK7HiODW&sharer_sharetime=1625821467053&sharer_shareid=30d0313b4bbee7c5e2c1ec3fad8ff149#rd" target="_blank" rel="noopener">æˆ‘åœ¨ç–†æ¥ç­‰ä½ â€”â€”â€œç–†æ¥è®¡åˆ’â€æ´»åŠ¨æŠ¥å (qq.com)</a></p><h3 id="æ™ºèƒ½ç‰©æµæœºå™¨äººã€æ— äººæœºé¡¹ç›®"><a href="#æ™ºèƒ½ç‰©æµæœºå™¨äººã€æ— äººæœºé¡¹ç›®" class="headerlink" title="æ™ºèƒ½ç‰©æµæœºå™¨äººã€æ— äººæœºé¡¹ç›®"></a>æ™ºèƒ½ç‰©æµæœºå™¨äººã€æ— äººæœºé¡¹ç›®</h3><p>æˆ‘ä»¬ç”±äºä¸ä¸ç”µä¿¡å­¦é™¢é‚£é‡Œé‡å ï¼Œæˆ‘ä»¬é€‰äº†ä¸ä»–ä»¬ä¸åŒçš„èµ›é“ï¼Œæˆ‘ä»¬é€‰çš„ä¹Ÿæ˜¯æœ€éš¾çš„ä¸€ä¸ªèµ›é“ï¼Œè¿™ä¸ªä¹Ÿæ˜¯æš‘å‡å®è·µé¡¹ç›®ï¼ŒåŒæ—¶è°­é™¢é•¿ä¹Ÿå»ºè®®æˆ‘ä»¬ç­çº§å¯ä»¥å¤šç»„å‡ ä¸ªé˜Ÿï¼Œåˆ°æ—¶å€™é™¢å†…å°±å¯ä»¥æ‰“æ¯”èµ›ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210710154952769.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="å­¦ç”Ÿç¤¾å›¢"><a href="#å­¦ç”Ÿç¤¾å›¢" class="headerlink" title="å­¦ç”Ÿç¤¾å›¢"></a>å­¦ç”Ÿç¤¾å›¢</h3><p>è°­é™¢é•¿ä¹Ÿè°ˆåˆ°äº†æœ‰å…³æœºæ¢°å­¦é™¢ï¼Œè®²åˆ°æœºæ¢°å­¦é™¢ç¤¾å›¢æ°›å›´æµ“åšï¼Œæœ‰ä¸Šç™¾ä¸ªå­¦ç”Ÿç¤¾å›¢ï¼Œä»–è¯´ä»–å¸Œæœ›æˆ‘ä»¬é™¢æœ€åä¹Ÿæœ‰è¿™ä¹ˆæµ“åšçš„æ°›å›´ï¼Œä»¥åè®¡ç®—æœºå­¦é™¢å¤§æ¥¼å»ºå¥½åï¼Œé™¢é•¿æ‰“ç®—ä¸€æ¥¼å…¨ç»™æˆ‘ä»¬å­¦ç”Ÿåˆ›ä¸šåˆ›æ–°ä½¿ç”¨ï¼Œæ”¯æŒæˆ‘ä»¬çš„åˆ›æ–°åˆ›ä¸šé¡¹ç›®ã€‚</p><h1 id="å†™åœ¨æœ€å"><a href="#å†™åœ¨æœ€å" class="headerlink" title="å†™åœ¨æœ€å"></a>å†™åœ¨æœ€å</h1><p>è®¿è°ˆæŒç»­äº†ä¸¤ä¸ªå°æ—¶ï¼Œè®¿è°ˆä¸ä¹æ¬¢å£°ç¬‘è¯­ï¼Œæ›´æœ‰æœ‰è®¤çœŸæ·±å…¥è®¨è®ºã€‚è°­é™¢é•¿ä¸€ç‚¹æ²¡æœ‰é™¢é•¿çš„æ¶å­ï¼Œå¾ˆå’Œå–„å¾ˆè®¤çœŸçš„ä¸æˆ‘ä»¬è®¨è®ºé—®é¢˜ä¸è¡¨è¾¾æƒ³æ³•ã€‚åœ¨æ­¤å†æ¬¡æ„Ÿè°¢è°­å¿—è™å‰¯é™¢é•¿ç»™æˆ‘ä»¬è¿™æ ·ä¸€ä¸ªè®¿è°ˆã€æ·±å…¥äº¤æµçš„æœºä¼šï¼Œæˆ‘ä»¬ä¹Ÿæ›´å¥½çš„äº†è§£äº†æˆ‘ä»¬è¯¾ç¨‹çš„å®‰æ’ä¸è®¡åˆ’ã€‚ä¹Ÿæ­£å¦‚æˆ‘ä»¬æœ€åæˆ‘ä»¬è¡¨ç¤ºçš„é‚£æ ·ï¼Œæˆ‘ä»¬éƒ½è§‰å¾—æ‚¨ç›®å‰ä¸ºæ­¢åšçš„å·¥ä½œéå¸¸å¥½ã€éå¸¸è€ƒè™‘åˆ°æˆ‘ä»¬å­¦ç”Ÿçš„åˆ‡èº«ä½“éªŒä¸æœªæ¥å‘å±•ã€‚æ‚¨çœ‹æˆ‘ä»¬å¤¸ä¹Ÿä¸å¥½æ„æ€åœ°ç¬‘äº†ã€‚è¿™é‡Œå†æ¬¡è¡¨è¾¾å¯¹æ‚¨ä¸ªäººçš„è°¢æ„ä¸æ‚¨å·¥ä½œæ€åº¦çš„æ•¬æ„ï¼</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210710152430940.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>åŒæ—¶ä¹Ÿå¤¸èµä¸€ä¸‹æˆ‘ä»¬å®è·µé˜Ÿåœ¨æ­¤æ¬¡è®¿è°ˆä¸­åšçš„åŠªåŠ›ï¼š</p><p>æ¨é‡Šç„¶åŒå­¦å…¨ç¨‹ä¸¾ç€ç›¸æœºæ‘„åƒï¼Œæ²¡æœ‰éœ²é¢ã€‚å§œæ˜±åŒå­¦å’Œæˆ‘ä¹Ÿåœ¨11ç‚¹åˆšå›å®¿èˆå°±å¼€å§‹ç€æ‰‹åæœŸå¤„ç†ï¼Œæˆ‘å†™æ–‡æ¡ˆè®¿è°ˆæ€»ç»“ä»–å¤„ç†åŠ å·¥è§†é¢‘ï¼Œä»ä¸Šåˆ11ç‚¹å¼€å§‹ä¸åœæ­‡åšåˆ°ä¸‹åˆ4ç‚¹ï¼Œæˆ‘è®¿è°ˆæ€»ç»“é©¬ä¸Šå†™å®Œäº†ï¼Œå§œæ˜±åŒå­¦ä¼°è®¡ä»éœ€è¦æŒºé•¿æ—¶é—´å¤„ç†å‰ªè¾‘ï¼Œä»¥åŠåŠ ç‰¹æ•ˆã€‚</p><p>å¸Œæœ›æˆ‘ä»¬ç»§ç»­åŠªåŠ›ï¼ğŸ¥³</p><p>ç”±äºå¾®ä¿¡å…¬ä¼—å·é™åˆ¶ï¼Œæˆ‘ä»¬è¿™é‡Œæ²¡æœ‰åŠæ³•å‘æ”¾è§†é¢‘å½•åƒã€‚è¿™é‡Œæˆ‘ä»¬å°†å…¶ä¸Šä¼ è‡³Githubå¹³å°ä¸bilibiliå¹³å°ï¼Œå…¶ä¸­Githubå¹³å°æœ‰ç€æ‰€æœ‰åŒ…æ‹¬æ•´ä¸ªå®è·µé˜Ÿå®è·µè¿‡ç¨‹çš„å…¨è®°å½•ï¼Œä¹Ÿæ¬¢è¿å¤§å®¶æŠ•å¸è§†é¢‘ä¸staræˆ‘ä»¬é¡¹ç›®ï¼</p><p>Githubå¹³å°ç½‘å€ï¼š<a href="https://github.com/LRY89757/the-exploration-of-HUST-and-CS" target="_blank" rel="noopener">https://github.com/LRY89757/the-exploration-of-HUST-and-CS</a></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/2021071015584961.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>bilibiliå¹³å°ç½‘å€ï¼š</p><p>å›¾ç‰‡</p><h1 id="å½©è›‹"><a href="#å½©è›‹" class="headerlink" title="å½©è›‹"></a>å½©è›‹</h1><p>æœ€åè°­é™¢é•¿ç»™æˆ‘ä»¬æ¯äººè¿˜é€äº†ä¸€æœ¬è®¡ç®—æœºç»„æˆåŸç†ä¹¦ç±ï¼Œè¿™æ³¢çœŸæ˜¯æƒŠå–œæ¬¸ï¼å°±å·®è¦ä¸ªç­¾åäº†ğŸ˜</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210710143606742.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>è®¿è°ˆï¼šé€¯æ¶¦é›¨ã€å§œæ˜±        è®¿è°ˆæ€»ç»“ä¸æ–‡æ¡ˆç¼–å†™ï¼šé€¯æ¶¦é›¨       è§†é¢‘å‰ªè¾‘ç‰¹æ•ˆåŠ å·¥å¤„ç†ï¼šå§œæ˜±        è§†é¢‘æ‹æ‘„ï¼šæ¨é‡Šç„¶      </p><p>â€‹                                                                                                                     2021å¹´7æœˆ10æ—¥è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯å­¦é™¢å—ä¸€æ¥¼</p>]]></content>
      
      
      <categories>
          
          <category> è®°å½• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¿è°ˆ </tag>
            
            <tag> ç¤¾ä¼šå®è·µ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æš‘æœŸå®è·µæ„Ÿæ…¨</title>
      <link href="/2021/09/06/shu-qi-shi-jian-gan-kai/"/>
      <url>/2021/09/06/shu-qi-shi-jian-gan-kai/</url>
      
        <content type="html"><![CDATA[<h3 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h3><p> æˆ‘æ˜¯2021è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯å­¦é™¢èµ´åä¸­ç§‘æŠ€å¤§å­¦â€œæ¢ç§‘è®¿è®¡â€æš‘æœŸç¤¾ä¼šå®è·µé˜Ÿé˜Ÿé•¿é€¯æ¶¦é›¨ã€‚è½¬çœ¼é—´å®è·µæ´»åŠ¨å·²ç„¶ç»“æŸï¼Œèº«ä¸ºé˜Ÿé•¿ï¼Œä¸ªäººä¹Ÿæ˜¯å­¦åˆ°äº†è®¸è®¸å¤šå¤šç»éªŒä¸æ•™è®­ï¼Œç»„ç»‡ä»»åŠ¡ã€å®‰æ’äººæ‰‹ã€ä¸è€å¸ˆæ²Ÿé€šè¿™äº›äº‹æƒ…å¹¶ä¸æ˜¯é‚£ä¹ˆç®€å•ã€‚æˆ‘ä¸ªäººæƒ³ä»é€‰ä¸»é¢˜ï¼Œåˆ°è”ç³»å¯¼å¸ˆï¼Œå†åˆ°æˆ‘ä»¬æ•´ç†ææ–™ã€åˆ†å·¥å†™æ¨æ–‡ã€å‰ªè¾‘è§†é¢‘ã€åˆ¶ä½œç½‘é¡µè¿™äº›æ–¹é¢æ¥ç®€å•æ€»ç»“æ¦‚æ‹¬ä¸€ä¸‹æœ¬æ¬¡å®è·µæ´»åŠ¨ã€‚</p><h3 id="é€‰æ‹©ä¸»é¢˜"><a href="#é€‰æ‹©ä¸»é¢˜" class="headerlink" title="é€‰æ‹©ä¸»é¢˜"></a>é€‰æ‹©ä¸»é¢˜</h3><p>æˆ‘ä»¬åœ¨ä¼—å¤šçš„ä¸»é¢˜ä¸­é€‰æ‹©äº†â€œæˆ‘çš„åä¸­å¤§â€ä¸»é¢˜ã€‚å®é™…ä¸Šæ˜¯ç»è¿‡ååˆ†æ…é‡è€Œè®¤çœŸçš„è€ƒè™‘çš„ï¼Œâ€œæ¢ç§‘è®¿è®¡â€è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯å­¦é™¢èµ´åä¸­ç§‘æŠ€å¤§å­¦æš‘æœŸç¤¾ä¼šå®è·µé˜Ÿ å†æ¥å­¦æ ¡å­¦é™¢ä»¥ä½è°ƒç¤ºäººï¼Œå®£ä¼ åŠ›åº¦ä¸å¤Ÿï¼Œæˆ‘ä»¬æ—¨åœ¨å‘æ˜å‡ºæˆ‘ä»¬å­¦é™¢çš„ä¼˜ç§€ç²¾ç¥äº‹è¿¹ï¼ŒåŠ å¤§å­¦é™¢çš„æœ‰å…³å®£ä¼ ä¸å†å²çš„æ¢ç´¢ã€‚è®©æ›´å¤šäººå¼€å§‹äº†è§£åä¸­ç§‘å­¦æŠ€æœ¯å¤§å­¦è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯å­¦é™¢ï¼ŒåŒæ—¶ä¹Ÿæ›´åŠ è®©æˆ‘ä»¬æ ¡å‹ä»¬æ›´åŠ äº†è§£æˆ‘ä»¬å­¦é™¢ã€‚è€Œæ­£æ˜¯å› ä¸ºå¦‚æ­¤æˆ‘ä»¬è§‰å¾—è¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„ä¸»é¢˜ï¼Œæ‰€ä»¥ä¸€è‡´é€šè¿‡äº†è¿™ä¸ªä¸»é¢˜ã€‚</p><h3 id="ä¸ªäººå°è±¡æ·±åˆ»çš„ä¸€äº›ç»å†"><a href="#ä¸ªäººå°è±¡æ·±åˆ»çš„ä¸€äº›ç»å†" class="headerlink" title="ä¸ªäººå°è±¡æ·±åˆ»çš„ä¸€äº›ç»å†"></a>ä¸ªäººå°è±¡æ·±åˆ»çš„ä¸€äº›ç»å†</h3><h4 id="é‡‡è®¿é‚µå¿—è¿œæ•™æˆ"><a href="#é‡‡è®¿é‚µå¿—è¿œæ•™æˆ" class="headerlink" title="é‡‡è®¿é‚µå¿—è¿œæ•™æˆ"></a>é‡‡è®¿é‚µå¿—è¿œæ•™æˆ</h4><p>åˆšå¼€å§‹çš„æ—¶å€™æ•™æˆå¯¹æˆ‘ä»¬è®¿è°ˆçš„å½¢å¼æœ‰è¯¯è§£ï¼Œæœ¬æ¥ä»¥ä¸ºä¸éœ€è¦æ‹è§†é¢‘ï¼Œå´å‘ç°æˆ‘ä»¬è¦å½•åƒã€‚è¿™ç¡®å®æ˜¯æˆ‘çš„é—®é¢˜ï¼Œæ²¡æœ‰æå‰å’Œé‚µæ•™æˆæ²Ÿé€šå¥½ï¼Œä¸è¿‡åæ¥é‚µæ•™æˆä¹Ÿæ˜¯è¶³å¤Ÿå¹³æ˜“è¿‘äººï¼Œé‡Šæ”¾äº†è¶³å¤Ÿçš„å–„æ„ã€‚æ„¿æ„æˆ‘ä»¬å½•è§†é¢‘è¿›è¡Œç›¸å…³çš„è®°å½•ï¼Œæ•´ä¸ªè®¿è°ˆçš„è¿‡ç¨‹å€’æ˜¯éå¸¸çš„é¡ºåˆ©ã€‚è®²äº†è®¸å¤šæ•™æˆæœ¬äººå¯¹åç§‘çš„çœ‹æ³•ä¸è®¤è¯†ï¼Œä¹Ÿå¯¹æˆ‘ä»¬è®²äº†è®¸è®¸å¤šå¤šçš„ä¸“ä¸šçŸ¥è¯†ï¼Œç»™äº†æˆ‘ä»¬æœ¬ç§‘ç”Ÿè®¸å¤šå»ºè®®ã€‚å¯ä»¥çœ‹å‡ºé‚µæ•™æˆæ˜¯å¾ˆæ¬¢è¿æˆ‘ä»¬æœ¬ç§‘ç”Ÿå»æ‰¾ä»–èŠå¤©ã€å»æ‰¾ä»–å’¨è¯¢ä¸“ä¸šçš„æœ‰å…³çŸ¥è¯†çš„ã€‚ä¸æ„§æ˜¯åä¸­ç§‘æŠ€å¤§å­¦è®¡ç®—æœºå­¦é™¢å·¥ä½œå¤šå¹´çš„â€œè€â€æ•™æˆï¼Œé¢‡å…·å­¦è€…é£èŒƒã€‚éå¸¸æ„Ÿè°¢æ•™æˆçš„åˆä½œè®¿è°ˆï¼</p><h4 id="é‡‡è®¿è°­å¿—è™å‰¯é™¢é•¿"><a href="#é‡‡è®¿è°­å¿—è™å‰¯é™¢é•¿" class="headerlink" title="é‡‡è®¿è°­å¿—è™å‰¯é™¢é•¿"></a>é‡‡è®¿è°­å¿—è™å‰¯é™¢é•¿</h4><p>é‡‡è®¿è°­å¿—è™é™¢é•¿æ—¶å€™æˆ‘ä»¬å°±è°¨æ…å¤šäº†ï¼Œæå‰å’Œé™¢é•¿æ²Ÿé€šå¥½è¦æœ‰è§†é¢‘é‡‡è®¿ã€‚é™¢é•¿ä¹Ÿååˆ†çˆ½å¿«åœ°åŒæ„äº†æˆ‘ä»¬çš„è¯·æ±‚ã€‚äº‹å…ˆå®Œå…¨æ²¡æœ‰æƒ³åˆ°è®¿è°ˆè¿‡ç¨‹ä¼šå¦‚æ­¤é¡ºåˆ©ï¼Œé‡‡è®¿å‰è¿˜æ‹…å¿ƒä¼šä¸ä¼šè°­é™¢é•¿ä¸æ„¿æ„æ¥å—æˆ‘ä»¬çš„é‚€è¯·ï¼Œä½†æ˜¯å¼ è¾…å¯¼å‘˜é¼“åŠ±æˆ‘ä»¬å»å’Œé™¢é•¿äº¤æµï¼Œè¯´è°­å‰¯é™¢é•¿è¿˜æ˜¯å¾ˆæ¬¢è¿æœ¬ç§‘ç”Ÿæ‰¾ä»–å»äº¤æµçš„ã€‚æœç„¶ç¬¬ä¸€å¤©æ™šä¸Šè”ç³»ï¼Œç¬¬äºŒå¤©å°±ç¡®å®šå¹¶å¼€å§‹äº†è®¿è°ˆã€‚é™¢é•¿å¾ˆçˆ½å¿«çš„æŠ½å‡ºäº†å°†è¿‘ä¸€ä¸Šåˆçš„æ—¶é—´æ¥å—æˆ‘ä»¬çš„è®¿è°ˆå¹¶ä¸”è¿˜å¾ˆç»†è‡´å…¥å¾®è®²è§£æˆ‘ä»¬å­¦é™¢æœªæ¥çš„è§„åˆ’ä¸æ‰“ç®—ã€æˆ‘ä»¬æ¯•ä¸šç”Ÿçš„ä¸€äº›å»ºè®®ä¸å»å‘æ”¿ç­–ã€é™¢é‡Œå¯¹å­¦ç”Ÿæ„è§çš„é‡è§†ã€‚æˆ‘ä»¬ç›¸å¯¹å¾ˆè½»æ¾çš„èŠåˆ°å“ªé‡Œè®²å“ªé‡Œã€‚è°­é™¢é•¿å¯è°“å¥è°ˆï¼Œä¹Ÿå¯èƒ½æ˜¯è¿™éƒ½æ˜¯ä»–è‡ªå·±äº²è‡ªå‚ä¸å¹¶å®æ–½çš„è§„åˆ’ï¼Œè°­é™¢é•¿å¾ˆä¹æ„ä¸æˆ‘ä»¬åˆ†äº«ç›®å‰é™¢é‡Œçš„ä¸€äº›é—®é¢˜ä¸è®¡åˆ’ã€‚ä¹Ÿå¸Œæœ›æˆ‘ä»¬å­¦ç”Ÿèƒ½å¤Ÿæ˜¯ä¸€ä¸ªå¾ˆå…³é”®çš„ä¸€ç¯ï¼Œä¸€èµ·æ¥å®Œå–„æˆ‘ä»¬å­¦é™¢çš„å»ºè®¾ã€‚</p><p>è¿™è¶³å¯è§è°­å‰¯é™¢é•¿çš„å¹³æ˜“è¿‘äººä»¥åŠå¯¹äºæˆ‘ä»¬æœ¬ç§‘ç”Ÿå­¦ä¹ ç”Ÿæ´»çš„é‡è§†ã€‚æœ€åä¹Ÿç»™äº†æˆ‘ä»¬ä¸€ä¸ªæƒŠå–œï¼Œç»™æˆ‘ä»¬ä¸€äººé€äº†ä¸€æœ¬ã€Šè®¡ç®—æœºç»„æˆåŸç†ã€‹ï¼Œé™¢é•¿æœ¬äººç¼–å†™çš„ä¹¦ã€‚çœŸçš„éå¸¸æ„ŸåŠ¨</p><h3 id="åˆ†å·¥é€‰æ‹©"><a href="#åˆ†å·¥é€‰æ‹©" class="headerlink" title="åˆ†å·¥é€‰æ‹©"></a>åˆ†å·¥é€‰æ‹©</h3><p>æˆ‘ä»¬å°ç»„æ¯ä¸ªäººéƒ½å¯ä»¥è¯´æ˜¯â€œèº«æ€€ç»æŠ€â€ï¼Œ æˆ‘èº«ä¸ºç»„é•¿ï¼Œç†æ‰€åº”å½“åˆ†å¥½æ¯ä¸ªäººçš„å·¥ä½œèŒè´£ï¼Œè®©æ¯ä¸€ä¸ªäººéƒ½èƒ½å‘æŒ¥æœ€å¤§çš„ä»·å€¼ï¼š</p><ul><li>æˆ‘ä»¬å‰¯é˜Ÿé•¿å§œæ˜±ï¼Œæˆ‘è®¤ä¸ºå§œæ˜±å’Œäººæ²Ÿé€šäº¤æµçš„èƒ½åŠ›ç‰¹åˆ«å¼ºï¼Œå¦å¤–è¿˜æœ‰ä¸€æ‰‹ååˆ†å‡ºè‰²çš„å‰ªè§†é¢‘èƒ½åŠ›ï¼Œä½†æ˜¯ä¸å¤ªæ“…é•¿å†™æ¨æ–‡ã€è®°å½•è¿™äº›ä¸œè¥¿ã€‚æ‰€ä»¥æˆ‘ä»¬è®¿è°ˆå®Œè€å¸ˆã€é™¢é•¿ä¹‹åå°±å’Œä»–åˆ†å·¥ï¼šä»–å¤„ç†è§†é¢‘ã€å‰ªè¾‘å¥½ç´ æï¼Œè€Œæˆ‘è´Ÿè´£è®°å½•æˆ‘ä»¬è®¿è°ˆçš„å†…å®¹å’Œæ’°å†™å…¬ä¼—å·æ¨æ–‡ã€‚</li><li>æˆ‘ä»¬è´¢åŠ¡å‘˜å¼ åˆ›æ–°ï¼ŒæŠ€æœ¯èƒ½åŠ›éå¸¸å¼ºï¼Œä»–è´Ÿè´£æˆ‘ä»¬å…¬ä¼—å·çš„å»ºç«‹å’Œè¿è¥ï¼Œå¦å¤–å°±æ˜¯æˆ‘ä»¬ç½‘é¡µçš„æœ€ç»ˆåˆ¶ä½œã€‚ä¸´æ—¶å­¦ä¹ äº†å…¬ä¼—å·çš„ç¼–è¾‘ä¸è¿è¥å·¥ä½œï¼Œå¹¶å°†æˆ‘ä»¬çš„æ¨æ–‡å‘å¸ƒå‡ºæ¥ã€‚äº‹å®è¯æ˜ä»–å®Œæˆçš„éå¸¸å‡ºè‰².åšå‡ºäº†è®©äººéå¸¸æ»¡æ„çš„ç»“æœã€‚</li><li>æˆ‘ä»¬å®‰å…¨å‘˜æ¨é‡Šç„¶ï¼Œè”ç³»äººã€æ²Ÿé€šèƒ½åŠ›åŒæ ·å¾ˆå‰å®³ï¼Œå¿ƒæ€æ¯”è¾ƒç¼œå¯†ï¼Œä¹Ÿè´Ÿè´£äº†ä¸€éƒ¨åˆ†æ¨æ–‡çš„åˆ¶ä½œã€‚å…¶ä¸­æœ‰ä¸€ä½æ•™æˆå°±æ˜¯ä»–è´Ÿè´£è”ç³»çš„ï¼Œå¦å¤–ä¹Ÿå†™äº†ç›¸å…³çš„æ¨æ–‡ä¸è®¿è°ˆè®°å½•ã€è°ƒæŸ¥çš„æ€»ç»“ä»»åŠ¡ã€‚</li><li>æˆ‘ä»¬çš„é€šè®¯å‘˜ç‹æ€¡å½¬ï¼Œæ¯”è¾ƒæ“…é•¿å¤„ç†è§†é¢‘ã€åˆ¶ä½œç›¸å…³é—®å·ã€‚æˆ‘ä»¬å¯¹å¹¿å¤§ç¾¤ä¼—çš„é—®å·å°±æ˜¯ä»–è´Ÿè´£ç¼–å†™ï¼Œå¦å¤–ä»–ä¹Ÿæ‰¿æ‹…äº†ç›¸å½“å¤šçš„è§†é¢‘å¤„ç†ä»»åŠ¡ï¼ŒåŒ…æ‹¬æˆ‘ä»¬çš„ç›¸å…³è°ƒæŸ¥çš„æ€»ç»“è¿™äº›ä¸œè¥¿éƒ½æœ‰å‚ä¸ã€‚</li></ul><h3 id="å†™åœ¨æœ€å"><a href="#å†™åœ¨æœ€å" class="headerlink" title="å†™åœ¨æœ€å"></a>å†™åœ¨æœ€å</h3><p>æ€»çš„æ¥è¯´ï¼Œä¸ªäººè¿˜æ˜¯æˆé•¿äº†è®¸å¤šçš„ï¼Œå®è·µæ´»åŠ¨è¿™äº›å¤©è¿‡å¾—å¾ˆå……å®ã€‚ç›´åˆ°ç°åœ¨æˆ‘ä»ç„¶ä¼šæƒ³èµ·æˆ‘ä»¬è®¿è°ˆå®Œå„ä½è€å¸ˆåèµ¶å¿™å›å»è®°å½•ç›¸å…³è®¿è°ˆè®°å½•ã€ä¹¦å†™æ¨æ–‡ã€å¤„ç†è§†é¢‘è¿™äº›åˆ†å·¥åˆä½œï¼Œä¸Šåˆé‡‡è®¿å®Œè€å¸ˆï¼Œä¸­åˆé¡¾ä¸ä¸Šåƒé¥­ä¸€ç›´åˆ°æˆ‘ä»¬åšå®Œæˆ‘ä»¬çš„å·¥ä½œæ‰å¼€å§‹å»åƒé¥­ã€‚æ¯ä¸ªäººéƒ½æŠ•å…¥äº†æå¤§çš„çƒ­æƒ…å»ä¸ºå›¢é˜Ÿä»˜å‡ºï¼Œè¿™äº›æ˜¯è®©æˆ‘éå¸¸æ„ŸåŠ¨çš„ï¼Œæˆ‘ä¹Ÿè®¤ä¸ºè¿™å°†æ˜¯æˆ‘å¤§å­¦ç”Ÿæ´»ä¸­å¾ˆéš¾å¿˜çš„ä¸€æ®µç»å†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å†™ç»™è‡ªå·±çš„æ•£æ–‡è¯— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å†™ç»™è‡ªå·±çš„æ•£æ–‡è¯— </tag>
            
            <tag> ç¤¾ä¼šå®è·µ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Faster RCNNæºç è§£è¯»</title>
      <link href="/2021/09/06/faster-rcnn-yuan-ma-jie-du/"/>
      <url>/2021/09/06/faster-rcnn-yuan-ma-jie-du/</url>
      
        <content type="html"><![CDATA[<h4 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h4><p>è¯¥ç¬”è®°æ˜¯æˆ‘çš„å…³äºPytorch Faster RCNNçš„æºç è§£è¯»ã€‚æºç è¯»äº†å¤§æ¦‚æœ‰4å¤©ï¼Œå…¶ä¸­ROIPoolingä½¿ç”¨C++å†™çš„ä»£ç ï¼Œé‚£ä¸€éƒ¨åˆ†ä»…ä»…äº†è§£äº†é‚£ä¸€å±‚çš„åŠŸèƒ½ï¼Œæ²¡æœ‰æ·±å…¥äº†è§£ã€‚æœ¬äººè§£è¯»çš„å¹¶éå®˜æ–¹æºç ï¼Œå®˜æ–¹æºç åœ¨<a href="https://github.com/pytorch/vision/tree/main/torchvision/models/detection" target="_blank" rel="noopener">è¿™é‡Œ</a>, å®˜æ–¹æºç è§£è¯»åœ¨<a href="https://heary.cn/posts/fasterrcnn-resnet50-fpn-%E4%BB%8Etorchvision%E6%BA%90%E7%A0%81%E7%90%86%E8%A7%A3Faster-R-CNN%E5%8E%9F%E7%90%86/" target="_blank" rel="noopener">è¿™é‡Œ</a></p><h3 id="Pytorchæ­å»ºFasterRCNNç›®æ ‡æ£€æµ‹å¹³å°"><a href="#Pytorchæ­å»ºFasterRCNNç›®æ ‡æ£€æµ‹å¹³å°" class="headerlink" title="Pytorchæ­å»ºFasterRCNNç›®æ ‡æ£€æµ‹å¹³å°"></a>Pytorchæ­å»ºFasterRCNNç›®æ ‡æ£€æµ‹å¹³å°</h3><h4 id="æ€»ä½“ä»‹ç»"><a href="#æ€»ä½“ä»‹ç»" class="headerlink" title="æ€»ä½“ä»‹ç»"></a>æ€»ä½“ä»‹ç»</h4><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20210904180046.png" alt="å…¨è¿‡ç¨‹"></p><ul><li>é¦–å…ˆæˆ‘ä»¬ä¼šå°†å›¾ç‰‡resizeï¼Œå°†å…¶çŸ­è¾¹resizeåˆ°600å¤§å°ï¼Œè€Œå…¶é•¿è¾¹ç›¸åº”çš„æŒ‰æ¯”ä¾‹ç¼©æ”¾ã€‚è¿™æ ·æˆ‘ä»¬å¾—åˆ°äº†å›ºå®šå¤§å°çš„å›¾ç‰‡ã€‚</li><li>é¦–å…ˆç»è¿‡backboneè¿™ä¸ªä¸»å¹²ç‰¹å¾æå–ç½‘ç»œï¼Œè¿™ä¸ªæ˜¯ç”¨æ¥æå–ä¸»å¹²ç‰¹å¾çš„ï¼Œä¸€åŠè¿™ä¸ªå¯ä»¥ä½¿ç”¨VGGæˆ–è€…ResNet.æˆ‘ä»¬è¿™é‡Œä»¥ResNet50ä¸ºä¾‹ã€‚</li><li>å½“æˆ‘ä»¬ç‰¹å¾æå–å®Œä¹‹åï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°è¿™ä¸ªå…±äº«ç‰¹å¾å±‚ä¹Ÿå°±æ˜¯feature mapã€‚ åœ¨æˆ‘ä»¬è¿™ä¸ªä¾‹å­å½“ä¸­ï¼Œè¾“å…¥æ˜¯600Ã—600Ã—3ï¼Œé‚£ä¹ˆå…±äº«ç‰¹å¾å±‚å°±æ˜¯38Ã—38Ã—1024ã€‚æˆ‘ä»¬å¾ˆå¤šä¹‹åæ“ä½œéƒ½ä¼šåœ¨è¿™ä¸ªå…±äº«ç‰¹å¾å±‚è¿›è¡Œæ“ä½œã€‚æˆ‘ä»¬åªéœ€è¦è®°ä½æˆ‘ä»¬è¿™ä¸ªå…±äº«ç‰¹å¾å±‚å­˜çš„æ˜¯è®¸å¤šæå–åˆ°çš„ç‰¹å¾ã€‚è€Œç‰¹å¾çš„shapeæ˜¯38Ã—38Ã—1024ã€‚</li><li>è€Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ªfeature mapæœ‰ä¸¤æ¡è·¯ï¼Œä¸€æ¡è·¯ç»è¿‡çš„æ˜¯ä¸€ä¸ª3Ã—3çš„å·ç§¯åå†åˆ†ä¸ºä¸¤æ¡è·¯ç»è¿‡1Ã—1çš„å·ç§¯ï¼Œä¸€ä¸ªé€šé“æ•°æ˜¯18ï¼Œå¦ä¸€ä¸ªé€šé“æ•°æ˜¯36ï¼Œè¿™ä¸€æ¡è·¯å°±æ˜¯æˆ‘ä»¬çš„å»ºè®®æ¡†ç½‘ç»œ.</li></ul><h4 id="ResNet50-backboneè¯¦è§£"><a href="#ResNet50-backboneè¯¦è§£" class="headerlink" title="ResNet50 backboneè¯¦è§£"></a>ResNet50 backboneè¯¦è§£</h4><h5 id="Preface-1"><a href="#Preface-1" class="headerlink" title="Preface"></a>Preface</h5><ul><li><p>Faster-RCNNå¯ä»¥é‡‡ç”¨å¤šç§çš„ä¸»å¹²ç‰¹å¾æå–ç½‘ç»œï¼Œå¸¸ç”¨çš„æœ‰VGGï¼ŒResnetï¼ŒXceptionç­‰ç­‰ï¼Œæœ¬æ–‡ä»¥Resnetç½‘ç»œä¸ºä¾‹å­æ¥ç»™å¤§å®¶æ¼”ç¤ºä¸€ä¸‹ã€‚</p></li><li><p>Faster-Rcnnå¯¹è¾“å…¥è¿›æ¥çš„å›¾ç‰‡å°ºå¯¸æ²¡æœ‰å›ºå®šï¼Œä½†æ˜¯ä¸€èˆ¬ä¼šæŠŠè¾“å…¥è¿›æ¥çš„å›¾ç‰‡çŸ­è¾¹å›ºå®šæˆ600ï¼Œå¦‚è¾“å…¥ä¸€å¼ 1200x1800çš„å›¾ç‰‡ï¼Œä¼šæŠŠå›¾ç‰‡ä¸å¤±çœŸçš„resizeåˆ°600x900ä¸Šã€‚</p></li><li><p>ResNet50æœ‰ä¸¤ä¸ªåŸºæœ¬çš„å—ï¼Œåˆ†åˆ«åä¸ºConv Blockå’ŒIdentity Blockï¼Œå…¶ä¸­Conv Blockè¾“å…¥å’Œè¾“å‡ºçš„ç»´åº¦æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ‰€ä»¥ä¸èƒ½è¿ç»­ä¸²è”ï¼Œå®ƒçš„ä½œç”¨æ˜¯æ”¹å˜ç½‘ç»œçš„ç»´åº¦ï¼›Identity Blockè¾“å…¥ç»´åº¦å’Œè¾“å‡ºç»´åº¦ç›¸åŒï¼Œå¯ä»¥ä¸²è”ï¼Œç”¨äºåŠ æ·±ç½‘ç»œçš„ã€‚</p></li></ul><h5 id="ä¸¤ç§å—"><a href="#ä¸¤ç§å—" class="headerlink" title="ä¸¤ç§å—"></a>ä¸¤ç§å—</h5><p>Conv Blockçš„ç»“æ„å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20210831195607.png" alt="Conv Block"></p><ul><li>å¯ä»¥çœ‹å‡ºï¼Œè¿™ç§æ˜¯ç”¨æ¥æ”¹å˜é€šé“æ•°ã€é•¿å®½çš„ï¼Œæˆ‘ä»¬æ¯æ¬¡é«˜å®½å‡åŠç”±äºè¦åŠ ä¸Šæˆ‘ä»¬çš„è¾“å…¥é¡¹æ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä¹ŸåŠ äº†å·ç§¯, è¿™ä¾¿æ˜¯Conv  Blockã€‚æ¯ä¸ªstageåº”è¯¥éƒ½ä¼šæœ‰ä¸€ä¸ªè¿™ä¸ªConv Block. </li><li><del>å¦å¤–ç”±æˆ‘ä»¬çš„Convï¼Œå¯ä»¥è¿™ä¹ˆè®°ï¼šå¯¹è¾“å…¥é¡¹æœ‰å·ç§¯å¤„ç†çš„å«åš<code>ConvBlock</code></del></li></ul><p>Identity Blockçš„ç»“æ„å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20191113094135752.png#pic_center" alt="Identity Block"></p><ul><li>è¿™ä¸ªç»“æ„ä¸ä¼šç”¨æ¥æ”¹å˜æˆ‘ä»¬çš„é•¿å®½é«˜ï¼Œä¸åŒçš„stageé‡å¤ä½¿ç”¨çš„æ¬¡æ•°ä¸åŒï¼Œè¯¥å—ç”±äºåŠ ä¸Šçš„è¾“å…¥å±‚æ²¡æœ‰è¿›è¡Œå·ç§¯æ”¹å˜å½¢çŠ¶ä¸é€šé“æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®°ä¸ºâ€œIdentity Blockâ€(<del>è¿™æ˜¯æˆ‘çç¼–çš„ï¼Œå¥½è®°</del>)</li></ul><p>è¿™ä¸¤ä¸ªéƒ½æ˜¯æ®‹å·®ç½‘ç»œç»“æ„ã€‚</p><p><strong>Faster-RCNNçš„ä¸»å¹²ç‰¹å¾æå–ç½‘ç»œéƒ¨åˆ†åªåŒ…å«äº†é•¿å®½å‹ç¼©äº†å››æ¬¡çš„å†…å®¹ï¼Œç¬¬äº”æ¬¡å‹ç¼©åçš„å†…å®¹åœ¨ROIä¸­ä½¿ç”¨ã€‚</strong>å³Faster-RCNNåœ¨ä¸»å¹²ç‰¹å¾æå–ç½‘ç»œæ‰€ç”¨çš„ç½‘ç»œå±‚å¦‚å›¾æ‰€ç¤ºã€‚</p><p>ä»¥è¾“å…¥çš„å›¾ç‰‡ä¸º600x600ä¸ºä¾‹ï¼Œshapeå˜åŒ–å¦‚ä¸‹ï¼š</p><p><a href="https://imgtu.com/i/hd1TxS" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/31/hd1TxS.png" alt="shape changes"></a></p><p>æœ€åä¸€å±‚çš„è¾“å‡ºå°±æ˜¯å…¬ç”¨ç‰¹å¾å±‚ã€‚</p><p><strong>åœ¨ä»£ç é‡Œé‡Œé¢ï¼Œæˆ‘ä»¬ä½¿ç”¨resnet50()å‡½æ•°æ¥è·å¾—resnet50çš„å…¬ç”¨ç‰¹å¾å±‚ã€‚</strong></p><p><strong>å…¶ä¸­featureséƒ¨åˆ†ä¸ºå…¬ç”¨ç‰¹å¾å±‚ï¼Œclassifieréƒ¨åˆ†ä¸ºç¬¬äºŒé˜¶æ®µç”¨åˆ°çš„åˆ†ç±»å™¨</strong>ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">resnet50</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    model <span class="token operator">=</span> ResNet<span class="token punctuation">(</span>Bottleneck<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#----------------------------------------------------------------------------#</span>    <span class="token comment" spellcheck="true">#   è·å–ç‰¹å¾æå–éƒ¨åˆ†ï¼Œä»conv1åˆ°model.layer3ï¼Œæœ€ç»ˆè·å¾—ä¸€ä¸ª38,38,1024çš„ç‰¹å¾å±‚</span>    <span class="token comment" spellcheck="true">#----------------------------------------------------------------------------#</span>    features <span class="token operator">=</span> list<span class="token punctuation">(</span><span class="token punctuation">[</span>model<span class="token punctuation">.</span>conv1<span class="token punctuation">,</span> model<span class="token punctuation">.</span>bn1<span class="token punctuation">,</span> model<span class="token punctuation">.</span>relu<span class="token punctuation">,</span> model<span class="token punctuation">.</span>maxpool<span class="token punctuation">,</span> model<span class="token punctuation">.</span>layer1<span class="token punctuation">,</span> model<span class="token punctuation">.</span>layer2<span class="token punctuation">,</span> model<span class="token punctuation">.</span>layer3<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#----------------------------------------------------------------------------#</span>    <span class="token comment" spellcheck="true">#   è·å–åˆ†ç±»éƒ¨åˆ†ï¼Œä»model.layer4åˆ°model.avgpool</span>    <span class="token comment" spellcheck="true">#----------------------------------------------------------------------------#</span>    classifier <span class="token operator">=</span> list<span class="token punctuation">(</span><span class="token punctuation">[</span>model<span class="token punctuation">.</span>layer4<span class="token punctuation">,</span> model<span class="token punctuation">.</span>avgpool<span class="token punctuation">]</span><span class="token punctuation">)</span>    features <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token operator">*</span>features<span class="token punctuation">)</span>    classifier <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token operator">*</span>classifier<span class="token punctuation">)</span>    <span class="token keyword">return</span> features<span class="token punctuation">,</span> classifier<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="ä»£ç éƒ¨åˆ†è§£æ"><a href="#ä»£ç éƒ¨åˆ†è§£æ" class="headerlink" title="ä»£ç éƒ¨åˆ†è§£æ"></a>ä»£ç éƒ¨åˆ†è§£æ</h5><h5 id="make-layer"><a href="#make-layer" class="headerlink" title="_make_layer"></a>_make_layer</h5><ul><li><p>è¯¥å‡½æ•°ç”¨æ¥ç”Ÿæˆæ¯ä¸ªstageã€‚</p></li><li><p>æˆ‘ä»¬æ®‹å·®è¾¹çš„downsampleæ˜¯ç”¨æ¥å¦‚æœæ˜¯Conv Blockçš„è¯ï¼Œæˆ‘ä»¬è¦é€‰æ‹©å¯¹è¾“å…¥å½“è¾“å‡ºé‚£ä¸€æ¡è·¯è¿›è¡Œå·ç§¯æ”¹å˜é«˜å®½å’Œé€šé“æ•°çš„å˜åŒ–ï¼Œè¿™ä¸ªæ˜¯æ”¹å˜é€šé“æ•°å’Œé«˜å®½çš„ã€‚</p></li><li><p>å¦ä¸€ä¸ªå¾ªç¯æ˜¯ç”¨æ¥ç”Ÿæˆä¸æ”¹å˜é«˜å®½çš„Identity Block. é‚£ä¸ªblockçš„é‡å¤æ¬¡æ•°æ¯ä¸ªstageéƒ½ä¸ä¸€æ ·ã€‚</p></li></ul><pre class="line-numbers language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">_make_layer</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> block<span class="token punctuation">,</span> planes<span class="token punctuation">,</span> blocks<span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        downsample <span class="token operator">=</span> None        <span class="token comment" spellcheck="true">#-------------------------------------------------------------------#</span>        <span class="token comment" spellcheck="true">#   å½“æ¨¡å‹éœ€è¦è¿›è¡Œé«˜å’Œå®½çš„å‹ç¼©çš„æ—¶å€™ï¼Œå°±éœ€è¦ç”¨åˆ°æ®‹å·®è¾¹çš„downsample</span>        <span class="token comment" spellcheck="true">#-------------------------------------------------------------------#</span>        <span class="token keyword">if</span> stride <span class="token operator">!=</span> <span class="token number">1</span> <span class="token operator">or</span> self<span class="token punctuation">.</span>inplanes <span class="token operator">!=</span> planes <span class="token operator">*</span> block<span class="token punctuation">.</span>expansion<span class="token punctuation">:</span>            downsample <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span>                nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>self<span class="token punctuation">.</span>inplanes<span class="token punctuation">,</span> planes <span class="token operator">*</span> block<span class="token punctuation">.</span>expansion<span class="token punctuation">,</span>kernel_size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> stride<span class="token operator">=</span>stride<span class="token punctuation">,</span> bias<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span>planes <span class="token operator">*</span> block<span class="token punctuation">.</span>expansion<span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token punctuation">)</span>        layers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        layers<span class="token punctuation">.</span>append<span class="token punctuation">(</span>block<span class="token punctuation">(</span>self<span class="token punctuation">.</span>inplanes<span class="token punctuation">,</span> planes<span class="token punctuation">,</span> stride<span class="token punctuation">,</span> downsample<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>inplanes <span class="token operator">=</span> planes <span class="token operator">*</span> block<span class="token punctuation">.</span>expansion        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> blocks<span class="token punctuation">)</span><span class="token punctuation">:</span>            layers<span class="token punctuation">.</span>append<span class="token punctuation">(</span>block<span class="token punctuation">(</span>self<span class="token punctuation">.</span>inplanes<span class="token punctuation">,</span> planes<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token operator">*</span>layers<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="Bottleneck"><a href="#Bottleneck" class="headerlink" title="Bottleneck"></a>Bottleneck</h5><ul><li>ç”¨æ¥ç”Ÿæˆæ¯ä¸ªå—</li><li>æœ‰ä¸‰ä¸ªå·ç§¯ï¼Œ<ul><li>ç¬¬ä¸€ä¸ªå·ç§¯ç”¨æ¥å‹ç¼©é€šé“æ•°</li><li>ç¬¬äºŒä¸ªå·ç§¯ç”¨æ¥æå–ç‰¹å¾</li><li>ç¬¬ä¸‰ä¸ªå·ç§¯ç”¨æ¥æ‰©å¼ é€šé“æ•°åˆ°åŸæ¥çš„ã€‚</li><li>æ•´äº†åŠå¤©ï¼ŒèŒ…å¡é¡¿å¼€ï¼</li></ul></li></ul><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Bottleneck</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>    expansion <span class="token operator">=</span> <span class="token number">4</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> inplanes<span class="token punctuation">,</span> planes<span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> downsample<span class="token operator">=</span>None<span class="token punctuation">)</span><span class="token punctuation">:</span>        super<span class="token punctuation">(</span>Bottleneck<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>conv1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>inplanes<span class="token punctuation">,</span> planes<span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> stride<span class="token operator">=</span>stride<span class="token punctuation">,</span> bias<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>bn1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span>planes<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>conv2 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>planes<span class="token punctuation">,</span> planes<span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> bias<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>bn2 <span class="token operator">=</span> nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span>planes<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>conv3 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>planes<span class="token punctuation">,</span> planes <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> bias<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>bn3 <span class="token operator">=</span> nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span>planes <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>relu <span class="token operator">=</span> nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>downsample <span class="token operator">=</span> downsample        self<span class="token punctuation">.</span>stride <span class="token operator">=</span> stride<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="ResNet-init"><a href="#ResNet-init" class="headerlink" title="ResNet init"></a>ResNet <strong>init</strong></h5><ul><li>ç¬¬ä¸€ä¸ªstageä¸é€šè¿‡Bottleneckæ”¹å˜å›¾ç‰‡é«˜å®½ï¼Œä½†æ˜¯é å®ƒæ”¹å˜é€šé“æ•°ï¼Œé max_pooling, è€Œåé¢stageéƒ½æ˜¯é ç¬¬ä¸€ä¸ªconv Blockæ”¹å˜é«˜å®½</li></ul><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">ResNet</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> block<span class="token punctuation">,</span> layers<span class="token punctuation">,</span> num_classes<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true">#-----------------------------------#</span>        <span class="token comment" spellcheck="true">#   å‡è®¾è¾“å…¥è¿›æ¥çš„å›¾ç‰‡æ˜¯600,600,3</span>        <span class="token comment" spellcheck="true">#-----------------------------------#</span>        self<span class="token punctuation">.</span>inplanes <span class="token operator">=</span> <span class="token number">64</span>        super<span class="token punctuation">(</span>ResNet<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 600,600,3 -> 300,300,64</span>        self<span class="token punctuation">.</span>conv1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> bias<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>bn1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>relu <span class="token operator">=</span> nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 300,300,64 -> 150,150,64</span>        self<span class="token punctuation">.</span>maxpool <span class="token operator">=</span> nn<span class="token punctuation">.</span>MaxPool2d<span class="token punctuation">(</span>kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> ceil_mode<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 150,150,64 -> 150,150,256</span>        self<span class="token punctuation">.</span>layer1 <span class="token operator">=</span> self<span class="token punctuation">.</span>_make_layer<span class="token punctuation">(</span>block<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> layers<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 150,150,256 -> 75,75,512</span>        self<span class="token punctuation">.</span>layer2 <span class="token operator">=</span> self<span class="token punctuation">.</span>_make_layer<span class="token punctuation">(</span>block<span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> layers<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 75,75,512 -> 38,38,1024 åˆ°è¿™é‡Œå¯ä»¥è·å¾—ä¸€ä¸ª38,38,1024çš„å…±äº«ç‰¹å¾å±‚</span>        self<span class="token punctuation">.</span>layer3 <span class="token operator">=</span> self<span class="token punctuation">.</span>_make_layer<span class="token punctuation">(</span>block<span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> layers<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># self.layer4è¢«ç”¨åœ¨classifieræ¨¡å‹ä¸­</span>        self<span class="token punctuation">.</span>layer4 <span class="token operator">=</span> self<span class="token punctuation">.</span>_make_layer<span class="token punctuation">(</span>block<span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">,</span> layers<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>avgpool <span class="token operator">=</span> nn<span class="token punctuation">.</span>AvgPool2d<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>fc <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">512</span> <span class="token operator">*</span> block<span class="token punctuation">.</span>expansion<span class="token punctuation">,</span> num_classes<span class="token punctuation">)</span>        <span class="token keyword">for</span> m <span class="token keyword">in</span> self<span class="token punctuation">.</span>modules<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> isinstance<span class="token punctuation">(</span>m<span class="token punctuation">,</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">)</span><span class="token punctuation">:</span>                n <span class="token operator">=</span> m<span class="token punctuation">.</span>kernel_size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> m<span class="token punctuation">.</span>kernel_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> m<span class="token punctuation">.</span>out_channels                m<span class="token punctuation">.</span>weight<span class="token punctuation">.</span>data<span class="token punctuation">.</span>normal_<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> math<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">.</span> <span class="token operator">/</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">elif</span> isinstance<span class="token punctuation">(</span>m<span class="token punctuation">,</span> nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">)</span><span class="token punctuation">:</span>                m<span class="token punctuation">.</span>weight<span class="token punctuation">.</span>data<span class="token punctuation">.</span>fill_<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>                m<span class="token punctuation">.</span>bias<span class="token punctuation">.</span>data<span class="token punctuation">.</span>zero_<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="ResNet50æ„å»º"><a href="#ResNet50æ„å»º" class="headerlink" title="ResNet50æ„å»º"></a>ResNet50æ„å»º</h5><ul><li>æ³¨æ„å‰é¢æåˆ°è¿‡ï¼Œè¿™ä¸ªç½‘ç»œå‰å››ä¸ªstageç”¨äºç‰¹å¾æå–ï¼Œè€Œç¬¬äº”ä¸ªstageæ”¾åˆ°äº†ROIpoolingä¸­ï¼Œæˆ‘ä»¬è¿™é‡Œæ­£æ˜¯è¦å°†å…¶åšä¸€ä¸ªåŒºåˆ†ã€‚æ‰€ä»¥å¦å¤–å®šä¹‰äº†ä¸€ä¸ªæ–°å‡½æ•°ï¼Œä¸è¿‡å¹¶ä¸éš¾ç†è§£ã€‚</li></ul><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">resnet50</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    model <span class="token operator">=</span> ResNet<span class="token punctuation">(</span>Bottleneck<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#----------------------------------------------------------------------------#</span>    <span class="token comment" spellcheck="true">#   è·å–ç‰¹å¾æå–éƒ¨åˆ†ï¼Œä»conv1åˆ°model.layer3ï¼Œæœ€ç»ˆè·å¾—ä¸€ä¸ª38,38,1024çš„ç‰¹å¾å±‚</span>    <span class="token comment" spellcheck="true">#----------------------------------------------------------------------------#</span>    features <span class="token operator">=</span> list<span class="token punctuation">(</span><span class="token punctuation">[</span>model<span class="token punctuation">.</span>conv1<span class="token punctuation">,</span> model<span class="token punctuation">.</span>bn1<span class="token punctuation">,</span> model<span class="token punctuation">.</span>relu<span class="token punctuation">,</span> model<span class="token punctuation">.</span>maxpool<span class="token punctuation">,</span> model<span class="token punctuation">.</span>layer1<span class="token punctuation">,</span> model<span class="token punctuation">.</span>layer2<span class="token punctuation">,</span> model<span class="token punctuation">.</span>layer3<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#----------------------------------------------------------------------------#</span>    <span class="token comment" spellcheck="true">#   è·å–åˆ†ç±»éƒ¨åˆ†ï¼Œä»model.layer4åˆ°model.avgpool</span>    <span class="token comment" spellcheck="true">#----------------------------------------------------------------------------#</span>    classifier <span class="token operator">=</span> list<span class="token punctuation">(</span><span class="token punctuation">[</span>model<span class="token punctuation">.</span>layer4<span class="token punctuation">,</span> model<span class="token punctuation">.</span>avgpool<span class="token punctuation">]</span><span class="token punctuation">)</span>    features <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token operator">*</span>features<span class="token punctuation">)</span>    classifier <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token operator">*</span>classifier<span class="token punctuation">)</span>    <span class="token keyword">return</span> features<span class="token punctuation">,</span> classifier<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Proposalå»ºè®®æ¡†æ„å»º"><a href="#Proposalå»ºè®®æ¡†æ„å»º" class="headerlink" title="Proposalå»ºè®®æ¡†æ„å»º"></a>Proposalå»ºè®®æ¡†æ„å»º</h4><ul><li>ç¡®å®ä¸æ˜¯é‚£ä¹ˆå¥½ç†è§£ï¼Œä¸è¿‡æ²¡å…³ç³»ï¼Œæ…¢æ…¢äº†è§£å°±è¡Œã€‚</li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20210901113220.png" alt="å…¨è¿‡ç¨‹"></p><p>è·å¾—çš„å…¬ç”¨ç‰¹å¾å±‚åœ¨å›¾åƒä¸­å°±æ˜¯Feature Mapï¼Œå…¶æœ‰ä¸¤ä¸ªåº”ç”¨ï¼Œä¸€ä¸ªæ˜¯å’ŒROIPoolingç»“åˆä½¿ç”¨ã€å¦ä¸€ä¸ªæ˜¯è¿›è¡Œä¸€æ¬¡3x3çš„å·ç§¯åï¼Œè¿›è¡Œä¸€ä¸ª18é€šé“çš„1x1å·ç§¯ï¼Œè¿˜æœ‰ä¸€ä¸ª36é€šé“çš„1x1å·ç§¯ã€‚</p><p>åœ¨Faster-RCNNä¸­ï¼Œnum_priorsä¹Ÿå°±æ˜¯å…ˆéªŒæ¡†çš„æ•°é‡å°±æ˜¯9ï¼Œæ‰€ä»¥ä¸¤ä¸ª1x1å·ç§¯çš„ç»“æœå®é™…ä¸Šä¹Ÿå°±æ˜¯ï¼š</p><ul><li><p>9 x 4çš„å·ç§¯ ç”¨äºé¢„æµ‹ å…¬ç”¨ç‰¹å¾å±‚ä¸Š æ¯ä¸€ä¸ªç½‘æ ¼ç‚¹ä¸Š æ¯ä¸€ä¸ªå…ˆéªŒæ¡†çš„å˜åŒ–æƒ…å†µã€‚ï¼ˆä¸ºä»€ä¹ˆè¯´æ˜¯å˜åŒ–æƒ…å†µå‘¢ï¼Œè¿™æ˜¯å› ä¸ºFaster-RCNNçš„é¢„æµ‹ç»“æœéœ€è¦ç»“åˆå…ˆéªŒæ¡†è·å¾—é¢„æµ‹æ¡†ï¼Œé¢„æµ‹ç»“æœå°±æ˜¯å…ˆéªŒæ¡†çš„å˜åŒ–æƒ…å†µã€‚ï¼‰</p></li><li><p>9 x 2çš„å·ç§¯ ç”¨äºé¢„æµ‹ å…¬ç”¨ç‰¹å¾å±‚ä¸Š æ¯ä¸€ä¸ªç½‘æ ¼ç‚¹ä¸Š æ¯ä¸€ä¸ªé¢„æµ‹æ¡†å†…éƒ¨æ˜¯å¦åŒ…å«äº†ç‰©ä½“ï¼Œåºå·ä¸º1çš„å†…å®¹ä¸ºåŒ…å«ç‰©ä½“çš„æ¦‚ç‡ã€‚</p></li></ul><p>å½“æˆ‘ä»¬è¾“å…¥çš„å›¾ç‰‡çš„shapeæ˜¯600x600x3çš„æ—¶å€™ï¼Œå…¬ç”¨ç‰¹å¾å±‚çš„shapeå°±æ˜¯38x38x1024ï¼Œç›¸å½“äºæŠŠè¾“å…¥è¿›æ¥çš„å›¾åƒåˆ†å‰²æˆ38x38çš„ç½‘æ ¼ï¼Œç„¶åæ¯ä¸ªç½‘æ ¼å­˜åœ¨9ä¸ªå…ˆéªŒæ¡†ï¼Œè¿™äº›å…ˆéªŒæ¡†æœ‰ä¸åŒçš„å¤§å°ï¼Œåœ¨å›¾åƒä¸Šå¯†å¯†éº»éº»ã€‚</p><p>9 x 4çš„å·ç§¯çš„ç»“æœä¼šå¯¹è¿™äº›å…ˆéªŒæ¡†è¿›è¡Œè°ƒæ•´ï¼Œè·å¾—ä¸€ä¸ªæ–°çš„æ¡†ã€‚<br>9 x 2çš„å·ç§¯ä¼šåˆ¤æ–­ä¸Šè¿°è·å¾—çš„æ–°æ¡†æ˜¯å¦åŒ…å«ç‰©ä½“ã€‚</p><p>åˆ°è¿™é‡Œæˆ‘ä»¬å¯ä»¥è·å¾—äº†ä¸€äº›æœ‰ç”¨çš„æ¡†ï¼Œè¿™äº›æ¡†ä¼šåˆ©ç”¨9 x 2çš„å·ç§¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç‰©ä½“ã€‚</p><p>åˆ°æ­¤ä½ç½®è¿˜åªæ˜¯ç²—ç•¥çš„ä¸€ä¸ªæ¡†çš„è·å–ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå»ºè®®æ¡†ã€‚ç„¶åæˆ‘ä»¬ä¼šåœ¨å»ºè®®æ¡†é‡Œé¢ç»§ç»­æ‰¾ä¸œè¥¿ã€‚</p><h5 id="init-å‡½æ•°"><a href="#init-å‡½æ•°" class="headerlink" title="__init__å‡½æ•°"></a><code>__init__</code>å‡½æ•°</h5><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™é‡Œçš„å»ºè®®æ¡†æ„å»ºçš„å‡ ä¸ªæ­¥éª¤ï¼š</p><ul><li>æˆ‘ä»¬é¦–å…ˆç”Ÿæˆä¸€ä¸ªåŸºç¡€çš„å…ˆéªŒæ¡†ï¼Œshapeä¸º[9ï¼Œ4]</li><li>æ¥ç€è¿›è¡Œä¸€ä¸ª3Ã—3çš„å·ç§¯ï¼Œå°±æ˜¯æˆ‘ä»¬ä»¥ä¸Šé‚£ä¸ªæ€»æµç¨‹å›¾çš„3Ã—3å·ç§¯ï¼Œå¯ä»¥ç†è§£ä¸ºç‰¹å¾æ•´åˆä»¥ä¸‹ï¼Œæ”¹å˜å˜æ¢ä¸€ä¸‹</li><li>éšååˆä¸€ä¸ªåˆ†ç±»é¢„æµ‹æ¡†ï¼Œå®šä¹‰äº†1Ã—1çš„å·ç§¯ï¼Œé€šé“æ•°å˜ä¸º9Ã—2ï¼Œé‚£ä¸ª9å°±æ˜¯å…ˆå‰æ¯ä¸ªåƒç´ ç”Ÿæˆçš„åŸºç¡€å…ˆéªŒæ¡†ä¸ªæ•°ï¼Œè€Œ2å¯ä»¥ç†è§£ä¸ºæ˜¯å¦åŒ…å«ç‰©ä½“çš„é¢„æµ‹ã€‚ï¼ˆå½“ç„¶åæ¥reshapeåæˆ‘ä»¬æ‰å¯ä»¥çœ‹å‡ºæ¥æ˜¯è¿™ä¸ªæ„æ€ï¼Œè¿™é‡Œä¸ºäº†æˆ‘ä»¬èƒ½å¤Ÿæå‰äº†ç†è§£ç›¸å…³æ¦‚å¿µï¼‰</li><li>å¹¶åˆ—åˆ†ç±»é¢„æµ‹æ¡†çš„æ˜¯æˆ‘ä»¬çš„å›å½’é¢„æµ‹æ¡†ï¼ŒåŒæ ·æ˜¯1Ã—1å·ç§¯ï¼Œä¸è¿‡é€šé“æ•°ä¸º9Ã—4ï¼Œå› ä¸ºè¿™ä¸ªæ˜¯é¢„æµ‹åˆ†ç±»æˆ‘ä»¬å…ˆéªŒæ¡†çš„ï¼Œéœ€è¦æœ‰4ä¸ªå‚æ•°æ¥ç¡®å®šï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©ä½¿ç”¨9Ã—4.</li><li>è€Œåçš„æƒå€¼åˆå§‹åŒ–æ˜¯æˆ‘ä»¬å•ç‹¬å®šä¹‰äº†ä¸€ä¸ªæ–°å‡½æ•°æ¥é€‰æ‹©æˆ‘ä»¬æƒ³è¦çš„åˆå§‹åŒ–æ–¹å¼ã€‚</li></ul><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">RegionProposalNetwork</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>            self<span class="token punctuation">,</span> in_channels<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span> mid_channels<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span> ratios<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            anchor_scales<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span> feat_stride<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span>            mode <span class="token operator">=</span> <span class="token string">"training"</span><span class="token punctuation">,</span>    <span class="token punctuation">)</span><span class="token punctuation">:</span>        super<span class="token punctuation">(</span>RegionProposalNetwork<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>feat_stride <span class="token operator">=</span> feat_stride        self<span class="token punctuation">.</span>proposal_layer <span class="token operator">=</span> ProposalCreator<span class="token punctuation">(</span>mode<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#-----------------------------------------#</span>        <span class="token comment" spellcheck="true">#   ç”ŸæˆåŸºç¡€å…ˆéªŒæ¡†ï¼Œshapeä¸º[9, 4]</span>        <span class="token comment" spellcheck="true">#-----------------------------------------#</span>        self<span class="token punctuation">.</span>anchor_base <span class="token operator">=</span> generate_anchor_base<span class="token punctuation">(</span>anchor_scales<span class="token operator">=</span>anchor_scales<span class="token punctuation">,</span> ratios<span class="token operator">=</span>ratios<span class="token punctuation">)</span>        n_anchor <span class="token operator">=</span> self<span class="token punctuation">.</span>anchor_base<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true">#-----------------------------------------#</span>        <span class="token comment" spellcheck="true">#   å…ˆè¿›è¡Œä¸€ä¸ª3x3çš„å·ç§¯ï¼Œå¯ç†è§£ä¸ºç‰¹å¾æ•´åˆ</span>        <span class="token comment" spellcheck="true">#-----------------------------------------#</span>        self<span class="token punctuation">.</span>conv1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token punctuation">,</span> mid_channels<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#-----------------------------------------#</span>        <span class="token comment" spellcheck="true">#   åˆ†ç±»é¢„æµ‹å…ˆéªŒæ¡†å†…éƒ¨æ˜¯å¦åŒ…å«ç‰©ä½“</span>        <span class="token comment" spellcheck="true">#-----------------------------------------#</span>        self<span class="token punctuation">.</span>score <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>mid_channels<span class="token punctuation">,</span> n_anchor <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#-----------------------------------------#</span>        <span class="token comment" spellcheck="true">#   å›å½’é¢„æµ‹å¯¹å…ˆéªŒæ¡†è¿›è¡Œè°ƒæ•´</span>        <span class="token comment" spellcheck="true">#-----------------------------------------#</span>        self<span class="token punctuation">.</span>loc <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>mid_channels<span class="token punctuation">,</span> n_anchor <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#--------------------------------------#</span>        <span class="token comment" spellcheck="true">#   å¯¹FPNçš„ç½‘ç»œéƒ¨åˆ†è¿›è¡Œæƒå€¼åˆå§‹åŒ–</span>        <span class="token comment" spellcheck="true">#--------------------------------------#</span>        normal_init<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv1<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>        normal_init<span class="token punctuation">(</span>self<span class="token punctuation">.</span>score<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>        normal_init<span class="token punctuation">(</span>self<span class="token punctuation">.</span>loc<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="forwardå‡½æ•°ï¼ˆéƒ¨åˆ†è§£æï¼‰"><a href="#forwardå‡½æ•°ï¼ˆéƒ¨åˆ†è§£æï¼‰" class="headerlink" title="forwardå‡½æ•°ï¼ˆéƒ¨åˆ†è§£æï¼‰"></a>forwardå‡½æ•°ï¼ˆéƒ¨åˆ†è§£æï¼‰</h5><p>è¿™é‡Œåˆ—ä¸¾äº†ä¸€éƒ¨åˆ†ç›¸å…³çš„å‡½æ•°</p><p>å¯ä»¥çœ‹å‡ºï¼Œ<strong>è¿™é‡Œæœ‰ä¸€äº›å€¼å¾—æˆ‘ä»¬å»æ³¨æ„çš„reshapeæ“ä½œ</strong>ï¼š</p><ul><li>å¯ä»¥çœ‹å‡ºè¿™é‡Œçš„å‰å‘ä¼ æ’­ä¸¤ä¸ª1Ã—1å·ç§¯æ˜¯å¹¶åˆ—è¿›è¡Œçš„ã€‚</li><li>å›å½’é¢„æµ‹æœ€åé‚£ä¸ªviewå‡½æ•°å¯ä»¥çœ‹å‡ºæˆ‘ä»¬æœ€ç»ˆå°†å…¶åˆ†æˆäº†ï¼ˆbatch_size, å…ˆéªŒæ¡†ï¼Œ å›å½’é¢„æµ‹æ¡†å››ä¸ªå‚æ•°ï¼‰</li><li>åˆ†ç±»é¢„æµ‹æœ€åé‚£ä¸ªviewå‡½æ•°å¯ä»¥çœ‹å‡ºæˆ‘ä»¬æœ€ç»ˆå°†å…¶åˆ†æˆäº†ï¼ˆbatch_size, å…ˆéªŒæ¡†ï¼Œ åˆ†ç±»é¢„æµ‹ï¼ˆæ˜¯ï¼Ÿä¸æ˜¯ï¼Ÿï¼‰ä¸¤ä¸ªå‚æ•°ï¼‰ï¼Œ<strong>è€Œæœ€åæˆ‘ä»¬ä¹Ÿå¯¹å…¶è¿›è¡Œäº†softmaxé¢„æµ‹</strong></li></ul><pre class="line-numbers language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> img_size<span class="token punctuation">,</span> scale<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        n<span class="token punctuation">,</span> _<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w <span class="token operator">=</span> x<span class="token punctuation">.</span>shape        <span class="token comment" spellcheck="true">#-----------------------------------------#</span>        <span class="token comment" spellcheck="true">#   å…ˆè¿›è¡Œä¸€ä¸ª3x3çš„å·ç§¯ï¼Œå¯ç†è§£ä¸ºç‰¹å¾æ•´åˆ</span>        <span class="token comment" spellcheck="true">#-----------------------------------------#</span>        x <span class="token operator">=</span> F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv1<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#-----------------------------------------#</span>        <span class="token comment" spellcheck="true">#   å›å½’é¢„æµ‹å¯¹å…ˆéªŒæ¡†è¿›è¡Œè°ƒæ•´</span>        <span class="token comment" spellcheck="true">#-----------------------------------------#</span>        rpn_locs <span class="token operator">=</span> self<span class="token punctuation">.</span>loc<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        rpn_locs <span class="token operator">=</span> rpn_locs<span class="token punctuation">.</span>permute<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>contiguous<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>view<span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#-----------------------------------------#</span>        <span class="token comment" spellcheck="true">#   åˆ†ç±»é¢„æµ‹å…ˆéªŒæ¡†å†…éƒ¨æ˜¯å¦åŒ…å«ç‰©ä½“</span>        <span class="token comment" spellcheck="true">#-----------------------------------------#</span>        rpn_scores <span class="token operator">=</span> self<span class="token punctuation">.</span>score<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        rpn_scores <span class="token operator">=</span> rpn_scores<span class="token punctuation">.</span>permute<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>contiguous<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>view<span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#--------------------------------------------------------------------------------------#</span>        <span class="token comment" spellcheck="true">#   è¿›è¡Œsoftmaxæ¦‚ç‡è®¡ç®—ï¼Œæ¯ä¸ªå…ˆéªŒæ¡†åªæœ‰ä¸¤ä¸ªåˆ¤åˆ«ç»“æœ</span>        <span class="token comment" spellcheck="true">#   å†…éƒ¨åŒ…å«ç‰©ä½“æˆ–è€…å†…éƒ¨ä¸åŒ…å«ç‰©ä½“ï¼Œrpn_softmax_scores[:, :, 1]çš„å†…å®¹ä¸ºåŒ…å«ç‰©ä½“çš„æ¦‚ç‡</span>        <span class="token comment" spellcheck="true">#--------------------------------------------------------------------------------------#</span>        rpn_softmax_scores <span class="token operator">=</span> F<span class="token punctuation">.</span>softmax<span class="token punctuation">(</span>rpn_scores<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>        rpn_fg_scores <span class="token operator">=</span> rpn_softmax_scores<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>contiguous<span class="token punctuation">(</span><span class="token punctuation">)</span>        rpn_fg_scores <span class="token operator">=</span> rpn_fg_scores<span class="token punctuation">.</span>view<span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Anchors-å…ˆéªŒæ¡†è¯¦è§£"><a href="#Anchors-å…ˆéªŒæ¡†è¯¦è§£" class="headerlink" title="Anchors å…ˆéªŒæ¡†è¯¦è§£"></a>Anchors å…ˆéªŒæ¡†è¯¦è§£</h4><h5 id="Preface-2"><a href="#Preface-2" class="headerlink" title="Preface"></a>Preface</h5><ul><li>å…ˆéªŒæ¡†æ˜¯é¢„å…ˆè®¾å®šå¥½çš„ï¼Œæˆ‘ä»¬ä¼šé€‰æ‹©ç­‰æˆ‘ä»¬åˆ¤æ–­æ˜¯å¦å«ç‰©ä½“ã€æ»¡è¶³è¦æ±‚çš„æƒ…å†µä¸‹è¿›ä¸€æ­¥å¾—åˆ°æˆ‘ä»¬çš„å»ºè®®æ¡†ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šé€‰æ‹©æˆ‘ä»¬éœ€è¦çš„ä½œä¸ºå»ºè®®æ¡†ã€‚ä¸‹é¢æˆ‘ä»¬çœ‹ä¸€ä¸‹å…ˆéªŒæ¡†æ˜¯æ€ä¹ˆç”Ÿæˆçš„ã€‚</li></ul><h5 id="generate-anchor-base"><a href="#generate-anchor-base" class="headerlink" title="generate_anchor_base"></a>generate_anchor_base</h5><ul><li><p>æˆ‘ä»¬å…ˆé€šè¿‡generate_anchor_baseè·å¾—åŸºç¡€çš„å…ˆéªŒæ¡†ã€‚</p></li><li><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">generate_anchor_base</span><span class="token punctuation">(</span>base_size<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span> ratios<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                         anchor_scales<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    anchor_base <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>ratios<span class="token punctuation">)</span> <span class="token operator">*</span> len<span class="token punctuation">(</span>anchor_scales<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>ratios<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>anchor_scales<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            h <span class="token operator">=</span> base_size <span class="token operator">*</span> anchor_scales<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>ratios<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            w <span class="token operator">=</span> base_size <span class="token operator">*</span> anchor_scales<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">.</span> <span class="token operator">/</span> ratios<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            index <span class="token operator">=</span> i <span class="token operator">*</span> len<span class="token punctuation">(</span>anchor_scales<span class="token punctuation">)</span> <span class="token operator">+</span> j            anchor_base<span class="token punctuation">[</span>index<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span> h <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">.</span>            anchor_base<span class="token punctuation">[</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span> w <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">.</span>            anchor_base<span class="token punctuation">[</span>index<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> h <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">.</span>            anchor_base<span class="token punctuation">[</span>index<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> w <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">.</span>    <span class="token keyword">return</span> anchor_base<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>æˆ‘ä»¬åœ¨è¿™é‡Œæœ‰ä¸¤ä¸ªåˆ—è¡¨ï¼Œæ¯ä¸ªåˆ—è¡¨é•¿åº¦ä¸º3ï¼ŒåµŒå¥—å¾ªç¯ä¸¤ä¸ªåˆ—è¡¨ï¼Œå¾—åˆ°9ä¸ªåŸºç¡€çš„å…ˆéªŒæ¡†</p></li><li><p>æˆ‘ä»¬å¯ä»¥å°è¯•æ‰“å°ä¸€ä¸‹æˆ‘ä»¬çš„æœ‰å…³å…ˆéªŒæ¡†çš„æ ·å­ï¼š</p></li><li><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/09/01/h0dotS.png" alt="output"></p></li><li><p>å¯ä»¥çœ‹å‡ºæœ‰ä¸‰ä¸ªç«–ç€çš„é•¿æ–¹å½¢ã€ä¸‰ä¸ªæ­£æ–¹å½¢ã€ä¸‰ä¸ªæ¨ªç€çš„é•¿æ–¹å½¢ã€‚</p></li><li><p>æˆ‘ä»¬ä¹‹å‰æè¿‡ï¼Œç±»ä¼¼è¿™æ ·ï¼š</p></li><li><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/30/htNkMF.png" alt="ä¹ç§çª—å£"></p></li></ul><h5 id="enumerate-shifted-anchor"><a href="#enumerate-shifted-anchor" class="headerlink" title="_enumerate_shifted_anchor"></a>_enumerate_shifted_anchor</h5><ul><li><p>æˆ‘ä»¬ç”±å¦‚ä¸Šå‡½æ•°å¾—åˆ°äº†æˆ‘ä»¬æƒ³è¦çš„ä¸€äº›å…ˆéªŒæ¡†ï¼Œ<strong>é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆæ ·å°†å…¶æ˜ å°„åˆ°æ¯ä¸€ä¸ªç½‘æ ¼ç‚¹ä¸­å»ï¼Œå°±æ˜¯é çš„_enumerate_shifted_anchor</strong></p></li><li><p>æˆ‘ä»¬å¯ä»¥å…ˆçœ‹ä¸€ä¸‹å‡½æ•°ï¼š</p></li><li><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">_enumerate_shifted_anchor</span><span class="token punctuation">(</span>anchor_base<span class="token punctuation">,</span> feat_stride<span class="token punctuation">,</span> height<span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># è®¡ç®—ç½‘æ ¼ä¸­å¿ƒç‚¹</span>    shift_x <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> width <span class="token operator">*</span> feat_stride<span class="token punctuation">,</span> feat_stride<span class="token punctuation">)</span>    shift_y <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> height <span class="token operator">*</span> feat_stride<span class="token punctuation">,</span> feat_stride<span class="token punctuation">)</span>    shift_x<span class="token punctuation">,</span> shift_y <span class="token operator">=</span> np<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span>shift_x<span class="token punctuation">,</span> shift_y<span class="token punctuation">)</span>    shift <span class="token operator">=</span> np<span class="token punctuation">.</span>stack<span class="token punctuation">(</span><span class="token punctuation">(</span>shift_x<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>shift_y<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                      shift_x<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>shift_y<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># æ¯ä¸ªç½‘æ ¼ç‚¹ä¸Šçš„9ä¸ªå…ˆéªŒæ¡†</span>    A <span class="token operator">=</span> anchor_base<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    K <span class="token operator">=</span> shift<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    anchor <span class="token operator">=</span> anchor_base<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> A<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> \             shift<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span>K<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># æ‰€æœ‰çš„å…ˆéªŒæ¡†</span>    anchor <span class="token operator">=</span> anchor<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span>K <span class="token operator">*</span> A<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>    <span class="token keyword">return</span> anchor<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>é¦–å…ˆæˆ‘ä»¬è®¡ç®—äº†ç½‘æ ¼çš„ä¸­å¿ƒï¼Œå…¶ä¸­ç”¨åˆ°äº†ä¸€äº›åŸºç¡€çš„å˜é‡ï¼Œæ¯”å¦‚è¯´feat_stride=16, å¦‚ä½•ç†è§£è¿™ä¸ª16å‘¢ï¼Ÿå®é™…ä¸Šæ˜¯å› ä¸ºæˆ‘ä»¬ä¹‹å‰é€šè¿‡ backboneä¸»å¹²æå–æ—¶ï¼Œç»è¿‡äº†4ä¸ªstageï¼Œå‡åŠäº†4æ¬¡é«˜å®½ï¼Œè¿™æ ·ä¸€æ¥æˆ‘ä»¬å°±æˆåŠŸçš„ç¼©å°äº†16å€ï¼Œæ‰€ä»¥æˆ‘ä»¬ç¡®å®šç½‘æ ¼ä¸­å¿ƒçš„æ—¶å€™éœ€è¦å°†è¿™äº›ä¸œè¥¿éƒ½ä¹˜ä»¥16å€ã€‚</p></li><li><p>è€Œæˆ‘ä»¬åæ¥å°±å°†æ•´ç†å¥½ï¼Œç„¶åå¦‚æœæˆ‘ä»¬æƒ³çœ‹ä¸€ä¸‹æˆ‘ä»¬åæ¥å¾—åˆ°çš„æ˜ å°„ç»“æœï¼Œå¯ä»¥åˆ©ç”¨å¦‚ä¸‹ä»£ç è·å–ï¼š</p></li><li><pre class="line-numbers language-python"><code class="language-python">    height<span class="token punctuation">,</span> width<span class="token punctuation">,</span> feat_stride <span class="token operator">=</span> <span class="token number">38</span><span class="token punctuation">,</span><span class="token number">38</span><span class="token punctuation">,</span><span class="token number">16</span>    anchors_all <span class="token operator">=</span> _enumerate_shifted_anchor<span class="token punctuation">(</span>nine_anchors<span class="token punctuation">,</span>feat_stride<span class="token punctuation">,</span>height<span class="token punctuation">,</span>width<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>shape<span class="token punctuation">(</span>anchors_all<span class="token punctuation">)</span><span class="token punctuation">)</span>    fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>    ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">300</span><span class="token punctuation">,</span><span class="token number">900</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">300</span><span class="token punctuation">,</span><span class="token number">900</span><span class="token punctuation">)</span>    shift_x <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> width <span class="token operator">*</span> feat_stride<span class="token punctuation">,</span> feat_stride<span class="token punctuation">)</span>    shift_y <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> height <span class="token operator">*</span> feat_stride<span class="token punctuation">,</span> feat_stride<span class="token punctuation">)</span>    shift_x<span class="token punctuation">,</span> shift_y <span class="token operator">=</span> np<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span>shift_x<span class="token punctuation">,</span> shift_y<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>shift_x<span class="token punctuation">,</span>shift_y<span class="token punctuation">)</span>    box_widths <span class="token operator">=</span> anchors_all<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">-</span>anchors_all<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>    box_heights <span class="token operator">=</span> anchors_all<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">-</span>anchors_all<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">109</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">113</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">115</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        rect <span class="token operator">=</span> plt<span class="token punctuation">.</span>Rectangle<span class="token punctuation">(</span><span class="token punctuation">[</span>anchors_all<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>anchors_all<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>box_widths<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>box_heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">"r"</span><span class="token punctuation">,</span>fill<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>        ax<span class="token punctuation">.</span>add_patch<span class="token punctuation">(</span>rect<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>ç»“æœï¼š</p></li><li><p><a href="https://imgtu.com/i/h0zwR0" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/09/01/h0zwR0.png" alt="output"></a></p></li></ul><p><em>ç»è¿‡ä¸ªäººæ‰€æƒ³ï¼Œå‰é¢é‚£ä¸ªAnchorsåº”è¯¥æ˜¯åˆ†åˆ«é€šè¿‡ä¸¤æ¡è·¯å¾—åˆ°æ¡†ã€å¾—åˆ°é‡Œé¢æ˜¯å¦åŒ…å«ç‰©ä½“ä¹‹åçš„ç»“æœï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦è¿›ä¸€æ­¥é€šè¿‡é‚£ä¸ªproposalçš„å±‚æ¥è¿›è¡Œç­›é€‰ï¼Œæœ€åå¾—åˆ°æœ‰ç‰©ä½“çš„ã€æ¡†æ¯”è¾ƒåˆé€‚çš„å»ºè®®æ¡†ï¼Œå½“ç„¶ï¼Œè¿™åªæ˜¯ç›®å‰æ¥çœ‹ï¼Œæˆ‘è‡ªå·±æ˜¯è¿™ä¹ˆç†è§£çš„ï¼Œåˆ°åæ¥å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œä¸è¿‡ç›®å‰å¤§è‡´æ¥çœ‹å¯èƒ½æ˜¯è¿™æ ·å§â€¦â€¦</em></p><h4 id="Anchors-å…ˆéªŒæ¡†è¯¦è§£-1"><a href="#Anchors-å…ˆéªŒæ¡†è¯¦è§£-1" class="headerlink" title="Anchors å…ˆéªŒæ¡†è¯¦è§£"></a>Anchors å…ˆéªŒæ¡†è¯¦è§£</h4><h5 id="Preface-3"><a href="#Preface-3" class="headerlink" title="Preface"></a>Preface</h5><ul><li>å…ˆéªŒæ¡†æ˜¯é¢„å…ˆè®¾å®šå¥½çš„ï¼Œæˆ‘ä»¬ä¼šé€‰æ‹©ç­‰æˆ‘ä»¬åˆ¤æ–­æ˜¯å¦å«ç‰©ä½“ã€æ»¡è¶³è¦æ±‚çš„æƒ…å†µä¸‹è¿›ä¸€æ­¥å¾—åˆ°æˆ‘ä»¬çš„å»ºè®®æ¡†ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šé€‰æ‹©æˆ‘ä»¬éœ€è¦çš„ä½œä¸ºå»ºè®®æ¡†ã€‚ä¸‹é¢æˆ‘ä»¬çœ‹ä¸€ä¸‹å…ˆéªŒæ¡†æ˜¯æ€ä¹ˆç”Ÿæˆçš„ã€‚</li></ul><h5 id="generate-anchor-base-1"><a href="#generate-anchor-base-1" class="headerlink" title="generate_anchor_base"></a>generate_anchor_base</h5><ul><li><p>æˆ‘ä»¬å…ˆé€šè¿‡generate_anchor_baseè·å¾—åŸºç¡€çš„å…ˆéªŒæ¡†ã€‚</p></li><li><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">generate_anchor_base</span><span class="token punctuation">(</span>base_size<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span> ratios<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                         anchor_scales<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    anchor_base <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>ratios<span class="token punctuation">)</span> <span class="token operator">*</span> len<span class="token punctuation">(</span>anchor_scales<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>ratios<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>anchor_scales<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            h <span class="token operator">=</span> base_size <span class="token operator">*</span> anchor_scales<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>ratios<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            w <span class="token operator">=</span> base_size <span class="token operator">*</span> anchor_scales<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">.</span> <span class="token operator">/</span> ratios<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            index <span class="token operator">=</span> i <span class="token operator">*</span> len<span class="token punctuation">(</span>anchor_scales<span class="token punctuation">)</span> <span class="token operator">+</span> j            anchor_base<span class="token punctuation">[</span>index<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span> h <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">.</span>            anchor_base<span class="token punctuation">[</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span> w <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">.</span>            anchor_base<span class="token punctuation">[</span>index<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> h <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">.</span>            anchor_base<span class="token punctuation">[</span>index<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> w <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">.</span>    <span class="token keyword">return</span> anchor_base<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>æˆ‘ä»¬åœ¨è¿™é‡Œæœ‰ä¸¤ä¸ªåˆ—è¡¨ï¼Œæ¯ä¸ªåˆ—è¡¨é•¿åº¦ä¸º3ï¼ŒåµŒå¥—å¾ªç¯ä¸¤ä¸ªåˆ—è¡¨ï¼Œå¾—åˆ°9ä¸ªåŸºç¡€çš„å…ˆéªŒæ¡†</p></li><li><p>æˆ‘ä»¬å¯ä»¥å°è¯•æ‰“å°ä¸€ä¸‹æˆ‘ä»¬çš„æœ‰å…³å…ˆéªŒæ¡†çš„æ ·å­ï¼š</p></li><li><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/09/01/h0dotS.png" alt="output"></p></li><li><p>å¯ä»¥çœ‹å‡ºæœ‰ä¸‰ä¸ªç«–ç€çš„é•¿æ–¹å½¢ã€ä¸‰ä¸ªæ­£æ–¹å½¢ã€ä¸‰ä¸ªæ¨ªç€çš„é•¿æ–¹å½¢ã€‚</p></li><li><p>æˆ‘ä»¬ä¹‹å‰æè¿‡ï¼Œç±»ä¼¼è¿™æ ·ï¼š</p></li><li><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/30/htNkMF.png" alt="ä¹ç§çª—å£"></p></li></ul><h5 id="enumerate-shifted-anchor-1"><a href="#enumerate-shifted-anchor-1" class="headerlink" title="_enumerate_shifted_anchor"></a>_enumerate_shifted_anchor</h5><ul><li><p>æˆ‘ä»¬ç”±å¦‚ä¸Šå‡½æ•°å¾—åˆ°äº†æˆ‘ä»¬æƒ³è¦çš„ä¸€äº›å…ˆéªŒæ¡†ï¼Œ<strong>é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆæ ·å°†å…¶æ˜ å°„åˆ°æ¯ä¸€ä¸ªç½‘æ ¼ç‚¹ä¸­å»ï¼Œå°±æ˜¯é çš„_enumerate_shifted_anchor</strong></p></li><li><p>æˆ‘ä»¬å¯ä»¥å…ˆçœ‹ä¸€ä¸‹å‡½æ•°ï¼š</p></li><li><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">_enumerate_shifted_anchor</span><span class="token punctuation">(</span>anchor_base<span class="token punctuation">,</span> feat_stride<span class="token punctuation">,</span> height<span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># è®¡ç®—ç½‘æ ¼ä¸­å¿ƒç‚¹</span>    shift_x <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> width <span class="token operator">*</span> feat_stride<span class="token punctuation">,</span> feat_stride<span class="token punctuation">)</span>    shift_y <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> height <span class="token operator">*</span> feat_stride<span class="token punctuation">,</span> feat_stride<span class="token punctuation">)</span>    shift_x<span class="token punctuation">,</span> shift_y <span class="token operator">=</span> np<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span>shift_x<span class="token punctuation">,</span> shift_y<span class="token punctuation">)</span>    shift <span class="token operator">=</span> np<span class="token punctuation">.</span>stack<span class="token punctuation">(</span><span class="token punctuation">(</span>shift_x<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>shift_y<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                      shift_x<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>shift_y<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># æ¯ä¸ªç½‘æ ¼ç‚¹ä¸Šçš„9ä¸ªå…ˆéªŒæ¡†</span>    A <span class="token operator">=</span> anchor_base<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    K <span class="token operator">=</span> shift<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    anchor <span class="token operator">=</span> anchor_base<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> A<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> \             shift<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span>K<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># æ‰€æœ‰çš„å…ˆéªŒæ¡†</span>    anchor <span class="token operator">=</span> anchor<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span>K <span class="token operator">*</span> A<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>    <span class="token keyword">return</span> anchor<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>é¦–å…ˆæˆ‘ä»¬è®¡ç®—äº†ç½‘æ ¼çš„ä¸­å¿ƒï¼Œå…¶ä¸­ç”¨åˆ°äº†ä¸€äº›åŸºç¡€çš„å˜é‡ï¼Œæ¯”å¦‚è¯´feat_stride=16, å¦‚ä½•ç†è§£è¿™ä¸ª16å‘¢ï¼Ÿå®é™…ä¸Šæ˜¯å› ä¸ºæˆ‘ä»¬ä¹‹å‰é€šè¿‡ backboneä¸»å¹²æå–æ—¶ï¼Œç»è¿‡äº†4ä¸ªstageï¼Œå‡åŠäº†4æ¬¡é«˜å®½ï¼Œè¿™æ ·ä¸€æ¥æˆ‘ä»¬å°±æˆåŠŸçš„ç¼©å°äº†16å€ï¼Œæ‰€ä»¥æˆ‘ä»¬ç¡®å®šç½‘æ ¼ä¸­å¿ƒçš„æ—¶å€™éœ€è¦å°†è¿™äº›ä¸œè¥¿éƒ½ä¹˜ä»¥16å€ã€‚</p></li><li><p>è€Œæˆ‘ä»¬åæ¥å°±å°†æ•´ç†å¥½ï¼Œç„¶åå¦‚æœæˆ‘ä»¬æƒ³çœ‹ä¸€ä¸‹æˆ‘ä»¬åæ¥å¾—åˆ°çš„æ˜ å°„ç»“æœï¼Œå¯ä»¥åˆ©ç”¨å¦‚ä¸‹ä»£ç è·å–ï¼š</p></li><li><pre class="line-numbers language-python"><code class="language-python">    height<span class="token punctuation">,</span> width<span class="token punctuation">,</span> feat_stride <span class="token operator">=</span> <span class="token number">38</span><span class="token punctuation">,</span><span class="token number">38</span><span class="token punctuation">,</span><span class="token number">16</span>    anchors_all <span class="token operator">=</span> _enumerate_shifted_anchor<span class="token punctuation">(</span>nine_anchors<span class="token punctuation">,</span>feat_stride<span class="token punctuation">,</span>height<span class="token punctuation">,</span>width<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>shape<span class="token punctuation">(</span>anchors_all<span class="token punctuation">)</span><span class="token punctuation">)</span>    fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>    ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">300</span><span class="token punctuation">,</span><span class="token number">900</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">300</span><span class="token punctuation">,</span><span class="token number">900</span><span class="token punctuation">)</span>    shift_x <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> width <span class="token operator">*</span> feat_stride<span class="token punctuation">,</span> feat_stride<span class="token punctuation">)</span>    shift_y <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> height <span class="token operator">*</span> feat_stride<span class="token punctuation">,</span> feat_stride<span class="token punctuation">)</span>    shift_x<span class="token punctuation">,</span> shift_y <span class="token operator">=</span> np<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span>shift_x<span class="token punctuation">,</span> shift_y<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>shift_x<span class="token punctuation">,</span>shift_y<span class="token punctuation">)</span>    box_widths <span class="token operator">=</span> anchors_all<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">-</span>anchors_all<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>    box_heights <span class="token operator">=</span> anchors_all<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">-</span>anchors_all<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">109</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">113</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">115</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        rect <span class="token operator">=</span> plt<span class="token punctuation">.</span>Rectangle<span class="token punctuation">(</span><span class="token punctuation">[</span>anchors_all<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>anchors_all<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>box_widths<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>box_heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">"r"</span><span class="token punctuation">,</span>fill<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>        ax<span class="token punctuation">.</span>add_patch<span class="token punctuation">(</span>rect<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>ç»“æœï¼š</p></li><li><p><a href="https://imgtu.com/i/h0zwR0" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/09/01/h0zwR0.png" alt="output"></a></p></li></ul><p><em>ç»è¿‡ä¸ªäººæ‰€æƒ³ï¼Œå‰é¢é‚£ä¸ªAnchorsåº”è¯¥æ˜¯åˆ†åˆ«é€šè¿‡ä¸¤æ¡è·¯å¾—åˆ°æ¡†ã€å¾—åˆ°é‡Œé¢æ˜¯å¦åŒ…å«ç‰©ä½“ä¹‹åçš„ç»“æœï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦è¿›ä¸€æ­¥é€šè¿‡é‚£ä¸ªproposalçš„å±‚æ¥è¿›è¡Œç­›é€‰ï¼Œæœ€åå¾—åˆ°æœ‰ç‰©ä½“çš„ã€æ¡†æ¯”è¾ƒåˆé€‚çš„å»ºè®®æ¡†ï¼Œå½“ç„¶ï¼Œè¿™åªæ˜¯ç›®å‰æ¥çœ‹ï¼Œæˆ‘è‡ªå·±æ˜¯è¿™ä¹ˆç†è§£çš„ï¼Œåˆ°åæ¥å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œä¸è¿‡ç›®å‰å¤§è‡´æ¥çœ‹å¯èƒ½æ˜¯è¿™æ ·å§â€¦â€¦</em></p><h4 id="Decode-å¯¹å…ˆéªŒæ¡†è°ƒæ•´è·å¾—å»ºè®®æ¡†"><a href="#Decode-å¯¹å…ˆéªŒæ¡†è°ƒæ•´è·å¾—å»ºè®®æ¡†" class="headerlink" title="Decode-å¯¹å…ˆéªŒæ¡†è°ƒæ•´è·å¾—å»ºè®®æ¡†"></a>Decode-å¯¹å…ˆéªŒæ¡†è°ƒæ•´è·å¾—å»ºè®®æ¡†</h4><h5 id="Preface-4"><a href="#Preface-4" class="headerlink" title="Preface"></a>Preface</h5><p>å‰é¢äº†è§£åˆ°äº†å¦‚ä½•ç”Ÿæˆå…ˆéªŒæ¡†ï¼Œé€šè¿‡æˆ‘ä»¬çš„generate_anchor_baseæ¯ä¸ªåƒç´ ç‚¹å¾—åˆ°ä¹ä¸ªåŸºç¡€çš„æ¡†çš„å„ä¸ªåæ ‡ä¹‹ç±»çš„ï¼Œç„¶åé€šè¿‡_enumerate_shifted_anchoræ¥å¯¹åº”ç”Ÿæˆä¸­å¿ƒç‚¹ï¼Œå°†å…ˆéªŒæ¡†å¯¹åº”åˆ°ä¸­å¿ƒç‚¹ä¸Šå»ï¼ŒçœŸæ­£ç”Ÿæˆå…ˆéªŒæ¡†ã€‚è€Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦é€šè¿‡æˆ‘ä»¬çš„è¿™ä¹ˆå¤šå…ˆéªŒæ¡†è¿›è¡Œç›¸åº”çš„è°ƒæ•´ï¼Œç”Ÿæˆæˆ‘ä»¬éœ€è¦çš„å»ºè®®æ¡†, å¹¶ä¸”åˆ¤æ–­è¿™äº›å»ºè®®æ¡†ä¸­æ˜¯å¦åŒ…å«ç‰©ä½“ï¼š</p><h5 id="æå‰çœ‹çœ‹è¿è¡Œç»“æœå§"><a href="#æå‰çœ‹çœ‹è¿è¡Œç»“æœå§" class="headerlink" title="æå‰çœ‹çœ‹è¿è¡Œç»“æœå§"></a>æå‰çœ‹çœ‹è¿è¡Œç»“æœå§</h5><p>é¦–å…ˆæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹è¿™äº›å»ºè®®æ¡†æ”¾åˆ°å›¾ç‰‡ä¸Šæ˜¯ä»€ä¹ˆæ•ˆæœï¼š</p><p><a href="https://imgtu.com/i/hg93UP" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/09/04/hg93UP.png" alt="å‰äº”åä¸ªå»ºè®®æ¡†ï¼ˆæ³¨æ„ï¼Œæ²¡æœ‰åˆ—å®Œï¼‰"></a></p><ul><li><p>è¿™å°±æ˜¯æˆ‘ä»¬çš„å»ºè®®æ¡†çš„ç»“æœï¼Œæ³¨æ„ï¼Œè¿™å¹¶ä¸æ˜¯æˆ‘ä»¬å¾—åˆ°çš„å…¨éƒ¨å»ºè®®æ¡†ï¼Œè¿™åªæ˜¯æˆ‘ä»¬çš„éƒ¨åˆ†ç»“æœï¼ˆé€‰äº†50ä¸ªä¾¿äºå±•ç¤ºï¼‰ã€‚</p></li><li><p>å¯ä»¥çœ‹å‡ºæ¥ï¼Œè¿™äº›å»ºè®®æ¡†å°†æˆ‘ä»¬åº”è¯¥åœˆå‡ºçš„ç‰©ä½“ä¹Ÿéƒ½æ¡†äº†å‡ºæ¥ï¼Œæ¯ä¸ªåº”è¯¥æ£€æµ‹å‡ºçš„ç‰©ä½“éƒ½æœ‰ç€å¤§å¤§å°å°çš„å»ºè®®æ¡†</p></li><li><p>å»ºè®®æ¡†å°±æ˜¯å¯¹æˆ‘ä»¬å›¾ç‰‡ä¸Šçš„ç›®æ ‡è¿›è¡Œåˆæ­¥ç²—ç•¥çš„ç­›é€‰ã€‚<strong>è€Œåæˆ‘ä»¬çš„åˆ†ç±»ä¼šåœ¨è¿™ä¸ªå»ºè®®æ¡†çš„åŸºç¡€ä¸Šåˆ¤æ–­æ˜¯å¦å«æœ‰æˆ‘ä»¬æƒ³è¦çš„ç‰©ä½“ï¼›åŒæ—¶æˆ‘ä»¬ä¹Ÿä¼šå¯¹å»ºè®®æ¡†çš„å¤§å°è¿›è¡Œç›¸å…³çš„è°ƒæ•´ï¼Œä½¿æˆ‘ä»¬çš„æ¡†æ›´åŠ ç²¾ç¡®ã€‚</strong></p></li><li><p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸‹æ€ä¹ˆå¯¹å…ˆéªŒæ¡†è°ƒæ•´æ¥å¾—åˆ°æˆ‘ä»¬çš„å»ºè®®æ¡†ï¼š</p></li></ul><h5 id="RegionProposalNetworkçš„forwardå‡½æ•°å‰©ä¸‹éƒ¨åˆ†è§£æ"><a href="#RegionProposalNetworkçš„forwardå‡½æ•°å‰©ä¸‹éƒ¨åˆ†è§£æ" class="headerlink" title="RegionProposalNetworkçš„forwardå‡½æ•°å‰©ä¸‹éƒ¨åˆ†è§£æ"></a>RegionProposalNetworkçš„forwardå‡½æ•°å‰©ä¸‹éƒ¨åˆ†è§£æ</h5><p>åœ¨æ­¤ä¹‹å‰æˆ‘ä»¬åœ¨è®²è§£ä¹‹å‰å»ºè®®æ¡†æ„å»ºçš„æ—¶å€™å†™åˆ°äº†ä¸€éƒ¨åˆ†RegionProposalNetworkçš„forwardå‡½æ•°ï¼Œé‚£äº›æ˜¯ä¸ºäº†ç”Ÿæˆå…ˆéªŒæ¡†å¹¶ä¸”å¾—åˆ°ç›¸åº”çš„åˆ†ç±»æ˜¯å¦å«æœ‰ç‰©ä½“ï¼š</p><pre class="line-numbers language-python"><code class="language-python">        n<span class="token punctuation">,</span> _<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w <span class="token operator">=</span> x<span class="token punctuation">.</span>shape        <span class="token comment" spellcheck="true">#-----------------------------------------#</span>        <span class="token comment" spellcheck="true">#   å…ˆè¿›è¡Œä¸€ä¸ª3x3çš„å·ç§¯ï¼Œå¯ç†è§£ä¸ºç‰¹å¾æ•´åˆ</span>        <span class="token comment" spellcheck="true">#-----------------------------------------#</span>        x <span class="token operator">=</span> F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv1<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#-----------------------------------------#</span>        <span class="token comment" spellcheck="true">#   å›å½’é¢„æµ‹å¯¹å…ˆéªŒæ¡†è¿›è¡Œè°ƒæ•´</span>        <span class="token comment" spellcheck="true">#-----------------------------------------#</span>        rpn_locs <span class="token operator">=</span> self<span class="token punctuation">.</span>loc<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        rpn_locs <span class="token operator">=</span> rpn_locs<span class="token punctuation">.</span>permute<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>contiguous<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>view<span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#-----------------------------------------#</span>        <span class="token comment" spellcheck="true">#   åˆ†ç±»é¢„æµ‹å…ˆéªŒæ¡†å†…éƒ¨æ˜¯å¦åŒ…å«ç‰©ä½“</span>        <span class="token comment" spellcheck="true">#-----------------------------------------#</span>        rpn_scores <span class="token operator">=</span> self<span class="token punctuation">.</span>score<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        rpn_scores <span class="token operator">=</span> rpn_scores<span class="token punctuation">.</span>permute<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>contiguous<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>view<span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#--------------------------------------------------------------------------------------#</span>        <span class="token comment" spellcheck="true">#   è¿›è¡Œsoftmaxæ¦‚ç‡è®¡ç®—ï¼Œæ¯ä¸ªå…ˆéªŒæ¡†åªæœ‰ä¸¤ä¸ªåˆ¤åˆ«ç»“æœ</span>        <span class="token comment" spellcheck="true">#   å†…éƒ¨åŒ…å«ç‰©ä½“æˆ–è€…å†…éƒ¨ä¸åŒ…å«ç‰©ä½“ï¼Œrpn_softmax_scores[:, :, 1]çš„å†…å®¹ä¸ºåŒ…å«ç‰©ä½“çš„æ¦‚ç‡</span>        <span class="token comment" spellcheck="true">#--------------------------------------------------------------------------------------#</span>        rpn_softmax_scores <span class="token operator">=</span> F<span class="token punctuation">.</span>softmax<span class="token punctuation">(</span>rpn_scores<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>        rpn_fg_scores <span class="token operator">=</span> rpn_softmax_scores<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>contiguous<span class="token punctuation">(</span><span class="token punctuation">)</span>        rpn_fg_scores <span class="token operator">=</span> rpn_fg_scores<span class="token punctuation">.</span>view<span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#------------------------------------------------------------------------------------------------#</span>        <span class="token comment" spellcheck="true">#   ç”Ÿæˆå…ˆéªŒæ¡†ï¼Œæ­¤æ—¶è·å¾—çš„anchoræ˜¯å¸ƒæ»¡ç½‘æ ¼ç‚¹çš„ï¼Œå½“è¾“å…¥å›¾ç‰‡ä¸º600,600,3çš„æ—¶å€™ï¼Œshapeä¸º(12996, 4)</span>        <span class="token comment" spellcheck="true">#------------------------------------------------------------------------------------------------#</span>        anchor <span class="token operator">=</span> _enumerate_shifted_anchor<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>self<span class="token punctuation">.</span>anchor_base<span class="token punctuation">)</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>feat_stride<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸‹å¦ä¸€éƒ¨åˆ†çš„forwardå‡½æ•°ï¼š</p><pre class="line-numbers language-python"><code class="language-python">rois <span class="token operator">=</span> list<span class="token punctuation">(</span><span class="token punctuation">)</span>        roi_indices <span class="token operator">=</span> list<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>            roi <span class="token operator">=</span> self<span class="token punctuation">.</span>proposal_layer<span class="token punctuation">(</span>rpn_locs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> rpn_fg_scores<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> anchor<span class="token punctuation">,</span> img_size<span class="token punctuation">,</span> scale<span class="token operator">=</span>scale<span class="token punctuation">)</span>            batch_index <span class="token operator">=</span> i <span class="token operator">*</span> torch<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>roi<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            rois<span class="token punctuation">.</span>append<span class="token punctuation">(</span>roi<span class="token punctuation">)</span>            roi_indices<span class="token punctuation">.</span>append<span class="token punctuation">(</span>batch_index<span class="token punctuation">)</span>        rois <span class="token operator">=</span> torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span>rois<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>        roi_indices <span class="token operator">=</span> torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span>roi_indices<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> rpn_locs<span class="token punctuation">,</span> rpn_scores<span class="token punctuation">,</span> rois<span class="token punctuation">,</span> roi_indices<span class="token punctuation">,</span> anchor<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®é™…ä¸Šæˆ‘ä»¬forwardå¦ä¸€éƒ¨åˆ†ä¸»è¦æ˜¯å…³äºProposalå»ºè®®æ¡†ç½‘ç»œçš„ç”Ÿæˆçš„ï¼Œå‰é¢å·²ç»å¾—åˆ°äº†æœ‰å…³çš„å…ˆéªŒæ¡†é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬åªéœ€è¦æ ¹æ®å…ˆéªŒæ¡†æ¥è¿›ä¸€æ­¥å¤„ç†ç”Ÿæˆå»ºè®®æ¡†ã€‚é¦–å…ˆæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è°ƒç”¨äº†proposal_layerï¼Œæˆ‘ä»¬å¯ä»¥å›åˆ°<code>__init__</code>æ¥çœ‹ä¸€ä¸‹æˆ‘ä»¬çš„proposal_layeréƒ½è¿›è¡Œäº†ä»€ä¹ˆï¼š</p><pre class="line-numbers language-python"><code class="language-python">self<span class="token punctuation">.</span>proposal_layer <span class="token operator">=</span> ProposalCreator<span class="token punctuation">(</span>mode<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p> å¯ä»¥çœ‹å‡ºå®ƒè°ƒç”¨äº†æœ‰å…³ProposalCreatorç±»ã€‚æˆ‘ä»¬æ¥ä¸‹æ¥å°±è§£æå­¦ä¹ ä¸€ä¸‹è¿™ä¸ªç±»ï¼š</p><h5 id="ProposalCreator"><a href="#ProposalCreator" class="headerlink" title="ProposalCreator"></a>ProposalCreator</h5><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¯¥ç±»åšäº†ä»€ä¹ˆå·¥ä½œã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">ProposalCreator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> mode<span class="token punctuation">,</span> nms_thresh<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">,</span>                 n_train_pre_nms<span class="token operator">=</span><span class="token number">12000</span><span class="token punctuation">,</span>                 n_train_post_nms<span class="token operator">=</span><span class="token number">600</span><span class="token punctuation">,</span>                 n_test_pre_nms<span class="token operator">=</span><span class="token number">3000</span><span class="token punctuation">,</span>                 n_test_post_nms<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">,</span>                 min_size<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>mode <span class="token operator">=</span> mode        self<span class="token punctuation">.</span>nms_thresh <span class="token operator">=</span> nms_thresh        self<span class="token punctuation">.</span>n_train_pre_nms <span class="token operator">=</span> n_train_pre_nms        self<span class="token punctuation">.</span>n_train_post_nms <span class="token operator">=</span> n_train_post_nms        self<span class="token punctuation">.</span>n_test_pre_nms <span class="token operator">=</span> n_test_pre_nms        self<span class="token punctuation">.</span>n_test_post_nms <span class="token operator">=</span> n_test_post_nms        self<span class="token punctuation">.</span>min_size <span class="token operator">=</span> min_size    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> loc<span class="token punctuation">,</span> score<span class="token punctuation">,</span>                 anchor<span class="token punctuation">,</span> img_size<span class="token punctuation">,</span> scale<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>mode <span class="token operator">==</span> <span class="token string">"training"</span><span class="token punctuation">:</span>            n_pre_nms <span class="token operator">=</span> self<span class="token punctuation">.</span>n_train_pre_nms            n_post_nms <span class="token operator">=</span> self<span class="token punctuation">.</span>n_train_post_nms        <span class="token keyword">else</span><span class="token punctuation">:</span>            n_pre_nms <span class="token operator">=</span> self<span class="token punctuation">.</span>n_test_pre_nms            n_post_nms <span class="token operator">=</span> self<span class="token punctuation">.</span>n_test_post_nms        anchor <span class="token operator">=</span> torch<span class="token punctuation">.</span>from_numpy<span class="token punctuation">(</span>anchor<span class="token punctuation">)</span>        <span class="token keyword">if</span> loc<span class="token punctuation">.</span>is_cuda<span class="token punctuation">:</span>            anchor <span class="token operator">=</span> anchor<span class="token punctuation">.</span>cuda<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#-----------------------------------#</span>        <span class="token comment" spellcheck="true">#   å°†RPNç½‘ç»œé¢„æµ‹ç»“æœè½¬åŒ–æˆå»ºè®®æ¡†</span>        <span class="token comment" spellcheck="true">#-----------------------------------#</span>        roi <span class="token operator">=</span> loc2bbox<span class="token punctuation">(</span>anchor<span class="token punctuation">,</span> loc<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#-----------------------------------#</span>        <span class="token comment" spellcheck="true">#   é˜²æ­¢å»ºè®®æ¡†è¶…å‡ºå›¾åƒè¾¹ç¼˜</span>        <span class="token comment" spellcheck="true">#-----------------------------------#</span>        roi<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> torch<span class="token punctuation">.</span>clamp<span class="token punctuation">(</span>roi<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> min <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> max <span class="token operator">=</span> img_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        roi<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> torch<span class="token punctuation">.</span>clamp<span class="token punctuation">(</span>roi<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> min <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> max <span class="token operator">=</span> img_size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#-----------------------------------#</span>        <span class="token comment" spellcheck="true">#   å»ºè®®æ¡†çš„å®½é«˜çš„æœ€å°å€¼ä¸å¯ä»¥å°äº16</span>        <span class="token comment" spellcheck="true">#-----------------------------------#</span>        min_size <span class="token operator">=</span> self<span class="token punctuation">.</span>min_size <span class="token operator">*</span> scale        keep <span class="token operator">=</span> torch<span class="token punctuation">.</span>where<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>roi<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> roi<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">>=</span> min_size<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>roi<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> roi<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">>=</span> min_size<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        roi <span class="token operator">=</span> roi<span class="token punctuation">[</span>keep<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>        score <span class="token operator">=</span> score<span class="token punctuation">[</span>keep<span class="token punctuation">]</span>        <span class="token comment" spellcheck="true">#-----------------------------------#</span>        <span class="token comment" spellcheck="true">#   æ ¹æ®å¾—åˆ†è¿›è¡Œæ’åºï¼Œå–å‡ºå»ºè®®æ¡†</span>        <span class="token comment" spellcheck="true">#-----------------------------------#</span>        order <span class="token operator">=</span> torch<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>score<span class="token punctuation">,</span> descending<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> n_pre_nms <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>            order <span class="token operator">=</span> order<span class="token punctuation">[</span><span class="token punctuation">:</span>n_pre_nms<span class="token punctuation">]</span>        roi <span class="token operator">=</span> roi<span class="token punctuation">[</span>order<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>        score <span class="token operator">=</span> score<span class="token punctuation">[</span>order<span class="token punctuation">]</span>        <span class="token comment" spellcheck="true">#-----------------------------------#</span>        <span class="token comment" spellcheck="true">#   å¯¹å»ºè®®æ¡†è¿›è¡Œéæå¤§æŠ‘åˆ¶</span>        <span class="token comment" spellcheck="true">#-----------------------------------#</span>        keep <span class="token operator">=</span> nms<span class="token punctuation">(</span>roi<span class="token punctuation">,</span> score<span class="token punctuation">,</span> self<span class="token punctuation">.</span>nms_thresh<span class="token punctuation">)</span>        keep <span class="token operator">=</span> keep<span class="token punctuation">[</span><span class="token punctuation">:</span>n_post_nms<span class="token punctuation">]</span>        roi <span class="token operator">=</span> roi<span class="token punctuation">[</span>keep<span class="token punctuation">]</span>        <span class="token keyword">return</span> roi<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªç±»é‡Œé¢æˆ‘ä»¬ä¸»è¦è°ƒç”¨çš„æ˜¯æˆ‘ä»¬çš„<code>__call__</code>å‡½æ•°ï¼Œåœ¨è¿™ä¸ªå‡½æ•°é‡Œé¢æˆ‘ä»¬ç¬¬ä¸€æ­¥å°±æ˜¯åˆ©ç”¨RPNçš„é¢„æµ‹ç»“æœå¯¹å…ˆéªŒæ¡†è¿›è¡Œè°ƒæ•´, ä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„loc2bbox,</p><pre class="line-numbers language-python"><code class="language-python">       <span class="token comment" spellcheck="true">#-----------------------------------#</span>        <span class="token comment" spellcheck="true">#   å°†RPNç½‘ç»œé¢„æµ‹ç»“æœè½¬åŒ–æˆå»ºè®®æ¡†</span>        <span class="token comment" spellcheck="true">#-----------------------------------#</span>        roi <span class="token operator">=</span> loc2bbox<span class="token punctuation">(</span>anchor<span class="token punctuation">,</span> loc<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p> æˆ‘ä»¬å¯ä»¥ä¸€èµ·çœ‹ä¸€ä¸‹æˆ‘ä»¬çš„è¿™ä¸ªloc2bboxï¼š</p><h6 id="loc2bbox"><a href="#loc2bbox" class="headerlink" title="loc2bbox"></a>loc2bbox</h6><p>src_bboxå°±æ˜¯æˆ‘ä»¬çš„å…ˆéªŒæ¡†ï¼Œè€Œæˆ‘ä»¬çš„locå°±æ˜¯æˆ‘ä»¬çš„å»ºè®®æ¡†ç½‘ç»œçš„é¢„æµ‹ç»“æœï¼Œ</p><ul><li>é¦–å…ˆæˆ‘ä»¬è®¡ç®—äº†å…ˆéªŒæ¡†çš„ä¸­å¿ƒå’Œå®½é«˜ï¼Œé€šè¿‡è¿™ç§æ–¹å¼æ¥ç¡®å®šå…ˆéªŒæ¡†çš„ä½ç½®ã€‚</li><li>åæ¥æˆ‘ä»¬æŠŠæˆ‘ä»¬è·å¾—çš„å…ˆéªŒæ¡†çš„è°ƒæ•´å‚æ•°è¿›è¡Œåˆ†å‰²ï¼Œåˆ†ä¸ºdx dy dw dhï¼Œçœ‹åå­—ä¹Ÿå¯ä»¥çœ‹å‡ºæ¥è¿™ä¸ªæ˜¯ä¸ºäº†å°†æˆ‘ä»¬çš„å…ˆéªŒæ¡†è¿›è¡Œè°ƒæ•´å®½é«˜å’Œä¸­å¿ƒã€‚</li><li>æ¥ä¸‹æ¥å°±æ˜¯å…·ä½“çš„è°ƒæ•´è¿‡ç¨‹ï¼Œè¿™ä¸ªè‡ªå·±çœ‹å°±è¡Œäº†ã€‚è€Œåç»è¿‡ä»¥ä¸Šè°ƒæ•´ï¼Œæˆ‘ä»¬å°±å¯ä»¥è·å¾—è°ƒæ•´åå…ˆéªŒæ¡†çš„ä½ç½®äº†ã€‚ä¹Ÿå°±æ˜¯æˆ‘ä»¬å°šæœªç­›é€‰çš„å»ºè®®æ¡†ã€‚</li><li>æœ€åæˆ‘ä»¬ä¼šå¯¹å»ºè®®æ¡†è¿›è¡Œä¸€ä¸ªæ ¼å¼çš„è½¬å˜ï¼Œè½¬å˜ä¸ºå·¦ä¸Šå³ä¸‹çš„å½¢å¼ï¼Œå°±å®Œæˆäº†ã€‚</li></ul><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">loc2bbox</span><span class="token punctuation">(</span>src_bbox<span class="token punctuation">,</span> loc<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> src_bbox<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> torch<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>loc<span class="token punctuation">.</span>dtype<span class="token punctuation">)</span>    src_width <span class="token operator">=</span> torch<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span>src_bbox<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> src_bbox<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>    src_height <span class="token operator">=</span> torch<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span>src_bbox<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> src_bbox<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>    src_ctr_x <span class="token operator">=</span> torch<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span>src_bbox<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> src_width    src_ctr_y <span class="token operator">=</span> torch<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span>src_bbox<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> src_height    dx <span class="token operator">=</span> loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span>    dy <span class="token operator">=</span> loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span>    dw <span class="token operator">=</span> loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span>    dh <span class="token operator">=</span> loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span>    ctr_x <span class="token operator">=</span> dx <span class="token operator">*</span> src_width <span class="token operator">+</span> src_ctr_x    ctr_y <span class="token operator">=</span> dy <span class="token operator">*</span> src_height <span class="token operator">+</span> src_ctr_y    w <span class="token operator">=</span> torch<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>dw<span class="token punctuation">)</span> <span class="token operator">*</span> src_width    h <span class="token operator">=</span> torch<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>dh<span class="token punctuation">)</span> <span class="token operator">*</span> src_height    dst_bbox <span class="token operator">=</span> torch<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>loc<span class="token punctuation">)</span>    dst_bbox<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> ctr_x <span class="token operator">-</span> <span class="token number">0.5</span> <span class="token operator">*</span> w    dst_bbox<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> ctr_y <span class="token operator">-</span> <span class="token number">0.5</span> <span class="token operator">*</span> h    dst_bbox<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> ctr_x <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> w    dst_bbox<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> ctr_y <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> h    <span class="token keyword">return</span> dst_bbox<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h6 id="ä¸€äº›ç­›é€‰å‰çš„å°äº‹æƒ…"><a href="#ä¸€äº›ç­›é€‰å‰çš„å°äº‹æƒ…" class="headerlink" title="ä¸€äº›ç­›é€‰å‰çš„å°äº‹æƒ…"></a>ä¸€äº›ç­›é€‰å‰çš„å°äº‹æƒ…</h6><p><strong>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯ç­›é€‰å»ºè®®æ¡†äº†ã€‚ä¸è¿‡åœ¨ç­›é€‰ä¹‹å‰æˆ‘ä»¬è¿˜éœ€è¦åšä¸€äº›å°äº‹æƒ…ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å›åˆ°ProposalCreatorç±»ç»§ç»­çœ‹ï¼š</strong></p><ul><li><p>æ¯”å¦‚è¯´åˆ©ç”¨sliceè¿›è¡Œåˆ†å‰²ï¼Œé˜²æ­¢å»ºè®®æ¡†è¶…å‡ºå›¾åƒè¾¹ç¼˜ï¼š</p><ul><li><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true">#-----------------------------------#</span>       <span class="token comment" spellcheck="true">#   é˜²æ­¢å»ºè®®æ¡†è¶…å‡ºå›¾åƒè¾¹ç¼˜</span>       <span class="token comment" spellcheck="true">#-----------------------------------#</span>       roi<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> torch<span class="token punctuation">.</span>clamp<span class="token punctuation">(</span>roi<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> min <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> max <span class="token operator">=</span> img_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>       roi<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> torch<span class="token punctuation">.</span>clamp<span class="token punctuation">(</span>roi<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> min <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> max <span class="token operator">=</span> img_size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul></li><li><p>å¦å¤–é˜²æ­¢å»ºè®®æ¡†è¿‡å°, ä½¿å…¶å»ºè®®æ¡†çš„å®½é«˜çš„æœ€å°å€¼ä¸å¯ä»¥å°äº16ï¼š</p><ul><li><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true">#-----------------------------------#</span>        <span class="token comment" spellcheck="true">#   å»ºè®®æ¡†çš„å®½é«˜çš„æœ€å°å€¼ä¸å¯ä»¥å°äº16</span>        <span class="token comment" spellcheck="true">#-----------------------------------#</span>        min_size <span class="token operator">=</span> self<span class="token punctuation">.</span>min_size <span class="token operator">*</span> scale        keep <span class="token operator">=</span> torch<span class="token punctuation">.</span>where<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>roi<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> roi<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">>=</span> min_size<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>roi<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> roi<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">>=</span> min_size<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        roi <span class="token operator">=</span> roi<span class="token punctuation">[</span>keep<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>        score <span class="token operator">=</span> score<span class="token punctuation">[</span>keep<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul></li></ul><p>å®Œæˆä»¥ä¸Šä¹‹åæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹ç­›é€‰äº†</p><h6 id="åˆæ­¥ç­›é€‰"><a href="#åˆæ­¥ç­›é€‰" class="headerlink" title="åˆæ­¥ç­›é€‰"></a>åˆæ­¥ç­›é€‰</h6><p>é¦–å…ˆæˆ‘ä»¬æŒ‰ç…§æˆç»©å¯¹å…¶è¿›è¡Œåˆæ­¥çš„ç­›é€‰ï¼Œç­›é€‰æ‰æˆç»©è¾ƒä½çš„éƒ¨åˆ†ï¼š</p><ul><li>å¯ä»¥çœ‹å‡ºï¼Œè¿™é‡Œæ˜¯æŒ‰ç…§æˆç»©å…ˆè¿›è¡Œæ’åºï¼Œç„¶åæŒ‘é€‰å‡ºå‰n_pre_nmsï¼ˆè¿™é‡Œé¢æ˜¯3000ï¼‰ä¸ª</li></ul><pre class="line-numbers language-python"><code class="language-python">        <span class="token comment" spellcheck="true">#-----------------------------------#</span>        <span class="token comment" spellcheck="true">#   æ ¹æ®å¾—åˆ†è¿›è¡Œæ’åºï¼Œå–å‡ºå»ºè®®æ¡†</span>        <span class="token comment" spellcheck="true">#-----------------------------------#</span>        order <span class="token operator">=</span> torch<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>score<span class="token punctuation">,</span> descending<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> n_pre_nms <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>            order <span class="token operator">=</span> order<span class="token punctuation">[</span><span class="token punctuation">:</span>n_pre_nms<span class="token punctuation">]</span>        roi <span class="token operator">=</span> roi<span class="token punctuation">[</span>order<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>        score <span class="token operator">=</span> score<span class="token punctuation">[</span>order<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h6 id="éæå¤§æŠ‘åˆ¶"><a href="#éæå¤§æŠ‘åˆ¶" class="headerlink" title="éæå¤§æŠ‘åˆ¶"></a>éæå¤§æŠ‘åˆ¶</h6><p>éæå¤§æŠ‘åˆ¶å¯ä»¥å°†æˆ‘ä»¬çš„å¯†é›†é‡å çš„æ¡†æ¡†å»æ‰é€‰å–ä¸€ä¸ªæœ€ä½³çš„æ¡†æ¡†ã€‚è¿™æ ·ä¸€æ¥æˆ‘ä»¬å°±æˆåŠŸå¾—åˆ°äº†æˆ‘ä»¬æƒ³è¦çš„å»ºè®®æ¡†ã€‚</p><pre class="line-numbers language-python"><code class="language-python">        <span class="token comment" spellcheck="true">#-----------------------------------#</span>        <span class="token comment" spellcheck="true">#   å¯¹å»ºè®®æ¡†è¿›è¡Œéæå¤§æŠ‘åˆ¶</span>        <span class="token comment" spellcheck="true">#-----------------------------------#</span>        keep <span class="token operator">=</span> nms<span class="token punctuation">(</span>roi<span class="token punctuation">,</span> score<span class="token punctuation">,</span> self<span class="token punctuation">.</span>nms_thresh<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>äº‹å®ä¸Šéæå¤§æŠ‘åˆ¶ä¸æ˜¯é‚£ä¹ˆå›°éš¾ï¼Œä»–å°±æ˜¯ä¸æ–­å–å‡ºç½®ä¿¡åº¦æœ€é«˜çš„å»ºè®®æ¡†ï¼Œç„¶åå°†å’Œå…¶IOUè¾ƒå¤§çš„éƒ½åˆ æ‰ã€‚æ¥ç€æˆ‘ä»¬å°±å¯ä»¥ä¿ç•™ä¸€å®šåŒºåŸŸå†…å¾—åˆ†æœ€å¤§çš„æ¡†æ¡†äº†ã€‚</p><h6 id="é€‰å‡ºå‰600ä¸ªæ¡†"><a href="#é€‰å‡ºå‰600ä¸ªæ¡†" class="headerlink" title="é€‰å‡ºå‰600ä¸ªæ¡†"></a>é€‰å‡ºå‰600ä¸ªæ¡†</h6><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä¼šé€‰å‡ºå‰n_train_post_nmsä¸ªï¼ˆè¿™é‡Œæ˜¯600ï¼‰æ¡†ä½œä¸ºå»ºè®®æ¡†ã€‚</p><pre class="line-numbers language-python"><code class="language-python">        keep <span class="token operator">=</span> keep<span class="token punctuation">[</span><span class="token punctuation">:</span>n_post_nms<span class="token punctuation">]</span>        roi <span class="token operator">=</span> roi<span class="token punctuation">[</span>keep<span class="token punctuation">]</span>        <span class="token keyword">return</span> roi<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h5 id="æœ€ç»ˆ"><a href="#æœ€ç»ˆ" class="headerlink" title="æœ€ç»ˆ"></a>æœ€ç»ˆ</h5><p>è€Œåå°±æ˜¯ä¸€äº›ç®€å•å¤„ç†å°±å¾—åˆ°æˆ‘ä»¬æœ€ç»ˆçš„å»ºè®®æ¡†äº†ã€‚è€Œåæˆ‘ä»¬å…±äº«ç‰¹å¾å±‚è¿›è¡Œæˆªå–ã€é€šè¿‡ROIpoolingå±‚è¿™äº›å°±æ˜¯åäº‹äº†ã€‚</p><pre class="line-numbers language-python"><code class="language-python">rois <span class="token operator">=</span> list<span class="token punctuation">(</span><span class="token punctuation">)</span>        roi_indices <span class="token operator">=</span> list<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>            roi <span class="token operator">=</span> self<span class="token punctuation">.</span>proposal_layer<span class="token punctuation">(</span>rpn_locs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> rpn_fg_scores<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> anchor<span class="token punctuation">,</span> img_size<span class="token punctuation">,</span> scale<span class="token operator">=</span>scale<span class="token punctuation">)</span>            batch_index <span class="token operator">=</span> i <span class="token operator">*</span> torch<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>roi<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            rois<span class="token punctuation">.</span>append<span class="token punctuation">(</span>roi<span class="token punctuation">)</span>            roi_indices<span class="token punctuation">.</span>append<span class="token punctuation">(</span>batch_index<span class="token punctuation">)</span>        rois <span class="token operator">=</span> torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span>rois<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>        roi_indices <span class="token operator">=</span> torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span>roi_indices<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> rpn_locs<span class="token punctuation">,</span> rpn_scores<span class="token punctuation">,</span> rois<span class="token punctuation">,</span> roi_indices<span class="token punctuation">,</span> anchor<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="é‡åˆ°äº†ä¸€ç‚¹ç‚¹é—®é¢˜"><a href="#é‡åˆ°äº†ä¸€ç‚¹ç‚¹é—®é¢˜" class="headerlink" title="é‡åˆ°äº†ä¸€ç‚¹ç‚¹é—®é¢˜"></a>é‡åˆ°äº†ä¸€ç‚¹ç‚¹é—®é¢˜</h5><p>æˆ‘ä»¬åœ¨è¿è¡Œpredict.pyæ—¶é‡åˆ°äº†ä¸¤ä¸ªé—®é¢˜ï¼Œæ‰€å¹¸éƒ½æ‰¾åˆ°äº†ç›¸åº”çš„åšå®¢æ¥å°è¯•è§£å†³ï¼š</p><ul><li>ç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„çš„é—®é¢˜ï¼Œè¿™ä¸ªé—®é¢˜éœ€è¦å¥½å¥½è€ƒè™‘ä¸€ä¸‹ï¼Œ<a href="https://segmentfault.com/a/1190000039175570" target="_blank" rel="noopener">ç»ˆäºææ‡‚äº†Pythonæ¨¡å—ä¹‹é—´çš„ç›¸äº’å¼•ç”¨é—®é¢˜</a>ï¼Œ<a href="https://blog.csdn.net/xiongchengluo1129/article/details/80453599" target="_blank" rel="noopener">åœ¨Pythonä¸­ä»¥ç»å¯¹è·¯å¾„æˆ–è€…ç›¸å¯¹è·¯å¾„å¯¼å…¥æ–‡ä»¶çš„æ–¹æ³•</a>è¿™æ˜¯ç¬¬ä¸€ä¸ªé—®é¢˜ã€‚</li><li>å¦å¤–ä¸€ä¸ªæ˜¯æˆ‘ä»¬çš„condaçš„æœ‰å…³é—®é¢˜ï¼Œæ˜¯è¿è¡Œç¯å¢ƒçš„é—®é¢˜ï¼Œ<a href="https://www.cnblogs.com/maomaozi/p/14619961.html" target="_blank" rel="noopener">numpyï¼šDLL load failed while importing _multiarray_umath: æ‰¾ä¸åˆ°æŒ‡å®šçš„æ¨¡å—</a></li></ul><p>æ‰€å¹¸æœ€ç»ˆæˆåŠŸè¿è¡Œäº†ï¼Œè¿™è¿˜éœ€è¦æ„Ÿè°¢@å¼ åˆ›æ–°çš„å¸®åŠ©ï¼Œæˆ‘ä»¬åœ¨ä¸€èµ·æ¢ç´¢äº†å¤§æ¦‚æœ‰2ä¸ªå¤šå°æ—¶ã€‚æœ€ç»ˆè§£å†³äº†é—®é¢˜ã€‚</p><h4 id="æ¥ä¸€ä¸ªå°å°çš„æ€»ç»“"><a href="#æ¥ä¸€ä¸ªå°å°çš„æ€»ç»“" class="headerlink" title="æ¥ä¸€ä¸ªå°å°çš„æ€»ç»“"></a>æ¥ä¸€ä¸ªå°å°çš„æ€»ç»“</h4><p>å®é™…ä¸Šæˆ‘ä»¬çš„è¿™ä¸ªç”ŸæˆProposalçš„æ•´ä¸ªè¿‡ç¨‹å°±åˆ†ä¸º3æ­¥ï¼ˆå‡ ä¹éƒ½åœ¨RegionProposalNetworké‡Œé¢äº†ï¼‰ï¼š</p><ul><li>ç¬¬ä¸€æ­¥å°±æ˜¯è·å¾—æˆ‘ä»¬å»ºè®®æ¡†ç½‘ç»œçš„é¢„æµ‹ç»“æœã€‚</li><li>ç¬¬äºŒæ­¥æ˜¯ç”Ÿæˆå…ˆéªŒæ¡†ã€‚</li><li>ç¬¬ä¸‰æ­¥æ˜¯æ ¹æ®é¢„æµ‹ç»“æœæ¥å¯¹å…ˆéªŒæ¡†è¿›è¡Œè°ƒæ•´å¹¶ä¸”é€šè¿‡åˆæ­¥ç­›é€‰ã€NMSã€é€‰å‡ºTOP-Næ¥ç¡®å®šæœ€ç»ˆçš„å»ºè®®æ¡†ç»“æœã€‚</li></ul><h4 id="ROI-Poolingå±‚ä»‹ç»-åˆ©ç”¨å»ºè®®æ¡†æˆªå–å…¬å…±ç‰¹å¾å±‚"><a href="#ROI-Poolingå±‚ä»‹ç»-åˆ©ç”¨å»ºè®®æ¡†æˆªå–å…¬å…±ç‰¹å¾å±‚" class="headerlink" title="ROI-Poolingå±‚ä»‹ç»-åˆ©ç”¨å»ºè®®æ¡†æˆªå–å…¬å…±ç‰¹å¾å±‚"></a>ROI-Poolingå±‚ä»‹ç»-åˆ©ç”¨å»ºè®®æ¡†æˆªå–å…¬å…±ç‰¹å¾å±‚</h4><h5 id="Preface-5"><a href="#Preface-5" class="headerlink" title="Preface"></a>Preface</h5><p>æˆ‘ä»¬å‰é¢å·²ç»äº†è§£æœ‰å…³æå–ç‰¹å¾å¾—åˆ°featuremapè¿‡ç¨‹ã€ç”Ÿæˆå…ˆéªŒæ¡†åè¿›ä¸€æ­¥å¾—åˆ°å»ºè®®æ¡†çš„è¿‡ç¨‹ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦è¿›ä¸€æ­¥å­¦ä¹ æœ‰å…³ROIPoolingå±‚çš„æœ‰å…³çŸ¥è¯†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20210904180046.png" alt="å…¨è¿‡ç¨‹"></p><h5 id="RoIPoolingå±‚åŠŸèƒ½"><a href="#RoIPoolingå±‚åŠŸèƒ½" class="headerlink" title="RoIPoolingå±‚åŠŸèƒ½"></a>RoIPoolingå±‚åŠŸèƒ½</h5><p>ç”±äºROIPoolingä½¿ç”¨C++ä»£ç æ¥å®ç°çš„æ‰€ä»¥æˆ‘ä»¬ä¸ä¼šç»†ç»†è®²è§£ã€‚æˆ‘ä»¬ä»…ä»…é€šè¿‡ä¸€äº›è¾“å…¥è¾“å‡ºå±‚çš„shapeæ¥äº†è§£ä¸€ä¸‹æœ‰å…³çš„åŠŸèƒ½å°±OKã€‚</p><ul><li>åˆšå¼€å§‹çš„feature mapï¼Œä¹Ÿå°±æ˜¯å…±äº«ç‰¹å¾å±‚çš„shapeå°±æ˜¯  [1, 1024, 38, 38]</li><li>Roisçš„shapeå°±æ˜¯[600, 4], 600ä¸ªæˆ‘ä»¬ä¹‹å‰é€‰å–å¥½çš„å»ºè®®æ¡†ã€‚<ul><li>å®ƒä¼šåœ¨feature mapè¿›è¡Œæˆªå–ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¯´çš„æ˜ å°„å•¦</li><li>è€Œä¹‹åæˆ‘ä»¬ä¼šå¯¹æˆªå–è·å¾—çš„å±€éƒ¨ç‰¹å¾å±‚ï¼Œç„¶åå†ROIPoolingå±‚ä¸­æˆ‘ä»¬ä¼šå¯¹è¿™äº›å±€éƒ¨ç‰¹å¾å±‚è¿›è¡Œåˆ†åŒºåŸŸçš„æ± åŒ–ï¼Œåœ¨æ± åŒ–å®Œä¹‹åæˆ‘ä»¬å°±ä¼šå¾—åˆ°åŒç­‰shapeçš„å±€éƒ¨ç‰¹å¾å±‚ã€‚</li></ul></li><li>ç»è¿‡æˆ‘ä»¬çš„ROIPoolingå±‚ä¹‹åï¼Œæˆ‘ä»¬å¾—åˆ°çš„å¼ é‡shapeå˜ä¸º[600, 1024, 14, 14].</li></ul><p>è¿™å°±æ˜¯å®ƒçš„åŠŸèƒ½ï¼Œå°†æˆ‘ä»¬çš„æ¡†æ± åŒ–åˆ°åŒä¸€shapeä¸Šè¿›è¡Œå¤„ç†ã€‚å°±è¯´è¿™ä¹ˆå¤šå§ã€‚</p><h4 id="Classifier-è¿›è¡Œå›å½’é¢„æµ‹å’Œåˆ†ç±»é¢„æµ‹"><a href="#Classifier-è¿›è¡Œå›å½’é¢„æµ‹å’Œåˆ†ç±»é¢„æµ‹" class="headerlink" title="Classifier-è¿›è¡Œå›å½’é¢„æµ‹å’Œåˆ†ç±»é¢„æµ‹"></a>Classifier-è¿›è¡Œå›å½’é¢„æµ‹å’Œåˆ†ç±»é¢„æµ‹</h4><h5 id="Preface-6"><a href="#Preface-6" class="headerlink" title="Preface"></a>Preface</h5><p>ä»¥ä¸Šæˆ‘ä»¬å¾—åˆ°äº†ROIPoolingå±‚çš„è¾“å‡ºï¼Œå¾—åˆ°äº†ä¸€ä¸ªshapeä¸º[600, 1024, 14,14]çš„ä¸€ä¸ªå¼ é‡ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹æˆ‘ä»¬å¦‚ä½•å¯¹ROIPoolingå±‚çš„è¾“å‡ºè¿›è¡Œåˆ†ç±»å’Œå›å½’é¢„æµ‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20210904180046.png" alt="å…¨è¿‡ç¨‹"></p><h5 id="init"><a href="#init" class="headerlink" title="__init__"></a><code>__init__</code></h5><ul><li><p>self.classifier : æˆ‘ä»¬ä¹‹å‰å­¦åˆ°è¿™é‡Œé¢ä½¿ç”¨ResNet50çš„æ—¶å€™ï¼Œä¸»å¹²æå–ç½‘ç»œbackboneå¹¶æ²¡æœ‰å®Œå…¨ä½¿ç”¨æ‰€æœ‰çš„5ä¸ªstageï¼Œè€Œæ˜¯ä»…ä»…ä½¿ç”¨äº†å‰4ä¸ªï¼Œè€Œæœ€åä¸€ä¸ªstageå°±æ˜¯è¦åœ¨ROIPoolingå±‚å¤„ç†è¿‡ä¹‹åæ‰è¿›è¡Œã€‚æ‰€ä»¥è¿™é‡Œé¦–å…ˆå®šä¹‰äº†è¿™ä¸ªç‰¹å¾æå–å±‚ã€‚</p><ul><li>ç”±äºè¿™ä¸ªclassifieræ˜¯åŒ…æ‹¬å…¨å±€æ± åŒ–çš„ï¼Œæ‰€ä»¥è¯´æˆ‘ä»¬ROIä¹‹åé€šè¿‡è¿™ä¸ªclassifieråçš„å¼ é‡shapeå°±å˜ä¸º[600, 2048, 1, 1]</li><li>å¦‚æœæ²¡æœ‰è¿™ä¸ªå…¨å±€æ± åŒ–ï¼Œæˆ‘ä»¬è·å¾—çš„shapeåº”è¯¥æ˜¯[600, 2048, 7, 7]é«˜å®½å‡åŠï¼Œé€šé“æ•°åŠ å€ï¼Œå°±æ˜¯ä¸€ä¸ªå…¸å‹çš„ResNetæ™®é€šBlock.</li><li>è€Œåæ¥çš„forwardè¿›ä¸€æ­¥å°±reshapeä¸º[600,2048]äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æˆ‘ä»¬çš„åˆ†ç±»é¢„æµ‹å’Œå›å½’é¢„æµ‹äº†ã€‚</li></ul></li><li><p>è€Œåæˆ‘ä»¬ä¸¤ä¸ªçº¿æ€§å±‚Linearè¾“å…¥å¾ˆæ˜æ˜¾å°±æ˜¯2048ï¼Œè€Œè¾“å‡ºåˆ†åˆ«å°±æ˜¯æˆ‘ä»¬çš„å›å½’å’Œé¢„æµ‹ç»“æœ         </p><ul><li>å…¶ä¸­çš„n_classeså°±æ˜¯æˆ‘ä»¬çš„æ˜¯å¦åŒ…å«ç‰©ä½“ä»¥åŠç‰©ä½“çš„ç§ç±»</li><li>å…¶ä¸­çš„n_classes*4å°±æ˜¯å¯¹å»ºè®®æ¡†çš„è°ƒæ•´å‚æ•°ï¼Œæ¯ä¸€ä¸ªç±»å¯¹åº”ä¸€ä¸ªè°ƒæ•´å‚æ•°ã€‚</li></ul></li><li><p>åªéœ€è¦ç¬¬äº”æ¬¡ç‰¹å¾æå–åå°±æ˜¯åˆ†ç±»é¢„æµ‹å’Œå›å½’é¢„æµ‹äº†ã€‚</p></li><li><p>éœ€è¦æ³¨æ„ï¼Œè¿™ä¸ªåˆ†ç±»é¢„æµ‹å’Œå›å½’é¢„æµ‹ç»“æœéƒ½æ˜¯é’ˆå¯¹å»ºè®®æ¡†çš„ã€‚</p></li></ul><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Resnet50RoIHead</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> n_class<span class="token punctuation">,</span> roi_size<span class="token punctuation">,</span> spatial_scale<span class="token punctuation">,</span> classifier<span class="token punctuation">)</span><span class="token punctuation">:</span>        super<span class="token punctuation">(</span>Resnet50RoIHead<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>classifier <span class="token operator">=</span> classifier        <span class="token comment" spellcheck="true">#--------------------------------------#</span>        <span class="token comment" spellcheck="true">#   å¯¹ROIPoolingåçš„çš„ç»“æœè¿›è¡Œå›å½’é¢„æµ‹</span>        <span class="token comment" spellcheck="true">#--------------------------------------#</span>        self<span class="token punctuation">.</span>cls_loc <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">,</span> n_class <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#-----------------------------------#</span>        <span class="token comment" spellcheck="true">#   å¯¹ROIPoolingåçš„çš„ç»“æœè¿›è¡Œåˆ†ç±»</span>        <span class="token comment" spellcheck="true">#-----------------------------------#</span>        self<span class="token punctuation">.</span>score <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">,</span> n_class<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#-----------------------------------#</span>        <span class="token comment" spellcheck="true">#   æƒå€¼åˆå§‹åŒ–</span>        <span class="token comment" spellcheck="true">#-----------------------------------#</span>        normal_init<span class="token punctuation">(</span>self<span class="token punctuation">.</span>cls_loc<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.001</span><span class="token punctuation">)</span>        normal_init<span class="token punctuation">(</span>self<span class="token punctuation">.</span>score<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>roi <span class="token operator">=</span> RoIPool<span class="token punctuation">(</span><span class="token punctuation">(</span>roi_size<span class="token punctuation">,</span> roi_size<span class="token punctuation">)</span><span class="token punctuation">,</span> spatial_scale<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è®©æˆ‘ä»¬å¯¹å»ºè®®æ¡†æœ‰ä¸€ä¸ªæ•´ä½“çš„ç†è§£ï¼š<br>äº‹å®ä¸Šå»ºè®®æ¡†å°±æ˜¯å¯¹å›¾ç‰‡å“ªä¸€ä¸ªåŒºåŸŸæœ‰ç‰©ä½“å­˜åœ¨è¿›è¡Œåˆæ­¥ç­›é€‰ã€‚</p><p>é€šè¿‡ä¸»å¹²ç‰¹å¾æå–ç½‘ç»œï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—ä¸€ä¸ªå…¬ç”¨ç‰¹å¾å±‚ï¼Œå½“è¾“å…¥å›¾ç‰‡ä¸º600x600x3çš„æ—¶å€™ï¼Œå®ƒçš„shapeæ˜¯38x38x1024ï¼Œç„¶åå»ºè®®æ¡†ä¼šå¯¹è¿™ä¸ªå…¬ç”¨ç‰¹å¾å±‚è¿›è¡Œæˆªå–ã€‚</p><p>å…¶å®å…¬ç”¨ç‰¹å¾å±‚é‡Œé¢çš„38x38å¯¹åº”ç€å›¾ç‰‡é‡Œçš„38x38ä¸ªåŒºåŸŸï¼Œ38x38ä¸­çš„æ¯ä¸€ä¸ªç‚¹ç›¸å½“äºè¿™ä¸ªåŒºåŸŸå†…éƒ¨æ‰€æœ‰ç‰¹å¾çš„æµ“ç¼©ã€‚</p><p>å»ºè®®æ¡†ä¼šå¯¹è¿™38x38ä¸ªåŒºåŸŸè¿›è¡Œæˆªå–ï¼Œä¹Ÿå°±æ˜¯è®¤ä¸ºè¿™äº›åŒºåŸŸé‡Œå­˜åœ¨ç›®æ ‡ï¼Œç„¶åå°†æˆªå–çš„ç»“æœè¿›è¡Œresizeï¼Œresizeåˆ°14x14x1024çš„å¤§å°ã€‚</p><p>ç„¶åå†å¯¹æ¯ä¸ªå»ºè®®æ¡†å†è¿›è¡ŒResnetåŸæœ‰çš„ç¬¬äº”æ¬¡å‹ç¼©ã€‚å‹ç¼©å®Œåè¿›è¡Œä¸€ä¸ªå¹³å‡æ± åŒ–ï¼Œå†è¿›è¡Œä¸€ä¸ªFlattenï¼Œæœ€ååˆ†åˆ«è¿›è¡Œä¸€ä¸ªnum_classesçš„å…¨è¿æ¥å’Œ(num_classes)x4å…¨è¿æ¥ã€‚</p><p>num_classesçš„å…¨è¿æ¥ç”¨äºå¯¹æœ€åè·å¾—çš„æ¡†è¿›è¡Œåˆ†ç±»ï¼Œ(num_classes)x4å…¨è¿æ¥ç”¨äºå¯¹ç›¸åº”çš„å»ºè®®æ¡†è¿›è¡Œè°ƒæ•´ã€‚</p><p>é€šè¿‡è¿™äº›æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—æ‰€æœ‰å»ºè®®æ¡†çš„è°ƒæ•´æƒ…å†µï¼Œå’Œè¿™ä¸ªå»ºè®®æ¡†è°ƒæ•´åæ¡†å†…ç‰©ä½“çš„ç±»åˆ«ã€‚</p><p>äº‹å®ä¸Šï¼Œåœ¨ä¸Šä¸€æ­¥è·å¾—çš„å»ºè®®æ¡†å°±æ˜¯ROIçš„å…ˆéªŒæ¡†ã€‚</p><p>å¯¹Proposalå»ºè®®æ¡†åŠ ä»¥åˆ©ç”¨çš„è¿‡ç¨‹ä¸shapeå˜åŒ–å¦‚å›¾æ‰€ç¤ºï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20210904192628.png" alt="shape å˜åŒ–"></p><p>å»ºè®®æ¡†è°ƒæ•´åçš„ç»“æœå°±æ˜¯æœ€ç»ˆçš„é¢„æµ‹ç»“æœäº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> pytorch </tag>
            
            <tag> ç›®æ ‡æ£€æµ‹ </tag>
            
            <tag> Faster RCNN </tag>
            
            <tag> æºç è§£è¯» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç›®æ ‡æ£€æµ‹ç¬”è®°ï¼ˆä¸Šï¼‰</title>
      <link href="/2021/09/06/mu-biao-jian-ce-bi-ji-shang/"/>
      <url>/2021/09/06/mu-biao-jian-ce-bi-ji-shang/</url>
      
        <content type="html"><![CDATA[<h4 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h4><p>æœ¬ç¬”è®°ä¸»è¦æ˜¯é’ˆå¯¹two-stageç³»åˆ—RCNNæ¨¡å‹çš„ç†è§£ï¼Œä¸»è¦å°±æ˜¯ä¸€äº›ç›¸å…³çš„çŸ¥è¯†ç‚¹ç¬”è®°ã€‚èŠ±äº†åå¤©æ¥è®°è¿™ä¸ªç¬”è®°ï¼Œé¡ºå¸¦ç€ä¹Ÿæ˜¯ä¸€ä¸ªå­¦ä¹ çš„è¿‡ç¨‹ã€‚ä»å¼€å§‹å…¥é—¨ç›®æ ‡æ£€æµ‹åˆ°å„ä¸ªæ¨¡å‹RCNNã€SPPNETã€FAST RCNNã€FASTER RCNNçš„åŸç†ä¸æ”¹è¿›çš„è¿‡ç¨‹ã€‚å…¶ä¸­æ²¡æœ‰ä»€ä¹ˆæºç ï¼Œæºç è§£è¯»å•ç‹¬æ”¾åˆ°å…¶ä»–çš„ç¬”è®°ä¸­äº†ã€‚</p><h3 id="ç›®æ ‡æ£€æµ‹R-CNNæ¨¡å‹"><a href="#ç›®æ ‡æ£€æµ‹R-CNNæ¨¡å‹" class="headerlink" title="ç›®æ ‡æ£€æµ‹R-CNNæ¨¡å‹"></a>ç›®æ ‡æ£€æµ‹R-CNNæ¨¡å‹</h3><ul><li>åœ¨CVPR 2014ä¸­Ross Girshickæå‡ºR-CNNã€‚</li><li>æå‡ºäº†ç‰©ä½“æ£€æµ‹çš„é‡è¦çš„æ€è·¯</li></ul><h4 id="å®Œæ•´çš„R-CNNç»“æ„"><a href="#å®Œæ•´çš„R-CNNç»“æ„" class="headerlink" title="å®Œæ•´çš„R-CNNç»“æ„"></a>å®Œæ•´çš„R-CNNç»“æ„</h4><p>ä¸ä½¿ç”¨æš´åŠ›æ–¹æ³•ï¼Œè€Œä½¿ç”¨å€™é€‰åŒºåŸŸæ–¹æ³•ï¼ˆregion proposal method)ï¼Œåˆ›å»ºç›®æ ‡æ£€æµ‹çš„åŒºåŸŸ<strong>æ”¹å˜äº†å›¾åƒé¢†åŸŸå®ç°ç‰©ä½“æ£€æµ‹çš„æ¨¡å‹æ€è·¯</strong>ï¼ŒR-CNNæ˜¯ä»¥æ·±åº¦ç¥ç»ç½‘ç»œä¸ºåŸºç¡€çš„ç‰©ä½“æ£€æµ‹çš„æ¨¡å‹ï¼ŒR-CNNåœ¨å½“æ—¶ä»¥ä¼˜å¼‚çš„æ€§èƒ½ä»¤ä¸–äººç©ç›®ï¼Œä»¥R-CNNä¸ºåŸºç‚¹ï¼Œåç»­çš„SPPNetï¼ŒFast R-CNNæ¨¡å‹éƒ½æ˜¯ç…§ç€è¿™ä¸ªç‰©ä½“æ£€æµ‹çš„æ€è·¯ã€‚</p><p><a href="https://imgtu.com/i/hP62TI" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/23/hP62TI.md.png" alt="åŸºæœ¬ç»“æ„"></a></p><ul><li>æ­¥éª¤ï¼ˆä»¥AlexNetç½‘ç»œä¸ºåŸºå‡†ï¼‰<ul><li><ol><li>æ‰¾å‡ºå›¾ç‰‡ä¸­å¯èƒ½å­˜åœ¨ç›®æ ‡çš„å€™é€‰åŒºåŸŸregion proposalï¼ˆå¯¹äº1å¼ å›¾ç‰‡æ‰¾2000ä¸ªå€™é€‰åŒºåŸŸï¼‰</li></ol></li><li><ol start="2"><li>å°†å€™é€‰åŒºåŸŸè°ƒæ•´ä¸ºäº†é€‚åº”AlexNetç½‘ç»œçš„è¾“å…¥å›¾åƒå¤§å°227*227ï¼Œé€šè¿‡CNNå¯¹å€™é€‰åŒºåŸŸæå–ç‰¹å¾å‘é‡ï¼Œ2000ä¸ªå»ºè®®æ¡†çš„CNNç‰¹å¾ç»„åˆæˆç½‘ç»œAlexNetçš„æœ€ç»ˆè¾“å‡ºï¼š2000Ã—4096ç»´çŸ©é˜µã€‚ï¼ˆå¯¹ç€ä¸¤åƒä¸ªåŒºåŸŸåšå¤§å°è°ƒæ•´å˜æ¢ç„¶åæ”¾åˆ°CNNç½‘ç»œä¸­å¾—åˆ°ä¸¤åƒä¸ªç‰¹å¾å‘é‡ï¼‰</li></ol></li><li><ol start="3"><li>å°†2000Ã—4096ç»´ç‰¹å¾ç»è¿‡SVMåˆ†ç±»å™¨ï¼ˆ20ç§åˆ†ç±»ï¼ŒSVMæ˜¯äºŒåˆ†ç±»å™¨ï¼Œåˆ™æœ‰20ä¸ªSVMï¼‰ï¼Œè·å¾—2000ç§°20ç§ç±»åˆ«çŸ©é˜µï¼ˆ<strong>ç»è¿‡20ä¸ªç±»åˆ«çš„SVMåˆ†ç±»å™¨ï¼Œå¯¹äº2000ä¸ªå€™é€‰åŒºåŸŸåšåˆ¤æ–­ï¼Œå¾—åˆ°2000Ã—20çš„å¾—åˆ†çŸ©é˜µ</strong>ï¼‰ï¼ˆåšåˆ†ç±»ï¼Œåæ¥ä¸ç”¨å‘é‡æœºäº†ï¼Œæ¢æˆç¥ç»ç½‘ç»œäº†ï¼‰</li></ol></li><li><ol start="4"><li>åˆ†åˆ«å¯¹2000Ã—20ç»´çŸ©é˜µä¸­è¿›è¡Œéæå¤§å€¼æŠ‘åˆ¶ï¼ˆNMSï¼šnon-maximum suppression)å»é™¤é‡å åº¦é«˜çš„ã€ä¸å¥½çš„å»ºè®®æ¡†ï¼Œå¾—åˆ°ä¸ç›®æ ‡ç‰©ä½“æœ€ç¬¦åˆï¼Œåˆ†æ•°æœ€é«˜çš„ä¸€äº›å»ºè®®æ¡†ã€‚</li></ol></li><li><ol start="5"><li>ä¿®æ­£bbox,å¯¹bboxåšå›å½’å¾®è°ƒ</li></ol></li></ul></li></ul><p><em>æ¥ä¸‹æ¥æˆ‘ä»¬è¯¦ç»†ä»‹ç»ä¸€ä¸‹å„ä¸ªè¿‡ç¨‹çš„å®ç°</em>ï¼š</p><h4 id="1-å€™é€‰åŒºåŸŸï¼ˆRegion-of-Interest-ROI-å¾—å‡ºï¼ˆäº†è§£SSï¼Œé€‰æ‹©æ€§æœç´¢ï¼‰"><a href="#1-å€™é€‰åŒºåŸŸï¼ˆRegion-of-Interest-ROI-å¾—å‡ºï¼ˆäº†è§£SSï¼Œé€‰æ‹©æ€§æœç´¢ï¼‰" class="headerlink" title="1. å€™é€‰åŒºåŸŸï¼ˆRegion of Interest (ROI))å¾—å‡ºï¼ˆäº†è§£SSï¼Œé€‰æ‹©æ€§æœç´¢ï¼‰"></a>1. å€™é€‰åŒºåŸŸï¼ˆRegion of Interest (ROI))å¾—å‡ºï¼ˆäº†è§£SSï¼Œé€‰æ‹©æ€§æœç´¢ï¼‰</h4><p>å®é™…ä¸Šè¿™ä¸€éƒ¨åˆ†ä»…ä»…äº†è§£å°±è¡Œäº†ï¼Œæ²¡æœ‰å¿…è¦å»æ·±ç©¶è¿™ä¸ªä¸œè¥¿ï¼Œè¿™ä¸ªå…¶å®åé¢çš„YOLOã€Faster R-CNNéƒ½ä¸ä¼šé€‰æ‹©å»ä½¿ç”¨è¿™äº›ä¸œè¥¿äº†ã€‚</p><ul><li><p><strong>é€‰æ‹©æ€§æœç´¢ï¼ˆSelectiveSerch, SS)</strong>: é¦–å…ˆå°†æ¯ä¸ªåƒç´ ä½œä¸ºä¸€ç»„ï¼Œç„¶åï¼Œè®¡ç®—æ¯ä¸€ç»„çš„çº¹ç†ï¼Œå¹¶å°†ä¸¤ä¸ªæœ€æ¥è¿‘çš„ç»„ç»“åˆèµ·æ¥ã€‚ä½†æ˜¯ä¸ºäº†é¿å…å•ä¸ªåŒºåŸŸåå™¬å…¶ä»–åŒºåŸŸï¼Œæˆ‘ä»¬é¦–å…ˆå¯¹è¾ƒå°çš„ç»„è¿›è¡Œåˆ†ç»„ã€‚æˆ‘ä»¬ç»§ç»­åˆå¹¶åŒºåŸŸï¼Œç›´åˆ°æ‰€æœ‰åŒºåŸŸéƒ½ç»“åˆåœ¨ä¸€èµ·ã€‚ä¸‹å›¾ç¬¬ä¸€è¡Œå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ä½¿åŒºåŸŸå¢é•¿ï¼Œç¬¬äºŒè¡Œä¸­çš„è“è‰²çŸ©å½¢ä»£è¡¨åˆå¹¶è¿‡ç¨‹ä¸­æ‰€æœ‰å¯èƒ½çš„ROIã€‚</p></li><li><p><a href="https://imgtu.com/i/hPhr59" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/23/hPhr59.png" alt="SelectiveSerch"></a></p></li><li><p>SSåœ¨ä¸€å¼ å›¾ç‰‡ä¸Šæå–å‡ºæ¥çº¦2000ä¸ªå€™é€‰åŒºåŸŸï¼Œ<strong>éœ€è¦æ³¨æ„çš„æ˜¯è¿™äº›å€™é€‰åŒºåŸŸçš„é•¿å®½éƒ½ä¸å›ºå®š</strong>ã€‚äºŒæˆ‘ä»¬ä½¿ç”¨CNNæå–å€™é€‰åŒºåŸŸçš„ç‰¹å¾å‘é‡ï¼Œéœ€è¦æ¥å—å›ºå®šé•¿åº¦çš„è¾“å…¥ï¼Œæ‰€ä»¥éœ€è¦å¯¹å€™é€‰åŒºåŸŸåšä¸€äº›å°ºå¯¸ä¸Šçš„ä¿®æ”¹ã€‚éœ€è¦æˆ‘ä»¬ä¸€äº›ç®—æ³•è¿›è¡Œä¿®æ”¹è°ƒæ•´ã€‚</p></li><li><p>å°±æ˜¯ä¸€ä¸ªåˆ©ç”¨åƒç´ ç‰¹å¾çš„è¿‡ç¨‹ï¼Œè¿˜æ˜¯ç®€å•äº†è§£ä¸€ä¸‹å°±OKã€‚</p></li></ul><h4 id="2-CNNç½‘ç»œæå–ç‰¹å¾"><a href="#2-CNNç½‘ç»œæå–ç‰¹å¾" class="headerlink" title="2. CNNç½‘ç»œæå–ç‰¹å¾"></a>2. CNNç½‘ç»œæå–ç‰¹å¾</h4><p>åœ¨å€™é€‰åŒºåŸŸçš„åŸºç¡€ä¸Šæå–å‡ºæ›´é«˜çº§çš„ã€æ›´æŠ½è±¡çš„ç‰¹å¾ï¼Œè¿™äº›é«˜çº§ç‰¹å¾æ˜¯ä½œä¸ºä¸‹ä¸€æ­¥çš„åˆ†ç±»å™¨ã€å›å½’çš„ä¾æ®</p><p><a href="https://imgtu.com/i/hP5iYd" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/23/hP5iYd.png" alt="CNNæå–ç‰¹å¾"></a></p><blockquote><p> è¿™äº›ç‰¹å¾æ³¨æ„æ˜¯<strong>ä¿å­˜åˆ°ç£ç›˜</strong>ä¸­ï¼è¿™ä¸æ˜¯ä¿å­˜åˆ°å†…å­˜ä¸­çš„ä¸´æ—¶æ•°æ®ï¼è¿™äº›ç‰¹å¾æ˜¯æˆ‘ä»¬çœŸæ­£è¦è®­ç»ƒçš„æ•°æ®è¯·æ³¨æ„ï¼</p></blockquote><h4 id="3-ç‰¹å¾å‘é‡è®­ç»ƒåˆ†ç±»å™¨SVM"><a href="#3-ç‰¹å¾å‘é‡è®­ç»ƒåˆ†ç±»å™¨SVM" class="headerlink" title="3. ç‰¹å¾å‘é‡è®­ç»ƒåˆ†ç±»å™¨SVM"></a>3. ç‰¹å¾å‘é‡è®­ç»ƒåˆ†ç±»å™¨SVM</h4><blockquote><p><em>å‡è®¾åš20ä¸ªç±»åˆ«çš„ç‰©ä½“æ£€æµ‹</em></p></blockquote><ul><li>å‡è®¾ä¸€ä¸ªå›¾ç‰‡å¾—åˆ°äº†2000ä¸ªå€™é€‰åŒºåŸŸï¼Œé‚£ä¹ˆæˆ‘ä»¬æå–å‡ºæ¥çš„å°±æ˜¯2000Ã—4096è¿™æ ·çš„ç‰¹å¾å‘é‡ï¼ˆR-CNNä¸­é»˜è®¤CNNå±‚è¾“å‡º4096ç‰¹å¾å‘é‡ï¼‰ã€‚</li><li>R-CNNé€‰ç”¨SVMè¿›è¡ŒäºŒåˆ†ç±»ï¼Œå‡è®¾æ£€æµ‹20ä¸ªç±»åˆ«ï¼Œé‚£ä¹ˆä¼šæä¾›20ä¸ªä¸åŒç±»åˆ«çš„SVMåˆ†ç±»å™¨ï¼Œæ¯ä¸ªåˆ†ç±»å™¨éƒ½ä¼šå¯¹2000ä¸ªå€™é€‰åŒºåŸŸçš„ç‰¹å¾å‘é‡åˆ†åˆ«åˆ¤æ–­ä¸€æ¬¡ï¼Œè¿™æ ·å¾—å‡º[2000, 20]çš„å¾—åˆ†çŸ©é˜µï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º</li><li><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/23/hPT9TU.md.png" alt="hPT9TU.md.png"></li><li>çŒ«åˆ†ç±»å¯¹ï¼š2000ä¸ªå€™é€‰åŒºåŸŸåšåˆ¤æ–­ï¼Œå¾—åˆ°2000ä¸ªå±äºçŒ«çš„ç±»åˆ«</li><li>ç‹—åˆ†ç±»å¯¹ï¼š2000ä¸ªå€™é€‰åŒºåŸŸåšåˆ¤æ–­ï¼Œå¾—åˆ°2000ä¸ªå±äºç‹—çš„ç±»åˆ«</li><li>â€¦â€¦</li><li>â€¦â€¦</li><li>æœ€ç»ˆå¾—åˆ°[2000, 20]å‘é‡ã€‚</li></ul><h4 id="4-éæå¤§æŠ‘åˆ¶-NMS"><a href="#4-éæå¤§æŠ‘åˆ¶-NMS" class="headerlink" title="4. éæå¤§æŠ‘åˆ¶(NMS)"></a>4. éæå¤§æŠ‘åˆ¶(NMS)</h4><h5 id="ç›®çš„"><a href="#ç›®çš„" class="headerlink" title="ç›®çš„"></a>ç›®çš„</h5><ul><li><strong>ç­›é€‰å€™é€‰åŒºåŸŸï¼Œç›®æ ‡æ˜¯ä¸€ä¸ªç‰©ä½“åªä¿ç•™ä¸€ä¸ªæœ€ä¼˜çš„æ¡†ï¼Œæ¥æŠ‘åˆ¶é‚£äº›å†—ä½™çš„å€™é€‰æ¡†</strong></li><li>RCNNé¢„æµ‹2000ä¸ªå€™é€‰æ¡†ï¼Œå¾—åˆ°æ‰€å«ç‰©ä½“æ•°çš„è¾ƒä¸ºå‡†ç¡®çš„å€™é€‰æ¡†ï¼ˆ<del>è¿™å¥è¯æœ‰ç‚¹éš¾ä»¥ç†è§£ï¼Œæˆ‘çš„è¡¨è¾¾èƒ½åŠ›æœ‰é—®é¢˜</del>ï¼‰</li></ul><h5 id="è¿­ä»£è¿‡ç¨‹"><a href="#è¿­ä»£è¿‡ç¨‹" class="headerlink" title="è¿­ä»£è¿‡ç¨‹"></a>è¿­ä»£è¿‡ç¨‹</h5><ul><li><p>å¯¹äºæ‰€æœ‰2000ä¸ªå€™é€‰åŒºåŸŸå¾—åˆ†è¿›è¡Œæ¦‚ç‡ç­›é€‰ï¼Œ0.5ï¼Œå°äº0.5éƒ½åˆ äº†ã€‚</p></li><li><p>å‰©ä½™çš„å€™é€‰æ¡†</p><ul><li><p>å‡è®¾å›¾ç‰‡çœŸå®ç‰©ä½“ä¸ªæ•°ä¸º2ï¼ˆNï¼‰ï¼Œç­›é€‰ä¹‹åå€™é€‰æ¡†ä¸º5ï¼ˆPï¼‰ï¼Œ<del>ç­›é€‰å‰å¯æ˜¯æœ‰2000ä¸ª</del>ï¼Œè®¡ç®—Nä¸­æ¯ä¸ªç‰©ä½“ä½ç½®ä¸æ‰€æœ‰Pçš„äº¤å¹¶æ¯”IOUè®¡ç®—ï¼Œå¾—åˆ°Pä¸­æ¬§ç»™æ¯ä¸ªå€™é€‰æ¡†å¯¹åº”IOUæœ€é«˜çš„Nä¸­ä¸€ä¸ª</p></li><li><p>å¦‚ä¸‹å›¾ï¼ŒAã€Cå€™é€‰æ¡†å¯¹åº”å·¦è¾¹è½¦è¾†ï¼ŒBã€Dã€Eå¯¹åº”å³è¾¹è½¦è¾†<a href="https://imgtu.com/i/hPjfSO" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/23/hPjfSO.png" alt="å¯¹åº”æ¡†"></a></p><p>å‡è®¾ç°åœ¨æ»‘åŠ¨çª—å£æœ‰ï¼šAã€Bã€Cã€Dã€E5ä¸ªå€™é€‰æ¡†ï¼ŒIOUæœ‰ç‚¹åƒæ˜¯è®¡ç®—é‡å ç¨‹åº¦çš„ã€‚</p><ul><li>ç¬¬ä¸€è½®ï¼šå¯¹äºå³è¾¹è½¦è¾†ï¼Œå‡è®¾Bæ˜¯å¾—åˆ†æœ€é«˜çš„ï¼Œä¸Bçš„IOU&gt;0.5åˆ é™¤ã€‚ç°åœ¨ä¸Bè®¡ç®—IOUï¼ŒDEç»“æœ&gt;0.5ï¼Œå‰”é™¤DEï¼ŒBä½œä¸ºä¸€ä¸ªé¢„æµ‹ç»“æœ</li><li>ç¬¬äºŒè½®ï¼šå¯¹äºå·¦è¾¹è½¦è¾†ï¼ŒACä¸­ï¼ŒAçš„å¾—åˆ†æœ€é«˜ï¼Œä¸Aè®¡ç®—IOUï¼ŒCçš„ç»“æœ&gt;0.5ï¼Œå‰”é™¤Cï¼ŒAä½œä¸ºä¸€ä¸ªç»“æœ</li></ul><p><strong>æœ€ç»ˆè¿™äº”ä¸ªä¸­æ£€æµ‹å‡ºç»“æœä¸ºAå’ŒB</strong>ï¼Œæœ€ç»ˆç†æƒ³çŠ¶æ€å°±æ˜¯æ¯ä¸€ä¸ªGround truthéƒ½æœ‰ä¸€ä¸ªå€™é€‰æ¡†ã€‚</p><p><strong>SSç®—æ³•å¾—åˆ°çš„ç‰©ä½“ä½ç½®å·²ç»å›ºå®šäº†ï¼Œä½†æ˜¯æˆ‘ä»¬ç­›é€‰å‡ºçš„ä½ç½®ä¸ä¸€å®šå°±çœŸçš„ç‰¹åˆ«å‡†ç¡®</strong>ï¼Œéœ€è¦å¯¹Aå’ŒBè¿›è¡Œæœ€åçš„ä¿®æ­£ã€‚</p></li></ul></li></ul><h4 id="5-ä¿®æ­£å€™é€‰æ¡†"><a href="#5-ä¿®æ­£å€™é€‰æ¡†" class="headerlink" title="5. ä¿®æ­£å€™é€‰æ¡†"></a>5. ä¿®æ­£å€™é€‰æ¡†</h4><ul><li><p>é€šè¿‡éæœ€å¤§æŠ‘åˆ¶ç­›é€‰å‡ºæ¥çš„å€™é€‰æ¡†ä¸ä¸€å®šéå¸¸å‡†ç¡®æ€ä¹ˆåŠï¼ŸR-CNNæä¾›äº†è¿™æ ·ä¸€ç§æ–¹æ³•ï¼Œå»ºç«‹ä¸€ä¸ªbbox regrassor</p><ul><li><p>å›å½’ç”¨äºä¿®æ­£ç­›é€‰åçš„å€™é€‰åŒºåŸŸï¼Œä½¿ä¹‹å›å½’äºground-truth,é»˜è®¤è®¤ä¸ºè¿™ä¸¤ä¸ªæ¡†ä¹‹é—´æ˜¯çº¿æ€§å…³ç³»ï¼Œå› ä¸ºåœ¨æœ€åç­›é€‰å‡ºæ¥çš„å€™é€‰åŒºåŸŸå’Œground-truthå¾ˆæ¥è¿‘äº†</p><p>ä¿®æ­£è¿‡ç¨‹ï¼ˆçº¿æ€§å›å½’ï¼‰</p><p><a href="https://imgtu.com/i/hipcR0" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/23/hipcR0.png" alt="çº¿æ€§å›å½’ç®—æ³•"></a></p><p>æˆ‘ä»¬ç»™å‡ºä¸€ä¸ªç›¸å…³çš„è§£é‡Šï¼š</p><p><a href="https://imgtu.com/i/hi9af1" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/23/hi9af1.png" alt="ä¾‹å­"></a></p><ul><li>å‡è®¾Gæ˜¯GTï¼Œè€ŒAæ˜¯predicted bbox.é‚£ä¹ˆæˆ‘ä»¬æƒ³è¦é€šè¿‡è¯¥å›å½’ç®—æ³•æ¥ä½¿å¾—Aå°½å¯èƒ½æ¥è¿‘Gï¼Œé€šè¿‡å˜æ¢æ¥ä½¿å¾—Aå˜ä¸ºGâ€™ï¼Œå°½é‡å’ŒçœŸå®å€¼Gç›¸ç­‰ã€‚</li></ul></li></ul></li><li><p>RCNNè¾“å‡ºï¼šä¸€å¼ å›¾ç‰‡é¢„æµ‹ä¸€ä¸ªXå€™é€‰æ¡†ï¼Œ x*w = y_locateï¼ˆç»è¿‡å›å½’ä¿®æ­£çš„ï¼‰</p></li></ul><p><strong>ä»¥ä¸Šä¾¿æ˜¯æˆ‘ä»¬RCNNçš„äº”æ­¥è¿‡ç¨‹ã€‚</strong></p><h4 id="æ£€æµ‹çš„è¯„ä»·æŒ‡æ ‡"><a href="#æ£€æµ‹çš„è¯„ä»·æŒ‡æ ‡" class="headerlink" title="æ£€æµ‹çš„è¯„ä»·æŒ‡æ ‡"></a>æ£€æµ‹çš„è¯„ä»·æŒ‡æ ‡</h4><h5 id="IOUäº¤å¹¶æ¯”"><a href="#IOUäº¤å¹¶æ¯”" class="headerlink" title="IOUäº¤å¹¶æ¯”"></a>IOUäº¤å¹¶æ¯”</h5><p><em>IOUäº¤å¹¶æ¯”æ˜¯æœ€ç®€å•çš„ä¸€ç§</em></p><table><thead><tr><th>ä»»åŠ¡</th><th>description</th><th>è¾“å…¥</th><th>è¾“å‡º</th><th>è¯„ä»·æ ‡å‡†</th></tr></thead><tbody><tr><td>Detection and Localization(æ£€æµ‹å’Œå®šä½)</td><td>åœ¨è¾“å…¥å›¾ç‰‡ä¸­æ‰¾å‡ºå­˜åœ¨ç‰©ä½“ç±»åˆ«å’Œä½ç½®ï¼ˆå¯èƒ½å­˜åœ¨å¤šç§ç‰©ä½“ï¼‰</td><td>å›¾ç‰‡ï¼ˆImage)</td><td>ç±»åˆ«æ ‡ç­¾ï¼ˆcategoriesï¼‰å’Œä½ç½®ï¼ˆbbox(x,y,w,h))</td><td>IOUï¼ˆIntersection over Union</td></tr></tbody></table><ul><li>IOU(äº¤å¹¶æ¯”)<ul><li>ä¸¤ä¸ªåŒºåŸŸçš„é‡å ç¨‹åº¦overlap:å€™é€‰åŒºåŸŸå’Œæ ‡å®šåŒºåŸŸçš„IOUå€¼</li><li><a href="https://imgtu.com/i/hFEfk8" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/24/hFEfk8.png" alt="IOUè®¡ç®—å…¬å¼"></a></li><li>æ‰€ä»¥æˆ‘ä»¬çš„IOUå€¼è¶Šå¤§ï¼Œé‡åˆç¨‹åº¦è¶Šå¤§ã€‚IOUå€¼åœ¨[0, 1]ä¹‹é—´</li><li>é€šå¸¸æ¥è¯´IOU&gt;0.5ï¼Œè¯´æ˜é‡åˆç¨‹åº¦ç®—æ¯”è¾ƒé«˜äº†ï¼Œç±»åˆ«ä¸€æ ·ã€‚</li><li><strong>å±äºä½ç½®çš„è€ƒé‡</strong></li></ul></li></ul><h5 id="å¹³å‡ç²¾ç¡®ç‡ï¼ˆmapï¼Œmean-average-precision"><a href="#å¹³å‡ç²¾ç¡®ç‡ï¼ˆmapï¼Œmean-average-precision" class="headerlink" title="å¹³å‡ç²¾ç¡®ç‡ï¼ˆmapï¼Œmean average precision)"></a>å¹³å‡ç²¾ç¡®ç‡ï¼ˆmapï¼Œmean average precision)</h5><p>è®­ç»ƒæ ·æœ¬çš„æ ‡è®°ï¼šå€™é€‰æ¡†ï¼ˆå¦‚RCNN2000ä¸ªï¼‰æ ‡è®°</p><ul><li>ä¸æ¯ä¸ªground truth boxæœ‰ç€æœ€é«˜çš„IOUçš„anchoræ ‡è®°ä¸ºæ­£æ ·æœ¬</li><li>å‰©ä¸‹çš„anchor/anchorsä¸ä»»ä½•ground truth boxçš„IOUå¤§äº0.7è®°ä¸ºæ­£æ ·æœ¬ï¼ŒIOUå°äº0.3ï¼Œ è®°ä¸ºè´Ÿæ ·æœ¬</li></ul><ul><li>å®šä¹‰ï¼šå¤šä¸ªåˆ†ç±»ä»»åŠ¡çš„APçš„å¹³å‡å€¼ã€‚<ul><li>mAP = æ‰€æœ‰ç±»åˆ«çš„APä¹‹å’Œ/ç±»åˆ«æ€»ä¸ªæ•°</li><li>æ³¨ï¼š<code>PRæ›²çº¿</code>ï¼Œè€ŒAPï¼ˆaverage precision)å°±æ˜¯è¿™ä¸ªæ›²çº¿ä¸‹çš„é¢ç§¯ï¼ˆROCä¸AUCï¼‰</li></ul></li></ul><blockquote><p><strong>å…³äºROCæ›²çº¿ã€AOCå€¼ã€æ­£ç¡®ç‡ã€å¬å›ç‡ã€PRæ›²çº¿ï¼Œè¿™é‡Œæœ‰ç€å‡ ä¸ªåšå®¢è®²çš„è¿˜å¯ä»¥:</strong></p><ol><li><p><strong><a href="https://zhuanlan.zhihu.com/p/58587448" target="_blank" rel="noopener">ROCæ›²çº¿å’ŒAUCå€¼</a>,</strong></p></li><li><p><strong><a href="https://zhuanlan.zhihu.com/p/31256633" target="_blank" rel="noopener">ROCæ›²çº¿ã€AUCå€¼ã€æ­£ç¡®ç‡ã€å¬å›ç‡</a></strong></p></li><li><p><strong><a href="https://zhuanlan.zhihu.com/p/104917232" target="_blank" rel="noopener">ROCæ›²çº¿å’ŒPRæ›²çº¿</a></strong></p></li></ol></blockquote><ul><li><p>æ–¹æ³•æ­¥éª¤</p><ul><li><ol><li>å¯¹äºå…¶ä¸­ä¸€ä¸ªç±»åˆ«Cï¼Œé¦–å…ˆå°†ç®—æ³•è¾“å‡ºæ‰€æœ‰Cç±»åˆ«çš„é¢„æµ‹æ¡†ï¼ŒæŒ‰é¢„æµ‹çš„åˆ†æ•°confidenceæ’åº<ul><li>RCNNä¸­å°±æ˜¯SVMçš„è¾“å‡ºåˆ†æ•°</li></ul></li></ol></li><li><ol start="2"><li>è®¾å®šä¸åŒçš„Kå€¼ï¼Œé€‰æ‹©top kä¸ªé¢„æµ‹æ¡†ï¼Œè®¡ç®—FPå’ŒTPï¼Œè®¡ç®—Precisionå’ŒAP</li></ol></li><li><ol start="3"><li>å°†å¾—åˆ°çš„Nä¸ªç±»åˆ«çš„APå–å¹³å‡ï¼Œå³å¾—åˆ°APï¼›APæ˜¯é’ˆå¯¹å•ä¸€ç±»åˆ«çš„ï¼ŒmAPæ—¶å°†æ‰€æœ‰ç±»åˆ«çš„APæ±‚å’Œå†å–å¹³å‡</li></ol></li></ul></li></ul><ul><li>é¦–å…ˆå›é¡¾ç²¾ç¡®ç‡å’Œå¬å›ç‡<ul><li>å·¦è¾¹ä¸€æ•´ä¸ªçŸ©å½¢ä¸­çš„æ•°è¡¨ç¤ºground truthä¹‹ä¸­ä¸º1çš„ï¼ˆå³ä¸ºæ­£ç¡®çš„ï¼‰æ•°æ®</li><li>å³è¾¹ä¸€æ•´ä¸ªçŸ©å½¢ä¸­çš„æ•°è¡¨ç¤ºground truthä¹‹ä¸­ä¸º0çš„æ•°æ®</li><li>ç²¾åº¦precisionçš„è®¡ç®—ä½¿ç”¨æ£€æµ‹æ­£ç¡®çš„æ•°æ®ä¸ªæ•°/æ€»çš„æ£€æµ‹ä¸ªæ•°</li><li>å¬å›ç‡recallçš„è®¡ç®—æ˜¯ç”¨æ£€æµ‹æ­£ç¡®çš„æ•°æ®ä¸ªæ•°/ground truthä¸­æ‰€æœ‰æ­£æ•°æ®ä¸ªæ•°ã€‚</li></ul></li></ul><p><a href="https://imgtu.com/i/h3fxcn" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/28/h3fxcn.png" alt="å›¾åƒè¾…åŠ©ç†è§£å„ä¸ªâ€œç‡â€"></a></p><p><strong>æˆ‘ä»¬æ‰€è¯´çš„å¬å›ç‡å°±æ˜¯ç»¿è‰²çš„åŠåœ†é™¤ä»¥å·¦åŠè¾¹ï¼Œå¬å›ç‡æ˜¯ä¸ºäº†è§£å†³æ ·æœ¬ä¸å‡è¡¡çš„é—®é¢˜ã€‚</strong></p><p>è¿™é‡Œæœ‰æ›´ä¸ºè¯¦ç»†çš„å¦‚ä½•è®¡ç®—ï¼š</p><p><a href="https://imgtu.com/i/h3huB6" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/28/h3huB6.md.png" alt="ç²¾ç¡®ç‡ä¸å¬å›ç‡è®¡ç®—"></a></p><h4 id="RCNNç®—æ³•æ€»ç»“"><a href="#RCNNç®—æ³•æ€»ç»“" class="headerlink" title="RCNNç®—æ³•æ€»ç»“"></a>RCNNç®—æ³•æ€»ç»“</h4><p>æµç¨‹æ€»ç»“</p><ol><li>é¦–å…ˆæˆ‘ä»¬è¾“å…¥ä¸€å¼ å›¾ç‰‡</li></ol><p><a href="https://imgtu.com/i/h3hLb6" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/28/h3hLb6.md.png" alt="input"></a></p><ol start="2"><li>æ¥ç€æˆ‘ä»¬å¾—åˆ°2000ä¸ªå€™é€‰åŒºåŸŸï¼Œå¾—åˆ°ROI</li></ol><p><a href="https://imgtu.com/i/h349xA" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/28/h349xA.md.png" alt="ROI"></a></p><ol start="3"><li>å¯¹å€™é€‰åŒºåŸŸè¿›è¡Œå¤§å°é€‚å½“çš„å˜æ¢</li></ol><p><a href="https://imgtu.com/i/h358OI" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/28/h358OI.md.png" alt="å¤§å°å˜æ¢"></a></p><ol start="4"><li>è€Œåç»è¿‡å·ç§¯æå–ç‰¹å¾å¾—åˆ°ç‰¹å¾å‘é‡</li></ol><p><a href="https://imgtu.com/i/h35rXn" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/28/h35rXn.md.png" alt="ç»è¿‡å·ç§¯å±‚"></a></p><ol start="5"><li>ç»è¿‡SVMåˆ†ç±»å¾—åˆ°ç±»åˆ«å’Œregå¾—åˆ°bbox</li></ol><p><a href="https://imgtu.com/i/h35Tn1" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/28/h35Tn1.md.png" alt="ç»è¿‡SVMåˆ†ç±»å¾—åˆ°ç±»åˆ«å’Œregå¾—åˆ°bbox"></a></p><h4 id="RCNNè¡¨ç°ä¸ç¼ºç‚¹"><a href="#RCNNè¡¨ç°ä¸ç¼ºç‚¹" class="headerlink" title="RCNNè¡¨ç°ä¸ç¼ºç‚¹"></a>RCNNè¡¨ç°ä¸ç¼ºç‚¹</h4><ul><li>è¡¨ç°<ul><li>åœ¨VOC2007æ•°æ®é›†ä¸Šçš„å¹³å‡ç²¾åº¦mapè¾¾åˆ°66%</li></ul></li></ul><ul><li>ç¼ºç‚¹<ul><li>è®­ç»ƒé˜¶æ®µå¤šï¼Œ æ­¥éª¤ç¹çï¼šå¾®è°ƒç½‘ç»œ+è®­ç»ƒSVM+è®­ç»ƒè¾¹æ¡†å›å½’å™¨ï¼ˆè¦è®­ç»ƒå¥½å¤šä¸œè¥¿ï¼Œæ¨¡å‹å¤ªå¤šï¼‰ã€‚</li><li>è®­ç»ƒè€—æ—¶ï¼Œå ç”¨ç£ç›˜ç©ºé—´å¤§ï¼š5000å¼ å›¾ç‰‡äº§ç”Ÿå‡ ç™¾Gçš„ç‰¹å¾æ–‡ä»¶ã€‚ï¼ˆVOCæ•°æ®é›†çš„æ£€æµ‹ç»“æœï¼Œå› ä¸ºSVMçš„å­˜åœ¨ï¼‰</li><li>å¤„ç†é€Ÿåº¦æ…¢ï¼šä½¿ç”¨GPUï¼ŒVGG16æ¨¡å‹å¤„ç†ä¸€å¼ å›¾åƒéœ€è¦47s</li><li>å›¾ç‰‡å½¢çŠ¶å˜åŒ–ï¼šå€™é€‰åŒºåŸŸè¦ç»è¿‡crop/warpè¿›è¡Œå›ºå®šå¤§å°ï¼Œæ— æ³•ä¿è¯å›¾ç‰‡ä¸å˜æ€§</li></ul></li></ul><h3 id="ResNet"><a href="#ResNet" class="headerlink" title="ResNet"></a>ResNet</h3><h4 id="Preface-1"><a href="#Preface-1" class="headerlink" title="Preface"></a>Preface</h4><ul><li><p>å‡è®¾æˆ‘ä»¬éœ€è¦åœ¨å·ç§¯ç¥ç»ç½‘ç»œä¸­äº†è§£ä¸€ä¸ªç¥ç»ç½‘ç»œçš„è¯ï¼Œ<strong>æˆ‘ä»¬åªéœ€è¦äº†è§£ResNetå°±è¡Œäº†</strong>ï¼Œè¿™ä¸ªç¥ç»ç½‘ç»œæ˜¯æœ€å¥½ç”¨çš„ä¸€ä¸ªç½‘ç»œäº†ã€‚</p></li><li><p>è¿™ä¸ªæºè‡ªä¸€ä¸ªæ€æƒ³å°±æ˜¯ï¼Œæˆ‘ä»¬æ€»æ˜¯ä¸æ–­åŠ æ·±æˆ‘ä»¬çš„ç¥ç»ç½‘ç»œï¼Œä½†æ˜¯åŠ æ·±ç¥ç»ç½‘ç»œä¸€å®šä¼šç»™æˆ‘ä»¬å¸¦æ¥å¥½å¤„å—ï¼Ÿ</p><ul><li>ä¸ä¸€å®šçš„ã€‚å¯èƒ½æˆ‘æ¨¡å‹è¶Šå¤§ï¼Œå°±ä¼šå­¦å¾—æ›´åäº†â€¦â€¦</li><li>è€Œæˆ‘ä»¬ResNetæ ¸å¿ƒæ€æƒ³å°±æ˜¯æˆ‘ä»¬æ¯æ¬¡åŠ å¤§æ¨¡å‹ï¼Œéƒ½åŒ…å«ä¸Šä¹‹å‰çš„é‚£ä¸ªå°æ¨¡å‹ï¼Œ<strong>è‡³å°‘è¦ä¿è¯æˆ‘åŠ æ·±ç½‘ç»œä¹‹åï¼Œæ¨¡å‹æ²¡æœ‰æ¯”ä¹‹å‰å·®</strong>ï¼Œ è¿™æ ·çš„è¯è‡³å°‘å¯ä»¥ä¿è¯ä¸€ä¸ªä¸‹é™ï¼Œä¿è¯æˆ‘æ²¡æœ‰å­¦åã€‚</li></ul></li></ul><h4 id="æ®‹å·®å—"><a href="#æ®‹å·®å—" class="headerlink" title="æ®‹å·®å—"></a>æ®‹å·®å—</h4><h5 id="å…·ä½“æ€æƒ³"><a href="#å…·ä½“æ€æƒ³" class="headerlink" title="å…·ä½“æ€æƒ³"></a>å…·ä½“æ€æƒ³</h5><ul><li><em>ä¹‹å‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹ æƒ¯äºä¸€å±‚ä¸€å±‚çš„ä¸æ–­å‰å‘ä¼ é€’å‚æ•°ï¼Œä¸Šä¸€å±‚çš„è¾“å‡ºå°±æ˜¯ä¸‹ä¸€å±‚çš„è¾“å…¥ï¼Œè¿™ä¹ˆä¸€ä¸ªå›ºå®šçš„æ¨¡å¼</em></li></ul><p>è€ŒResNetå´æ”¹å˜äº†è¿™æ ·çš„ä¸€ä¸ªå›ºæœ‰æ¨¡å¼ï¼Œæ¥ä¿è¯æˆ‘ä»¬è‡³å°‘ä¸ä¼šå¾—åˆ°æ›´å·®çš„ç»“æœï¼š</p><ul><li><p>ä¸²è”ä¸€ä¸ªå±‚æ”¹å˜å‡½æ•°ç±»ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½æ‰©å¤§å‡½æ•°ç±»</p></li><li><p>æ®‹å·®å¿«åŠ å…¥å¿«é€Ÿé€šé“æ¥å¾—åˆ°$f(x) = x + g(x)$â€‹çš„ç»“æ„ã€‚è¿™æ ·æ¥è¯´å°±å‡è®¾æˆ‘$g(x)$ä»€ä¹ˆéƒ½ä¸å¹²æˆ‘ä»¬è‡³å°‘ä¼šå¾—åˆ°åŸæ¥çš„ç»“æœã€‚</p></li><li><p>å¯ä»¥çœ‹ä¸‹å›¾ï¼Œç›¸å½“äºåŠ äº†ä¸ªå¿«é€Ÿé€šé“ï¼ŒåŠ äº†ä¸ªâ€œæ·å¾„â€æ¥æ˜¯è¾“å…¥åŠ è‡³è¾“å‡ºã€‚</p></li><li><p><a href="https://imgtu.com/i/hANdN8" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/24/hANdN8.md.png" alt="ä¸ä¹‹å‰å¯¹æ¯”"></a></p></li><li><p>å½“ç„¶ResNetå½“æ—¶ä¸æ˜¯è¿™ä¹ˆè§£é‡Šçš„ï¼Œä»–å½“æ—¶æ˜¯å€ŸåŠ©äº†æ®‹å·®è¿™äº›æ¦‚å¿µä½†æ˜¯æˆ‘ä»¬ä¸éœ€è¦è¿™ä¹ˆè§£é‡Šï¼Œå°±æŒ‰ç…§ä»¥ä¸Šçš„æ–¹å¼è§£è¯»æ˜¯éå¸¸åˆé€‚çš„ã€‚</p></li></ul><h5 id="ç»†èŠ‚"><a href="#ç»†èŠ‚" class="headerlink" title="ç»†èŠ‚"></a>ç»†èŠ‚</h5><p>å½“ç„¶ï¼Œä»¥ä¸Šçš„åªæ˜¯ä¸€ä¸ªç›´è§‚ä¸Šçš„æ¥ç†è§£ï¼Œæˆ‘ä»¬çœŸæ­£çš„æ®‹å·®ResNetå—çš„ç»†èŠ‚ç»“æ„å¦‚ä¸‹ï¼š</p><p><a href="https://imgtu.com/i/hAaImR" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/24/hAaImR.png" alt="ResNetå—"></a></p><ul><li>å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªResNetå—è¿™é‡Œå€Ÿé‰´äº†VGGçš„æœ‰å…³å·ç§¯å±‚ï¼Œåˆ©ç”¨äº†3*3çš„å·ç§¯å—ï¼Œè¿™ä¹ˆä¸€æ¥æˆ‘ä»¬çš„è¾“å…¥è¾“å‡ºçš„å½¢çŠ¶ä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼Œæ­£å¥½æœ‰åˆ©äºæˆ‘ä»¬çš„åŠ ä¸Šè¾“å…¥å±‚çš„æ“ä½œã€‚</li><li>åŒæ—¶è¿™é‡Œå¦‚æœæˆ‘ä»¬æƒ³è¦å˜æ¢è¾“å…¥å±‚çš„é€šé“æ•°ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨åˆ°è¿™é‡Œæœ‰ä¸€ä¸ª1*1çš„å·ç§¯å±‚æ–¹ä¾¿æ”¹å˜é€šé“æ•°</li><li>ç»¼åˆä»¥ä¸Šä¸¤ç‚¹ï¼Œæœ‰åˆ©äºæˆ‘ä»¬è¾“å…¥å’Œè¾“å‡ºçš„ç›¸åŠ ã€‚ï¼ˆ<del>å¯ä»¥è¯´å®Œç¾è§£å†³äº†è¿™äº›é—®é¢˜</del>ï¼‰</li></ul><h5 id="æ›´å¤šå˜ç§"><a href="#æ›´å¤šå˜ç§" class="headerlink" title="æ›´å¤šå˜ç§"></a>æ›´å¤šå˜ç§</h5><p>å½“ç„¶æˆ‘ä»¬æˆ–è®¸å¯¹äºæˆ‘ä»¬åŠ å…¥xçš„ä½ç½®æœ‰æ‰€ç–‘é—®ï¼Œä¸ºä»€ä¹ˆå¿…é¡»åŠ åˆ°BNå±‚å’ŒReLUä¹‹é—´å‘¢ï¼Ÿå®é™…ä¸Šè¿™é‡Œå°±æ˜¯æˆ‘ä»¬å¦ä¸€ä¸ªæ¯”è¾ƒæœ‰è¶£çš„åœ°æ–¹ï¼Œç­”æ¡ˆæ˜¯ï¼š<strong>éšä¾¿è¯•è¯•ï¼</strong></p><p><a href="https://imgtu.com/i/hAdHDs" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/24/hAdHDs.png" alt="éƒ½å¯ä»¥å°è¯•ä¸€ä¸‹"></a></p><h4 id="ResNetå—"><a href="#ResNetå—" class="headerlink" title="ResNetå—"></a>ResNetå—</h4><p>ç”±ä¸‹å›¾æˆ‘ä»¬å¯ä»¥çœ‹å‡ºå…·ä½“çš„ResNetå—çš„ç»„æˆï¼Œå®é™…ä¸ŠResNetå—æ˜¯æœ‰2ç§çš„ï¼ˆä¸Šè¾¹ä¹Ÿæœ‰æ‰€æåˆ°ï¼‰ï¼š</p><ul><li>ç¬¬ä¸€ä¸ªResNetå—ä¾¿æ˜¯é¦–å…ˆæˆ‘ä»¬éœ€è¦å°†å…¶é«˜å®½å‡åŠï¼Œæ‰€ä»¥æˆ‘ä»¬å®šä¹‰äº†3*3convå±‚çš„æ­¥å¹…ä¸º2ï¼Œè¿™æ ·ä¸€æ¥æˆ‘ä»¬é€šè¿‡çš„æ•°æ®é«˜å®½å‡åŠäº†ï¼Œè€Œé«˜å®½å‡åŠåæˆ‘ä»¬é€šå¸¸ä¼šå°†æˆ‘ä»¬çš„é€šé“æ•°å¢åŠ ï¼ˆ<del>è¿™æ˜¯ä¹‹å‰VGGç­‰çš„ç»éªŒ</del>ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬åŠ å…¥å¿«é€Ÿé€šé“çš„åŒæ—¶æˆ‘ä»¬åŠ è¿›å»äº†ä¸€ä¸ªconv1å±‚æ¥å‡åŠé«˜å®½å¹¶ä¸”å¢åŠ é€šé“æ•°ä»¥ä¿æŒæˆ‘ä»¬å¯ä»¥é¡ºåˆ©çš„å°†ä¸¤è€…ç›¸åŠ ã€‚<em>è¿™é‡Œä»éœ€æ³¨æ„çš„ä¸€ç‚¹æ˜¯æˆ‘ä»¬çš„3*3å·ç§¯ä»…ä»…åªæœ‰ç¬¬ä¸€ä¸ªæ˜¯æ­¥å¹…ä¸º2ï¼Œä¹Ÿå°±æ˜¯åªå‡åŠä¸€æ¬¡</em></li><li>ç¬¬äºŒç§ResNetå—ä¾¿æ˜¯æ­£å¸¸çš„3*3å·ç§¯ï¼Œä¿æŒæˆ‘ä»¬çš„é«˜å®½ä¸å˜ï¼Œç”šè‡³æˆ‘ä»¬é€šé“æ•°ä¹Ÿæ²¡æœ‰æ”¹å˜ï¼Œè¿™æ ·ä¸€æ¥æˆ‘ä»¬å°±å¯ä»¥ä¸ä½¿ç”¨1*1å·ç§¯æ¥æ”¹å˜è¾“å…¥çš„é€šé“æ•°ï¼Œç›´æ¥ç›¸åŠ å°±OKã€‚è€Œç¬¬äºŒä¸ªResNetå—æˆ‘ä»¬ä¼šé‡å¤å¤šæ¬¡ï¼Œæ¥å¤šä¸ªè¿™æ ·çš„å—ã€‚</li></ul><p><a href="https://imgtu.com/i/hADyJP" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/24/hADyJP.png" alt="ResNetå—"></a></p><h4 id="ResNetæ¶æ„"><a href="#ResNetæ¶æ„" class="headerlink" title="ResNetæ¶æ„"></a>ResNetæ¶æ„</h4><ul><li>ç±»ä¼¼VGGå’ŒGoogleNetçš„æ€»ä½“æ¶æ„ï¼Œä¹Ÿæ˜¯5ä¸ªstage</li><li>ä¸è¿‡è¿™é‡Œæ›¿æ¢æˆäº†ResNetå—</li></ul><p><a href="https://imgtu.com/i/hAgPqU" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/24/hAgPqU.png" alt="ResNetæ¶æ„"></a></p><h3 id="æ”¹è¿›-ç›®æ ‡æ£€æµ‹SPPNET"><a href="#æ”¹è¿›-ç›®æ ‡æ£€æµ‹SPPNET" class="headerlink" title="æ”¹è¿›-ç›®æ ‡æ£€æµ‹SPPNET"></a>æ”¹è¿›-ç›®æ ‡æ£€æµ‹SPPNET</h3><p>è¿™ä¸ªç›¸å½“äºæ˜¯ä¸­é—´çš„ä¸€ä¸ªç®—æ³•äº†ã€‚</p><h4 id="Preface-2"><a href="#Preface-2" class="headerlink" title="Preface"></a>Preface</h4><ul><li>å­¦ä¹ ç›®æ ‡<ul><li>è¯´æ˜SPPNETçš„ç‰¹ç‚¹</li><li>è¯´æ˜SPPå±‚çš„ä½œç”¨</li></ul></li><li>åº”ç”¨<ul><li>æš‚æ— </li></ul></li></ul><h4 id="RCNNæ…¢åœ¨å“ªé‡Œï¼Ÿ"><a href="#RCNNæ…¢åœ¨å“ªé‡Œï¼Ÿ" class="headerlink" title="RCNNæ…¢åœ¨å“ªé‡Œï¼Ÿ"></a>RCNNæ…¢åœ¨å“ªé‡Œï¼Ÿ</h4><p><a href="https://imgtu.com/i/hGFNo6" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/29/hGFNo6.png" alt="RCNNå…¨è¿‡ç¨‹"></a></p><p><strong>æ¯ä¸ªå€™é€‰åŒºåŸŸéƒ½è¿›è¡Œäº†å·ç§¯æ“ä½œæå–ç‰¹å¾</strong>!</p><p>æ…¢å°±æ…¢åœ¨è¿™é‡Œçš„ConvNetè¿™ä¸ªåœ°æ–¹ï¼æ¯ä¸ªå›¾ç‰‡éƒ½æœ‰2000ä¸ªå€™é€‰æ¡†æ¥åšå·ç§¯!</p><h4 id="é‚£æˆ‘ä»¬è¿›è¡Œäº†æ€æ ·çš„æ”¹è¿›å‘¢ï¼Ÿ"><a href="#é‚£æˆ‘ä»¬è¿›è¡Œäº†æ€æ ·çš„æ”¹è¿›å‘¢ï¼Ÿ" class="headerlink" title="é‚£æˆ‘ä»¬è¿›è¡Œäº†æ€æ ·çš„æ”¹è¿›å‘¢ï¼Ÿ"></a>é‚£æˆ‘ä»¬è¿›è¡Œäº†æ€æ ·çš„æ”¹è¿›å‘¢ï¼Ÿ</h4><p>SPPNetä¸»è¦å­˜åœ¨ä¸¤ç‚¹æ”¹è¿›çš„åœ°æ–¹ï¼Œæå‡ºäº†SPPå±‚</p><ul><li>å‡å°‘å·ç§¯è¿ç®—<ul><li>é¦–å…ˆRCNNæ˜¯ç»è¿‡ä¸€ä¸ªcrop/warpå±‚ï¼Œè¿™æ˜¯è£å‰ªresizeå›¾ç‰‡å¾—åˆ°å€™é€‰åŒºåŸŸç”¨çš„ï¼Œè€Œåæˆ‘ä»¬ç»è¿‡å·ç§¯å±‚ï¼Œè¿™ä¸ªæ—¶å€™æ˜¯2000ä¸ªå€™é€‰åŒºåŸŸéƒ½ç»è¿‡å·ç§¯å±‚ï¼Œï¼Œç„¶åç»è¿‡å…¨è¿æ¥å±‚æœ€åå¾—åˆ°è¾“å‡º</li><li>è€Œæˆ‘ä»¬çš„SPPNETæ˜¯é¦–å…ˆå°†è¿™ä¸€å¼ å›¾ç‰‡ç»è¿‡å·ç§¯å±‚ï¼Œæ³¨æ„ï¼Œä¹‹å‰RCNNå¯æ˜¯2000å¼ ç»è¿‡å·ç§¯å±‚ï¼è€Œåç»è¿‡ä¸€ä¸ªSPP Poolingå±‚ï¼Œæ¥ç€å°±æ˜¯ç»è¿‡å…¨è¿æ¥å±‚ç„¶åè¾“å‡ºã€‚<ul><li>ä¸€å¼ å›¾ç‰‡ç»è¿‡äº†å·ç§¯ï¼Œé‚£æˆ‘ä»¬æ€ä¹ˆå¾—åˆ°å€™é€‰åŒºåŸŸå‘¢?è¿™ä¾¿æ˜¯æˆ‘ä»¬SPPå±‚éœ€è¦è€ƒè™‘çš„äº†ã€‚</li><li><strong>å¯è§æˆ‘ä»¬çš„é‡ç‚¹æ”¹è¿›å‘¢ä¾¿æ˜¯è¿™ä¸ªSPPå±‚ï¼ˆspatial pyramid pooling<del>ç©ºé—´é‡‘å­—å¡”æ± åŒ–</del>ï¼‰</strong></li></ul></li></ul></li></ul><p><a href="https://imgtu.com/i/hGVoCV" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/29/hGVoCV.png" alt="RCNNå’ŒSPPå¯¹æ¯”"></a></p><table><thead><tr><th>R-CNNæ¨¡å‹</th><th>SPPNetæ¨¡å‹</th></tr></thead><tbody><tr><td>1ã€R-CNNæ˜¯è®©æ¯ä¸ªå€™é€‰åŒºåŸŸç»è¿‡crop/wrapç­‰æ“ä½œå˜æ¢æˆå›ºå®šå¤§å°çš„å›¾åƒ   2ã€å›ºå®šå¤§å°çš„å›¾åƒå¡ç»™CNNä¼ ç»™åé¢çš„å±‚åšè®­ç»ƒå›å½’åˆ†ç±»æ“ä½œã€‚</td><td>1ã€SPPNetæŠŠå…¨å›¾å¡ç»™CNNå¾—åˆ°å…¨å›¾çš„feature map 2ã€ <strong>è®©SSï¼ˆé€‰æ‹©æ€§æœç´¢ï¼‰å¾—åˆ°å€™é€‰åŒºåŸŸç›´æ¥æ˜ å°„ç‰¹å¾å‘é‡ä¸­å¯¹åº”ä½ç½®</strong> 3ã€æ˜ å°„è¿‡æ¥çš„ç‰¹å¾å‘é‡ï¼Œ<strong>ç»è¿‡SPPå±‚</strong>ï¼ˆ<strong>ç©ºé—´é‡‘å­—å¡”å˜æ¢å±‚</strong>ï¼‰ï¼ŒSè¾“å‡ºå›ºå®šå¤§å°çš„ç‰¹å¾å‘é‡ç»™FCå±‚ã€‚</td></tr></tbody></table><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/29/hGZiKe.png" alt="æ›´å½¢è±¡çš„å¯¹æ¯”"></p><ul><li>è¿™ä¸ªæ˜ å°„è¿˜æ˜¯éå¸¸å…³é”®çš„ï¼ŒåŸå›¾ä¸­é€šè¿‡SSå¾—åˆ°çš„å€™é€‰åŒºåŸŸç›´æ¥<strong>æ˜ å°„</strong>åˆ°æˆ‘ä»¬çš„å·ç§¯å¾—åˆ°çš„ç›¸åº”åŒºåŸŸã€‚</li><li><strong>ç„¶åæ˜ å°„è¿‡æ¥çš„å€™é€‰åŒºåŸŸçš„ç‰¹å¾å‘é‡</strong>ï¼Œç»è¿‡SPPå±‚æ¥è¾“å‡ºå›ºå®šå¤§å°çš„ç‰¹å¾å‘é‡ç»™FCå±‚ã€‚</li></ul><h4 id="æ˜ å°„"><a href="#æ˜ å°„" class="headerlink" title="æ˜ å°„"></a>æ˜ å°„</h4><p><em>åŸå§‹å›¾ç‰‡ç»è¿‡CNNå˜æˆäº†feature map, åŸå§‹å›¾ç‰‡é€šè¿‡é€‰æ‹©æ€§æœç´¢(SSï¼‰å¾—åˆ°äº†å€™é€‰åŒºåŸŸï¼ˆRegion of Interest),ç°åœ¨éœ€è¦å°†åŸºäºåŸå§‹å›¾ç‰‡çš„å€™é€‰åŒºåŸŸæ˜ å°„åˆ°feature mapä¸­çš„ç‰¹å¾å‘é‡ã€‚æ˜ å°„è¿‡ç¨‹å›¾å‚è€ƒå¦‚ä¸‹ï¼š</em></p><ul><li>æ˜ å°„æ˜¯æœ‰ç‰¹å®šè§„åˆ™çš„</li></ul><p><a href="https://imgtu.com/i/hGeYeH" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/29/hGeYeH.png" alt="æ˜ å°„"></a></p><p>æ•´ä¸ªæ˜ å°„è¿‡ç¨‹æœ‰å…·ä½“çš„å…¬å¼ï¼Œå¦‚ä¸‹ï¼š</p><p>å‡è®¾ï¼ˆxâ€™ï¼Œyâ€™)è¡¨ç¤ºç‰¹å¾å›¾ä¸Šçš„åæ ‡ç‚¹ï¼Œåæ ‡ç‚¹(x, y)è¡¨ç¤ºåŸè¾“å…¥å›¾ç‰‡ä¸Šçš„ç‚¹ï¼Œé‚£ä¹ˆå®ƒä»¬ä¹‹é—´æœ‰å¦‚ä¸‹è½¬æ¢å…³ç³»ï¼Œè¿™ç§æ˜ å°„å…³ç³»ä¸ç½‘ç»œç»“æ„æœ‰å…³ï¼š(x, y) = (S*xâ€™, S*yâ€™), å³</p><ul><li><p>å·¦ä¸Šè§’çš„ç‚¹ï¼š</p><ul><li><strong>xâ€™ = [x / S] + 1</strong></li></ul></li><li><p>å³ä¸‹è§’çš„ç‚¹ï¼š</p><ul><li><strong>xâ€™ = [x / S] - 1</strong></li></ul></li></ul><p>å…¶ä¸­Så°±æ˜¯CNNä¸­æ‰€æœ‰çš„stridesçš„ä¹˜ç§¯ï¼ŒåŒ…å«äº†æ± åŒ–ã€å·ç§¯çš„stride.è®ºæ–‡ä¸­ä½¿ç”¨Sè®¡ç®—å‡ºæ¥çš„ä¸º2Ã—2Ã—2Ã—2=16</p><blockquote><p>å¦‚æœæƒ³å…³æ³¨è¿™ä¸ªå…¬å¼æ€ä¹ˆè®¡ç®—å‡ºæ¥çš„ï¼Œæˆ‘ä»¬å¯ä»¥å‚è€ƒï¼š</p><p><a href="http://kaiminghe.com/iccv15tutorial/iccv2015_tutorial_convolutional_feature_maps_kaiminghe.pdf" target="_blank" rel="noopener">http://kaiminghe.com/iccv15tutorial/iccv2015_tutorial_convolutional_feature_maps_kaiminghe.pdf</a></p></blockquote><p>è®ºæ–‡ä½¿ç”¨çš„AlexNetå¥½åƒï¼ˆæ­¤æ—¶2015è¿˜æ²¡æå‡ºæ¥é‚£ä¸ªResNet)</p><ul><li>åŸå›¾ï¼šç‰¹å¾å›¾ä¸­xminâ€™, yminâ€™ = [xmin/16]+1, [ymin/16]+1</li><li>ç‰¹å¾å›¾ï¼šxmaxâ€™,ymaxâ€™ = [xmax/16] - 1,ymax/16 -1</li></ul><p><em>é‚£ä¹ˆè¿™ä¹ˆä¸€æ¥æˆ‘ä»¬å¾—åˆ°ç‰¹å¾å›¾å€™é€‰åŒºåŸŸäº†ã€‚ä½†æ˜¯æˆ‘ä»¬å¾—åˆ°çš„ç‰¹å¾å›¾ä»ç„¶å¤§å°ä¸ä¸€ï¼Œéœ€è¦æˆ‘ä»¬è¿›ä¸€æ­¥çš„å°†ç‰¹å¾å›¾è½¬æ¢ä¸ºå›ºå®šå¤§å°çš„ç‰¹å¾å‘é‡ï¼ˆRNNä¸­é çš„æ˜¯crop/warpæ¥å¾—åˆ°å›ºå®šçš„å¤§å°ï¼Œç„¶åæ‰é€šè¿‡çš„CNNæ³¨æ„å¯¹æ¯”ï¼‰ã€‚è¿™å°±éœ€è¦æˆ‘ä»¬çš„åé¢çš„spatial pyramid poolingå±‚äº†</em></p><h4 id="spatial-pyramid-pooling"><a href="#spatial-pyramid-pooling" class="headerlink" title="spatial pyramid pooling"></a>spatial pyramid pooling</h4><p><strong>å€™é€‰åŒºåŸŸçš„ç‰¹å¾å›¾è½¬æ¢æˆå›ºå®šå¤§å°çš„ç‰¹å¾å‘é‡</strong></p><p>æˆ‘ä»¬ç»™å‡ºä¸€ä¸ªç¤ºä¾‹ï¼šå‡è®¾åŸå›¾è¾“å…¥æ˜¯224Ã—224ï¼Œå¯¹äºconvå‡ºæ¥åçš„è¾“å‡ºæ˜¯13Ã—13Ã—256ï¼Œå…¶ä¸­æŸä¸ªæ˜ å°„çš„å€™é€‰åŒºåŸŸå‡è®¾ä¸º12Ã—10Ã—256</p><ul><li>spp layer ä¼šå°†æ¯ä¸€ä¸ªå€™é€‰åŒºåŸŸåˆ†æˆ1Ã—1ï¼Œ2Ã—2ï¼Œ4Ã—4ä¸‰å¼ å­å›¾ï¼Œå¯¹æ¯ä¸ªå­å›¾çš„æ¯ä¸ªåŒºåŸŸåšmax pooling,å¾—å‡ºçš„ç‰¹å¾å†è¿æ¥åˆ°ä¸€èµ·å°±æ˜¯ï¼ˆ16+4+1ï¼‰Ã—256 = 21Ã—256=5376ç»“æœï¼Œæ¥ç€ç»™å…¨è¿æ¥å±‚åšè¿›ä¸€æ­¥å¤„ç†ï¼Œå¦‚ä¸‹å›¾ï¼š</li><li>Spatial binsï¼ˆç©ºé—´ç›’ä¸ªæ•°ï¼‰ï¼š1 + 4 + 16 = 21ï¼Œç›¸å½“äºç›’å­ä¸€æ ·å°†æˆ‘ä»¬çš„åƒç´ è£…è¿›å»åšæ± åŒ–ã€‚</li><li>ç±»ä¼¼äºé‡‘å­—å¡”å‹çš„æ± åŒ–æ“ä½œèƒ½å¤Ÿå‡å°‘æˆ‘ä»¬çš„ç‰¹å¾æ•°å¹¶ä¸”å°†æˆ‘ä»¬çš„ç‰¹å¾æ•°å›ºå®šåˆ°äº†5736ä¸ªè¿™æ ·ä¸€ä¸ªç»“æœã€‚æˆ‘ä»¬åˆ°å…¨è¿æ¥å±‚</li></ul><p><a href="https://imgtu.com/i/hG2GwT" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/29/hG2GwT.png" alt="ç»è¿‡SPPå±‚"></a></p><h4 id="SPPNetæ€»ç»“"><a href="#SPPNetæ€»ç»“" class="headerlink" title="SPPNetæ€»ç»“"></a>SPPNetæ€»ç»“</h4><p>æˆ‘ä»¬SPPNetå…¶å®åˆ›æ–°æ¥è¯´å°±æ˜¯ä¸€ä¸ªSPPå±‚çš„åˆ›æ–°ï¼Œåˆ›æ–°åŠ›åº¦ç›¸å¯¹è€Œè¨€æ²¡æœ‰é‚£ä¹ˆå¤§ã€‚åªæ˜¯æˆ‘ä»¬çš„</p><ul><li><p>ä¼˜ç‚¹</p><ul><li>SPPNetåœ¨R-CNNçš„åŸºç¡€ä¸Šæå‡ºäº†æ”¹è¿›ï¼Œé€šè¿‡å€™é€‰åŒºåŸŸå’Œfeature mapçš„æ˜ å°„ï¼Œé…åˆSPPå±‚çš„ä½¿ç”¨ï¼Œä»è€Œè¾¾åˆ°äº†CNNå±‚çš„å…±äº«è®¡ç®—ï¼Œå‡å°‘äº†è¿ç®—çš„æ—¶é—´ï¼Œåé¢çš„Fast R-CNNç­‰ä¹Ÿæ˜¯å—SPPNetçš„å¯å‘</li></ul></li><li><p>ç¼ºç‚¹</p><ul><li>è®­ç»ƒä¾ç„¶è¿‡æ…¢ã€æ•ˆç‡ä½ï¼Œç‰¹å¾éœ€è¦å†™å…¥ç£ç›˜ï¼Œå› ä¸º(SVMçš„å­˜åœ¨)</li><li>åˆ†é˜¶æ®µè®­ç»ƒç½‘ç»œï¼šé€‰å–å€™é€‰åŒºåŸŸã€è®­ç»ƒCNNã€è®­ç»ƒSVMã€è®­ç»ƒbboxå›å½’å™¨ï¼ŒSPPNetåå‘ä¼ æ’­æ•ˆç‡ä½ã€‚å¯ä»¥çœ‹å‡ºï¼Œ<strong>SPPä»…è§£å†³äº†ä¸€å°éƒ¨åˆ†R-CNNçš„ç¼ºç‚¹</strong>ï¼Œå¾ˆå¤šç¼ºç‚¹ä»ç„¶æ²¡æœ‰è§£å†³ã€‚</li></ul></li></ul><p><a href="https://imgtu.com/i/hGRbb6" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/29/hGRbb6.png" alt="æ€»æµç¨‹"></a></p><h3 id="ç›®æ ‡æ£€æµ‹Fast-R-CNN"><a href="#ç›®æ ‡æ£€æµ‹Fast-R-CNN" class="headerlink" title="ç›®æ ‡æ£€æµ‹Fast R-CNN"></a>ç›®æ ‡æ£€æµ‹Fast R-CNN</h3><h4 id="Preface-3"><a href="#Preface-3" class="headerlink" title="Preface"></a>Preface</h4><ul><li>äº†è§£Fast R-CNNçš„ç»“æ„ç‰¹ç‚¹</li><li>è¯´æ˜RoI pooling çš„ç‰¹ç‚¹</li><li>äº†è§£å¤šä»»åŠ¡æŸå¤±</li></ul><p>SPPNetæ€§èƒ½å·²ç»å¾—åˆ°äº†å¾ˆå¤§çš„æ”¹å–„ï¼Œä½†æ˜¯ç”±äºç½‘ç»œä¹‹é—´ä¸ç»Ÿä¸€è®­ç»ƒï¼ˆåˆè¦è®­ç»ƒå·ç§¯ï¼Œåˆè¦è®­ç»ƒSVMï¼Œåˆè¦è®­ç»ƒregressionâ€¦â€¦ï¼‰ï¼Œé€ æˆå¾ˆå¤§éº»çƒ¦ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥çš„Fast R-CNNå°±æ˜¯ä¸ºäº†è§£å†³è¿™æ ·çš„é—®é¢˜ï¼Œç›´æ¥å°†é‚£äº›ç»Ÿä¸€åˆ°ä¸€èµ·äº†ã€‚</p><h4 id="æ”¹è¿›ä¹‹å¤„"><a href="#æ”¹è¿›ä¹‹å¤„" class="headerlink" title="æ”¹è¿›ä¹‹å¤„"></a>æ”¹è¿›ä¹‹å¤„</h4><ul><li>æå‡ºäº†ä¸€ä¸ªRoI pooling,ç„¶åæ•´åˆæ•´ä¸ªæ¨¡å‹ï¼ŒæŠŠCNNã€RoIpoolingã€åˆ†ç±»å™¨ã€bboxå›å½’å‡ ä¸ªæ¨¡å—æ•´ä¸ªä¸€èµ·è®­ç»ƒ</li></ul><p><a href="https://imgtu.com/i/hGfdpQ" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/29/hGfdpQ.png" alt="ROI pooling"></a></p><ul><li>æ­¥éª¤<ul><li>é¦–å…ˆå°†æ•´ä¸ªå›¾ç‰‡è¾“å…¥åˆ°ä¸€ä¸ªåŸºç¡€å·ç§¯ç½‘ç»œï¼Œå¾—åˆ°æ•´å¼ å›¾çš„feature map</li><li>å°†é€‰æ‹©æ€§æœç´¢ç®—æ³•çš„ç»“æœregion proposalï¼ˆROI)æ˜ å°„åˆ°feature mapä¸­(å‰ä¸¤æ­¥å’ŒSPPNetä¸€æ ·å“¦)</li><li>ROI pooling layerï¼ˆä¸SPPNetå¯¹æ¯”ï¼‰æå–ä¸€ä¸ªå›ºå®šé•¿åº¦çš„ç‰¹å¾å‘é‡ï¼Œæ¯ä¸ªç‰¹å¾ä¼šè¾“å…¥åˆ°ä¸€ç³»åˆ—å…¨è¿æ¥å±‚ï¼Œå¾—åˆ°ä¸€ä¸ªROIç‰¹å¾å‘é‡ï¼ˆ<strong>æ­¤æ­¥éª¤æ˜¯å¯¹æ¯ä¸€ä¸ªå€™é€‰åŒºåŸŸéƒ½ä¼šè¿›è¡Œç›¸åŒçš„æ“ä½œ</strong>ï¼‰<ul><li>å…¶ä¸­ä¸€ä¸ªæ˜¯ä¼ ç»Ÿsoftmaxå±‚ï¼ˆä¸åŒäºSVMï¼‰è¿›è¡Œåˆ†ç±»ï¼Œè¾“å‡ºç±»åˆ«æœ‰kä¸ªç±»åˆ«åŠ ä¸Šâ€œèƒŒæ™¯ç±»â€</li><li>å¦ä¸€ä¸ªæ˜¯bounding box regressor</li></ul></li></ul></li></ul><h4 id="ROI-pooling"><a href="#ROI-pooling" class="headerlink" title="ROI pooling"></a>ROI pooling</h4><p>é¦–å…ˆRoI poolingåªæ˜¯ä¸€ä¸ªç®€å•ç‰ˆæœ¬çš„SPPï¼Œç›®çš„æ˜¯ä¸ºäº†å‡å°‘è®¡ç®—æ—¶é—´å¹¶ä¸”å¾—å‡ºå›ºå®šé•¿åº¦çš„å‘é‡ã€‚</p><p><a href="https://imgtu.com/i/hG4VPO" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/29/hG4VPO.png" alt="ROI AND SPP"></a></p><ul><li>åªä½¿ç”¨ä¸€ç§æ¯”å¦‚è¯´4Ã—4=16ç©ºé—´ç›’æ•°</li><li>ROIæ± å±‚ä½¿ç”¨æœ€å¤§æ± åŒ–å°†ä»»ä½•æœ‰æ•ˆROIåŒºåŸŸå†…çš„ç‰¹å¾è½¬æ¢æˆå…·æœ‰HÃ—Wçš„å›ºå®šç©ºé—´èŒƒå›´çš„å°feature mapï¼Œå…¶ä¸­Hå’ŒWæ˜¯è¶…å‚æ•° ä»–ä»¬ç‹¬ç«‹äºä»»ä½•ç‰¹å®šçš„ROIã€‚</li></ul><p>ä¸ºä»€ä¹ˆè¦è®¾è®¡å•ä¸ªå°ºåº¦å‘¢ï¼Ÿè¿™è¦æ¶‰åŠåˆ°single scale ä¸ multi scaleä¸¤è€…çš„ä¼˜ç¼ºç‚¹</p><ul><li>single scaleï¼Œ ç›´æ¥å°†imageå®šä¸ºæŸç§scaleï¼Œç›´æ¥è¾“å…¥ç½‘ç»œæ¥è®­ç»ƒå³å¯ã€‚ï¼ˆFast R-CNN)</li><li>multi scale, ä¹Ÿå°±æ˜¯è¦ç”Ÿæˆä¸€ä¸ªé‡‘å­—å¡”</li></ul><p><strong>åè€…æ¯”å‰è€…æ›´åŠ å‡†ç¡®äº›ï¼Œä½†å‡†ç¡®ç‡å¹¶æ²¡æœ‰é«˜å¾ˆå¤šï¼Œä¸è¿‡æ—¶é—´è¦èŠ‚çœå¾ˆå¤šï¼Œæ‰€ä»¥å®é™…é‡‡ç”¨çš„æ˜¯ç¬¬ä¸€ä¸ªç­–ç•¥ï¼Œå› æ­¤Fast R-CNNè¦æ¯”SPPNetå¿«å¾ˆå¤šä¹Ÿæ˜¯å› ä¸ºè¿™é‡Œçš„åŸå› ã€‚</strong></p><h4 id="End-to-End-model"><a href="#End-to-End-model" class="headerlink" title="End-to-End model"></a>End-to-End model</h4><p>ä»è¾“å…¥ç«¯åˆ°è¾“å‡ºç«¯ç›´æ¥ç”¨ä¸€ä¸ªç¥ç»ç½‘ç»œç›¸è¿ï¼Œæ•´ä½“ä¼˜åŒ–ç›®æ ‡å‡½æ•°</p><h4 id="æ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹ä¸ºä»€ä¹ˆåé¢çš„æ•´ä¸ªç½‘ç»œèƒ½è¿›è¡Œç»Ÿä¸€è®­ç»ƒï¼Ÿ"><a href="#æ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹ä¸ºä»€ä¹ˆåé¢çš„æ•´ä¸ªç½‘ç»œèƒ½è¿›è¡Œç»Ÿä¸€è®­ç»ƒï¼Ÿ" class="headerlink" title="æ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹ä¸ºä»€ä¹ˆåé¢çš„æ•´ä¸ªç½‘ç»œèƒ½è¿›è¡Œç»Ÿä¸€è®­ç»ƒï¼Ÿ"></a>æ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹ä¸ºä»€ä¹ˆåé¢çš„æ•´ä¸ªç½‘ç»œèƒ½è¿›è¡Œç»Ÿä¸€è®­ç»ƒï¼Ÿ</h4><p>ç‰¹å¾æå–CNNçš„è®­ç»ƒå’ŒSVMåˆ†ç±»å™¨çš„è®­ç»ƒåœ¨æ—¶é—´ä¸Šæ˜¯å…ˆåé¡ºåºï¼Œä¸¤è€…çš„è®­ç»ƒæ–¹å¼ç‹¬ç«‹ï¼Œå› æ­¤SVMsçš„è®­ç»ƒLossæ— æ³•æ›´æ–°SPP-Layerä¹‹å‰çš„å·ç§¯å±‚å‚æ•°ï¼Œå»æ‰äº†SVMåˆ†ç±»è¿™ä¸€è¿‡ç¨‹ï¼Œæ‰€æœ‰ç‰¹å¾éƒ½å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œä¸å ç”¨ç£ç›˜ç©ºé—´ï¼Œ<strong>å½¢æˆäº†End-to-Endæ¨¡å‹</strong>ï¼ˆé™¤äº†é€‰æ‹©æ€§æœç´¢å¾—åˆ°å€™é€‰æ¡†ä¹Ÿå³proposalé™¤å¤–ï¼Œend-to-endåœ¨Faster -RCNNä¸­å¾—ä»¥å®Œå–„ï¼‰</p><ul><li>è®­ç»ƒä¼šæ¯”è¾ƒç»Ÿä¸€ï¼šåºŸå¼ƒäº†SVMä»¥åŠSPPnet<ul><li>ROI pooling layer  + softmax </li><li>.</li></ul></li></ul><h4 id="å¤šä»»åŠ¡æŸå¤±"><a href="#å¤šä»»åŠ¡æŸå¤±" class="headerlink" title="å¤šä»»åŠ¡æŸå¤±"></a>å¤šä»»åŠ¡æŸå¤±</h4><p><em>è¿™æ˜¯Fast R-CNNçš„ä¸€ä¸ªç‰¹ç‚¹</em></p><p>ä¸¤ä¸ªlossï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ul><li>å¯¹äºåˆ†ç±»loss, æ˜¯ä¸€ä¸ªN+1è·¯çš„softmaxè¾“å‡ºï¼Œå…¶ä¸­çš„Næ˜¯ç±»åˆ« ä¸ªæ•°ï¼Œ1æ˜¯èƒŒæ™¯ï¼Œä½¿ç”¨äº¤å‰ç†µæŸå¤±</li><li>å¯¹äºå›å½’lossï¼Œæ˜¯ä¸€ä¸ª4Ã—Nè·¯è¾“å‡ºçš„regressorï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹äºæ¯ä¸ªç±»åˆ«éƒ½ä¼šè®­ç»ƒä¸€ä¸ªå•ç‹¬çš„regressorçš„æ„æ€ï¼Œ<strong>ä½¿ç”¨å¹³å‡ç»å¯¹è¯¯å·®æŸå¤±ï¼ˆMAEï¼‰å³L1æŸå¤±</strong></li><li><a href="https://imgtu.com/i/hGbcAs" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/29/hGbcAs.png" alt="L1 Loss"></a></li></ul><ul><li>fine-tuningè®­ç»ƒ<ul><li>åœ¨å¾®è°ƒæ—¶ï¼Œè°ƒæ•´CNN+ROI pooling + softmax</li><li>è°ƒæ•´bbox regressor å›å½’å½“ä¸­çš„å‚æ•°</li></ul></li></ul><h4 id="R-CNNã€SPPNetã€Fast-R-CNNæ•ˆæœå¯¹æ¯”"><a href="#R-CNNã€SPPNetã€Fast-R-CNNæ•ˆæœå¯¹æ¯”" class="headerlink" title="R-CNNã€SPPNetã€Fast R-CNNæ•ˆæœå¯¹æ¯”"></a>R-CNNã€SPPNetã€Fast R-CNNæ•ˆæœå¯¹æ¯”</h4><table><thead><tr><th align="center">å‚æ•°</th><th align="center">R-CNN</th><th align="center">SPPNet</th><th align="center">Fast R-CNN</th></tr></thead><tbody><tr><td align="center">è®­ç»ƒæ—¶é—´ï¼ˆhï¼‰</td><td align="center">84</td><td align="center">25</td><td align="center"><strong>9.5</strong></td></tr><tr><td align="center">æµ‹è¯•æ—¶é—´/å›¾ç‰‡</td><td align="center">47.0s</td><td align="center">2.3s</td><td align="center"><strong>0.32s</strong></td></tr><tr><td align="center">mAP</td><td align="center">66.0</td><td align="center">63.1</td><td align="center"><strong>66.9</strong></td></tr><tr><td align="center"></td><td align="center"></td><td align="center"></td><td align="center"></td></tr></tbody></table><h4 id="Fast-R-CNNæ€»ç»“"><a href="#Fast-R-CNNæ€»ç»“" class="headerlink" title="Fast R-CNNæ€»ç»“"></a>Fast R-CNNæ€»ç»“</h4><p><a href="https://imgtu.com/i/hGXGxP" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/29/hGXGxP.png" alt="Fast R-CNN"></a></p><p>åŸºæœ¬ä¸Šå·²ç»ç®—æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç¥ç»ç½‘ç»œäº†</p><ul><li>ç¼ºç‚¹<ul><li>Selective Search æå–Region Proposals, <strong>æ²¡æœ‰çœŸæ­£æ„ä¹‰çš„ç«¯åˆ°ç«¯</strong>ï¼Œæ“ä½œä¹Ÿæ¯”è¾ƒè€—æ—¶</li></ul></li></ul><p>æ¥ä¸‹æ¥ä¾¿æ˜¯æˆ‘ä»¬çš„æœ€ç»ˆä¼˜åŒ–æ”¹è¿›ï¼ŒFaster R-CNNçš„ç™»åœºäº†ï¼</p><h3 id="ç›®æ ‡æ£€æµ‹Faster-R-CNN"><a href="#ç›®æ ‡æ£€æµ‹Faster-R-CNN" class="headerlink" title="ç›®æ ‡æ£€æµ‹Faster R-CNN"></a>ç›®æ ‡æ£€æµ‹Faster R-CNN</h3><h4 id="Preface-4"><a href="#Preface-4" class="headerlink" title="Preface"></a>Preface</h4><ul><li>äº†è§£Faster R-CNNçš„ç‰¹ç‚¹</li><li>çŸ¥é“RPNçš„åŸç†ä»¥åŠä½œç”¨</li><li>å€™é€‰åŒºåŸŸèåˆåˆ°ç½‘ç»œä¹‹ä¸­ã€‚</li></ul><p>åœ¨Fast R-CNNè¿˜å­˜åœ¨ç€ç“¶é¢ˆé—®é¢˜ï¼šSelective  Search ï¼ˆé€‰æ‹©æ€§æœç´¢ï¼‰ã€‚è¦æ‰¾å‡ºæ‰€æœ‰çš„å€™é€‰æ¡†ï¼Œé‚£æˆ‘ä»¬æœ‰æ²¡æœ‰ä¸€ä¸ªæ›´åŠ é«˜æ•ˆçš„æ–¹æ³•æ¥æ±‚å‡ºè¿™äº›å€™é€‰æ¡†å‘¢ï¼Ÿ</p><h4 id="æ”¹è¿›ä¹‹å¤„-1"><a href="#æ”¹è¿›ä¹‹å¤„-1" class="headerlink" title="æ”¹è¿›ä¹‹å¤„"></a>æ”¹è¿›ä¹‹å¤„</h4><p>åœ¨Faster R-CNNä¸­åŠ å…¥äº†ä¸€ä¸ªæå–è¾¹ç¼˜çš„ç¥ç»ç½‘ç»œï¼Œä¹Ÿå°±æ˜¯è¯´æ‰¾å€™é€‰æ¡†çš„å·¥ä½œä¹Ÿäº¤ç»™äº†ç¥ç»ç½‘ç»œæ¥åšäº†ã€‚è¿™æ ·ï¼Œç›®æ ‡æ£€æµ‹çš„å››ä¸ªåŸºæœ¬æ­¥éª¤ï¼ˆ<strong>å€™é€‰åŒºåŸŸç”Ÿæˆï¼Œç‰¹å¾æå–ï¼Œåˆ†ç±»ï¼Œä½ç½®ç²¾ä¿®</strong>ï¼‰ç»ˆäºè¢«ç»Ÿä¸€åˆ°ä¸€ä¸ªæ·±åº¦ç½‘ç»œæ¡†æ¶ä¹‹å†…ã€‚</p><p>æˆ‘ä»¬ä¸å¦¨å…ˆçœ‹ä¸€ä¸‹ä¸‰ç§ç½‘ç»œçš„å¯¹æ¯”ï¼š</p><p><a href="https://imgtu.com/i/hGjR6P" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/29/hGjR6P.png" alt="ä¸‰ç§æ–¹æ³•å¯¹æ¯”"></a></p><p>å¯ä»¥æ˜æ˜¾çœ‹å‡ºæˆ‘ä»¬çš„fasterç›¸æ¯”ä¹‹ä¸‹å€™é€‰åŒºåŸŸçš„æ¨èä¹Ÿèè¿›å»äº†ï¼Œå°†ä»¥ä¸Šè¯´çš„å››ä¸ªæ­¥éª¤ï¼š<strong>å€™é€‰åŒºåŸŸç”Ÿæˆï¼Œç‰¹å¾æå–ï¼Œåˆ†ç±»ï¼Œä½ç½®ç²¾ä¿®</strong>éƒ½èè¿›å»äº†ã€‚</p><p>Faster R-CNNå¯ä»¥ç®€å•åœ°çœ‹æˆæ˜¯<strong>åŒºåŸŸç”Ÿæˆç½‘ç»œ+Fast R-CNNçš„æ¨¡å‹</strong>ï¼Œ ç”¨åŒºåŸŸç”Ÿæˆç½‘ç»œï¼ˆRegion Proposal Network, ç®€ç§°RPNï¼‰æ¥ä»£æ›¿Fast R-CNNä¸­çš„é€‰æ‹©æ€§æœç´¢æ–¹æ³•ï¼Œç»“æ„å¦‚ä¸‹ï¼š</p><p><a href="https://imgtu.com/i/hGjx7F" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/29/hGjx7F.png" alt="RPNç»“æ„"></a></p><h4 id="RPN"><a href="#RPN" class="headerlink" title="RPN"></a>RPN</h4><ul><li><p>é¦–å…ˆå‘CNNç½‘ç»œï¼ˆVGG-16)è¾“å…¥å›¾ç‰‡ï¼ŒFaster R-CNNä½¿ç”¨ä¸€ç»„åŸºç¡€çš„conv+relu+poolingå±‚æå–feature map.è¯¥<strong>feature mapè¢«å…±äº«ç”¨äºåç»­RPNå±‚å’Œå…¨è¿æ¥å±‚</strong>ã€‚</p></li><li><p>Region Proposal Networks. RPNç½‘ç»œç”¨äºç”Ÿæˆregion proposals, faster rcnnä¸­ç§°ä¹‹ä¸ºanchors</p><ul><li><strong>é€šè¿‡softmaxåˆ¤æ–­anchorså±äºforeground æˆ–è€…background</strong></li><li><strong>å†åˆ©ç”¨bounding box regression ä¿®æ­£anchorsè·å¾—ç²¾ç¡®çš„proposalsï¼Œ è¾“å‡ºå™¨Top-N(é»˜è®¤ä¸º300)çš„åŒºåŸŸç»™RoI pooling</strong></li><li>å¾—åˆ°é»˜è®¤300ä¸ªå€™é€‰åŒºåŸŸ</li></ul></li><li><p>ç”Ÿæˆanchors-&gt;softmaxåˆ†ç±»å™¨æå–fg anchors -&gt; bbox regå›å½’ fg anchors -&gt; Proposal Layerç”Ÿæˆproposals</p></li><li><p>åç»­å°±æ˜¯Fast RCNNæ“ä½œ</p></li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210829221422804.png" alt="å…¨è¿‡ç¨‹"></p><ul><li>RPNå°±æ˜¯æˆ‘ä»¬çš„ä»Feature Mapåˆ°ROIPoolingè¿™ä¸­é—´çš„éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯å›¾ç‰‡å·¦ä¸‹è§’è¿™ä¹ˆä¸€å—éƒ¨åˆ†ã€‚</li><li>åŸæ¥æˆ‘ä»¬æ˜¯å°†æˆ‘ä»¬çš„feature mapé€šè¿‡SSï¼ˆé€‰æ‹©æ€§æœç´¢ï¼‰å¾—åˆ°æˆ‘ä»¬çš„å€™é€‰åŒºåŸŸç„¶åæ˜ å°„åˆ°æˆ‘ä»¬çš„ROIPoolingå¤„ç†åçš„ç»“æœå¾—åˆ°æœ€ç»ˆå€™é€‰åŒºåŸŸ</li><li>ç°åœ¨æˆ‘ä»¬å¯ä»¥è¯´RPNå®Œå…¨å–ä»£äº†æˆ‘ä»¬SSæ‰€æ‰¿æ‹…çš„ä»»åŠ¡ï¼Œç›´æ¥é€šè¿‡æˆ‘ä»¬çš„RPNåœ¨æˆ‘ä»¬çš„feature mapæ¥å¾—åˆ°æˆ‘ä»¬å€™é€‰åŒºåŸŸï¼Œç„¶åä¹Ÿæ˜¯åŒæ ·çš„æ˜ å°„åˆ°ROIPoolingå¤„ç†åçš„ç»“æœã€‚</li></ul><h4 id="RPNåŸç†"><a href="#RPNåŸç†" class="headerlink" title="RPNåŸç†"></a>RPNåŸç†</h4><p>RPNç½‘ç»œçš„ä¸»è¦ä½œç”¨æ˜¯å¾—å‡ºæ¯”è¾ƒå‡†ç¡®çš„å€™é€‰åŒºåŸŸã€‚æ•´ä¸ªè¿‡ç¨‹åˆ†ä¸ºä¸¤æ­¥</p><ul><li>ç”¨nÃ—nï¼ˆé»˜è®¤3Ã—3=9ï¼‰çš„å¤§å°çª—å£å»æ‰«æç‰¹å¾å›¾ï¼Œæ¯ä¸ªæ»‘çª—ä½ç½®æ˜ å°„åˆ°ä¸€ä¸ªä½ç»´çš„å‘é‡ï¼ˆé»˜è®¤256ç»´ï¼‰ï¼Œå¹¶ä¸ºæ¯ä¸ªæ»‘çª—ä½ç½®è€ƒè™‘kç§ï¼ˆåœ¨è®ºæ–‡è®¾è®¡ä¸­k=9ï¼‰å¯èƒ½çš„<strong>å‚è€ƒçª—å£ï¼ˆè®ºæ–‡ä¸­ç§°ä¸ºanchorsï¼‰</strong></li><li>è¿™é‡Œæ»‘åŠ¨çš„æ–¹å¼è¯·æ³¨æ„ï¼Œè¿™é‡Œä¼šä»¥æ¯ä¸€ä¸ªåƒç´ ä¸ºä¸­å¿ƒç‚¹ç”Ÿæˆkç§å¯èƒ½çš„å‚è€ƒçª—å£ã€‚å‡è®¾æˆ‘ä»¬çš„è¾“å…¥feature mapæ˜¯20*20*256çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¼šå¾—åˆ°20*20*9=3600ä¸ªå‚è€ƒçª—å£ï¼ˆanchorsï¼‰ï¼ˆå½“ç„¶æˆ‘ä»¬çš„æ¯ä¸€ä¸ªanchorsä¹Ÿæœ‰256ä¸ªé€šé“ï¼‰ã€‚</li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/30/htGhbn.png" alt="å»ºè®®æ¡†"></p><ul><li><p>æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹ä»–æ‰€ç»™å‡ºçš„æ¯ä¸ªåƒç´ ç‚¹ä¸ºä¸­å¿ƒçš„ä¹ç§çª—å£å¤§å°çš„é€‰å–ï¼š</p><p><a href="https://imgtu.com/i/htNkMF" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/30/htNkMF.png" alt="ä¹ç§çª—å£"></a></p></li></ul><ul><li>3*3å·ç§¯æ ¸çš„ä¸­å¿ƒç‚¹å¯¹åº”åŸå›¾ä¸Šçš„ä½ç½®ï¼Œå°†è¯¥ç‚¹ä½œä¸ºanchorçš„ä¸­å¿ƒç‚¹ï¼Œåœ¨åŸå›¾ä¸­æ¡†å‡ºå¤šå°ºåº¦ã€å¤šç§é•¿å®½æ¯”çš„anchorsï¼Œä¸‰ç§å°ºåº¦ï¼ˆ128ï¼Œ256ï¼Œ512ï¼‰ï¼Œä¸‰ç§é•¿å®½æ¯”ï¼ˆ1ï¼š1ï¼Œ1ï¼š2ï¼Œ2ï¼š1ï¼‰ï¼Œæ¯ä¸ªç‰¹å¾å›¾ç§çš„åƒç´ ç‚¹æœ‰9ç§æ¡†ã€‚ä¸Šè¾¹å°±æ˜¯æ‰€è°“çš„å›¾ã€‚</li></ul><p>ä¸¾ä¸ªä¾‹å­ï¼ˆä»¥ä¸‹å›¾ä¸ºä¾‹ï¼‰ï¼š</p><p><a href="https://imgtu.com/i/htUVl8" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/30/htUVl8.png" alt="æµç¨‹"></a></p><p>å‡è®¾æˆ‘ä»¬æœ€åfeature shapeä¸º51*39*256, é‚£ä¹ˆæˆ‘ä»¬ä¼šæœ€ç»ˆå¾—åˆ°</p><h4 id="Faster-R-CNNè®­ç»ƒ"><a href="#Faster-R-CNNè®­ç»ƒ" class="headerlink" title="Faster R-CNNè®­ç»ƒ"></a>Faster R-CNNè®­ç»ƒ</h4><p>Faster R-CNNçš„è®­ç»ƒåˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œå³ä¸¤ä¸ªç½‘ç»œçš„è®­ç»ƒã€‚</p><ul><li><p>RPNè®­ç»ƒ</p><ul><li>ç›®çš„ï¼šä»ä¼—å¤šçš„å€™é€‰åŒºåŸŸä¸­æå–å‡ºscoreè¾ƒé«˜çš„ï¼Œå¹¶ä¸”ç»è¿‡regressionè°ƒæ•´çš„å€™é€‰åŒºåŸŸ</li><li>åˆ†ç±»ï¼šäºŒåˆ†ç±»ï¼Œsoftmaxï¼Œlogistic regression</li><li>å€™é€‰æ¡†çš„è°ƒæ•´ï¼šå‡æ–¹è¯¯å·®ä¿®æ­£</li></ul></li><li><p>Fast R-CNNéƒ¨åˆ†çš„è®­ç»ƒï¼š</p><ul><li>Fast R-CNN classification(over classes): æ‰€æœ‰ç±»åˆ«åˆ†ç±»N+1ï¼Œå¾—åˆ°å€™é€‰åŒºåŸŸçš„æ¯ä¸ªç±»åˆ«æ¦‚ç‡</li><li>Fast R-CNN regression(bbox regression): å¾—åˆ°æ›´å¥½çš„ä½ç½®</li></ul></li></ul><ul><li>é¢„æµ‹ç±»åˆ«è®­ç»ƒï¼šsoftmax</li><li>é¢„æµ‹ä½ç½®çš„è®­ç»ƒï¼šå‡æ–¹è¯¯å·®æŸå¤±</li></ul><p><a href="https://imgtu.com/i/hN3s7q" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/30/hN3s7q.png" alt="æ€»æµç¨‹"></a></p><h4 id="å€™é€‰åŒºåŸŸçš„è®­ç»ƒ"><a href="#å€™é€‰åŒºåŸŸçš„è®­ç»ƒ" class="headerlink" title="å€™é€‰åŒºåŸŸçš„è®­ç»ƒ"></a>å€™é€‰åŒºåŸŸçš„è®­ç»ƒ</h4><ul><li>è®­ç»ƒæ ·æœ¬anchoræ ‡è®°<ul><li>æ¯ä¸ªground-truth boxæœ‰ç€æœ€é«˜çš„IOUçš„anchoræ ‡è®°ä¸ºæ­£æ ·æœ¬</li><li>å‰©ä¸‹çš„anchor/anchorsä¸ä»»ä½•ground-truth boxçš„IOUå¤§äº0.7çš„è®°ä¸ºæ­£æ ·æœ¬ï¼ŒIOUå°äº0.3ï¼Œè®°ä¸ºè´Ÿæ ·æœ¬</li><li>å‰©ä¸‹çš„æ ·æœ¬å…¨éƒ¨å¿½ç•¥</li><li>æ­£è´Ÿæ ·æœ¬æ¯”ä¾‹ä¸º1ï¼š3</li></ul></li></ul><p><a href="https://blog.csdn.net/qq_40212975/article/details/107214896" target="_blank" rel="noopener">å…³äºæ­£è´Ÿæ ·æœ¬ã€ç®€å•å›°éš¾æ ·æœ¬</a></p><p><a href="https://imgtu.com/i/hNB5KP" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/30/hNB5KP.png" alt></a></p><ul><li>è®­ç»ƒæŸå¤±<ul><li>RPN classification(anchor good/bad), äºŒåˆ†ç±»ï¼Œæ˜¯å¦æœ‰ç‰©ä½“ï¼Œæ˜¯ï¼Œå¦ã€‚</li><li>RPNï¼Œ å›å½’</li><li>æ³¨ï¼šè¿™é‡Œä½¿ç”¨çš„æŸå¤±å‡½æ•°å’ŒFast R-CNNå†…çš„æŸå¤±å‡½æ•°åŸç†ç±»ä¼¼ï¼ŒåŒæ—¶æœ€å°åŒ–ä¸¤ç§ä»£ä»·</li></ul></li></ul><p><strong>å€™é€‰åŒºåŸŸçš„è®­ç»ƒæ˜¯ä¸ºäº†è®©å¾—å‡ºæ¥çš„æ­£ç¡®çš„å€™é€‰åŒºåŸŸï¼Œå¹¶ä¸”å€™é€‰åŒºåŸŸç»è¿‡äº†å›å½’å¾®è°ƒã€‚åœ¨è¿™åŸºç¡€ä¸ŠåšFast RCNNè®­ç»ƒæ˜¯å¾—åˆ°ç‰¹å¾å‘é‡åšåˆ†ç±»é¢„æµ‹å’Œå›å½’é¢„æµ‹ã€‚</strong></p><h4 id="æ•ˆæœå¯¹æ¯”"><a href="#æ•ˆæœå¯¹æ¯”" class="headerlink" title="æ•ˆæœå¯¹æ¯”"></a>æ•ˆæœå¯¹æ¯”</h4><p><a href="https://imgtu.com/i/hNrmSs" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/30/hNrmSs.png" alt="ä¸‰ç§R-CNNå¯¹æ¯”" style="zoom:150%;"></a></p><p>Faster R-CNNå¾ˆæ˜æ˜¾é€Ÿåº¦ä¼šæ›´å¿«ä¸€äº›ï¼Œæ€§èƒ½æå‡éå¸¸æ˜¾è‘—ã€‚</p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><ul><li><p>ä¼˜ç‚¹</p><ul><li>æå‡ºRPNç½‘ç»œ</li><li>ç«¯åˆ°ç«¯ç½‘ç»œæ¨¡å‹</li></ul></li><li><p>ç¼ºç‚¹</p><ul><li>è®­ç»ƒå‚æ•°è¿‡å¤§</li></ul></li></ul><p>å¯ä»¥æ”¹è¿›çš„éœ€æ±‚ï¼š</p><ul><li>RPNï¼ˆRegion Proposal Networks)æ”¹è¿›å¯¹äºå°ç›®æ ‡é€‰æ‹©åˆ©ç”¨å¤šå°ºåº¦ç‰¹å¾ä¿¡æ¯è¿›è¡ŒRPN</li><li>é€Ÿåº¦æå‡ï¼Œå¦‚YOLOç³»åˆ—ç®—æ³•ï¼Œåˆ å»äº†RPNï¼Œç›´æ¥å¯¹proposalè¿›è¡Œåˆ†ç±»å›å½’ï¼Œæå¤§çš„æå‡äº†ç½‘ç»œçš„é€Ÿåº¦</li></ul>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> ç›®æ ‡æ£€æµ‹ </tag>
            
            <tag> Faster RCNN </tag>
            
            <tag> RCNN </tag>
            
            <tag> ç¬”è®° </tag>
            
            <tag> Fast RCNN </tag>
            
            <tag> SPPNet </tag>
            
            <tag> ResNet </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®å¢å¼º</title>
      <link href="/2021/09/06/shu-ju-zeng-qiang/"/>
      <url>/2021/09/06/shu-ju-zeng-qiang/</url>
      
        <content type="html"><![CDATA[<h2 id="æ•°æ®å¢å¼ºï¼ˆData-Augmentation"><a href="#æ•°æ®å¢å¼ºï¼ˆData-Augmentation" class="headerlink" title="æ•°æ®å¢å¼ºï¼ˆData Augmentation)"></a>æ•°æ®å¢å¼ºï¼ˆData Augmentation)</h2><h4 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h4><p>ç”±äºæ•°æ®å¢å¼ºæœ¬äººç›®å‰åªæ˜¯ç®€å•äº†è§£ï¼Œå¹¶æ²¡æœ‰ç†è§£çš„å¤ªæ·±å…¥ï¼Œæ‰€ä»¥è¿™ä¸ªåšå®¢ä¼šæŒç»­æ›´æ–°ã€‚ç›®å‰ä»…è®°å½•äº†ä¸€äº›è‡ªå·±çš„ç¬”è®°ã€‚</p><h3 id="ä¸€äº›ç®€å•ä»‹ç»"><a href="#ä¸€äº›ç®€å•ä»‹ç»" class="headerlink" title="ä¸€äº›ç®€å•ä»‹ç»"></a>ä¸€äº›ç®€å•ä»‹ç»</h3><ul><li>å¢åŠ å·²æœ‰çš„æ•°æ®é›†ï¼Œä½¿å¾—æœ‰æ›´å¤šçš„å¤šæ ·æ€§<ul><li>åœ¨è¯­è¨€é‡Œé¢åŠ å…¥å„ç§ä¸åŒçš„èƒŒæ™¯å™ªéŸ³</li><li>æ”¹å˜å›¾ç‰‡çš„é¢œè‰²å’Œå½¢çŠ¶ï¼ˆè‰²æ¸©å‘€ã€ç±»ä¼¼çš„ï¼‰</li></ul></li></ul><ul><li>æ•°æ®å¢å¼ºæ˜¯<strong>åœ¨çº¿ã€éšæœº</strong>ç”Ÿæˆçš„<ul><li>åœ¨çº¿æ˜¯æŒ‡æˆ‘ä»¬ç”±åŸå§‹çš„æ•°æ®é›†ï¼Œç„¶åå¯¹åŸå§‹æ•°æ®é›†è¿›è¡Œå¤„ç†å¤„ç†åå¹¶ä¸å­˜å‚¨åœ¨ç£ç›˜é‡Œï¼Œä»…ä»…å­˜åˆ°å†…å­˜ä¸­ï¼Œå°±ç›¸å½“äºä¸´æ—¶å­˜å‚¨åŠ å·¥æ•°æ®äº†ï¼Œè¿™ä¸ªæ˜¯æˆ‘ä»¬çš„æ­¤åˆ»çš„ä¸€ä¸ªå¤„ç†ï¼Œç›¸å½“äº<strong>æ•°æ®é›†ä¸´æ—¶å¾—åˆ°äº†æ‰©å……</strong></li><li>éšæœºæ˜¯æŒ‡æˆ‘ä»¬çš„æ•°æ®é›†è¿›è¡Œæ•°æ®å¢å¼ºçš„æ“ä½œæ˜¯éšæœºé€‰å–çš„å›¾ç‰‡è¿›è¡Œæ•°æ®å¢å¼ºï¼Œæ¯æ¬¡æ•°æ®å¢å¼ºé€‰å–çš„å›¾ç‰‡å¯èƒ½éƒ½ä¸ä¸€æ ·ã€‚</li></ul></li></ul><ul><li>æµ‹è¯•çš„æ—¶å€™ä¸€èˆ¬ä¸ä¼šè¿›è¡Œå›¾ç‰‡å¢å¼ºï¼ˆ<del>æ¬¸ï¼Ÿä¸ºä»€ä¹ˆä¸è¡Œå‘¢ï¼Ÿæˆ‘è§‰å¾—å¾ˆæœ‰é“ç†å•Š</del>ï¼‰<ul><li>å¯ä»¥è®¤ä¸ºæ•°æ®å¢å¼ºæ˜¯ä½œç”¨åˆ°è®­ç»ƒçš„æ—¶å€™çš„ä¸€ä¸ªæ­£åˆ™é¡¹ã€‚</li></ul></li></ul><h3 id="å¸¸è§æ•°æ®å¢å¼ºæ“ä½œ"><a href="#å¸¸è§æ•°æ®å¢å¼ºæ“ä½œ" class="headerlink" title="å¸¸è§æ•°æ®å¢å¼ºæ“ä½œ"></a>å¸¸è§æ•°æ®å¢å¼ºæ“ä½œ</h3><h4 id="ç¿»è½¬"><a href="#ç¿»è½¬" class="headerlink" title="ç¿»è½¬"></a>ç¿»è½¬</h4><ul><li>å·¦å³ç¿»è½¬,åˆç§°ä¸ºé•œåƒå¯¹ç§°ï¼Œè¿™ä¸ªä¼¼ä¹æ˜¯æœ€å¸¸è§çš„ï¼Œæœ€å®ç”¨çš„ã€‚</li><li>ä¸Šä¸‹ç¿»è½¬ï¼Œä½†æ˜¯ä¸Šä¸‹ç¿»è½¬ä¸æ€»æ˜¯è¡Œçš„ï¼Œå¦‚æœæˆ‘ä»¬å›¾ç‰‡æ˜¯å»ºç­‘ç‰©å›¾ç‰‡ï¼Œå°±ä¸å¤ªå¥½ä¸Šä¸‹ç¿»è½¬</li></ul><p><a href="https://imgtu.com/i/h9obo4" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/23/h9obo4.png" alt="ç¿»è½¬"></a></p><h4 id="è£å‰ª"><a href="#è£å‰ª" class="headerlink" title="è£å‰ª"></a>è£å‰ª</h4><p>éšæœºè£å‰ª,éšæœºé€‰å–ä¸€éƒ¨åˆ†è¿›è¡Œè£å‰ªã€‚</p><p><a href="https://imgtu.com/i/h9TT1I" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/23/h9TT1I.png" alt="Random Cropping"></a></p><h4 id="è‰²å½©è½¬æ¢ï¼ˆColor-Shifting"><a href="#è‰²å½©è½¬æ¢ï¼ˆColor-Shifting" class="headerlink" title="è‰²å½©è½¬æ¢ï¼ˆColor Shifting)"></a>è‰²å½©è½¬æ¢ï¼ˆColor Shifting)</h4><p>æä¾›ä¸€ä¸ªå›¾ç‰‡ï¼Œæˆ‘ä»¬æŠŠRGBä¸‰ä¸ªé€šé“åŠ ä¸Šä¸åŒçš„åç§»å€¼ã€‚ç„¶åæˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ä¸ªè¾ƒä¸ºå¤±çœŸçš„å›¾ç‰‡ã€‚å½“ç„¶å®é™…ä½¿ç”¨çš„æ—¶å€™å¹¶ä¸æ˜¯ä»»æ„ä¿®æ”¹RGBå€¼çš„ï¼Œæˆ‘ä»¬ä¼šé€‰æ‹©åŸºäºæŸç§åˆ†å¸ƒæ›´æ”¹RGBå€¼ã€‚</p><p><a href="https://imgtu.com/i/h974bT" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/23/h974bT.png" alt="Color Shifting"></a></p><p>è¿™ä¹ˆåšç›®çš„å°±æ˜¯ä½¿ç”¨RGBæ”¹å˜é¢œè‰²ã€è‰²æ¸©è¿™äº›ä¸œè¥¿ï¼Œ<strong>æ³¨æ„è¿™äº›æ˜¯æœ‰ç”¨çš„ï¼ï¼</strong></p><p>æˆ‘ä»¬æœ‰ä¸€äº›ç°å®çš„æ¡ˆä¾‹ï¼š</p><p><a href="https://imgtu.com/i/h97cCj" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/23/h97cCj.png" alt="CES"></a></p><p>è¿™å°±æ˜¯æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦æ”¹å˜è¿™äº›é¢œè‰²æ¥å¢å¼ºæ•°æ®ã€‚<strong>è¿™ä¼šè®©æˆ‘ä»¬çš„æ¨¡å‹å¯¹é¢œè‰²çš„æ›´æ”¹æ›´å…·æœ‰é²æ£’æ€§</strong></p><p><em>æˆ‘ä»¬å¯ä»¥ä¸ç†è§£æˆ‘ä»¬æ›´æ”¹çš„RGBçš„æ”¹å˜æ–¹å¼ï¼Œæˆ‘ä»¬å¯¹å…·ä½“çš„é¢œè‰²æ”¹å˜çš„æ–¹å¼å«åšPCAé¢œè‰²å¢å¼ºï¼ˆPCA color augmentation)ï¼ˆ<del>PCAæ˜¯ä¸»æˆåˆ†åˆ†æçš„æ„æ€ï¼Œæ˜¯æˆ‘å¬è¯´è¿‡ä½†ä¸æ›¾å­¦è¿‡çš„é™ç»´æ–¹æ³•ï¼Œä½†è¿™é‡Œå¾ˆæ˜æ˜¾ä¸æ˜¯è¿™ä¸ªæ„æ€</del>ï¼‰,è¿™ä¸ªåœ¨Alexçš„è®ºæ–‡ä¸­é¦–æ¬¡æåˆ°ã€‚è€Œè¿™ä¸ªçš„å¤§æ¦‚å«ä¹‰å°±æ˜¯å¦‚æœæˆ‘ä»¬çš„å›¾ç‰‡å‘ˆç°ç´«è‰²ï¼Œå³ä¸»è¦å«æœ‰çº¢è‰²å’Œè“è‰²ï¼Œæœ‰å¾ˆå°‘çš„ç»¿è‰²ã€‚é‚£ä¹ˆPCA  color Augmentation ç®—æ³•ä¾¿ä¼šå‡å°‘å¤§é‡çš„R å’ŒBå€¼ï¼Œè€Œä¿ç•™è¾ƒå¤šçš„Gå€¼ä¸€æ˜¯æˆ‘ä»¬æ€»ä½“çš„é¢œè‰²ä¿æŒä¸€è‡´ã€‚</em></p><h3 id="å…³äºæ•°æ®å¢å¼ºçš„å¤šçº¿ç¨‹CPUåŠ è½½è¿‡ç¨‹"><a href="#å…³äºæ•°æ®å¢å¼ºçš„å¤šçº¿ç¨‹CPUåŠ è½½è¿‡ç¨‹" class="headerlink" title="å…³äºæ•°æ®å¢å¼ºçš„å¤šçº¿ç¨‹CPUåŠ è½½è¿‡ç¨‹"></a>å…³äºæ•°æ®å¢å¼ºçš„å¤šçº¿ç¨‹CPUåŠ è½½è¿‡ç¨‹</h3><p>è¿™äº›æˆ‘ä»¬ä¼°è®¡æ²¡æœ‰åŠæ³•è¿›è¡Œä¸€ä¸ªç®€å•çš„è®²è§£ï¼Œå¯ä»¥çœ‹è¿™ä¸ª<a href="https://www.bilibili.com/video/BV1y7411476v?p=21" target="_blank" rel="noopener">è¯¾ç¨‹</a>,ä»6ï¼š22å¼€å§‹çœ‹ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> æ•°æ®å¢å¼º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python è·¯å¾„ç›¸äº’å¼•ç”¨å¯¼å…¥é—®é¢˜(è½¬)</title>
      <link href="/2021/09/01/python-lu-jing-xiang-hu-yin-yong-dao-ru-wen-ti/"/>
      <url>/2021/09/01/python-lu-jing-xiang-hu-yin-yong-dao-ru-wen-ti/</url>
      
        <content type="html"><![CDATA[<p><a href="https://segmentfault.com/u/huaweiyunkaifazheshequ" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://avatar-static.segmentfault.com/310/908/3109081790-5eb6281a8ede6_huge128" alt><strong>åä¸ºäº‘å¼€å‘è€…ç¤¾åŒº</strong></a>å‘å¸ƒäº 2 æœˆ 5 æ—¥<a href="https://segmentfault.com/a/1190000039175570" target="_blank" rel="noopener">ç»ˆäºææ‡‚äº†Pythonæ¨¡å—ä¹‹é—´çš„ç›¸äº’å¼•ç”¨é—®é¢˜</a></p><blockquote><p>æ‘˜è¦ï¼šè¯¦ç»†è®²è§£äº†ç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„çš„å¼•ç”¨æ–¹æ³•ã€‚</p></blockquote><p>åœ¨æŸæ¬¡è¿è¡Œè¿‡ç¨‹ä¸­å‡ºç°äº†å¦‚ä¸‹ä¸¤ä¸ªæŠ¥é”™ï¼š</p><pre class="line-numbers language-ceylon"><code class="language-ceylon">æŠ¥é”™1ï¼š ModuleNotFoundError: No module named '__main__.src_test1'; '__main__' is not a packageæŠ¥é”™2ï¼š ImportError: attempted relative import with no known parent package <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>äºæ˜¯åŸºäºè¿™ä¸¤ä¸ªæŠ¥é”™æ¢ç©¶äº†ä¸€ä¸‹python3ä¸­çš„æ¨¡å—ç›¸äº’å¼•ç”¨çš„é—®é¢˜ï¼Œä¸‹é¢æ¥é€ä¸ªè§£æï¼Œè¯·è€å¿ƒçœ‹å®Œã€‚</p><p>å¥½çš„ï¼Œæˆ‘ä»¬å…ˆæ¥æ„é€ ç¬¬ä¸€ä¸ªé”™ï¼š</p><p><strong>æµ‹è¯•ä»£ç ç»“æ„å¦‚ä¸‹ï¼š</strong></p><pre class="line-numbers language-1c"><code class="language-1c">|--- test_main.py|--- src  |--- __init__.py                                                                  |--- src_test1.py    |--- src_test2.py<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>src_test2.py ä»£ç </strong></p><pre class="line-numbers language-angelscript"><code class="language-angelscript">class Test2(object):    def foo(self):        print('I am foo')<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>src_test1.py ä»£ç ï¼Œå¼•ç”¨Test2æ¨¡å—</p><pre class="line-numbers language-isbl"><code class="language-isbl">from .src_test2 import Test2def fun1():    t2 = Test2()    t2.foo()if __name__ == "__main__":    fun1()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ­¤æ—¶è¿è¡Œ src_test1.py æŠ¥é”™â€œNo module named â€˜<strong>main</strong>.src_test1â€™; â€˜<strong>main</strong>â€˜ is not a packageâ€</p><p>é—®é¢˜åŸå› ï¼š</p><p>ä¸»è¦åœ¨äºå¼•ç”¨src_test2æ¨¡å—çš„æ—¶å€™ï¼Œç”¨çš„æ˜¯ç›¸å¯¹è·¯å¾„â€.â€ï¼Œåœ¨importè¯­æ³•ä¸­ç¿»è¯‘æˆâ€./â€œï¼Œä¹Ÿå°±æ˜¯å½“å‰ç›®å½•ä¸‹ï¼ŒæŒ‰è¿™æ ·ç†è§£ä¹Ÿæ²¡æœ‰é—®é¢˜ï¼Œé‚£ä¸ºä»€ä¹ˆæŠ¥é”™å‘¢ï¼Ÿ</p><p>ä» PEP 328 ä¸­ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†å…³äº the relative importsï¼ˆç›¸å¯¹å¼•ç”¨ï¼‰çš„ä»‹ç»</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://segmentfault.com/img/bVcOxvT" alt></p><p>é€šä¿—ä¸€ç‚¹æ„æ€å°±æ˜¯ï¼Œä½ ç¨‹åºå…¥å£è¿è¡Œçš„é‚£ä¸ªæ¨¡å—ï¼Œå°±é»˜è®¤ä¸º<strong>ä¸»æ¨¡å—</strong>ï¼Œä»–çš„nameå°±æ˜¯â€˜mainâ€™ï¼Œç„¶åä¼šå°†æœ¬æ¨¡å—importä¸­çš„ç‚¹(.)æ›¿æ¢æˆâ€˜<strong>main</strong>â€™ï¼Œé‚£ä¹ˆ .src_test2å°±å˜æˆäº† <strong>main</strong>.src_test2ï¼Œæ‰€ä»¥å½“ç„¶æ‰¾ä¸åˆ°è¿™ä¸ªæ¨¡å—äº†ã€‚</p><p><strong>è§£å†³æ–¹æ³•ï¼š</strong></p><p>å› æ­¤ï¼Œå»ºè®®çš„åšæ³•æ˜¯åœ¨ srcåŒå±‚çº§ç›®å½•åˆ›å»º å¼•ç”¨æ¨¡å— test_main.pyï¼ˆä¸ºä»€ä¹ˆä¸åœ¨srcç›®å½•ä¸‹åˆ›å»ºï¼Œå¾…ä¼šä¸‹ä¸€ä¸ªæŠ¥é”™å†è®²ï¼‰ï¼Œå¹¶å¼•ç”¨src_test1æ¨¡å—ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-capnproto"><code class="language-capnproto">from src.src_test1 import fun1if __name__ == "__main__":    fun1()test_src ä»£ç :from src_test1 import fun1if __name__ == "__main__":    fun1()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰§è¡ŒæŠ¥é”™ï¼šImportError: attempted relative import with no known parent package</p><p>é—®é¢˜åŸå› ï¼š</p><p>å½“æ‰§è¡Œtest_srcæ—¶ï¼ŒæŒ‰ä¸Šæ–‡ç†è§£ï¼Œæ­¤æ—¶æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ä¸ºæ ¹ç›®å½•ï¼Œé‚£ä¹ˆå¼•ç”¨test1çš„æ—¶å€™ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤æ—¶test1çš„nameå±æ€§ä¸å†æ˜¯src.src_test1ï¼Œå› ä¸ºç¨‹åºæ„ŸçŸ¥ä¸åˆ°srcçš„å­˜åœ¨ï¼Œæ­¤æ—¶ä»–çš„ç»å¯¹è·¯å¾„æ˜¯ src_test1ï¼Œæ­¤æ—¶å†æ¬¡å¼•ç”¨ç›¸å¯¹è·¯å¾„æŸ¥æ‰¾çš„test2ï¼ŒåŒæ ·çš„æ­¥éª¤ï¼Œéœ€è¦å…ˆæ‰¾åˆ°çˆ¶èŠ‚ç‚¹ï¼Œè€Œæ­¤æ—¶ä»–è‡ªå·±å°±æ˜¯æ ¹èŠ‚ç‚¹äº†ï¼Œå·²ç»æ²¡æœ‰çˆ¶èŠ‚ç‚¹äº†ï¼Œå› æ­¤æŠ¥é”™â€œno known parent packageâ€ã€‚</p><p>è§£å†³æ–¹æ³•ï¼š</p><p>æ­¤æ—¶ä¸ºäº†é¿å…çˆ¶èŠ‚ç‚¹äº§ç”ŸçŸ›ç›¾ï¼Œå› æ­¤å°†test1ä¸­çš„å¼•å…¥å»æ‰ç›¸å¯¹å¼•ç”¨å³å¯</p><pre class="line-numbers language-clean"><code class="language-clean">from .src_test2 import Test2    -->    from src_test2 import Test2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>ç»§ç»­æ·±å…¥ï¼š</strong></p><p>é‚£ä½¿ç”¨ç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„ï¼Œç¼–è¯‘å™¨æ˜¯æ€ä¹ˆæ‰¾åˆ°è¿™ä¸ªæ¨¡å—çš„å‘¢ï¼Ÿ</p><p>æ‰§è¡Œimportçš„æ—¶å€™ï¼Œå­˜åœ¨ä¸€ä¸ªå¼•å…¥çš„é¡ºåºï¼Œå³ä¼˜å…ˆæŸ¥æ‰¾æ‰§è¡Œç›®å½•ä¸‹æœ‰æ²¡æœ‰æ­¤æ–‡ä»¶ï¼Œå¦‚æ²¡æœ‰ï¼Œå†æŸ¥æ‰¾libåº“ä¸‹ï¼Œå¦‚è¿˜æ²¡æœ‰ï¼Œå†æŸ¥æ‰¾sys.pathä¸­çš„è·¯å¾„ï¼Œå¦‚å†æ²¡æœ‰ï¼ŒæŠ¥é”™ã€‚</p><p>æ‰€ä»¥ä¸ç®¡æ˜¯å½“å‰ç›®å½•ï¼Œè¿˜æ˜¯ sys.pathä¸­çš„ç›®å½•ï¼Œéƒ½å¯ä»¥æŸ¥åˆ° src_test2è¿™ä¸ªæ¨¡å—ï¼Œå°±å¯ä»¥ç¼–è¯‘æˆåŠŸã€‚</p><p><strong>å·å¤–</strong>ï¼š</p><p>è§£å†³å®Œä¸Šè¿°é—®é¢˜åï¼Œä¸ç®¡æˆ‘ä»¬ç”¨å“ªç§æ–¹å¼ï¼Œæˆ‘ä»¬è°ƒè¯•ä»£ç æ—¶ï¼Œéƒ½æ˜¯å•ä¸ªæ–‡ä»¶è°ƒè¯•ï¼Œä½†æ­¤æ—¶æ ¹ç›®å½•å°±ä¸å¯¹äº†ï¼Œimportæ–¹å¼åˆè¦æ”¹åŠ¨ï¼Œæ‰§è¡Œèµ·æ¥å¾ˆéº»çƒ¦ï¼Œæ‰€ä»¥è¿™é‡Œæ¨èå¦ä¸€ç§æ–¹å¼ï¼ˆæœ‰æ›´å¥½çš„æ–¹å¼æ¬¢è¿ç•™è¨€ï¼‰ï¼Œä½¿ç”¨sys.path.append()çš„æ–¹æ³•</p><pre class="line-numbers language-moonscript"><code class="language-moonscript">import sys,ossys.path.append(os.getcwd())from src.src_test2 import Test2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨appendçš„æ–¹å¼ï¼Œå°†ç¨‹åºæ–‡ä»¶æ ¹ç›®å½•æ”¾è¿›äº†sys.pathä¸­ï¼Œç„¶åå†å¼•ç”¨<strong>ç»å¯¹</strong>è·¯å¾„ï¼Œè¿™æ ·çš„æ–¹å¼ï¼Œä¸ç®¡ä½¿ç”¨ä¸Šæ–‡ä¸­çš„ç¬¬ä¸€æˆ–ç¬¬äºŒæ‰§è¡Œæ–¹å¼éƒ½å¯ä»¥è°ƒç”¨ï¼Œä¹Ÿå¯ä»¥å•ç‹¬ç¼–è¯‘test1æ–‡ä»¶ï¼Œä¸ç”¨ä¿®æ”¹importè·¯å¾„ï¼Œä¹Ÿæ˜¯ç›¸å¯¹å®‰å…¨çš„æ–¹å¼ã€‚ä½†æ˜¯ç¼ºç‚¹å°±æ˜¯ï¼Œå¦‚æœä½ ä¿®æ”¹äº†æŸä¸€ä¸ªåŒ…åï¼Œéœ€è¦å°†æ‰€æœ‰å¼•ç”¨åœ°æ–¹éƒ½ä¿®æ”¹ä¸€ä¸‹ï¼Œå·¥ä½œé‡å¤§ï¼Œæ‰€ä»¥å› åœ°åˆ¶å®œã€‚</p><p>ç»¼ä¸Šï¼Œè¯¦ç»†è®²è§£äº†ç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„çš„å¼•ç”¨æ–¹æ³•ï¼Œç°åœ¨ä½ åº”è¯¥å¯¹importå¯¼å…¥çš„é—®é¢˜æœ‰äº†æ¸…æ™°çš„ç†è§£å§</p>]]></content>
      
      
      <categories>
          
          <category> è¯­æ³•çŸ¥è¯† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> è¯­æ³• </tag>
            
            <tag> è·¯å¾„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç™¾åº¦è¿˜æœ‰ç¿»ç›˜çš„æœºä¼šå—</title>
      <link href="/2021/08/26/bai-du-huan-you-fan-pan-de-ji-hui-ma/"/>
      <url>/2021/08/26/bai-du-huan-you-fan-pan-de-ji-hui-ma/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰é¢å†™ç‚¹ä¸ªäººæ„Ÿæƒ³"><a href="#å‰é¢å†™ç‚¹ä¸ªäººæ„Ÿæƒ³" class="headerlink" title="å‰é¢å†™ç‚¹ä¸ªäººæ„Ÿæƒ³"></a>å‰é¢å†™ç‚¹ä¸ªäººæ„Ÿæƒ³</h2><p>æˆ‘å¯¹äºBATçš„æ€åº¦ï¼Œå¯èƒ½ç›®å‰ç™¾åº¦ä¸é…äº†ã€‚ä½†æ˜¯è¿™å¹¶ä¸å¦¨ç¢æˆ‘æœ€å–œæ¬¢ç™¾åº¦ã€‚æˆ‘è®¤ä¸ºç™¾åº¦ä¸€ç›´æ˜¯ä¸€å®¶æŠ€æœ¯å…¬å¸ã€‚å½“ç„¶ç°åœ¨ç™¾åº¦æ²¡è½äº†ï¼Œä¸è¿‡æˆ‘è®¤ä¸ºï¼Œä¹Ÿå¸Œæœ›ç™¾åº¦å¯ä»¥é äººå·¥æ™ºèƒ½ï¼Œé AIç¿»ç›˜ã€‚ä¸ªäººçœ‹æ¥ï¼Œç™¾åº¦å¯èƒ½æ˜¯ä¸ºæ•°ä¸å¤šçš„æœªæ¥å¯ä»¥åšåˆ°å’ŒGoogleã€Amazonä¸€æ ·çš„å…¨çƒæ€§è´¨çš„é«˜ç§‘æŠ€äº’è”ç½‘å…¬å¸ï¼Œæˆ‘è®¤ä¸ºå…¨çƒé«˜ç§‘æŠ€äº’è”ç½‘å…¬å¸ï¼Œä¸­å›½ç›®å‰åªæœ‰ç™¾åº¦å¯ä»¥åšåˆ°ã€‚å½“ç„¶ç°åœ¨ç™¾åº¦æœ‰ç€å¤ªå¤šå¤ªå¤šçš„é—®é¢˜ã€‚äº§å“ä½“éªŒè¿‡å·®ç¡®å®æ˜¯ç¡¬ä¼¤ã€‚ä¸è¿‡ç›®å‰æœ€å›°éš¾çš„æ—¶åˆ»å·²ç»è¿‡å»äº†ï¼Œå¸Œæœ›ç™¾åº¦èƒ½å¤ŸæŒºä½ç†¬è¿‡ç›®å‰çš„å›°éš¾ï¼Œç™¾åº¦åŠ æ²¹ï¼</p><p>çŸ¥ä¹ä¸Šã€å„ä¸ªè®ºå›ä¸Šéƒ½åœ¨éª‚ç™¾åº¦çš„åƒåœ¾äº§å“ç™¾å®¶å·ï¼Œåƒåœ¾çš„å¹¿å‘Šï¼Œé»‘æš—çš„ç«ä»·æ’åï¼Œç™¾åº¦å®¢æœçš„æ··ä¹±ä¸ä¸è´Ÿè´£ä»»ï¼Œå·²ç»çœ‹ä¸åˆ°çš„ä¼ä¸šæ–‡åŒ–ï¼ˆè™½ç„¶æˆ‘è§‰å¾—ç°åœ¨é˜¿é‡Œçš„ä¹Ÿä¸å’‹åœ°ï¼‰â€¦â€¦åˆ°å¤„éƒ½æ˜¯åœ¨åæ§½è¯Ÿç—…ç™¾åº¦çš„ç›®å‰ç§ç§ç¼ºç‚¹ï¼Œå¥½åƒç°åœ¨ç™¾åº¦å°±åƒæ˜¯ä¸€ä¸ªç”Ÿç—…çš„å·¨äººã€‚é ç€ä»…å­˜çš„æœç´¢å¼•æ“ä¼˜åŠ¿åœ¨è‹Ÿæ´»â€¦â€¦</p><p>çš„ç¡®ï¼Œä»¥ä¸Šéƒ½æ˜¯å¾ˆè‡´å‘½ã€å¾ˆæ‹›äººåŒçš„ç¼ºç‚¹ã€‚æˆ‘ä¹Ÿè®¤ä¸ºå¦‚æœè¿™ä¹ˆç»§ç»­ä¸‹å»ç™¾åº¦å¯èƒ½çœŸçš„è¦å®Œäº†â€¦â€¦</p><p>ä½†æ˜¯æˆ‘è¿˜æ˜¯å¾ˆå´‡æ•¬ç™¾åº¦çš„è®¸å¤šä¸¾æªâ€¦â€¦</p><p>ä»–æ˜¯å›½å†…ä¸ºæ•°ä¸å¤šçš„åœ¨<strong>è®¤çœŸ</strong>åšè‡ªå·±çš„æ·±åº¦å­¦ä¹ æ¡†æ¶paddlepaddleçš„ä¼ä¸šï¼Œä¹Ÿæ˜¯åœ¨ä¼ä¸šå·²ç»å¦‚æ­¤å¢ƒåœ°çš„æƒ…å†µä¸‹åšæŒå¸ƒå±€AIï¼Œ8å¹´æ— äº§å‡ºçš„æŠ•å…¥è¿‘åƒäº¿ç ”ç©¶AIçš„ä¼ä¸š<del>ï¼ˆå°±è¿™ä¸€ç‚¹æˆ‘è§‰å¾—æˆ‘å¯¹è¿™ä¸ªä¼ä¸šå°±ç»å¯¹è®¨åŒä¸èµ·æ¥ï¼‰</del>, ä»ç„¶æ˜¯è‡ªåŠ¨é©¾é©¶è¿™ä¸ªé¢†åŸŸç”šè‡³æ˜¯å…¨çƒé¢†å…ˆçš„ä¼ä¸šã€‚å¯ä»¥è¯´è¿™æ˜¯ä¸ºæ•°ä¸å¤šçš„å›½å†…é«˜ç§‘æŠ€ã€ææŠ€æœ¯çš„é«˜æ–°ä¼ä¸šã€‚åƒè¿™ä¹ˆä¸€ä¸ªè§„æ¨¡çš„ä¼ä¸šï¼Œå‡ ä¹éƒ½æ˜¯åœ¨åšäº§å“ï¼Œç”šè‡³é˜¿é‡Œè¾¾æ‘©é™¢åœ¨æ‰¿æ¥å¤–åŒ…ï¼Œè‡ªè´Ÿç›ˆäºâ€¦â€¦</p><p>ä¸ªäººçœŸå¿ƒå¸Œæœ›ç™¾åº¦å¯ä»¥æ”¹å–„è‡ªå·±äº§å“ï¼Œä¼˜åŒ–å½¢è±¡ï¼ŒæˆåŠŸè½¬å‹ï¼ŒæˆåŠŸèµ¶ä¸Šç”šè‡³å¼•é¢†AIçš„é£å£ã€‚é€†åŠ¿è€Œä¸ºï¼Œæœªæ¥æ˜¯æ˜Ÿè¾°å¤§æµ·ï¼</p><blockquote><p>ä»¥ä¸‹æ˜¯è½¬è½½å†…å®¹ï¼Œå¦‚æœ‰ä¾µæƒï¼Œè¯·è”ç³»åšä¸»<a href="mailto:lry89757@gmail.com" target="_blank" rel="noopener">lry89757@gmail.com</a>ï¼š</p><p> æœ¬æ–‡æ¥è‡ªå¾®ä¿¡å…¬ä¼—å·<a href="https://mp.weixin.qq.com/s/FweA28zX0sjHsGY4cf-wDA" target="_blank" rel="noopener">â€œæ™ºæ…§äº‘è‘£äº‹ä¼šâ€ï¼ˆID:izhihuiyunï¼‰</a>ï¼Œä½œè€…ï¼šé™ˆé›ªé¢‘</p><p>çœ‹äº†è®¸å¤šç™¾åº¦çš„åˆ†æï¼Œå¤§å¤šæ•°éƒ½æ˜¯åæ§½å’Œä¸çœ‹å¥½ï¼ŒçœŸæ­£ç»†è‡´åˆ†æçš„ã€å®¢è§‚çš„å‡ ä¹æ²¡æœ‰ã€‚ç›´åˆ°æˆ‘çœ‹åˆ°è¿™ç¯‡æ–‡ç« ï¼Œæ„Ÿè§‰å†™å¾—éå¸¸ç²¾å½©ï¼ä¹Ÿè®©æˆ‘å¯¹ç™¾åº¦çš„è§„åˆ’ä¸æ”¿ç­–æœ‰äº†æ›´å¥½çš„äº†è§£ä¸ç†è§£ï¼Œè½¬è½½åŒ†å¿™ï¼Œå¦‚æœè¿™ç¯‡æ–‡ç« æœ‰ä¾µæƒï¼Œè¯·ç«‹åˆ»è”ç³»æœ¬äºº<a href="mailto:lry89757@gmail.com" target="_blank" rel="noopener">lry89757@gmail.com</a>ï¼Œä¾µåˆ </p></blockquote><blockquote><p> ç™¾åº¦ä¸€åº¦æ˜¯ä¸­å›½å¸‚å€¼æœ€é«˜çš„äº’è”ç½‘å…¬å¸ï¼Œä½†åœ¨æœ€è¿‘å‡ å¹´å¢é•¿ç¼“æ…¢ï¼Œä¸ä»…è¢«é˜¿é‡Œå·´å·´å’Œè…¾è®¯è¶…è¶Šï¼Œç”šè‡³å¸‚å€¼è½åäºåæ¥è€…ç¾å›¢å’Œæ‹¼å¤šå¤šã€‚æœ¬æ–‡é€šè¿‡å¯¹ç™¾åº¦åœ¨æˆ˜ç•¥å’Œä¸šåŠ¡å¸ƒå±€çš„åˆ†æï¼Œå‘ç°ç™¾åº¦è™½ç„¶åœ¨ç§»åŠ¨äº’è”ç½‘æ—¶ä»£ä¸€åº¦è½åï¼Œä½†åœ¨äººå·¥æ™ºèƒ½é¢†åŸŸè¿˜æœ‰æœºä¼šç¿»ç›˜ï¼Œä¸Šæ¼”ä¸€å‡ºç±»ä¼¼äºå¾®è½¯è½¬å‹çš„å¥½æˆï¼Œä½†å‰ææ˜¯ç™¾åº¦å¿…é¡»åœ¨ç»„ç»‡å’Œæ–‡åŒ–æ–¹é¢æŒç»­ä¼˜åŒ–ï¼Œæ‰“é€ ä¸€ä¸ªæ›´åŠ å¼€æ”¾çš„ç”Ÿæ€å‹ç»„ç»‡ã€‚</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img.36krcdn.com/20200624/v2_21c213531bfa495bbe7effb905caad60_img_000" alt="æå½¦å®"></p><p>è¿‡å»ä¸¤å¹´ï¼Œ<a href="https://36kr.com/projectDetails/28215" target="_blank" rel="noopener">ç™¾åº¦</a>åœ¨èµ„æœ¬å¸‚åœºçš„è¡¨ç°å¹³å¹³ã€‚2018å¹´5æœˆ31æ—¥ï¼Œç™¾åº¦çš„è‚¡ä»·è¾¾åˆ°å†å²çš„æœ€é«˜ç‚¹284ç¾å…ƒï¼Œå¸‚å€¼ä¹Ÿè¾¾åˆ°å†å²æœ€é«˜ç‚¹980äº¿ç¾å…ƒã€‚è¿™ä¹‹åï¼Œç™¾åº¦çš„è‚¡ä»·å°±ä¸€ç›´å¤„åœ¨ä¸‹è·Œé€šé“ä¸­ï¼Œä¸€ç›´è·Œåˆ°2020å¹´3æœˆ31æ—¥çš„82ç¾å…ƒæ‰å¼€å§‹åå¼¹ã€‚æ­¤æ—¶ç™¾åº¦çš„å¸‚å€¼ä¸º283äº¿ç¾å…ƒï¼Œå’Œ20ä¸ªæœˆå‰ç›¸æ¯”è·Œå¹…è¶…è¿‡70%ï¼Œå’Œ10å¹´å‰ç™¾åº¦çš„å¸‚å€¼ç›¸å½“ã€‚è¿™ä¹‹åç™¾åº¦çš„è‚¡ä»·å¼€å§‹åå¼¹ï¼Œå¹¶åœ¨2020å¹´6æœˆ22æ—¥åå¼¹åˆ°123ç¾å…ƒï¼Œå’Œä¸¤ä¸ªå¤šæœˆå‰ç›¸æ¯”ä¸Šæ¶¨äº†è¿‘50%ã€‚</p><p>å†æŠŠæ—¶é—´çº¿æ‹‰é•¿ï¼Œç™¾åº¦åœ¨è¿‡å»åå¹´çš„è‚¡ä»·ä¹Ÿæ˜¯èµ·èµ·ä¼ä¼ã€‚2011å¹´ï¼Œç™¾åº¦æ›¾ç»ä¸€åº¦æ˜¯ä¸­å›½å¸‚å€¼æœ€é«˜çš„äº’è”ç½‘å…¬å¸ï¼Œå’Œ<a href="https://36kr.com/projectDetails/7133" target="_blank" rel="noopener">é˜¿é‡Œå·´å·´</a>å’Œè…¾è®¯å¹¶ç§°BATã€‚å½“æ—¶çš„è…¾è®¯åˆšåˆšç»å†è¿‡3Qå¤§æˆ˜çš„æ´—ç¤¼ï¼Œå…¬å¸å†…éƒ¨å£«æ°”ä½è¿·ï¼Œé˜¿é‡Œå·´å·´åªæœ‰B2Bä¸šåŠ¡ä¸Šå¸‚ï¼Œè‚¡ä»·ä¹Ÿæ˜¯ä¸€åº¦ä½è¿·ã€‚å½“æ—¶æŠ•èµ„äººæ›´çœ‹å¥½åœ¨æœç´¢é¢†åŸŸä¸€æç‹¬ç§€çš„ç™¾åº¦ï¼Œè€Œä¸æ˜¯è¿˜åœ¨ä¸æ–­æ¢ç´¢ä¸šåŠ¡è¾¹ç•Œçš„é˜¿é‡Œå·´å·´å’Œè…¾è®¯ã€‚å¤§å®¶éƒ½è®¤ä¸ºç™¾åº¦æ˜¯ä¸­å›½æŠ€æœ¯åŠ¿åŠ›æœ€é›„åšçš„äº’è”ç½‘å…¬å¸ï¼Œæœªæ¥çš„æƒ³è±¡ç©ºé—´æ›´å¤§ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img.36krcdn.com/20200624/v2_a3bd449a305d4ac8bd4c5722f936e4ce_img_000" alt="ç™¾åº¦è¿‡å»10å¹´çš„è‚¡ä»·å˜è¿å›¾"></p><p>åå¹´è¿‡å»äº†ï¼Œè…¾è®¯çš„è‚¡ä»·ä¸Šå‡äº†20å¤šå€ï¼Œé˜¿é‡Œå·´å·´åœ¨ç»å†äº†B2Bä¸šåŠ¡é€€å¸‚å’Œé›†å›¢ä¸Šå¸‚ï¼Œä¸¤å®¶å…¬å¸çš„å¸‚å€¼éƒ½çªç ´äº†5000äº¿ç¾å…ƒï¼Œä½†ç™¾åº¦çš„å¸‚å€¼ä¾ç„¶èµ·èµ·ä¼ä¼ã€‚åå¹´å‰ï¼Œç¾å›¢ã€<a href="https://36kr.com/projectDetails/99343" target="_blank" rel="noopener">å­—èŠ‚è·³åŠ¨</a>ã€æ»´æ»´å’Œ<a href="https://36kr.com/projectDetails/81304" target="_blank" rel="noopener">æ‹¼å¤šå¤š</a>è¿˜æ²¡æœ‰åˆ›ç«‹ï¼Œä½†å¦‚ä»Šç¾å›¢å’Œæ‹¼å¤šå¤šçš„å¸‚å€¼éƒ½è¶…è¿‡äº†åƒäº¿ç¾å…ƒï¼Œå­—èŠ‚è·³åŠ¨å’Œæ»´æ»´åœ¨ä¸€çº§å¸‚åœºçš„ä¼°å€¼ä¹Ÿéƒ½é«˜äºç™¾åº¦ã€‚è™½ç„¶æ¯å®¶å…¬å¸çš„å•†ä¸šæ¨¡å¼éƒ½ä¸ä¸€æ ·ï¼Œä»…ä»…ç”¨å¸‚å€¼æ¥åˆ¤æ–­ä¸€å®¶å…¬å¸çš„ä»·å€¼æœªå¿…æ­£ç¡®ï¼Œä½†è‡³å°‘èƒ½ååº”æŠ•èµ„äººå¯¹è¿™å®¶å…¬å¸çš„ä¿¡å¿ƒã€‚</p><p>â€œå¸‚åœºçŸ­æœŸæ˜¯æŠ•ç¥¨å™¨ï¼Œé•¿æœŸæ˜¯ç§°é‡å™¨ã€‚â€è¿™æ˜¯ä»·å€¼æŠ•èµ„æ•™çˆ¶æœ¬æ°æ˜.æ ¼é›·å„å§†çš„åè¨€ï¼Œä¹Ÿè¢«ä»–çš„å­¦ç”Ÿæ²ƒä¼¦.å·´è²ç‰¹å¥‰ä¸ºåœ­è‡¬ï¼Œæ„æ€æ˜¯ä¸€å®¶å…¬å¸çš„è‚¡ä»·æ³¢åŠ¨çŸ­æœŸæ¥çœ‹æ˜¯è‚¡æ°‘ä»¥æŒæœ‰å¸‚å€¼æŠ•ç¥¨çš„ç»“æœï¼Œé•¿æœŸæ¥çœ‹è¿™å®¶å…¬å¸çš„è‚¡ä»·åˆ™èƒ½åæ˜ è¿™ä¸ªå…¬å¸çš„çœŸå®ä»·å€¼ã€‚å¦‚æœç”¨ä»·å€¼æŠ•èµ„çš„ç†å¿µå»åˆ¤æ–­ä¸€å®¶ä¼ä¸šï¼Œæˆ‘å°±ä¸èƒ½ä»…ä»…é€šè¿‡è¿™å®¶å…¬å¸è´¢æŠ¥å»è¡¡é‡ä¸€å®¶å…¬å¸çš„æœªæ¥ï¼Œæ›´è¦é€šè¿‡è¿™å®¶å…¬å¸çš„æˆ˜ç•¥ã€äº§å“ã€ç»„ç»‡ã€äººæ‰å’Œæ–‡åŒ–ç­‰è§†è§’å»åˆ¤æ–­è¿™å®¶å…¬å¸çš„å‰æ™¯ï¼Œä»è€Œè¯„ä¼°å®ƒçš„ä»·å€¼ã€‚</p><p>è¿™ç¯‡æ–‡ç« ä»ä»·å€¼æŠ•èµ„çš„è§†è§’ï¼Œåˆ†æç™¾åº¦åœ¨èµ„æœ¬å¸‚åœºè¡¨ç°ä¸ä½³çš„åŸå› ï¼Œå¹¶æ ¹æ®å®ƒåœ¨æˆ˜ç•¥å’Œä¸šåŠ¡ä¸Šçš„å¸ƒå±€ï¼Œé¢„æµ‹å®ƒæœªæ¥å¯èƒ½çš„å¸‚åœºè¡¨ç°ã€‚è¿™ç¯‡æ–‡ç« ä¹Ÿå¸Œæœ›èƒ½å›ç­”è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šä¸€å®¶æ›¾ç»çš„è¡Œä¸šéœ¸ä¸»åœ¨é­é‡å¢é•¿å¤±é€Ÿä¹‹åï¼Œå®ƒè¿˜èƒ½æ¢å¤åˆ°ä»¥å‰çš„æ´»åŠ›å—ï¼Ÿ</p><h2 id="01ã€ç™¾åº¦å¸‚å€¼ä¸‹æ»‘èƒŒåçš„åŸå› ä½•åœ¨ï¼Ÿ"><a href="#01ã€ç™¾åº¦å¸‚å€¼ä¸‹æ»‘èƒŒåçš„åŸå› ä½•åœ¨ï¼Ÿ" class="headerlink" title="01ã€ç™¾åº¦å¸‚å€¼ä¸‹æ»‘èƒŒåçš„åŸå› ä½•åœ¨ï¼Ÿ"></a>01ã€ç™¾åº¦å¸‚å€¼ä¸‹æ»‘èƒŒåçš„åŸå› ä½•åœ¨ï¼Ÿ</h2><p>å…³äºç™¾åº¦å¸‚å€¼ä¸‹æ»‘åˆ†æçš„æ–‡ç« ä¸å°‘ï¼Œå¤§éƒ½åŸºäºå®šé‡å’Œå®šæ€§çš„åˆ†æã€‚ä¸ç®¡æ˜¯é‚£ç§åˆ†ææ–¹æ³•ï¼Œéƒ½è¦ä»ç™¾åº¦çš„è´¢æŠ¥çœ‹èµ·ï¼Œè®©æˆ‘ä»¬å…ˆæ¥åˆ†æç™¾åº¦è¿‡å»ä¸‰å¹´å¤šçš„è´¢åŠ¡æŠ¥è¡¨ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img.36krcdn.com/20200624/v2_6659b27cca2a49a2b00183a825376b97_img_000" alt="è´¢åŠ¡æŠ¥è¡¨"></p><p>ç™¾åº¦2017â€”2020å¹´çš„è´¢åŠ¡æŠ¥è¡¨åˆ†æ</p><p>ä»ç™¾åº¦çš„è´¢åŠ¡æŠ¥è¡¨å¯ä»¥çœ‹åˆ°ï¼Œç™¾åº¦çš„ä¸»è¦æ”¶å…¥ä¸ºåœ¨çº¿å¹¿å‘Šï¼Œå°¤å…¶æ˜¯æœç´¢å¼•æ“å’Œè§†é¢‘å¹¿å‘Šã€‚ä»æ•°æ®æ¥çœ‹ï¼Œç™¾åº¦åœ¨çº¿å¹¿å‘Šçš„æ”¶å…¥è¿™3å¹´æ²¡æœ‰å¤§å¹…å¢é•¿ã€‚2020å¹´æ˜¥èŠ‚åï¼Œç”±äºæ–°å† ç—…æ¯’ç–«æƒ…çš„ç¼˜æ•…ï¼Œå¹¿å‘ŠæŠ•æ”¾é‡å¤§å¹…ä¸‹æ»‘ï¼Œä¹Ÿå¯¼è‡´ç™¾åº¦åœ¨2020å¹´ç¬¬ä¸€å­£åº¦çš„æ”¶å…¥å‡ºç°äº†ä¸¤ä½æ•°çš„ä¸‹æ»‘ã€‚å†åŠ ä¸Š3æœˆä»½ç¾å›½é­é‡äº†ç™¾å¹´ä¸é‡çš„è‚¡ç¾ï¼Œæ‰€æœ‰è‚¡ç¥¨éƒ½å¤§å¹…è·³æ°´ï¼Œä¸¤ä¸ªåŸå› å åŠ åœ¨ä¸€èµ·ï¼Œè¿™ä¹Ÿæ˜¯ç™¾åº¦åœ¨ä»Šå¹´è‚¡ä»·å¤§å¹…ä¸‹æ»‘çš„ä¸»è¦åŸå› ã€‚</p><p>ä»ç»†åˆ†è¡Œä¸šçš„å¢é•¿æ€§æ¥çœ‹ï¼Œç™¾åº¦æ ¸å¿ƒæ”¶å…¥çš„å¢é•¿ç¼“æ…¢å’Œäº’è”ç½‘çš„æµé‡å˜è¿æœ‰å¾ˆå¤§å…³ç³»ã€‚åœ¨PCäº’è”ç½‘æ—¶ä»£ï¼Œç™¾åº¦æŒæ§äº†äº’è”ç½‘ä¿¡æ¯çš„å…¥å£ï¼Œâ€œæœ‰äº‹æƒ…ã€ç™¾åº¦ä¸€ä¸‹â€ï¼Œæˆä¸ºä¸€ä»£äººçš„è¡Œä¸ºä¹ æƒ¯ã€‚ä½†éšç€ç§»åŠ¨äº’è”ç½‘å°¤å…¶æ˜¯ç¤¾äº¤åª’ä½“çš„å…´èµ·ï¼Œæœç´¢å¼•æ“çš„ä¿¡æ¯æŒæ§ä¼˜åŠ¿è¢«å‰Šå¼±ï¼Œä¿¡æ¯è·å–çš„æ–¹å¼å˜å¾—æ›´åŠ å¤šå…ƒåŒ–ï¼Œå¾®ä¿¡ã€<a href="https://36kr.com/projectDetails/38685" target="_blank" rel="noopener">å¾®åš</a>ã€è§†é¢‘ã€å¤´æ¡ã€æŠ–éŸ³éƒ½åœ¨åˆ†æ•£ç™¾åº¦çš„æµé‡ï¼Œä¼´éšç€æµé‡çš„åˆ†æ•£ï¼Œæœç´¢å¸¦æ¥çš„åœ¨çº¿å¹¿å‘Šæ”¶å…¥ä¸‹æ»‘ä¸å¯é¿å…ã€‚</p><p>æ ¹æ®ä¸­å…³æ‘äº’åŠ¨è¥é”€å®éªŒå®¤å‘å¸ƒçš„ã€Š2019å¹´äº’è”ç½‘å¹¿å‘Šå‘å±•æŠ¥å‘Šã€‹ï¼Œ2019å¹´ä¸­å›½äº’è”ç½‘å¹¿å‘Šæ€»æ”¶å…¥çº¦4367äº¿äººæ°‘å¸ï¼Œç›¸è¾ƒäºä¸Šä¸€å¹´å¢é•¿ç‡ä¸º18.2%ã€‚å…¶ä¸­æ¥è‡ªç”µå•†å¹³å°çš„å¹¿å‘Šå æ€»é‡çš„35.9%ï¼Œç¨³å±…ç¬¬ä¸€ï¼Œæ¯”2018å¹´å¢é•¿3%ï¼›æœç´¢ç±»å¹³å°å¹¿å‘Šä»¥14.9%çš„ä»½é¢ä»å±…ç¬¬äºŒä½ï¼Œä½†æ¯”2018å¹´çš„21%ä¸‹æ»‘äº†è¿‘ä¸‰åˆ†ä¹‹ä¸€ï¼›è§†é¢‘ç±»å¹³å°æ”¶å…¥åŒæ¯”å¢é•¿43%ï¼Œå–ä»£æ–°é—»èµ„è®¯ç±»å¹³å°ï¼Œæˆä¸ºç¬¬ä¸‰å¤§äº’è”ç½‘å¹¿å‘ŠæŠ•æ”¾å¹³å°ã€‚ç™¾åº¦çš„ä¸»è¦æ”¶å…¥æ¥æºæ˜¯æœç´¢å¼•æ“å’Œè§†é¢‘ç±»å¹³å°å¸¦æ¥çš„æ”¶å…¥ï¼Œå°¤å…¶æ˜¯æœç´¢å¸¦æ¥çš„å¹¿å‘Šæ”¶å…¥ï¼Œå› æ­¤æ”¶å…¥å—è¡Œä¸šå½±å“ä¸‹æ»‘å°±éš¾å…äº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img.36krcdn.com/20200624/v2_40ff7904ebb94ac4951e3f3ab7c0419a_img_000" alt="2019å¹´åœ¨çº¿å¹¿å‘Šæ”¶å…¥çš„åª’ä½“å¹³å°ç±»å‹æ’å"></p><p>å†æ¥åˆ†æä¸€ä¸‹ä¸­å›½äº’è”ç½‘å¹¿å‘Šçš„å‰ååæ’åã€‚ä¸­å›½åœ¨çº¿å¹¿å‘Šæ”¶å…¥æœ€å¤šçš„å…¬å¸æ˜¯é˜¿é‡Œå·´å·´ï¼Œè¿™ä¸»è¦æ˜¯å› ä¸ºé˜¿é‡Œå·´å·´æ˜¯ç”µå­å•†åŠ¡å¹³å°çš„é¢†å¯¼è€…ï¼Œè€Œè¿™ä¸ªç»†åˆ†èµ›é“åˆåœ¨æ‰€æœ‰åœ¨çº¿å¹¿å‘Šåª’ä½“æ¸ é“ä¸­å æ®äº†35.9%çš„æ”¶å…¥ï¼Œå› æ­¤æ”¶å…¥è¶…è¿‡åƒäº¿äººæ°‘å¸ã€‚ç”±äºå­—èŠ‚è·³åŠ¨åœ¨çŸ­è§†é¢‘ï¼ˆæŠ–éŸ³ï¼‰å’Œæ–°é—»èµ„è®¯ç±»åª’ä½“ï¼ˆä»Šæ—¥å¤´æ¡ï¼‰çš„è¡¨ç°çªå‡ºï¼Œå¯¼è‡´å…¶æ”¶å…¥å·²ç»è¶…è¿‡ç™¾åº¦ï¼Œæˆä¸ºä¸­å›½åœ¨çº¿å¹¿å‘Šæ”¶å…¥æ’åç¬¬äºŒçš„å…¬å¸ã€‚ç”±æ­¤å¯è§ï¼Œç™¾åº¦å¢é•¿å¤±é€Ÿçš„æœ€é‡è¦çš„åŸå› è¿˜æ˜¯æ‰€åœ¨ç»†åˆ†è¡Œä¸šå¢å¹…ä¸‹æ»‘å¯¼è‡´çš„ã€‚</p><p>å†³å®šä¸€å®¶å…¬å¸å¸‚å€¼çš„åŸå› å¾ˆå¤šï¼Œæœ‰å…³è¿™æ–¹é¢çš„è´¢åŠ¡æ¨¡å‹ä¹Ÿä¸å°‘ã€‚å¦‚æœé«˜åº¦ç®€åŒ–çš„è¯ï¼Œå¸‚å€¼æ˜¯æŠ•èµ„äººå¯¹å…¬å¸æœªæ¥ä»·å€¼çš„åˆ¤æ–­ï¼Œè¿™ç§åˆ¤æ–­ä¸€èˆ¬åŸºäºä¸¤ç‚¹ï¼šä¸€æ˜¯å…¬å¸ç°åœ¨çš„è´¢åŠ¡è¡¨ç°ï¼Œæ ¸å¿ƒæ•°æ®åŒ…æ‹¬å…¬å¸çš„é”€å”®é¢å’Œåˆ©æ¶¦ï¼Œè¿™æ˜¯ä¸€ä¸ªå®šé‡å’Œç›¸å¯¹é™æ€çš„æ¦‚å¿µï¼›ç¬¬äºŒæ˜¯å…¬å¸æœªæ¥çš„å¢é•¿æ½œåŠ›ï¼ŒåŒ…æ‹¬è¿™å®¶å…¬å¸è¿‡å»ä¸€æ®µæ—¶é—´çš„å¢é•¿è¶‹åŠ¿ï¼Œä»¥åŠè¿™å®¶å…¬å¸åœ¨å¢é•¿æ½œåŠ›æ–¹é¢çš„ç»¼åˆåˆ¤æ–­ï¼Œè¿™æ˜¯ä¸€ä¸ªå®šæ€§å’Œç›¸å¯¹åŠ¨æ€çš„åˆ¤æ–­ã€‚</p><p>ç”¨è¿™ä¸ªå¸‚å€¼æ¨¡å‹å¯ä»¥çœ‹å‡ºï¼Œç™¾åº¦å¸‚å€¼ä¸‹æ»‘çš„ä¸»è¦åŸå› æœ‰ä¸‰ä¸ªï¼šç¬¬ä¸€æ˜¯æ ¸å¿ƒä¸šåŠ¡æ”¶å…¥ä¸‹æ»‘ï¼Œå¯¼è‡´å…¬å¸çš„è´¢åŠ¡è¡¨ç°ä¸ä½³ï¼Œå½±å“äº†æŠ•èµ„è€…çš„ä¿¡å¿ƒã€‚ç¬¬äºŒæ˜¯ç™¾åº¦è™½ç„¶è¿‡å»ä¸‰å¹´å¤šçš„ç ”å‘æŠ•å…¥éƒ½åœ¨ç¨³æ­¥å¢åŠ ï¼Œè€Œä¸”åœ¨AIæ–¹é¢è·å¾—æŠ€æœ¯çªç ´ï¼Œåœ¨AIé¢†åŸŸçš„æ”¶å…¥ä¹Ÿåœ¨ä¸Šæ¶¨ï¼Œä½†æŠ•èµ„è€…éƒ½è¿™ä¸ªé¢†åŸŸçš„æœªæ¥è¿˜æŒè§‚æœ›çŠ¶æ€ã€‚ç¬¬ä¸‰æ˜¯å¤–éƒ¨ç¯å¢ƒé­é‡åˆ°äº†ç™¾å¹´ä¸€é‡çš„ç–«æƒ…å’Œè‚¡ç¾å½±å“ï¼Œå¯¼è‡´æ‰€æœ‰ä¼ä¸šéƒ½é­é‡äº†è‚¡ä»·ä¸‹è·Œï¼Œç™¾åº¦å½“ç„¶ä¹Ÿä¸ä¾‹å¤–ã€‚</p><p>ç°åœ¨çœ‹æ¥ï¼Œç™¾åº¦æœ€ç³Ÿç³•çš„æ—¶é—´åº”è¯¥å·²ç»è¿‡å»äº†ã€‚</p><p>é¦–å…ˆï¼Œç™¾åº¦æœç´¢æœ‰ä¸¤ä¸ªæ˜¾æ€§å˜åŒ–ï¼Œä¸€æ˜¯ç«¯å†…æœç´¢ä¸æ–­å¢é•¿ï¼Œå·²ç»å åˆ°æ•´ä½“ç§»åŠ¨æœç´¢50%ä»¥ä¸Šï¼›äºŒæ˜¯AIæœç´¢å¸¦æ¥è¿‘60%çš„ç™»å½•ç”¨æˆ·ï¼Œè¶Šæ¥è¶Šå¤šçš„å¹¿å‘Šä¸»ä½¿ç”¨ç™¾å®¶å·ã€æ‰˜ç®¡é¡µå’Œå°ç¨‹åºè¥é”€è¿è¥ã€‚ç™¾åº¦<a href="https://36kr.com/projectDetails/107450" target="_blank" rel="noopener">æœç´¢å¹¿å‘Š</a>å†å²ä¸Šæ›¾ç»æœ‰é«˜è¾¾50%çš„è¿è¥åˆ©æ¶¦ç‡ï¼Œå¦‚ä»Šåˆ©æ¶¦ç‡ä¿æŒ40%ä»¥ä¸Šï¼Œé¢„æœŸæ ¸å¿ƒæ”¶å…¥åŒæ¯”è¶‹åŠ¿å˜å¥½ã€‚</p><p>å…¶æ¬¡ï¼Œç”±äºç–«æƒ…æ”¾ç¼“å’Œç»æµå¤è‹ï¼Œå¯¼è‡´ç™¾åº¦åœ¨æ ¸å¿ƒä¸šåŠ¡æ–¹é¢çš„å¹¿å‘Šæ”¶å…¥ä¹Ÿåœ¨å¿«é€Ÿå¤è‹ã€‚å†åŠ ä¸Šéšç€å›½å®¶åœ¨æ–°åŸºå»ºé¢†åŸŸçš„åä¸‡äº¿çº§æŠ•èµ„ï¼Œç™¾åº¦åœ¨AIé¢†åŸŸçš„æ”¶å…¥ä¸€å®šä¼šè¿æ¥çˆ†å‘ã€‚</p><p>å†æ¬¡ï¼Œç¾å›½æœ€è¿‘å®ç°é‡åŒ–å®½æ¾çš„è´§å¸æ”¿ç­–ï¼Œè¿‡å»ä¸€æ®µæ—¶é—´åœ¨ç¾ä¸Šå¸‚å…¬å¸çš„è‚¡ä»·éƒ½å¼ºåŠ›åå¼¹ï¼Œå› æ­¤ç™¾åº¦åœ¨æœªæ¥ä¸€æ®µæ—¶é—´çš„è‚¡ä»·åº”è¯¥ä¼šæŒç»­èµ°é«˜ã€‚è¿™ä¹Ÿæ˜¯ç™¾åº¦åœ¨è¿‡å»ä¸¤ä¸ªå¤šæœˆè‚¡ä»·ä¸Šæ¶¨50%çš„å‡ ä¸ªåŸå› ã€‚</p><p>å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿä¸èƒ½ä»…ä»…å› æ ¹æ®ä¸€å®¶å…¬å¸çš„è´¢æŠ¥æ¥åˆ¤æ–­è¿™å®¶å…¬å¸çš„ä»·å€¼ï¼Œæ›´ä¸èƒ½åˆ¤æ–­è¿™å®¶å…¬å¸åœ¨æœªæ¥çš„å¸‚å€¼èµ°å‘ã€‚æƒ³è¦å¯¹ç™¾åº¦æœªæ¥çš„å‘å±•æœ‰ä¸€ä¸ªæ¸…æ™°çš„åˆ¤æ–­ï¼Œè¿˜éœ€è¦ä»ç™¾åº¦çš„æˆ˜ç•¥ã€äº§å“ã€æœåŠ¡ã€ç»„ç»‡ã€äººæ‰ã€è¿è¥ã€ç®¡ç†ç­‰å±‚é¢å»åˆ†æå®ƒï¼Œä»è€Œå¯¹ç™¾åº¦çš„æœªæ¥æœ‰ä¸€ä¸ªæ›´åŠ å®Œæ•´çš„è®¤è¯†ã€‚</p><h2 id="02ã€ç™¾åº¦åœ¨ç§»åŠ¨ä¸šåŠ¡ä¸Šè¿˜èƒ½è·å¾—å¢é•¿å—ï¼Ÿ"><a href="#02ã€ç™¾åº¦åœ¨ç§»åŠ¨ä¸šåŠ¡ä¸Šè¿˜èƒ½è·å¾—å¢é•¿å—ï¼Ÿ" class="headerlink" title="02ã€ç™¾åº¦åœ¨ç§»åŠ¨ä¸šåŠ¡ä¸Šè¿˜èƒ½è·å¾—å¢é•¿å—ï¼Ÿ"></a>02ã€ç™¾åº¦åœ¨ç§»åŠ¨ä¸šåŠ¡ä¸Šè¿˜èƒ½è·å¾—å¢é•¿å—ï¼Ÿ</h2><p>é¦–å…ˆæˆ‘ä»¬æ¥åˆ†æç™¾åº¦çš„æˆ˜ç•¥å¸ƒå±€ã€‚ç™¾åº¦çš„æˆ˜ç•¥æ˜¯ï¼šâ€œå¤¯å®ç§»åŠ¨åŸºç¡€ã€å†³èƒœAIæ—¶ä»£â€ã€‚å…¶ä¸­ï¼Œç›®å‰ç™¾åº¦çš„ä¸»è¦æ”¶å…¥æ¥æºå°±æ˜¯ç§»åŠ¨ä¸šåŠ¡ï¼ˆç›¸å½“äºç°é‡‘æµä¸šåŠ¡ï¼‰ï¼ŒåŒ…æ‹¬PCæœç´¢å’Œç§»åŠ¨æœç´¢ç­‰ï¼Œä»¥åŠå›´ç»•ç€æµé‡çš„è§†é¢‘ã€ç¤¾ç¾¤ã€çŸ¥è¯†å’Œå·¥å…·ç±»æœåŠ¡ã€‚AIï¼ˆäººå·¥æ™ºèƒ½ï¼‰åˆ™æ˜¯ç™¾åº¦æ­£åœ¨å¤§åŠ›æ¢ç´¢çš„ä¸šåŠ¡ï¼ˆç›¸å½“äºæœªæ¥çš„æ˜æ˜Ÿä¸šåŠ¡ï¼‰ï¼Œè¿™ä¸€å—ä¸»è¦è¿˜åœ¨æŠ•å…¥æœŸï¼Œå¯ä»¥ç†è§£ä¸ºç™¾åº¦çš„â€œç¬¬äºŒæ›²çº¿â€ä¸šåŠ¡ã€‚ç™¾åº¦çš„æˆ˜ç•¥æ ¸å¿ƒå°±æ˜¯åœ¨ç§»åŠ¨æ¿å—ä¿æŒé¢†å…ˆï¼Œç¡®ä¿ç°é‡‘æµçš„ç¨³å®šï¼ŒåŒæ—¶åœ¨AIæ–¹é¢å¿«é€Ÿå¸ƒå±€ï¼Œè·å¾—æ›´å¤§çš„æƒ³è±¡ç©ºé—´ã€‚</p><p>ç™¾åº¦CEOæå½¦å®å¯¹â€œå¤¯å®ç§»åŠ¨åŸºç¡€â€çš„ç†è§£æ˜¯ï¼Œç™¾åº¦è¦æ„å»ºä¸€ä¸ªç©ºå‰ç¹è£å¼ºå¤§çš„ç§»åŠ¨ç”Ÿæ€ã€‚è¿™ä¸ªå¼ºå¤§çš„ç§»åŠ¨ç”Ÿæ€ä¸æ˜¯ç®€å•çš„ç®€å•çš„â€œæœç´¢+feedâ€ï¼Œå®ƒä»¬æ˜¯ç™¾åº¦çš„åŒå¼•æ“ï¼Œä½†ä¸æ˜¯ç™¾åº¦ç§»åŠ¨ç”Ÿæ€çš„å…¨éƒ¨ã€‚ç§»åŠ¨ç”Ÿæ€æ˜¯æŒ‡æ•´ä¸ªç”Ÿæ€çš„ç›¸äº’ä¾å­˜å…³ç³»æ˜¯é¡ºçš„ï¼Œå®ƒèƒ½å¤Ÿå­µåŒ–å‡ºå¼ºå¤§çš„äº§å“ã€å¥½ç”¨çš„åŠŸèƒ½ã€å¥½çš„ç”¨æˆ·ä½“éªŒã€‚</p><p>åˆ†æç™¾åº¦åœ¨ç§»åŠ¨ç‰ˆå›¾çš„å¸ƒå±€ï¼Œå¯ä»¥çœ‹å‡ºç™¾åº¦çš„ä¸»è¦åšæ³•æ˜¯å›´ç»•ç€ç™¾åº¦APPæ¥å±•å¼€çš„ï¼Œé€šè¿‡ç™¾åº¦APPçš„è¶…çº§æµé‡å¸¦åŠ¨äº†çŸ¥è¯†ã€è§†é¢‘ã€ç¤¾ç¾¤å’Œå·¥å…·ç±»äº§å“ã€‚ç„¶ååœ¨ä¸€äº›å‚ç›´é¢†åŸŸçš„å†…å®¹å’Œå•†ä¸šåº”ç”¨æ–¹é¢éƒ½æœ‰å¸ƒå±€ï¼Œå…¶ä¸­å¤§å¤šæ•°æ˜¯ç™¾åº¦è‡ªè¥çš„å†…å®¹å¹³å°ï¼Œè¿˜æœ‰ä¸€äº›æ˜¯é€šè¿‡æŠ•èµ„å®ç°ç»†åˆ†å†…å®¹çš„è¿æ¥ï¼Œæ¯”å¦‚<a href="https://36kr.com/projectDetails/26201" target="_blank" rel="noopener">çŸ¥ä¹</a>ï¼Œæœå£³ã€<a href="https://36kr.com/projectDetails/50809" target="_blank" rel="noopener">å‡¯å”è®²æ•…äº‹</a>ã€<a href="https://36kr.com/projectDetails/30367" target="_blank" rel="noopener">ç½‘æ˜“</a>äº‘éŸ³ä¹ã€<a href="https://36kr.com/projectDetails/113287" target="_blank" rel="noopener">æ¢¨è§†é¢‘</a>ã€<a href="https://dianping.36kr.com/space/4879001014" target="_blank" rel="noopener">æœ‰èµ</a>ç­‰ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img.36krcdn.com/20200624/v2_68b486f043d341ae85018ad61447299a_img_000" alt="ç™¾åº¦ç§»åŠ¨ç‰ˆå›¾"></p><p>ç™¾åº¦å¯¹ä¼˜è´¨å†…å®¹éå¸¸é‡è§†ï¼Œä¸€ä¸ªé‡è¦çš„åŸå› æ˜¯ç™¾åº¦ä¸€ç›´å¸Œæœ›æ‰“é€ ä¿¡æ¯å…¥å£ï¼Œè¿™ä¹Ÿå†³å®šäº†ä»–ä»¬éœ€è¦æ›´åŠ ä¼˜è´¨çš„å†…å®¹ã€‚åœ¨PCäº’è”ç½‘æ—¶ä»£ï¼Œç™¾åº¦å°±å…ˆåæ¨å‡ºäº†è´´å§ã€çŸ¥é“ã€ç™¾ç§‘ç­‰å†…å®¹äº§å“ï¼Œè‡³ä»Šè¿™äº›äº§å“ä»æ˜¯ç™¾åº¦ç§»åŠ¨ç”Ÿæ€çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚åˆ°äº†ç§»åŠ¨äº’è”ç½‘æ—¶ä»£ï¼Œâ€œä¿¡æ¯å­¤å²›â€è®©ç™¾åº¦å¯ä»¥è·å–çš„ä¼˜è´¨å†…å®¹å‡å°‘ï¼Œäºæ˜¯ç™¾åº¦å…ˆæ˜¯å‘åŠ›ç™¾å®¶å·ï¼Œä¸ºç§»åŠ¨ç«¯æä¾›ä¼˜è´¨å†…å®¹ï¼Œååˆåœ¨2018å¹´æ¨å‡ºæ™ºèƒ½å°ç¨‹åºï¼Œæ„å»ºæ–°çš„å†…å®¹ç”Ÿæ€ç¯å¢ƒã€‚</p><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œç™¾åº¦åœ¨åŒ…æ‹¬çŸ¥é“ã€ç™¾ç§‘ã€æ–‡åº“ç­‰çŸ¥è¯†å†…å®¹æ–¹é¢ç§¯ç´¯äº†è¶…10äº¿çš„é«˜è´¨é‡å†…å®¹ã€‚ç™¾åº¦ç™¾ç§‘æ˜¯å…¨çƒæœ€å¤§çš„ä¸­æ–‡ç™¾ç§‘å…¨ä¹¦ï¼Œæ‹¥æœ‰1600ä¸‡ä¸ªè¯æ¡ï¼›ç™¾åº¦çŸ¥é“æ˜¯å…¨çƒæœ€å¤§çš„äº’åŠ¨é—®ç­”å¹³å°ï¼Œç´¯ç§¯é—®ç­”æ•°è¾¾åˆ°5.5äº¿ï¼›ç™¾åº¦æ–‡åº“æ˜¯ä¸­å›½æœ€å¤§çš„æ–‡æ¡£åˆ†äº«å¹³å°ï¼Œåœ¨çº¿æ–‡æ¡£æ•°è¶…6äº¿ã€‚å¦å¤–ï¼Œç™¾å®¶å·æ‹¥æœ‰240ä¸‡å†…å®¹ç”Ÿäº§è€…ï¼Œç”Ÿäº§å†…å®¹åŒ…æ‹¬æ–‡ç« ã€å›¾ç‰‡ã€çŸ­è§†é¢‘ç­‰ï¼›ç™¾åº¦æ™ºèƒ½å°ç¨‹åºæœˆæ´»è·ƒç”¨æˆ·è¾¾3äº¿ï¼Œå…¥é©»å°ç¨‹åºæ•°é‡è¾¾åˆ°30ä¸‡ã€‚</p><p>ç”±æ­¤ï¼Œç™¾åº¦æ„å»ºäº†ä¸­å›½æœ€å¤§çš„ä»¥ä¿¡æ¯å’ŒçŸ¥è¯†ä¸ºæ ¸å¿ƒçš„ç§»åŠ¨ç”Ÿæ€ã€‚é€šè¿‡å¯¹ç™¾åº¦åœ¨ç§»åŠ¨ç‰ˆå›¾çš„å¸ƒå±€å¯ä»¥çœ‹å‡ºï¼Œç™¾åº¦ä¸€æ–¹é¢é€šè¿‡åŒå¼•æ“â€”â€”æœç´¢å’Œä¿¡æ¯æµçš„æ–¹å¼åˆ†å‘å†…å®¹ï¼Œå¹¶å½¢æˆæ¯å¤©ç™¾äº¿çº§çš„æµé‡åˆ†å‘ï¼Œä¸€æ–¹é¢é€šè¿‡ç™¾å®¶å·å’Œæ™ºèƒ½å°ç¨‹åºå½¢æˆä¸€ä¸ªå†…å®¹ç”Ÿæ€ã€‚ä¸æ­¤åŒæ—¶ï¼Œç™¾åº¦è¿˜é€šè¿‡æˆ˜ç•¥æŠ•èµ„çš„æ–¹å¼æ‹“å®½å†…å®¹ç»´åº¦ï¼Œæ»¡è¶³æ›´å¤šç”¨æˆ·å¤šæ ·åŒ–çš„å†…å®¹éœ€æ±‚ï¼Œæé«˜ç”¨æˆ·æ»¡æ„åº¦ï¼Œå¢åŠ ç”¨æˆ·é»æ€§ï¼Œå¤¯å®ä»¥ä¿¡æ¯å’ŒçŸ¥è¯†ä¸ºæ ¸å¿ƒçš„ç§»åŠ¨ç”Ÿæ€ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img.36krcdn.com/20200624/v2_0fe877ed19e5421db2c72ac41b9b08b8_img_000" alt="ç™¾åº¦åœ¨2018â€”2019å¹´åœ¨ç§»åŠ¨èµ›é“ä¸Šçš„æŠ•èµ„ç‰ˆå›¾"></p><p>æ¯”å¦‚è¯´ï¼Œåœ¨ç™¾åº¦æŠ•èµ„çš„é¡¹ç›®ä¸­ï¼ŒçŸ¥ä¹æ‹¥æœ‰2.2äº¿ç”¨æˆ·ï¼Œ1.3äº¿å›ç­”æ•°é‡ï¼Œæ˜¯å›½å†…å¤´éƒ¨çŸ¥è¯†é—®ç­”ç¤¾åŒºã€‚è¿™äº›å†…å®¹ä»¥æ™ºèƒ½å°ç¨‹åºçš„å½¢å¼æ¥å…¥ç™¾åº¦Appåï¼Œä¸ä»…æ‹“å®½äº†ç™¾åº¦Appå†…å®¹ç”Ÿæ€ç»´åº¦ï¼Œä¹Ÿä¸ºç”¨æˆ·æä¾›æ›´å¹¿æ³›çš„çŸ¥è¯†å†…å®¹ï¼Œæå‡äº†ç”¨æˆ·ä½“éªŒã€‚åŒæ ·ï¼Œæœå£³ã€å‡¯å”è®²æ•…äº‹ã€ä¸ƒçŒ«å°è¯´ã€ç½‘æ˜“äº‘éŸ³ä¹çš„æ¥å…¥ï¼Œä¸ä»…æ»¡è¶³ç”¨æˆ·å¯¹äºå›¾æ–‡ã€èµ„è®¯ã€éŸ³é¢‘ã€è§†é¢‘ã€é˜…è¯»ç­‰å¤šç§å¨±ä¹å†…å®¹è¯‰æ±‚ï¼Œå¢å¼ºç”¨æˆ·å¯¹äºäº§å“çš„é»æ€§ï¼Œæå‡ç”¨æˆ·ä½¿ç”¨æ—¶é•¿ã€‚</p><p>ç™¾åº¦æƒ³è¦åœ¨ç§»åŠ¨ç‰ˆå›¾ä¸Šä¿æŒå¢é•¿ï¼Œé™¤äº†ä¿æŒåœ¨æœç´¢ä¸šåŠ¡çš„ç¨³å®šä¹‹å¤–ï¼Œè¿˜éœ€è¦æ‹“å±•è‡ªå·±åœ¨è§†é¢‘å’Œæ–°é—»èµ„è®¯é¢†åŸŸçš„å¢é•¿é€Ÿåº¦ï¼Œè¿™ä¹Ÿæ˜¯ç™¾åº¦åœ¨å†…å®¹ç”Ÿæ€æ–¹é¢å‘åŠ›çš„ä¸»è¦é©±åŠ¨åŠ›ã€‚ä»æˆ˜ç•¥å±‚é¢æ¥çœ‹ï¼Œç™¾åº¦å·²ç»çœ‹åˆ°äº†è¿™ä¸ªè¶‹åŠ¿ï¼Œå› æ­¤ç§¯æåœ¨å†…å®¹ç«¯å»å‘åŠ›ï¼Œä»¥è·å¾—æœªæ¥çš„å¯æŒç»­å¢é•¿ã€‚</p><p>éšç€ç™¾åº¦æœç´¢ä»ç½‘é¡µç«¯æœç´¢å‘APPç«¯å’Œæ™ºèƒ½ç»ˆç«¯æœç´¢è½¬åŒ–ï¼Œå¯¼è‡´ç™¾åº¦APPå·²ç»å åˆ°äº†ç™¾åº¦æ”¶å…¥çš„ä¸€åŠä»¥ä¸Šï¼Œè€Œä¸”è¶Šæ¥è¶Šå¤šçš„å¹¿å‘Šé€šè¿‡ç™¾å®¶å·å’Œå°ç¨‹åºæ¥å®ç°ã€‚2019å¹´ï¼Œç™¾åº¦çš„æ ¸å¿ƒå¹¿å‘Šä¸šåŠ¡æ€»æ”¶å…¥çº¦ä¸º 781 äº¿ï¼Œå‡€åˆ©æ¶¦è¾¾åˆ°228äº¿ï¼Œåˆ©æ¶¦ç‡æ¥è¿‘30%ã€‚å‡è®¾ç™¾åº¦çš„æ ¸å¿ƒå¹¿å‘Šä¸šåŠ¡æ”¶å…¥é•¿æœŸä¿æŒ10%çš„å¢é•¿ç‡ï¼Œå¸‚ç›ˆç‡ä¸ä½äº12å€ï¼ˆè¿™ä¸¤ä¸ªæ•°å­—éƒ½æ¯”è¾ƒä¿å®ˆï¼‰ï¼Œç™¾åº¦åœ¨ç§»åŠ¨ä¸šåŠ¡çš„ä¼°å€¼å°±åº”è¯¥ä¸ä½äº450äº¿ç¾å…ƒï¼Œé«˜äºç›®å‰æ•´ä¸ªç™¾åº¦çš„å¸‚å€¼ã€‚</p><p>ç»¼ä¸Šæ‰€è¿°ï¼Œåªè¦ç™¾åº¦å®ˆä½äº†ç§»åŠ¨ä¸šåŠ¡çš„åŸºæœ¬ç›˜ï¼Œä¿æŒç¨³å¥çš„ç°é‡‘æµï¼Œå°±æœ‰ç¿»ç›˜çš„æœºä¼šã€‚</p><h2 id="03ã€AIå•†ä¸šåŒ–æ˜¯å¦å¯æœŸï¼Ÿ"><a href="#03ã€AIå•†ä¸šåŒ–æ˜¯å¦å¯æœŸï¼Ÿ" class="headerlink" title="03ã€AIå•†ä¸šåŒ–æ˜¯å¦å¯æœŸï¼Ÿ"></a>03ã€AIå•†ä¸šåŒ–æ˜¯å¦å¯æœŸï¼Ÿ</h2><p>å¦‚æœè¯´ç§»åŠ¨ä¸šåŠ¡æ˜¯ç™¾åº¦çš„ç°é‡‘æµä¸šåŠ¡ï¼Œæ˜¯ç™¾åº¦çš„ç«‹èº«ä¹‹æœ¬ï¼Œä½†åœ¨è¿™ä¸ªé¢†åŸŸç”±äºç«äº‰å·²ç»æ¯”è¾ƒå……åˆ†ï¼Œè¿™ä¸ªé¢†åŸŸå‘å±•å¾—å†å¥½ä¹Ÿåªèƒ½æ˜¯ä¿æŒä¼˜åŠ¿ã€‚ç™¾åº¦è¦æƒ³æ¢å¤BATæ—¶ä»£çš„è£è€€ï¼Œå¸‚å€¼åœ¨ç°æœ‰åŸºç¡€ä¸Šå¢é•¿10å€ä»¥ä¸Šï¼Œå’Œè…¾è®¯å’Œé˜¿é‡Œå·´å·´æ¯”è‚©ï¼Œå°±éœ€è¦åœ¨è¿™ä¸ªé¢†åŸŸèƒ½æœ‰çªç ´æ€§çš„å‘å±•ã€‚</p><p>ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿä¸»è¦åŸå› æœ‰ä¸¤ä¸ªï¼šç¬¬ä¸€æ˜¯å¤§åŠ¿æ‰€è¶‹ï¼Œåœ¨æœªæ¥æ•°å­—ç»æµå°†ä¼šè¿æ¥ä¸€æ³¢çˆ†å‘æ€§çš„å¢é•¿ï¼Œè¿™é‡Œé¢å­˜åœ¨åä¸‡äº¿çº§çš„å¸‚åœºï¼Œå…¶ä¸­AIåˆ™æ˜¯æ•°å­—ç»æµçš„æ ¸å¿ƒé©±åŠ¨å› ç´ ã€‚ç¬¬äºŒæ˜¯ç›¸å¯¹ä¼˜åŠ¿ï¼Œç°åœ¨å„å¤§å…¬å¸éƒ½åœ¨å‘åŠ›AIï¼Œä½†ç™¾åº¦åœ¨è¿™ä¸ªé¢†åŸŸè€•è€˜æ—¶é—´æœ€é•¿ï¼Œæ‹¥æœ‰çš„ä¸“åˆ©æœ€å¤šï¼Œç›¸æ¯”å…¶ä»–ä¼ä¸šæ›´å…·ä¼˜åŠ¿ã€‚ä¸€ä¸ªå¥½æˆ˜ç•¥åº”è¯¥æ»¡è¶³ä¸‰ä¸ªæ¡ä»¶ï¼šæœ‰ç°å®çš„å¸‚åœºéœ€æ±‚ï¼Œä¼ä¸šæœ‰èµ„æºå’ŒæŠ€æœ¯ï¼Œæœ‰å·®å¼‚åŒ–çš„ç«äº‰ä¼˜åŠ¿ã€‚AIå¯¹äºç™¾åº¦æ¥è¯´æ˜¯ä¸‰è€…å…¼å¤‡ã€‚</p><p>é€šè¿‡å¯¹æ”¿æ²»ã€ç»æµã€ç¤¾ä¼šå’Œç§‘æŠ€åšåˆ†æï¼ˆPESTåˆ†æï¼‰ï¼Œéƒ½ä¼šå‘ç°AIæ˜¯å¤§è¶‹åŠ¿ã€‚ä»æ”¿æ²»æ¥çœ‹ï¼Œå›½å®¶åœ¨AIæ–¹é¢å‡ºå°äº†ä¸€ç³»åˆ—æ”¿ç­–ï¼Œåœ¨2020å¹´æ¨å‡ºçš„æ–°åŸºå»ºä¸­ï¼ŒAIæ˜¯ä¸ƒå¤§éƒ¨åˆ†ä¹‹ä¸€ã€‚ä»ç»æµæ¥çœ‹ï¼Œä¸­å›½ç»æµçš„è½¬å‹å‡çº§ï¼Œä¼ä¸šé¢ä¸´æ•°å­—åŒ–è½¬å‹ï¼Œè€ŒAIåœ¨æ•°å­—åŒ–è½¬å‹ä¸­æ‰®æ¼”å¤§è„‘è§’è‰²ã€‚ä»ç¤¾ä¼šæ¥çœ‹ï¼Œ2020å¹´çš„æ–°å† ç—…æ¯’ç–«æƒ…ä¸­ï¼ŒAIæ‰®æ¼”äº†éå¸¸é‡è¦çš„è§’è‰²ã€‚ä»ç§‘æŠ€æ¥çœ‹ï¼Œç°åœ¨å„ç§AIçš„åº”ç”¨è¶Šæ¥è¶Šæˆç†Ÿï¼Œå¹¶å½¢æˆäº†ä¸€ä¸ªå®Œæ•´çš„äº§ä¸šé“¾ã€‚</p><p>2018å¹´12æœˆï¼Œä¸­å¤®ç»æµå·¥ä½œä¼šè®®åœ¨åŒ—äº¬ä¸¾è¡Œï¼Œä¼šè®®é‡æ–°å®šä¹‰äº†åŸºç¡€è®¾æ–½å»ºè®¾ï¼ŒæŠŠ5Gã€äººå·¥æ™ºèƒ½ã€å·¥ä¸šäº’è”ç½‘ã€ç‰©è”ç½‘å®šä¹‰ä¸ºâ€œæ–°å‹åŸºç¡€è®¾æ–½å»ºè®¾â€ï¼Œç®€ç§°â€œæ–°åŸºå»ºâ€ã€‚åœ¨æ–°åŸºå»ºä¸­ï¼Œäººå·¥æ™ºèƒ½æ‰®æ¼”ä¸­å¤§è„‘çš„è§’è‰²ï¼Œåœ¨è¿™ä¸ªé¢†åŸŸæœªæ¥ä¼šæœ‰æ•°ä»¥åƒäº¿çš„æŠ•èµ„ï¼Œè€Œç™¾åº¦åœ¨è¿™ä¸ªé¢†åŸŸå…·å¤‡ä¼˜åŠ¿ã€‚2020å¹´ï¼Œæ–°å† è‚ºç‚ç–«æƒ…å‘ç”Ÿä»¥æ¥ï¼ŒAIåœ¨åŒ»ç–—ã€é…é€ã€å·¡æ£€ç­‰æ–¹é¢<a href="https://36kr.com/projectDetails/461959" target="_blank" rel="noopener">å¤§æ˜¾</a>èº«æ‰‹ï¼Œâ€œæ–°åŸºå»ºâ€ä¹ŸæŒ‰ä¸‹å¿«è¿›é”®ï¼ŒåŒé‡å› ç´ å åŠ ï¼Œå¯¼è‡´AIæ­£è¿æ¥æ–°çš„å‘å±•æ–°æœºé‡ã€‚AIçš„å•†ä¸šåŒ–ä¹Ÿå¼€å§‹è¿æ¥äº†æ˜¥å¤©ï¼Œä½œä¸ºAIé¢†åŸŸçš„é¢†å¯¼è€…ï¼Œç™¾åº¦å…·æœ‰å¾ˆå¤§çš„æƒ³è±¡ç©ºé—´ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img.36krcdn.com/20200624/v2_c7b3511b68354d71b9519f1984c7e1a6_img_000" alt="ç™¾åº¦çš„AIæ–°åŸºå»ºç‰ˆå›¾"></p><p>AIä¼šåœ¨ä¸‰ä¸ªå±‚æ¬¡å¸¦æ¥å®è´¨çš„ç»æµå’Œäº§ä¸šç»“æ„æ€§å½±å“ï¼Œè€Œç™¾åº¦åœ¨è¿™ä¸‰ä¸ªå±‚æ¬¡ä¸Šéƒ½æœ‰å¸ƒå±€ï¼š</p><p>é¦–å…ˆæ˜¯æ™ºèƒ½äº¤äº’å±‚ï¼Œå¯¹åº”çš„æ˜¯å„ç§ç»ˆç«¯è®¾å¤‡å’Œåº”ç”¨æœåŠ¡ï¼Œä¸»è¦å•†ä¸šæ¨¡å¼æ˜¯2Cã€‚åœ¨ç§»åŠ¨äº’è”ç½‘æ—¶ä»£å¯¹åº”çš„æ˜¯æ™ºèƒ½æ‰‹æœºå’Œå„ç§APPåº”ç”¨ï¼Œä½†äººå·¥æ™ºèƒ½å’Œç‰©è”ç½‘ä¼šè¶…è¶Šæ™ºèƒ½æ‰‹æœºçš„èŒƒå›´ï¼Œæ¯”å¦‚æ™ºèƒ½éŸ³ç®±ï¼Œå„ç§å¯ç©¿æˆ´è®¾å¤‡ï¼Œä¼ æ„Ÿè£…ç½®å’Œæœºå™¨äººç­‰ï¼Œè¿™å¿…å°†å¯¼è‡´æ•´ä¸ªè¡Œä¸šè¢«é‡æ–°æ´—ç‰Œã€‚ç™¾åº¦åœ¨è¿™ä¸ªé¢†åŸŸéå¸¸æœ‰ä¼˜åŠ¿ï¼Œç§»åŠ¨ç«¯æ‹¥æœ‰åäº¿ä»¥ä¸Šçš„ç”¨æˆ·ï¼Œå¯¹è¯å¼è¯­éŸ³äº¤äº’çš„å°åº¦éŸ³ç®±ä¸­å›½å¸‚åœºä»½é¢ç¬¬ä¸€ï¼Œä»–ä»¬éƒ½æ˜¯AIçš„ç»ˆç«¯è®¾å¤‡å’Œåº”ç”¨ã€‚</p><p>å…¶æ¬¡æ˜¯åŸºç¡€è®¾æ–½å±‚ï¼Œå¯¹åº”çš„æ˜¯5Gç½‘ç»œã€äº‘è®¡ç®—ã€å¤§æ•°æ®å’ŒAIç­‰ï¼Œè¿™äº›åŸºç¡€è®¾æ–½æœ€ç»ˆéƒ½ä¼šé€šè¿‡äº‘æœåŠ¡çš„æ¨¡å¼å¯¹å¤–å¼€æ”¾å…±äº«ï¼Œå…¶ä¸»è¦å•†ä¸šæ¨¡å¼æ˜¯2Bã€‚è¿™ä¸ªå±‚æ¬¡çš„åˆ›æ–°ä¸å¦‚ç”¨æˆ·ç»ˆç«¯å±‚é¢é‚£æ ·æ˜æ˜¾ï¼Œä½†å½±å“å´éå¸¸æ·±è¿œã€‚å›½å¤–çš„è°·æ­Œã€äºšé©¬é€Šå’Œå¾®è½¯éƒ½åœ¨è¿™ä¸ªåŸºç¡€è®¾æ–½é¢†åŸŸé•¿æœŸæŠ•èµ„ï¼Œè¿™ä¹Ÿæ˜¯æ”¯æ’‘ä»–ä»¬çš„å¸‚å€¼è¶…è¿‡ä¸€ä¸‡äº¿ç¾å…ƒçš„é‡è¦åŸºç¡€ã€‚åœ¨å›½å†…ï¼Œ<a href="https://36kr.com/projectDetails/25167" target="_blank" rel="noopener">åä¸º</a>ã€ç™¾åº¦ã€è…¾è®¯å’Œé˜¿é‡Œå·´å·´éƒ½åœ¨è¿™é‡ŒæŠ•ä»¥é‡é‡‘ï¼Œå…¶ä¸­ç™¾åº¦åˆ™ä»¥AIè§é•¿ã€‚</p><p>æœ€åæ˜¯äº§ä¸šæ™ºèƒ½åŒ–å±‚é¢ï¼Œå¯¹åº”çš„æ˜¯äº¤é€šã€åŒ»ç–—ã€åŸå¸‚ã€æ•™è‚²ç­‰ç­‰å…·ä½“è¡Œä¸šçš„æ™ºèƒ½åŒ–ï¼Œä»¥åŠåœ¨æ™ºèƒ½åŒ–åŸºç¡€ä¹‹ä¸Šï¼Œè¿™äº›è¡Œä¸šä¹‹é—´çš„ç›¸äº’å½±å“ï¼Œå…¶å•†ä¸šæ¨¡å¼å¯èƒ½æ˜¯å‚ç›´æ•´åˆçš„ï¼Œæ—¢æœ‰2Bçš„æˆåˆ†ï¼Œä¹Ÿæœ‰2Cçš„æˆåˆ†ã€‚æ•°å­—æŠ€æœ¯å¯¹è¡Œä¸šçš„æ”¹é€ ä¸»è¦é›†ä¸­åœ¨ä¿¡æ¯ã€é›¶å”®ã€æ—…æ¸¸ã€é…’åº—ã€æœ¬åœ°ç”Ÿæ´»æœåŠ¡å’Œé‡‘èç­‰ä¸ªäººä¿¡æ¯é©±åŠ¨çš„è¡Œä¸šï¼Œä½†ç‰©è”ç½‘å’Œäººå·¥æ™ºèƒ½é©±åŠ¨çš„æ™ºèƒ½ç»æµä¸ä½†åŒ…æ‹¬äº†ä¸ªäººä¿¡æ¯ï¼Œè¿˜åŒ…æ‹¬äº†ç‰©çš„ä¿¡æ¯ï¼Œæ¯”å¦‚æ— äººé©¾é©¶å°±èšåˆå¾ˆå¤šåˆ›æ–°æœºä¼šã€‚ç™¾åº¦ã€è…¾è®¯å’Œé˜¿é‡Œå·´å·´éƒ½åœ¨æ¨å‡ºäº§ä¸šäº’è”ç½‘ï¼Œå…¶ä¸»è¦çš„æ€è·¯å°±æ˜¯åˆ©ç”¨AIç­‰æ•°å­—æŠ€æœ¯æ¨åŠ¨ä¼ ç»Ÿäº§ä¸šçš„è½¬å‹å‡çº§ã€‚å…¶ä¸­ï¼Œç™¾åº¦åœ¨äº¤é€šã€èƒ½æºã€æ•™è‚²ç­‰é¢†åŸŸçš„æ•°å­—æŠ€æœ¯æ–¹é¢æ¯”è¾ƒæœ‰ä¼˜åŠ¿ã€‚</p><p>ç™¾åº¦åœ¨AIé¢†åŸŸçš„ä¼˜åŠ¿åœ¨äºå®ƒå¸ƒå±€å¾ˆæ—©ã€‚ä»2017å¹´èµ·ï¼ŒAIä½œä¸ºç™¾åº¦æ–°çš„é©±åŠ¨å¼•æ“ï¼Œé€æ¸æ·±å…¥å…¶å„é¡¹ä¸šåŠ¡ä¸­ï¼Œæ— è®ºæ˜¯æœç´¢ã€å†…å®¹åˆ†å‘ï¼Œè¿˜æ˜¯æ™ºèƒ½é©¾é©¶ã€åŒ»ç–—ç­‰ï¼Œéƒ½æ‰“ä¸Šäº†AIçš„çƒ™å°ã€‚åŸºäºåºå¤§çš„ç”¨æˆ·æ•°æ®èƒ½å¤Ÿè®©ç™¾åº¦åœ¨AIç®—æ³•ä¸Šå é¢†ä¼˜åŠ¿ï¼Œå› æ­¤ç™¾åº¦ä¸€ç›´åœ¨ä¸æ–­åŠ ç åŸºç¡€è®¾æ–½å»ºè®¾ï¼Œä¸æ–­æŠ•èµ„äººå·¥æ™ºèƒ½åŸºç¡€æŠ€æœ¯ã€‚ç™¾åº¦åœ¨ä¸­å›½å»ºç«‹äº†åå‡ ä¸ªäº‘è®¡ç®—ä¸­å¿ƒï¼Œå¹¶æŠ•èµ„äº†40åƒå…†äº¤æ¢æœºï¼Œä¸ºäººå·¥æ™ºèƒ½æŠ€æœ¯å’Œå­˜å‚¨æä¾›é‡è¦æ”¯æŒã€‚â€œç™¾åº¦å¤§è„‘â€çš„å‚æ•°è§„æ¨¡å·²ç»è¾¾åˆ°ç™¾äº¿çº§ï¼Œåˆ›é€ äº†ä¸–ç•Œä¸Šæœ€å¤§çš„æ·±åº¦ç¥ç»ç½‘ç»œã€‚</p><p>ä¸­å›½ä¸“åˆ©ä¿æŠ¤åä¼šå‘å¸ƒçš„ã€Šäººå·¥æ™ºèƒ½æŠ€æœ¯ä¸“åˆ©æ·±åº¦åˆ†ææŠ¥å‘Šã€‹æ˜¾ç¤ºï¼Œ2019å¹´ç™¾åº¦ä»¥2368ä»¶çš„AIä¸“åˆ©ç”³è¯·é‡åœ¨å›½å†…ä½å±…ç¬¬ä¸€ï¼Œæ˜¯è…¾è®¯çš„2å€ï¼Œé˜¿é‡Œå·´å·´çš„3å€ä»¥ä¸Šã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img.36krcdn.com/20200624/v2_af6955ea361f43e4bbf73c462cebffb9_img_000" alt="ç™¾åº¦åœ¨AIé¢†åŸŸçš„å¸ƒå±€"></p><p>ç™¾åº¦è¿˜é€šè¿‡æŠ•èµ„åœ¨æ³›äº’è”ç½‘å’ŒAIä¼ä¸šï¼Œè¥é€ AIçš„äº§ä¸šç”Ÿæ€ã€‚å…¶ä¸­ï¼Œ2016 å¹´ 9 æœˆï¼Œç™¾åº¦æˆç«‹ç™¾åº¦é£æŠ•ï¼ŒåŸºé‡‘è§„æ¨¡è¶…è¿‡ 30 äº¿äººæ°‘å¸ï¼Œä¸“æ³¨äºæŠ•èµ„äººå·¥æ™ºèƒ½é¢†åŸŸçš„æ—©æœŸé¡¹ç›®ï¼›2016 å¹´ 10 æœˆï¼Œç™¾åº¦æˆç«‹ç™¾åº¦èµ„æœ¬ï¼ŒåŸºé‡‘è§„æ¨¡ 200 äº¿äººæ°‘å¸ï¼ŒæŠ•èµ„äºæ³›äº’è”ç½‘é¢†åŸŸä¸­åæœŸé¡¹ç›®ã€‚2018å¹´4æœˆï¼Œç™¾åº¦è¿˜æˆç«‹äº†é•¿æˆåŸºé‡‘ï¼Œå‡ºèµ„é¢ä¸º5äº¿ç¾å…ƒï¼ŒæŠ•èµ„æ³›äº’è”ç½‘å’Œäººå·¥æ™ºèƒ½é¢†åŸŸçš„åˆ›æ–°ä¼ä¸šã€‚</p><p>ç™¾åº¦ä¸€ç›´åœ¨ç”¨AIæ€ç»´çœ‹å‡ºè¡Œï¼Œå›´ç»•äººå’Œè½¦ï¼Œç™¾åº¦åˆ†åˆ«æ¨å‡ºäº†å¯¹è¯å¼äººå·¥æ™ºèƒ½ç³»ç»ŸDuerOSã€è‡ªåŠ¨é©¾é©¶æ±½è½¦å¹³å°Apolloå’Œç™¾åº¦äº‘ï¼Œè¿™ä¹Ÿæ˜¯ç™¾åº¦äººå·¥æ™ºèƒ½å•†ä¸šåŒ–çš„é‡è¦éƒ¨åˆ†ã€‚åœ¨ç™¾åº¦çš„æŠ•èµ„ç‰ˆå›¾ä¸­ï¼Œäº¤é€šå‡ºè¡Œé¢†åŸŸä¸€ç›´éƒ½æ·±å¾—ç™¾åº¦é’çï¼Œç™¾åº¦æŠ•èµ„äº†é•¿æ²™æ™ºèƒ½é©¾é©¶ç ”ç©¶é™¢ã€VisualThreatã€<a href="https://36kr.com/projectDetails/5263" target="_blank" rel="noopener">ç¯å®‡æ™ºè¡Œ</a>ã€Lunewaveç­‰å‡ºè¡Œé¢†åŸŸç›¸å…³çš„é¡¹ç›®ã€‚ç™¾åº¦åœ¨æ•™è‚²é¢†åŸŸçš„æŠ•èµ„ä¹Ÿé€éœ²ç€AIæ€ç»´ï¼Œæ¯”å¦‚ç™¾æ€ç¼–ç¨‹ã€<a href="https://36kr.com/projectDetails/123796" target="_blank" rel="noopener">æµ·è±šæ€ç»´</a>å’ŒSnark AIç­‰é¡¹ç›®ã€‚</p><p>ä»å¸‚å€¼èµ°åŠ¿æ¥çœ‹ï¼Œç™¾åº¦åœ¨æ™ºèƒ½é©¾é©¶å’Œè½¦è”ç½‘æ–¹é¢æ‹¥æœ‰è¾ƒå¤§çš„æƒ³è±¡ç©ºé—´ã€‚åŒæ¯”è‡ªåŠ¨é©¾é©¶ä¼ä¸šWaymoï¼Œå®ƒåœ¨ä¸Šä¸€è½®èèµ„ä¼°å€¼å°±æœ‰ 300 äº¿ç¾é‡‘ï¼Œè¿™è¯´<a href="https://36kr.com/projectDetails/78900" target="_blank" rel="noopener">æ˜æŠ•</a>èµ„è€…å¯¹è¿™ä¸ªé¢†åŸŸéå¸¸çœ‹å¥½ã€‚ç™¾åº¦æ‹¥æœ‰å…¨çƒé¢†å…ˆçš„è‡ªåŠ¨é©¾é©¶å¼€æ”¾å¹³å°å’Œå›½å†…é¢†å…ˆçš„è½¦è”ç½‘ï¼Œç›®å‰ 60 è½¦å‚çš„400 æ¬¾è½¦å‹æœ‰æ­è½½ç™¾åº¦çš„ç³»ç»Ÿï¼Œæ— è®ºæ˜¯æŠ€æœ¯è¿˜æ˜¯å¸‚åœºå½±å“åŠ›è¦è¶…è¿‡äº†Waymoï¼Œä½“ç°åœ¨èµ„æœ¬å¸‚åœºçš„ä¼°å€¼æ–¹é¢ï¼Œä¹Ÿåº”è¯¥ä¼šæœ‰æ¯”è¾ƒå¤§çš„æƒ³è±¡ç©ºé—´ã€‚</p><p>åœ¨2018å¹´çš„AIå¼€å‘è€…å¤§ä¼šä¸Šï¼Œæ¥è‡ªå…¨çƒçš„7000å¤šä½AIå¼€å‘è€…å’Œçˆ±å¥½è€…è§è¯äº†ç™¾åº¦åœ¨AIé¢†åŸŸçš„å‘å±•ï¼šäº‘ç«¯å…¨åŠŸèƒ½AIèŠ¯ç‰‡â€œæ˜†ä»‘â€ã€ç™¾åº¦å¤§è„‘3.0ã€ç™¾åº¦æ™ºèƒ½å°ç¨‹åºã€DuerOS 3.0å¼€æ”¾å¹³å°ã€Apollo3.0å¼€æ”¾å¹³å°ã€ARä»¿çœŸç­‰ã€‚ç”±æ­¤å¯è§ï¼Œåœ¨ç™¾åº¦ä¸€ä¸ªå…¨äº§ä¸šé“¾é«˜åº¦å¼€æ”¾çš„ç”Ÿæ€ç³»ç»Ÿå·²ç„¶æˆå‹ï¼Œå¸‚åœºä¹Ÿè¶Šæ¥è¶Šæˆç†Ÿäº†ã€‚</p><p>åœ¨ç™¾åº¦çš„è´¢æŠ¥ä¸­å¯èƒ½çœ‹åˆ°è¿™ç§å˜åŒ–ï¼ŒåŸºäºAIä¸šåŠ¡çš„æ”¶å…¥ä¹Ÿå¢é•¿è¿…é€Ÿï¼Œä»2017å¹´çš„117äº¿å¢åŠ åˆ°2019å¹´çš„293äº¿äººæ°‘å¸ï¼Œå¢å¹…è¶…è¿‡150%ã€‚2020å¹´å…¨çƒé­é‡æ–°å† è‚ºç‚ç–«æƒ…ï¼Œå¯¼è‡´ç™¾åº¦çš„åœ¨çº¿å¹¿å‘Šæ”¶å…¥å’Œå»å¹´åŒæ¯”ä¸‹æ»‘äº†19%ï¼Œä½†ä»¥AIä¸ºä¸»çš„å…¶ä»–ä¸šåŠ¡æ”¶å…¥åˆ™é€†å¸‚å¢é•¿äº†28%ã€‚æ­¤æ¶ˆå½¼é•¿ï¼Œç›¸ä¿¡ä¸ä¼šè¶…è¿‡å‡ å¹´ï¼Œç™¾åº¦åœ¨AIé¢†åŸŸçš„æ”¶å…¥å°±ä¼šè¶…è¿‡ç§»åŠ¨ç‰ˆå›¾çš„æ”¶å…¥ï¼Œä»è€Œæˆä¸ºä¸€ä¸ªä»¥AIä¸ºä¸»å¯¼çš„å…¬å¸ã€‚</p><h2 id="04ã€å¦‚ä½•å°†æŠ€æœ¯ä¼˜åŠ¿è½¬åŒ–ä¸ºå¸‚åœºè¡¨ç°ï¼Ÿ"><a href="#04ã€å¦‚ä½•å°†æŠ€æœ¯ä¼˜åŠ¿è½¬åŒ–ä¸ºå¸‚åœºè¡¨ç°ï¼Ÿ" class="headerlink" title="04ã€å¦‚ä½•å°†æŠ€æœ¯ä¼˜åŠ¿è½¬åŒ–ä¸ºå¸‚åœºè¡¨ç°ï¼Ÿ"></a>04ã€å¦‚ä½•å°†æŠ€æœ¯ä¼˜åŠ¿è½¬åŒ–ä¸ºå¸‚åœºè¡¨ç°ï¼Ÿ</h2><p>é€šè¿‡ä¸Šé¢çš„åˆ†ææˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œç™¾åº¦çš„åœ¨ç§»åŠ¨æ¿å—çš„ä¸šåŠ¡å¸ƒå±€å®Œæ•´ï¼Œæ”¶å…¥å¢é•¿ä¹Ÿç›¸å¯¹ç¨³å¥ï¼›åœ¨AIé¢†åŸŸçš„æŠ€æœ¯ç§¯ç´¯æœ‰ä¼˜åŠ¿ï¼Œæ‰€åœ¨èµ›é“æœªæ¥æœ‰å¾ˆå¤§çš„å¢é•¿æ½œåŠ›ã€‚ä»2017å¹´åˆ°ç°åœ¨ï¼Œç™¾åº¦åœ¨ç ”å‘æ–¹é¢çš„æŠ•å…¥åˆè®¡è¶…è¿‡500äº¿äººæ°‘å¸ï¼Œåœ¨ç§»åŠ¨ç”Ÿæ€å’ŒAIé¢†åŸŸçš„æŠ•èµ„åŠ èµ·æ¥çš„æŠ•èµ„è¶…è¿‡äº†300äº¿äººæ°‘å¸ã€‚ä»è´¢æŠ¥æ¥çœ‹ï¼Œç™¾åº¦åœ¨AIé¢†åŸŸçš„æ”¶å…¥åœ¨å¿«é€Ÿå¢é•¿ï¼Œä¹Ÿè¯æ˜æˆ˜ç•¥æ–¹å‘ä¸Šæ˜¯æ­£ç¡®çš„ã€‚</p><p>ä¸è¿‡ï¼Œè¦æŠŠæŠ€æœ¯ä¼˜åŠ¿è½¬åŒ–ä¸ºå¸‚åœºæˆæœï¼Œè¦æŠŠç ”å‘æŠ•å…¥å’ŒæŠ•èµ„è½¬åŒ–ä¸ºè´¢åŠ¡æ•°æ®ï¼Œå¹¶æœ€ç»ˆåœ¨èµ„æœ¬å¸‚åœºä¸Šä½“ç°ä¸ºå¸‚å€¼å¢é•¿ï¼Œç™¾åº¦è¿˜éœ€è¦åœ¨ç»„ç»‡ã€äººæ‰ã€è¿è¥ã€ç®¡ç†æ–¹é¢æŒç»­ä¼˜åŒ–ï¼Œç¡®ä¿æˆ˜ç•¥èƒ½å¤Ÿè½åœ°ã€‚</p><p>æ ¹æ®<a href="https://36kr.com/projectDetails/442969" target="_blank" rel="noopener">ç½—ä¼¯ç‰¹</a>Â·å¡æ™®å…°å’Œæˆ´ç»´Â·è¯ºé¡¿æå‡ºçš„æˆ˜ç•¥åœ°å›¾æ¨¡å‹ï¼Œä¸€å®¶å…¬å¸çš„é•¿æœŸè‚¡ä¸œä»·å€¼æœ€ç›´æ¥çš„åŸå› æ˜¯è´¢åŠ¡è¡¨ç°ï¼ŒåŒ…æ‹¬è¯´æ”¶å…¥ã€åˆ©æ¶¦ã€ç°é‡‘æµå’ŒæŠ•èµ„å›æŠ¥ç‡ç­‰ï¼Œä½†è´¢åŠ¡è¡¨ç°å¾€å¾€æ˜¯ç”±å®¢æˆ·ä»·å€¼å†³å®šçš„ï¼ŒåŒ…æ‹¬å…¬å¸çš„äº§å“ã€æœåŠ¡ã€å“ç‰Œç­‰ã€‚è€Œæ”¯æŒå®¢æˆ·ä»·å€¼çš„åˆ™æ˜¯å…¬å¸å†…éƒ¨è¿è¥ï¼ŒåŒ…æ‹¬åˆ›æ–°ã€è¿è¥ç®¡ç†å’Œå®¢æˆ·ç®¡ç†ã€‚åœ¨è¿™ä¸ªåŸºç¡€ä¸‹é¢ï¼Œåˆ™æ˜¯å…¬å¸çš„äººåŠ›èµ„æœ¬å’Œç»„ç»‡èµ„æœ¬ï¼Œä»¥åŠä¼ä¸šçš„é¢†å¯¼åŠ›ã€ä»·å€¼è§‚å’Œä¼ä¸šæ–‡åŒ–ç­‰ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img.36krcdn.com/20200624/v2_503efc82a5d34313aecd4f943b4f245b_img_000" alt="æˆ˜ç•¥åœ°å›¾æ¡†æ¶"></p><p>ç™¾åº¦è¦é¢ä¸´çš„ç¬¬ä¸€ä¸ªæŒ‘æˆ˜æ˜¯åœ¨äº§å“å’Œè¿è¥æ–¹é¢çš„ä¼˜åŒ–ã€‚ä¸šå†…æµä¼ è¿™æ ·ä¸€å¥è¯ï¼šç™¾åº¦çš„æŠ€æœ¯ã€è…¾è®¯çš„äº§å“å’Œé˜¿é‡Œçš„è¿è¥ã€‚è¿™å¥è¯æœªå¿…éå¸¸ç²¾ç¡®ï¼Œä½†ç¡®å®ä¹Ÿèƒ½åæ˜ ä¸€äº›é—®é¢˜ï¼Œé‚£å°±æ˜¯ç™¾åº¦éª¨å­é‡Œæ˜¯ä¸€å®¶æŠ€æœ¯å…¬å¸ï¼Œåœ¨æŠ€æœ¯æ–¹é¢å­˜åœ¨ä¼˜åŠ¿ï¼Œä½†åœ¨äº§å“å’Œè¿è¥æ–¹é¢è¿˜å­˜åœ¨è¯¸å¤šä¸è¶³ã€‚ç›¸å½“é•¿çš„æ—¶é—´é‡Œï¼Œç™¾åº¦çš„æ ¸å¿ƒä¸šåŠ¡æ˜¯æœç´¢å¼•æ“ï¼Œä¸»è¦é’ˆå¯¹çš„å®¢æˆ·æ˜¯ä¸ªäººï¼Œè¿™ç§å•†ä¸šæ¨¡å¼å†³å®šäº†ç™¾åº¦ä¼šæŠŠæ›´å¤šç²¾åŠ›æ”¾åœ¨æŠ€æœ¯åˆ›æ–°ä¸Šï¼Œè€Œä¸éœ€è¦åœ¨äº§å“æ‰“ç£¨å’Œè¿è¥æ–¹é¢èŠ±å¤ªå¤šç²¾åŠ›ï¼Œä¹…è€Œä¹…ä¹‹ä¹Ÿå°±å¡‘é€ äº†ç™¾åº¦çš„ç»„ç»‡èƒ½åŠ›å’Œä¼ä¸šæ–‡åŒ–ã€‚</p><p>ç°åœ¨ç™¾åº¦çš„å•†ä¸šæ¨¡å¼éœ€è¦å®ƒåœ¨å†…å®¹å’ŒAIæ–¹é¢å‘åŠ›ã€‚å†…å®¹ä¸»è¦é’ˆå¯¹ä¸ªäººå®¢æˆ·ï¼Œå¯¹äº§å“èƒ½åŠ›è¦æ±‚å¾ˆé«˜ï¼Œè¿™æ˜¯è…¾è®¯æ¯”è¾ƒå¼ºçš„åœ°æ–¹ï¼›AIä¸»è¦é’ˆå¯¹ä¼ä¸šå®¢æˆ·ï¼Œå¯¹è¿è¥èƒ½åŠ›è¦æ±‚å¾ˆé«˜ï¼Œè¿™æ˜¯é˜¿é‡Œå·´å·´æ¯”è¾ƒå¼ºçš„åœ°æ–¹ã€‚ç™¾åº¦åœ¨AIé¢†åŸŸçš„ä¸“åˆ©æ•°é‡æ¯”é˜¿é‡Œå·´å·´å’Œè…¾è®¯éƒ½è¦é¢†å…ˆï¼Œä½†åœ¨AIé¢†åŸŸçš„å¸‚åœºè¡¨ç°è¿˜æ²¡æœ‰å®Œå…¨è¿¸å‘å‡ºæ¥ï¼Œä¹Ÿè¯´æ˜ç™¾åº¦åœ¨äº§å“å’Œè¿è¥èƒ½åŠ›æ–¹é¢éœ€è¦åŠ å¼ºã€‚å¦‚æœç™¾åº¦è¦èµ¢å¾—ç«äº‰ï¼Œå°±éœ€è¦å¼ºåŒ–è‡ªå·±è¿™ä¸¤æ–¹é¢çš„ç»„ç»‡èƒ½åŠ›ã€‚</p><p>ç»„ç»‡èƒ½åŠ›èƒŒåæ˜¯ä¼ä¸šçš„äººåŠ›èµ„æœ¬ã€‚ç™¾åº¦è¿™äº›å¹´å¢é•¿ä¹åŠ›ï¼Œç»™äººçš„æ„Ÿè§‰è¿˜æ˜¯ç™¾åº¦å¯¹ä¼˜ç§€äººæ‰çš„å¸å¼•åŠ›ä¸å¤Ÿã€‚æˆ‘æ›¾ç»å¬è¿‡ç™¾åº¦å†…éƒ¨ç®¡ç†è€…çš„è§£é‡Šï¼Œå¤§æ„æ˜¯æŠ€æœ¯äººæ‰å¯¹å¹³å°çš„ä¾èµ–ç¨‹åº¦ä¸å¦‚äº§å“ç®¡ç†è€…å’Œè¿è¥ç®¡ç†è€…ï¼Œä»–ä»¬æ›´å®¹æ˜“è·³æ§½åˆ°å¦ä¸€ä¸ªå¹³å°ï¼Œæˆ–è€…è·å¾—æŠ•èµ„æ–¹çš„æ”¯æŒå»åˆ›ä¸šã€‚è¿™ä¸ªç†ç”±ä¹Ÿèƒ½è‡ªåœ†å…¶è¯´ï¼Œä½†ä¹Ÿä¸èƒ½æ©ç›–ç™¾åº¦åœ¨äººæ‰å¸å¼•å’Œæ¿€åŠ±æ–¹é¢çš„é—®é¢˜ã€‚æ¯”å¦‚é™†å¥‡å’Œå¼ äºšå‹¤éƒ½æ›¾ç»åšè¿‡å¾®è½¯çš„å…¨çƒå‰¯æ€»è£ï¼Œåˆ°ç™¾åº¦ä¹‹åæ²¡æœ‰å‘æŒ¥æœŸæœ›ä¸­çš„ä»·å€¼ï¼Œä»–ä»¬çš„ç¦»èŒå¤„ç†å¾—å¾ˆä½“é¢ï¼Œä½†è¿˜æ˜¯è®©äººæ„Ÿè§‰ç•¥æœ‰é—æ†¾ã€‚</p><p>æˆ˜ç•¥å’Œç»„ç»‡ç›¸äº’å½±å“ï¼Œå†å¥½çš„æˆ˜ç•¥å¦‚æœæ²¡æœ‰å’Œæˆ˜ç•¥åŒ¹é…çš„ç»„ç»‡èƒ½åŠ›ä¹Ÿå¾ˆéš¾è½åœ°ï¼Œè€Œç»„ç»‡èƒ½åŠ›çš„æ ¸å¿ƒæ˜¯é«˜ç»©æ•ˆçš„ç®¡ç†è€…ã€‚æ¯”å¦‚è¯´ï¼Œç™¾åº¦çœ‹åˆ°äº†O2Oé¢†åŸŸçš„å·¨å¤§æ½œåŠ›ï¼ŒæŠ•ä»¥å‡ ç™¾äº¿äººæ°‘å¸ï¼Œæœ€åæƒ¨æ·¡æ”¶åœºã€‚ä»èµ›é“é€‰æ‹©æ¥çœ‹ï¼Œç™¾åº¦çš„æˆ˜ç•¥åˆ¤æ–­å¹¶æ²¡æœ‰é”™ï¼Œç¾å›¢ç°åœ¨çš„æˆåŠŸè¯æ˜äº†è¿™ä¸€ç‚¹ã€‚ç™¾åº¦åœ¨ç³¯ç±³é¡¹ç›®ä¸Šçš„å¤±è´¥å’Œç¼ºä¹ç›¸å…³é¢†å†›äººæ‰æœ‰å¾ˆå¤§çš„å…³ç³»ï¼Œå› ä¸ºO2Oå¯¹è¿è¥çš„è¦æ±‚éå¸¸é«˜ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªé¢†åŸŸçš„é¢†å†›äººæ‰ï¼Œå†å¥½çš„æˆ˜ç•¥ä¹Ÿæ— æ³•è½åœ°ã€‚</p><p>è¯´åˆ°é¢†å¯¼æ¢¯é˜Ÿï¼Œè¿˜æ˜¯å¿ä¸ä½è¦æ‹¿ç™¾åº¦å’Œé˜¿é‡Œå·´å·´å’Œè…¾è®¯å¯¹æ¯”ã€‚é©¬äº‘å·²ç»é€€ä¼‘äº†ï¼Œé©¬åŒ–è…¾ä¹Ÿå¾ˆå°‘éœ²é¢ï¼Œä½†è¿™æ¯«ä¸å½±å“ä»–ä»¬ä¸šåŠ¡çš„å¢é•¿ï¼Œä¸€ä¸ªå¾ˆé‡è¦çš„åŸå› å°±æ˜¯è¿™ä¸¤å®¶å…¬å¸éƒ½æœ‰â€œè‰¯å°†å¦‚æ½®â€çš„é¢†å¯¼æ¢¯é˜Ÿï¼Œè€Œè¿™äº›é¢†å¯¼äººæ‰å¤§éƒ½æ˜¯å†…éƒ¨åŸ¹å…»å‡ºæ¥çš„ï¼ŒèƒŒåæœ‰ä¸€ä¸ªå®Œå–„çš„äººæ‰åŸ¹å…»ã€é€‰æ‹”å’Œæ¿€åŠ±æœºåˆ¶ã€‚ä½†åœ¨å¾ˆé•¿ä¸€æ®µæ—¶é—´é‡Œï¼Œç™¾åº¦ä¼¼ä¹æ›´é’çå¤–éƒ¨çš„æ˜æ˜Ÿç»ç†äººï¼Œæ›´æ„¿æ„ç”¨é«˜è–ªå»å¸å¼•äººæ‰ï¼Œè€Œä¸å¤ªæ„¿æ„åŸ¹å…»å’Œææ‹”å†…éƒ¨ç®¡ç†è€…ï¼Œå¯¼è‡´ç™¾åº¦å†…éƒ¨çš„é«˜æ½œäººæ‰å‡ºä¸æ¥ï¼Œä¹…è€Œä¹…ä¹‹å°±æ²¡æœ‰å½¢æˆä¸€ä¸ªâ€œè‰¯å°†å¦‚æ½®â€çš„é¢†å¯¼æ¢¯é˜Ÿã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œç™¾åº¦çš„æˆ˜ç•¥ä¸Šæœ‰å¾ˆå¥½çš„å¸ƒå±€ï¼Œè€Œä¸”åœ¨æŠ€æœ¯ç§¯ç´¯æ–¹é¢æœ‰ä¸€å®šçš„ä¼˜åŠ¿ï¼Œä½†æƒ³è¦æŠŠæŠ€æœ¯ä¼˜åŠ¿è½¬åŒ–ä¸ºå¸‚åœºä¼˜åŠ¿ï¼Œå°±å¿…é¡»åœ¨ç»„ç»‡èƒ½åŠ›å’Œä¼ä¸šæ–‡åŒ–æ–¹é¢åšå‡ºè½¬å˜ï¼Œè¿™æ˜¯ç™¾åº¦è¦é¢ä¸´çš„æŒ‘æˆ˜ã€‚</p><h2 id="05ã€ç™¾åº¦æ­£åœ¨å¼€å§‹æ–°çš„é•¿å¾"><a href="#05ã€ç™¾åº¦æ­£åœ¨å¼€å§‹æ–°çš„é•¿å¾" class="headerlink" title="05ã€ç™¾åº¦æ­£åœ¨å¼€å§‹æ–°çš„é•¿å¾"></a>05ã€ç™¾åº¦æ­£åœ¨å¼€å§‹æ–°çš„é•¿å¾</h2><p>å¥½æ¶ˆæ¯æ˜¯ï¼Œç™¾åº¦æ­£åœ¨å‘ç”Ÿç§¯æçš„å˜åŒ–ã€‚åˆ†æç™¾åº¦åœ¨2019å¹´å¼€å§‹çš„å˜åŒ–ï¼Œæˆ‘ä»¬å‘ç°ç™¾åº¦åœ¨ç»„ç»‡æ„æ¶ã€äººæ‰ç»“æ„å’Œä¼ä¸šæ–‡åŒ–æ–¹é¢éƒ½åœ¨åšå‡ºå¤§å¹…è°ƒæ•´ï¼Œè¿™ç§è°ƒæ•´äº§ç”Ÿçš„ç§¯ææ•ˆæœä¹Ÿå¼€å§‹åˆæ­¥æ˜¾ç°å‡ºæ¥ã€‚</p><p>2019å¹´1æœˆ17æ—¥ï¼Œæå½¦å®å‘å…¨å‘˜é‚®ä»¶ï¼Œå‘å¸ƒç™¾åº¦çš„æ–°æ„¿æ™¯ï¼šâ€œä»Šå¤©ï¼Œæˆ‘ä»¬æŠŠè¿™æ ·çš„æ€è€ƒã€è¿™æ ·çš„è®¤è¯†æ˜ç¡®ä¸ºå…¬å¸çš„æ„¿æ™¯ï¼Œé‚£å°±æ˜¯ï¼šæˆä¸ºæœ€æ‡‚ç”¨æˆ·ï¼Œå¹¶èƒ½å¸®åŠ©äººä»¬æˆé•¿çš„å…¨çƒé¡¶çº§é«˜ç§‘æŠ€å…¬å¸ã€‚è¿™æ˜¯ç™¾åº¦å†å²ä¸Šé¦–æ¬¡å‘å¸ƒæ„¿æ™¯ï¼Œè¿™24ä¸ªå­—å°†ä¸Šæ‰¿æ–°ä½¿å‘½ã€ä¸‹å±•å…¬å¸â€˜å¤¯å®ç§»åŠ¨åŸºç¡€ã€å†³èƒœAIæ—¶ä»£â€™çš„æ•´ä½“æˆ˜ç•¥ï¼Œé”šå®šç™¾åº¦åœ¨æœªæ¥çš„æ–°åæ ‡â€”â€”ä¸ä»…æ˜¯èšç„¦ç”¨æˆ·ã€æˆå°±ä»–äººçš„ç™¾åº¦ï¼Œä¹Ÿæ˜¯ç«‹è¶³å…¨çƒã€æœ‰æ‰€ä½œä¸ºçš„ç™¾åº¦ï¼â€</p><p>éšåä¸ä¹…ï¼Œç™¾åº¦å¼€å§‹äº†åœ¨ç»„ç»‡æ„æ¶å’Œäººæ‰æ–¹é¢çš„å¤§å¹…è°ƒæ•´ã€‚2019å¹´5æœˆ17æ—¥ï¼Œç™¾åº¦å‘å¸ƒ2019å¹´ç¬¬ä¸€å­£åº¦è´¢æŠ¥ï¼Œè´¢æŠ¥æ˜¾ç¤ºå…¶é­é‡äº†ä¸Šå¸‚ä»¥æ¥çš„é¦–ä¸ªå­£åº¦äºæŸï¼ŒåŒæ—¶è¿˜å®£å¸ƒäº†ç™¾åº¦é«˜çº§å‰¯æ€»è£ã€æœç´¢å…¬å¸æ€»è£å‘æµ·é¾™è¾èŒçš„æ¶ˆæ¯ï¼Œä»¥åŠå°†ç™¾åº¦æœç´¢å…¬å¸å·²æ”¹ç»„â€œç§»åŠ¨ç”Ÿæ€äº‹ä¸šç¾¤â€ï¼ˆç®€ç§°MEGï¼‰ã€‚å‘æµ·é¾™ä½œä¸ºç™¾åº¦æ ¸å¿ƒä¸šåŠ¡çš„è´Ÿè´£äººï¼Œæ›¾ç»ä¸€åº¦è¢«è®¤ä¸ºâ€œæœ€ä¸å¯èƒ½åŠ¨â€çš„äººã€‚å‘æµ·é¾™çš„ç¦»èŒæ˜¯ä¸€ä¸ªæ ‡å¿—æ€§äº‹ä»¶ï¼Œæ„å‘³ç€ç™¾åº¦å¼€å§‹å¤§å¹…è°ƒæ•´é«˜ç®¡ã€‚</p><p>äººäº‹å˜åŠ¨å¾€å¾€è¡¨æ˜äº†å…¬å¸åœ¨å‘å±•æ€åº¦ä¸Šçš„æ”¹å˜ã€‚2019å¹´ï¼Œé€šè¿‡å¯†é›†çš„è°ƒå…µé£å°†ï¼Œç™¾åº¦å½¢æˆäº†1ï¼ˆæå½¦å®ï¼‰+15 ï¼ˆVPä»¥ä¸Šé«˜ç®¡ï¼‰çš„æ–°å†³ç­–å±‚ã€‚æ ¹æ®<a href="https://36kr.com/projectDetails/29820" target="_blank" rel="noopener">çŒäº‘ç½‘</a>çš„æ¢³ç†ï¼Œè¿™15ä½é«˜ç®¡ä¸­æœ‰12åæ˜¯æ–°æ™‹é«˜ç®¡ï¼Œå…¶ä¸­5ä½æ¥è‡ªå†…éƒ¨æ™‹å‡ï¼Œ3ä½å…ƒè€å›å½’ï¼Œ4ä½å¤–éƒ¨å¼•è¿›ï¼Œè¿™12ä¸ªäººéƒ½æ˜¯75å-85åï¼Œå¹³å‡åœ¨ç™¾åº¦æœåŠ¡æ—¶é—´ä¸º8å¹´ã€‚ç™¾åº¦ç»„å»ºäº†è¿‘5å¹´æ¥æœ€å¹´è½»çš„é«˜ç®¡å›¢é˜Ÿã€‚</p><p>å°±åœ¨2019å¹´5æœˆ17å·æå½¦å®ä¸ç™¾åº¦MEGç®¡ç†å±‚çš„æ²Ÿé€šä¼šä¸Šï¼Œæå½¦å®è¿˜æå‡ºäº†ä¸‰ç‚¹æ–°çš„è¦æ±‚ï¼šç¬¬ä¸€ã€ç¡®ä¿å…¬å¸å½»åº•é€æ˜ï¼Œå¿…é¡»è¯´å®è¯ï¼Œå¿…é¡»ä¿¡æ¯é€æ˜ï¼Œç»å¯¹ä¸èƒ½æ¬ºä¸Šç’ä¸‹ï¼›ç¬¬äºŒã€é‡æ–°è¯„ä¼°çº¦å®šä¿—æˆçš„ä¸€äº›åšæ³•ï¼Œæ‰¾åˆ°æ–°çš„æœºä¼šï¼Œæ‰æœ‰åˆ›æ–°çš„ç©ºé—´ï¼Œæ‰èƒ½å¤Ÿæ¯”ä»¥å‰åšå¾—æ›´å¥½ï¼›ç¬¬ä¸‰ã€è°å—ç›Šã€è°æ¨åŠ¨ï¼Œè§£å†³ä¸äº†å¾€ä¸ŠæŠ¥ã€‚æœ‰äº›äº‹æƒ…ï¼Œé ä¸€ä¸ªäººçš„åŠ›é‡å®Œä¸æˆï¼Œåˆ«äººåˆä¸åŒæ„ä½ ï¼Œé‚£å°±æŠŠè¿™ä»¶äº‹æƒ…åé¦ˆåˆ°ä¸¤ä¸ªäººçš„å…±åŒè€æ¿é‚£é‡Œï¼Œè®©ä»–æ¥åšè¿™ä¸ªå†³ç­–ï¼Œåˆ°åº•è¡Œè¿˜æ˜¯ä¸è¡Œã€‚è¿™ä¸‰ç‚¹è¦æ±‚è¯´æ˜ç™¾åº¦åœ¨ä¼ä¸šæ–‡åŒ–æ–¹é¢å¼€å§‹é‡ç‚¹è°ƒæ•´ã€‚</p><p>ä¼ä¸šæ–‡åŒ–å»ºè®¾æ˜¯HRéƒ¨é—¨çš„å·¥ä½œï¼Œä½†ç™¾åº¦çš„ä¼ä¸šæ–‡åŒ–å†æ¥æ¯”è¾ƒå¼±ï¼Œå¯¼è‡´ç™¾åº¦ç•™ä¸ä½äººï¼Œå˜æˆâ€œäº’è”ç½‘é»„åŸ”å†›æ ¡â€ã€‚ä¸ºäº†æ”¹å˜ä¼ä¸šæ–‡åŒ–ï¼Œç™¾åº¦æŠŠæ›¾ç»çš„åˆ›ä¸šå…ƒè€å´”çŠçŠè¯·å›æ¥æ‹…ä»»æ–°çš„HRå‰¯æ€»è£ï¼Œå¥¹åœ¨2000å¹´å°±åŠ å…¥ç™¾åº¦ï¼Œå¯¹ç™¾åº¦å¾ˆæœ‰æ„Ÿæƒ…ï¼Œç”¨ç™¾åº¦å†…éƒ¨äººçš„è¯æ¥è¯´å°±æ˜¯â€œä¸€å¿ƒå°±æƒ³è®©ç™¾åº¦å¥½â€ï¼Œç”±å¥¹æ¥æ¨åŠ¨ä¼ä¸šæ–‡åŒ–å˜é©æ­£åˆé€‚ã€‚</p><p>åœ¨2019å¹´7æœˆ11æ—¥ç™¾åº¦å…¬å¸çš„æ€»ç›‘ä¼šä¸Šï¼Œè´Ÿè´£HRçš„å‰¯æ€»è£å´”çŠçŠè®²è¯çš„ä¸»é¢˜å°±æ˜¯ï¼Œâ€œæå‡ç»„ç»‡èƒ½åŠ›ï¼Œå¼€å§‹æ–°çš„é•¿å¾ã€‚â€ï¼Œé¢å¯¹ç™¾åº¦çš„æ ¸å¿ƒç®¡ç†å±‚ï¼Œå´”çŠçŠç›´è¨€ä¸è®³ï¼šâ€œé¢†å†›äººç‰©è¦ä¸ºä¸šç»©è´Ÿè´£ï¼Œé‚£äº›å¹²å¾—ä¸å¥½çš„ã€ä¸å¥½å¥½åšç®¡ç†çš„ã€æŠŠä¸šç»©åšå·®äº†çš„äººï¼Œå°±è¦ä¸ºå·®çš„ä¸šç»©ä¹°å•ã€‚â€</p><p>æ›¾ç»æ‹¯æ•‘è¿‡IBMçš„éƒ­å£«çº³è®¤ä¸ºï¼Œè¦è®©ä¸€å®¶ä¼ä¸šé‡æ–°ç„•å‘æ´»åŠ›ï¼Œç§˜è¯€å°±æ˜¯æ–‡åŒ–å’Œç»©æ•ˆã€‚ç”¨ä»–çš„è¯æ¥è¯´ï¼Œâ€œå…¬å¸æ–‡åŒ–ä¸ä»…ä»…æ˜¯æ¸¸æˆçš„ä¸€ä¸ªæ–¹é¢â€”â€”å®ƒå°±æ˜¯æ¸¸æˆæœ¬èº«â€ï¼Œé‚£ä¹ˆç»©æ•ˆå…¶å®å°±æ˜¯æ¸¸æˆè§„åˆ™ã€‚ä¸ºäº†æ›´å¥½åœ°æ”¹å˜ä¼ä¸šæ–‡åŒ–ï¼Œç™¾åº¦ä¹ŸæŠŠå…¬å¸çš„ç»©æ•ˆè€ƒæ ¸æ–¹æ³•å¿«é€Ÿä»ä¼ ç»Ÿçš„KPIåˆ‡æ¢åˆ°OKRã€‚</p><p>æå½¦å®æ›¾åœ¨é‚®ä»¶é‡Œæ‰¹è¯„äº†å…¬å¸çš„KPIæ–‡åŒ–ï¼šâ€œå¦‚æœä½ ç”¨ä¸€ä¸ªç®€å•çš„æœºæ¢°çš„KPIå¾€ä¸‹åˆ†è§£å’Œä¼ é€’ï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½åˆ°åŸºå±‚åˆ°ä¸€çº¿å‘˜å·¥çš„æ—¶å€™ï¼Œä»–å®Œå…¨ä¸ç†è§£æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦å¹²è¿™ä¸ªäº‹å„¿ã€‚è¿™ä¸ªæ—¶å€™å¦‚æœä»–å¿ƒç›®å½“ä¸­æƒ³çš„ä¸æ˜¯ç”¨æˆ·ä½“éªŒï¼Œæƒ³çš„ä¸æ˜¯å¸‚åœºéœ€æ±‚ï¼Œæƒ³çš„æ˜¯æˆ‘æ€ä¹ˆèƒ½å¤Ÿå®Œæˆè¿™ä¸ªæ•°ï¼Œé‚£è¿™ä¸ªå…¬å¸çœŸçš„æ˜¯æ—¶é—´ä¸€é•¿å°±å®Œè›‹äº†ã€‚â€</p><p>è¿™ç§KPIçš„ç»©æ•ˆè€ƒæ ¸æŒ‡æ ‡å¯¼è‡´äº†å…¬å¸å†…éƒ¨ä¸Šä¸‹ä¸Šä¸‹ä¿¡æ¯ä¸å¯¹ç§°ï¼Œä¸»ç®¡å’Œå‘˜å·¥ä¸èƒ½å¤Ÿæ­£ç¡®åœ°æ²Ÿé€šï¼Œå‘˜å·¥ä¹‹é—´ä¹Ÿéƒ½æ˜¯å„å¹²å„çš„ï¼Œå°‘æœ‰ç›¸äº’çœ‹é½ï¼›ç®¡ç†å±‚ä¸ºäº†è®©æ•°æ®å¥½çœ‹å»ç©å°åŠ¨ä½œï¼Œè€Œä¸”è®©äººæ‰è¯†åˆ«æœ‰é—®é¢˜ã€‚æ›´ä¸¥é‡çš„æ˜¯ï¼Œç”±äºKPIè¿‡äºå¼ºè°ƒå…¬å¸ä¸šç»©ï¼Œä¸ç®¡å®ç°è·¯å¾„æ˜¯ä»€ä¹ˆï¼Œæ˜¯ä¸æ˜¯å¯¹ç”¨æˆ·ä½“éªŒã€å…¬å¸å“ç‰Œæœ‰ä¼¤å®³ï¼Œå¯¼è‡´ä»·å€¼è§‚ä¸¥é‡å˜å½¢ã€‚ç™¾åº¦åœ¨è¿‡å»å‘ç”Ÿè¿‡çš„ä¸€äº›å±æœºï¼Œéƒ½æˆ–å¤šæˆ–å°‘å’Œè¿™ç§KPIå¯¼è‡´çš„ä»·å€¼è§‚å˜å½¢æœ‰å…³ã€‚</p><p>ç™¾åº¦åˆ°ç›®å‰ä¸ºæ­¢æ¨è¡ŒOKRå·²ç»ä¸€å¹´å¤šçš„æ—¶é—´äº†ï¼Œæœ€é‡è¦çš„ä½œç”¨å°±æ˜¯è½å®äº†ä¸Šä¸‹åŒå¿ƒã€‚OKRæ˜¯æ¨ªå‘å’Œçºµå‘éƒ½å¯è§çš„ï¼Œå…¬å¸é‡Œæ¯ä¸ªäººéƒ½çŸ¥é“æå½¦å®çš„OKRæ˜¯ä»€ä¹ˆï¼Œæ€»ç›‘çŸ¥é“VPçš„OKRæ˜¯ä»€ä¹ˆï¼Œå‘˜å·¥çŸ¥é“éƒ¨é—¨é¢†å¯¼çš„OKRæ˜¯ä»€ä¹ˆï¼Œè¿™æ ·å°±èƒ½å¤Ÿè®©å…¬å¸çš„æˆ˜ç•¥ç›®æ ‡å±‚å±‚åµŒå¥—ï¼Œå±‚å±‚å¯¹é½ï¼Œæœ‰åˆ©äºæå‡æ•ˆç‡ï¼Œå‡å°‘èµ„æºæµªè´¹ã€‚</p><h2 id="06ã€è…¾è®¯å’Œå¾®è½¯è½¬å‹ç»™ç™¾åº¦çš„å¯ç¤º"><a href="#06ã€è…¾è®¯å’Œå¾®è½¯è½¬å‹ç»™ç™¾åº¦çš„å¯ç¤º" class="headerlink" title="06ã€è…¾è®¯å’Œå¾®è½¯è½¬å‹ç»™ç™¾åº¦çš„å¯ç¤º"></a>06ã€è…¾è®¯å’Œå¾®è½¯è½¬å‹ç»™ç™¾åº¦çš„å¯ç¤º</h2><p>ä»»ä½•å˜åŒ–éƒ½éœ€è¦ä¸€å®šçš„æ—¶é—´æ‰èƒ½äº§ç”Ÿç»“æœã€‚ç°åœ¨åˆ¤æ–­ç™¾åº¦è½¬å‹æ˜¯å¦æˆåŠŸè¿˜è¨€ä¹‹å¤ªæ—©ã€‚ä½†è§‚å¯ŸåŒç±»å…¬å¸åœ¨ç»å†è¿‡å±æœºä¹‹åçš„è½¬å˜ï¼Œæˆ–è®¸å¯¹ç™¾åº¦çš„æœªæ¥ä¼šæœ‰äº›å¯å‘ã€‚</p><p>ç¬¬ä¸€ä¸ªå€¼å¾—å€Ÿé‰´çš„å…¬å¸æ˜¯è…¾è®¯ã€‚ä¹‹æ‰€ä»¥æ‹¿è…¾è®¯å’Œç™¾åº¦ç›¸æ¯”ï¼Œæ˜¯å› ä¸ºè…¾è®¯ä¹Ÿæ›¾ç»å†è¿‡ä¸¥é‡çš„å£°èª‰å±æœºã€‚2010å¹´çš„â€œ3Qå¤§æˆ˜â€ï¼Œè™½ç„¶å½“æ—¶è…¾è®¯èµ¢äº†é’ˆå¯¹360çš„å®˜å¸ï¼Œä½†å“ç‰Œå½¢è±¡ä¹Ÿå—åˆ°äº†ä¸¥é‡ä¼¤å®³ã€‚è…¾è®¯çš„ä¼ä¸šæ–‡åŒ–ä¸€åº¦å†…å‘ï¼Œä»–ä»¬æŠŠç²¾åŠ›ä¸“æ³¨åœ¨ç”¨æˆ·å’Œäº§å“ä¸Šï¼Œçœ‹åˆ°æœ‰ä»€ä¹ˆäº§å“æµè¡Œå°±æ‹¿æ¥æ¨¡ä»¿ï¼Œç„¶ååˆ©ç”¨è‡ªå·±çš„æµé‡ä¼˜åŠ¿å»ç¢¾å‹å¯¹æ‰‹ã€‚åŒæ—¶ç”±äºè…¾è®¯å’Œå¤–éƒ¨ä¸“å®¶ã€åª’ä½“å’ŒåŒè¡Œéƒ½äº¤æµä¸å¤šï¼Œå¤–éƒ¨å¯¹è…¾è®¯ä¹Ÿå……æ»¡äº†è¯¯è¯»ï¼Œå¯¼è‡´å¸‚åœºå£ç¢‘ä¸å¤ªå¥½ã€‚</p><p>2011å¹´ï¼Œè…¾è®¯ç»„ç»‡äº†ä¸€æ‰¹å¤–éƒ¨ä¸“å®¶â€œè¯Šæ–­è…¾è®¯â€ï¼Œç»™è…¾è®¯æäº†å¾ˆå¤šå°–é”çš„æ„è§ã€‚åœ¨è¿™ç§å¤–éƒ¨åˆºæ¿€ä¹‹ä¸‹ï¼Œè…¾è®¯ä¹Ÿå¼€å§‹å˜å¾—æ›´åŠ å¼€æ”¾èµ·æ¥ã€‚è¿™ç§å¼€æ”¾ä¸åªæ˜¯ä¼ä¸šæ–‡åŒ–çš„å¼€æ”¾ï¼Œåœ¨æˆ˜ç•¥å¸ƒå±€ä¸Šä¹Ÿæ›´åŠ å¼€æ”¾ï¼Œä¸å†åƒä»¥å‰çœ‹åˆ°ä¸€ä¸ªæœºä¼šå°±å»è‡ªå·±å¹²ï¼Œè€Œæ˜¯æŠ•èµ„ä¸šå†…çš„ä¼˜ç§€ä¼ä¸šï¼Œé€šè¿‡ä¸ºä»–ä»¬èµ‹èƒ½æ¥è°‹æ±‚å…±ç”Ÿã€‚åŒæ—¶ï¼Œè…¾è®¯å¼€å§‹ç»„ç»‡ç»“æ„è°ƒæ•´ï¼Œè®©ç»„ç»‡æ›´åŠ åŒ¹é…æˆ˜ç•¥ã€‚åœ¨æ–°çš„ç»„ç»‡æ„æ¶å’Œä¼ä¸šæ–‡åŒ–ä¸‹ï¼Œè…¾è®¯å­µåŒ–å‡ºäº†å¾®ä¿¡ç­‰ç°è±¡çº§äº§å“ï¼Œå¹¶åœ¨2017å¹´å¼€å§‹æ¨å‡ºäº§ä¸šäº’è”ç½‘ã€‚è¿™ä¸€äº›ç³»åˆ—æˆ˜ç•¥å¸ƒå±€å’Œç»„ç»‡å˜é©ï¼Œä¹Ÿè®©è…¾è®¯çš„å¸‚å€¼10å¹´å†…å¢åŠ äº†20å¤šå€ï¼Œæˆä¸ºä¸€å®¶ç”Ÿæ€çº§çš„ä¼ä¸šã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img.36krcdn.com/20200624/v2_7b0e36d940d7420db1f1d1b722401634_img_000" alt="è…¾è®¯è¿‡å»10å¹´çš„è‚¡ä»·å˜è¿å›¾ï¼ˆä¸œæ–¹è´¢å¯Œç½‘ï¼‰"></p><p>å¦ä¸€ä¸ªå€¼å¾—å€Ÿé‰´çš„å…¬å¸æ˜¯å¾®è½¯ã€‚å¾®è½¯æ›¾ç»æ˜¯PCæ—¶ä»£çš„ç‹è€…ï¼Œåœ¨äº’è”ç½‘æ—¶ä»£ä¹Ÿå¸ƒå±€å¾ˆæ—©ï¼Œä½†ä¼¼ä¹ä¸€ç›´æ²¡æœ‰åšå¾—ç‰¹åˆ«å‡ºè‰²ï¼Œä¹Ÿå…ˆåé”™è¿‡äº†æ”¶è´­é›…è™ã€è°·æ­Œå’Œfacebookçš„æœºä¼šï¼Œç”šè‡³æœ‰äººè¯´å¾®è½¯é”™è¿‡äº†äº’è”ç½‘çš„ç«äº‰ã€‚å½“æ—¶å¾®è½¯çš„ä¼ä¸šæ–‡åŒ–ä¹Ÿæ¯”è¾ƒç³Ÿç³•ï¼Œéƒ¨é—¨ä¹‹é—´å†…æ–—å¾—å¾ˆå‰å®³ï¼Œå…¬å¸å†…éƒ¨å£«æ°”ä½è½ï¼Œå¤§é‡ä¼˜ç§€äººæ‰çº·çº·ç¦»å¼€ã€‚åœ¨è¿™æ ·çš„èƒŒæ™¯ä¸‹ï¼Œå¾®è½¯çš„æ”¶å…¥æ­¢æ­¥ä¸å‰ï¼Œè‚¡ä»·ä¹Ÿä¸€è·¯ä¸‹è·Œï¼Œå¸‚å€¼ä¸€åº¦è·Œç ´700äº¿ç¾å…ƒã€‚</p><p>å¹¸è¿çš„æ˜¯ï¼Œå¾®è½¯çœ‹å‡†äº†äº‘è®¡ç®—çš„è¶‹åŠ¿ï¼Œç”±äºè¿™ä¸€å—çš„ä¸šåŠ¡å¢é•¿å¾ˆå¿«ã€‚è´Ÿè´£äº‘è®¡ç®—ä¸šåŠ¡çš„è¨æäºšÂ·çº³å¾·æ‹‰åœ¨2014å¹´æ‹…ä»»å¾®è½¯æ–°ä»»CEOã€‚è¨æäºšÂ·çº³å¾·æ‹‰æ‹…ä»»å¾®è½¯CEOä¹‹åï¼Œå¼€å§‹â€œåˆ·æ–°â€å¾®è½¯ï¼Œä¸ä»…æŠŠå¾®è½¯çš„æˆ˜ç•¥é‡å¿ƒè°ƒæ•´ä¸ºäº‘è®¡ç®—ï¼Œè€Œä¸”åœ¨ä¼ä¸šæ–‡åŒ–æ–¹é¢åšäº†è¾¾åˆ°å¤§åˆ€é˜”æ–§çš„å˜é©ï¼Œè®©æ•´ä¸ªä¼ä¸šæ›´å¾—æ›´åŠ æœ‰æ‰§è¡ŒåŠ›ï¼Œä¹Ÿè®©å¾®è½¯åˆ›æ–°ç„•å‘ç”Ÿæœºã€‚ä¼´éšç€è¿™ç§å˜åŒ–çš„æ˜¯ï¼Œå¾®è½¯çš„è‚¡ä»·åœ¨ä»–ä¸Šä»»ä¹‹åä¸Šæ¶¨äº†è¶…è¿‡6å€ï¼Œå¹¶åœ¨2020å¹´6æœˆ22æ—¥çš„å¸‚å€¼è¾¾åˆ°1.52ä¸‡äº¿ç¾å…ƒï¼Œæˆä¸ºå…¨çƒä»…æ¬¡äºè‹¹æœå…¬å¸çš„ç§‘æŠ€å…¬å¸ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img.36krcdn.com/20200624/v2_c9bfc4e75c174c6eaed12d75b58c6194_img_000" alt="å¾®è½¯è¿‡å»10å¹´çš„è‚¡ä»·å˜è¿å›¾ï¼ˆä¸œæ–¹è´¢å¯Œç½‘ï¼‰"></p><p>ä»è…¾è®¯å’Œå¾®è½¯çš„ä¾‹å­éƒ½å¯ä»¥çœ‹åˆ°ï¼šä¸€å®¶æ›¾ç»é­é‡å±æœºã€å¢é•¿å¤±é€Ÿçš„ä¼ä¸šä¾ç„¶å¯ä»¥é‡å¯å¢é•¿ï¼Œä½†å‰ææ˜¯é€‰å‡†æˆ˜ç•¥æ–¹å‘ï¼Œæ±‡èšä¼˜ç§€äººæ‰ï¼Œåˆ·æ–°ä¼ä¸šæ–‡åŒ–ï¼Œå¢å¼ºç»„ç»‡èƒ½åŠ›ã€‚è¿™æ˜¯ç™¾åº¦æ­£åœ¨åšçš„äº‹æƒ…ï¼Œæˆ‘ä»¬æ— æ³•é¢„æµ‹ç™¾åº¦æœªæ¥çš„å¸‚å€¼ä¼šä¸ä¼šä¹Ÿä¼šè¿æ¥10å€ä»¥ä¸Šçš„å¢é•¿ï¼Œä½†è‡³å°‘å®ƒåˆé‡æ–°èµ°åœ¨äº†æ­£ç¡®çš„è·¯ä¸Šã€‚</p><p>ç™¾åº¦çš„æœªæ¥åœ¨å“ªé‡Œï¼Ÿæˆ–è®¸è¾›å¼ƒç–¾çš„è¿™é¦–è¯é‡Œè•´è—äº†ç­”æ¡ˆï¼šä¼—é‡Œå¯»ä»–<a href="https://36kr.com/projectDetails/187422" target="_blank" rel="noopener">åƒç™¾åº¦</a>ï¼Œè“¦ç„¶å›é¦–ï¼Œé‚£äººå´åœ¨ï¼Œç¯ç«é˜‘çŠå¤„ã€‚ç¯ç«é˜‘çŠå¤„ï¼Œä¹Ÿæ˜¯æ˜Ÿè¾°å¤§æµ·ã€‚</p><p>å‚è€ƒèµ„æ–™ï¼š</p><p>æ½˜ä¹±ï¼šã€Šç™¾åº¦æ­£åœ¨åˆ·æ–°ï¼šå››ä¸‡äººå¼€å§‹æ–°é•¿å¾ã€‹</p><p>è´¢ç»ï¼šã€Šç™¾åº¦æ¨åŠ¨å…¨å‘˜ç»©æ•ˆå˜é©ï¼Œæå½¦å®çš„OKRæœ‰å“ªäº›ï¼Ÿã€‹</p><p>ä¸­å…³æ‘äº’åŠ¨è¥é”€å®éªŒå®¤ï¼šã€Š2019å¹´äº’è”ç½‘å¹¿å‘Šå‘å±•æŠ¥å‘Šã€‹</p><p>å‡¤å‡°ç½‘ï¼šã€Šç™¾åº¦æ˜¯å¦è¢«ä½ä¼°ï¼Ÿã€‹</p><p>ä½œè€… | é™ˆé›ªé¢‘ï¼Œ<a href="https://36kr.com/projectDetails/29044" target="_blank" rel="noopener">æ™ºæ…§äº‘</a>åˆ›å§‹åˆä¼™äººï¼Œå¤šå®¶é«˜æˆé•¿ä¼ä¸šçš„æˆ˜ç•¥é¡¾é—®å’Œæ€»è£æ•™ç»ƒã€‚</p><p>ç¼–è¾‘ | æ™ºæ…§äº‘è‘£äº‹ä¼šï¼Œå®šä½äºâ€é«˜æˆé•¿ä¼ä¸šçš„å¤–éƒ¨è‘£äº‹ä¼šâ€ï¼Œè‡´åŠ›äºæå‡ä¼ä¸šå®¶é¢†å¯¼åŠ›ï¼ŒåŠ©åŠ›ä¼ä¸šé«˜é€Ÿæˆé•¿ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> äº’è”ç½‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç™¾åº¦ </tag>
            
            <tag> ç§‘æŠ€ </tag>
            
            <tag> ä¼ä¸š </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>éŸ³é¢‘å¯è§†åŒ–ï¼šé‡‡æ ·ã€é¢‘ç‡å’Œå‚…é‡Œå¶å˜æ¢ï¼ˆè½¬ï¼‰</title>
      <link href="/2021/08/25/yin-pin-ke-shi-hua-cai-yang-pin-lu-he-fu-li-xie-bian-huan/"/>
      <url>/2021/08/25/yin-pin-ke-shi-hua-cai-yang-pin-lu-he-fu-li-xie-bian-huan/</url>
      
        <content type="html"><![CDATA[<blockquote><p>çœŸæ˜¯é‡‘å­ä¸€æ ·çš„æ–‡ç« ï¼æˆ‘è§‰å¾—è¿™ä¸€ç¯‡æ–‡ç« å†™çš„çœŸæ˜¯å¤ªæœ‰æ°´å¹³äº†ï¼å¾ˆæ„Ÿè°¢è¿™æ ·è‰¯å¿ƒä¹äºåˆ†äº«çš„ä½œè€…ã€‚  </p><p>æœ¬åšå®¢è½¬è½½è‡ª<a href="https://cjting.me/2021/08/07/fourier-transform-and-audio-visualization/" target="_blank" rel="noopener">cjting</a>, å¦‚æœ‰ä¾µæƒï¼Œè¯·ç«‹åˆ»è”ç³»åšä¸»<a href="mailto:lry89757@gmail.com" target="_blank" rel="noopener">lry89757@gmail.com</a>.</p></blockquote><h1 id="éŸ³é¢‘å¯è§†åŒ–ï¼šé‡‡æ ·ã€é¢‘ç‡å’Œå‚…é‡Œå¶å˜æ¢"><a href="#éŸ³é¢‘å¯è§†åŒ–ï¼šé‡‡æ ·ã€é¢‘ç‡å’Œå‚…é‡Œå¶å˜æ¢" class="headerlink" title="éŸ³é¢‘å¯è§†åŒ–ï¼šé‡‡æ ·ã€é¢‘ç‡å’Œå‚…é‡Œå¶å˜æ¢"></a>éŸ³é¢‘å¯è§†åŒ–ï¼šé‡‡æ ·ã€é¢‘ç‡å’Œå‚…é‡Œå¶å˜æ¢</h1><p>2021.08.07</p><p>[TOC]</p><p>å°è±¡ä¸­ä½¿ç”¨çš„ç¬¬ä¸€ä¸ª PC éŸ³ä¹æ’­æ”¾å™¨æ˜¯ã€Œåƒåƒé™å¬ã€ï¼Œå¤§æ¦‚æ˜¯ 08 å¹´å·¦å³ã€‚æˆ‘è¿˜æ¸…æ¥šåœ°è®°å¾—å®ƒè‡ªå¸¦äº†ä¸€é¦–æ¢é™èŒ¹çš„æ­Œã€ŒLove is everythingã€ï¼ŒåŠ¨å¬çš„æ—‹å¾‹è‡³ä»Šè¦ç»•è€³æ—ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cjting.me/2021/08/07/fourier-transform-and-audio-visualization/qianqian.jpeg" alt="img"></p><p>åƒåƒé™å¬çš„å·¦ä¸Šè§’æœ‰ä¸€ç»„éšç€éŸ³ä¹è·³åŠ¨çš„æŸ±å­ï¼Œæˆ‘æƒ³å¤§å®¶éƒ½ä¹ ä»¥ä¸ºå¸¸äº†ï¼Œå¾ˆå¤šæ’­æ”¾å™¨éƒ½æœ‰è¿™åŠŸèƒ½ã€‚ä½†æ˜¯å…¶å®æœ‰æ²¡æœ‰æƒ³è¿‡ï¼Œè¿™æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ</p><p>è¦ç†è§£è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬é¦–å…ˆè¦ç†è§£å£°éŸ³æ˜¯ä»€ä¹ˆã€‚</p><h2 id="æ³¢"><a href="#æ³¢" class="headerlink" title="æ³¢"></a>æ³¢</h2><p>ä¸­å­¦ç‰©ç†æœ‰ä»‹ç»è¿‡ï¼Œå£°éŸ³æ˜¯ç”±ç‰©ä½“æŒ¯åŠ¨äº§ç”Ÿçš„ï¼Œè¿™ä¸ªæŒ¯åŠ¨ç»ç”±ä»‹è´¨ä¼ å¯¼åˆ°æˆ‘ä»¬çš„è€³æœµä¸­å¼•èµ·è€³è†œæŒ¯åŠ¨ä»è€Œè®©æˆ‘ä»¬å¬è§å£°éŸ³ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç”¨æ³¢å½¢æ¥æè¿°æŒ¯åŠ¨ï¼Œå…¶ä¸­æ¨ªè½´æ˜¯æ—¶é—´ï¼Œçºµè½´æ˜¯æŒ¯åŠ¨çš„ä½ç§»ï¼Œä¹Ÿå°±æ˜¯ç¦»å¼€åŸç‚¹çš„è·ç¦»ã€‚</p><p>æŒ¯åŠ¨çš„ä¸¤ä¸ªå…³é”®å±æ€§æ˜¯é¢‘ç‡å’ŒæŒ¯å¹…ï¼Œé¢‘ç‡æ˜¯æŒ‡ä¸€ç§’é’ŸæŒ¯åŠ¨å¤šå°‘æ¬¡ï¼Œå¯¹åº”äºéŸ³é«˜ï¼Œé¢‘ç‡è¶Šé«˜å£°éŸ³è¶Šå°–é”åˆºè€³ã€‚</p><p>æŒ¯å¹…åˆ™è¡¨ç¤ºæœ€å¤§çš„ä½ç§»å€¼ï¼Œå¯¹åº”äºéŸ³é‡ï¼ŒæŒ¯å¹…è¶Šå¤§å£°éŸ³è¶Šå“ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cjting.me/2021/08/07/fourier-transform-and-audio-visualization/200hz.png" alt="img"></p><p>ä¸Šå›¾æ˜¯ç”¨ <a href="https://matplotlib.org/" target="_blank" rel="noopener">matplot</a> ç»˜åˆ¶çš„ä¸€ä¸ªæ­£å¼¦æ³¢ï¼Œå¯ä»¥çœ‹å‡ºåœ¨ 0.01s å†…æŒ¯åŠ¨äº† 2 æ¬¡ï¼Œå› æ­¤é¢‘ç‡æ˜¯ 200ï¼ŒæŒ¯å¹…æ˜¯ 1ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">def</span> <span class="token function">sin_wave</span><span class="token punctuation">(</span>hz<span class="token punctuation">)</span><span class="token punctuation">:</span>  x <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> endpoint<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>  y <span class="token operator">=</span> np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>x <span class="token operator">*</span> hz <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>pi<span class="token punctuation">)</span>  plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>  plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"Time"</span><span class="token punctuation">)</span>  plt<span class="token punctuation">.</span>axhline<span class="token punctuation">(</span>y<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'k'</span><span class="token punctuation">)</span>  plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>sin_wave<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ç§æœ€ç®€å•çš„æ³¢å½¢å¯¹åº”çš„å£°éŸ³å«åš pure toneï¼Œé¡¾åæ€ä¹‰ï¼Œéå¸¸çš„ç®€å•è€Œä¸”çº¯ç²¹ã€‚</p><p>ä¸‹é¢æ˜¯ç”¨ <a href="https://www.scipy.org/" target="_blank" rel="noopener">scipy</a> ç”Ÿæˆçš„ 200hz çš„å£°éŸ³ï¼Œå¤§å®¶å¯ä»¥å¬å¬çœ‹ã€‚</p><p><audio controls style="width: 680px; margin: 16px 0px;"></audio></p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> scipy<span class="token punctuation">.</span>io<span class="token punctuation">.</span>wavfile <span class="token keyword">as</span> wavSAMPLE_RATE <span class="token operator">=</span> <span class="token number">44100</span>DURATION <span class="token operator">=</span> <span class="token number">5</span><span class="token keyword">def</span> <span class="token function">write_wav</span><span class="token punctuation">(</span>hz<span class="token punctuation">)</span><span class="token punctuation">:</span>  x <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> DURATION<span class="token punctuation">,</span> SAMPLE_RATE <span class="token operator">*</span> DURATION<span class="token punctuation">,</span> endpoint<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>  tone <span class="token operator">=</span> np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>x <span class="token operator">*</span> hz <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>pi<span class="token punctuation">)</span>  normalized_tone <span class="token operator">=</span> np<span class="token punctuation">.</span>int16<span class="token punctuation">(</span><span class="token punctuation">(</span>tone <span class="token operator">/</span> tone<span class="token punctuation">.</span>max<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">32767</span><span class="token punctuation">)</span>  wav<span class="token punctuation">.</span>write<span class="token punctuation">(</span>f<span class="token string">"{hz}hz.wav"</span><span class="token punctuation">,</span> SAMPLE_RATE<span class="token punctuation">,</span> normalized_tone<span class="token punctuation">)</span>write_wav<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ˜¯ 800hz çš„å£°éŸ³ï¼Œå¯ä»¥æ˜æ˜¾æ„Ÿè§‰åˆ°ï¼Œå£°éŸ³æ›´åŠ å°–é”äº†ã€‚</p><p><audio controls style="width: 680px; margin: 16px 0px;"></audio></p><p>ç°å®ä¸–ç•Œä¸­æˆ‘ä»¬å¬åˆ°çš„å£°éŸ³ä¸ä¼šæ˜¯ pure toneï¼Œè€Œæ˜¯å„ç§ pure tone å åŠ çš„ç»“æœã€‚</p><p>ä¸‹å›¾ä¸­è“è‰²æ˜¯ 200hzï¼Œé»„è‰²æ˜¯ 800hzï¼Œè€Œç»¿è‰²åˆ™æ˜¯å®ƒä»¬å åŠ çš„ç»“æœï¼Œå·²ç»ä¸å†æ˜¯ä¸€ä¸ª pure tone äº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cjting.me/2021/08/07/fourier-transform-and-audio-visualization/200-add-800hz.png" alt="img"></p><p>ä¸‹é¢æ˜¯ç»¿è‰²æ›²çº¿å¬èµ·æ¥çš„æ•ˆæœã€‚</p><p><audio controls style="width: 680px; margin: 16px 0px;"></audio></p><p>æ€»ç»“ä¸€ä¸‹ï¼š</p><ul><li>æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªæ³¢å½¢å›¾æ¥è¡¨ç¤ºå£°éŸ³ï¼Œå…¶ä¸­ X è½´æ˜¯æ—¶é—´ï¼ŒY è½´æ˜¯æŒ¯åŠ¨çš„ä½ç§»</li><li>æœ€ç®€å•çš„æ­£å¼¦æ³¢å¯¹åº”çš„å£°éŸ³å«åš pure tone</li><li>æ—¥å¸¸ä¸­æˆ‘ä»¬å¬åˆ°çš„å£°éŸ³éƒ½æ˜¯å„ç§ pure tone å åŠ çš„ç»“æœ</li></ul><p>Tip:</p><p>å¦‚æœæƒ³äº†è§£ä¸€ç‚¹ä¹ç†ï¼Œ<a href="https://www.lightnote.co/music-theory/sound-waves" target="_blank" rel="noopener">LITENOTE</a> éå¸¸ä¸é”™ã€‚</p><p>å®ƒçš„ç½‘é¡µåšå¾—å¾ˆæ£’ï¼Œé€šè¿‡äº’åŠ¨çš„å½¢å¼è®²è¿°åŸºæœ¬çš„ä¹ç†çŸ¥è¯†ï¼ŒåŒ…æ‹¬éŸ³é˜¶ã€å’Œå¼¦ï¼ŒåäºŒå¹³å‡å¾‹ç­‰ã€‚</p><h2 id="é‡‡æ ·"><a href="#é‡‡æ ·" class="headerlink" title="é‡‡æ ·"></a>é‡‡æ ·</h2><p>å› ä¸ºå£°éŸ³æ˜¯ä¸€ä¸ªéšæ—¶é—´å˜åŒ–çš„è¿ç»­å‡½æ•°ï¼Œä»»æ„ä¸€æ®µé—´éš”å†…éƒ½æœ‰æ— ç©·å¤šä¸ªå€¼ï¼Œè€Œæ— ç©·å¤šçš„æ•°æ®æ˜¯æ²¡åŠæ³•å­˜å‚¨åœ¨è®¡ç®—æœºä¸­çš„ã€‚</p><p>æƒ³è¦å­˜å‚¨ï¼Œæˆ‘ä»¬å°±éœ€è¦å°†å®ƒç¦»æ•£åŒ–å˜æˆç¦»æ•£åºåˆ—ï¼Œå…·ä½“çš„æ–¹æ³•å°±æ˜¯é‡‡æ ·ï¼Œä½¿ç”¨å›ºå®šçš„é—´éš”å¯¹å‡½æ•°è¿›è¡Œæ±‚å€¼ã€‚</p><p>è¿™æ˜¯åŸå§‹çš„å£°éŸ³ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cjting.me/2021/08/07/fourier-transform-and-audio-visualization/origin.png" alt="img"></p><p>è¿™æ˜¯é‡‡æ ·åçš„ç»“æœã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cjting.me/2021/08/07/fourier-transform-and-audio-visualization/sampled.png" alt="img"></p><p>é€šè¿‡é‡‡æ ·ï¼Œæˆ‘ä»¬å°†ä¸€ä¸ªæ— å°½åºåˆ—å˜æˆäº†ä¸€ä¸ªæœ‰é™åºåˆ—ï¼Œå…¶ä¸­æ¯ä¸€ä¸ªå€¼å«åšæ ·æœ¬ï¼Œè¿™æ ·å°±å¯ä»¥æ–¹ä¾¿åœ°åœ¨è®¡ç®—æœºä¸­å­˜å‚¨äº†ã€‚</p><p>é‡‡æ ·çš„å…³é”®å‚æ•°æœ‰ä¸¤ä¸ªï¼Œåˆ†åˆ«æ˜¯é‡‡æ ·é¢‘ç‡å’Œé‡‡æ ·æ·±åº¦ã€‚</p><p>é‡‡æ ·é¢‘ç‡æ˜¯æŒ‡æ¯ç§’é’Ÿé‡‡æ ·å¤šå°‘æ¬¡ï¼Œå¾ˆæ˜æ˜¾ï¼Œé‡‡æ ·é¢‘ç‡è¶Šé«˜ï¼Œæ ·æœ¬è¶Šå¤šï¼Œæ•°æ®é‡è¶Šå¤§ï¼ŒåŒæ—¶ä¹Ÿæ›´æ¥è¿‘åŸå§‹çš„å£°éŸ³ã€‚</p><p>é‡‡æ ·æ·±åº¦æ˜¯æŒ‡ç”¨å¤šå°‘æ¯”ç‰¹å»å­˜å‚¨é‡‡æ ·å¾—åˆ°çš„å€¼ï¼Œä½¿ç”¨çš„æ¯”ç‰¹è¶Šå¤šï¼Œè¿˜åŸå¾—åˆ°çš„å£°éŸ³è¶Šç»†è…»ï¼Œå’Œå›¾ç‰‡çš„è‰²å½©æ·±åº¦æ˜¯ä¸€ä¸ªé“ç†ã€‚</p><p>å‡è®¾æˆ‘ä»¬ç”¨ 16bit é‡‡æ ·æ·±åº¦å’Œ 44100 çš„é‡‡æ ·é¢‘ç‡ï¼Œé‚£ä¹ˆä¸€æ®µä¸€ç§’é’Ÿçš„å£°éŸ³å°±å˜æˆäº†ä¸€ä¸ª 44100 å¤§å°çš„ int16 æ•°ç»„ã€‚</p><p>å¾—åˆ°é‡‡æ ·å€¼æ•°ç»„ä»¥åï¼Œæ¥ä¸‹æ¥å¦‚ä½•å­˜å‚¨è¿™ä¸ªæ•°ç»„å°±æ˜¯ç¼–ç çš„èŒƒç•´äº†ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥å­˜ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨æŸç§ç®—æ³•å‹ç¼©ä»¥åå†å­˜ã€‚å„ç§å„æ ·çš„åŠæ³•ï¼Œå¯¹åº”ç€å„ç§å„æ ·çš„éŸ³é¢‘æ ¼å¼ï¼Œæ¯”å¦‚ MP3, AAC, WAV ç­‰ã€‚</p><p>è¿™å…¶ä¸­ AAC å’Œ MP3 æ ¼å¼æ˜¯æœ‰æŸçš„ï¼Œä¹Ÿå°±æ˜¯å­˜å‚¨ä»¥åå†è¯»å‡ºæ¥ï¼Œå¾—åˆ°çš„æ ·æœ¬å’ŒåŸå§‹çš„ä¼šæœ‰ä¸€äº›åŒºåˆ«ï¼Œä½†è¿™äº›åŒºåˆ«å¾ˆç»†å¾®ï¼Œå¯ä»¥å¿½ç•¥ã€‚æœ‰æŸçš„ç‰¹ç‚¹å°±æ˜¯åœ¨åŸºæœ¬ä¸å½±å“æœ€ç»ˆæ’­æ”¾æ•ˆæœçš„æƒ…å†µä¸‹ï¼Œå¤§å¹…åº¦å‡å°‘æ–‡ä»¶ä½“ç§¯ã€‚</p><p>è€Œ WAV åˆ™æ˜¯æ— æŸçš„ï¼Œè¾“å…¥æ˜¯ä»€ä¹ˆï¼Œè¯»å‡ºæ¥å°±æ˜¯ä»€ä¹ˆï¼Œç¼ºç‚¹è‡ªç„¶æ˜¯ä½“ç§¯è¦å¤§å¾ˆå¤šã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ scipy æ¥è¯»å– WAV éŸ³é¢‘ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> scipy<span class="token punctuation">.</span>io<span class="token punctuation">.</span>wavfile <span class="token keyword">as</span> wavrate<span class="token punctuation">,</span> all_samples <span class="token operator">=</span> wav<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token string">"xxx.wav"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>rate<span class="token punctuation">,</span> len<span class="token punctuation">(</span>all_samples<span class="token punctuation">)</span><span class="token punctuation">,</span> all_samples<span class="token punctuation">.</span>dtype<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 44100 10639873 int16</span><span class="token comment" spellcheck="true"># ä¸Šé¢åˆ†åˆ«æ˜¯ï¼šé‡‡æ ·ç‡ï¼Œæ ·æœ¬æ€»æ•°ï¼Œä»¥åŠæ ·æœ¬å€¼çš„ç±»å‹</span><span class="token comment" spellcheck="true"># int16 è¯´æ˜æ¯ä¸€ä¸ªæ ·æœ¬æ˜¯ 16bit æ•´æ•°</span><span class="token keyword">print</span><span class="token punctuation">(</span>all_samples<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># [-41 -51 -49 -41 -28 -15 -20 -33 -32 -38 -54 -54 -44 -30  -8  10  11   2</span><span class="token comment" spellcheck="true"># -14 -36]</span><span class="token comment" spellcheck="true"># å¯ä»¥çœ‹åˆ°æ ·æœ¬å°±æ˜¯ä¸€ç»„æ•°å­—</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹å‡ºï¼Œé‡‡æ ·é¢‘ç‡æ˜¯ 44100ï¼Œä¸€å…±æœ‰ 10639873 ä¸ªæ ·æœ¬ï¼Œä½¿ç”¨ int16 è¿›è¡Œå­˜å‚¨ï¼Œè®¡ç®—å¯çŸ¥è¿™é¦–æ­Œçš„æ—¶é—´æ˜¯ 241 ç§’ã€‚</p><h2 id="å‚…é‡Œå¶å˜æ¢"><a href="#å‚…é‡Œå¶å˜æ¢" class="headerlink" title="å‚…é‡Œå¶å˜æ¢"></a>å‚…é‡Œå¶å˜æ¢</h2><p>ç»™å®šä¸€ä¸ª 200hz çš„æ³¢å½¢å’Œä¸€ä¸ª 800hz çš„æ³¢å½¢ï¼Œè®¡ç®—å®ƒä»¬å åŠ ä»¥åçš„ç»“æœéå¸¸ç®€å•ï¼Œæ²¡æœ‰ä»»ä½•éš¾åº¦ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cjting.me/2021/08/07/fourier-transform-and-audio-visualization/200-add-800hz.png" alt="img"></p><p>ä½†æ˜¯ï¼Œå¦‚æœç»™åˆ°å åŠ ä»¥åçš„ç»“æœå‘¢ï¼Ÿ</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cjting.me/2021/08/07/fourier-transform-and-audio-visualization/mixed.png" alt="img"></p><p>èƒ½çœ‹å‡ºä¸Šé¢çš„ç»¿è‰²æ›²çº¿æ˜¯ 200hz+800hz å åŠ å¾—åˆ°çš„å—ï¼Ÿå®Œå…¨çœ‹ä¸å‡ºæ¥ï¼Œç”šè‡³ï¼Œè¿™æ ·çš„é€†æ¨çœŸçš„å¯è¡Œå—ï¼Ÿè¿˜æ˜¯è¯´å’Œæ°¸åŠ¨æœºä¸€æ ·åœ¨åŸç†ä¸Šå°±æ˜¯ä¸å¯è¡Œçš„ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯å¯è¡Œçš„ï¼Œé€šè¿‡å‚…é‡Œå¶å˜æ¢ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸€ä¸ªå¤åˆæ³¢å½¢æ‹†è§£ä¸ºæ„æˆå®ƒçš„ç®€å•æ³¢å½¢ã€‚</p><p>æƒ³æƒ³éƒ½è§‰å¾—ä¸å¯æ€è®®ï¼Œè¿™æ˜¯æ€ä¹ˆåšåˆ°çš„ï¼Ÿå‚…é‡Œå¶åˆæ˜¯æ€ä¹ˆæƒ³åˆ°çš„ï¼Ÿä¸å¾—ä¸è¯´åå…«ä¸–çºªçš„æ³•å›½æ•°å­¦å®¶å‚…é‡Œå¶æ˜¯ä¸€ä¸ªå¤©æ‰ï¼Œè®©äººä»°æœ›ã€‚</p><p>Tip: 3Blue1Brown æœ‰ä¸€ä¸ªè§†é¢‘ä»‹ç»å‚…é‡Œå¶å˜æ¢çš„åŸç†ï¼Œéå¸¸æ£’ï¼š<a href="https://www.youtube.com/watch?v=spUNpyF58BY" target="_blank" rel="noopener">å½¢è±¡çš„ä»‹ç»ï¼šä»€ä¹ˆæ˜¯å‚…é‡Œå¶å˜æ¢ï¼Ÿ</a></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹æ€æ ·é€šè¿‡å‚…é‡Œå¶å˜æ¢æ¥æ‹†è§£å¤åˆæ³¢å½¢ã€‚</p><p>æˆ‘ä»¬å¯ä»¥è®¤ä¸ºå‚…é‡Œå¶å˜æ¢æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒçš„è¾“å…¥ä¸º N ä¸ªå®æ•°ï¼Œä»£è¡¨é‡‡æ ·å€¼ï¼Œè¾“å‡ºä¸º N ä¸ªå¤æ•°ï¼Œä»£è¡¨ä¸åŒé¢‘ç‡çš„åˆ†é‡ï¼Œè¿™é‡Œæˆ‘ä»¬å¿½ç•¥å¤æ•°çš„å®éƒ¨å’Œè™šéƒ¨ï¼Œåªå…³å¿ƒå®ƒçš„æ¨¡ï¼Œä¹Ÿå°±æ˜¯ç»å¯¹å€¼ã€‚</p><p>Tip: è¿™é‡Œå…³äºå‚…é‡Œå¶å˜æ¢çš„è¯´æ³•å¹¶ä¸å®Œæ•´ï¼Œæ¯”å¦‚å‚…é‡Œå¶å˜æ¢çš„è¾“å…¥ä¹Ÿå¯ä»¥æ˜¯å¤æ•°ã€‚ä½†æ˜¯å¯¹æˆ‘ä»¬æ¥è¯´ç†è§£åˆ°è¿™ä¸€å±‚é¢å°±å¤Ÿäº†ã€‚å¦‚æœæƒ³è¦æ·±å…¥ç ”ç©¶ï¼Œå¯ä»¥å»å­¦ä¹ æ•°å­—ä¿¡å·å¤„ç†ç›¸å…³çš„è¯¾ç¨‹ã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨ scipy æ¥å®é™…è¿›è¡Œä¸€ä¸‹å‚…é‡Œå¶å˜æ¢ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> scipy<span class="token punctuation">.</span>fft <span class="token keyword">import</span> fft<span class="token punctuation">,</span> fftfreq<span class="token comment" spellcheck="true"># è¿™æ˜¯å³å°†è¿›è¡Œå˜æ¢çš„é‡‡æ ·å€¼: [0, 1, 2, 3, 4, 5, 6, 7]</span>samples <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># è¿™æ˜¯å‚…é‡Œå¶å˜æ¢çš„ç»“æœ</span>y <span class="token operator">=</span> fft<span class="token punctuation">(</span>samples<span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> y<span class="token punctuation">:</span>  <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># å˜æ¢ç»“æœä¸º 8 ä¸ªå¤æ•°</span><span class="token comment" spellcheck="true"># (28-0j)</span><span class="token comment" spellcheck="true"># (-3.9999999999999996+9.65685424949238j)</span><span class="token comment" spellcheck="true"># (-4+4j)</span><span class="token comment" spellcheck="true"># (-4+1.6568542494923797j)</span><span class="token comment" spellcheck="true"># (-4-0j)</span><span class="token comment" spellcheck="true"># (-4-1.6568542494923797j)</span><span class="token comment" spellcheck="true"># (-4-4j)</span><span class="token comment" spellcheck="true"># (-3.9999999999999996-9.65685424949238j)</span><span class="token comment" spellcheck="true"># x æ˜¯ä¸Šé¢æ¯ä¸ªç»“æœå¯¹åº”çš„é¢‘ç‡</span><span class="token comment" spellcheck="true"># è¿™é‡Œ fftfreq å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ ·æœ¬æ•°é‡</span><span class="token comment" spellcheck="true"># ç¬¬äºŒä¸ªå‚æ•°ä¸º é‡‡æ ·ç‡çš„ å€’æ•°ï¼Œæˆ‘ä»¬å‡å®šé‡‡æ ·ç‡ä¸º 8</span>x <span class="token operator">=</span> fftfreq<span class="token punctuation">(</span>len<span class="token punctuation">(</span>samples<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># [ 0.  1.  2.  3. -4. -3. -2. -1.]</span><span class="token comment" spellcheck="true"># è¿™é‡Œæ„å‘³ç€ y[0] å¯¹åº”çš„é¢‘ç‡æ˜¯ 0ï¼Œy[1] å¯¹åº”çš„é¢‘ç‡æ˜¯ 1</span><span class="token comment" spellcheck="true"># è´Ÿæ•°é¢‘ç‡æ˜¯ä»€ä¹ˆå«ä¹‰ï¼Ÿæˆ‘ä»¬å¯ä»¥ä¸ç®¡ï¼Œå¿½ç•¥</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šé¢çš„ä»£ç æˆ‘ä»¬æ„é€ äº† 8 ä¸ªæ•°å­—è¿›è¡Œå‚…é‡Œå¶å˜æ¢ï¼Œå¹¶å‡å®šè¿™ç»„æ ·æœ¬æ˜¯ä½¿ç”¨é‡‡æ ·ç‡ 8 è¿›è¡Œé‡‡æ ·å¾—åˆ°çš„ã€‚</p><p>å˜æ¢çš„ç»“æœæ˜¯ 8 ä¸ªå¤æ•°ï¼Œè¿™ 8 ä¸ªå¤æ•°å¯¹åº” 8 ä¸ªé¢‘ç‡ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œæ­£é¢‘ç‡å’Œè´Ÿé¢‘ç‡å¯¹åº”çš„å˜æ¢ç»“æœæ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿå°±æ˜¯å˜æ¢åçš„ç»“æœæ˜¯å¯¹ç§°çš„ã€‚</p><p>ä¸Šé¢å¾—åˆ°çš„ç»“æœæ„ä¹‰ä¸å¤§ï¼Œå› ä¸ºè¾“å…¥æ²¡ä»€ä¹ˆæ„ä¹‰ã€‚ç°åœ¨æˆ‘ä»¬ä½¿ç”¨å‚…é‡Œå¶å˜æ¢å¤„ç†ä¸€ä¸‹ 200hz+800hz å åŠ åçš„æ³¢å½¢ï¼Œçœ‹çœ‹æ˜¯å¦èƒ½è¿˜åŸå› 200hz å’Œ 800hzã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt<span class="token keyword">from</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">import</span> figure<span class="token keyword">from</span> scipy<span class="token punctuation">.</span>fft <span class="token keyword">import</span> fft<span class="token punctuation">,</span> fftfreqfigure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">)</span>DURATION <span class="token operator">=</span> <span class="token number">0.01</span>SAMPLE_RATE <span class="token operator">=</span> <span class="token number">44100</span><span class="token keyword">def</span> <span class="token function">gen_sine_wave</span><span class="token punctuation">(</span>freq<span class="token punctuation">)</span><span class="token punctuation">:</span>  x <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> DURATION<span class="token punctuation">,</span> int<span class="token punctuation">(</span>DURATION <span class="token operator">*</span> SAMPLE_RATE<span class="token punctuation">)</span><span class="token punctuation">,</span> endpoint<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>  y <span class="token operator">=</span> np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>x <span class="token operator">*</span> freq <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>pi<span class="token punctuation">)</span>  <span class="token keyword">return</span> yhz200 <span class="token operator">=</span> gen_sine_wave<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>hz800 <span class="token operator">=</span> gen_sine_wave<span class="token punctuation">(</span><span class="token number">800</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># å åŠ åçš„é‡‡æ ·æ•°æ®</span><span class="token comment" spellcheck="true"># è¿™é‡Œæ¯ä¸ªæ ·æœ¬ä¸æ˜¯ int16ï¼Œè€Œæ˜¯ floatï¼Œæ— å…³ç´§è¦</span>total <span class="token operator">=</span> hz200 <span class="token operator">+</span> hz800y <span class="token operator">=</span> fft<span class="token punctuation">(</span>total<span class="token punctuation">)</span>x <span class="token operator">=</span> fftfreq<span class="token punctuation">(</span>len<span class="token punctuation">(</span>total<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">/</span> SAMPLE_RATE<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># æ­¤æ—¶æ¨ªè½´æ˜¯é¢‘ç‡ï¼Œçºµè½´æ˜¯è¯¥é¢‘ç‡çš„åˆ†é‡</span><span class="token comment" spellcheck="true"># ä½¿ç”¨ np.abs è®¡ç®—å¤æ•°çš„æ¨¡</span>plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> np<span class="token punctuation">.</span>abs<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œé¦–å…ˆè¾“å‡ºç»“æœæ˜¯å·¦å³å¯¹ç§°çš„ï¼Œæˆ‘ä»¬å¿½ç•¥æ‰è´Ÿé¢‘ç‡éƒ¨åˆ†ï¼Œåªå…³æ³¨æ­£é¢‘ç‡ã€‚</p><p>å…¶æ¬¡ï¼Œå‚…é‡Œå¶å˜æ¢å‘Šè¯‰æˆ‘ä»¬è¯¥è¾“å…¥ä¿¡å·ç”± 2 ä¸ªé¢‘ç‡ç»„æˆï¼Œç¨‹åºè¿è¡Œæ—¶é¼ æ ‡æ”¾ä¸Šå»å¯ä»¥çœ‹å‡ºæ˜¯ 200 å’Œ 800ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡å‚…é‡Œå¶å˜æ¢ï¼Œæˆ‘ä»¬å°†å¤åˆæ³¢å½¢æ‹†è§£ä¸ºäº†ç®€å•æ³¢å½¢ã€‚</p><p>æˆ–è€…è¯´ï¼Œé€šè¿‡å‚…é‡Œå¶å˜æ¢ï¼Œæˆ‘ä»¬å°†ä¸€ä¸ªä¿¡å·æ‹†è§£ä¸ºäº†ä¸€ç»„ä¸åŒé¢‘ç‡çš„æ­£å¼¦æ³¢ï¼Œå°†å®ƒä»æ—¶åŸŸå˜æ¢åˆ°äº†é¢‘åŸŸã€‚ä¿¡å·è¿˜æ˜¯è¿™ä¸ªä¿¡å·ï¼Œåªä¸è¿‡æ¢ä¸ªè§’åº¦å»çœ‹å®ƒã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cjting.me/2021/08/07/fourier-transform-and-audio-visualization/transform.png" alt="img"></p><p>æ€»ç»“ä¸€ä¸‹ï¼š</p><ul><li>å‚…é‡Œå¶å˜æ¢æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥ä¸€ä¸²æ•°å­—ä»£è¡¨æ ·æœ¬å€¼ï¼Œè¾“å‡ºä¸€ä¸²å¤æ•°ä»£è¡¨é¢‘ç‡åˆ†é‡</li><li>æ¯ä¸ªæ•°å­—å…·ä½“ä»£è¡¨çš„é¢‘ç‡å¯ä»¥æ ¹æ®æ ·æœ¬æ•°é‡å’Œé‡‡æ ·é¢‘ç‡è®¡ç®—å¾—çŸ¥</li><li>æˆ‘ä»¬ä¸å…³å¿ƒå¤æ•°çš„æ–¹å‘ï¼Œæˆ‘ä»¬åªå…³å¿ƒå¤æ•°çš„æ¨¡</li><li>å‚…é‡Œå¶è¾“å‡ºçš„ç»“æœæ˜¯å·¦å³å¯¹ç§°çš„ï¼Œå› æ­¤åªæœ‰ä¸€åŠçš„ä¿¡æ¯æœ‰ä»·å€¼</li></ul><p>å› ä¸ºè¾“å‡ºç»“æœæ˜¯å¯¹ç§°çš„ï¼Œåªæœ‰ä¸€åŠçš„ä¿¡æ¯æœ‰ä»·å€¼ï¼Œå› æ­¤æœ‰ä¸€ä¸ªå˜ä½“å«åš <code>rfft</code>ï¼Œåªè¿”å›ä¸€åŠçš„ä¿¡æ¯ï¼Œè®¡ç®—é€Ÿåº¦å¯ä»¥æ›´å¿«ä¸€äº›ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">from</span> scipy<span class="token punctuation">.</span>fft <span class="token keyword">import</span> rfft<span class="token punctuation">,</span> rfftfreqSAMPLE_RATE <span class="token operator">=</span> <span class="token number">8</span>samples <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># æ­¤æ—¶ x å’Œ y éƒ½æ˜¯ 5 ä¸ªå€¼</span>y <span class="token operator">=</span> rfft<span class="token punctuation">(</span>samples<span class="token punctuation">)</span>x <span class="token operator">=</span> rfftfreq<span class="token punctuation">(</span>len<span class="token punctuation">(</span>samples<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">/</span> SAMPLE_RATE<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># y[0] è¡¨ç¤ºé¢‘ç‡ 0 çš„åˆ†é‡</span><span class="token comment" spellcheck="true"># y[1] è¡¨ç¤ºé¢‘ç‡ 1 çš„åˆ†é‡</span><span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># [0. 1. 2. 3. 4.]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> y<span class="token punctuation">:</span>  <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># å’Œä¹‹å‰ fft/fftfreq çš„è¾“å‡ºå¯¹æ¯”ï¼Œå¯ä»¥å‘ç°ç»“æœæ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡å»æ‰äº†å¯¹ç§°çš„å†—ä½™ä¿¡æ¯</span><span class="token comment" spellcheck="true"># (28+0j)</span><span class="token comment" spellcheck="true"># (-3.9999999999999996+9.65685424949238j)</span><span class="token comment" spellcheck="true"># (-4+4j)</span><span class="token comment" spellcheck="true"># (-4+1.6568542494923797j)</span><span class="token comment" spellcheck="true"># (-4+0j)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="éŸ³é¢‘å¯è§†åŒ–"><a href="#éŸ³é¢‘å¯è§†åŒ–" class="headerlink" title="éŸ³é¢‘å¯è§†åŒ–"></a>éŸ³é¢‘å¯è§†åŒ–</h2><p>åˆ°äº†è¿™é‡Œæ‰€æœ‰å®ç°éŸ³é¢‘å¯è§†åŒ–æ‰€éœ€è¦çš„çŸ¥è¯†éƒ½å¤‡é½äº†ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬å¯ä»¥çŒœåˆ°ï¼ŒéšéŸ³ä¹è·³åŠ¨çš„æ¯ä¸ªæŸ±å­ï¼Œå¯¹åº”çš„æ˜¯ä¸€ä¸ªé¢‘ç‡æˆ–ä¸€ç»„é¢‘ç‡ï¼Œè€ŒæŸ±å­çš„é«˜åº¦åˆ™æ˜¯é¢‘ç‡çš„åˆ†é‡å¤§å°ï¼Œè¿™ä¸¤ä¸ªä¿¡æ¯å‚…é‡Œå¶å˜æ¢éƒ½èƒ½ç»™åˆ°ã€‚</p><p>ç°åœ¨å‰©ä¸‹çš„é—®é¢˜åˆ™æ˜¯è¾“å…¥æ˜¯ä»€ä¹ˆï¼Ÿæˆ‘ä»¬ä¸å¯èƒ½æŠŠä¸€é¦–æ­Œæ›²çš„æ‰€æœ‰æ ·æœ¬ä½œä¸ºè¾“å…¥è¿›è¡Œå‚…é‡Œå¶å˜æ¢ï¼Œå¦‚æœè¿™æ ·åšï¼Œæˆ‘ä»¬åªèƒ½å¾—åˆ°ä¸€ä»½é¢‘ç‡æ•°æ®ã€‚</p><p>æˆ‘ä»¬å¸Œæœ›å¾—åˆ°çš„é¢‘ç‡æ•°æ®éšç€éŸ³ä¹åœ¨å˜åŒ–ï¼Œå› æ­¤è¿™é‡Œè¦é€‰æ‹©ä¸€ä¸ªçª—å£å¤§å°ï¼ˆFFT_SIZEï¼‰ï¼Œæ¯”å¦‚ 2048ã€‚éšç€éŸ³ä¹çš„æ’­æ”¾ï¼Œæˆ‘ä»¬æ¯æ¬¡éƒ½ä»å½“å‰æ’­æ”¾ä½ç½®é€‰æ‹© 2048 ä¸ªæ ·æœ¬ç„¶åè¿›è¡Œå‚…é‡Œå¶å˜æ¢ã€‚</p><p>ç°åœ¨æˆ‘ä»¬çš„åˆæ­¥éŸ³é¢‘å¯è§†åŒ–æ–¹æ¡ˆå°±ç¡®å®šäº†ï¼š</p><ul><li>è§£æéŸ³é¢‘æ–‡ä»¶å¾—åˆ° allSamples</li><li>æ¯æ¬¡ç»˜å›¾æ—¶ï¼Œä»å½“å‰ sample å¼€å§‹é€‰æ‹© FFT_SIZE ä¸ª sample</li><li>å¯¹è¿™äº› sample è¿›è¡Œå‚…é‡Œå¶å˜æ¢</li><li>å¯¹å˜æ¢å¾—åˆ°çš„å¤æ•°æ±‚æ¨¡</li><li>æŠŠç»“æœå˜æ¢åˆ° 0 ~ 1 ç„¶åç»˜å›¾</li></ul><p>æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨ Web æ¥å®ç°ä¸€ä¸ªç®€å•çš„éŸ³é¢‘å¯è§†åŒ–å·¥å…·ã€‚</p><p>é¦–å…ˆï¼Œè§£æéŸ³é¢‘æ–‡ä»¶å¾—åˆ° allSamples æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ WebAudio çš„ APIã€‚</p><pre class="line-numbers language-js"><code class="language-js"><span class="token comment" spellcheck="true">// å¾—åˆ°æŸä¸ªéŸ³é¢‘æ–‡ä»¶çš„äºŒè¿›åˆ¶æ•°æ®</span><span class="token keyword">const</span> ab <span class="token operator">=</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"xxx.mp3"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=</span><span class="token operator">></span> res<span class="token punctuation">.</span><span class="token function">arrayBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">// æ–°å»º WebAudio context</span><span class="token keyword">const</span> audioCtx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AudioContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">// è§£æ arrayBuffer</span><span class="token keyword">const</span> audioBuffer <span class="token operator">=</span> audioCtx<span class="token punctuation">.</span><span class="token function">decodeAudioData</span><span class="token punctuation">(</span>ab<span class="token punctuation">)</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>audioBuffer<span class="token punctuation">)</span><span class="token comment" spellcheck="true">// AudioBuffer {length: 10639872, duration: 241.2669387755102, sampleRate: 44100, numberOfChannels: 2}</span><span class="token comment" spellcheck="true">//  duration: 241.2669387755102</span><span class="token comment" spellcheck="true">//  length: 10639872</span><span class="token comment" spellcheck="true">//  numberOfChannels: 2</span><span class="token comment" spellcheck="true">//  sampleRate: 44100</span><span class="token comment" spellcheck="true">// [[Prototype]]: AudioBuffer</span><span class="token comment" spellcheck="true">// ä¸€èˆ¬æ¥è¯´éŸ³é¢‘éƒ½æœ‰å¤šä¸ªå£°é“ï¼Œç”¨äºç«‹ä½“å£°æ’­æ”¾</span><span class="token comment" spellcheck="true">// è¿™é‡Œæˆ‘ä»¬é€‰ç¬¬ä¸€ä¸ªå£°é“å°±å¯ä»¥äº†</span><span class="token keyword">const</span> allSamples <span class="token operator">=</span> audioBuffer<span class="token punctuation">.</span><span class="token function">getChannelData</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">// allSamples å°±æ˜¯æˆ‘ä»¬è¦çš„æ ·æœ¬æ•°ç»„ï¼Œæ¯ä¸€ä¸ªæ ·æœ¬å€¼æ˜¯æµ®ç‚¹æ•°</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>allSamples<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">// Float32Array(10) [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>requestAnimationFrame</code> æ¥è¿›è¡Œç»˜åˆ¶ã€‚</p><p>æ¯æ¬¡ç»˜åˆ¶çš„æ—¶å€™ï¼Œéœ€è¦å…ˆè·å–å½“å‰çš„æ’­æ”¾ä½ç½®ã€‚audioBuffer ä¸­æœ‰éŸ³é¢‘çš„æ€»æ—¶é—´ï¼Œé€šè¿‡ <code>audioCtx.currentTime</code> æˆ‘ä»¬å¯ä»¥å¾—çŸ¥å½“å‰çš„æ’­æ”¾æ—¶é—´ï¼Œä¸¤ä¸ªç›¸é™¤ä¾¿æ˜¯æ’­æ”¾ä½ç½®ã€‚</p><pre class="line-numbers language-js"><code class="language-js"><span class="token comment" spellcheck="true">// ç”¨æˆ·ç‚¹å‡»æ’­æ”¾æ—¶</span><span class="token keyword">const</span> onPlay <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// è®°å½•ä¸‹æ’­æ”¾çš„å¼€å§‹æ—¶é—´</span>  <span class="token keyword">const</span> startTime <span class="token operator">=</span> audioCtx<span class="token punctuation">.</span>currentTime  <span class="token keyword">const</span> draw <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>draw<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">// ç›®å‰æ’­æ”¾äº†å¤šå°‘æ—¶é—´ (seconds)</span>    <span class="token keyword">const</span> cur <span class="token operator">=</span> audioCtx<span class="token punctuation">.</span>currentTime <span class="token operator">-</span> startTime    <span class="token comment" spellcheck="true">// æ’­æ”¾çš„è¿›åº¦æ˜¯å¤šå°‘</span>    <span class="token keyword">const</span> per <span class="token operator">=</span> cur <span class="token operator">/</span> audioBuffer<span class="token punctuation">.</span>duration    <span class="token keyword">const</span> startIndex <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>allSamples<span class="token punctuation">.</span>length <span class="token operator">*</span> per<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">// ä» startIndex å¼€å§‹åˆ‡å‰² FFT_SIZE ä¸ª sample å‡ºæ¥</span>    <span class="token comment" spellcheck="true">// æ­¤æ—¶è¦è¿›è¡Œå‚…é‡Œå¶å˜æ¢çš„ samples å°±å‡†å¤‡å¥½äº†</span>    <span class="token keyword">const</span> samples <span class="token operator">=</span> allSamples<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>startIndex<span class="token punctuation">,</span> startIndex <span class="token operator">+</span> FFT_SIZE<span class="token punctuation">)</span>  <span class="token punctuation">}</span>  <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>draw<span class="token punctuation">)</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ä¸‹æ¥å°±æ˜¯å‚…é‡Œå¶å˜æ¢äº†ï¼Œè¿™é‡Œæˆ‘æ‰¾äº†ä¸€ä¸‹ï¼ŒJS ç›¸å…³çš„åº“å¾ˆå°‘ï¼Œä¸è¿‡éªŒè¯ä¸‹æ¥ <a href="https://github.com/indutny/fft.js/" target="_blank" rel="noopener">fft.js</a> æ˜¯å¯ç”¨çš„ã€‚</p><p>Tip: ä¸å¾—ä¸è¯´ç§‘å­¦è®¡ç®—è¿˜æ˜¯ Python æ–¹ä¾¿ï¼Œnumpy å’Œ scipy çœŸçš„å¤ªå¥½ç”¨äº†ã€‚</p><p>ç»è¿‡ FFT ä»¥åï¼Œæˆ‘ä»¬å¾—åˆ°äº† 1025 ä¸ªå¤æ•°ï¼Œå¯¹è¿™äº›å¤æ•°å–æ¨¡ï¼Œå¾—åˆ° 1025 ä¸ªå®æ•°ã€‚</p><pre class="line-numbers language-js"><code class="language-js"><span class="token comment" spellcheck="true">// JS æ²¡æœ‰å¤æ•°ï¼Œæˆ‘ä»¬è‡ªè¡Œå®šä¹‰ä¸€ä¸ª</span><span class="token keyword">class</span> <span class="token class-name">Complex</span> <span class="token punctuation">{</span>  <span class="token function">constructor</span><span class="token punctuation">(</span>real<span class="token punctuation">,</span> imag<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>real <span class="token operator">=</span> real    <span class="token keyword">this</span><span class="token punctuation">.</span>imag <span class="token operator">=</span> imag  <span class="token punctuation">}</span>  <span class="token function">abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>real <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>real <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>imag <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>imag<span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">const</span> rfft <span class="token operator">=</span> <span class="token punctuation">(</span>samples<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FFTJS</span><span class="token punctuation">(</span>samples<span class="token punctuation">.</span>length<span class="token punctuation">)</span>  <span class="token keyword">const</span> out <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">createComplexArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token keyword">const</span> N <span class="token operator">=</span> samples<span class="token punctuation">.</span>length <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span>  f<span class="token punctuation">.</span><span class="token function">realTransform</span><span class="token punctuation">(</span>out<span class="token punctuation">,</span> samples<span class="token punctuation">)</span>  <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    value<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Complex</span><span class="token punctuation">(</span>out<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">*</span>i<span class="token operator">+</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> out<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">*</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> value<span class="token punctuation">}</span><span class="token comment" spellcheck="true">// æ­¤æ—¶æˆ‘ä»¬å¾—åˆ°äº†ä¸€ç»„å®æ•°</span><span class="token keyword">const</span> y <span class="token operator">=</span> <span class="token function">rfft</span><span class="token punctuation">(</span>samples<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>c <span class="token operator">=</span><span class="token operator">></span> c<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Tip:</p><p>å…¶å®è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ä»¬ä¸ä¼šç›´æ¥æŠŠ samples è¿›è¡Œ FFT å˜æ¢ï¼Œè€Œæ˜¯ä¼šå…ˆåº”ç”¨ä¸€ä¸ª Window Functionï¼Œè¿™æ ·åšçš„ç›®çš„å¦‚æœæ„Ÿå…´è¶£å¯ä»¥è‡ªè¡Œäº†è§£ã€‚</p><p>å¯¹äºæˆ‘ä»¬æ¥è¯´ï¼ŒWindow Function å°±æ˜¯ä¸€ä¸ª <code>number[] -&gt; number[]</code> çš„å‡½æ•°ã€‚</p><p>æ¥ä¸‹æ¥å°±æ˜¯å°†è¿™äº›æ•°å­—å˜æ¢åˆ° 0 ~ 1 åŒºé—´ï¼Œè¿™ä¸€æ­¥æ¯”è¾ƒç®€å•ï¼Œè§‚å¯Ÿä¸€ä¸‹æœ€å¤§æœ€å°å€¼åšä¸ªçº¿æ€§å˜æ¢å°±è¡Œäº†ã€‚</p><pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">const</span> result <span class="token operator">=</span> y<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>v <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span>v <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">80</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æœ‰äº†ä¸€ç»„ 0 ~ 1 çš„æ•°å­—ä»¥åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ Canvas è¿›è¡Œç»˜å›¾äº†ã€‚</p><pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">const</span> W <span class="token operator">=</span> <span class="token number">800</span> <span class="token comment" spellcheck="true">// canvas width</span><span class="token keyword">const</span> H <span class="token operator">=</span> <span class="token number">600</span> <span class="token comment" spellcheck="true">// canvas height</span><span class="token keyword">const</span> draw <span class="token operator">=</span> <span class="token punctuation">(</span>spectrum<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> W<span class="token punctuation">,</span> H<span class="token punctuation">)</span>  <span class="token keyword">const</span> barWidth <span class="token operator">=</span> W <span class="token operator">/</span> spectrum<span class="token punctuation">.</span>length  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> spectrum<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> v <span class="token operator">=</span> spectrum<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    <span class="token keyword">const</span> x <span class="token operator">=</span> i <span class="token operator">*</span> barWidth    <span class="token keyword">const</span> height <span class="token operator">=</span> v <span class="token operator">*</span> H    <span class="token keyword">const</span> y <span class="token operator">=</span> H <span class="token operator">-</span> height    ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> barWidth<span class="token punctuation">,</span> height<span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åæˆ‘ä»¬æ¥çœ‹çœ‹ç»“æœï¼Œæ‰“å¼€ <a href="http://cjting.me/audio-vis-demo/" target="_blank" rel="noopener">audio-vis-demo</a>ï¼Œé€‰æ‹©ä¸€ä¸ªéŸ³é¢‘æ–‡ä»¶ï¼Œå–æ¶ˆå‹¾é€‰ â€œSmoothâ€ï¼Œç‚¹å‡»æ’­æ”¾ï¼Œç„¶åæˆ‘ä»¬ä¼šå‘ç°ï¼ŒæŸ±å­å¯ä»¥æ­£å¸¸åœ°ç»˜åˆ¶å‡ºæ¥ï¼Œä½†æ˜¯å®ƒä»¬â€è·³è·ƒâ€œå¾—éå¸¸å‰å®³ï¼Œä¸å¤Ÿå¹³ç¨³ã€‚</p><p>è¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ¼äº†ä¸€æ­¥ï¼Œå«åš Time smoothingã€‚</p><p>å…·ä½“çš„æœºç†æˆ‘å¹¶ä¸ç†è§£ï¼Œæ‰€ä»¥å°±ä¸å†è¯´æ˜äº†ï¼Œå¯¹æˆ‘ä»¬çš„ç›®æ ‡æ¥è¯´ï¼Œè¿™éƒ¨åˆ†å½“åšé»‘ç›’å¤„ç†å°±å¯ä»¥äº†ã€‚</p><p>è¿™é‡Œæˆ‘æƒ³è¯´æ˜ä¸€ä¸‹ï¼Œåœ¨æˆ‘çœ‹æ¥ï¼Œå­¦ä¹ ä»»ä½•çŸ¥è¯†éƒ½æ˜¯åˆ†å±‚çš„ï¼Œå­¦åˆ°è‡ªå·±æ„Ÿå…´è¶£çš„å±‚çº§å³å¯ï¼Œå¯¹ä¸‹ä¸€å±‚æœ‰ä¸€ä¸ªå®šæ€§çš„è®¤è¯†ï¼Œéœ€è¦çš„æ—¶å€™å¯ä»¥å†å»ç»†ç©¶ã€‚</p><p>æˆ‘ä»¬å¯ä»¥è®¤ä¸º Time smoothing å°±æ˜¯å¯¹å½“å‰çš„ result å’Œä¸Šä¸€ä¸ª result è¿›è¡ŒæŸç§æ“ä½œï¼Œç„¶åè¾“å‡ºä¸€ç»„å€¼ã€‚</p><p>ä¸‹é¢æ˜¯å…·ä½“çš„ç®—æ³•ï¼Œä»£ç éå¸¸ç®€å•ï¼Œä½†æ˜¯æ•ˆæœéå¸¸æ˜æ˜¾ã€‚</p><pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">const</span> smoothConstantDown <span class="token operator">=</span> <span class="token number">0.08</span><span class="token keyword">const</span> smoothConstantUp <span class="token operator">=</span> <span class="token number">0.8</span><span class="token keyword">if</span><span class="token punctuation">(</span>lastY <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> lastY<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> lastY<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      lastY<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> y<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> smoothConstantDown <span class="token operator">+</span> lastY<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> smoothConstantDown<span class="token punctuation">)</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>      lastY<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> y<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> smoothConstantUp <span class="token operator">+</span> lastY<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> smoothConstantUp<span class="token punctuation">)</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>  lastY <span class="token operator">=</span> y<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬åœ¨ Demo ä¸­å‹¾é€‰ä¸Š â€œSmoothâ€ å¯ç”¨è¿™ä¸ªç®—æ³•ï¼Œç„¶åå°±ä¼šå‘ç°å›¾åƒé©¬ä¸Šå˜å¾—ä¸å†è·³åŠ¨äº†ï¼Œæ•´ä½“ç»“æœå·²ç»å’Œå…¶ä»–æ’­æ”¾å™¨å¾ˆæ¥è¿‘äº†ã€‚</p><p>æ³¨æ„ï¼Œè¿™é‡Œæˆ‘ä»¬æ˜¯ä¸ºäº†å­¦ä¹ åº•å±‚çš„æ­¥éª¤å’Œç»†èŠ‚ï¼Œæ‰€ä»¥å¾ˆå¤šæ“ä½œéƒ½è‡ªå·±æ¥åšã€‚å¦‚æœçœŸçš„éœ€è¦å¼€å‘ç›¸å…³åŠŸèƒ½ï¼Œä½¿ç”¨ WebAudio çš„ API æ˜¯æ›´åˆç†çš„é€‰æ‹©ã€‚</p><p>æˆ‘åœ¨ <a href="http://cjting.me/audio-vis-demo/" target="_blank" rel="noopener">audio-vis-demo</a> ä¸­ä¹ŸåŸºäº WebAudio çš„ API è¿›è¡Œäº†å®ç°ï¼Œä¸»è¦æ˜¯ä¸ºäº†å¯¹æ¯”å’Œå‚è€ƒã€‚</p><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å®Œæ•´åœ°å®ç°äº†ä»ä¸€ç»„æ•°å­—åˆ°å¯è§†åŒ–å›¾å½¢çš„å…¨è¿‡ç¨‹ï¼Œæ·±åˆ‡åœ°æ„Ÿå—åˆ°äº†æ•°å­¦çš„é­…åŠ›ã€‚è¿™é‡Œçš„ç¼–ç ä¸€ç‚¹ä¹Ÿä¸éš¾ï¼Œéš¾çš„ï¼Œæˆ–è€…æ˜¯è®©äººèµå¹çš„ï¼Œæ˜¯èƒŒåçš„æ•°å­¦ï¼Œäººç±»æ™ºæ…§çš‡å† ä¸Šæœ€ç¿çƒ‚çš„æ˜ç ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ•°ç çŸ¥è¯† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°ç  </tag>
            
            <tag> æ•°å­¦ </tag>
            
            <tag> éŸ³é¢‘ </tag>
            
            <tag> éŸ³ä¹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Pytorch Cookbook(å¸¸ç”¨ä»£ç æ®µ)</title>
      <link href="/2021/08/25/pytorch-cookbook-chang-yong-dai-ma-duan/"/>
      <url>/2021/08/25/pytorch-cookbook-chang-yong-dai-ma-duan/</url>
      
        <content type="html"><![CDATA[<h3 id="PyTorchå¸¸ç”¨ä»£ç æ®µæ•´ç†åˆé›†"><a href="#PyTorchå¸¸ç”¨ä»£ç æ®µæ•´ç†åˆé›†" class="headerlink" title="PyTorchå¸¸ç”¨ä»£ç æ®µæ•´ç†åˆé›†"></a>PyTorchå¸¸ç”¨ä»£ç æ®µæ•´ç†åˆé›†</h3><p> <a href="https://www.ctolib.com/user/pe-12647.html" target="_blank" rel="noopener">HudsonEvangeline</a> </p><p>æœ¬æ–‡ä»£ç åŸºäº PyTorch 1.0 ç‰ˆæœ¬ï¼Œéœ€è¦ç”¨åˆ°ä»¥ä¸‹åŒ…</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> collections<span class="token keyword">import</span> os<span class="token keyword">import</span> shutil<span class="token keyword">import</span> tqdm<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> PIL<span class="token punctuation">.</span>Image<span class="token keyword">import</span> torch<span class="token keyword">import</span> torchvision<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åŸºç¡€é…ç½®</p><p>æ£€æŸ¥ PyTorch ç‰ˆæœ¬</p><pre class="line-numbers language-python"><code class="language-python">torch<span class="token punctuation">.</span>__version__               <span class="token comment" spellcheck="true"># PyTorch version</span>torch<span class="token punctuation">.</span>version<span class="token punctuation">.</span>cuda              <span class="token comment" spellcheck="true"># Corresponding CUDA version</span>torch<span class="token punctuation">.</span>backends<span class="token punctuation">.</span>cudnn<span class="token punctuation">.</span>version<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># Corresponding cuDNN version</span>torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>get_device_name<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true"># GPU type</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ›´æ–° PyTorch</p><p>PyTorch å°†è¢«å®‰è£…åœ¨ anaconda3/lib/python3.7/site-packages/torch/ç›®å½•ä¸‹ã€‚</p><pre class="line-numbers language-python"><code class="language-python">conda update pytorch torchvision <span class="token operator">-</span>c pytorch<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å›ºå®šéšæœºç§å­</p><pre class="line-numbers language-python"><code class="language-python">torch<span class="token punctuation">.</span>manual_seed<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>manual_seed_all<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æŒ‡å®šç¨‹åºè¿è¡Œåœ¨ç‰¹å®š GPU å¡ä¸Š</p><p>åœ¨å‘½ä»¤è¡ŒæŒ‡å®šç¯å¢ƒå˜é‡</p><pre class="line-numbers language-python"><code class="language-python">CUDA_VISIBLE_DEVICES<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span> python train<span class="token punctuation">.</span>py<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ–åœ¨ä»£ç ä¸­æŒ‡å®š</p><pre class="line-numbers language-python"><code class="language-python">os<span class="token punctuation">.</span>environ<span class="token punctuation">[</span><span class="token string">'CUDA_VISIBLE_DEVICES'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'0,1'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åˆ¤æ–­æ˜¯å¦æœ‰ CUDA æ”¯æŒ</p><pre class="line-numbers language-python"><code class="language-python">torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è®¾ç½®ä¸º cuDNN benchmark æ¨¡å¼</p><p>Benchmark æ¨¡å¼ä¼šæå‡è®¡ç®—é€Ÿåº¦ï¼Œä½†æ˜¯ç”±äºè®¡ç®—ä¸­æœ‰éšæœºæ€§ï¼Œæ¯æ¬¡ç½‘ç»œå‰é¦ˆç»“æœç•¥æœ‰å·®å¼‚ã€‚</p><pre class="line-numbers language-python"><code class="language-python">torch<span class="token punctuation">.</span>backends<span class="token punctuation">.</span>cudnn<span class="token punctuation">.</span>benchmark <span class="token operator">=</span> <span class="token boolean">True</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœæƒ³è¦é¿å…è¿™ç§ç»“æœæ³¢åŠ¨ï¼Œè®¾ç½®</p><pre class="line-numbers language-python"><code class="language-python">torch<span class="token punctuation">.</span>backends<span class="token punctuation">.</span>cudnn<span class="token punctuation">.</span>deterministic <span class="token operator">=</span> <span class="token boolean">True</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ¸…é™¤ GPU å­˜å‚¨</p><p>æœ‰æ—¶ Control-C ä¸­æ­¢è¿è¡Œå GPU å­˜å‚¨æ²¡æœ‰åŠæ—¶é‡Šæ”¾ï¼Œéœ€è¦æ‰‹åŠ¨æ¸…ç©ºã€‚åœ¨ PyTorch å†…éƒ¨å¯ä»¥</p><pre class="line-numbers language-python"><code class="language-python">torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>empty_cache<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ–åœ¨å‘½ä»¤è¡Œå¯ä»¥å…ˆä½¿ç”¨ ps æ‰¾åˆ°ç¨‹åºçš„ PIDï¼Œå†ä½¿ç”¨ kill ç»“æŸè¯¥è¿›ç¨‹</p><pre class="line-numbers language-python"><code class="language-python">ps aux <span class="token operator">|</span> grep pythonkill <span class="token operator">-</span><span class="token number">9</span> <span class="token punctuation">[</span>pid<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ–è€…ç›´æ¥é‡ç½®æ²¡æœ‰è¢«æ¸…ç©ºçš„ GPU</p><pre class="line-numbers language-python"><code class="language-python">nvidia<span class="token operator">-</span>smi <span class="token operator">-</span><span class="token operator">-</span>gpu<span class="token operator">-</span>reset <span class="token operator">-</span>i <span class="token punctuation">[</span>gpu_id<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¼ é‡å¤„ç†</p><p>å¼ é‡åŸºæœ¬ä¿¡æ¯</p><pre><code>tensor.type()   # Data typetensor.size()   # Shape of the tensor. It is a subclass of Python tupletensor.dim()    # Number of dimensions.</code></pre><p>æ•°æ®ç±»å‹è½¬æ¢</p><pre><code># Set default tensor type. Float in PyTorch is much faster than double.torch.set_default_tensor_type(torch.FloatTensor)# Type convertions.tensor = tensor.cuda()tensor = tensor.cpu()tensor = tensor.float()tensor = tensor.long()</code></pre><p>torch.Tensor ä¸ np.ndarray è½¬æ¢</p><pre><code># torch.Tensor -&gt; np.ndarray.ndarray = tensor.cpu().numpy()# np.ndarray -&gt; torch.Tensor.tensor = torch.from_numpy(ndarray).float()tensor = torch.from_numpy(ndarray.copy()).float()  # If ndarray has negative stride</code></pre><p>torch.Tensor ä¸ PIL.Image è½¬æ¢</p><p>PyTorch ä¸­çš„å¼ é‡é»˜è®¤é‡‡ç”¨ NÃ—DÃ—HÃ—W çš„é¡ºåºï¼Œå¹¶ä¸”æ•°æ®èŒƒå›´åœ¨ [0, 1]ï¼Œéœ€è¦è¿›è¡Œè½¬ç½®å’Œè§„èŒƒåŒ–ã€‚</p><pre><code># torch.Tensor -&gt; PIL.Image.image = PIL.Image.fromarray(torch.clamp(tensor * 255, min=0, max=255    ).byte().permute(1, 2, 0).cpu().numpy())image = torchvision.transforms.functional.to_pil_image(tensor)  # Equivalently way# PIL.Image -&gt; torch.Tensor.tensor = torch.from_numpy(np.asarray(PIL.Image.open(path))    ).permute(2, 0, 1).float() / 255tensor = torchvision.transforms.functional.to_tensor(PIL.Image.open(path))  # Equivalently way</code></pre><p>np.ndarray ä¸ PIL.Image è½¬æ¢</p><pre><code># np.ndarray -&gt; PIL.Image.image = PIL.Image.fromarray(ndarray.astypde(np.uint8))# PIL.Image -&gt; np.ndarray.ndarray = np.asarray(PIL.Image.open(path))</code></pre><p>ä»åªåŒ…å«ä¸€ä¸ªå…ƒç´ çš„å¼ é‡ä¸­æå–å€¼</p><p>è¿™åœ¨è®­ç»ƒæ—¶ç»Ÿè®¡ loss çš„å˜åŒ–è¿‡ç¨‹ä¸­ç‰¹åˆ«æœ‰ç”¨ã€‚å¦åˆ™è¿™å°†ç´¯ç§¯è®¡ç®—å›¾ï¼Œä½¿ GPU å­˜å‚¨å ç”¨é‡è¶Šæ¥è¶Šå¤§ã€‚</p><pre><code>value = tensor.item()</code></pre><p>å¼ é‡å½¢å˜</p><p>å¼ é‡å½¢å˜å¸¸å¸¸éœ€è¦ç”¨äºå°†å·ç§¯å±‚ç‰¹å¾è¾“å…¥å…¨è¿æ¥å±‚çš„æƒ…å½¢ã€‚ç›¸æ¯” torch.viewï¼Œtorch.reshape å¯ä»¥è‡ªåŠ¨å¤„ç†è¾“å…¥å¼ é‡ä¸è¿ç»­çš„æƒ…å†µã€‚</p><pre><code>tensor = torch.reshape(tensor, shape)</code></pre><p>æ‰“ä¹±é¡ºåº</p><pre><code>tensor = tensor[torch.randperm(tensor.size(0))]  # Shuffle the first dimension</code></pre><p>æ°´å¹³ç¿»è½¬</p><p>PyTorch ä¸æ”¯æŒ tensor[::-1] è¿™æ ·çš„è´Ÿæ­¥é•¿æ“ä½œï¼Œæ°´å¹³ç¿»è½¬å¯ä»¥ç”¨å¼ é‡ç´¢å¼•å®ç°ã€‚</p><pre><code># Assume tensor has shape N*D*H*W.tensor = tensor[:, :, :, torch.arange(tensor.size(3) - 1, -1, -1).long()]</code></pre><p>å¤åˆ¶å¼ é‡</p><p>æœ‰ä¸‰ç§å¤åˆ¶çš„æ–¹å¼ï¼Œå¯¹åº”ä¸åŒçš„éœ€æ±‚ã€‚</p><pre><code># Operation                 |  New/Shared memory | Still in computation graph |tensor.clone()            # |        New         |          Yes               |tensor.detach()           # |      Shared        |          No                |tensor.detach.clone()()   # |        New         |          No                |</code></pre><p>æ‹¼æ¥å¼ é‡</p><p>æ³¨æ„ torch.cat å’Œ torch.stack çš„åŒºåˆ«åœ¨äº torch.cat æ²¿ç€ç»™å®šçš„ç»´åº¦æ‹¼æ¥ï¼Œè€Œ torch.stack ä¼šæ–°å¢ä¸€ç»´ã€‚ä¾‹å¦‚å½“å‚æ•°æ˜¯ 3 ä¸ª 10Ã—5 çš„å¼ é‡ï¼Œtorch.cat çš„ç»“æœæ˜¯ 30Ã—5 çš„å¼ é‡ï¼Œè€Œ torch.stack çš„ç»“æœæ˜¯ 3Ã—10Ã—5 çš„å¼ é‡ã€‚</p><pre><code>tensor = torch.cat(list_of_tensors, dim=0)tensor = torch.stack(list_of_tensors, dim=0)</code></pre><p>å°†æ•´æ•°æ ‡è®°è½¬æ¢æˆç‹¬çƒ­ï¼ˆone-hotï¼‰ç¼–ç </p><p>PyTorch ä¸­çš„æ ‡è®°é»˜è®¤ä» 0 å¼€å§‹ã€‚</p><pre><code>N = tensor.size(0)one_hot = torch.zeros(N, num_classes).long()one_hot.scatter_(dim=1, index=torch.unsqueeze(tensor, dim=1), src=torch.ones(N, num_classes).long())</code></pre><p>å¾—åˆ°éé›¶/é›¶å…ƒç´ </p><pre><code>torch.nonzero(tensor)               # Index of non-zero elementstorch.nonzero(tensor == 0)          # Index of zero elementstorch.nonzero(tensor).size(0)       # Number of non-zero elementstorch.nonzero(tensor == 0).size(0)  # Number of zero elements</code></pre><p>å¼ é‡æ‰©å±•</p><pre><code># Expand tensor of shape 64*512 to shape 64*512*7*7.torch.reshape(tensor, (64, 512, 1, 1)).expand(64, 512, 7, 7)</code></pre><p>çŸ©é˜µä¹˜æ³•</p><pre><code># Matrix multiplication: (m*n) * (n*p) -&gt; (m*p).result = torch.mm(tensor1, tensor2)# Batch matrix multiplication: (b*m*n) * (b*n*p) -&gt; (b*m*p).result = torch.bmm(tensor1, tensor2)# Element-wise multiplication.result = tensor1 * tensor2</code></pre><p>è®¡ç®—ä¸¤ç»„æ•°æ®ä¹‹é—´çš„ä¸¤ä¸¤æ¬§å¼è·ç¦»</p><pre><code># X1 is of shape m*d.X1 = torch.unsqueeze(X1, dim=1).expand(m, n, d)# X2 is of shape n*d.X2 = torch.unsqueeze(X2, dim=0).expand(m, n, d)# dist is of shape m*n, where dist[i][j] = sqrt(|X1[i, :] - X[j, :]|^2)dist = torch.sqrt(torch.sum((X1 - X2) ** 2, dim=2))</code></pre><p>æ¨¡å‹å®šä¹‰</p><p>å·ç§¯å±‚</p><p>æœ€å¸¸ç”¨çš„å·ç§¯å±‚é…ç½®æ˜¯</p><pre><code>conv = torch.nn.Conv2d(in_channels, out_channels, kernel_size=3, stride=1, padding=1, bias=True)conv = torch.nn.Conv2d(in_channels, out_channels, kernel_size=1, stride=1, padding=0, bias=True)</code></pre><p>å¦‚æœå·ç§¯å±‚é…ç½®æ¯”è¾ƒå¤æ‚ï¼Œä¸æ–¹ä¾¿è®¡ç®—è¾“å‡ºå¤§å°æ—¶ï¼Œå¯ä»¥åˆ©ç”¨å¦‚ä¸‹å¯è§†åŒ–å·¥å…·è¾…åŠ©</p><p>é“¾æ¥ï¼š<a href="https://ezyang.github.io/convolution-visualizer/index.html" target="_blank" rel="noopener">https://ezyang.github.io/convolution-visualizer/index.html</a></p><p>0GAPï¼ˆGlobal average poolingï¼‰å±‚</p><pre><code>gap = torch.nn.AdaptiveAvgPool2d(output_size=1)</code></pre><p>åŒçº¿æ€§æ±‡åˆï¼ˆbilinear poolingï¼‰</p><pre><code>X = torch.reshape(N, D, H * W)                        # Assume X has shape N*D*H*WX = torch.bmm(X, torch.transpose(X, 1, 2)) / (H * W)  # Bilinear poolingassert X.size() == (N, D, D)X = torch.reshape(X, (N, D * D))X = torch.sign(X) * torch.sqrt(torch.abs(X) + 1e-5)   # Signed-sqrt normalizationX = torch.nn.functional.normalize(X)                  # L2 normalization</code></pre><p>å¤šå¡åŒæ­¥ BNï¼ˆBatch normalizationï¼‰</p><p>å½“ä½¿ç”¨ torch.nn.DataParallel å°†ä»£ç è¿è¡Œåœ¨å¤šå¼  GPU å¡ä¸Šæ—¶ï¼ŒPyTorch çš„ BN å±‚é»˜è®¤æ“ä½œæ˜¯å„å¡ä¸Šæ•°æ®ç‹¬ç«‹åœ°è®¡ç®—å‡å€¼å’Œæ ‡å‡†å·®ï¼ŒåŒæ­¥ BN ä½¿ç”¨æ‰€æœ‰å¡ä¸Šçš„æ•°æ®ä¸€èµ·è®¡ç®— BN å±‚çš„å‡å€¼å’Œæ ‡å‡†å·®ï¼Œç¼“è§£äº†å½“æ‰¹é‡å¤§å°ï¼ˆbatch sizeï¼‰æ¯”è¾ƒå°æ—¶å¯¹å‡å€¼å’Œæ ‡å‡†å·®ä¼°è®¡ä¸å‡†çš„æƒ…å†µï¼Œæ˜¯åœ¨ç›®æ ‡æ£€æµ‹ç­‰ä»»åŠ¡ä¸­ä¸€ä¸ªæœ‰æ•ˆçš„æå‡æ€§èƒ½çš„æŠ€å·§ã€‚</p><p>é“¾æ¥ï¼š<a href="https://github.com/vacancy/Synchronized-BatchNorm-PyTorch" target="_blank" rel="noopener">https://github.com/vacancy/Synchronized-BatchNorm-PyTorch</a></p><p>ç±»ä¼¼ BN æ»‘åŠ¨å¹³å‡</p><p>å¦‚æœè¦å®ç°ç±»ä¼¼ BN æ»‘åŠ¨å¹³å‡çš„æ“ä½œï¼Œåœ¨ forward å‡½æ•°ä¸­è¦ä½¿ç”¨åŸåœ°ï¼ˆinplaceï¼‰æ“ä½œç»™æ»‘åŠ¨å¹³å‡èµ‹å€¼ã€‚</p><pre><code>class BN(torch.nn.Module)    def __init__(self):        ...        self.register_buffer(&#39;running_mean&#39;, torch.zeros(num_features))    def forward(self, X):        ...        self.running_mean += momentum * (current - self.running_mean)</code></pre><p>è®¡ç®—æ¨¡å‹æ•´ä½“å‚æ•°é‡</p><pre><code>num_parameters = sum(torch.numel(parameter) for parameter in model.parameters())</code></pre><p>ç±»ä¼¼ Keras çš„ model.summary() è¾“å‡ºæ¨¡å‹ä¿¡æ¯</p><p>é“¾æ¥ï¼š<a href="https://github.com/sksq96/pytorch-summary" target="_blank" rel="noopener">https://github.com/sksq96/pytorch-summary</a></p><p>æ¨¡å‹æƒå€¼åˆå§‹åŒ–</p><p>æ³¨æ„ model.modules() å’Œ model.children() çš„åŒºåˆ«ï¼šmodel.modules() ä¼šè¿­ä»£åœ°éå†æ¨¡å‹çš„æ‰€æœ‰å­å±‚ï¼Œè€Œ model.children() åªä¼šéå†æ¨¡å‹ä¸‹çš„ä¸€å±‚ã€‚</p><pre><code># Common practise for initialization.for layer in model.modules():    if isinstance(layer, torch.nn.Conv2d):        torch.nn.init.kaiming_normal_(layer.weight, mode=&#39;fan_out&#39;,                                      nonlinearity=&#39;relu&#39;)        if layer.bias is not None:            torch.nn.init.constant_(layer.bias, val=0.0)    elif isinstance(layer, torch.nn.BatchNorm2d):        torch.nn.init.constant_(layer.weight, val=1.0)        torch.nn.init.constant_(layer.bias, val=0.0)    elif isinstance(layer, torch.nn.Linear):        torch.nn.init.xavier_normal_(layer.weight)        if layer.bias is not None:            torch.nn.init.constant_(layer.bias, val=0.0)# Initialization with given tensor.layer.weight = torch.nn.Parameter(tensor)</code></pre><p>éƒ¨åˆ†å±‚ä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹</p><p>æ³¨æ„å¦‚æœä¿å­˜çš„æ¨¡å‹æ˜¯ torch.nn.DataParallelï¼Œåˆ™å½“å‰çš„æ¨¡å‹ä¹Ÿéœ€è¦æ˜¯</p><pre><code>model.load_state_dict(torch.load(&#39;model,pth&#39;), strict=False)</code></pre><p>å°†åœ¨ GPU ä¿å­˜çš„æ¨¡å‹åŠ è½½åˆ° CPU</p><pre><code>model.load_state_dict(torch.load(&#39;model,pth&#39;, map_location=&#39;cpu&#39;))</code></pre><p>æ•°æ®å‡†å¤‡ã€ç‰¹å¾æå–ä¸å¾®è°ƒ</p><p>å¾—åˆ°è§†é¢‘æ•°æ®åŸºæœ¬ä¿¡æ¯</p><pre><code>import cv2video = cv2.VideoCapture(mp4_path)height = int(video.get(cv2.CAP_PROP_FRAME_HEIGHT))width = int(video.get(cv2.CAP_PROP_FRAME_WIDTH))num_frames = int(video.get(cv2.CAP_PROP_FRAME_COUNT))fps = int(video.get(cv2.CAP_PROP_FPS))video.release()</code></pre><p>TSN æ¯æ®µï¼ˆsegmentï¼‰é‡‡æ ·ä¸€å¸§è§†é¢‘</p><pre><code>K = self._num_segmentsif is_train:    if num_frames &gt; K:        # Random index for each segment.        frame_indices = torch.randint(            high=num_frames // K, size=(K,), dtype=torch.long)        frame_indices += num_frames // K * torch.arange(K)    else:        frame_indices = torch.randint(            high=num_frames, size=(K - num_frames,), dtype=torch.long)        frame_indices = torch.sort(torch.cat((            torch.arange(num_frames), frame_indices)))[0]else:    if num_frames &gt; K:        # Middle index for each segment.        frame_indices = num_frames / K // 2        frame_indices += num_frames // K * torch.arange(K)    else:        frame_indices = torch.sort(torch.cat((                                          torch.arange(num_frames), torch.arange(K - num_frames))))[0]assert frame_indices.size() == (K,)return [frame_indices[i] for i in range(K)]</code></pre><p>æå– ImageNet é¢„è®­ç»ƒæ¨¡å‹æŸå±‚çš„å·ç§¯ç‰¹å¾</p><pre><code># VGG-16 relu5-3 feature.model = torchvision.models.vgg16(pretrained=True).features[:-1]# VGG-16 pool5 feature.model = torchvision.models.vgg16(pretrained=True).features# VGG-16 fc7 feature.model = torchvision.models.vgg16(pretrained=True)model.classifier = torch.nn.Sequential(*list(model.classifier.children())[:-3])# ResNet GAP feature.model = torchvision.models.resnet18(pretrained=True)model = torch.nn.Sequential(collections.OrderedDict(    list(model.named_children())[:-1]))with torch.no_grad():    model.eval()    conv_representation = model(image)</code></pre><p>æå– ImageNet é¢„è®­ç»ƒæ¨¡å‹å¤šå±‚çš„å·ç§¯ç‰¹å¾</p><pre><code>class FeatureExtractor(torch.nn.Module):    &quot;&quot;&quot;Helper class to extract several convolution features from the given    pre-trained model.    Attributes:        _model, torch.nn.Module.        _layers_to_extract, list&lt;str&gt; or set&lt;str&gt;    Example:        &gt;&gt;&gt; model = torchvision.models.resnet152(pretrained=True)        &gt;&gt;&gt; model = torch.nn.Sequential(collections.OrderedDict(                list(model.named_children())[:-1]))        &gt;&gt;&gt; conv_representation = FeatureExtractor(                pretrained_model=model,                layers_to_extract={&#39;layer1&#39;, &#39;layer2&#39;, &#39;layer3&#39;, &#39;layer4&#39;})(image)    &quot;&quot;&quot;    def __init__(self, pretrained_model, layers_to_extract):        torch.nn.Module.__init__(self)        self._model = pretrained_model        self._model.eval()        self._layers_to_extract = set(layers_to_extract)    def forward(self, x):        with torch.no_grad():            conv_representation = []            for name, layer in self._model.named_children():                x = layer(x)                if name in self._layers_to_extract:                    conv_representation.append(x)            return conv_representation</code></pre><p>å…¶ä»–é¢„è®­ç»ƒæ¨¡å‹</p><p>é“¾æ¥ï¼š<a href="https://github.com/Cadene/pretrained-models.pytorch" target="_blank" rel="noopener">https://github.com/Cadene/pretrained-models.pytorch</a></p><p>å¾®è°ƒå…¨è¿æ¥å±‚</p><pre><code>model = torchvision.models.resnet18(pretrained=True)for param in model.parameters():    param.requires_grad = Falsemodel.fc = nn.Linear(512, 100)  # Replace the last fc layeroptimizer = torch.optim.SGD(model.fc.parameters(), lr=1e-2, momentum=0.9, weight_decay=1e-4)</code></pre><p>ä»¥è¾ƒå¤§å­¦ä¹ ç‡å¾®è°ƒå…¨è¿æ¥å±‚ï¼Œè¾ƒå°å­¦ä¹ ç‡å¾®è°ƒå·ç§¯å±‚</p><pre><code>model = torchvision.models.resnet18(pretrained=True)finetuned_parameters = list(map(id, model.fc.parameters()))conv_parameters = (p for p in model.parameters() if id(p) not in finetuned_parameters)parameters = [{&#39;params&#39;: conv_parameters, &#39;lr&#39;: 1e-3},               {&#39;params&#39;: model.fc.parameters()}]optimizer = torch.optim.SGD(parameters, lr=1e-2, momentum=0.9, weight_decay=1e-4)</code></pre><p>æ¨¡å‹è®­ç»ƒ</p><p>å¸¸ç”¨è®­ç»ƒå’ŒéªŒè¯æ•°æ®é¢„å¤„ç†</p><p>å…¶ä¸­ ToTensor æ“ä½œä¼šå°† PIL.Image æˆ–å½¢çŠ¶ä¸º HÃ—WÃ—Dï¼Œæ•°å€¼èŒƒå›´ä¸º [0, 255] çš„ np.ndarray è½¬æ¢ä¸ºå½¢çŠ¶ä¸º DÃ—HÃ—Wï¼Œæ•°å€¼èŒƒå›´ä¸º [0.0, 1.0] çš„ torch.Tensorã€‚</p><pre><code>train_transform = torchvision.transforms.Compose([    torchvision.transforms.RandomResizedCrop(size=224,                                             scale=(0.08, 1.0)),    torchvision.transforms.RandomHorizontalFlip(),    torchvision.transforms.ToTensor(),    torchvision.transforms.Normalize(mean=(0.485, 0.456, 0.406),                                     std=(0.229, 0.224, 0.225)), ]) val_transform = torchvision.transforms.Compose([    torchvision.transforms.Resize(224),    torchvision.transforms.CenterCrop(224),    torchvision.transforms.ToTensor(),    torchvision.transforms.Normalize(mean=(0.485, 0.456, 0.406),                                     std=(0.229, 0.224, 0.225)),])</code></pre><p>è®­ç»ƒåŸºæœ¬ä»£ç æ¡†æ¶</p><pre><code>for t in epoch(80):    for images, labels in tqdm.tqdm(train_loader, desc=&#39;Epoch %3d&#39; % (t + 1)):        images, labels = images.cuda(), labels.cuda()        scores = model(images)        loss = loss_function(scores, labels)        optimizer.zero_grad()        loss.backward()        optimizer.step()</code></pre><p>æ ‡è®°å¹³æ»‘ï¼ˆlabel smoothingï¼‰</p><pre><code>for images, labels in train_loader:    images, labels = images.cuda(), labels.cuda()    N = labels.size(0)    # C is the number of classes.    smoothed_labels = torch.full(size=(N, C), fill_value=0.1 / (C - 1)).cuda()    smoothed_labels.scatter_(dim=1, index=torch.unsqueeze(labels, dim=1), value=0.9)    score = model(images)    log_prob = torch.nn.functional.log_softmax(score, dim=1)    loss = -torch.sum(log_prob * smoothed_labels) / N    optimizer.zero_grad()    loss.backward()    optimizer.step()</code></pre><p>Mixup</p><pre><code>beta_distribution = torch.distributions.beta.Beta(alpha, alpha)for images, labels in train_loader:    images, labels = images.cuda(), labels.cuda()    # Mixup images.    lambda_ = beta_distribution.sample([]).item()    index = torch.randperm(images.size(0)).cuda()    mixed_images = lambda_ * images + (1 - lambda_) * images[index, :]    # Mixup loss.        scores = model(mixed_images)    loss = (lambda_ * loss_function(scores, labels)             + (1 - lambda_) * loss_function(scores, labels[index]))    optimizer.zero_grad()    loss.backward()    optimizer.step()</code></pre><p>L1 æ­£åˆ™åŒ–</p><pre><code>l1_regularization = torch.nn.L1Loss(reduction=&#39;sum&#39;)loss = ...  # Standard cross-entropy lossfor param in model.parameters():    loss += torch.sum(torch.abs(param))loss.backward()</code></pre><p>ä¸å¯¹åç½®é¡¹è¿›è¡Œ L2 æ­£åˆ™åŒ–/æƒå€¼è¡°å‡ï¼ˆweight decayï¼‰</p><pre><code>bias_list = (param for name, param in model.named_parameters() if name[-4:] == &#39;bias&#39;)others_list = (param for name, param in model.named_parameters() if name[-4:] != &#39;bias&#39;)parameters = [{&#39;parameters&#39;: bias_list, &#39;weight_decay&#39;: 0},                              {&#39;parameters&#39;: others_list}]optimizer = torch.optim.SGD(parameters, lr=1e-2, momentum=0.9, weight_decay=1e-4)</code></pre><p>æ¢¯åº¦è£å‰ªï¼ˆgradient clippingï¼‰</p><pre><code>torch.nn.utils.clip_grad_norm_(model.parameters(), max_norm=20)</code></pre><p>è®¡ç®— Softmax è¾“å‡ºçš„å‡†ç¡®ç‡</p><pre><code>score = model(images)prediction = torch.argmax(score, dim=1)num_correct = torch.sum(prediction == labels).item()accuruacy = num_correct / labels.size(0)</code></pre><p>å¯è§†åŒ–æ¨¡å‹å‰é¦ˆçš„è®¡ç®—å›¾</p><p>é“¾æ¥ï¼š<a href="https://github.com/szagoruyko/pytorchviz" target="_blank" rel="noopener">https://github.com/szagoruyko/pytorchviz</a></p><p>å¯è§†åŒ–å­¦ä¹ æ›²çº¿</p><p>æœ‰ Facebook è‡ªå·±å¼€å‘çš„ Visdom å’Œ Tensorboard ä¸¤ä¸ªé€‰æ‹©ã€‚</p><p><a href="https://github.com/facebookresearch/visdom" target="_blank" rel="noopener">https://github.com/facebookresearch/visdom</a></p><p><a href="https://github.com/lanpa/tensorboardX" target="_blank" rel="noopener">https://github.com/lanpa/tensorboardX</a></p><pre><code># Example using Visdom.vis = visdom.Visdom(env=&#39;Learning curve&#39;, use_incoming_socket=False)assert self._visdom.check_connection()self._visdom.close()options = collections.namedtuple(&#39;Options&#39;, [&#39;loss&#39;, &#39;acc&#39;, &#39;lr&#39;])(    loss={&#39;xlabel&#39;: &#39;Epoch&#39;, &#39;ylabel&#39;: &#39;Loss&#39;, &#39;showlegend&#39;: True},    acc={&#39;xlabel&#39;: &#39;Epoch&#39;, &#39;ylabel&#39;: &#39;Accuracy&#39;, &#39;showlegend&#39;: True},    lr={&#39;xlabel&#39;: &#39;Epoch&#39;, &#39;ylabel&#39;: &#39;Learning rate&#39;, &#39;showlegend&#39;: True})for t in epoch(80):    tran(...)    val(...)    vis.line(X=torch.Tensor([t + 1]), Y=torch.Tensor([train_loss]),             name=&#39;train&#39;, win=&#39;Loss&#39;, update=&#39;append&#39;, opts=options.loss)    vis.line(X=torch.Tensor([t + 1]), Y=torch.Tensor([val_loss]),             name=&#39;val&#39;, win=&#39;Loss&#39;, update=&#39;append&#39;, opts=options.loss)    vis.line(X=torch.Tensor([t + 1]), Y=torch.Tensor([train_acc]),             name=&#39;train&#39;, win=&#39;Accuracy&#39;, update=&#39;append&#39;, opts=options.acc)    vis.line(X=torch.Tensor([t + 1]), Y=torch.Tensor([val_acc]),             name=&#39;val&#39;, win=&#39;Accuracy&#39;, update=&#39;append&#39;, opts=options.acc)    vis.line(X=torch.Tensor([t + 1]), Y=torch.Tensor([lr]),             win=&#39;Learning rate&#39;, update=&#39;append&#39;, opts=options.lr)</code></pre><p>å¾—åˆ°å½“å‰å­¦ä¹ ç‡</p><pre><code># If there is one global learning rate (which is the common case).lr = next(iter(optimizer.param_groups))[&#39;lr&#39;]# If there are multiple learning rates for different layers.all_lr = []for param_group in optimizer.param_groups:    all_lr.append(param_group[&#39;lr&#39;])</code></pre><p>å­¦ä¹ ç‡è¡°å‡</p><pre><code># Reduce learning rate when validation accuarcy plateau.scheduler = torch.optim.lr_scheduler.ReduceLROnPlateau(optimizer, mode=&#39;max&#39;, patience=5, verbose=True)for t in range(0, 80):    train(...); val(...)    scheduler.step(val_acc)# Cosine annealing learning rate.scheduler = torch.optim.lr_scheduler.CosineAnnealingLR(optimizer, T_max=80)# Reduce learning rate by 10 at given epochs.scheduler = torch.optim.lr_scheduler.MultiStepLR(optimizer, milestones=[50, 70], gamma=0.1)for t in range(0, 80):    scheduler.step()        train(...); val(...)# Learning rate warmup by 10 epochs.scheduler = torch.optim.lr_scheduler.LambdaLR(optimizer, lr_lambda=lambda t: t / 10)for t in range(0, 10):    scheduler.step()    train(...); val(...)</code></pre><p>ä¿å­˜ä¸åŠ è½½æ–­ç‚¹</p><p>æ³¨æ„ä¸ºäº†èƒ½å¤Ÿæ¢å¤è®­ç»ƒï¼Œæˆ‘ä»¬éœ€è¦åŒæ—¶ä¿å­˜æ¨¡å‹å’Œä¼˜åŒ–å™¨çš„çŠ¶æ€ï¼Œä»¥åŠå½“å‰çš„è®­ç»ƒè½®æ•°ã€‚</p><pre><code># Save checkpoint.is_best = current_acc &gt; best_accbest_acc = max(best_acc, current_acc)checkpoint = {    &#39;best_acc&#39;: best_acc,        &#39;epoch&#39;: t + 1,    &#39;model&#39;: model.state_dict(),    &#39;optimizer&#39;: optimizer.state_dict(),}model_path = os.path.join(&#39;model&#39;, &#39;checkpoint.pth.tar&#39;)torch.save(checkpoint, model_path)if is_best:    shutil.copy(&#39;checkpoint.pth.tar&#39;, model_path)# Load checkpoint.if resume:    model_path = os.path.join(&#39;model&#39;, &#39;checkpoint.pth.tar&#39;)    assert os.path.isfile(model_path)    checkpoint = torch.load(model_path)    best_acc = checkpoint[&#39;best_acc&#39;]    start_epoch = checkpoint[&#39;epoch&#39;]    model.load_state_dict(checkpoint[&#39;model&#39;])    optimizer.load_state_dict(checkpoint[&#39;optimizer&#39;])    print(&#39;Load checkpoint at epoch %d.&#39; % start_epoch)</code></pre><p>è®¡ç®—å‡†ç¡®ç‡ã€æŸ¥å‡†ç‡ï¼ˆprecisionï¼‰ã€æŸ¥å…¨ç‡ï¼ˆrecallï¼‰</p><pre><code># data[&#39;label&#39;] and data[&#39;prediction&#39;] are groundtruth label and prediction # for each image, respectively.accuracy = np.mean(data[&#39;label&#39;] == data[&#39;prediction&#39;]) * 100# Compute recision and recall for each class.for c in range(len(num_classes)):    tp = np.dot((data[&#39;label&#39;] == c).astype(int),                (data[&#39;prediction&#39;] == c).astype(int))    tp_fp = np.sum(data[&#39;prediction&#39;] == c)    tp_fn = np.sum(data[&#39;label&#39;] == c)    precision = tp / tp_fp * 100    recall = tp / tp_fn * 100</code></pre><p>PyTorch å…¶ä»–æ³¨æ„äº‹é¡¹</p><p>æ¨¡å‹å®šä¹‰</p><ul><li>å»ºè®®æœ‰å‚æ•°çš„å±‚å’Œæ±‡åˆï¼ˆpoolingï¼‰å±‚ä½¿ç”¨ torch.nn æ¨¡å—å®šä¹‰ï¼Œæ¿€æ´»å‡½æ•°ç›´æ¥ä½¿ç”¨ torch.nn.functionalã€‚torch.nn æ¨¡å—å’Œ torch.nn.functional çš„åŒºåˆ«åœ¨äºï¼Œtorch.nn æ¨¡å—åœ¨è®¡ç®—æ—¶åº•å±‚è°ƒç”¨äº† torch.nn.functionalï¼Œä½† torch.nn æ¨¡å—åŒ…æ‹¬è¯¥å±‚å‚æ•°ï¼Œè¿˜å¯ä»¥åº”å¯¹è®­ç»ƒå’Œæµ‹è¯•ä¸¤ç§ç½‘ç»œçŠ¶æ€ã€‚ä½¿ç”¨ torch.nn.functional æ—¶è¦æ³¨æ„ç½‘ç»œçŠ¶æ€ï¼Œå¦‚</li></ul><pre><code>def forward(self, x):    ...    x = torch.nn.functional.dropout(x, p=0.5, training=self.training)</code></pre><ul><li>model(x) å‰ç”¨ model.train() å’Œ model.eval() åˆ‡æ¢ç½‘ç»œçŠ¶æ€ã€‚</li><li>ä¸éœ€è¦è®¡ç®—æ¢¯åº¦çš„ä»£ç å—ç”¨ with torch.no_grad() åŒ…å«èµ·æ¥ã€‚model.eval() å’Œ torch.no_grad() çš„åŒºåˆ«åœ¨äºï¼Œmodel.eval() æ˜¯å°†ç½‘ç»œåˆ‡æ¢ä¸ºæµ‹è¯•çŠ¶æ€ï¼Œä¾‹å¦‚ BN å’Œéšæœºå¤±æ´»ï¼ˆdropoutï¼‰åœ¨è®­ç»ƒå’Œæµ‹è¯•é˜¶æ®µä½¿ç”¨ä¸åŒçš„è®¡ç®—æ–¹æ³•ã€‚torch.no_grad() æ˜¯å…³é—­ PyTorch å¼ é‡çš„è‡ªåŠ¨æ±‚å¯¼æœºåˆ¶ï¼Œä»¥å‡å°‘å­˜å‚¨ä½¿ç”¨å’ŒåŠ é€Ÿè®¡ç®—ï¼Œå¾—åˆ°çš„ç»“æœæ— æ³•è¿›è¡Œ loss.backward()ã€‚</li><li>torch.nn.CrossEntropyLoss çš„è¾“å…¥ä¸éœ€è¦ç»è¿‡ Softmaxã€‚torch.nn.CrossEntropyLoss ç­‰ä»·äº torch.nn.functional.log_softmax + torch.nn.NLLLossã€‚</li><li>loss.backward() å‰ç”¨ optimizer.zero_grad() æ¸…é™¤ç´¯ç§¯æ¢¯åº¦ã€‚optimizer.zero_grad() å’Œ model.zero_grad() æ•ˆæœä¸€æ ·ã€‚</li></ul><p>PyTorch æ€§èƒ½ä¸è°ƒè¯•</p><ul><li>torch.utils.data.DataLoader ä¸­å°½é‡è®¾ç½® pin_memory=Trueï¼Œå¯¹ç‰¹åˆ«å°çš„æ•°æ®é›†å¦‚ MNIST è®¾ç½® pin_memory=False åè€Œæ›´å¿«ä¸€äº›ã€‚num_workers çš„è®¾ç½®éœ€è¦åœ¨å®éªŒä¸­æ‰¾åˆ°æœ€å¿«çš„å–å€¼ã€‚</li><li>ç”¨ del åŠæ—¶åˆ é™¤ä¸ç”¨çš„ä¸­é—´å˜é‡ï¼ŒèŠ‚çº¦ GPU å­˜å‚¨ã€‚</li><li>ä½¿ç”¨ inplace æ“ä½œå¯èŠ‚çº¦ GPU å­˜å‚¨ï¼Œå¦‚</li></ul><pre><code>x = torch.nn.functional.relu(x, inplace=True)</code></pre><ul><li>å‡å°‘ CPU å’Œ GPU ä¹‹é—´çš„æ•°æ®ä¼ è¾“ã€‚ä¾‹å¦‚å¦‚æœä½ æƒ³çŸ¥é“ä¸€ä¸ª epoch ä¸­æ¯ä¸ª mini-batch çš„ loss å’Œå‡†ç¡®ç‡ï¼Œå…ˆå°†å®ƒä»¬ç´¯ç§¯åœ¨ GPU ä¸­ç­‰ä¸€ä¸ª epoch ç»“æŸä¹‹åä¸€èµ·ä¼ è¾“å› CPU ä¼šæ¯”æ¯ä¸ª mini-batch éƒ½è¿›è¡Œä¸€æ¬¡ GPU åˆ° CPU çš„ä¼ è¾“æ›´å¿«ã€‚</li><li>ä½¿ç”¨åŠç²¾åº¦æµ®ç‚¹æ•° half() ä¼šæœ‰ä¸€å®šçš„é€Ÿåº¦æå‡ï¼Œå…·ä½“æ•ˆç‡ä¾èµ–äº GPU å‹å·ã€‚éœ€è¦å°å¿ƒæ•°å€¼ç²¾åº¦è¿‡ä½å¸¦æ¥çš„ç¨³å®šæ€§é—®é¢˜ã€‚</li><li>æ—¶å¸¸ä½¿ç”¨ assert tensor.size() == (N, D, H, W) ä½œä¸ºè°ƒè¯•æ‰‹æ®µï¼Œç¡®ä¿å¼ é‡ç»´åº¦å’Œä½ è®¾æƒ³ä¸­ä¸€è‡´ã€‚</li><li>é™¤äº†æ ‡è®° y å¤–ï¼Œå°½é‡å°‘ä½¿ç”¨ä¸€ç»´å¼ é‡ï¼Œä½¿ç”¨ n*1 çš„äºŒç»´å¼ é‡ä»£æ›¿ï¼Œå¯ä»¥é¿å…ä¸€äº›æ„æƒ³ä¸åˆ°çš„ä¸€ç»´å¼ é‡è®¡ç®—ç»“æœã€‚</li><li>ç»Ÿè®¡ä»£ç å„éƒ¨åˆ†è€—æ—¶</li></ul><pre><code>with torch.autograd.profiler.profile(enabled=True, use_cuda=False) as profile:    ...print(profile)</code></pre><p>æˆ–è€…åœ¨å‘½ä»¤è¡Œè¿è¡Œ</p><pre><code>python -m torch.utils.bottleneck main.py</code></pre><p>è‡´è°¢</p><p>æ„Ÿè°¢ @äº›è®¸æµå¹´å’Œ@El tnotoçš„å‹˜è¯¯ã€‚ç”±äºä½œè€…æ‰ç–å­¦æµ…ï¼Œæ›´å…¼æ—¶é—´å’Œç²¾åŠ›æ‰€é™ï¼Œä»£ç ä¸­é”™è¯¯ä¹‹å¤„åœ¨æ‰€éš¾å…ï¼Œæ•¬è¯·è¯»è€…æ‰¹è¯„æŒ‡æ­£ã€‚</p><p>å‚è€ƒèµ„æ–™</p><ul><li>PyTorch å®˜æ–¹ä»£ç ï¼špytorch/examples (<a href="https://link.zhihu.com/?target=https%3A//github.com/pytorch/examples)" target="_blank" rel="noopener">https://link.zhihu.com/?target=https%3A//github.com/pytorch/examples)</a></li><li>PyTorch è®ºå›ï¼šPyTorch Forums (<a href="https://link.zhihu.com/?target=https%3A//discuss.pytorch.org/latest%3Forder%3Dviews)" target="_blank" rel="noopener">https://link.zhihu.com/?target=https%3A//discuss.pytorch.org/latest%3Forder%3Dviews)</a></li><li>PyTorch æ–‡æ¡£ï¼š<a href="http://pytorch.org/docs/stable/index.html" target="_blank" rel="noopener">http://pytorch.org/docs/stable/index.html</a> (<a href="https://link.zhihu.com/?target=http%3A//pytorch.org/docs/stable/index.html)" target="_blank" rel="noopener">https://link.zhihu.com/?target=http%3A//pytorch.org/docs/stable/index.html)</a></li><li>å…¶ä»–åŸºäº PyTorch çš„å…¬å¼€å®ç°ä»£ç ï¼Œæ— æ³•ä¸€ä¸€åˆ—ä¸¾</li></ul><p>å¼ çš“ï¼šå—äº¬å¤§å­¦è®¡ç®—æœºç³»æœºå™¨å­¦ä¹ ä¸æ•°æ®æŒ–æ˜æ‰€ï¼ˆLAMDAï¼‰ç¡•å£«ç”Ÿï¼Œç ”ç©¶æ–¹å‘ä¸ºè®¡ç®—æœºè§†è§‰å’Œæœºå™¨å­¦ä¹ ï¼Œç‰¹åˆ«æ˜¯è§†è§‰è¯†åˆ«å’Œæ·±åº¦å­¦ä¹ ã€‚ä¸ªäººä¸»é¡µï¼š<a href="http://lamda.nju.edu.cn/zhangh/" target="_blank" rel="noopener">http://lamda.nju.edu.cn/zhangh/</a></p><p><em>åŸçŸ¥ä¹é“¾æ¥ï¼š</em> <a href="https://zhuanlan.zhihu.com/p/59205847?" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/59205847?</a></p><p>æŸ¥çœ‹åŸæ–‡ï¼š <a href="https://www.jiqizhixin.com/articles/2019-04-25-8" target="_blank" rel="noopener">ç‚¹èµæ”¶è—ï¼šPyTorchå¸¸ç”¨ä»£ç æ®µæ•´ç†åˆé›†</a><a href="https://www.jiqizhixin.com/articles/2019-04-25-8" target="_blank" rel="noopener">https://www.jiqizhixin.com/articles/2019-04-25-8</a>)</p>]]></content>
      
      
      <categories>
          
          <category> pytorch </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> pytorch </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CNNç»å…¸æ¨¡å‹å¤ç°æ•°æ®åˆ†æè§£æ</title>
      <link href="/2021/08/14/cnn-jing-dian-mo-xing-fu-xian-shu-ju-fen-xi-jie-xi/"/>
      <url>/2021/08/14/cnn-jing-dian-mo-xing-fu-xian-shu-ju-fen-xi-jie-xi/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ¬æ¬¡å…±åŠ¨æ‰‹å®ç°äº†æ¨¡å‹LeNetã€AlexNetã€VGG(11 13 16 19)ã€GoogLeNetå…±7ä¸ªæ¨¡å‹ï¼Œä»¥CIFAR10æ•°æ®é›†ä½œä¸ºåˆ†ç±»ç»“æœè·‘æ•°æ®å‰å‰ååè·‘äº†å¤§æ¦‚æœ‰å‡ å¤©å§ï¼ˆå½“ç„¶å¹¶ä¸æ˜¯ä¸€ç›´åœ¨è·‘æ•°æ®ï¼‰ï¼Œç»ˆäºå¾—åˆ°äº†æ‰€æœ‰æ•°æ®ï¼Œæœ¬äººå°†æ•°æ®åˆ†æè¿‡ç¨‹è®°å½•ä¸‹æ¥ã€‚ä»¥åå°±ä¼šé€‰æ‹©ç”¨TensorBoardæ¥è®°å½•äº†ã€‚</p><h1 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h1><p>ç”±äºæˆ‘ä»¬æœ€ç»ˆæ˜¯è¦å¾—åˆ°3ç±»å›¾ï¼Œåˆ†åˆ«ä¸ºï¼š</p><ul><li>è¿™ä¸ƒä¸ªæ¨¡å‹çš„losséšç€epochçš„å˜åŒ–çš„æŠ˜çº¿å›¾ï¼ˆæ¯ä¸€ä¸ªæ¨¡å‹éƒ½ç”»ä¸€ä¸ªå¹¶ä¹Ÿæœ‰æ”¾ä¸€å¼ å›¾ä¸­åˆ†æï¼‰</li><li>è¿™ä¸ƒä¸ªæ¨¡å‹çš„test accuracyéšç€epochçš„å˜åŒ–çš„æŠ˜çº¿å›¾ï¼ˆæ¯ä¸€ä¸ªæ¨¡å‹éƒ½ç”»ä¸€ä¸ªå¹¶ä¹Ÿæœ‰æ”¾ä¸€å¼ å›¾ä¸­åˆ†æï¼‰</li><li>è¿™ä¸ƒä¸ªæ¨¡å‹è®­ç»ƒå®Œæ¯•åï¼Œæµ‹è¯•CIFAR10æ•°æ®é›†10ç±»æ¯ä¸€ç±»çš„å‡†ç¡®ç‡ï¼Œå¹¶ä¸”å†åŠ ä¸Šä¸€ä¸ªå¹³å‡å‡†ç¡®ç‡çš„ç›´æ–¹å›¾ï¼ˆä¹Ÿå°±æ˜¯7ä¸ªç›´æ–¹å›¾ï¼Œæ¯ä¸ªç›´æ–¹å›¾æœ‰11é¡¹æ•°æ®ï¼‰</li><li>ä¸ƒä¸ªæ¨¡å‹æœ€ç»ˆé¢„æµ‹å‡†ç¡®ç‡ç›´æ–¹å›¾</li></ul><p><em>æˆ‘ä»¬ä¸€ä¸ªä¸€ä¸ªåˆ†æã€‚</em></p><h1 id="ç›®å‰å·²æœ‰æ•°æ®"><a href="#ç›®å‰å·²æœ‰æ•°æ®" class="headerlink" title="ç›®å‰å·²æœ‰æ•°æ®"></a>ç›®å‰å·²æœ‰æ•°æ®</h1><p>ç›®å‰ç»è¿‡æ¨¡å‹è®­ç»ƒï¼Œæˆ‘ä»¬å¾—åˆ°äº†3ä¸ªå­—å…¸all_loss, accuracy, sort_accuracy, å«æœ‰7ä¸ªæ¨¡å‹çš„è®­ç»ƒç»“æœï¼Œåˆ†åˆ«å¯¹åº”æˆ‘ä»¬çš„ç›®æ ‡ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_loss:'</span><span class="token punctuation">,</span> all_loss<span class="token punctuation">,</span> <span class="token string">'accuracy:'</span><span class="token punctuation">,</span> accuracy<span class="token punctuation">,</span> <span class="token string">'sort_accuracy:'</span><span class="token punctuation">,</span> sort_accuracy<span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p><strong>all_loss</strong>:</p><p>{â€˜LeNetâ€™: [1.6242144256544204, 1.31352958249039, 1.1847674048107095, 1.0951759464757533, 1.0312513256027236, 0.9760023163094097, 0.9317566171641237, 0.8888657108683351, 0.851712247841799, 0.8184668843134504, 0.7859083576722551, 0.7644560352320559, 0.7326112778157816, 0.7069267691783393, 0.6854747742204733, 0.6642881736340465, 0.6426100643186026, 0.6204320310554822, 0.6023138596873518, 0.5891161807839563], â€˜AlexNetâ€™: [1.6470382594177528, 1.2535949297921443, 1.0847475018855173, 0.9779244823785295, 0.8868776897513097, 0.8185919923463542, 0.7630485494740865, 0.712278577117148, 0.6728370328667983, 0.6266675178945942, 0.5853622808280238, 0.5530675600163081, 0.5216182161763702, 0.48412983791613073, 0.47559833306859717, 0.4513656324656324, 0.4125896211587231, 0.39553951881992766, 0.37599814571654727, 0.3764796929466118], â€˜VGG11â€™: [1.2797923941720546, 0.8204267419688761, 0.6319287241801801, 0.5093692947448406, 0.3947184955271024, 0.30049776959918817, 0.22226405595217713, 0.1716289870436193, 0.12499573790278794, 0.10720912222238049, 0.08451989348654552, 0.07376416784010903, 0.06238203229706184, 0.05902868207292414, 0.054739658074399546, 0.046656431376819574, 0.0440141692180995, 0.040774361139257746, 0.037835499233601716, 0.038758098736319496], â€˜VGG13â€™: [1.2642371852684509, 0.7722501971989947, 0.5903376623264054, 0.4784044684923213, 0.3800432443847437, 0.30268731431278123, 0.23576976750951137, 0.18087512682027676, 0.1408744841037542, 0.10939275374864717, 0.08912606567770834, 0.07885368761744664, 0.0641673685397174, 0.059465244257598734, 0.05032006161191555, 0.05069959139102436, 0.0446176283173007, 0.04227883966442089, 0.038349986351278245, 0.035195458980138435], â€˜VGG16â€™: [1.4878040287653198, 0.9365591992959952, 0.7370820180763065, 0.6060846281783355, 0.5078294051958777, 0.4291884641894294, 0.3603880833024564, 0.2933719548994623, 0.24789767926725584, 0.198568012527264, 0.1621592563060124, 0.1343770895839271, 0.11871750627541938, 0.0996952341926639, 0.08778401462586306, 0.0753310109254049, 0.06421501902134522, 0.06112010521195529, 0.0573385018331911, 0.0516717257278869], â€˜VGG19â€™: [1.7686422246191509, 1.193289189539907, 0.9002916185599764, 0.7483896711826934, 0.6286251023221199, 0.5321085340417254, 0.4624791795297352, 0.38920851096587106, 0.33552453419684297, 0.2911587263483678, 0.24505771608913646, 0.20557330978696076, 0.1741280048142385, 0.14644487293513345, 0.1290046954908601, 0.11228246268544756, 0.09866908017803183, 0.08531898694664307, 0.08279588602601176, 0.0675076813722277], â€˜GoogLeNetâ€™: [1.2311952696431934, 0.7666956804063924, 0.578668496149885, 0.4777612447205102, 0.3925454377594506, 0.3375073971079134, 0.2815402130908368, 0.23534502303394514, 0.19595492798406297, 0.16418727704554872, 0.14072739037082477, 0.11543235368431186, 0.10002748314839076, 0.08524505978824137, 0.08325784758050138, 0.06983265248925218, 0.06453105599111508, 0.058409628307665974, 0.05595131519743625, 0.05454142128511587]}</p><p><strong>accuracy:</strong></p><p>{â€˜LeNetâ€™: [0.47634, 0.57336, 0.61238, 0.62712, 0.66916, 0.6842, 0.68662, 0.7085, 0.73304, 0.7478, 0.73412, 0.7546, 0.76134, 0.77652, 0.79072, 0.77714, 0.80508, 0.80592, 0.79098, 0.8204], â€˜AlexNetâ€™: [0.4927, 0.588, 0.67408, 0.70754, 0.72952, 0.75498, 0.7811, 0.77366, 0.8081, 0.79696, 0.82704, 0.83872, 0.84712, 0.8661, 0.8742, 0.86808, 0.8815, 0.88648, 0.88684, 0.88756], â€˜VGG11â€™: [0.69674, 0.76524, 0.81788, 0.8647, 0.91078, 0.93784, 0.95356, 0.97072, 0.97222, 0.96346, 0.98072, 0.97492, 0.983, 0.98192, 0.9873, 0.98874, 0.98556, 0.99128, 0.98768, 0.99384], â€˜VGG13â€™: [0.6891, 0.77314, 0.83566, 0.88822, 0.90306, 0.92948, 0.93804, 0.96178, 0.97378, 0.97418, 0.97518, 0.98266, 0.98802, 0.9846, 0.98568, 0.98912, 0.99238, 0.9936, 0.99396, 0.98878], â€˜VGG16â€™: [0.61826, 0.72454, 0.79506, 0.81732, 0.84844, 0.88578, 0.90558, 0.92866, 0.93832, 0.9508, 0.95308, 0.96834, 0.97676, 0.95392, 0.98222, 0.98524, 0.98964, 0.98392, 0.98868, 0.98892], â€˜VGG19â€™: [0.4279, 0.66604, 0.7312, 0.77616, 0.82448, 0.84562, 0.87258, 0.90588, 0.9072, 0.93078, 0.94332, 0.95704, 0.95202, 0.9642, 0.97252, 0.9682, 0.97178, 0.97656, 0.97264, 0.98384], â€˜GoogLeNetâ€™: [0.68024, 0.78884, 0.84078, 0.87326, 0.88924, 0.90944, 0.92276, 0.93896, 0.94442, 0.95026, 0.9642, 0.96864, 0.97296, 0.97084, 0.97456, 0.97932, 0.98056, 0.98624, 0.98712, 0.98292]} </p><p><strong>sort_accuracy ï¼š</strong></p><p>{â€˜LeNetâ€™: [0.8550247116968699, 0.9040880503144654, 0.7291338582677165, 0.7156105100463679, 0.8411949685534591, 0.688135593220339, 0.8456692913385827, 0.8050847457627118, 0.9357366771159875, 0.8855799373040752], â€˜AlexNetâ€™: [0.9159802306425041, 0.9119496855345912, 0.8267716535433071, 0.7372488408037094, 0.8915094339622641, 0.8101694915254237, 0.9700787401574803, 0.888135593220339, 0.9780564263322884, 0.9482758620689655], â€˜VGG11â€™: [1.0, 0.9921383647798742, 0.9921259842519685, 0.9953632148377125, 0.9874213836477987, 0.988135593220339, 0.9984251968503937, 0.9966101694915255, 0.9952978056426333, 0.9984326018808778], â€˜VGG13â€™: [0.9857142857142858, 0.9910714285714286, 0.9846153846153847, 0.9775641025641025, 0.9801980198019802, 0.9935275080906149, 0.9819819819819819, 0.9933110367892977, 0.9866220735785953, 1.0], â€˜VGG16â€™: [0.9821428571428571, 1.0, 0.9907692307692307, 0.9871794871794872, 0.9966996699669967, 0.9935275080906149, 0.993993993993994, 0.9832775919732442, 0.9899665551839465, 1.0], â€˜VGG19â€™: [0.9964285714285714, 0.9821428571428571, 0.9723076923076923, 0.9166666666666666, 0.9933993399339934, 0.9805825242718447, 0.984984984984985, 0.9899665551839465, 0.9966555183946488, 1.0], â€˜GoogLeNetâ€™: [0.9892857142857143, 0.9970238095238095, 0.9723076923076923, 0.967948717948718, 0.9834983498349835, 0.970873786407767, 0.996996996996997, 0.9899665551839465, 0.9933110367892977, 0.9879518072289156]}</p></blockquote><h1 id="å¯¼å…¥å¿…è¦åº“"><a href="#å¯¼å…¥å¿…è¦åº“" class="headerlink" title="å¯¼å…¥å¿…è¦åº“"></a>å¯¼å…¥å¿…è¦åº“</h1><p> é¦–å…ˆå¯¼å…¥å¿…è¦çš„åº“ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸»è¦ä½¿ç”¨åˆ°matplotlibåº“ï¼Œç”±äºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯jupyter notebookï¼Œæ‰€ä»¥æˆ‘ä»¬é¢å¤–åŠ äº†ä¸ªå‘½ä»¤<code>%matplotlib inline</code>ï¼Œè¿™æ˜¯pythonä¸€ä¸ªé­”æœ¯æ–¹æ³•ï¼Œå¯ä»¥å°†æˆ‘ä»¬çš„å›¾åµŒå¥—åˆ°cellçš„è¾“å‡ºé‡Œé¢ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token operator">%</span>matplotlib inline<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">import</span> matplotlib<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h1 id="é¢œè‰²è®¾ç½®"><a href="#é¢œè‰²è®¾ç½®" class="headerlink" title="é¢œè‰²è®¾ç½®"></a>é¢œè‰²è®¾ç½®</h1><h2 id="æŸ¥çœ‹å„ç±»é¢œè‰²"><a href="#æŸ¥çœ‹å„ç±»é¢œè‰²" class="headerlink" title="æŸ¥çœ‹å„ç±»é¢œè‰²"></a>æŸ¥çœ‹å„ç±»é¢œè‰²</h2><p>ç”±äºæˆ‘ä»¬éœ€è¦å°†å„ç§æŠ˜çº¿ç”»åˆ°ä¸€å¼ å›¾ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬å°½é‡ä¸åŒæ¨¡å‹ä½¿ç”¨ä¸åŒé¢œè‰²ï¼Œæ‰€ä»¥æˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£éƒ½æœ‰å“ªäº›é¢œè‰²ã€‚</p><p>è¾“å…¥å¦‚ä¸‹ä»£ç ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># åˆ—å‡ºæ‰€æœ‰çš„matplotlibæœ‰çš„é¢œè‰²</span><span class="token keyword">for</span> name<span class="token punctuation">,</span> hex <span class="token keyword">in</span> matplotlib<span class="token punctuation">.</span>colors<span class="token punctuation">.</span>cnames<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> hex<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬å¯ä»¥å¾—åˆ°æ‰€æœ‰çš„é¢œè‰²ä»¥åŠå…¶rgbå€¼(å…±æœ‰148ç§)ï¼š</p><blockquote><p>aliceblue #F0F8FF<br>antiquewhite #FAEBD7<br>aqua #00FFFF<br>aquamarine #7FFFD4<br>azure #F0FFFF<br>beige #F5F5DC<br>bisque #FFE4C4<br>black #000000<br>blanchedalmond #FFEBCD<br>blue #0000FF<br>blueviolet #8A2BE2<br>brown #A52A2A<br>burlywood #DEB887<br>cadetblue #5F9EA0<br>chartreuse #7FFF00<br>chocolate #D2691E<br>coral #FF7F50<br>cornflowerblue #6495ED<br>cornsilk #FFF8DC<br>crimson #DC143C<br>cyan #00FFFF<br>darkblue #00008B<br>darkcyan #008B8B<br>darkgoldenrod #B8860B<br>darkgray #A9A9A9</p><p>[show more (open the raw output data in a text editor) â€¦](vscode-file://vscode-app/d:/Microsoft VS Code/resources/app/out/vs/code/electron-browser/workbench/workbench.html#)</p><p>wheat #F5DEB3 white #FFFFFF whitesmoke #F5F5F5 yellow #FFFF00 yellowgreen #9ACD32</p></blockquote><h2 id="è®¾ç½®è‡ªå·±çš„é¢œè‰²"><a href="#è®¾ç½®è‡ªå·±çš„é¢œè‰²" class="headerlink" title="è®¾ç½®è‡ªå·±çš„é¢œè‰²"></a>è®¾ç½®è‡ªå·±çš„é¢œè‰²</h2><p>å› ä¸ºä¸€å…±æœ‰7ç§æ¨¡å‹ï¼Œæˆ‘ä»¬åªéœ€è¦7ç§é¢œè‰²å°±è¡Œï¼Œè¿™é‡Œç”¨åˆ°äº†zipå°†å…¶æ‰“åŒ…ï¼Œå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'wheat'</span><span class="token punctuation">,</span> <span class="token string">'blue'</span><span class="token punctuation">,</span> <span class="token string">'yellow'</span><span class="token punctuation">,</span> <span class="token string">'green'</span><span class="token punctuation">,</span> <span class="token string">'pink'</span><span class="token punctuation">,</span> <span class="token string">'purple'</span><span class="token punctuation">,</span> <span class="token string">'red'</span><span class="token punctuation">]</span>colors <span class="token operator">=</span> dict<span class="token punctuation">(</span>zip<span class="token punctuation">(</span>all_loss<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> colors<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>colors<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><blockquote><p>{â€˜LeNetâ€™: â€˜wheatâ€™, â€˜AlexNetâ€™: â€˜blueâ€™, â€˜VGG11â€™: â€˜yellowâ€™, â€˜VGG13â€™: â€˜greenâ€™, â€˜VGG16â€™: â€˜pinkâ€™, â€˜VGG19â€™: â€˜purpleâ€™, â€˜GoogLeNetâ€™: â€˜redâ€™}</p></blockquote><p><em>è€Œåæˆ‘ä»¬é€‰æ‹©é¢œè‰²å°±å¯ä»¥ç›´æ¥è¿™ä¹ˆé€‰æ‹©å°±OKã€‚</em></p><h1 id="loss-epochæŠ˜çº¿å›¾"><a href="#loss-epochæŠ˜çº¿å›¾" class="headerlink" title="loss -epochæŠ˜çº¿å›¾"></a>loss -epochæŠ˜çº¿å›¾</h1><h2 id="å„ä¸ªæ¨¡å‹å¯¹æ¯”åˆ†æ"><a href="#å„ä¸ªæ¨¡å‹å¯¹æ¯”åˆ†æ" class="headerlink" title="å„ä¸ªæ¨¡å‹å¯¹æ¯”åˆ†æ"></a>å„ä¸ªæ¨¡å‹å¯¹æ¯”åˆ†æ</h2><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><pre class="line-numbers language-python"><code class="language-python">epoch <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'The loss of Every model with epoch'</span><span class="token punctuation">)</span><span class="token keyword">for</span> name<span class="token punctuation">,</span> loss <span class="token keyword">in</span> all_loss<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># print(name, colors[name])</span>    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>epoch<span class="token punctuation">,</span> loss<span class="token punctuation">,</span> color<span class="token operator">=</span>colors<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">,</span> label<span class="token operator">=</span>name<span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">1.5</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> x<span class="token punctuation">,</span> y <span class="token keyword">in</span> zip<span class="token punctuation">(</span>epoch<span class="token punctuation">,</span> loss<span class="token punctuation">)</span><span class="token punctuation">:</span>        plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token string">'%3s'</span><span class="token operator">%</span>round<span class="token punctuation">(</span>y<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ha<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">,</span> va<span class="token operator">=</span><span class="token string">'bottom'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">'best'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">'loss/all.png'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä»£ç åˆ†æ"><a href="#ä»£ç åˆ†æ" class="headerlink" title="ä»£ç åˆ†æ"></a>ä»£ç åˆ†æ</h3><ol><li>è¿™é‡Œé¢epochä½œä¸ºxè½´ï¼Œä¸€å…±æœ‰20ä¸ªepoch,æ‰€ä»¥æˆ‘ä»¬np.arange(1, 21).</li><li>plt.figure()æ˜¯å»ºç«‹äº†ä¸€ä¸ªå›¾ï¼Œå…¶ä¸­figsizeå‚æ•°æ˜¯ä¸€ä¸ªå…ƒç»„ï¼Œç”¨æ¥å®šä¹‰æˆ‘ä»¬å»ºç«‹çš„å›¾çš„å¤§å°ï¼Œï¼ˆwidth, heightï¼‰ï¼Œmatplotlib çš„ figure å°±æ˜¯ä¸€ä¸ª å•ç‹¬çš„ figure çª—å£, çª—å£é‡Œé¢è¿˜å¯ä»¥æœ‰æ›´å¤šçš„å°å›¾ç‰‡.</li><li>è€Œåæˆ‘ä»¬ç›´æ¥è®¾ç½®plt.title</li><li>éšåæˆ‘ä»¬é€‰æ‹©ç»˜å›¾ï¼Œè¿™é‡Œåªæœ‰ä¸€ä¸ªfigureæ˜¯ä¸ºäº†æŠŠæ‰€æœ‰æŠ˜çº¿ç”»åˆ°ä¸€å¼ å›¾ä¸­</li><li>éšåæˆ‘ä»¬ç›´æ¥é€‰ç”¨plt.plotç»˜å›¾ï¼Œç¬¬ä¸€ä¸ªä¸ºxè½´ï¼Œç¬¬äºŒä¸ªä¸ºyè½´ï¼Œé¢œè‰²é€‰æ‹©æˆ‘ä»¬ä¹‹å‰ä¸€ä¸€å¯¹åº”çš„ï¼Œlabelæ˜¯æˆ‘ä»¬æ‰€é€‰çš„å›¾ä¾‹ï¼Œæˆ‘ä»¬å›¾ä¾‹éœ€è¦åœ¨plt.legend()å‘½ä»¤åæ‰ä¼šæ˜¾ç¤ºã€‚linewidthæ˜¯æˆ‘ä»¬çº¿æ¡çš„ç²—ç»†ï¼Œå®é™…ä¸Šä¹Ÿå¯ä»¥è°ƒæˆè™šçº¿ï¼Œéœ€è¦è°ƒæ•´<code>linestyle==&#39;--&#39;</code>.</li><li>é‡Œé¢åµŒå¥—çš„forå¾ªç¯ç”¨æ¥æ ‡æ³¨å„ä¸ªç‚¹çš„çºµåæ ‡ï¼Œæ ‡æ³¨æ•°æ®ä»¥æ–¹ä¾¿åç»­åˆ†æ</li><li>plt.legend(loc=â€™bestâ€™),locæ˜¯å›¾ä¾‹çš„ä½ç½®ï¼Œè¿™ä¸ªå¯ä»¥è‡ªå®šä¹‰ï¼Œä¹Ÿå¯ä»¥ç›´æ¥â€™bestâ€™è®©ç¨‹åºè‡ªåŠ¨åˆ†é…æœ€å¥½çš„å›¾ä¾‹ä½ç½®ã€‚<strong>å¦‚æœå«Œå›¾ä¾‹æ¡†å°å¯ä»¥ä½¿ç”¨<code>borderpad=2</code>æ›´æ”¹å†…éƒ¨å¡«å……ï¼Œæˆ‘ä»¬å°†ä½¿æ•´ä¸ªå›¾ä¾‹æ¡†å˜å¤§(å•ä½æ˜¯å­—ä½“å¤§å°çš„å€æ•°ï¼Œç±»ä¼¼äº<code>em</code></strong></li><li>plt.savefigæ˜¯ç”¨æ¥ä¿å­˜å›¾ç‰‡ï¼Œé‡Œé¢å¯ä»¥å¡«æˆ‘ä»¬éœ€è¦ä¿å­˜åˆ°çš„è·¯å¾„ã€‚å¿…é¡»æ”¾åˆ°plt.show()å‰é¢ï¼Œå¦åˆ™ä¼šå¾—åˆ°ç©ºå›¾åƒ</li><li>plt.show()æ˜¯ç›´æ¥æ˜¾ç¤ºè¾“å‡ºå›¾åƒ</li></ol><h3 id="è¾“å‡ºç»“æœ"><a href="#è¾“å‡ºç»“æœ" class="headerlink" title="è¾“å‡ºç»“æœ"></a>è¾“å‡ºç»“æœ</h3><blockquote><p> <a href="https://imgtu.com/i/f6BJ29" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/14/f6BJ29.png" alt="loss-epoch"></a></p></blockquote><h3 id="å¯¹æ¯”åˆ†æ"><a href="#å¯¹æ¯”åˆ†æ" class="headerlink" title="å¯¹æ¯”åˆ†æ"></a>å¯¹æ¯”åˆ†æ</h3><p><strong>å…ˆæŒ–ä¸ªå‘</strong></p><h2 id="å•ç‹¬è¾“å‡ºæ¨¡å‹"><a href="#å•ç‹¬è¾“å‡ºæ¨¡å‹" class="headerlink" title="å•ç‹¬è¾“å‡ºæ¨¡å‹"></a>å•ç‹¬è¾“å‡ºæ¨¡å‹</h2><p>è®²è¿‡ä»¥ä¸Šå¦‚ä½•ç»˜å›¾ä¹‹åï¼Œå®é™…ä¸Šæ¥ä¸‹æ¥å°±ç®€å•å¤šäº†ã€‚</p><h3 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><pre class="line-numbers language-python"><code class="language-python">epoch <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">for</span> index<span class="token punctuation">,</span> data <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>all_loss<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    name<span class="token punctuation">,</span> loss <span class="token operator">=</span> data    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span>f<span class="token string">'The loss of model {name} with epoch'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>epoch<span class="token punctuation">,</span> loss<span class="token punctuation">,</span> color<span class="token operator">=</span>colors<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">,</span> label<span class="token operator">=</span>name<span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">1.5</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">'best'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">'loss/The loss of every model with epoch'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä»£ç åˆ†æ-1"><a href="#ä»£ç åˆ†æ-1" class="headerlink" title="ä»£ç åˆ†æ"></a>ä»£ç åˆ†æ</h3><ol><li>è¿™é‡Œé¢ç”±äºä¸Šæ–‡è®²äº†å¤§éƒ¨åˆ†ï¼Œè¿™é‡Œå°±æŒ‘ä¸€éƒ¨åˆ†æ¥çœ‹</li><li>é¦–å…ˆæˆ‘ä»¬å®šä¹‰å›¾åƒå¤§å°ä¹‹åï¼ˆ<del>åˆ«é—®æˆ‘æ€ä¹ˆå¼„çš„å‚æ•°ï¼Œè¯•å‡ºæ¥çš„</del>ï¼‰è¿™é‡Œé¢è®¾å®šäº†æœ‰å­å›¾plt.subplot(a, b, c)å®é™…ä¸Ša, bæ˜¯æŒ‡å‡†å¤‡ç»™å›¾åƒå¹³å‡åˆ†ä¸ºa*bå‡ ä»½ï¼Œcæ˜¯æŒ‡ç›®å‰è¦æ“ä½œçš„ä½ç½®æ˜¯ç¬¬å‡ ä»½å­å›¾ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦è¿›ä¸€æ­¥æ¢ç´¢å¯ä¸å¯ä»¥ä¸å¹³å‡åˆ†ï¼Œå¯ä»¥çœ‹<a href="https://mofanpy.com/tutorials/data-manipulation/plt/subpot1/" target="_blank" rel="noopener">è¿™é‡Œ</a>ï¼Œ<a href="https://blog.csdn.net/math_gao/article/details/109521842?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522162894368316780255248420%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=162894368316780255248420&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-109521842.first_rank_v2_pc_rank_v29&utm_term=matplotlib+%E8%B0%83%E6%95%B4%E5%AD%90%E5%9B%BE%E5%A4%A7%E5%B0%8F&spm=1018.2226.3001.4187" target="_blank" rel="noopener">è°ƒå­å›¾é—´è·</a> å®é™…ä¸Šæˆ‘ä¹Ÿæ˜¯éšä¾¿æ‰¾çš„èµ„æ–™çœ‹ï¼Œå¤§å®¶ä¸Šç½‘éšä¾¿ä¸€æœå°±OKã€‚</li><li>æ¥ç€æ˜¯æˆ‘ä»¬çš„ç»˜å›¾ã€ä¿å­˜äº†ï¼Œæ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œä¸å¤šè¯´äº†ã€‚</li></ol><p><strong>å¦å¤–éœ€è¦æ³¨æ„çš„å°±æ˜¯æˆ‘ä»¬çš„é¡ºåºä¸€å®šè¦æ³¨æ„ï¼Œå¦åˆ™ä¼šå‡ºç°ä¸€äº›æ„æƒ³ä¸åˆ°çš„é”™è¯¯</strong></p><h3 id="è¾“å‡ºç»“æœ-1"><a href="#è¾“å‡ºç»“æœ-1" class="headerlink" title="è¾“å‡ºç»“æœ"></a>è¾“å‡ºç»“æœ</h3><blockquote><p><a href="https://imgtu.com/i/f6BNK1" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/14/f6BNK1.png" alt="The loss of every model with epoch"></a></p></blockquote><h1 id="accuracy-epochæŠ˜çº¿å›¾"><a href="#accuracy-epochæŠ˜çº¿å›¾" class="headerlink" title="accuracy-epochæŠ˜çº¿å›¾"></a>accuracy-epochæŠ˜çº¿å›¾</h1><h2 id="å„ä¸ªæ¨¡å‹çš„å¯¹æ¯”åˆ†æ"><a href="#å„ä¸ªæ¨¡å‹çš„å¯¹æ¯”åˆ†æ" class="headerlink" title="å„ä¸ªæ¨¡å‹çš„å¯¹æ¯”åˆ†æ"></a>å„ä¸ªæ¨¡å‹çš„å¯¹æ¯”åˆ†æ</h2><p>ç”±äºéƒ½æ˜¯æŠ˜çº¿å›¾ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»£ç å·®è·å®é™…ä¸Šå¹¶ä¸å¤§ï¼š</p><h3 id="ä»£ç -2"><a href="#ä»£ç -2" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><pre class="line-numbers language-python"><code class="language-python">epoch <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'The Accuracy of Every model with epoch'</span><span class="token punctuation">)</span><span class="token keyword">for</span> name<span class="token punctuation">,</span> rate <span class="token keyword">in</span> accuracy<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> colors<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>epoch<span class="token punctuation">,</span> rate<span class="token punctuation">,</span> color<span class="token operator">=</span>colors<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">,</span> label<span class="token operator">=</span>name<span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">1.5</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> x<span class="token punctuation">,</span> y <span class="token keyword">in</span> zip<span class="token punctuation">(</span>epoch<span class="token punctuation">,</span> rate<span class="token punctuation">)</span><span class="token punctuation">:</span>        plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token string">'%3s'</span><span class="token operator">%</span>round<span class="token punctuation">(</span>y<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ha<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">,</span> va<span class="token operator">=</span><span class="token string">'bottom'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">'best'</span><span class="token punctuation">,</span> borderpad<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">'accuracy/all.png'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è¾“å‡ºç»“æœ-2"><a href="#è¾“å‡ºç»“æœ-2" class="headerlink" title="è¾“å‡ºç»“æœ"></a>è¾“å‡ºç»“æœ</h3><blockquote><p><a href="https://imgtu.com/i/f6sjdP" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/14/f6sjdP.png" alt="The Accuracy of Every model with epoch"></a></p></blockquote><h3 id="ä»£ç åˆ†æ-2"><a href="#ä»£ç åˆ†æ-2" class="headerlink" title="ä»£ç åˆ†æ"></a>ä»£ç åˆ†æ</h3><p>å®é™…ä¸Šä»£ç æ˜¯éå¸¸ç±»ä¼¼çš„ï¼Œå¹¶ä¸éœ€è¦é¢å¤–å»åˆ†æ</p><h3 id="å¯¹æ¯”åˆ†æ-1"><a href="#å¯¹æ¯”åˆ†æ-1" class="headerlink" title="å¯¹æ¯”åˆ†æ"></a>å¯¹æ¯”åˆ†æ</h3><p><strong>åŒæ ·å…ˆæŒ–ä¸ªå‘</strong></p><h2 id="å•ç‹¬è¾“å‡ºæ¨¡å‹-1"><a href="#å•ç‹¬è¾“å‡ºæ¨¡å‹-1" class="headerlink" title="å•ç‹¬è¾“å‡ºæ¨¡å‹"></a>å•ç‹¬è¾“å‡ºæ¨¡å‹</h2><h3 id="ä»£ç -3"><a href="#ä»£ç -3" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><pre class="line-numbers language-python"><code class="language-python">epoch <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token keyword">for</span> name<span class="token punctuation">,</span> rate <span class="token keyword">in</span> accuracy<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span>f<span class="token string">'The Accuracy of model {name} with epoch'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>epoch<span class="token punctuation">,</span> rate<span class="token punctuation">,</span> color<span class="token operator">=</span>colors<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">,</span> label<span class="token operator">=</span>name<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">'best'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">'accuracy/%s.png'</span><span class="token operator">%</span>name<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è¾“å‡ºç»“æœ-3"><a href="#è¾“å‡ºç»“æœ-3" class="headerlink" title="è¾“å‡ºç»“æœ"></a>è¾“å‡ºç»“æœ</h3><blockquote><p><a href="https://imgtu.com/i/f66YBn" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/14/f66YBn.png" alt="The accuracy of every model with epoch"></a></p></blockquote><h1 id="sort-variety-sortåˆ†å¸ƒç›´æ–¹å›¾"><a href="#sort-variety-sortåˆ†å¸ƒç›´æ–¹å›¾" class="headerlink" title="sort_variety-sortåˆ†å¸ƒç›´æ–¹å›¾"></a>sort_variety-sortåˆ†å¸ƒç›´æ–¹å›¾</h1><h2 id="ä»£ç -4"><a href="#ä»£ç -4" class="headerlink" title="ä»£ç "></a>ä»£ç </h2><pre class="line-numbers language-python"><code class="language-python">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">for</span> index<span class="token punctuation">,</span> data <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>sort_accuracy<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    name<span class="token punctuation">,</span> rate <span class="token operator">=</span> data    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span>f<span class="token string">'The Accuracy Of Every Variety Of {name}'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>classes<span class="token punctuation">,</span> rate<span class="token punctuation">,</span> color<span class="token operator">=</span>colors<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">,</span> label<span class="token operator">=</span>name<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># plt.legend(loc='best')</span>    <span class="token keyword">for</span> x<span class="token punctuation">,</span> y <span class="token keyword">in</span> zip<span class="token punctuation">(</span>classes<span class="token punctuation">,</span> rate<span class="token punctuation">)</span><span class="token punctuation">:</span>        plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token string">"%3s"</span><span class="token operator">%</span>round<span class="token punctuation">(</span>y<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ha<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">,</span> va<span class="token operator">=</span><span class="token string">'bottom'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'The test_acc of every model'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>models_name<span class="token punctuation">,</span> test_acc<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'bgry'</span><span class="token punctuation">)</span><span class="token keyword">for</span> x<span class="token punctuation">,</span> y <span class="token keyword">in</span> zip<span class="token punctuation">(</span>models_name<span class="token punctuation">,</span> test_acc<span class="token punctuation">)</span><span class="token punctuation">:</span>    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token string">'%3s'</span><span class="token operator">%</span>round<span class="token punctuation">(</span>y<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ha<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">,</span> va<span class="token operator">=</span><span class="token string">'bottom'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">'sort_accuracy/the accuracy of every variety.png'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ä»£ç åˆ†æ-3"><a href="#ä»£ç åˆ†æ-3" class="headerlink" title="ä»£ç åˆ†æ"></a>ä»£ç åˆ†æ</h2><ol><li>é¦–å…ˆå®šä¹‰çª—å£å¤§å°</li><li>å¦å¤–è¿™é‡Œé¢ç”¨plt.baræ¥å®šä¹‰ç›´æ–¹å›¾ï¼Œæ¨ªåæ ‡ä¸ºclasses, çºµåæ ‡ä¸ºrateï¼ŒåŒæ ·è¿™é‡Œäº‹å®ä¸Šä¸éœ€è¦å›¾ä¾‹</li><li>è¿™é‡Œé¢ç”±äºæˆ‘ä»¬æ”¾å¥½å¤šå›¾åœ¨ä¸€å¼ å›¾é‡Œäº†ï¼Œæ‰€ä»¥å­—ä½“çœ‹èµ·æ¥æœ‰äº›å°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨frontsizeè¿™ä¸ªå±æ€§æ¥<a href="https://blog.csdn.net/u011008379/article/details/60478927" target="_blank" rel="noopener">è°ƒå¤§å°</a>ã€‚</li><li>å¦å¤–å°±æ˜¯æˆ‘ä»¬ä¿ç•™ä½æ•°åˆ©ç”¨round(y, 2), 2ä¸ºä¿ç•™ä¸¤ä½æ•°å­—ã€‚</li></ol><p><a href="https://imgtu.com/i/f6f13V" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/14/f6f13V.png" alt="the accuracy of every variety"></a></p><h2 id="å¯¹æ¯”åˆ†æ-2"><a href="#å¯¹æ¯”åˆ†æ-2" class="headerlink" title="å¯¹æ¯”åˆ†æ"></a>å¯¹æ¯”åˆ†æ</h2><p>æŒ–å‘</p><p><strong>ç»ˆäºï¼ŒCNNåˆ†æå®Œæ¯•ï¼Œæ¥ä¸‹æ¥å°±è¦å°è¯•æ–°ä¸œè¥¿äº†ï¼Œè¯·å„ä½ç»§ç»­å…³æ³¨æˆ‘çš„åšå®¢ğŸ™‚</strong></p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åˆ†æ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> pytorch </tag>
            
            <tag> CNN </tag>
            
            <tag> matplotlib </tag>
            
            <tag> æ•°æ®åˆ†æ </tag>
            
            <tag> numpy </tag>
            
            <tag> GoogLeNet </tag>
            
            <tag> LeNet </tag>
            
            <tag> AlexNet </tag>
            
            <tag> VGG </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kaggleç«Ÿç„¶ä¸æ”¯æŒTensorBoard</title>
      <link href="/2021/08/13/kaggle-jing-ran-bu-zhi-chi-tensorboard/"/>
      <url>/2021/08/13/kaggle-jing-ran-bu-zhi-chi-tensorboard/</url>
      
        <content type="html"><![CDATA[<p>   æœ€è¿‘æƒ³ç™½å«–ä¸€ä¸‹Kaggleçš„GPUï¼Œè´¹äº†ä¸€äº›åŠŸå¤«<a href="https://blog.csdn.net/bigbennyguo/article/details/87956434?utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control" target="_blank" rel="noopener">å­¦äº†å­¦</a>TensorBoard, åæ¥å‘ç°Kaggleä¸Šçš„å‘½ä»¤å’Œæœ¬åœ°è¿è¡Œè¿˜ä¸ä¸€æ ·ã€‚åˆå­¦äº†å­¦<a href="https://zhuanlan.zhihu.com/p/66748652" target="_blank" rel="noopener">Kaggleä¸Šçš„å¯åŠ¨æ–¹å¼</a>ï¼Œå­¦å®Œåï¼Œæ»¡æ€€æœŸå¾…çš„å¼€å§‹æµ‹è¯•ä¸€äº›åŸºæœ¬ä»£ç ã€‚æ²¡æƒ³åˆ°å´é‡åˆ°äº†è¿™æ ·çš„æƒ…å†µï¼š</p><p><a href="https://imgtu.com/i/fDuEkQ" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/13/fDuEkQ.png" alt="æ°”æ­»æˆ‘äº†ï¼ï¼"></a></p><p>ç«Ÿç„¶è¿è¡Œè¶…æ—¶ï¼æˆ‘æœ¬æ¥ä»¥ä¸ºæ˜¯å› ä¸ºæ²¡æœ‰ç§‘å­¦shangwangçš„åŸå› ï¼Œæ‰€ä»¥å°±å¼€å§‹å¯å­¦çš„ä¸Šç½‘ï¼Œä½†æ˜¯é‡æ–°è¿è¡Œå‘½ä»¤ï¼Œè¿˜æ˜¯è¿™æ ·çš„ç»“æœï¼Œæ²¡æœ‰åŠæ³•ï¼Œåªå¥½ä¸Šç½‘æœä¸€ä¸‹ä¸ºä»€ä¹ˆï¼Œé—®åº¦å¨˜ä¸ºä»€ä¹ˆKaggleä¸Šè¿è¡ŒTensorboardæ²¡æœ‰å“åº”ï¼Œæ²¡æœ‰ç»“æœâ€¦â€¦ã€‚å—¨ï¼Œå¥½å§â€¦â€¦ä¸­æ–‡ç¤¾åŒºç«Ÿç„¶æ ¹æœ¬æ²¡æœ‰äººæå‡ºè¿™ä¸ªé—®é¢˜ï¼Œè‡ªç„¶ä¹Ÿæ²¡æœ‰äººè§£ç­”ï¼Œåæ¥æŠŠé”™è¯¯åŸå› è¾“è¿›å»ï¼Œä¸€è¾“å…¥å°±å¾—åˆ°äº†Kaggleä¸Šé—®ç­”åŒºçš„è®¨è®ºï¼š</p><p><a href="https://imgtu.com/i/fDuc9A" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/13/fDuc9A.png" alt="NO!!!"></a></p><p>å¤šè°¢å¤§å“¥ï¼åŸæ¥TensorBoard å·²è¢«æš‚æ—¶ç¦ç”¨ï¼Œå› ä¸ºå®ƒä¼šå‡æ…¢æ‰€æœ‰ç”¨æˆ·çš„ Jupyter ç¬”è®°æœ¬å¯åŠ¨æ—¶é—´ã€‚ ä»–ä»¬è¯´ä»–ä»¬æ­£åœ¨åŠªåŠ›å°†å…¶å–å› 10 ä¸ªæœˆå‰ã€‚ å®ƒç°åœ¨ä¼¼ä¹å·²ç»é€€å±…äºŒçº¿ã€‚ ä½œä¸ºä¸€ç§è§£å†³æ–¹æ³•ï¼Œæˆ‘å‘ç°è¿™ä¸ª notebook å¯ä»¥åœ¨å½“å‰çš„ docker æ–‡ä»¶ä¸Šè¿è¡Œã€‚ æœ‰å…³åœ¨ Kaggle ä¸­ä½¿ç”¨ TensorBoard çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…æ­¤<a href="https://www.kaggle.com/product-feedback/89671" target="_blank" rel="noopener">issue</a>ã€‚</p><p>ç„¶è€Œæˆ‘å‚é˜…åâ€¦â€¦å‘ç°å½»åº•ç”¨ä¸äº†äº†ï¼Œä¹–ä¹–è‡ªå·±ç”¨matplotlibå®ç°å§â€¦â€¦</p><p>å”‰å”‰å”‰ï¼è¦ä¸æ˜¯æˆ‘æœ¬äººæ²¡æœ‰GPUï¼Œè°ç¨€ç½•Kaggle Tesla K80GPUé‚£ç‚¹ç®—åŠ›â€¦â€¦</p><p>æœ€åé™„ä¸Šä¸€äº›TensorBoardæŠ€å·§ï¼š</p><h2 id="åœ¨Kaggleä¸Šï¼ˆç›®å‰æ²¡å•¥ç”¨ï¼‰"><a href="#åœ¨Kaggleä¸Šï¼ˆç›®å‰æ²¡å•¥ç”¨ï¼‰" class="headerlink" title="åœ¨Kaggleä¸Šï¼ˆç›®å‰æ²¡å•¥ç”¨ï¼‰"></a>åœ¨Kaggleä¸Šï¼ˆç›®å‰æ²¡å•¥ç”¨ï¼‰</h2><p>ç›¸æ¯”æœ¬åœ°æœºä¸­ä½¿ç”¨notebookè¿›è¡Œå¯è§†åŒ–ï¼Œåœ¨è¿™ç§è¿œç¨‹çš„notebookä¸­å¦‚æœä½¿ç”¨é­”æ³•å‡½æ•°</p><pre class="line-numbers language-python3"><code class="language-python3">ï¼tensorboard --logdir<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¼šå¯¼è‡´ä½ æ— æ³•æ‰“å¼€tensorboardçš„httpæœåŠ¡ï¼ˆä¹Ÿå°±æ˜¯ç½‘å€ï¼‰ã€‚æœ¬æ–‡ä½¿ç”¨ä¸€ç§ç®€å•çš„æ–¹æ³•ï¼Œé€šè¿‡tensorboardXåœ¨notebookå¯è§†åŒ–pytorchæ¨¡å‹å‚æ•°ã€‚</p><p>ç¬¬ä¸€æ­¥import tensorboardX ï¼ˆå¦‚ä½•ä½¿ç”¨tensorboardXè¯·å‚è€ƒreferenceï¼‰ï¼š</p><pre class="line-numbers language-text"><code class="language-text">from tensorboardX import SummaryWriter<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¬¬äºŒæ­¥åˆå§‹åŒ–ä¸€ä¸ª SummaryWriterå®ä¾‹ï¼š</p><pre class="line-numbers language-text"><code class="language-text">writer = SummaryWriter()<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¬¬ä¸‰æ­¥ï¼š</p><pre class="line-numbers language-text"><code class="language-text">%load_ext tensorboard.notebook<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¬¬å››æ­¥æŠŠä½ æ¨¡å‹éœ€è¦åœ¨tensorboardä¸­å¯è§†åŒ–çš„å‚æ•°å†™å…¥writerï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic1.zhimg.com/80/v2-39de1b0efa3e5ce57e95d02208478e04_1440w.jpg" alt="img"></p><p>ç¬¬äº”æ­¥ï¼š</p><pre class="line-numbers language-text"><code class="language-text">%tensorboard --logdir ./<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ¥ä¸‹æ¥ä½ å°±å¯ä»¥è®­ç»ƒä½ çš„æ¨¡å‹äº†ï¼Œè€Œä¸”åœ¨è¾¹è®­ç»ƒçš„æ—¶å€™å¯ä»¥è¾¹çœ‹åˆ°æ¨¡å‹å‚æ•°çš„å˜åŒ–ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic2.zhimg.com/80/v2-e7e1d23b2830e5deaa826b2ac0e06649_1440w.jpg" alt="img"></p><h2 id="æœ¬åœ°"><a href="#æœ¬åœ°" class="headerlink" title="æœ¬åœ°"></a>æœ¬åœ°</h2><p><a href="https://blog.csdn.net/bigbennyguo/article/details/87956434?utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control" target="_blank" rel="noopener">https://blog.csdn.net/bigbennyguo/article/details/87956434?utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control</a></p>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> GPU </tag>
            
            <tag> Kaggle </tag>
            
            <tag> BUG </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CPU/GPU/TPU/APUå®¶æ—ä»¬</title>
      <link href="/2021/08/13/cpu-gpu-tpu-apu-jia-zu-men/"/>
      <url>/2021/08/13/cpu-gpu-tpu-apu-jia-zu-men/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æ–‡ç« è½¬è½½è‡ªä¸ªäººåšå®¢<a href="http://www.techeasygo.com/archives/1143" target="_blank" rel="noopener">é—»è¥¿è°ˆ</a>ï¼Œå¦‚æœ‰ä¾µæƒï¼Œè¯·ä¸åšä¸»æœ¬äººè”ç³»ï¼š<a href="mailto:lry89757@gmail.com" target="_blank" rel="noopener">lry89757@gmail.com</a></p></blockquote><p>åˆšå¼€å§‹æ¥è§¦æ·±åº¦å­¦ä¹ æ¦‚å¿µæ—¶ï¼ŒåŸºæœ¬å¤§å¤šæ•°æ—¶å€™ä¹Ÿå°±æåˆ°GPUï¼Œä¹ŸåŸºæœ¬æ˜¯ç”¨GPUæ¥è¿›è¡Œæ·±åº¦å­¦ä¹ ç®—æ³•è®­ç»ƒæˆ–éƒ¨ç½²äººè„¸è¯†åˆ«ç³»ç»Ÿçš„ã€‚</p><p>è¿‘å‡ å¹´ï¼Œéšç€äººå·¥æ™ºèƒ½(å°¤å…¶æ˜¯äººè„¸è¯†åˆ«)çš„çˆ†ç‚¸å¼å‘å±•ï¼Œè¯ç”Ÿäº†è®¸å¤šæ–°çš„ä¸œè¥¿ï¼Œå…¶ä¸­è¿™èŠ¯ç‰‡ï¼Œå°±è®©å¾ˆå¤šäººéƒ½æ‘¸ä¸ç€å¤´è„‘ã€‚</p><p>é™¤äº†CPUï¼ŒGPUä¹‹å¤–ï¼Œè¿˜æœ‰TPUï¼ŒNPUç­‰ï¼ŒçœŸçš„æ˜¯CPU/GPU/TPU/NPUå‚»å‚»åˆ†ä¸æ¸…æ¥šå•Šã€‚</p><p>ä»Šå¤©ï¼Œé—»è¥¿å°±æ¥å¸®å¤§å®¶ç†ç†è¿™äº›è®©äººåˆ†ä¸æ¸…æ¥šçš„èŠ¯ç‰‡åˆ°åº•éƒ½æ˜¯å•¥ï¼Ÿæ€ä¹ˆåŒºåˆ«å®ƒä»¬ï¼Ÿ</p><h2 id="CPU"><a href="#CPU" class="headerlink" title="CPU"></a><strong>CPU</strong></h2><p>CPUæ˜¯å¤§å®¶å¬åˆ°å¾—æœ€å¤šçš„ã€‚</p><p>CPUè‹±æ–‡å…¨ç§°æ˜¯Central Processing Unitï¼Œä¸­æ–‡å…¨ç§°æ˜¯ä¸­å¤®å¤„ç†å™¨ï¼Œæ˜¯è®¡ç®—æœºçš„æ ¸å¿ƒå™¨ä»¶ï¼ŒCPUé€šå¸¸ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼š<strong>è®¡ç®—å•å…ƒã€æ§åˆ¶å•å…ƒå’Œå­˜å‚¨å•å…ƒã€‚</strong></p><p>æ¶æ„å›¾å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic2.zhimg.com/80/v2-d65f155a80f7a1d6e6227d01c7f414a1_1440w.jpg" alt="img"></p><p>æ˜¯ä¸æ˜¯çœ‹ä¸æ‡‚ï¼Ÿçœ‹ä¸æ‡‚å°±å¯¹äº†ï¼Œä¸‹é¢è¿™å¼ å›¾æ‰æ˜¯å¸®åŠ©ä½ ç†è§£çš„ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic3.zhimg.com/80/v2-046ee01f1002ef7e7db48eeda9aa539e_1440w.jpg" alt="img"></p><h2 id="GPU"><a href="#GPU" class="headerlink" title="GPU"></a><strong>GPU</strong></h2><p>GPUå…¨ç§°æ˜¯Graphics Processing Unitï¼Œä¸­æ–‡å…¨ç§°å«å›¾å½¢å¤„ç†å™¨ï¼Œå®ƒä¹Ÿæ˜¯ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼š<strong>è®¡ç®—å•å…ƒã€æ§åˆ¶å•å…ƒå’Œå­˜å‚¨å•å…ƒã€‚</strong></p><p>æˆ‘ä»¬ç»§ç»­æ²¿ç”¨ä¸Šé¢CPUæ¶æ„å›¾ç”¨æ¥è¡¨ç¤ºå„ä¸ªå•å…ƒçš„é¢œè‰²æ¥è¡¨ç¤ºä¸‹GPUæ¶æ„(é»„è‰²ç”¨æ¥è¡¨ç¤ºæ§åˆ¶å•å…ƒï¼Œç»¿è‰²ç”¨æ¥è¡¨ç¤ºè®¡ç®—å•å…ƒï¼Œæ©™è‰²ç”¨æ¥è¡¨ç¤ºå­˜å‚¨å•å…ƒ)ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic4.zhimg.com/80/v2-7d630d1681ddd6ee47968af93bec0c23_1440w.jpg" alt="img"></p><p>è¿™å¦¥å¦¥æ˜¯ä¸ªCPUå˜ç§å•Šï¼</p><p>æˆ‘ä»¬æŠŠCPUå’ŒGPUçš„æ¶æ„å›¾æ”¾åœ¨ä¸€èµ·æ¯”è¾ƒä¸‹ï¼Œçœ‹çœ‹æœ‰å•¥åŒºåˆ«ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic4.zhimg.com/80/v2-005d784787c6e72d75214c3cbe1ea303_1440w.jpg" alt="img"></p><p>CPUè¿™è¾¹èµ·ç 30%éƒ½æ˜¯ç”¨åœ¨äº†æ§åˆ¶å•å…ƒï¼Œå„ä¸ªå•å…ƒå æ¯”è¿˜ç®—å‡è¡¡ï¼Œè€ŒGPUå°±å¤¸å¼ äº†ï¼Œ80%ä»¥ä¸Šéƒ½ç”¨åœ¨äº†è®¡ç®—å•å…ƒï¼Œåç§‘æœ‰ç‚¹ä¸¥é‡å•Šã€‚</p><p>æ­£æ˜¯ç”±äºè¿™ç§åŒºåˆ«ï¼Œå¯¼è‡´CPUç²¾äºæ§åˆ¶å’Œå¤æ‚è¿ç®—ï¼Œè€ŒGPUç²¾äºç®€å•ä¸”é‡å¤çš„è¿ç®—ã€‚</p><p><strong>å¦å¤–CPUå’ŒGPUè¿˜æœ‰ä¸€ä¸ªæœ€å¤§çš„åŒºåˆ«ï¼šCPUæ˜¯é¡ºåºæ‰§è¡Œè¿ç®—ï¼Œè€ŒGPUæ˜¯å¯ä»¥å¤§é‡å¹¶å‘çš„æ‰§è¡Œè¿ç®—ï¼Œé€šä¿—çš„è¯´å°±æ˜¯CPUåšäº‹æƒ…æ˜¯ä¸€ä»¶ä¸€ä»¶æ¥åšï¼Œè€ŒGPUæ˜¯å¾ˆå¤šä»¶äº‹æƒ…åŒæ—¶åšã€‚</strong></p><p>ä½†å¾ˆå¤šä»¶äº‹æƒ…åŒæ—¶åšï¼Œä¸€å®šæ˜¯ç®€å•çš„äº‹æƒ…ï¼Œå°±åƒä¸€ä¸ªäººä¸€æ ·ï¼Œæˆ‘ä»¬æ²¡æ³•åŒæ—¶åšä¸¤ä»¶å¤æ‚çš„äº‹æƒ…ã€‚</p><p>å€Ÿç”¨çŸ¥ä¹ä¸ŠæŸå¤§ç¥çš„è¯´æ³•ï¼Œå°±åƒä½ æœ‰ä¸ªå·¥ä½œéœ€è¦è®¡ç®—å‡ äº¿æ¬¡ä¸€ç™¾ä»¥å†…åŠ å‡ä¹˜é™¤ä¸€æ ·ï¼Œæœ€å¥½çš„åŠæ³•å°±æ˜¯é›‡ä¸Šå‡ åä¸ªå°å­¦ç”Ÿä¸€èµ·ç®—ï¼Œä¸€äººç®—ä¸€éƒ¨åˆ†ï¼Œåæ­£è¿™äº›è®¡ç®—ä¹Ÿæ²¡ä»€ä¹ˆæŠ€æœ¯å«é‡ï¼Œçº¯ç²¹ä½“åŠ›æ´»è€Œå·²ï¼›è€ŒCPUå°±åƒè€æ•™æˆï¼Œç§¯åˆ†å¾®åˆ†éƒ½ä¼šç®—ï¼Œå°±æ˜¯å·¥èµ„é«˜ï¼Œä¸€ä¸ªè€æ•™æˆèµ„é¡¶äºŒåä¸ªå°å­¦ç”Ÿï¼Œä½ è¦æ˜¯å¯Œå£«åº·ä½ é›‡å“ªä¸ªï¼Ÿ</p><p>GPUå°±æ˜¯ç”¨å¾ˆå¤šç®€å•çš„è®¡ç®—å•å…ƒå»å®Œæˆå¤§é‡çš„è®¡ç®—ä»»åŠ¡ï¼Œçº¯ç²¹çš„äººæµ·æˆ˜æœ¯ã€‚è¿™ç§ç­–ç•¥åŸºäºä¸€ä¸ªå‰æï¼Œå°±æ˜¯å°å­¦ç”ŸAå’Œå°å­¦ç”ŸBçš„å·¥ä½œæ²¡æœ‰ä»€ä¹ˆä¾èµ–æ€§ï¼Œæ˜¯äº’ç›¸ç‹¬ç«‹çš„ã€‚</p><p><strong>ä½†æœ‰ä¸€ç‚¹éœ€è¦å¼ºè°ƒï¼Œè™½ç„¶GPUæ˜¯ä¸ºäº†å›¾åƒå¤„ç†è€Œç”Ÿçš„ï¼Œä½†æ˜¯æˆ‘ä»¬é€šè¿‡å‰é¢çš„ä»‹ç»å¯ä»¥å‘ç°ï¼Œå®ƒåœ¨ç»“æ„ä¸Šå¹¶æ²¡æœ‰ä¸“é—¨ä¸ºå›¾åƒæœåŠ¡çš„éƒ¨ä»¶</strong>ï¼Œåªæ˜¯å¯¹CPUçš„ç»“æ„è¿›è¡Œäº†ä¼˜åŒ–ä¸è°ƒæ•´ï¼Œæ‰€ä»¥ç°åœ¨GPUä¸ä»…å¯ä»¥åœ¨å›¾åƒå¤„ç†é¢†åŸŸå¤§æ˜¾èº«æ‰‹ï¼Œå®ƒè¿˜è¢«ç”¨æ¥ç§‘å­¦è®¡ç®—ã€å¯†ç ç ´è§£ã€æ•°å€¼åˆ†æï¼Œæµ·é‡æ•°æ®å¤„ç†ï¼ˆæ’åºï¼ŒMap-Reduceç­‰ï¼‰ï¼Œé‡‘èåˆ†æç­‰éœ€è¦å¤§è§„æ¨¡å¹¶è¡Œè®¡ç®—çš„é¢†åŸŸã€‚</p><p>ä¸Šé¢æˆ‘ä»¬æåˆ°çš„CPUå’ŒGPUéƒ½æ˜¯é€šç”¨èŠ¯ç‰‡ã€‚</p><p>ä½†å¤è¯­æœ‰äº‘ï¼šå·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨ã€‚</p><p>ä¸€å—çŸ³å¤´ï¼Œæ˜¯é€šç”¨çš„ï¼Œä½†å¦‚æœæˆ‘ä¸“é—¨æ‰“ç£¨æ‰“ç£¨ï¼Œè®©å®ƒå˜æˆé”‹åˆ©çš„ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥ç”¨æ¥åˆ‡å‰²ä¸œè¥¿äº†å‘¢ï¼Ÿ</p><p>æœ‰äº†è¿™ä¸ªæ¦‚å¿µåï¼Œå¯¹äºTPUï¼ŒNPUç­‰ç­‰ä¼—å¤šçš„PUä»¬ï¼Œä½ æŠŠå®ƒä»¬å½“æˆéƒ½æ˜¯ä¸“é—¨æ‰“ç£¨è¿‡çš„çŸ³å¤´ï¼Œå°±å¾ˆå¥½ç†è§£äº†ã€‚</p><h2 id="TPU"><a href="#TPU" class="headerlink" title="TPU"></a><strong>TPU</strong></h2><p>è‡ªä»è°·æ­Œçš„AlphaGoæ‰“è´¥æä¸–çŸ³ä¹‹åï¼Œè°·æ­Œåœ¨äººå·¥æ™ºèƒ½ç•Œçš„çŸ¥ååº¦ä¹Ÿè¶Šæ¥è¶Šå¤§äº†ï¼Œäºæ˜¯è°·æ­Œæ¨å‡ºäº†å®ƒä»¬çš„æ·±åº¦å­¦ä¹ æ¡†æ¶TensorFlowï¼Œè¿™ä¸ªæ·±åº¦å­¦ä¹ æ¡†æ¶ä¹Ÿå°±æ­¤æ‰¬åä¸–ç•Œã€‚</p><p>æœ‰äº†å¥½çš„ç®—æ³•æ¡†æ¶ï¼Œå°±å¾—è¦æœ‰ç¡¬ä»¶æ¥æ”¯æŒå•Šï¼Œä¼ ç»Ÿçš„GPUè¡Œå—ï¼Ÿ</p><p>å½“ç„¶è¡Œï¼Œå¯æ˜¯å®ƒæ¯•ç«Ÿæ˜¯å—é€šç”¨çš„çŸ³å¤´ï¼Œè¦æ˜¯æ‰“ç£¨æ‰“ç£¨å°±å¥½äº†ã€‚</p><p>äºæ˜¯é’ˆå¯¹è°·æ­Œçš„æ·±åº¦å­¦ä¹ æ¡†æ¶TensorFlowä¸“é—¨å®šåˆ¶çš„èŠ¯ç‰‡è¯ç”Ÿäº†ï¼Œè‹±æ–‡å…¨ç§°å°±å«Tensor Processing Unitï¼Œç¿»è¯‘ä¸ºä¸­æ–‡å°±æ˜¯å¼ é‡å¤„ç†å•å…ƒï¼Œå®ƒåˆ°åº•æœ‰å¤šç‰›å‘¢ï¼Ÿæ¯”è¾ƒä¸‹ä½ å°±çŸ¥é“äº†ï¼š</p><p><strong>TPUä¸åŒæœŸçš„CPUå’ŒGPUç›¸æ¯”ï¼Œå¯ä»¥æä¾›15-30å€çš„æ€§èƒ½æå‡ï¼Œä»¥åŠ30-80å€çš„æ•ˆç‡ï¼ˆæ€§èƒ½/ç“¦ç‰¹ï¼‰æå‡ã€‚</strong></p><p>å¼å¼ï¼Œè¿™å¯ä¸æ˜¯ä¸€ä¸ç‚¹çš„æ•ˆç‡æå‡ï¼Œæ˜¯å¤§å¤§çš„æå‡ã€‚</p><h2 id="NPU"><a href="#NPU" class="headerlink" title="NPU"></a><strong>NPU</strong></h2><p>NPUè‹±æ–‡å…¨ç§°æ˜¯Neural network Processing Unitï¼Œ ä¸­æ–‡å«ç¥ç»ç½‘ç»œå¤„ç†å™¨ã€‚</p><p>ç¥ç»ç½‘ç»œæ˜¯ä¸ªå•¥ï¼Ÿ</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic1.zhimg.com/80/v2-9818a287fb926b1d6cd213546e91d934_1440w.jpg" alt="img"></p><p>ç¥ç»ç½‘ç»œå°±æ˜¯ä½ å¤§è„‘é‡Œé¢çš„ç¥ç»å…ƒè¿æ¥æˆçš„ç½‘ç»œï¼Œé”™ç»¼å¤æ‚ï¼Œæ®è¯´è¶Šå¤æ‚è¶Šèªæ˜ï¼Œå½“ç„¶å¤ªå¤æ‚äº†ï¼Œå°±æˆç¥ç»ç—…äº†ã€‚</p><p>è€Œè¿™ä¸ªNPUï¼Œå³ç¥ç»ç½‘ç»œå¤„ç†å™¨ï¼Œå°±æ˜¯è¦æ¨¡ä»¿äººçš„å¤§è„‘ç¥ç»ç½‘ç»œï¼Œä½¿ä¹‹å…·å¤‡æ™ºèƒ½ã€‚</p><p>æ€ä¹ˆæ¨¡ä»¿å‘¢ï¼Ÿ</p><p>NPUå·¥ä½œåŸç†æ˜¯åœ¨ç”µè·¯å±‚æ¨¡æ‹Ÿäººç±»ç¥ç»å…ƒå’Œçªè§¦ï¼Œå¹¶ä¸”ç”¨æ·±åº¦å­¦ä¹ æŒ‡ä»¤é›†ç›´æ¥å¤„ç†å¤§è§„æ¨¡çš„ç¥ç»å…ƒå’Œçªè§¦ï¼Œä¸€æ¡æŒ‡ä»¤å®Œæˆä¸€ç»„ç¥ç»å…ƒçš„å¤„ç†ã€‚ç›¸æ¯”äºCPUå’ŒGPUï¼ŒNPUé€šè¿‡çªè§¦æƒé‡å®ç°å­˜å‚¨å’Œè®¡ç®—ä¸€ä½“åŒ–ï¼Œä»è€Œæé«˜è¿è¡Œæ•ˆç‡ã€‚</p><h2 id="å…¶ä»–PUä»¬"><a href="#å…¶ä»–PUä»¬" class="headerlink" title="å…¶ä»–PUä»¬"></a><strong>å…¶ä»–PUä»¬</strong></h2><p>é¡ºç€è¿™ä¸ªå¥—è·¯ï¼Œæ„Ÿè§‰å¦ˆå¦ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒæˆ‘çš„PUäº†ã€‚</p><p>APU â€” Accelerated Processing Unit, åŠ é€Ÿå¤„ç†å™¨ï¼ŒAMDå…¬å¸æ¨å‡ºåŠ é€Ÿå›¾åƒå¤„ç†èŠ¯ç‰‡äº§å“ã€‚</p><p>BPU â€” Brain Processing Unit, åœ°å¹³çº¿å…¬å¸ä¸»å¯¼çš„åµŒå…¥å¼å¤„ç†å™¨æ¶æ„ã€‚</p><p>CPU â€” Central Processing Unit ä¸­å¤®å¤„ç†å™¨ï¼Œ ç›®å‰PC coreçš„ä¸»æµäº§å“ã€‚</p><p>DPU â€” Deep learning Processing Unit, æ·±åº¦å­¦ä¹ å¤„ç†å™¨ï¼Œæœ€æ—©ç”±å›½å†…æ·±é‰´ç§‘æŠ€æå‡ºï¼›å¦è¯´æœ‰Dataflow Processing Unit æ•°æ®æµå¤„ç†å™¨ï¼Œ Wave Computing å…¬å¸æå‡ºçš„AIæ¶æ„ï¼›Data storage Processing Unitï¼Œæ·±åœ³å¤§æ™®å¾®çš„æ™ºèƒ½å›ºæ€ç¡¬ç›˜å¤„ç†å™¨ã€‚</p><p>FPU â€” Floating Processing Unit æµ®ç‚¹è®¡ç®—å•å…ƒï¼Œé€šç”¨å¤„ç†å™¨ä¸­çš„æµ®ç‚¹è¿ç®—æ¨¡å—ã€‚</p><p>GPU â€” Graphics Processing Unit, å›¾å½¢å¤„ç†å™¨ï¼Œé‡‡ç”¨å¤šçº¿ç¨‹SIMDæ¶æ„ï¼Œä¸ºå›¾å½¢å¤„ç†è€Œç”Ÿã€‚</p><p>HPU â€” Holographics Processing Unit å…¨æ¯å›¾åƒå¤„ç†å™¨ï¼Œ å¾®è½¯å‡ºå“çš„å…¨æ¯è®¡ç®—èŠ¯ç‰‡ä¸è®¾å¤‡ã€‚</p><p>IPU â€” Intelligence Processing Unitï¼Œ Deep MindæŠ•èµ„çš„Graphcoreå…¬å¸å‡ºå“çš„AIå¤„ç†å™¨äº§å“ã€‚</p><p>MPU/MCU â€” Microprocessor/Micro controller Unitï¼Œ å¾®å¤„ç†å™¨/å¾®æ§åˆ¶å™¨ï¼Œä¸€èˆ¬ç”¨äºä½è®¡ç®—åº”ç”¨çš„RISCè®¡ç®—æœºä½“ç³»æ¶æ„äº§å“ï¼Œå¦‚ARM-Mç³»åˆ—å¤„ç†å™¨ã€‚</p><p>NPU â€” Neural Network Processing Unitï¼Œç¥ç»ç½‘ç»œå¤„ç†å™¨ï¼Œæ˜¯åŸºäºç¥ç»ç½‘ç»œç®—æ³•ä¸åŠ é€Ÿçš„æ–°å‹å¤„ç†å™¨æ€»ç§°ï¼Œå¦‚ä¸­ç§‘é™¢è®¡ç®—æ‰€/å¯’æ­¦çºªå…¬å¸å‡ºå“çš„diannaoç³»åˆ—ã€‚</p><p>RPU â€” Radio Processing Unit, æ— çº¿ç”µå¤„ç†å™¨ï¼Œ Imagination Technologies å…¬å¸æ¨å‡ºçš„é›†åˆé›†Wifi/è“ç‰™/FM/å¤„ç†å™¨ä¸ºå•ç‰‡çš„å¤„ç†å™¨ã€‚</p><p>TPU â€” Tensor Processing Unit å¼ é‡å¤„ç†å™¨ï¼Œ Google å…¬å¸æ¨å‡ºçš„åŠ é€Ÿäººå·¥æ™ºèƒ½ç®—æ³•çš„ä¸“ç”¨å¤„ç†å™¨ã€‚ç›®å‰ä¸€ä»£TPUé¢å‘Inferenceï¼ŒäºŒä»£é¢å‘è®­ç»ƒã€‚</p><p>VPU â€” Vector Processing Unit çŸ¢é‡å¤„ç†å™¨ï¼ŒIntelæ”¶è´­çš„Movidiuså…¬å¸æ¨å‡ºçš„å›¾åƒå¤„ç†ä¸äººå·¥æ™ºèƒ½çš„ä¸“ç”¨èŠ¯ç‰‡çš„åŠ é€Ÿè®¡ç®—æ ¸å¿ƒã€‚</p><p>WPU â€” Wearable Processing Unitï¼Œ å¯ç©¿æˆ´å¤„ç†å™¨ï¼ŒIneda Systemså…¬å¸æ¨å‡ºçš„å¯ç©¿æˆ´ç‰‡ä¸Šç³»ç»Ÿäº§å“ï¼ŒåŒ…å«GPU/MIPS CPUç­‰IPã€‚</p><p>XPU â€” ç™¾åº¦ä¸Xilinxå…¬å¸åœ¨2017å¹´Hotchipså¤§ä¼šä¸Šå‘å¸ƒçš„FPGAæ™ºèƒ½äº‘åŠ é€Ÿï¼Œå«256æ ¸ã€‚</p><p>ZPU â€” Zylin Processing Unit, ç”±æŒªå¨Zylin å…¬å¸æ¨å‡ºçš„ä¸€æ¬¾32ä½å¼€æºå¤„ç†å™¨ã€‚</p><p><strong>è¿™ä¹ˆä¸‹å»æ„Ÿè§‰26ä¸ªå­—æ¯å®Œå…¨ä¸å¤Ÿç”¨å•Šï¼Œè¯è¯´ä»¥åPUä»¬ä¼šä¸ä¼šé•¿çš„è·Ÿè½¦ç‰Œä¸€æ ·äº†å‘¢ï¼Ÿ</strong></p><p><strong>æ¯”å¦‚ï¼šXZAYPUï¼Œå—¯ï¼Œæˆ‘çœ‹å°±å·®åŠ ä¸ªç²¤Båœ¨å‰é¢äº†ã€‚</strong></p><p><strong>ä»¥åå¦ˆå¦ˆå¯èƒ½è¿˜æ˜¯è¦æ‹…å¿ƒæˆ‘çš„PUäº†ï¼</strong></p>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> CPU </tag>
            
            <tag> æ˜¾å¡ </tag>
            
            <tag> GPU </tag>
            
            <tag> TPU </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ·±åº¦å­¦ä¹ GPUåˆ©ç”¨ç‡ä½é—®é¢˜åˆ†æ(è½¬)</title>
      <link href="/2021/08/12/shen-du-xue-xi-gpu-li-yong-lu-di-wen-ti-fen-xi-zhuan/"/>
      <url>/2021/08/12/shen-du-xue-xi-gpu-li-yong-lu-di-wen-ti-fen-xi-zhuan/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æœ¬æ–‡è½¬è½½è‡ªï¼š<a href="https://benpaodewoniu.github.io/2021/01/21/torch16/" target="_blank" rel="noopener">çŠ€ç‰›é¸Ÿçš„åšå®¢</a>,å¦‚æœ‰ä¾µæƒè¯·ä¸æœ¬äººè”ç³»ï¼š<a href="mailto:lry89757@gmail.com" target="_blank" rel="noopener">lry89757@gmail.com</a></p></blockquote><p>è¿™ä¸ªçœŸçš„æ˜¯å€¼å¾—äººç ”ç©¶çš„äº‹æƒ…ï¼Œå¦‚æœï¼Œ<code>gpu</code> åˆ©ç”¨ç‡å¾ˆä½ï¼Œé‚£è¿˜ä¸å¦‚ <code>cpu</code> æ¥çš„èˆ’çˆ½ã€‚</p><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li><a href="https://blog.csdn.net/qq_32998593/article/details/92849585" target="_blank" rel="noopener">æ·±åº¦å­¦ä¹ PyTorchï¼ŒTensorFlowä¸­GPUåˆ©ç”¨ç‡è¾ƒä½ï¼ŒCPUåˆ©ç”¨ç‡å¾ˆä½ï¼Œä¸”æ¨¡å‹è®­ç»ƒé€Ÿåº¦å¾ˆæ…¢çš„é—®é¢˜æ€»ç»“ä¸åˆ†æ</a></li></ul><p>æˆ‘ä¼šç»“åˆæˆ‘è‡ªå·±çš„ç»éªŒåŠ ä¸Šè¿™ç¯‡åšæ–‡æ¥åšä¸€ä¸ªæ€»ç»“ï¼</p><p>åœ¨æ·±åº¦å­¦ä¹ æ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œåœ¨æœåŠ¡å™¨ç«¯æˆ–è€…æœ¬åœ°<code>pcç«¯</code>ï¼Œè¾“å…¥<code>nvidia-smi</code>æ¥è§‚å¯Ÿæ˜¾å¡çš„<code>GPUå†…å­˜å ç”¨ç‡</code>ï¼ˆ<code>Memory-Usage</code>ï¼‰ï¼Œ<code>æ˜¾å¡çš„GPUåˆ©ç”¨ç‡</code>ï¼ˆ<code>GPU-util</code>ï¼‰ï¼Œç„¶åé‡‡ç”¨<code>top</code>æ¥æŸ¥çœ‹<code>CPU</code>çš„çº¿ç¨‹æ•°ï¼ˆ<code>PIDæ•°</code>ï¼‰å’Œ<code>åˆ©ç”¨ç‡</code>ï¼ˆ<code>%CPU</code>ï¼‰ã€‚å¾€å¾€ä¼šå‘ç°å¾ˆå¤šé—®é¢˜ï¼Œæ¯”å¦‚</p><ul><li>GPUå†…å­˜å ç”¨ç‡ä½</li><li>æ˜¾å¡åˆ©ç”¨ç‡ä½</li><li>CPUç™¾åˆ†æ¯”ä½ç­‰ç­‰</li></ul><h1 id="GPUå†…å­˜å ç”¨ç‡é—®é¢˜"><a href="#GPUå†…å­˜å ç”¨ç‡é—®é¢˜" class="headerlink" title="GPUå†…å­˜å ç”¨ç‡é—®é¢˜"></a>GPUå†…å­˜å ç”¨ç‡é—®é¢˜</h1><p>è¿™å¾€å¾€æ˜¯ç”±äº</p><ul><li><code>æ¨¡å‹çš„å¤§å°</code></li><li><code>batch size</code>çš„å¤§å°</li></ul><p>æ¥å½±å“è¿™ä¸ªæŒ‡æ ‡ã€‚</p><p>å½“ä½ å‘ä¸‹ä½ çš„<code>GPUå ç”¨ç‡</code>å¾ˆå°çš„æ—¶å€™ï¼Œæ¯”å¦‚<code>40%</code>ï¼Œ<code>70%</code>ï¼Œç­‰ç­‰ã€‚</p><p>æ­¤æ—¶ï¼Œå¦‚æœä½ çš„ç½‘ç»œç»“æ„å·²ç»å›ºå®šï¼Œæ­¤æ—¶åªéœ€è¦æ”¹å˜<code>batch size</code>çš„å¤§å°ï¼Œå°±å¯ä»¥å°½é‡åˆ©ç”¨å®Œæ•´ä¸ª<code>GPU</code>çš„å†…å­˜ã€‚<code>GPU</code>çš„å†…å­˜å ç”¨ç‡ä¸»è¦æ˜¯<code>æ¨¡å‹çš„å¤§å°</code>ï¼ŒåŒ…æ‹¬ç½‘ç»œçš„å®½åº¦ï¼Œæ·±åº¦ï¼Œå‚æ•°é‡ï¼Œä¸­é—´æ¯ä¸€å±‚çš„ç¼“å­˜ï¼Œéƒ½ä¼šåœ¨å†…å­˜ä¸­å¼€è¾Ÿç©ºé—´æ¥è¿›è¡Œä¿å­˜ï¼Œæ‰€ä»¥æ¨¡å‹æœ¬èº«ä¼šå ç”¨å¾ˆå¤§ä¸€éƒ¨åˆ†å†…å­˜ã€‚</p><p>å…¶æ¬¡æ˜¯<code>batch size</code>çš„å¤§å°ï¼Œä¹Ÿä¼šå ç”¨å½±å“å†…å­˜å ç”¨ç‡ã€‚<code>batch size</code>è®¾ç½®ä¸º<code>128</code>ï¼Œä¸è®¾ç½®ä¸º<code>256</code>ç›¸æ¯”ï¼Œå†…å­˜å ç”¨ç‡æ˜¯æ¥è¿‘äº<code>2</code>å€å…³ç³»ã€‚å½“ä½ <code>batch size</code>è®¾ç½®ä¸º<code>128</code>ï¼Œå ç”¨ç‡ä¸º<code>40%</code>çš„è¯ï¼Œè®¾ç½®ä¸º<code>256</code>æ—¶ï¼Œæ­¤æ—¶æ¨¡å‹çš„å ç”¨ç‡çº¦ç­‰äº<code>80%</code>ï¼Œåå·®ä¸å¤§ã€‚æ‰€ä»¥åœ¨æ¨¡å‹ç»“æ„å›ºå®šçš„æƒ…å†µä¸‹ï¼Œå°½é‡å°†<code>batch size</code>è®¾ç½®å¤§ï¼Œå……åˆ†åˆ©ç”¨<code>GPU</code>çš„å†…å­˜ã€‚ï¼ˆ<code>GPU</code>ä¼šå¾ˆå¿«çš„ç®—å®Œä½ ç»™è¿›å»çš„æ•°æ®ï¼Œä¸»è¦ç“¶é¢ˆåœ¨<code>CPUçš„æ•°æ®ååé‡</code>ä¸Šé¢ã€‚ï¼‰</p><h1 id="GPUåˆ©ç”¨ç‡é—®é¢˜"><a href="#GPUåˆ©ç”¨ç‡é—®é¢˜" class="headerlink" title="GPUåˆ©ç”¨ç‡é—®é¢˜"></a>GPUåˆ©ç”¨ç‡é—®é¢˜</h1><p>è¿™ä¸ªæ˜¯<code>Volatile GPU-Util</code>è¡¨ç¤ºï¼Œå½“æ²¡æœ‰è®¾ç½®å¥½<code>CPUçš„çº¿ç¨‹æ•°</code>æ—¶ï¼Œè¿™ä¸ªå‚æ•°æ˜¯åœ¨åå¤çš„è·³åŠ¨çš„ï¼Œ<code>0%</code>ï¼Œ<code>20%</code>ï¼Œ<code>70%</code>ï¼Œ<code>95%</code>ï¼Œ<code>0%</code>ã€‚è¿™æ ·åœæ¯<code>1-2</code> ç§’ç„¶ååˆé‡å¤èµ·æ¥ã€‚å…¶å®æ˜¯<code>GPU</code>åœ¨ç­‰å¾…æ•°æ®ä»<code>CPU</code>ä¼ è¾“è¿‡æ¥ï¼Œå½“ä»æ€»çº¿ä¼ è¾“åˆ°<code>GPU</code>ä¹‹åï¼Œ<code>GPU</code>é€æ¸èµ·è®¡ç®—æ¥ï¼Œåˆ©ç”¨ç‡ä¼šçªç„¶å‡é«˜ï¼Œä½†æ˜¯<code>GPU</code>çš„ç®—åŠ›å¾ˆå¼ºå¤§ï¼Œ<code>0.5ç§’</code>å°±åŸºæœ¬èƒ½å¤„ç†å®Œæ•°æ®ï¼Œæ‰€ä»¥åˆ©ç”¨ç‡æ¥ä¸‹æ¥åˆä¼šé™ä¸‹å»ï¼Œç­‰å¾…ä¸‹ä¸€ä¸ª<code>batch</code>çš„ä¼ å…¥ã€‚å› æ­¤ï¼Œè¿™ä¸ª<code>GPUåˆ©ç”¨ç‡</code>ç“¶é¢ˆåœ¨<code>å†…å­˜å¸¦å®½</code>å’Œ<code>å†…å­˜ä»‹è´¨</code>ä¸Šä»¥åŠ<code>CPUçš„æ€§èƒ½</code>ä¸Šé¢ã€‚æœ€å¥½å½“ç„¶å°±æ˜¯æ¢æ›´å¥½çš„å››ä»£æˆ–è€…æ›´å¼ºå¤§çš„å†…å­˜æ¡ï¼Œé…åˆæ›´å¥½çš„<code>CPU</code>ã€‚</p><p>å¦å¤–çš„ä¸€ä¸ªæ–¹æ³•æ˜¯ï¼Œåœ¨<code>PyTorch</code>è¿™ä¸ªæ¡†æ¶é‡Œé¢ï¼Œæ•°æ®åŠ è½½<code>Dataloader</code>ä¸Šåšæ›´æ”¹å’Œä¼˜åŒ–ï¼ŒåŒ…æ‹¬<code>num_workers</code>ï¼ˆçº¿ç¨‹æ•°ï¼‰ï¼Œ<code>pin_memory</code>ï¼Œä¼šæå‡é€Ÿåº¦ã€‚è§£å†³å¥½æ•°æ®ä¼ è¾“çš„å¸¦å®½ç“¶é¢ˆå’ŒGPUçš„è¿ç®—æ•ˆç‡ä½çš„é—®é¢˜ã€‚åœ¨<code>TensorFlow</code>ä¸‹é¢ï¼Œä¹Ÿæœ‰è¿™ä¸ªåŠ è½½æ•°æ®çš„è®¾ç½®ã€‚</p><h2 id="pytorch"><a href="#pytorch" class="headerlink" title="pytorch"></a>pytorch</h2><pre><code>torch.utils.data.DataLoader(image_datasets[x],                            batch_size=batch_size,                             shuffle=True,                            num_workers=8,                            pin_memory=True)</code></pre><p>ä¸ºäº†æé«˜åˆ©ç”¨ç‡ï¼Œé¦–å…ˆè¦å°†<code>num_workers</code>ï¼ˆçº¿ç¨‹æ•°ï¼‰è®¾ç½®å¾—ä½“ï¼Œ<code>4</code>,<code>8</code>,<code>16</code>æ˜¯å‡ ä¸ªå¸¸é€‰çš„å‡ ä¸ªå‚æ•°ã€‚æœ¬äººæµ‹è¯•è¿‡ï¼Œå°†<code>num_workers</code>è®¾ç½®çš„éå¸¸å¤§ï¼Œä¾‹å¦‚ï¼Œ<code>24</code>ï¼Œ<code>32</code>,ç­‰ï¼Œå…¶æ•ˆç‡åè€Œé™ä½ï¼Œå› ä¸ºæ¨¡å‹éœ€è¦å°†æ•°æ®å¹³å‡åˆ†é…åˆ°å‡ ä¸ªå­çº¿ç¨‹å»è¿›è¡Œé¢„å¤„ç†ï¼Œåˆ†å‘ç­‰æ•°æ®æ“ä½œï¼Œè®¾é«˜äº†åè€Œå½±å“æ•ˆç‡ã€‚</p><p>å½“ç„¶ï¼Œçº¿ç¨‹æ•°è®¾ç½®ä¸º<code>1</code>ï¼Œæ˜¯å•ä¸ªCPUæ¥è¿›è¡Œæ•°æ®çš„é¢„å¤„ç†å’Œä¼ è¾“ç»™<code>GPU</code>ï¼Œæ•ˆç‡ä¹Ÿä¼šä½ã€‚å…¶æ¬¡ï¼Œå½“ä½ çš„æœåŠ¡å™¨æˆ–è€…ç”µè„‘çš„å†…å­˜è¾ƒå¤§ï¼Œæ€§èƒ½è¾ƒå¥½çš„æ—¶å€™ï¼Œå»ºè®®æ‰“å¼€<code>pin_memory</code>æ‰“å¼€ï¼Œå°±çœæ‰äº†å°†æ•°æ®ä»<code>CPU</code>ä¼ å…¥åˆ°ç¼“å­˜<code>RAM</code>é‡Œé¢ï¼Œå†ç»™ä¼ è¾“åˆ°<code>GPU</code>ä¸Šï¼›ä¸º<code>True</code>æ—¶æ˜¯ç›´æ¥æ˜ å°„åˆ°<code>GPU</code>çš„ç›¸å…³å†…å­˜å—ä¸Šï¼Œçœæ‰äº†ä¸€ç‚¹æ•°æ®ä¼ è¾“æ—¶é—´ã€‚</p><h2 id="tensorflow"><a href="#tensorflow" class="headerlink" title="tensorflow"></a>tensorflow</h2><pre><code>dataset = dataset.map(map_func=parse_fn, num_parallel_calls=FLAGS.num_parallel_calls)</code></pre><p>psï¼š <code>tensorflow</code> çš„ä»£ç æˆ‘æ²¡æœ‰è¯•è¿‡</p><h1 id="CPUçš„åˆ©ç”¨ç‡é—®é¢˜"><a href="#CPUçš„åˆ©ç”¨ç‡é—®é¢˜" class="headerlink" title="CPUçš„åˆ©ç”¨ç‡é—®é¢˜"></a>CPUçš„åˆ©ç”¨ç‡é—®é¢˜</h1><p>å¾ˆå¤šäººåœ¨æ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œä¸åªæ˜¯å…³æ³¨<code>GPU</code>çš„å„ç§æ€§èƒ½å‚æ•°ï¼Œå¾€å¾€è¿˜éœ€è¦æŸ¥çœ‹<code>CPU</code>å¤„ç†çš„æ€ä¹ˆæ ·ï¼Œåˆ©ç”¨çš„å¥½ä¸å¥½ã€‚è¿™ä¸€ç‚¹è‡³å…³é‡è¦ã€‚</p><p>ä½†æ˜¯å¯¹äº<code>CPU</code>ï¼Œä¸èƒ½ä¸€å‘³è¿½æ±‚è¶…é«˜çš„å ç”¨ç‡ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œå¯¹äº<code>14339</code>è¿™ä¸ªç¨‹åºæ¥è¯´ï¼Œå…¶<code>CPU</code>å ç”¨ç‡ä¸º<code>2349%</code>ï¼ˆæˆ‘çš„æœåŠ¡å™¨æ˜¯<code>32</code>æ ¸çš„ï¼Œæ‰€ä»¥æœ€é«˜ä¸º<code>3200%</code>ï¼‰ã€‚è¿™è¡¨æ˜ç”¨äº†<code>24æ ¸CPU</code>æ¥åŠ è½½æ•°æ®å’Œåšé¢„å¤„ç†å’Œåå¤„ç†ç­‰ã€‚å…¶å®ä¸»è¦çš„<code>CPU</code>èŠ±åœ¨åŠ è½½ä¼ è¾“æ•°æ®ä¸Šã€‚æ­¤æ—¶ï¼Œæ¥æµ‹é‡æ•°æ®åŠ è½½çš„æ—¶é—´å‘ç°ï¼Œå³ä½¿<code>CPU</code>åˆ©ç”¨ç‡å¦‚æ­¤ä¹‹é«˜ï¼Œå…¶å®é™…æ•°æ®åŠ è½½æ—¶é—´æ˜¯è®¾ç½®æ°å½“çš„<code>DataLoader</code>çš„<code>20å€</code>ä»¥ä¸Šï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ç§æ–¹æ³•æ¥åŠ è½½æ•°æ®æ…¢<code>20å€</code>ã€‚</p><p>å½“<code>DataLoader</code>çš„<code>num_workers=0</code>æ—¶ï¼Œæˆ–è€…ä¸è®¾ç½®è¿™ä¸ªå‚æ•°ï¼Œä¼šå‡ºç°è¿™ä¸ªæƒ…å†µã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://benpaodewoniu.github.io/images/torch/16_0.png" alt="img"></p><p>ä¸‹é¢çš„æ•°æ®å¯ä»¥çœ‹å‡ºï¼ŒåŠ è½½æ•°æ®çš„å®é™…æ˜¯<code>12.8s</code>ï¼Œæ¨¡å‹<code>GPU</code>è¿ç®—æ—¶é—´æ˜¯<code>0.16s</code>ï¼Œ<code>lossåä¼ </code>å’Œæ›´æ–°æ—¶é—´æ˜¯<code>0.48s</code>ã€‚æ­¤æ—¶ï¼Œå³ä½¿<code>CPU</code>ä¸º<code>2349%</code>ï¼Œä½†æ¨¡å‹çš„è®­ç»ƒé€Ÿåº¦è¿˜æ˜¯éå¸¸æ…¢ï¼Œè€Œä¸”ï¼Œ<code>GPU</code>å¤§éƒ¨åˆ†æ˜¯æ—¶é—´æ˜¯ç©ºé—²ç­‰å¾…çŠ¶æ€ã€‚</p><pre><code>å½“ num_workers = 0 æ—¶ï¼Œæ¨¡å‹æ¯ä¸ªé˜¶æ®µçš„æ—¶é—´ç»Ÿè®¡load data time: 12.8model process time is: 0.159loss backward and para update time : 0.47</code></pre><p>å½“æˆ‘å°†<code>num_workers=1</code>æ—¶ï¼Œå‡ºç°çš„æ—¶é—´ç»Ÿè®¡å¦‚ä¸‹ï¼Œ<code>load data time</code>ä¸º<code>6.3</code>ï¼Œæ•°æ®åŠ è½½æ•ˆç‡æå‡<code>1</code>å€ã€‚ä¸”æ­¤æ—¶çš„<code>CPUåˆ©ç”¨ç‡</code>ä¸º<code>170%</code>ï¼Œç”¨çš„<code>CPU</code>å¹¶ä¸å¤šï¼Œæ€§èƒ½æå‡<code>1</code>å€ã€‚</p><pre><code>å½“ num_workers = 1 æ—¶ï¼Œæ¨¡å‹æ¯ä¸ªé˜¶æ®µçš„æ—¶é—´ç»Ÿè®¡load data time: 6.33model process time is: 0.1244loss backward and para update time : 0.45</code></pre><p>æ­¤æ—¶ï¼ŒæŸ¥çœ‹<code>GPU</code>çš„æ€§èƒ½çŠ¶æ€ï¼ˆæˆ‘çš„æ¨¡å‹æ˜¯æ”¾åœ¨<code>1</code>,<code>2</code>,<code>3</code>å·å¡ä¸Šè®­ç»ƒï¼‰ï¼Œå‘ç°ï¼Œè™½ç„¶<code>GPU(1,2,3)</code>çš„å†…å­˜åˆ©ç”¨ç‡å¾ˆé«˜ï¼ŒåŸºæœ¬ä¸Šä¸º<code>98%</code>ï¼Œä½†æ˜¯åˆ©ç”¨ç‡ä¸º<code>0%</code>å·¦å³ã€‚è¡¨é¢æ­¤æ—¶ç½‘ç»œåœ¨ç­‰å¾…ä»<code>CPU</code>ä¼ è¾“æ•°æ®åˆ°<code>GPU</code>ï¼Œæ­¤æ—¶<code>CPU</code>ç–¯ç‹‚åŠ è½½æ•°æ®ï¼Œè€Œ<code>GPU</code>å¤„äºç©ºé—²çŠ¶æ€ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://benpaodewoniu.github.io/images/torch/16_1.png" alt="img"></p><p>ç”±æ­¤å¯è§ï¼Œ<code>CPUçš„åˆ©ç”¨ç‡</code>ä¸ä¸€å®šæœ€å¤§æ‰æœ€å¥½ã€‚</p><p>å¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œè§£å†³åŠæ³•æ˜¯ï¼Œå¢åŠ <code>DataLoader</code>è¿™ä¸ª<code>num_wokers</code>çš„ä¸ªæ•°ï¼Œä¸»è¦æ˜¯å¢åŠ å­çº¿ç¨‹çš„ä¸ªæ•°ï¼Œæ¥åˆ†æ‹…ä¸»çº¿ç¨‹çš„æ•°æ®å¤„ç†å‹åŠ›ï¼Œå¤šçº¿ç¨‹ååŒå¤„ç†æ•°æ®å’Œä¼ è¾“æ•°æ®ï¼Œä¸ç”¨æ”¾åœ¨ä¸€ä¸ªçº¿ç¨‹é‡Œè´Ÿè´£æ‰€æœ‰çš„é¢„å¤„ç†å’Œä¼ è¾“ä»»åŠ¡ã€‚</p><p>æˆ‘å°†<code>num_workers=8,16</code>éƒ½èƒ½å–å¾—ä¸é”™çš„æ•ˆæœã€‚æ­¤æ—¶ç”¨<code>top</code>æŸ¥çœ‹<code>CPU</code>å’Œçº¿ç¨‹æ•°ï¼Œå¦‚æœæˆ‘è®¾ç½®ä¸º<code>num_workers=8</code>ï¼Œçº¿ç¨‹æ•°æœ‰äº†<code>8</code>ä¸ªè¿ç»­å¼€è¾Ÿçš„çº¿ç¨‹<code>PID</code>ï¼Œä¸”å¤§å®¶çš„å ç”¨ç‡éƒ½åœ¨<code>100%</code>å·¦å³ï¼Œè¿™è¡¨æ˜æ¨¡å‹çš„<code>CPUç«¯</code>ï¼Œæ˜¯è¾ƒå¥½çš„åˆ†é…äº†ä»»åŠ¡ï¼Œæå‡æ•°æ®ååæ•ˆç‡ã€‚æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ<code>CPUåˆ©ç”¨ç‡</code>å¾ˆå¹³å‡å’Œé«˜æ•ˆï¼Œæ¯ä¸ªçº¿ç¨‹æ˜¯å‘æŒ¥äº†æœ€å¤§çš„æ€§èƒ½ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://benpaodewoniu.github.io/images/torch/16_2.jpg" alt="img"></p><p>æ­¤æ—¶ï¼Œåœ¨ç”¨<code>nvidia-smi</code>æŸ¥çœ‹<code>GPU</code>çš„åˆ©ç”¨ç‡ï¼Œå‡ å—<code>GPU</code>éƒ½åœ¨æ»¡è´Ÿè·ï¼Œæ»¡<code>GPU</code>å†…å­˜ï¼Œæ»¡<code>GPU</code>åˆ©ç”¨ç‡çš„å¤„ç†æ¨¡å‹ï¼Œé€Ÿåº¦å¾—åˆ°å·¨å¤§æå‡ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://benpaodewoniu.github.io/images/torch/16_3.png" alt="img"></p><p>ä¸Šå›¾ä¸­å¯ä»¥çœ‹è§ï¼Œ<code>GPU</code>çš„å†…å­˜åˆ©ç”¨ç‡æœ€å¤§åŒ–ï¼Œæ­¤æ—¶æ˜¯å°†<code>batch size</code>è®¾ç½®çš„è¾ƒå¤§ï¼Œå æ»¡äº†<code>GPUçš„å†…å­˜</code>ï¼Œç„¶åå°†<code>num_workers=8</code>ï¼Œåˆ†é…å¤šä¸ªå­çº¿ç¨‹ï¼Œä¸”è®¾ç½®<code>pin_memory=True</code>ï¼Œç›´æ¥æ˜ å°„æ•°æ®åˆ°<code>GPU</code>çš„ä¸“ç”¨å†…å­˜ï¼Œå‡å°‘æ•°æ®ä¼ è¾“æ—¶é—´ã€‚<code>GPU</code>å’Œ<code>CPU</code>çš„æ•°æ®ç“¶é¢ˆå¾—åˆ°è§£å†³ã€‚æ•´ä½“æ€§èƒ½å¾—åˆ°æƒè¡¡ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å¯¹ä¸Šé¢çš„åˆ†ææ€»ç»“ä¸€ä¸‹ã€‚</p><p>ç¬¬ä¸€æ˜¯å¢åŠ <code>batch size</code>ï¼Œå¢åŠ <code>GPU</code>çš„å†…å­˜å ç”¨ç‡ï¼Œå°½é‡ç”¨å®Œå†…å­˜ï¼Œè€Œä¸è¦å‰©ä¸€åŠï¼Œç©ºçš„å†…å­˜ç»™å¦å¤–çš„ç¨‹åºç”¨ï¼Œä¸¤ä¸ªä»»åŠ¡çš„æ•ˆç‡éƒ½ä¼šéå¸¸ä½ã€‚</p><p>ç¬¬äºŒï¼Œåœ¨æ•°æ®åŠ è½½æ—¶å€™ï¼Œå°†<code>num_workers</code>çº¿ç¨‹æ•°è®¾ç½®ç¨å¾®å¤§ä¸€ç‚¹ï¼Œæ¨èæ˜¯<code>8,16</code>ç­‰ï¼Œä¸”å¼€å¯<code>pin_memory=True</code>ã€‚ä¸è¦å°†æ•´ä¸ªä»»åŠ¡æ”¾åœ¨ä¸»è¿›ç¨‹é‡Œé¢åšï¼Œè¿™æ ·æ¶ˆè€—<code>CPU</code>ï¼Œä¸”é€Ÿåº¦å’Œæ€§èƒ½æä¸ºä½ä¸‹ã€‚</p><p>å¦å¤–ï¼Œæˆ‘åœ¨è·‘æˆ‘è‡ªå·±ä»£ç çš„æ—¶å€™ï¼Œå‘ç°ï¼Œè€—è´¹æ—¶é—´æœ€å¤šçš„åœ°æ–¹æ—¶æ•°æ®çš„é¢„å¤„ç†</p><p>æ•°æ®é¢„å¤„ç†</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">TrainDataset</span><span class="token punctuation">(</span>Dataset<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">:</span>        å½’ä¸€åŒ–ã€æ•°æ®å¤„ç†ã€ç­‰ç­‰        <span class="token keyword">return</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­</p><pre class="line-numbers language-python"><code class="language-python">train_loader <span class="token operator">=</span> DataLoader<span class="token punctuation">(</span>dataset<span class="token operator">=</span>trainDataset<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token keyword">for</span> batch_idx<span class="token punctuation">,</span> <span class="token punctuation">(</span>data<span class="token punctuation">,</span> target<span class="token punctuation">)</span> <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>train_loader<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ¯ä¸€æ¬¡ <code>for batch_idx, (data, target) in enumerate(train_loader)</code> éƒ½è¦é‡æ–°æ¥å¤„ç†ä¸€è¾¹æ•°æ®ï¼Œæ¯”å¦‚å½’ä¸€åŒ–ç­‰ï¼Œæ‰€ä»¥ï¼Œå¾ˆéº»çƒ¦ã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘çš„åšæ³•æ˜¯æå‰å°†æ•°æ®å¤„ç†å¥½ï¼Œå°†å¤„ç†å¥½çš„æ•°æ®æ”¾åœ¨ <code>csv</code>ç­‰æ ¼å¼çš„æ–‡ä»¶ä¸­ï¼Œç„¶åç›´æ¥è¯»å–æ–‡ä»¶å°±å¥½äº†ã€‚æˆ‘çš„ä»£ç æå‡äº† <code>50</code> å€ã€‚</p><h1 id="ç›¸å…³å‘½ä»¤"><a href="#ç›¸å…³å‘½ä»¤" class="headerlink" title="ç›¸å…³å‘½ä»¤"></a>ç›¸å…³å‘½ä»¤</h1><ul><li><pre class="line-numbers language-shell"><code class="language-shell">top<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>æŸ¥çœ‹ <code>cpu</code></li><li>å®æ—¶æŸ¥çœ‹ä½ çš„<code>CPU</code>çš„è¿›ç¨‹åˆ©ç”¨ç‡ï¼Œè¿™ä¸ªå‚æ•°å¯¹åº”ä½ çš„<code>num_workers</code>çš„è®¾ç½®</li></ul></li><li><pre class="line-numbers language-shell"><code class="language-shell">watch -n 0.5 nvidia-smi<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>æ¯<code>0.5ç§’</code>åˆ·æ–°å¹¶æ˜¾ç¤ºæ˜¾å¡è®¾ç½®</li><li>å®æ—¶æŸ¥çœ‹ä½ çš„<code>GPU</code>çš„ä½¿ç”¨æƒ…å†µï¼Œè¿™æ˜¯<code>GPU</code>çš„è®¾ç½®ç›¸å…³ã€‚è¿™ä¸¤ä¸ªé…åˆå¥½ã€‚åŒ…æ‹¬<code>batch_size</code>çš„è®¾ç½®ã€‚</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> pytorch </tag>
            
            <tag> CPU </tag>
            
            <tag> GPU </tag>
            
            <tag> åŠ é€Ÿ </tag>
            
            <tag> tensorflow </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çˆ¬è™«å®æˆ˜ç³»åˆ—ä¹‹çŸ¥ä¹GPU</title>
      <link href="/2021/08/12/pa-chong-shi-zhan-xi-lie-zhi-zhi-hu-gpu/"/>
      <url>/2021/08/12/pa-chong-shi-zhan-xi-lie-zhi-zhi-hu-gpu/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ä»¥ä¸‹å†…å®¹å‡çˆ¬è™«è·å¾—ï¼Œå¦‚æœ‰ä¾µæƒï¼Œè¯·è”ç³»åšä¸»lry89757ï¼Œé‚®ç®±ï¼š <a href="mailto:lry89757@gmail.com" target="_blank" rel="noopener">lry89757@gmail.com</a></p></blockquote><h1 id="å®éªŒå®¤ä¸€å—GPUéƒ½æ²¡æœ‰æ€ä¹ˆåšæ·±åº¦å­¦ä¹ ï¼Ÿ"><a href="#å®éªŒå®¤ä¸€å—GPUéƒ½æ²¡æœ‰æ€ä¹ˆåšæ·±åº¦å­¦ä¹ ï¼Ÿ" class="headerlink" title="å®éªŒå®¤ä¸€å—GPUéƒ½æ²¡æœ‰æ€ä¹ˆåšæ·±åº¦å­¦ä¹ ï¼Ÿ"></a>å®éªŒå®¤ä¸€å—GPUéƒ½æ²¡æœ‰æ€ä¹ˆåšæ·±åº¦å­¦ä¹ ï¼Ÿ</h1><p>2021-02-23é˜…è¯» 2500</p><p>è¿™ä¸ªé—®é¢˜ï¼Œ5å¹´å‰æˆ‘ä¹Ÿæƒ³é—®ã€‚</p><p>è¿˜è®°å¾— CVPR 2015 å¼€å®Œä¼šå›æ¥ï¼Œæ„Ÿè§‰å¤§å®¶éƒ½åœ¨è®¨è®º deep learningï¼Œconvolutional neural networkï¼Œå½“æ—¶è§‰å¾—åº”è¯¥è¯•è¯•ã€‚æˆ‘å°±ç”¨ç½‘ä¸Šå¼€æºçš„ LetNet åœ¨ç¬”è®°æœ¬ä¸Šè®­ç»ƒäº†ä¸€ä¸‹æˆ‘ä»¬å½“æ—¶è‡ªå·±é‡‡é›†çš„æ•°æ®é›†ï¼Œç»“æœå®Œçˆ†æˆ‘ä»¬è´¹å°½å¿ƒæ€æ‰‹åŠ¨è®¾è®¡çš„ä¼ ç»Ÿæ–¹æ³•ã€‚æˆ‘å½“æ—¶å°±é¼“åŠ¨æˆ‘è€æ¿ï¼Œè®©å¥¹ç»™å®éªŒå®¤ä¹°ä¸ªå¸¦ GPU çš„æœºå™¨ã€‚ç»“æœå¥¹è¯­é‡å¿ƒé•¿åœ°è¯´: â€œä½ çœ‹å®éªŒå®¤è¿™äº›æ—§ç”µè„‘ï¼Œæˆ‘ä¹‹å‰ç»™æ¯ä¸€ä¸ª PhD å­¦ç”Ÿéƒ½é…ä¸€å°ç”µè„‘ï¼Œç»“æœæ²¡è¿‡å¤šé•¿æ—¶é—´ï¼Œå¤§å®¶éƒ½ä¸ç”¨äº†ï¼Œåªç”¨è‡ªå·±çš„ç¬”è®°æœ¬ï¼Œæ‰€ä»¥ä¸è¦æŠŠé’±èŠ±åœ¨ç¡¬ä»¶ä¸Šâ€ã€‚æˆ‘ç«Ÿæ— è¨€ä»¥å¯¹ã€‚ã€‚ã€‚</p><p>ä½†æ˜¯ Research è¿˜æ˜¯è¦åšï¼Œæˆ‘å°±ä¸€ç‹ å¿ƒä¹°äº†ä¸ª Titan-Z GPUï¼Œå¤§æ¦‚èŠ±äº†åšå£«ä¸€ä¸ªæœˆçš„å·¥èµ„ï¼Œç„¶åå°±æœ‰äº†ä¸‹é¢è¿™å¼ å›¾ï¼š</p><p><a href="https://imgtu.com/i/fwS3HU" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/12/fwS3HU.jpg" alt="fwS3HU.jpg"></a><br>](<a href="https://imgtu.com/i/fwSJN4" target="_blank" rel="noopener">https://imgtu.com/i/fwSJN4</a>)</p><p><a href="https://imgtu.com/i/fwSyUe" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/12/fwSyUe.jpg" alt="fwSyUe.jpg"></a></p><p>é‚£æ—¶å€™è¿˜æ²¡æœ‰ eGPUï¼Œæˆ‘å°±è‡ªå·±æäº†ä¸ªè§£å†³æ–¹æ¡ˆï¼Œç”¨ä¸€ä¸ªå¤–ç½®å°å¼æœºç”µæºå¸¦åŠ¨ thunderbolt to PCIe çš„è½¬æ¥å™¨ã€‚æœ‰äº†è¿™äº›â€œè£…å¤‡â€ä¹‹åï¼Œæˆ‘å°±å¼€å§‹äº†è°ƒå‚çš„ä¸å½’è·¯ã€‚</p><p>æ¯”è¾ƒæ—©å…¥å‘ï¼Œ16 å¹´ç”¨ MatConvNet å¤ç°äº†ä¸€ä¸‹ ResNet zhanghang1989/ResNet-Matconvnetï¼Œç„¶åç”¨ ResNet æäº†ä¸‹ featureï¼Œæ¯”è¾ƒå®¹æ˜“æ°´ paperã€‚åœ¨ NVIDIA å®ä¹ çš„æ—¶å€™ï¼Œå¬è¯´å¯ä»¥è‡ªå·±å†™ proposal å‘ NVIDIA ç”³è¯·å…è´¹çš„ GPUï¼Œä¹‹åå°±æ¯å¹´éƒ½ç”³è¯·ä¸€å—ï¼Œç›´åˆ°æ¯•ä¸š (é“¾æ¥ï¼šGPU Grant Application)ã€‚åœ¨å‘äº†å‡ ç¯‡ deep learning çš„ paper ä¹‹åï¼Œæˆ‘è€æ¿ä¹Ÿå¼€å§‹æ¢æ–¹å‘äº†ï¼Œè€Œä¸”ç»™ç»„é‡Œçš„å­¦å¼Ÿä»¬ä¹°äº†8å¡çš„GPU Serverï¼ˆå½“æ—¶æ˜¯æˆ‘æ¯•ä¸šå‰å¸®è€æ¿æŒ‘çš„æœºå™¨ï¼Œå¯æƒœè‡ªå·±æ²¡æœ‰ç”¨åˆ°ï¼‰ã€‚</p><p>å¾ˆéš¾æƒ³è±¡ï¼Œå½“åˆå¦‚æœè‡ªå·±æ²¡æœ‰è‡ªè´¹ä¹° GPUï¼Œç°åœ¨æˆ‘ä¼šåœ¨å“ªé‡Œï¼Œåœ¨åšä»€ä¹ˆã€‚å¦‚æœå®¢è§‚æ¡ä»¶ä¸å¥½ï¼Œå°½é‡æƒ³åŠæ³•å…‹æœä¸€ä¸‹ï¼Œæœºä¼šè¦å¥½å¥½æŠŠæ¡</p><h2 id="ä½œè€…ï¼šå­”ç¥¥å‹‡-https-www-zhihu-com-question-299434830-answer-1138597471"><a href="#ä½œè€…ï¼šå­”ç¥¥å‹‡-https-www-zhihu-com-question-299434830-answer-1138597471" class="headerlink" title="ä½œè€…ï¼šå­”ç¥¥å‹‡ https://www.zhihu.com/question/299434830/answer/1138597471"></a><strong>ä½œè€…ï¼šå­”ç¥¥å‹‡</strong> <strong><a href="https://www.zhihu.com/question/299434830/answer/1138597471" target="_blank" rel="noopener">https://www.zhihu.com/question/299434830/answer/1138597471</a></strong></h2><p>æˆ‘ä»¬å­¦ç§‘ï¼Œå­¦æ ¡éƒ½ä¸€èˆ¬ï¼Œå¤§éƒ¨åˆ†è€å¸ˆéƒ½æ²¡ç»è´¹æ²¡è¿™äº›ç¡¬ä»¶çš„ã€‚</p><p>æˆ‘è‡ªå·±å®éªŒå®¤æ˜¯ä¸€ç‚¹ç‚¹ç§¯ç´¯ä¹°GPUçš„ï¼Œæ‹¿ä¸åˆ°å›½å®¶è¯¾é¢˜å°±åšä¼ä¸šè¯¾é¢˜ï¼Œç„¶åç”¨æ¥ç»™å­¦ç”Ÿä¹°GPUï¼Œç”µè„‘ï¼Œå†…å­˜ï¼Œç£ç›˜ï¼Œä¿è¯æœ¬ç§‘+ç ”ç©¶ç”Ÿ20å¤šäººçš„è®¡ç®—èƒ½åŠ›ã€‚AIè®¡ç®—çš„è¯ï¼šä¸€å°åŒå¡2080tiä¸»åŠ›è®¡ç®—å·¥ä½œç«™ï¼Œ4å°2080æˆ–è€…2070Sçš„GPUï¼Œç ”ç©¶ç”Ÿäººå‡ä¸€å°ï¼Œæœ¬ç§‘ä¸€ä¸ªå›¢é˜Ÿä¸€å°ã€‚å¹³å¸¸è·‘ä¸æ»¡ï¼Œå¦‚æœæœ‰å¤–é¢åˆä½œçš„å­¦ç”Ÿä¹Ÿä¼šå€Ÿç»™ä»–ä»¬ç”¨ï¼Œå¦‚æœæœ‰äº¤é›†ï¼Œå¯ä»¥ç§‘ç ”è®ºæ–‡åˆä½œã€‚</p><p>ä¸‹ä¸€æ­¥æ‰“ç®—ï¼šå¯¹åˆä½œå‹è”åˆçš„çƒ­çˆ±ç§‘ç ”çš„å­¦ç”Ÿï¼Œå¦‚æœè‡ªå·±å¯¼å¸ˆæ²¡æœ‰å‡ºè®ºæ–‡ç»è´¹çš„æˆ‘ä¼šå¸®ä»–ä»¬å‡ºã€‚å½“ç„¶æ¡ä»¶ä¹Ÿæ˜¯è¦æ±‚ï¼šä»–é™¤äº†è¦å®Œæˆè‡ªå·±çš„è®ºæ–‡ä¹Ÿè¦å¤šåšäº›å·¥ä½œï¼Œå¦‚æœæ„¿æ„çš„è¯ï¼Œæ”¯æŒä¸‹å­¦ç”Ÿä¹Ÿæ²¡é—®é¢˜ã€‚å¦‚æœæœ‰è¿™æ–¹é¢éœ€æ±‚æ„¿æ„åˆä½œï¼Œå¯ä»¥ç§ä¿¡æˆ‘ã€‚</p><p>æˆ‘ä»¬ä¸»è¦åšåŒ»å­¦äººå·¥æ™ºèƒ½ï¼Œé€šç”¨AIåœ¨æŠ€æœ¯ä¸Šä¸€æ ·çš„ï¼Œä¸é™åˆ¶è¯¾é¢˜ã€‚</p><h2 id="ä½œè€…ï¼šæ—¶é—´æ—…å®¢-https-www-zhihu-com-question-299434830-answer-1138460434"><a href="#ä½œè€…ï¼šæ—¶é—´æ—…å®¢-https-www-zhihu-com-question-299434830-answer-1138460434" class="headerlink" title="ä½œè€…ï¼šæ—¶é—´æ—…å®¢ https://www.zhihu.com/question/299434830/answer/1138460434"></a><strong>ä½œè€…ï¼šæ—¶é—´æ—…å®¢</strong> <strong><a href="https://www.zhihu.com/question/299434830/answer/1138460434" target="_blank" rel="noopener">https://www.zhihu.com/question/299434830/answer/1138460434</a></strong></h2><p>å®éªŒå®¤æ²¡æœ‰GPUï¼Œä¹Ÿä¸æƒ³èŠ±é’±ç§ŸGPUï¼Œå°±åªèƒ½ç”¨CPUäº†ã€‚CPUæ¯”GPUæ…¢å¾ˆå¤šï¼Œæ‰€ä»¥å¤æ‚çš„æ•°æ®é‡å¤§çš„ç ”ç©¶æ˜¯æ²¡æ³•åšäº†ã€‚é‚£ä¹ˆæœ‰æ²¡æœ‰æ•°æ®é‡å°ï¼Œä¸”æœ‰ä¸€äº›æ„ä¹‰çš„ç ”ç©¶å‘¢ï¼Ÿæœ‰ã€‚</p><p><strong>å»ºè®®ç ”ç©¶ä¸€äº›å¯è§£é‡Šæ€§çš„ç›¸å…³é—®é¢˜ã€‚</strong></p><p>ä¸¾ä¸€ä¸ªå·ç§¯ç¥ç»ç½‘ç»œçš„ä¾‹å­ï¼Œæ¯”å¦‚è¿™ä¸ªé—®é¢˜ï¼š</p><p>èƒ½å¦å¯¹å·ç§¯ç¥ç»ç½‘ç»œå·¥ä½œåŸç†åšä¸€ä¸ªç›´è§‚çš„è§£é‡Šï¼Ÿ<a href="https://www.zhihu.com/question/39022858" target="_blank" rel="noopener">https://www.zhihu.com/question/39022858</a></p><p>å¤§å®¶éƒ½æ˜¯ä»æ»¤æ³¢å™¨çš„è§’åº¦è§£é‡Šå·ç§¯æ ¸ï¼Œé‚£ä¹ˆæ€ä¹ˆèƒ½çŸ¥é“æ˜¯å¦è¯´çš„æ˜¯å¯¹çš„å‘¢ï¼Ÿæ˜¯ä¸æ˜¯å¯ä»¥å–100å¼ çŒ«å’Œ100å¼ ç‹—ï¼Œæ¨¡å‹è®¾ç½®ä¸ºä¸€å±‚feature mapä¸º10çš„3*3å·ç§¯+å…¨å±€poolï¼Œè®­ç»ƒåˆ°è¿‡æ‹Ÿåˆã€‚çœ‹çœ‹å“ªå‡ ä¸ªç»´åº¦ä¼šé¢„æµ‹åˆ°çŒ«ï¼Œå“ªå‡ ä¸ªç»´åº¦ä¼šé¢„æµ‹åˆ°ç‹—ï¼Œå†çœ‹çœ‹è¿™10ä¸ªå·ç§¯æ ¸é•¿ä»€ä¹ˆæ ·ï¼Œåˆ†æä¸€ä¸‹åŸå›¾è¿‡äº†è¿™äº›å·ç§¯æ ¸åˆ°åº•è·å¾—äº†ä»€ä¹ˆç‰¹å¾ã€‚</p><p>å†æ¯”å¦‚ï¼ŒCNNåœ¨ç»è¿‡å›¾åƒæ—‹è½¬ã€å¹³ç§»ã€æ”¾ç¼©ç­‰å¢å¼ºæ–¹æ³•ä¹‹åæ˜¯å¯ä»¥å…·æœ‰ç›¸åº”çš„ä¸å˜æ€§çš„ã€‚é‚£ä¹ˆå®ƒåˆ°åº•æ˜¯æ€ä¹ˆè·å¾—è¿™ç§ä¸å˜æ€§çš„å‘¢ï¼Ÿæ˜¯åˆ©ç”¨ä¸åŒçš„feature mapæ˜ å°„åˆ°æœ€åè¾“å‡ºå‘é‡ä¸­ä¸åŒçš„ç»´åº¦ï¼Œè¿˜æ˜¯æœ€åä¼šæ˜ å°„åˆ°ç›¸åŒç»´åº¦å‘¢ï¼Ÿ</p><p>å†è¿›ä¸€æ­¥ï¼Œè¡Œäººé‡è¯†åˆ«ä»»åŠ¡ä¸­æœ‰å¾ˆå¤šç”¨åº¦é‡å­¦ä¹ çš„æ–¹æ³•ï¼Œä¸¤å¼ å·®å¼‚å¾ˆå¤§çš„å›¾ç‰‡è¿‡åŒä¸€ä¸ªæ¨¡å‹å¯ä»¥å¾—åˆ°æ¯”è¾ƒè¿‘ä¼¼çš„å‘é‡ï¼Œé‚£ä¹ˆè¿™äº›æ¨¡å‹æ˜¯æ€ä¹ˆè·å–ç‰¹å¾å¹¶æ€ä¹ˆæ˜ å°„çš„å‘¢ï¼Ÿ</p><p>è¿™äº›é—®é¢˜å…¶å®æ˜¯æˆ‘ä¸€ç›´æ€è€ƒæ²¡æƒ³å‡ºç­”æ¡ˆï¼Œä½†ä¹Ÿæ²¡å»åšå®éªŒçš„ã€‚å› ä¸ºæˆ‘æœ‰GPUï¼Œå¹³æ—¶æ­æ¨¡å‹ã€è°ƒå‚çš„å·¥ä½œåšå¤šäº†ï¼Œå°±æ²¡æœ‰å¤ªå¤§åŠ¨åŠ›å»ç ”ç©¶è¿™äº›æœ‰æ„æ€çš„é—®é¢˜äº†ã€‚</p><h2 id="ä½œè€…ï¼šè«ç¬‘å‚…ç«‹å¶-https-www-zhihu-com-question-299434830-answer-1693087823"><a href="#ä½œè€…ï¼šè«ç¬‘å‚…ç«‹å¶-https-www-zhihu-com-question-299434830-answer-1693087823" class="headerlink" title="ä½œè€…ï¼šè«ç¬‘å‚…ç«‹å¶ https://www.zhihu.com/question/299434830/answer/1693087823"></a><strong>ä½œè€…ï¼šè«ç¬‘å‚…ç«‹å¶ <a href="https://www.zhihu.com/question/299434830/answer/1693087823" target="_blank" rel="noopener">https://www.zhihu.com/question/299434830/answer/1693087823</a></strong></h2><p>1.å…„å¼Ÿï¼Œèµ¶ç´§å‚¬ç€è€å¸ˆä¹°ä¸€å—ã€‚</p><p>\2. è¦ä¹ˆçœ‹è€å¸ˆå’Œè®¡ç®—æœºå­¦é™¢è€å¸ˆå…³ç³»å¦‚ä½•ï¼Œç›´æ¥ä½å¯¹æ–¹å®éªŒå®¤å»ã€‚</p><p>\3. æˆ‘ç”¨è¿‡å¥½å¤šç½‘ä¸Šå¹³å°ï¼Œæ»´æ»´äº‘è¿˜è¡Œï¼Œæœ‰å¤§ä¼ä¸šèƒŒä¹¦åˆä¾¿å®œï¼Œè¿˜æœ‰å¥½å¤šé€çš„æ´»åŠ¨ã€‚</p><p>\4. colabå°±ç®—äº†ã€‚</p><h2 id="ä½œè€…ï¼šsnowhou-https-www-zhihu-com-question-299434830-answer-1231487151"><a href="#ä½œè€…ï¼šsnowhou-https-www-zhihu-com-question-299434830-answer-1231487151" class="headerlink" title="ä½œè€…ï¼šsnowhou https://www.zhihu.com/question/299434830/answer/1231487151"></a><strong>ä½œè€…ï¼šsnowhou</strong> <strong><a href="https://www.zhihu.com/question/299434830/answer/1231487151" target="_blank" rel="noopener">https://www.zhihu.com/question/299434830/answer/1231487151</a></strong></h2><p>ä½ è¿™ä¸€å—å¡æ²¡æœ‰åšæ·±åº¦å­¦ä¹ ä¸å¤ªç°å®ï¼Œ<strong>æœ€å¥½è¯´æœä½ è€å¸ˆæœ€å¥½ä¹°å‡ å¼ å¡(1080ti)ä»¥ä¸Š</strong>ï¼Œæ¯•ç«Ÿä¹Ÿä¸æ˜¯ä½ ä¸€ä¸ªäººåœ¨ç”¨ã€‚è¿™æ˜¯å…¶å®æ˜¯æœ€åˆ’ç®—çš„æ–¹å¼ï¼Œåœ¨ç½‘ä¸Šæ— è®ºæ˜¯å…è´¹è¿˜æ˜¯ä»˜è´¹çš„èµ„æºï¼Œç»ˆç©¶ä¸æ˜¯é•¿è¿œä¹‹è®¡ï¼Œè€Œä¸”æœ‰ä¸€å®šçš„ä½¿ç”¨é™åˆ¶ã€‚<strong>äº‰å–ä¸åˆ°å¡çš„è¯è¿˜æ˜¯ä¹˜æ—©å¼ƒå‘å§ï¼Œæ·±åº¦å­¦ä¹ ä¸ç”¨å¤§é‡çš„å¡â€å–‚â€ï¼Œå¾ˆéš¾ç ”ç©¶å‡ºä»€ä¹ˆä¸œè¥¿ã€‚</strong></p><p>[<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/12/fwSJN4.jpg" alt="fwSJN4.jpg"></p><p>åˆ†äº«ä¸‹æˆ‘è‡ªå·±çš„â€å¡â€è·¯ï¼Œä½ å¯ä»¥å‚è€ƒä¸‹æˆ‘çš„â€è´«æ°‘â€å†ç¨‹ã€‚</p><p>ä¸€å¼€å§‹æœ‰<strong><em>4å—1080\</em></strong>ï¼Œå’Œå¸ˆå…„ä»¬ä¸€èµ·ç”¨ï¼Œå½“æ—¶åˆšå¼€å§‹å…¥é—¨ï¼Œä¹Ÿå°±è·‘ä¸‹ cs231n å’Œå½“æ—¶è¿˜æ˜¯caffe ç‰ˆæœ¬çš„ R-CNNï¼Œç”µè„‘ç³»ç»Ÿå¤ªè€äº†caffeæ€»æ˜¯å‡ºé—®é¢˜ï¼Œä¹Ÿåœ¨ç½‘ä¸Šç”¨è¿‡æœåŠ¡å™¨(å›½å†…ä»˜è´¹çš„ï¼Œè°·æ­Œäº‘çš„300ç¾é‡‘ï¼ŒColab ç­‰)ï¼Œä¹Ÿå°±éšä¾¿è·‘äº†è·‘ã€‚åæ¥éšç€ detectron ç­‰çš„å¼€æºï¼Œå‘ç° 1080 æ˜¾å­˜å¤ªå°äº†ï¼Œè€Œä¸”é€Ÿåº¦å¤ªæ…¢ï¼Œåªèƒ½è·‘ VOCï¼Œè·‘ COCO ä¸å¤ªç°å®ï¼Œä¸€åº¦å¾ˆå¥”æºƒï¼Œæƒ³ç€æ˜¯ä¸æ˜¯è¦æ¢ä¸ªæ–¹å‘ã€‚</p><p>ä»¥åå¯¹è€å¸ˆè½¯ç£¨ç¡¬æ³¡ï¼ŒåŠ äº†å° <strong>åŒ2080ti</strong>  çš„æœºå™¨ï¼Œç»ˆäºå¯ä»¥è·‘ COCO äº†ï¼Œè™½ç„¶è®­ç»ƒæ—¶é—´è¿˜æ˜¯ç•¥é•¿ï¼Œä¸è¿‡å·²ç»åœ¨æ¥å—èŒƒå›´å†…äº†ã€‚</p><p>åæ¥æœºç¼˜å·§åˆä¸‹å‘ç°äº†äº›å…è´¹çš„å¹³å°(ç™¾åº¦ AIStudioç­‰)ï¼Œç¬¬ä¸€æ¬¡ç”¨åˆ° <strong>V100</strong> ï¼Œçˆ½è¿‡å¸å¤§éº»ã€‚å¤šæ³¨å†Œäº†å‡ ä¸ªè´¦æˆ·ï¼Œç»ˆäºä¸åœ¨æ‹…å¿ƒç®—åŠ›çš„é—®é¢˜ï¼Œå°±è¿™æ ·å¼€å§‹äº†å‡çº§æ‰“æ€ªä¹‹è·¯ï¼Œè·‘è·‘è®ºæ–‡ä»£ç ï¼Œæ‰“æ‰“æ¯”èµ›ï¼Œå¥½å¤šä»»åŠ¡éƒ½å¯ä»¥å¹¶è¡Œå±•å¼€äº†ï¼Œè¿™æ—¶å€™å°±ç›¸å½“èˆ’æœäº†ï¼Œæ²¡æœ‰äº†ç®—åŠ›çš„çº¦æŸï¼Œæˆé•¿èµ·æ¥ä¹Ÿæ˜¯å¾ˆå¿«çš„ã€‚å‡å¦‚æ²¡æœ‰äº†è¿™äº›å…è´¹å¹³å°ï¼Œæ€•ä¸æ˜¯è¦åœ¨å…¥é—¨çš„åœ°æ–¹åŸåœ°è¸æ­¥äº†ã€‚</p><p>å…¶å®ç¼ºå°‘ç®—åŠ›è¿˜å¯ä»¥å»ä¼ä¸šå®ä¹ ï¼Œä¸è¿‡å¦‚æœåŸºæœ¬çš„ 1080ti éƒ½ç”¨ä¸ä¸Šï¼Œå¤§æ¦‚é—¨éƒ½å…¥ä¸äº†ï¼Œå…¬å¸ä¼°è®¡ä¹Ÿè¿›ä¸å»ã€‚æ‰€ä»¥è¿˜æ˜¯æœ€å¼€å§‹çš„è¯ï¼Œ<strong>å°½æ—©è”åˆä½ åŒå±ŠåŒå­¦è¯´æœè€å¸ˆä¹°å¡ï¼Œä¸ç„¶è¿˜æ˜¯ä¹˜æ—©å¼ƒå‘ã€‚è‡ªå·±å­¦(æ— äººæŒ‡å¯¼) + æ²¡å¡ = å¤©å‘ ï¸ï¼Œåˆ‡è®°ï¼</strong></p><h2 id="ä½œè€…ï¼šè‰¾åŠ›å…‹æ–¯Alex-https-www-zhihu-com-question-299434830-answer-1016932439"><a href="#ä½œè€…ï¼šè‰¾åŠ›å…‹æ–¯Alex-https-www-zhihu-com-question-299434830-answer-1016932439" class="headerlink" title="ä½œè€…ï¼šè‰¾åŠ›å…‹æ–¯Alex https://www.zhihu.com/question/299434830/answer/1016932439"></a><strong>ä½œè€…ï¼šè‰¾åŠ›å…‹æ–¯Alex</strong> <strong><a href="https://www.zhihu.com/question/299434830/answer/1016932439" target="_blank" rel="noopener">https://www.zhihu.com/question/299434830/answer/1016932439</a></strong></h2><p>ä¸Šå­¦æœŸåšçš„computional vision  è¿œç¨‹è¿æ¥å­¦æ ¡linuxè£…ä¸äº†tensorflowï¼ŒGoogle Colabå°è¯•äº†ä¸¤å¤©ä¹Ÿæ²¡è®¾ç½®å¥½</p><p>ç„¶åå¿ƒä¸€æ¨ª æˆ‘å°±ç”¨æˆ‘çš„å››æ ¸8GBMacBookæ…¢æ…¢è·‘å§ trainä¸€æ¬¡ä¸€å¤© validate 6ä¸ªå°æ—¶ï¼Œæˆ‘å°±è¿™æ ·åšæŒäº†ä¸€ä¸ªæœˆæŠŠä½œä¸šå†™å®Œäº†ã€‚</p><h2 id="ä½œè€…ï¼šè§†å­¦ç®—æ³•-https-www-zhihu-com-question-299434830-answer-1071679101"><a href="#ä½œè€…ï¼šè§†å­¦ç®—æ³•-https-www-zhihu-com-question-299434830-answer-1071679101" class="headerlink" title="ä½œè€…ï¼šè§†å­¦ç®—æ³• https://www.zhihu.com/question/299434830/answer/1071679101"></a><strong>ä½œè€…ï¼šè§†å­¦ç®—æ³•</strong> <strong><a href="https://www.zhihu.com/question/299434830/answer/1071679101" target="_blank" rel="noopener">https://www.zhihu.com/question/299434830/answer/1071679101</a></strong></h2><p>å¯¹åˆå­¦è€…æ¥è¯´CPUè¶³ä»¥ã€‚ä»¥ä¸‹å‡ ç‚¹ï¼š</p><p>1ã€å…ˆæŠŠCPUåˆ©ç”¨å¥½ï¼šå…¶å®å¯¹äºå¾ˆå¤šåˆå­¦è€…æ¥è¯´èƒ½æŠŠOpenMPIé…ç½®å¥½ï¼Œå¤šçº¿ç¨‹åˆ©ç”¨èµ·æ¥ï¼ŒCåº•å±‚ç¨‹åºç”¨Intel MKLç¼–è¯‘(éœ€è¦Intel CPU)ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥å¸¦æ¥çš„æ•ˆç‡æå‡å¯ä»¥è¿‘ä¼¼äºç”¨GPUã€‚</p><p>2ã€ç„¶ååˆ©ç”¨å¥½ä½ è‡ªå·±çš„æ—¶é—´: è²Œä¼¼ç°åœ¨é“å¬é€”è¯´ä¸€èˆ¬çš„ç»“è®ºæ˜¯GPUæ¯”CPUæé€Ÿ10å€å·¦å³ã€‚å¤§å®¶æƒ³æƒ³ï¼Œè®­ç»ƒä¸€ä¸ªæ¨¡å‹ï¼Œæœ¬æ¥è¦CPUè·‘10ä¸ªå°æ—¶ï¼Œç»“æœä¹°äº†GPUåªç”¨1ä¸€ä¸ªå°æ—¶ï¼Œä½†æ˜¯èŠ‚çº¦æ¥çš„9ä¸ªå°æ—¶é‡Œé¢ä¸€åŠæµªè´¹åœ¨äº†çœ‹çŸ¥ä¹ä¸Šï¼ˆè¯´ä½ å‘¢ï¼ï¼‰ï¼Œå¦ä¸€åŠæµªè´¹åœ¨äº†åˆ·å¾®ä¿¡ä¸Šã€‚æœ¬å±Œæœ€è¿‘è·‘äº›NLPæ–¹é¢çš„ä¸œè¥¿ï¼Œä¸œè¥¿ä¸æ˜¯ç‰¹åˆ«å¤§ï¼ŒUbuntuç¬”è®°æœ¬è£…äº†OpenMPIå¯ä»¥å››ä¸ªçº¿ç¨‹ä¸€èµ·è·‘ï¼Œä¹Ÿæ¯”å•æ ¸CPUå¿«ä¸€å€å·¦å³ï¼ŒåŸºæœ¬ä¸Šç™½å¤©å…ˆæŠŠæ¨¡å‹è®¾ç½®å¥½ï¼Œè·‘ä¸Š3~4ä¸ªEpochçœ‹çœ‹æ•ˆæœï¼Œç„¶ååœ¨æ™šä¸Šç¡è§‰ä¹‹å‰å¼€å§‹è·‘ä¸ª20-30ä¸ªå¾ªç¯ï¼Œç¬¬äºŒå¤©æ—©ä¸Šæ€ä¹ˆä¹Ÿéƒ½å¥½äº†ã€‚</p><p>3ã€æœ€åè®¾è®¡å¥½æ•°æ®ç»“æ„: å¦å¤–å…¶å®æ•°æ®é¢„å¤„ç†çš„å¥½ï¼Œç”¨ç®€ä¾¿çš„æ–¹æ³•å­˜åœ¨å†…å­˜é‡Œé¢ï¼Œä¹Ÿæ˜¯å¯ä»¥æå‡ä¸å°‘æ•ˆç‡çš„ã€‚</p><h2 id="ä½œè€…ï¼šrunner-time-https-www-zhihu-com-question-299434830-answer-1099500820"><a href="#ä½œè€…ï¼šrunner-time-https-www-zhihu-com-question-299434830-answer-1099500820" class="headerlink" title="ä½œè€…ï¼šrunner time https://www.zhihu.com/question/299434830/answer/1099500820"></a><strong>ä½œè€…ï¼šrunner time</strong> <strong><a href="https://www.zhihu.com/question/299434830/answer/1099500820" target="_blank" rel="noopener">https://www.zhihu.com/question/299434830/answer/1099500820</a></strong></h2><p>å®éªŒå®¤è¿æ˜¾å¡éƒ½æ²¡æœ‰å°±è¯´è¦ææ·±åº¦å­¦ä¹ ï¼Ÿé‚£æˆ‘çœ‹ä½ ä»¬å¯¼å¸ˆä¹Ÿæ˜¯è„‘é—¨ä¸€æ‹ï¼Œç„¶åéšæ‰‹ææœ¬æ•™ç§‘ä¹¦èƒ¡æä¹±æï¼Œä½ è§‰å¾—è¿™æ ·ä¸‹å»èƒ½æå‡ºä»€ä¹ˆåå ‚ï¼Ÿ</p><p>ä¸å¦‚ä¹°å—æ¸¸æˆæ˜¾å¡æ‰“æ¸¸æˆå»ã€‚</p><p>å“¦ï¼Œå…¶å®æ¸¸æˆæ˜¾å¡ä¹Ÿæ˜¯å¯ä»¥ææ·±åº¦å­¦ä¹ çš„ï¼Œå›¾çµæ¶æ„æ˜¾å¡çš„CUDAè®¡ç®—åŠ›é«˜è¾¾7.0ï¼Œåªè¦1500å…ƒä¸€å—ï¼Œä½ å€¼å¾—æ‹¥æœ‰ï¼</p>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> GPU </tag>
            
            <tag> çˆ¬è™« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Typoraé›†æˆPicGoå›¾åºŠæœåŠ¡</title>
      <link href="/2021/08/10/typora-ji-cheng-picgo-tu-chuang-fu-wu/"/>
      <url>/2021/08/10/typora-ji-cheng-picgo-tu-chuang-fu-wu/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ç»™å¤§å®¶æ¨é€ä¸€æ³¢ç¦åˆ©ï¼Œæ–°ç‰ˆæœ¬çš„ Markdown å†™ä½œåˆ©å™¨ â€”â€”<strong>Typora</strong>ï¼Œé›†æˆäº† PicGo æœåŠ¡ï¼Œæ–‡ç« æ’å…¥å›¾ç‰‡å³å¯é€šè¿‡ PicGo æœåŠ¡ä¸Šä¼ åˆ°å›¾åºŠå†…ã€‚åºŸè¯ä¸å¤šè¯´ï¼Œç›´æ¥å¼€é—¨è§å±±ï¼</p><h1 id="ç¬¬ä¸€æ­¥"><a href="#ç¬¬ä¸€æ­¥" class="headerlink" title="ç¬¬ä¸€æ­¥"></a>ç¬¬ä¸€æ­¥</h1><p>å®‰è£… PicGo è½¯ä»¶ï¼Œæ¥ç€å›¾åºŠçš„æ­å»ºï¼Œå¹¶è¿›è¡Œç›¸å…³çš„é…ç½®ã€‚</p><h1 id="ç¬¬äºŒæ­¥"><a href="#ç¬¬äºŒæ­¥" class="headerlink" title="ç¬¬äºŒæ­¥"></a>ç¬¬äºŒæ­¥</h1><p>æ³¨æ„ï¼šPicGo è½¯ä»¶çš„ç‰ˆæœ¬è¦æ±‚ 2.2.0 åŠä»¥ä¸Š</p><p>æ‰“å¼€ PicGo è½¯ä»¶çš„è®¾ç½®ç•Œé¢ï¼Œè¿›è¡Œ Server çš„è®¾ç½®ï¼š</p><p>PicGo è®¾ç½® -&gt; è®¾ç½® Serverï¼Œå¼€å¯ Serverï¼Œç›‘å¬åœ°å€ä¸ç”¨è¿›è¡Œæ›´æ”¹ï¼Œç›‘å¬ç«¯å£çš„å€¼è®¾ç½®ä¸º 36677ï¼Œè¿™ä¸ªå€¼çš„è·å–åœ¨ Typora è½¯ä»¶ä¸­ï¼Œä¸‹é¢ä¼šæåˆ°ï¼š</p><p><a href="https://cdn.jsdelivr.net/gh/Yafine/Yafine-imgs/images/20200316220909.png" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/Yafine/Yafine-imgs/images/20200316220909.png" alt></a></p><h1 id="ç¬¬ä¸‰æ­¥"><a href="#ç¬¬ä¸‰æ­¥" class="headerlink" title="ç¬¬ä¸‰æ­¥"></a>ç¬¬ä¸‰æ­¥</h1><p>æ³¨æ„ï¼šTypora è½¯ä»¶çš„ç‰ˆæœ¬è¦æ±‚ 0.9.84 åŠä»¥ä¸Š</p><p>æ¥ä¸‹æ¥è¿›è¡Œ Typora çš„è®¾ç½®ï¼ŒTypora çš„å®‰è£…æˆ‘å°±ä¸è¯´äº†ï¼Œç›¸ä¿¡å¤§å®¶éƒ½ä¼šå®‰è£…ï¼Œæ‰“å¼€ typora è½¯ä»¶ï¼Œä¾æ¬¡æ‰“å¼€æ­¥éª¤ä¸ºï¼šæ–‡ä»¶ -&gt; åå¥½è®¾ç½® -&gt; å›¾åƒï¼Œå…·ä½“é…ç½®å‚è€ƒä¸‹é¢çš„å›¾ä¸­çš„é…ç½®ï¼š</p><p><a href="https://cdn.jsdelivr.net/gh/Yafine/Yafine-imgs/images/20200316222009.png" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/Yafine/Yafine-imgs/images/20200316222009.png" alt></a></p><h1 id="ç¬¬å››æ­¥"><a href="#ç¬¬å››æ­¥" class="headerlink" title="ç¬¬å››æ­¥"></a>ç¬¬å››æ­¥</h1><p>è¿›è¡ŒéªŒè¯ï¼Œçœ‹ Typora æ˜¯å¦å¯ä»¥æˆåŠŸçš„é€šè¿‡ PicGo ä¸Šä¼ åˆ°å›¾åºŠ</p><p>ç‚¹å‡»ç¬¬ä¸‰æ­¥å›¾ä¸­çš„éªŒè¯å›¾ç‰‡é€‰é¡¹ï¼Œå½“æˆåŠŸåä¼šå‡ºç°ä¸‹é¢å›¾ä¸­çš„æƒ…å†µ</p><p><a href="https://cdn.jsdelivr.net/gh/Yafine/Yafine-imgs/images/20200316222349.png" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/Yafine/Yafine-imgs/images/20200316222349.png" alt></a></p><p>å›¾ä¸­å¯ä»¥çœ‹å‡ºç›‘å¬åœ°å€ä»¥åŠç«¯å£å·ï¼Œè¿™ä¸ªéœ€è¦ä¸ PicGo çš„ Server æœåŠ¡ä¸­çš„ç›‘å¬åœ°å€ä»¥åŠç«¯å£å·ä¸€è‡´ï¼Œå¦åˆ™ä¸Šä¼ ä¼šå¤±è´¥ï¼</p><h1 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h1><p>æœ‰ä¸‰ç§æ–¹æ³•</p><h2 id="ç¬¬ä¸€ç§"><a href="#ç¬¬ä¸€ç§" class="headerlink" title="ç¬¬ä¸€ç§"></a>ç¬¬ä¸€ç§</h2><p>é‡‡ç”¨æ‹–æ‹½çš„æ–¹æ³•ï¼Œç›´æ¥å°†æœ¬åœ°å›¾ç‰‡æ‹–æ‹½åˆ°æ–‡ç« ä¸­ï¼Œå³å¯è¿›è¡Œä¸Šä¼ </p><h2 id="ç¬¬äºŒç§"><a href="#ç¬¬äºŒç§" class="headerlink" title="ç¬¬äºŒç§"></a>ç¬¬äºŒç§</h2><p>é‡‡ç”¨æ’å…¥æœ¬åœ°å›¾ç‰‡çš„æ–¹æ³•ï¼Œä½¿ç”¨å¿«æ·é”® <strong>Ctrl + Shift + I</strong>ï¼Œé€‰æ‹©å›¾ç‰‡è·¯å¾„å³å¯</p><h2 id="ç¬¬ä¸‰ç§"><a href="#ç¬¬ä¸‰ç§" class="headerlink" title="ç¬¬ä¸‰ç§"></a>ç¬¬ä¸‰ç§</h2><p>é‡‡ç”¨æˆªå›¾è½¯ä»¶ï¼Œæˆ‘æ¨èå¤§å®¶ä¸€æ¬¾è½¯ä»¶ â€”â€”<strong>Snipaste</strong>ï¼Œå¯ä»¥å¿«é€Ÿæˆªå›¾å¹¶è¿›è¡Œç²˜è´´ï¼Œå¿«æ·é”® <strong>F1</strong>ï¼Œè¿›è¡Œæˆªå›¾ï¼Œ<strong>Ctrl + C</strong>ï¼Œè¿›è¡Œå¤åˆ¶ï¼Œ<strong>Ctrl + V</strong>ï¼Œè¿›è¡Œç²˜è´´ï¼Œå¯ä»¥ç›´æ¥ç²˜è´´åˆ°æ–‡ç« å†…ï¼Œç„¶åå°±è‡ªåŠ¨ä¸Šä¼ åˆ°å›¾ä¼ å†…ï¼Œå¾ˆæ–¹ä¾¿ï¼Œè¿˜æœ‰å¾ˆå¤šå¥½ç”¨çš„æˆªå›¾è½¯ä»¶ï¼Œæˆ‘å°±ä¸åœ¨è¿™é‡Œè¯´äº†</p><p>å¦‚æœä½ åœ¨ç”µè„‘ä¸Šç™»å½• QQï¼Œä¹Ÿå¯ä»¥é€šè¿‡å¿«æ·é”® <strong>Ctrl + Alt + A</strong>ï¼Œè¿›è¡Œå¿«é€Ÿæˆªå›¾å¹¶è¿›è¡Œå¤åˆ¶ç²˜è´´ï¼Œç›´æ¥ç²˜è´´åˆ°æ–‡ç« ä¸­å³å¯ã€‚</p><h1 id="é—®é¢˜é›†é”¦"><a href="#é—®é¢˜é›†é”¦" class="headerlink" title="é—®é¢˜é›†é”¦"></a>é—®é¢˜é›†é”¦</h1><h2 id="é”™è¯¯ä¸€ï¼š-Failed-to-fetch"><a href="#é”™è¯¯ä¸€ï¼š-Failed-to-fetch" class="headerlink" title="é”™è¯¯ä¸€ï¼š Failed to fetch"></a>é”™è¯¯ä¸€ï¼š Failed to fetch</h2><p>è¿™ä¸ªé—®é¢˜ä¸€èˆ¬æ˜¯å› ä¸ºç«¯å£ä¸ä¸€è‡´è€Œå¯¼è‡´çš„ï¼ŒTypora ç›‘å¬çš„ç«¯å£å·ä¸º 36677ï¼Œå¦‚ä½•è§£å†³å‘¢ï¼Ÿ</p><p>è§£å†³åŠæ³•ï¼š</p><p>æ‰“å¼€ PicGo è½¯ä»¶ï¼Œç„¶åä¾æ¬¡æ‰“å¼€ <code>PicGoè®¾ç½®</code>ğŸ‘‰<code>è®¾ç½®Server</code>ï¼ŒæŸ¥çœ‹å½“å‰çš„ç«¯å£å·ï¼Œå¦‚æœä¸æ˜¯ 36677ï¼Œåˆ™å°†ç›‘å¬ç«¯å£å·ä¿®æ”¹ä¸º 36677 å³å¯ã€‚</p><p>ä¸è¿‡æœ‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„è€æœ‹å‹ Failed to fetch è¿˜æ˜¯å¦‚çº¦è€Œè‡³ï¼Œæ‰“å¼€ç«¯å£è®¾ç½®ä¸€çœ‹ï¼Œæ€ä¹ˆå˜æˆäº† 366771ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</p><p>é—®é¢˜åœ¨äºç«¯å£å†²çªï¼Œå¦‚æœä½ æ‰“å¼€äº†å¤šä¸ª picgo ç¨‹åºï¼Œå°±ä¼šç«¯å£å†²çªï¼Œ<strong>picgo è‡ªåŠ¨å¸®ä½ æŠŠ 36677 ç«¯å£æ”¹ä¸º 366771 ç«¯å£</strong>ï¼Œå¯¼è‡´é”™è¯¯ã€‚log æ–‡ä»¶é‡Œä¹Ÿå†™å¾—å¾ˆæ¸…æ¥šã€‚</p><p><code>è§£å†³æ–¹æ³•</code>ï¼š<strong>å…ˆæŠŠ picgo ä¸­çš„ç«¯å£è®¾ç½®æ”¹å› 36677ï¼Œç„¶åé€€å‡ºæ‰€æœ‰ picgo ç¨‹åº</strong>ï¼Œå†ä½¿ç”¨ typora ä¸Šä¼ åŠŸèƒ½ï¼ˆä¼šè‡ªåŠ¨å¯åŠ¨ picgo ç¨‹åºï¼‰</p><h2 id="é”™è¯¯äºŒï¼š-â€œsuccessâ€-false"><a href="#é”™è¯¯äºŒï¼š-â€œsuccessâ€-false" class="headerlink" title="é”™è¯¯äºŒï¼š{â€œsuccessâ€,false}"></a>é”™è¯¯äºŒï¼š{â€œsuccessâ€,false}</h2><p>è¿™ä¸ªé”™è¯¯ç›¸ä¿¡ä¹Ÿæœ‰å¾ˆå¤šå°ä¼™ä¼´é‡åˆ°äº†ï¼ŒåŸå› æ˜¯<strong>æ–‡ä»¶åå†²çª</strong>äº†ï¼Œå¦‚æœä½ ä¸Šä¼ è¿‡ä¸€å¼  image1.jpg çš„å›¾ç‰‡ï¼Œå†ä¸Šä¼ åç§°ä¸€æ ·çš„å›¾ç‰‡å°±ä¼šå¤±è´¥ï¼Œlog æ—¥å¿—ä¸­ä¹Ÿä¼šå†™é“ã€‚</p><p>åŠæ³•ä¹Ÿå¾ˆç®€å•ï¼Œæ‰“å¼€ picgo è®¾ç½®ï¼Œå°†ã€<strong>æ—¶é—´æˆ³é‡å‘½åã€‘æ‰“å¼€</strong>å³å¯ï¼Œå†æ¬¡ä¸Šä¼ å³å¯æˆåŠŸï¼å¦å¤–è¿˜æœ‰ä¸€ä»¶äº‹å°±æ˜¯ç›®å‰PicGo.appä¸æ”¯æŒä¸Šä¼ ç½‘ç»œå›¾ç‰‡ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›®å‰åªèƒ½ä¸Šä¼ æœ¬åœ°å›¾ç‰‡(æˆ‘è¢«<a href="https://github.com/Molunerfinn/PicGo/issues/432" target="_blank" rel="noopener">è¿™ä¸ª</a>å‘æ­»äº†ï¼‰ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://gitee.com/moisten-the-rain/image01/raw/master/img/20210810183614.jpg" alt></p><p><a href="https://cdn.jsdelivr.net/gh/Yafine/Yafine-imgs/images/20200501114637.png" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/Yafine/Yafine-imgs/images/20200501114637.png" alt></a></p><hr><p>å‹æƒ…æé†’ï¼š</p><p>PicGo çš„æ—¥å¿— (log) æ–‡ä»¶æ˜¯ä¸ªå¥½ä¸œè¥¿ï¼Œå¦‚æœå‡ºç°æŠ¥é”™ï¼Œå›¾ç‰‡ä¸Šä¼ ä¸æˆåŠŸçš„æƒ…å†µï¼Œå¤§å®¶å¯ä»¥æ‰“å¼€æ—¥å¿—çœ‹çœ‹ï¼Œæ ¹æ®æ—¥å¿—è¾“å‡ºï¼Œç„¶åè‡ªå·±å°è¯•è§£å†³ï¼Œç™¾åº¦æ˜¯ä¸ªå¥½ä¸œè¥¿ï¼ğŸ˜ğŸ˜ğŸ˜</p><p><a href="https://cdn.jsdelivr.net/gh/Yafine/Yafine-imgs/images/20200501114257.png" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/Yafine/Yafine-imgs/images/20200501114257.png" alt></a></p><p><a href="https://cdn.jsdelivr.net/gh/Yafine/Yafine-imgs/images/2020-05-01_11-43-27.png" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://cdn.jsdelivr.net/gh/Yafine/Yafine-imgs/images/2020-05-01_11-43-27.png" alt></a></p><hr><p>å‚è€ƒï¼š<a href="https://zhuanlan.zhihu.com/p/114175770" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/114175770</a></p><blockquote><p><strong>æ–‡ç« ä½œè€…:</strong> <a href="mailto:undefined" target="_blank" rel="noopener">Yafine</a></p><p><strong>æ–‡ç« é“¾æ¥:</strong> <a href="https://yafine-blog.cn/posts/4e9b.html" target="_blank" rel="noopener">https://yafine-blog.cn/posts/4e9b.html</a></p><p><strong>ç‰ˆæƒå£°æ˜:</strong> æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://yafine-blog.cn/" target="_blank" rel="noopener">è¿‡å®¢ï½åŠ±ã‚€</a>ï¼</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ•ˆç‡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å›¾åºŠ </tag>
            
            <tag> markdown </tag>
            
            <tag> ç äº‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°ä¸€æ¬¡åæŒ–çŸ¿ç—…æ¯’ï¼ˆè½¬ï¼‰</title>
      <link href="/2021/08/10/ji-yi-ci-fan-wa-kuang-bing-du-zhuan/"/>
      <url>/2021/08/10/ji-yi-ci-fan-wa-kuang-bing-du-zhuan/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ä½œè€…ï¼š<a href="https://home.cnblogs.com/u/wq242424/" target="_blank" rel="noopener">ä¸¨oè½ä¹„é›¨oä¸¨</a></p><p>å‡ºå¤„ï¼š<a href="http://www.cnblogs.com/wq242424/" target="_blank" rel="noopener">http://www.cnblogs.com/wq242424/</a></p><p>æœ¬æ–‡ç‰ˆæƒå½’ä½œè€…å’Œåšå®¢å›­å…±æœ‰ï¼Œæ¬¢è¿è½¬è½½ï¼Œä½†æœªç»ä½œè€…åŒæ„å¿…é¡»ä¿ç•™æ­¤æ®µå£°æ˜ï¼Œä¸”åœ¨æ–‡ç« é¡µé¢æ˜æ˜¾ä½ç½®ç»™å‡ºåŸæ–‡è¿æ¥ï¼Œå¦åˆ™ä¿ç•™è¿½ç©¶æ³•å¾‹è´£ä»»çš„æƒåˆ©ã€‚</p></blockquote><p>è¿™ä¸¤å¤©å®éªŒå®¤ç”µè„‘ä¸­åº¦äº†ï¼Œæ— æ•…è¢«å ç”¨50%cpuæŒ–çŸ¿ï¼Œä¸”è¿è¡Œä»»ä½•ç¨‹åºéƒ½ä¼škilledã€‚</p><p>è¿è¡ŒåŸç†ç±»ä¼¼äºï¼Œè‡ªåŠ¨ç½‘ä¸Šä¸‹è½½æŒ–çŸ¿ç¨‹åºï¼Œç„¶årmåˆ é™¤ç¨‹åºï¼Œè®©ä½ æ— ä»æ‰¾åˆ°ç¨‹åºï¼Œæœ‰æ—¶å€™è¿˜ä¼šç”¨ld.so.preloadä¼ªè£…ï¼Œä½¿ä½ çœ‹ä¸åˆ°å ç”¨èµ„æºçš„æŒ–çŸ¿ç¨‹åºåç§°ï¼Œåœ¨è¯•äº†å„ç§åŠæ³•åï¼Œæœ€æœ‰æ•ˆçš„å¦‚ä¸‹ï¼š</p><p><strong>ä¸€ã€æœç»æ¶æ„IPè®¿é—®</strong></p><p>æ‰§è¡ŒnetstatæŸ¥è¯¢å¤–éƒ¨ipï¼Œ</p><pre class="line-numbers language-shell"><code class="language-shell">1 $ netstat -ant<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å‘ç°æ¥è‡ªäºè·å…°çš„ä¸€ä¸ªipï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">1 45.153.184.134<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¦ç”¨ipï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">1 $ iptables -I INPUT -s  45.153.0.0/16 -j DROP2 # ä¿å­˜è§„åˆ™3 $ iptables-save > /etc/sysconfig/iptables4 # ä½¿è§„åˆ™ç”Ÿæ•ˆ5 $ iptables -L<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·å°±ç¦æ­¢äº†æ­¤ipçš„è®¿é—®ã€‚</p><p>æœ‰æ—¶ï¼Œé»‘å®¢ä¼šåˆ©ç”¨è‡ªå¯åŠ¨ç¨‹åºåœ¨å¼€æœºæ—¶å¯¹iptablesè¿›è¡Œä¿®æ”¹ï¼Œæ‰€ä»¥éœ€è¦äº‹å…ˆå¯¹iptablesè¿›è¡Œæ¸…ç©ºï¼Œåœ¨æ­¤ï¼Œè®°å½•ä¸‹é‡å†™iptablesçš„è¿‡ç¨‹ã€‚</p><p>æ¸…é™¤æ‰€æœ‰è§„åˆ™ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">1 $ iptables -F2 $ iptables -X3 $ iptables -Z<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ·»åŠ ä¸€äº›å¸¸ç”¨ç«¯å£ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell"> 1 #å…è®¸æœ¬åœ°å›ç¯æ¥å£(å³è¿è¡Œæœ¬æœºè®¿é—®æœ¬æœº) 2 $ iptables -A INPUT -i lo -j ACCEPT 3 # å…è®¸å·²å»ºç«‹çš„æˆ–ç›¸å…³è¿çš„é€šè¡Œ 4 $ iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT 5 #å…è®¸æ‰€æœ‰æœ¬æœºå‘å¤–çš„è®¿é—® 6 $ iptables -A OUTPUT -j ACCEPT 7 # å…è®¸è®¿é—®22,21,20,80ç«¯å£ 8 $ iptables -A INPUT -p tcp --dport 22 -j ACCEPT 9 $ iptables -A INPUT -p tcp --dport 21 -j ACCEPT10 $ iptables -A INPUT -p tcp --dport 20 -j ACCEPT11 $ iptables -A INPUT -p tcp --dport 80 -j ACCEPT12 # å…è®¸127.0.0.113 $ iptables -A INPUT -s 127.0.0.1 -d 127.0.0.1 -j ACCEPT14 $ iptables -A OUTPUT -s 127.0.0.1 -d 127.0.0.1 -j ACCEP15 #16 $ iptables -A OUTPUT -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT17 $ iptables -A OUTPUT  -p tcp --sport 80 -m state --state ESTABLISHED -j ACCEPT18 #å…è®¸ping19 $ iptables -A INPUT -p icmp -m icmp --icmp-type 8 -j ACCEPT20 #è¿è¡Œè‡ªå·±æŒ‡å®šçš„ç½‘æ®µ21 $ iptables -A INPUT -p tcp -s 172.16.0.0/16 --dport 22 -j ACCEPT22 #ç¦æ­¢å…¶ä»–æœªå…è®¸çš„è§„åˆ™è®¿é—®23 $ iptables -A INPUT -j REJECT  #ï¼ˆæ³¨æ„ï¼šå¦‚æœ22ç«¯å£æœªåŠ å…¥å…è®¸è§„åˆ™ï¼ŒSSHé“¾æ¥ä¼šç›´æ¥æ–­å¼€ã€‚ï¼‰24 $ iptables -A FORWARD -j REJECT<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æŸ¥çœ‹ç½‘ç»œé€šä¿¡ï¼ŒæŸ¥æ‰¾å¼‚å¸¸IPï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">1 $ netstat -ant æˆ–è€… netstat -antp<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><a href="https://imgtu.com/i/fJmhB6" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/10/fJmhB6.png" alt="IP"></a></p><p>ç¦æ­¢æŒ–çŸ¿ç½‘æ®µï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">1 $ iptables -I INPUT -s 198.251.0.0/16 -j DROP2 $ iptables -I INPUT -s 45.153.0.0/16 -j DROP3 $ iptables -I INPUT -s 54.38.193.170 -j DROP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>åªå…è®¸å†…ç½‘ç½‘æ®µï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">1 $ iptables -A INPUT -p tcp -s 172.16.0.0/16 --dport 22 -j ACCEPT<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åˆ°æ­¤ï¼Œè§„åˆ™å°±é‡å†™å®Œæˆï¼Œè®°å¾—ä¿å­˜è§„åˆ™ç”Ÿæ•ˆï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">1 $ iptables-save > /etc/sysconfig/iptables2 $ iptables -L<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è®¾ç½®iptableså¼€æœºå¯åŠ¨ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">1 $ chkconfig --level 345 iptables on2 $service iptables save<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>äºŒã€åˆ é™¤æŒ–çŸ¿ç—…æ¯’æºç¨‹åº</strong></p><p>å¯ä»¥å‚è€ƒ<a href="https://blog.csdn.net/weixin_45284355/article/details/110728620" target="_blank" rel="noopener">https://blog.csdn.net/weixin_45284355/article/details/110728620</a> è¿™ç¯‡åšå®¢ï¼Œè·Ÿæˆ‘é‡åˆ°çš„é—®é¢˜å‡ ä¹ä¸€æ ·ã€‚</p><p>åœ¨ /bin/ ä¸‹æ‰¾åˆ° sysdrr æŒ–çŸ¿æºç—…æ¯’ç¨‹åºï¼Œå¹¶åˆ é™¤ï¼</p><p>åŒæ—¶ä¹Ÿå¯ä»¥ä½¿ç”¨ find / -name sysdrr å…¨ç›˜æŸ¥æ‰¾æºç—…æ¯’ç¨‹åºï¼Œå¹¶åˆ é™¤ï¼</p><p>åœ¨ /etc/cron.monthly/ , /etc/cron.weekly/ , /etc/cron.daily/ , /etc/cron.hourly/ è¿™äº›å®šæ—¶ç›®å½•é‡Œæ‰¾åˆ°syncç¨‹åºå¹¶åˆ é™¤ï¼</p><p>ç”¨ crontab -l æŸ¥çœ‹å®šæ—¶ä»»åŠ¡å¹¶åˆ é™¤æ‰€æœ‰å¼‚å¸¸å®šæ—¶ä»»åŠ¡ã€‚</p><p>ä¸Šè¿°sysdrrå’Œsyncç›´æ¥åˆ é™¤ä¸äº†ï¼Œå°±éœ€è¦å…ˆç”¨ chattr -R -i /bin/sysdrr å’Œ chattr -R -i /bin/sync ï¼Œåœ¨ç”¨ rm -f åˆ é™¤ï¼</p><p>è¿™æ ·å°±è§£å†³äº†æŒ–çŸ¿ç—…æ¯’çš„é—®é¢˜ã€‚</p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å°±æˆåŠŸå•¦ï¼</p>]]></content>
      
      
      <categories>
          
          <category> æŒ–çŸ¿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¯”ç‰¹å¸ </tag>
            
            <tag> æŒ–çŸ¿ </tag>
            
            <tag> åæŒ–çŸ¿ </tag>
            
            <tag> æŒ–çŸ¿ç—…æ¯’ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EIP-1559åªæ˜¯å¼€å§‹ï¼ˆè½¬ï¼‰</title>
      <link href="/2021/08/10/eip-1559-zhi-shi-kai-shi/"/>
      <url>/2021/08/10/eip-1559-zhi-shi-kai-shi/</url>
      
        <content type="html"><![CDATA[<h2 id="EIP-1559åªæ˜¯å¼€å§‹"><a href="#EIP-1559åªæ˜¯å¼€å§‹" class="headerlink" title="EIP-1559åªæ˜¯å¼€å§‹"></a><strong>EIP-1559åªæ˜¯å¼€å§‹</strong></h2><p>ä»¥å¤ªåŠçš„ä¼¦æ•¦å‡çº§äº8æœˆ4æ—¥å®Œæˆï¼Œå…¶ä¸­åŒ…æ‹¬äº†è‘—åçš„EIP-1559ã€‚åœ¨EIP-1559æ¨å‡ºè‡³ä»Šï¼Œä¸åˆ°4å¤©ï¼Œå·²ç»çƒ§æ¯äº†16,230.38ä¸ªETHï¼ˆæˆªæ­¢åˆ°å†™ç¨¿æ—¶ï¼‰ï¼Œä»·å€¼æ¥è¿‘5,000ä¸‡ç¾å…ƒã€‚å½“çœŸå®çš„ETHè¢«çƒ§æ¯æ—¶ï¼Œäººä»¬ç»ˆäºæ„Ÿå—åˆ°EIP-1559çš„ç‡ƒçƒ§èƒ½é‡ï¼Œçœ‹åˆ°æ¯å¤©éƒ½ä¼šæœ‰å¤§é‡çš„ETHè¢«çƒ§æ‰ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/img_convert/bd0493633e96ae3d431424151d76e4fb.png" alt="oh">)ï¼ˆEIP-1559æ¨å‡ºåçƒ§æ¯çš„ETHæ€»é‡ï¼ŒUltrasound.money)</p><p>å½“ç„¶ï¼Œåªæœ‰EIP-1559æ— æ³•å¯¼è‡´ETHçš„é€šç¼©ã€‚å½“å‰æ¯å¤©ETHçš„æ–°å¢é‡å¤§çº¦ä¸º13,000ä¸ªï¼ŒEIP-1559å¯åŠ¨åç¬¬ä¸€å¤©ä»¥å¤ªåŠçƒ§æ¯çš„ETHé‡ä¸º4791.5ä¸ªã€‚EIP-1559å¤§çº¦ä½¿ETHæ–°å¢ç‡é™ä½30%å·¦å³ï¼ˆå½“ç„¶ETHçš„é”€æ¯é‡ä¹Ÿä¼šæ ¹æ®ç½‘ç»œçš„ä½¿ç”¨æƒ…å†µå‘ç”Ÿå˜åŒ–ï¼Œè¿™é‡Œåªæ˜¯æ ¹æ®å½“å‰æƒ…å†µçš„å¤§æ¦‚é¢„ä¼°ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/img_convert/1ab262af5685209692bdd1606447b82c.png" alt="my">)ï¼ˆEIP-1559æ¨å‡ºä¹‹åç¬¬ä¸€å¤©çƒ§æ¯çš„ETHé‡ï¼Œetherchain.org)</p><p>è“ç‹ç¬”è®°åœ¨ä¹‹å‰çš„æ–‡ç« ã€Š<a href="http://mp.weixin.qq.com/s?__biz=MzAwOTk1NjM0NQ%3D%3D&chksm=9b551eadac2297bbf939efb5ff7d33c98703a8f0ac52f5e715796747f052abb857b8a3f3ddea&idx=1&mid=2247491643&scene=21&sn=1c03eba5cd5a2d1fc9bff0024c2c8270#wechat_redirect" target="_blank" rel="noopener">EIP-1559ä¸ä»¥å¤ªåŠä¹‹è·¯</a>ã€‹ä¸­ä¹Ÿæåˆ°ï¼Œæœªæ¥åŠå¹´å¤šï¼Œä»¥å¤ªåŠæœ‰ä¸‰ä»¶é‡è¦çš„äº‹æƒ…ï¼Œå…¶ä¸­å½±å“æœ€å¤§çš„è¿˜æ˜¯POSçš„èåˆï¼Œå®ƒå¯¹ä»¥å¤ªåŠå’ŒETHçš„å½±å“ä¼šè¿œè¶…EIP-1559ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒEIP-1559åªæ˜¯æ‹‰å¼€å¤§å¹•ï¼Œå¤§æˆè¿˜åœ¨è·¯ä¸Šã€‚PoSçš„èåˆä¼šç›´æ¥æ”¹å˜ETHçš„æ€§è´¨ã€‚</p><h2 id="PoSèåˆæ‰æ˜¯å¤§æˆ"><a href="#PoSèåˆæ‰æ˜¯å¤§æˆ" class="headerlink" title="PoSèåˆæ‰æ˜¯å¤§æˆ"></a><strong>PoSèåˆæ‰æ˜¯å¤§æˆ</strong></h2><p>å‡åŠæ•ˆåº”çš„æ¦‚å¿µæ¥è‡ªäºæ¯”ç‰¹å¸æ¯å››å¹´ä¸€æ¬¡çš„å‡åŠï¼Œæ¯æ¬¡å‡åŠå¯¼è‡´å…¶æ–°å¢å‘è¡Œçš„å¤§å¹…ä¸‹é™ã€‚å½“æ–°å¢é‡ä¸‹é™ï¼Œè€Œéœ€æ±‚é‡ä¿æŒä¸å˜æˆ–è€…ä¸Šå‡æ—¶ï¼Œå°±ä¼šæ¨åŠ¨ä»·æ ¼çš„ä¸Šå‡ã€‚å…³äºBTCçš„å‡åŠï¼Œå¯ä»¥å‚è€ƒè“ç‹ç¬”è®°ä¹‹å‰æ–‡ç« ã€Š<a href="http://mp.weixin.qq.com/s?__biz=MzAwOTk1NjM0NQ%3D%3D&chksm=9b56e2c2ac216bd4a77695b9b7c5b21283976f2e54697d875dbfae1ae195d853d9f510a8a083&idx=1&mid=2247490644&scene=21&sn=b99c5afae4c6741dd1dd39fe80f4128e#wechat_redirect" target="_blank" rel="noopener">æ¯”ç‰¹å¸çš„å‡åŠæ•ˆåº”ä¸ETH2.0çš„è´¨æŠ¼æ•ˆåº”</a>ã€‹ã€ã€Š<a href="http://mp.weixin.qq.com/s?__biz=MzAwOTk1NjM0NQ%3D%3D&chksm=9b56e920ac216036da9f4b0a9b161122da35627bf6a5328be972d28f5725f300f61ea4c4d74a&idx=1&mid=2247489462&scene=21&sn=dba87af98559637ed9e71974e23cbd7a#wechat_redirect" target="_blank" rel="noopener">BTCçš„å‡åŠæ•ˆåº”ï¼šå¦‚ä½•è®¡å…¥ä»·æ ¼ï¼Ÿ</a>ã€‹ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/img_convert/8baf69163fdeaa486a398c22338a8550.png" alt="god">)ï¼ˆå…³äºBTCå‡åŠæ•ˆåº”çš„å½¢è±¡å±•ç¤ºï¼Œæ¥æºäºMoonCapital)</p><p>è¿™åœ¨æ¯”ç‰¹å¸çš„å†å²ä¸Šæ›¾ç»å¤šæ¬¡å¾—åˆ°è¯æ˜ã€‚å¦‚ä»Šï¼Œä»¥å¤ªåŠç¤¾åŒºä¸­çš„ä¸€éƒ¨åˆ†äººä¹Ÿå°†å‡åŠæ•ˆåº”æ¦‚å¿µè¿ç”¨åˆ°ä»¥å¤ªåŠä¸Šï¼Œè€Œä¸”ç›¸å¯¹äºbtcçš„å‡åŠæ¥è¯´ï¼Œæ˜¯ä¸‰å€å‡åŠã€‚é‚£ä¹ˆï¼Œå¦‚ä½•ç†è§£ä»¥å¤ªåŠçš„ä¸‰å€å‡åŠæ¦‚å¿µï¼Ÿ</p><h2 id="ä¸‰å€å‡åŠ"><a href="#ä¸‰å€å‡åŠ" class="headerlink" title="*ä¸‰å€å‡åŠ"></a>*ä¸‰å€å‡åŠ</h2><p>ç›®å‰ETHå¹´å¢å‘ç‡å¤§çº¦ä¸º4%ï¼Œæ¯å¹´æ–°å¢å¤§çº¦460ä¸‡å¤šä¸ªETHï¼Œå¹³å‡æ¯æ—¥æ–°å¢å¤§çº¦13,000ä¸ªå·¦å³ï¼Œå‡è®¾PoSæ–°å¢å‘è¡Œ0.4%ï¼ˆæ ¹æ®è´¨æŠ¼ç‡ä¼šæœ‰å˜åŒ–ï¼‰ï¼Œå¹³å‡æ—¥æ–°å¢å¤§çº¦13,00å¤šä¸ªETHã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒæŒ‰ç…§å½“å‰æ¯æ—¥æ–°å¢ä¸º13,000ä¸ªETHï¼Œå‡åŠä¹‹åä¸º6,500ä¸ªETHï¼Œç¬¬äºŒæ¬¡å‡åŠåˆ™3,250ä¸ªETHï¼Œç¬¬ä¸‰æ¬¡å‡åŠä¸º1,625ä¸ªETHã€‚ä»13,000åˆ°1,625ï¼Œä¸€å…±ç¼©å‡87.5%ï¼Œæ¥è¿‘äº90%çš„ç¼©å‡ï¼Œå¤§çº¦ç›¸å½“äº3å€å‡åŠã€‚ï¼ˆæ³¨ï¼šè¿™é‡Œçš„å…·ä½“æ•°å­—ä¸æ˜¯ç²¾ç¡®æ•°å­—ï¼Œæ ¹æ®å…·ä½“æƒ…å†µï¼Œä¼šæœ‰ä¸€å®šçš„ä¸Šä¸‹æµ®åŠ¨ï¼Œä¸»è¦æ˜¯ä¸ºäº†è¯´æ˜é‡çº§ï¼‰</p><p>å½“æ¯å¤©æ–°å¢ETHä»…ä¸º1,625ä¸ªå·¦å³æ—¶ï¼Œå³ä¾¿æ˜¯å¦‚ä»Šçš„æ—¥çƒ§æ¯é‡ä¹Ÿè¶…è¿‡è¿™ä¸ªæ—¥æ–°å¢é‡ï¼Œè¿™ä¼šå¯¼è‡´ETHè¿›å…¥é€šç¼©çš„çŠ¶æ€ã€‚</p><p>BTCçš„æ€»é‡æ˜¯æ’å®šçš„ï¼Œä¸ä¼šé€šç¼©ã€‚è€ŒETHéšç€PoSçš„åˆ°æ¥ï¼Œæœ‰å¾ˆå¤§æ¦‚ç‡è¿›å…¥é€šç¼©çš„çŠ¶æ€ã€‚è¿™å¯¼è‡´ETHä¼šå˜å¾—è¶Šæ¥è¶Šç¨€ç¼ºã€‚ä»è¿™é‡Œä¹Ÿå¯ä»¥çœ‹å‡ºï¼ŒBTCå’ŒETHç»æµæœºåˆ¶çš„ä¸åŒã€‚</p><p>å½“ç„¶ï¼Œéœ€è¦ç€é‡å¼ºè°ƒçš„æ˜¯ï¼Œè¿™é‡Œæ— æ³•è¯„åˆ¤è°çš„ç»æµæ”¿ç­–æ›´å¥½ã€‚å¦‚æœä»é•¿è¿œç”Ÿæ€å‘å±•çœ‹ï¼Œä¸ä¸€å®šé€šç¼©å°±ä¸€å®šæ˜¯å¥½çš„ï¼Œä¸€ä¸ªè¶Šæ¥è¶Šç¨€ç¼ºçš„ETHæ˜¯å¦æ˜¯å¥½äº‹ï¼Œç›®å‰è¿˜ä¸èƒ½ä¸‹å®šè®ºï¼Œè¿™ä¸ªéœ€è¦è¾©è¯æ¥çœ‹é—®é¢˜ã€‚</p><p>ä¸è¿‡ï¼Œä»…ä»ä¾›éœ€çš„å¸‚åœºè§’åº¦ï¼Œè¿™ä¼šå¯¼è‡´å¯¹ETHçš„éœ€æ±‚ä¸æ–­å¢åŠ ï¼Œä¾›åº”çš„å‡å°‘ä¼šå¸¦æ¥å‹åŠ›ï¼Œä¼šå¯¼è‡´ETHä»·å€¼ä¸Šæ¶¨ã€‚ä¸€ä¸ªé€šç¼©çš„ETHä¼šé¢ä¸´è¶Šæ¥è¶Šå¤§çš„éœ€æ±‚ç«äº‰ã€‚è¿™ä¸ªç«äº‰ä¸ä»…æ¥è‡ªäºDeFiçš„é”å®šï¼Œä¹Ÿæ¥è‡ªäºPoSçš„è´¨æŠ¼éœ€æ±‚ã€‚</p><h2 id="PoSè´¨æŠ¼"><a href="#PoSè´¨æŠ¼" class="headerlink" title="*PoSè´¨æŠ¼"></a>*PoSè´¨æŠ¼</h2><p>æˆªæ­¢åˆ°è“ç‹ç¬”è®°å†™ç¨¿æ—¶ä¸ºæ­¢ï¼Œä»…ä»…æ˜¯8ä¸ªå¤šæœˆçš„æ—¶é—´ï¼ŒETH2.0è´¨æŠ¼åˆçº¦ä¸­å­˜å…¥çš„ETHæ•°é‡é«˜è¾¾6,548,125ä¸ªETHï¼Œå æ®ETHæ€»é‡çš„5.6%å·¦å³ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/img_convert/48074e0aa6ee539d0834ca45a46e6ca3.png" alt="az">)ï¼ˆå­˜å…¥ETH2.0è´¨æŠ¼åˆçº¦çš„ETHé‡å¢é•¿è¶‹åŠ¿ï¼Œbeaconcha.io)</p><p>éšç€åç»­PoSèåˆï¼Œéšç€çŸ¿å·¥çš„è¿ç§»ï¼Œé¢„è®¡è´¨æŠ¼çš„PoSè¿˜ä¼šå¤§å¹…åº¦ä¸Šå‡ã€‚æ ¹æ®è“ç‹ç¬”è®°çš„é¢„ä¼°ï¼Œæœªæ¥å­˜å…¥ETH2.0è´¨æŠ¼åˆçº¦ä¸­çš„ETHæœ‰æœºä¼šè¾¾åˆ°2,000åˆ°3,000ä¸‡ä¸ªä»¥ä¸Šï¼Œç”šè‡³æ›´é«˜ï¼Œå æ®ETHæ€»é‡20%ä»¥ä¸Šã€‚ï¼ˆæ³¨ï¼šè¿™é‡Œåªæ˜¯é¢„ä¼°ï¼Œè¿˜ä¸æ˜¯ç°å®ï¼‰</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»æµé€šå¸‚åœºä¸­ï¼Œä¼šæœ‰å¤§é‡çš„ETHè¢«ç§»èµ°ï¼Œä¸€æ˜¯æ¯å¤©æœ‰çœŸå®çš„ETHè¢«çƒ§æ¯ï¼ŒäºŒæ˜¯æœ‰è¶Šæ¥è¶Šå¤šçš„ETHè¿›å…¥åˆ°ETH2.0çš„è´¨æŠ¼åˆçº¦ï¼Œä»¥èµšå–ETHçš„æ”¶ç›Šã€‚</p><h2 id="DeFiçš„é”å®š"><a href="#DeFiçš„é”å®š" class="headerlink" title="*DeFiçš„é”å®š"></a>*DeFiçš„é”å®š</h2><p>æˆªæ­¢åˆ°è“ç‹ç¬”è®°å†™ç¨¿æ—¶ï¼Œç›®å‰DeFiä¸­é”å®šçš„ETHè¶…è¿‡950ä¸‡ä¸ªï¼Œè¶…è¿‡ETHæµé€šé‡çš„8%ï¼Œé¢„è®¡é”å®šåœ¨DeFiä¸­çš„ETHå¾ˆå¿«ä¼šçªç ´1000ä¸‡ä¸ªã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/img_convert/fb2d2815f4fa8f2cf9e6440d3c03705b.png" alt="%%%">)ï¼ˆETHåœ¨DeFiä¸­çš„é”å®šé‡,DeFiPulse)</p><p>éšç€åç»­DeFiåè®®çš„å‘å±•ï¼Œå°¤å…¶æ˜¯å€Ÿè´·ã€DEXã€è¡ç”Ÿå“ç­‰é¢†åŸŸçš„ç»§ç»­å‘å±•ï¼ŒDeFié¢†åŸŸå¯¹ETHçš„éœ€æ±‚ä¹Ÿæ˜¯é€æ­¥å¢åŠ çš„ã€‚æœªæ¥DeFié¢†åŸŸå¯¹ETHçš„éœ€æ±‚ä¹Ÿæœ‰å¯èƒ½ä¼šçªç ´2000ä¸‡ä¸ªã€‚ï¼ˆæ³¨ï¼šè¿™åªæ˜¯é¢„ä¼°ï¼Œå¹¶éå‘ç”Ÿçš„ç°å®ï¼‰</p><p>é‚£ä¹ˆï¼Œæœªæ¥PoS+DeFiå¤§æ¦‚ä¼šé”å®šå¸‚åœºä¸­æ¥è¿‘40-50%çš„ETHï¼Œç”šè‡³æ›´é«˜çš„æ¯”ä¾‹ï¼Œè€Œæ¯å¤©çš„æ–°å¢å‘è¡Œé‡æœ‰å¯èƒ½å°äºæ¯æ—¥çš„çƒ§æ¯é‡ã€‚å³ä¾¿æ˜¯PoS+DeFiçš„é”å®šé‡ä¸å˜ï¼Œæ•´ä¸ªå¸‚åœºä¸Šæµé€šçš„ETHä¹Ÿä¼šè¶Šæ¥è¶Šå°‘ã€‚</p><h2 id="ETHèµ°å‘é€šç¼©æ˜¯å¤§æ¦‚ç‡äº‹ä»¶"><a href="#ETHèµ°å‘é€šç¼©æ˜¯å¤§æ¦‚ç‡äº‹ä»¶" class="headerlink" title="ETHèµ°å‘é€šç¼©æ˜¯å¤§æ¦‚ç‡äº‹ä»¶"></a><strong>ETHèµ°å‘é€šç¼©æ˜¯å¤§æ¦‚ç‡äº‹ä»¶</strong></h2><p>å¦‚æœä»¥å¤ªåŠPoSèåˆé¡ºåˆ©ï¼Œåœ¨è¿™ä¸ªå‰æä¸‹ï¼Œè€ƒè™‘åˆ°å…¶å¹´æ–°å¢å‘è¡Œç‡çš„ä¸‹é™ä»¥åŠETHçƒ§æ¯é‡çš„æƒ…å†µï¼ŒETHæœ‰å¾ˆå¤§çš„æ¦‚ç‡èµ°å‘é€šç¼©ï¼Œè€Œé€šç¼©çš„ETHä¼šå¯¹å…¶ä¾›æ±‚å…³ç³»äº§ç”Ÿæå…¶é‡è¦çš„å½±å“ã€‚ä¸æ­¤åŒæ—¶ï¼ŒPoSçš„æœºåˆ¶å¯¼è‡´å¯¹ETHçš„è´¨æŠ¼éœ€æ±‚åœ¨å¢åŠ ï¼ŒåŠ ä¸ŠDeFiåè®®å¯¹ETHçš„éœ€æ±‚ä¹Ÿåœ¨å¢é•¿ï¼Œæœªæ¥åŠå¹´ä¹‹åçš„ETHå¯èƒ½æ˜¯å®Œå…¨ä¸åŒçš„ETHã€‚</p><p>å½“ç„¶ï¼Œæœªæ¥æ”¿ç­–å±‚é¢çš„å˜åŒ–ï¼Œæœ‰å¯èƒ½ä¼šå¯¹PoSäº§ç”Ÿä¸€äº›ä¸åˆ©çš„å½±å“ï¼Œä½†é•¿è¿œçœ‹ï¼Œå¦‚æœè¿™ä¸ªå½±å“åªæ˜¯é™ä½å…¶æ”¶ç›Šç‡ï¼Œå¹¶ä¸æ˜¯ä¸è®©å®ƒå­˜åœ¨ï¼Œé‚£ä¹ˆï¼Œä»è¿™ä¸ªè§’åº¦ï¼Œè™½ç„¶ä¼šé¢ä¸´é˜»åŠ›ï¼Œä½†è¶‹åŠ¿è¿˜ä¼šç»§ç»­ã€‚</p><blockquote><p>æœ¬æ–‡è½¬è½½è‡ªï¼š<a href="https://blog.csdn.net/weixin_44383880" target="_blank" rel="noopener">å·´æ¯”ç‰¹èµ„è®¯</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æŒ–çŸ¿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¯”ç‰¹å¸ </tag>
            
            <tag> ä»¥å¤ªåŠ </tag>
            
            <tag> æŒ–çŸ¿ </tag>
            
            <tag> EIP-1559 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»¥å¤ªåŠGASè´¹çˆ†æ£šï¼ŒçŸ¿å·¥ç–¯ç‹‚æ‰«è´§é«˜ç«¯ç¬”è®°æœ¬æŒ–çŸ¿ï¼ˆè½¬ï¼‰</title>
      <link href="/2021/08/10/yi-tai-fang-gas-fei-bao-peng-kuang-gong-feng-kuang-sao-huo-gao-duan-bi-ji-ben-wa-kuang/"/>
      <url>/2021/08/10/yi-tai-fang-gas-fei-bao-peng-kuang-gong-feng-kuang-sao-huo-gao-duan-bi-ji-ben-wa-kuang/</url>
      
        <content type="html"><![CDATA[<p>ä¸€å¥è¯ï¼Œå¸‚åœºä¼¼ä¹å·²ç»åˆ°äº†â€œé—­çœ¼æ¢­å“ˆä¹Ÿè‡´å¯Œâ€çš„é˜¶æ®µã€‚</p><p>å¾ˆå¤šæŒ–çŸ¿æˆ–è€…ä½¿ç”¨Uniswapç­‰éœ€è¦ç”¨åˆ°ä»¥å¤ªåŠé“¾ä¸Šè½¬è´¦çš„æŠ•èµ„äººå‘ç°ï¼Œç°åœ¨GASè´¹å¤ªè´µäº†ï¼Œæœ‰å¤šè´µå‘¢ï¼Ÿä¸€ä¸ªç®€å•çš„äº¤æ˜“å°±éœ€è¦å‡ ç™¾å—ï¼Œå¤æ‚çš„åˆçº¦äº¤äº’ï¼Œæ¯”å¦‚æŒ–ä¸ªçŸ¿ï¼Œæ²¡æœ‰å‡ åƒå—æ˜¯ä¸è¡Œäº†ã€‚DeFiï¼Œæ™®é€šäººå½»åº•ç©ä¸èµ·äº†ã€‚ç¾Šæ¯›ä¹Ÿä¸èˆå¾—è–…äº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy8xVk8yRlNpY1JHVlJOa0NxSld1ZnhyRkl5TFRBdUFpYUJaRlBXREF4clBVSURqeFVLNWQwNUhNSHhHdVVxYk15MXo3U1FXY0JGMXZxbm0wQ3Z3ZFRtQmRnLzY0MA?x-oss-process=image/format,png" alt="â€¦â€¦"></p><p>â–²ä»¥å¤ªåŠç›¸å…³æ•°æ®ï¼ˆ6æ—¥ä¸‹åˆ2ç‚¹ï¼ŒOKlinkï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy8xVk8yRlNpY1JHVlJOa0NxSld1ZnhyRkl5TFRBdUFpYUJaNGR6NGt5ZXVkMjk1dXhUaFZlSWlhQ1VJaGljOGlidlNBUzFTY3JCdVd5RmdpY00zaWFyaWE4cTJPUHlRLzY0MA?x-oss-process=image/format,png" alt="Gwei"></p><p>â–²æŸæŒ–çŸ¿é¡¹ç›®çš„GASè´¹ç”¨ï¼Œ487GASç­‰äºè¿‘åƒå…ƒäººæ°‘å¸</p><p>æ®Tokenviewæ•°æ®æ˜¾ç¤ºï¼Œ2æœˆ5æ—¥ä»¥å¤ªåŠé“¾ä¸Šæ‰‹ç»­è´¹æ€»å’Œè¾¾åˆ°12827.06 ETHï¼ˆçº¦ä¸º3018.9åƒä¸‡ç¾å…ƒï¼‰ï¼Œå•æ—¥GASå‡ä»·ä¸º150 GWeiï¼Œå•ç¬”äº¤æ˜“æ‰‹ç»­è´¹å¹³å‡å€¼ä¸º24.7ç¾å…ƒï¼Œå±äºè¿‘ä¸¤å¹´çš„æœ€é«˜ä½ã€‚</p><p>è¡Œä¸šå¤§Vâ€œæ¯”ç‰¹å¸è¶…çº§å›â€å°±è¯´ï¼šâ€œä»¥å¤ªåŠé«˜æ˜‚çš„æ‰‹ç»­è´¹æ­£åœ¨é©±èµ¶ç»å¤§å¤šæ•°defiçŸ¿å·¥ã€‚â€</p><p>é‚£ä»€ä¹ˆæ—¶å€™GASä¾¿å®œå‘¢ï¼Ÿçœ‹ä¸‹å›¾ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy8xVk8yRlNpY1JHVlJOa0NxSld1ZnhyRkl5TFRBdUFpYUJaS25aVFpXN2phWnl0SFozV2ljV1ZBMGNhbWhOS2lhdlJ2ZEI5clRJejVzTzFZV1ZNSVhxaWNuS21RLzY0MA?x-oss-process=image/format,png" alt="img"></p><p>é€šè¿‡æ•°æ®å¯ä»¥å‘ç°ï¼Œæ•´ä½“è€Œè¨€ï¼Œ<strong>ä¸€å‘¨çš„ä¸‹åˆ1ç‚¹åˆ°3ç‚¹è¿™ä¸ªæ—¶é—´æ®µçš„GASè´¹ç”¨æœ€ä¾¿å®œ</strong>ï¼Œåªæœ‰80Gweiã€‚å‡Œæ™¨ã€åˆå¤œçš„è´¹ç”¨ç›¸å¯¹æœ€è´µï¼Œå¯ä»¥è½»æ¾ç¿»è¶Š400Gweiã€‚</p><p>æ‰€ä»¥ï¼Œå¦‚æœä½ è¦é€šè¿‡DeFiåº”ç”¨äº¤æ˜“ï¼Œæˆ–æ˜¯è¦å»æŸä¸ªæœªå‘å¸çš„åº”ç”¨é‡Œè–…ç¾Šæ¯›ï¼Œè¿™ä¸ªå›¾å¯ä»¥è®©ä½ ä¸€çœ¼çœ‹GASè´¹ç”¨æœ€â€œåˆ’ç®—â€çš„æ—¶é—´ç‚¹ã€‚</p><p>å½“ç„¶ï¼Œè¿™ä¸ªæ•°æ®æ˜¯åŠ¨æ€çš„ï¼Œå˜åŒ–éå¸¸å¿«ï¼Œæ›´å¤šå®æ—¶æ•°æ®å¯ä»¥é€šè¿‡ä¸€ä¸ªå«åšgasnowçš„ç½‘ç«™æŸ¥çœ‹ï¼Œè¿™æ˜¯ä»¥å¤ªåŠæœ€å¤§çš„çŸ¿æ± æ˜Ÿç«çŸ¿æ± åšçš„å°ç½‘ç«™ï¼Œå®ƒåˆ†æå¤„ç†äº†ä»¥å¤ªåŠçš„é“¾ä¸Šæ•°æ®åç»™å‡ºäº†é’ˆå¯¹GASè´¹ç”¨çš„é¢„æµ‹ã€‚ç½‘ç«™å¦‚ä¸‹ï¼Œå¯ç‚¹å‡»æ”¶è—ï¼š<a href="https://gasnow.sparkpool.com/" target="_blank" rel="noopener">https://gasnow.sparkpool.com/</a></p><h2 id="1"><a href="#1" class="headerlink" title="1"></a><strong><em>1</em></strong></h2><h2 id="DeFiç–¯ç‹‚ï¼Œä»¥å¤ªåŠçŸ¿å·¥æ‰«è´§ç¬”è®°æœ¬æŒ–çŸ¿"><a href="#DeFiç–¯ç‹‚ï¼Œä»¥å¤ªåŠçŸ¿å·¥æ‰«è´§ç¬”è®°æœ¬æŒ–çŸ¿" class="headerlink" title="DeFiç–¯ç‹‚ï¼Œä»¥å¤ªåŠçŸ¿å·¥æ‰«è´§ç¬”è®°æœ¬æŒ–çŸ¿"></a>DeFiç–¯ç‹‚ï¼Œä»¥å¤ªåŠçŸ¿å·¥æ‰«è´§ç¬”è®°æœ¬æŒ–çŸ¿</h2><p>æ•°æ®æ˜¾ç¤ºï¼Œä»¥å¤ªåŠçŸ¿å·¥åœ¨ä¸€å°æ—¶å†…èµšäº†350ä¸‡ç¾å…ƒï¼Œè¿™æ˜¯è¿„ä»Šä¸ºæ­¢æœ€é«˜çš„æ¯å°æ—¶é‡‡çŸ¿æ”¶å…¥ã€‚</p><p>ä½†æ˜¯ï¼Œä¼—æ‰€å‘¨çŸ¥ï¼Œå› ä¸ºç–«æƒ…ç­‰åŸå› ï¼Œ2020å¹´ä»¥æ¥é«˜ç«¯æ˜¾å¡çš„ä¾›è´§ä¸è¶³ï¼Œæœ‰é’±ä¹Ÿä¹°ä¸åˆ°ã€‚éšç€ETHä»·æ ¼çªç ´å‰é«˜ï¼ŒçŸ¿å·¥ä»¬å·²ç»æŠŠæ³¨æ„åŠ›æŠ•é™å‘äº†æ¸¸æˆæœ¬ï¼Œå°¤å…¶æ˜¯æ­è½½äº†æœ€æ–°æœ€å¼ºæ˜¾å¡çš„é«˜ç«¯æœºå‹ã€‚</p><p>æœ€è¿‘ï¼Œé±¼æ± å°±åšäº†ä¸€ä¸ªçƒ­é—¨å°è§†é¢‘ï¼Œä¸»æŒäººæ‹¿ç€ä¸€å°æ­è½½äº†NVIDIA3060æ˜¾å¡çš„åç¡•ç¬”è®°æœ¬å»æ˜Ÿå·´å…‹è–…ç¾Šæ¯›ã€‚æ•°æ®æ˜¾ç¤ºï¼Œè¯¥æ¸¸æˆæœ¬å¯æä¾›40MH/Sçš„ç®—åŠ›ï¼Œç»“åˆéš¾åº¦å’Œå¸ä»·ï¼Œæ—¥æ”¶ç›Šçº¦23å…ƒï¼Œ260å¤©å›æœ¬ï¼Œå¹´åŒ–140%çš„å›æŠ¥ç‡ã€‚ç”µè´¹ç™½å«–ã€‚</p><p>è¿™ä¸æ˜¯æ®µå­ã€‚ç›®å‰ï¼Œç¡®å®æœ‰ä¸€éƒ¨åˆ†çŸ¿å·¥åœ¨æ‰«è´§ç¬”è®°æœ¬ï¼Œä»–ä»¬è¦ä¹ˆæŠŠç¬”è®°æœ¬è‚¢è§£ï¼Œå–å‡ºæ˜¾å¡é‡æ–°ç»„è£…ä¸ºçŸ¿æœºï¼Œè¦ä¹ˆç›´æ¥å®‰ä¸Šè½¯ä»¶æŒ–çŸ¿ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy8xVk8yRlNpY1JHVlJOa0NxSld1ZnhyRkl5TFRBdUFpYUJaWjVGUEoxSFpYd25QMUN4VFMzc210NktueFdDeE1MTko1aE5yVWt5UWljbHRjYmprYlpQVE1pYWcvNjQw?x-oss-process=image/format,png" alt="èµ°èµ·ï¼ï¼"></p><h2 id="2"><a href="#2" class="headerlink" title="2"></a><strong><em>2</em></strong></h2><h2 id="ä»¥å¤ªåŠæ‹¥å µï¼Œäº¤æ˜“æ‰€å…¬é“¾å’ŒäºŒå±‚ç½‘ç»œçš„æœºä¼šæ¥äº†ï¼Ÿ"><a href="#ä»¥å¤ªåŠæ‹¥å µï¼Œäº¤æ˜“æ‰€å…¬é“¾å’ŒäºŒå±‚ç½‘ç»œçš„æœºä¼šæ¥äº†ï¼Ÿ" class="headerlink" title="ä»¥å¤ªåŠæ‹¥å µï¼Œäº¤æ˜“æ‰€å…¬é“¾å’ŒäºŒå±‚ç½‘ç»œçš„æœºä¼šæ¥äº†ï¼Ÿ"></a>ä»¥å¤ªåŠæ‹¥å µï¼Œäº¤æ˜“æ‰€å…¬é“¾å’ŒäºŒå±‚ç½‘ç»œçš„æœºä¼šæ¥äº†ï¼Ÿ</h2><p>ä»¥å¤ªåŠå µäº†ï¼ŒGASè´¹è´µäº†ï¼Œå¯¹è°æœ€æœ‰åˆ©ï¼Ÿæ— ç–‘æ˜¯ä»¥â€œå¤ªåŠæ€æ‰‹â€ï¼Œæ¯”å¦‚Cardanoã€Polkadotã€Cosmosç­‰ã€‚</p><p>ç»“åˆä»Šå¤©çš„å¸‚åœºçƒ­ç‚¹ï¼Œå¸å®‰çš„bscï¼Œç«å¸çš„hecoï¼Œokäº¤æ˜“æ‰€çš„okchainï¼Œè¿™äº›äº¤æ˜“æ‰€å…¬é“¾å¯èƒ½ä¹Ÿå°†è·å¾—å¸‚åœºé’çã€‚</p><p>å¦å¤–ï¼Œå€¼å¾—æœŸå¾…çš„å°±æ˜¯Layer2ï¼ˆäºŒå±‚ç½‘ç»œï¼‰ç±»é¡¹ç›®ã€‚ä½†ä¸å¾—ä¸è¯´ï¼ŒLayer2çš„ç›®å‰è¿˜éš¾å½“å¤§ä»»ï¼Œç‚’ä½œå™±å¤´è¶…è¿‡äº†å®é™…çš„ä»·å€¼ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL3N6X21tYml6X2dpZi9RamNKakQ1VVJWa1Vhb0Q2TXdpY2pOSlMxbWlhaWJYaWI3eDRyQWh4Wm5KRWNaRXNxdWxNTjJsS0xjQ3hOR1N0UWFNQ2tGR3JReUZUVFJpYmtCb2FEWXJoYzJBLzY0MA?x-oss-process=image/format,png" alt="èµ°å¥½ï¼"></p><blockquote><p>æœ¬æ–‡è½¬è½½è‡ªï¼š<a href="https://blog.csdn.net/weixin_44383880" target="_blank" rel="noopener">å·´æ¯”ç‰¹èµ„è®¯</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æŒ–çŸ¿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¯”ç‰¹å¸ </tag>
            
            <tag> ä»¥å¤ªåŠ </tag>
            
            <tag> æŒ–çŸ¿ </tag>
            
            <tag> åŒºå—é“¾ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¢…è¥¿ï¼Œè¯ºåæ™®æ°¸è¿œæ˜¯ä½ çš„å®¶</title>
      <link href="/2021/08/09/mei-xi-nuo-kan-pu-yong-yuan-shi-ni-de-jia/"/>
      <url>/2021/08/09/mei-xi-nuo-kan-pu-yong-yuan-shi-ni-de-jia/</url>
      
        <content type="html"><![CDATA[<h5 id="äº‹å…ˆå£°æ˜"><a href="#äº‹å…ˆå£°æ˜" class="headerlink" title="äº‹å…ˆå£°æ˜"></a>äº‹å…ˆå£°æ˜</h5><p><em>è¿™æ˜¯æœ¬äººçš„åšå®¢ï¼Œæœ¬äººä¸ºè‡ªå·±ç•™ä¸‹çš„äº’è”ç½‘è‡ªç•™åœ°ï¼Œæˆ‘æƒ³å†™ä»€ä¹ˆå°±å†™ä»€ä¹ˆï¼Œè¿™é‡Œé¢å¯èƒ½æœ‰å¾ˆå¤šå¾ˆæ°”æ„¤ï¼Œå‘æ³„çš„è¯ï¼Œä½†æ˜¯è½®ä¸åˆ°åˆ«äººæŒ‡è´£ã€‚ä»¥ä¸‹æ–‡ç« å¸ƒå±€å¾ˆä¹±ï¼Œæœ¬äººæƒ³åˆ°ä»€ä¹ˆå†™ä»€ä¹ˆ</em></p><h2 id="åŸæœ¬è¿™æ˜¯ä¸€ä¸ªå¾ˆç¾å¥½çš„å¤å¤©"><a href="#åŸæœ¬è¿™æ˜¯ä¸€ä¸ªå¾ˆç¾å¥½çš„å¤å¤©" class="headerlink" title="åŸæœ¬è¿™æ˜¯ä¸€ä¸ªå¾ˆç¾å¥½çš„å¤å¤©"></a>åŸæœ¬è¿™æ˜¯ä¸€ä¸ªå¾ˆç¾å¥½çš„å¤å¤©</h2><p>åŸæœ¬è¿™æ˜¯ä¸€ä¸ªå¾ˆè®©äººå¼€å¿ƒçš„å¤å¤©ï¼Œå¤šå¹´å›½å®¶é˜Ÿæ— å† ä¹‹åï¼Œè€æ¿ä»¥ç»å¯¹æ ¸å¿ƒã€å„é¡¹MVPçš„èº«ä»½æ§å¾—äº†ç¾æ´²æ¯ã€‚æœ‰åŠ›å‡»ç¢äº†æ‰€è°“â€œä½“ç³»çƒå‘˜â€ã€â€œå›½å®¶é˜ŸçŸ­æ¿â€çš„ç§°å·ã€‚ä»Šå¹´ä¹Ÿè¢«ç§°ä¸ºç½—ç²‰â€œå…¨å®Œè›‹äº†â€çš„ä¸€å¹´ï¼Œè€æ¿ä»Šå¹´ç«äº‰å¯¹æ‰‹å…¨éƒ¨æ‹‰è·¨ï¼Œè‡ªèº«åˆæœ‰ç»å¯¹äº®çœ¼çš„è¡¨ç°ï¼Œé©¬ä¸Šå°±7åº§é‡‘çƒå¥–åŠ èº«ã€‚æ‰€è°“çš„æŠŠé‡‘çƒæ•°å°åœ¨æŸäººçƒè¡£åé¢ğŸ¤£ã€‚ä¸€èº«è½»æ¾ã€åº¦å‡å½’æ¥çš„è€æ¿æœ¬æ¥æ‰“ç®—é™è–ª50%ï¼ŒåŒæ„ä¸å·´å¡ç½—é‚£ä¿±ä¹éƒ¨ç­¾è®¢ç»­çº¦ï¼Œå¯è°æ›¾æƒ³ï¼Œå·´è¨æœ€åå…³å¤´å±…ç„¶çªç„¶å˜å¦ï¼Œå› ä¸ºCVCè€Œæ— æ³•å®Œæˆä¸æ¢…è¥¿çš„ç»­çº¦ã€‚è¿™æ˜¾ç„¶æ˜¯å®Œå…¨æ— æ³•è®©çƒè¿·ã€è®©æ¢…è¥¿æ¥å—çš„ä¸€ä»¶äº‹æƒ…ã€‚</p><h2 id="é˜Ÿå²æœ€ä½³ï¼Ÿå·´è¨ä»¥å‰æ€ä¹ˆå¯¹å°ç½—ã€å…‹åœ£ï¼Œå¦‚ä»Šæ€ä¹ˆå¯¹æ¢…è¥¿"><a href="#é˜Ÿå²æœ€ä½³ï¼Ÿå·´è¨ä»¥å‰æ€ä¹ˆå¯¹å°ç½—ã€å…‹åœ£ï¼Œå¦‚ä»Šæ€ä¹ˆå¯¹æ¢…è¥¿" class="headerlink" title="é˜Ÿå²æœ€ä½³ï¼Ÿå·´è¨ä»¥å‰æ€ä¹ˆå¯¹å°ç½—ã€å…‹åœ£ï¼Œå¦‚ä»Šæ€ä¹ˆå¯¹æ¢…è¥¿"></a>é˜Ÿå²æœ€ä½³ï¼Ÿå·´è¨ä»¥å‰æ€ä¹ˆå¯¹å°ç½—ã€å…‹åœ£ï¼Œå¦‚ä»Šæ€ä¹ˆå¯¹æ¢…è¥¿</h2><hr><p><strong><em>â€œå—ä»»äºè´¥å†›ä¹‹é™…ï¼Œå¥‰å‘½äºå±éš¾ä¹‹é—´ï¼Œå°”æ¥äºŒåæœ‰ä¸€å¹´çŸ£â€</em></strong></p><p>ä¸ºä¿±ä¹éƒ¨å¥‹æ–—21å¹´çš„é˜Ÿé•¿ï¼Œ30å¤šåº§å† å†›ï¼Œè‡ªå®¶é’è®­å‡ºæ¥çš„å†å²æœ€ä½³ï¼Œæ¢¦ä¸‰ç‹æœçš„ç»å¯¹åŠŸè‡£ï¼Œå¤§å¦å°†å€¾ä¹‹åŠ›æŒ½ç‹‚æ¾œã€‚å³ä½¿å¦‚æ­¤ï¼Œä»ç„¶è™šæ€€è‹¥è°·ï¼Œå¾…äººæ¥ç‰©è°¦è™šäº²å’Œï¼Œç”šè‡³é…ä¸ä¸Šä¸€ä¸ªä½“é¢çš„é€åˆ«â€¦â€¦æˆ‘ä¸çŸ¥é“è¿™æ˜¯ä¸€å®¶æ€æ ·çš„ä¿±ä¹éƒ¨ï¼Œé‚£äº›å¹´çš„å››äº¿å¦„ä¸ºã€ç®¡ç†å±‚çš„æ˜åº¸ã€é«˜è–ªèµ„ï¼ˆå³ä½¿å·²ç»ç­”åº”äº†é™è–ª50%ï¼‰ã€æ›´æ–°æ¢ä»£éƒ½å¯ä»¥ä½œä¸ºå€Ÿå£ï¼Œä½†æˆ‘æ— æ³•å¿å—è¿™ä¹ˆä¸€ç§é€åˆ«ã€‚ä»…ä»…ä¸€ä¸ªäººçš„å‘å¸ƒä¼šï¼Œåç€è‡ªå·±çš„å‡ åé˜Ÿå‹ã€å‡ å®¶åª’ä½“ã€‚ç”±æ¢…è¥¿è‡ªå·±åœ¨é‚£é‡ŒæŠ½æ³£ç€è®²äº†ä¸€ä¸ªå¤šå°æ—¶ã€‚</p><p><strong>ä¸€ä¸ªéå¸¸ç®€å•çš„å£°æ˜ï¼Œå°±è¿™ä¹ˆè®©ç”Ÿæ´»21å¹´çš„é˜Ÿå²æœ€ä½³ç¦»å¼€ï¼Œè¿˜æ˜¯è¢«è’™éª—çš„ç¦»å¼€ï¼Œè¢«å½“ä½œåšå¼ˆçš„æ£‹å­ï¼Œç›´åˆ°æœ€åå½»åº•ç”¨å®Œå‰©ä½™ä»·å€¼æ‰è¢«æ‰”æ‰</strong></p><p>ä»¥ä¸‹ä¸¤æ®µæ¥è‡ªçŸ¥ä¹ï¼š</p><blockquote><p>æ¢…è¥¿æ˜¯ä¸€ä¸ªå–„è‰¯ã€çœŸå®çš„äººï¼Œä»–æ²¡æœ‰éšè—è‡ªå·±çš„ä»»ä½•æ„Ÿæƒ…ï¼Œä»–åˆ°æœ€åä¹Ÿæ·±çˆ±ç€ä¿±ä¹éƒ¨ï¼Œä¸ºäº†ä¿±ä¹éƒ¨çš„è„¸é¢ï¼Œä»–ç»™æ‹‰ç‹—ç•™è¶³äº†ä½™åœ°ï¼Œå®é™…ä¸Šæ¢…è¥¿å·²ç»è¡¨è¾¾äº†è¢«æ¬ºéª—è¢«æ‹–å»¶çš„äº‹å®ï¼Œä½†å´ç”¨äº†æœ€æ¸©æŸ”çš„æ–¹å¼ã€‚æ¢…è¥¿ç”šè‡³è¡¨è¾¾äº†ä»–åŒæ„ä¸€åŠé™è–ªåå¯ä»¥ç»§ç»­è®©æ­¥çš„å†³å¿ƒï¼Œåªæ˜¯æ‹‰ç‹—æ²¡æœ‰å†æè¿›ä¸€æ­¥çš„è¦æ±‚ã€‚</p><p>å› ä¸ºè¿™ä¸ªé ç€æ¢…è¥¿ä¸Šä½çš„æ¼”æŠ€æ´¾ä¸»å¸­ï¼Œä»–ä½ä¼°äº†æ¢…è¥¿å¯¹ä¿±ä¹éƒ¨çš„çˆ±ï¼Œä»–æ•´ä¸ªå‰§æœ¬ä¸­å”¯ä¸€æ²¡æœ‰æ–™åˆ°çš„å°±æ˜¯æ¢…è¥¿ä¼šç«‹å³åŒæ„é™è–ªä¸€åŠï¼Œç”šè‡³è¡¨è¾¾å‡ºåªè¦èƒ½ç•™ä¸‹å¯ä»¥ç»§ç»­èˆå¼ƒçš„å†³å¿ƒï¼</p></blockquote><blockquote><p>æ¢…è¥¿ï¼šä¹‹å‰ä»–ä»¬è¦æ±‚è®©æˆ‘é™è–ª50%ï¼Œæˆ‘åŒæ„äº†ï¼Œä»–ä»¬å†æ²¡åˆ«çš„è¦æ±‚ã€‚ä½†æœ€ç»ˆæ²¡æ³•ç»­çº¦ã€‚</p><p>æ‹‰æ³¢å°”å¡”ï¼šå˜¿å˜¿ï¼Œé™è–ª50%åªæ˜¯æƒ³é€¼èµ°ä½ çš„å™±å¤´ï¼Œæ²¡æƒ³åˆ°è¿™å‚»å°å­çœŸåŒæ„â€¦.</p></blockquote><h2 id="ä»–ä»¬åªæ˜¯ä¸è¦æˆ‘äº†"><a href="#ä»–ä»¬åªæ˜¯ä¸è¦æˆ‘äº†" class="headerlink" title="ä»–ä»¬åªæ˜¯ä¸è¦æˆ‘äº†"></a>ä»–ä»¬åªæ˜¯ä¸è¦æˆ‘äº†</h2><hr><p>æ›¾ç»æ¢…è¥¿æ›¾æ¥å—é‡‡è®¿è¯´ï¼š</p><p><a href="https://imgtu.com/i/fGSCT0" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/09/fGSCT0.jpg" alt></a><br><a href="https://imgtu.com/i/fGS9wq" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/09/fGS9wq.jpg" alt></a></p><p>å¦‚ä»Šä»–ä»¬çœŸçš„ä¸è¦è€æ¿äº†</p><p>](<a href="https://imgtu.com/i/fGw6FH" target="_blank" rel="noopener">https://imgtu.com/i/fGw6FH</a>)</p><p><a href="https://imgtu.com/i/fGSR7q" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/09/fGSR7q.jpg" alt></a></p><p>ä»–ä»¬è®©è€æ¿ç‹¬è‡ªä¸€äººå®Œæˆäº†å‘å¸ƒä¼šï¼ˆæ‹‰æ³¢å°”å¡”æƒ³è¦å’Œè€æ¿ä¸€èµ·å¼€ï¼Œæˆ‘åªæƒ³è¯´è¿™ä¸ªäººçœŸæ˜¯<del>åšé¢œæ— è€»</del>ï¼‰ï¼Œä¼šä¸Šä»–æ²¡æœ‰è¯´ä»»ä½•äººçš„ä¸æ˜¯ï¼Œåªæ˜¯è¡¨è¾¾äº†å¯¹è¿™å®¶ä¿±ä¹éƒ¨çš„æ„Ÿæ¿€ï¼Œè¡¨è¾¾äº†è‡ªå·±çš„ä¸èˆï¼Œä»¥åŠè¡¨è¾¾äº†è‡ªå·±çš„çœ¼æ³ªï¼š</p><p>[<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/10/fGw6FH.jpg" alt></p><h2 id="æˆ‘ä¸æ‹…å¿ƒä»–ä¸ä¼šåˆ›é€ å¥‡è¿¹ï¼Œä½†çœŸå¸Œæœ›é‚£æŠ¹é¢œè‰²æ˜¯çº¢è“ï¼Œæˆ–æ˜¯è“ç™½"><a href="#æˆ‘ä¸æ‹…å¿ƒä»–ä¸ä¼šåˆ›é€ å¥‡è¿¹ï¼Œä½†çœŸå¸Œæœ›é‚£æŠ¹é¢œè‰²æ˜¯çº¢è“ï¼Œæˆ–æ˜¯è“ç™½" class="headerlink" title="æˆ‘ä¸æ‹…å¿ƒä»–ä¸ä¼šåˆ›é€ å¥‡è¿¹ï¼Œä½†çœŸå¸Œæœ›é‚£æŠ¹é¢œè‰²æ˜¯çº¢è“ï¼Œæˆ–æ˜¯è“ç™½"></a>æˆ‘ä¸æ‹…å¿ƒä»–ä¸ä¼šåˆ›é€ å¥‡è¿¹ï¼Œä½†çœŸå¸Œæœ›é‚£æŠ¹é¢œè‰²æ˜¯çº¢è“ï¼Œæˆ–æ˜¯è“ç™½</h2><hr><blockquote><p>04/05èµ›å­£ï¼Œé‚£ä¸ªåœ¨å°ç½—èƒŒä¸Šæ¬¢å¿«åº†ç¥è¿›çƒçš„å°‘å¹´ï¼Œ</p><p>05/06èµ›å­£ï¼Œå¯¹é“è¡€è“å†›é©¬è¸è¿è¥ï¼ŒåŠ©çƒé˜Ÿå†å¤ºæ¬§å† ï¼Œ </p><p>06/07èµ›å­£ï¼Œå›½å®¶å¾·æ¯”å¸½å­æˆæ³•éœ‡æƒŠä¸–ç•Œï¼Œ</p><p>ä»æ­¤ä¹‹åï¼Œå—ä»»äºè´¥å†›ä¹‹é™…ï¼Œå¥‰å‘½äºå±éš¾ä¹‹é—´ï¼Œç–¾é£çŸ¥ åŠ²è‰ï¼Œé€†å¢ƒè§è‹±é›„ï¼ 08/09èµ›å­£ï¼Œå†³æˆ˜ç½—é©¬ï¼Œç»ˆäºç™»é¡¶æ¬§é™†ä¹‹å·…ã€‚ </p><p>å¤§é¹ä¸€æ—¥å› é£èµ·ï¼ŒæŠŸæ‘‡ç›´ä¸Šä¹ä¸‡é‡Œï¼Œ å…­å† ç‹ï¼Œâ€œæ¢¦ä¸‰é˜Ÿä¹‹å‰‘â€ï¼Œ</p><p>å¹´åº¦91è¿›çƒï¼Œçªç ´äººç±»å†å²æé™ï¼Œ </p><p>é‡‘çƒå¥–å››è¿å† ï¼Œ </p><p>MSNç»„åˆï¼Œä¸‰å‰‘å®¢å¤§æ€å››æ–¹ï¼Œç¬¬äº”åº§é‡‘çƒå¥–ï¼Œ </p><p>æŒ½ç‹‚æ¾œäºå³å€’ï¼Œæ‰¶å¤§å¦ä¹‹å°†å€¾ï¼Œç¬¬å…­åº§é‡‘çƒå¥–ï¼Œè¶³å›é¦–æ¬¡åŠ³ä¼¦æ–¯å¤§å¥–â€¦â€¦</p><p>å‡ºåœº778æ¬¡ï¼Œæ‰“è¿›672çƒï¼Œè´¡çŒ®305æ¬¡åŠ©æ”»ã€‚ 4å±Šæ¬§å† å† å†›ï¼Œ10æ¬¡è¥¿ç”²å† å†›ï¼Œ7æ¬¡å›½ç‹æ¯ï¼Œ8æ¬¡è¥¿ç­ç‰™è¶…çº§æ¯ï¼Œ3æ¬¡å›½é™…è¶³è”ä¿±ä¹éƒ¨ä¸–ç•Œæ¯ã€‚ 6åº§é‡‘çƒå¥–ï¼Œ6æ¬¡ä¸–ç•Œè¶³çƒå…ˆç”Ÿï¼Œ6æ¬¡æ¬§å† é‡‘é´ï¼Œ6æ¬¡æ¬§æ´²é‡‘é´ï¼Œ8æ¬¡è¥¿ç”²é‡‘é´ï¼Œ3å±Šæ¬§è¶³è”æœ€ä½³çƒå‘˜â€¦â€¦ </p><p>åä½™å¹´å…‰é˜´å¦‚ç™½é©¹è¿‡éš™è½¬ç¬å³é€ï¼Œä»å®¹é¢œé’æ¶©çš„å°‘å¹´ï¼Œå¦‚ä»Šå† ç›–æ»¡äº¬åï¼Œæ—©å·²ä¸€èº«è£å†•ï¼Œ æ— æ•°æ¬¡è¢«å›½é™…è¶³å›æ— æ•°æƒå¨äººå£«è®¤å¯ã€å¤šå®¶æƒå¨åª’ä½“è®ºè¯ï¼Œèµèª‰ä¸ºGOATï¼ˆå†å²æœ€ä½³ï¼‰çƒå‘˜ï¼Œè¶…è¶Š æ— æ•°æ®¿å ‚çº§å‰è¾ˆä¼ å¥‡å·¨æ˜Ÿï¼Œè¿›å…¥å’Œè´åˆ©ã€é©¬æ‹‰å¤šçº³å¹¶è‚©çš„è¶³å›æœ€ä¼Ÿå¤§å·¨æ˜Ÿä¹‹åˆ—ã€‚ ä¸æ­¢æ˜¯ç‹¬æ­¥å¤©ä¸‹çš„çƒæŠ€ï¼Œä¸€ç›´è°¦é€Šä½è°ƒï¼Œè™šæ€€è‹¥è°·ï¼Œå¿ å®å®¶åº­ï¼Œå…³çˆ±é˜Ÿå‹ï¼Œçƒ­çˆ±å›½å®¶ï¼Œä»æœªä¸ªäººå“ è¡Œæ–¹é¢çš„ä¸ç«¯è¡Œä¸ºï¼Œè™½ç„¶è®ºå¹´æ”¶å…¥ï¼Œæ—©å·²ç»é“¸å°±äº†ä¸€ä¸ªè¶³å›ç¬¬ä¸€ä½“å›å‰ä¸‰çš„å•†ä¸šå¸å›½ï¼Œä¸€å®¶äº”å£è¿‡ çš„å´æ˜¯æœ€å¯»å¸¸æ™®é€šä¸è¿‡çš„ä¸­äº§ç”Ÿæ´»ã€‚ å› æ­¤ï¼Œä»æ¥ä¸æ­¢æ˜¯å·´è¨çƒè¿·ï¼Œä¸æ­¢æ˜¯é˜¿æ ¹å»·çƒè¿·ï¼Œè€Œæ˜¯åœ¨ä¸–ç•Œå„å›½å„åœ°ï¼Œéƒ½æœ‰æ— æ•°æ‹¥è¶¸ã€‚ä¸çŸ¥å¤šå°‘ äººä»æ¥å¹¶ä¸å–œæ¬¢å·´è¨ï¼Œä¹Ÿå¯¹é˜¿æ ¹å»·å›½å®¶é˜Ÿå®Œå…¨æ— æ„Ÿï¼Œä»–ä»¬ä»…ä»…æ˜¯æ¢…è¥¿çš„å–œçˆ±è€…ã€‚</p></blockquote><p>ä»Šå¹´å¤å¤©ï¼Œå¹´è½»åŒ–çš„é˜¿æ ¹å»·å›½å®¶é˜Ÿç”¨ç¾æ´²æ¯å† å†›è¯æ˜ï¼Œå¦‚ä»Š34å²çš„æ¢…è¥¿ï¼Œè™½ç„¶æ—©å·²ä¸å†æ˜¯09~16å¹´ æç››æ—¶æœŸï¼Œè¶³çƒå²ä¸ŠGOATçº§åˆ«çš„ä¸ªäººæŠ€è‰ºï¼Œä½†åªè¦é˜µå®¹æ­é…å¾—å½“ï¼Œä¼—å¿—æˆåŸã€ä¸‰å†›ç”¨å‘½ï¼Œåªä¸ºå…¨ åŠ›äº‰å–å† å†›ï¼Œæ¢…è¥¿ä¾ç„¶èƒ½å‘ˆç°å‡ºå½“ä¸–ç¬¬ä¸€çš„æŠ€æˆ˜æœ¯æ°´å‡†ã€‚è€Œè¿™ï¼Œæ°æ°æ˜¯ä»Šå¤©çš„å·´è¨é˜Ÿï¼Œæ— è®ºå¦‚ä½•ä¹Ÿéš¾ä»¥åŒ¹é…çš„ã€‚ ä¸€å¦‚18/19èµ›å­£ï¼Œå½“å·´è¨é˜Ÿé•¿æ¢…è¥¿å¯¹ç€è¯ºåæ™®å‡ ä¸‡çƒè¿·å®£èª“ï¼Œè¦ç‡é˜Ÿé‡å›æ¬§å† ä¹‹å·…ï¼Œé‚£äº›â€œå…­å† ç‹â€æ—¶ä»£çš„è€é˜Ÿå‹ä»¬ï¼Œç”šè‡³å®Œå…¨ä¸å½“å›äº‹ï¼šå¯¹ä»–ä»¬æ¥è¯´ï¼Œå† å†›æ—©æ‹¿å¾—è¶³å¤Ÿå¤šäº†ï¼Œä½•å¿…å†æ‹¼ï¼Ÿæ‰“å¡ä¸‹ç­ç­‰é€€å½¹å½“åå®¿å°±å®Œäº‹äº†ã€‚â€”â€”å¦‚æ­¤æ–—å¿—æ¶£æ•£ï¼Œå…¨æŒ‡æœ›ç€æ¢…è¥¿ä¸€äººå‘æŒ¥ç¥å¨çš„çƒé˜Ÿï¼Œå½“ç„¶å¿…ç„¶ä¼šæœ‰ å®‰è²å°”å¾·çš„æƒ¨è´¥ã€‚</p><h2 id="å®‰è²å°”å¾·ï¼æˆ‘ä¸æƒ³äº†è§£"><a href="#å®‰è²å°”å¾·ï¼æˆ‘ä¸æƒ³äº†è§£" class="headerlink" title="å®‰è²å°”å¾·ï¼æˆ‘ä¸æƒ³äº†è§£"></a>å®‰è²å°”å¾·ï¼æˆ‘ä¸æƒ³äº†è§£</h2><p>å®‰è²å°”å¾·â€¦â€¦æˆ‘ä¸æƒ³å¤šè¯´è¿™ä¸€ä»¶äº‹ï¼ŒğŸ˜­ğŸ˜­ğŸ˜­ï¼Œè¿™åº”è¯¥æ˜¯ä¸ºæ•°ä¸å¤šæ¢…è¥¿å‘ä¸–äººï¼Œå‘çƒè¿·å‘è¡¨è®²è¯è¡¨ç¤ºè¦æ‹¿å† å†›çš„åœºé¢äº†ã€‚</p><p>æˆ‘ä¹Ÿå¤šä¹ˆå¸Œæœ›æ¢…è¥¿å¯ä»¥è·å¾—é‚£ä¸€å¹´çš„ä¸‰å† ç‹å•Šï¼Œé‚£æ˜¯æ¢…è¥¿ä¸ªäººèƒ½åŠ›æœ€é€†å¤©çš„ä¸€å¹´ï¼Œä¹Ÿæ˜¯å·´è¨æ°”è¿æœ€èƒ½é€†è½¬çš„ä¸€å¹´äº†ã€‚å”‰ï¼Œè¿™æ˜¯æœ¬äººçš„åšå®¢ã€æˆ‘æƒ³æ€ä¹ˆéª‚å°±æ€ä¹ˆéª‚ï¼šç™»ç•œæˆ‘æ°¸è¿œä¸ä¼šåŸè°…ä½ ï¼Œå“ªæ€•ä½ ä»¥åä¼šå¸¦é¢†å·´è¨å–å¾—æ€æ ·çš„æˆå°±ï¼ˆä¼¼ä¹ä¹Ÿæ²¡å•¥æˆå°±ï¼‰ï¼Œæˆ‘æ°¸è¿œä¸ä¼šåŸè°…ä½ çš„é‚£ä¸€å¹´å¯¹åˆ©ç‰©æµ¦çš„ç»µè½¯æ— åŠ›çš„ä¸€å°„ï¼Œä¸ä¼šåŸè°…æ¢…è¥¿ç¦»é˜Ÿå‘å¸ƒä¼šçš„åˆšç»“æŸä½ åˆšåˆ°å·´å¡ç½—é‚£ï¼Œä¸ä¼šåŸè°…ä½ è¾±éª‚äºšæ´²é»„ç§äººã€‚ä»–çœŸçš„ä¸é…æˆ‘èŠ±è¿™ä¹ˆé•¿ç¯‡å¹…å†™ã€‚</p><p><a href="https://imgtu.com/i/fGwEdg" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/10/fGwEdg.png" alt="æ— æ³•æƒ³è±¡"></a></p><p>æˆ‘ä¹Ÿæƒ³çœ‹åˆ°æ¢…è¥¿åœ¨åŠ å†•ä¸–ç•Œæ¯ï¼Œæˆ–æ˜¯æ²¡æœ‰åŠ å†•ï¼ˆè¿™ä¸é‡è¦ï¼‰ï¼Œä¹‹ååœ¨å·´è¨çš„çº¢è“é£˜å¸¦ä¸­ï¼Œåœ¨å·¨å¤§ç”»åƒçš„GOATä¸­å‘è¡¨æ„Ÿè¨€ï¼Œæ³ªæµæ»¡é¢ï¼Œå·´è¨æœ€ä¼Ÿå¤§çš„çƒå‘˜ï¼Œç¼“ç¼“ç¦»åœºã€‚è€Œä¸æ˜¯ï¼š</p><p><a href="https://imgtu.com/i/fGw6FH" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/10/fGw6FH.jpg" alt></a></p><h2 id="MSNå…¨éƒ½ç¦»å¼€äº†ï¼Œç”šè‡³é©¬å„¿èµ°çš„æ˜¯æœ€ä½“é¢çš„"><a href="#MSNå…¨éƒ½ç¦»å¼€äº†ï¼Œç”šè‡³é©¬å„¿èµ°çš„æ˜¯æœ€ä½“é¢çš„" class="headerlink" title="MSNå…¨éƒ½ç¦»å¼€äº†ï¼Œç”šè‡³é©¬å„¿èµ°çš„æ˜¯æœ€ä½“é¢çš„"></a>MSNå…¨éƒ½ç¦»å¼€äº†ï¼Œç”šè‡³é©¬å„¿èµ°çš„æ˜¯æœ€ä½“é¢çš„</h2><hr><p>å†…é©¬å°”æ˜¯ä¸€æ¡æ±‰å­ï¼Œæ˜¯çœŸçš„å–œçˆ±è¶³çƒï¼Œä¹Ÿæ˜¯æ¢…è¥¿çœŸçš„å…„å¼Ÿã€‚ç¾æ´²æ¯æœ€åé˜¶æ®µå¤ºå† ä¹‹åï¼Œæˆ‘å½“æ—¶å¤´çš®å‘éº»ï¼ŒçœŸæ˜¯æƒ³ä¸åˆ°æœ‰å¤šå¿«ä¹äº†ï¼Œä½†æ˜¯çœ‹åˆ°å†…é©¬å°”çš„ç¥æƒ…ï¼Œçœ‹åˆ°å†…é©¬å°”å’Œæ¢…è¥¿è„±è¡£æœååœ¨ä¸€èµ·ï¼Œæš‚æ—¶æ‰¾ä¸åˆ°é‚£ä¸€å¼ å›¾äº†ï¼Œä¸€ç§è¯´ä¸å‡ºæ¥çš„æ„Ÿæƒ…ã€‚èµ›åé©¬å„¿å‘è¡¨æ­å–œæ¢…è¥¿å¤ºå† ï¼Œâ€œè¶³çƒä¸€ç›´ç­‰å¾…è¿™ä¸€åˆ»â€ï¼ŒçœŸæ˜¯æ„Ÿè§‰å†…é©¬å°”çœŸæ˜¯æ¡‘å·´è¶³çƒçš„ä»£è¡¨ï¼Œä¹Ÿæ˜¯çœŸæœæ°”è€å¤§å“¥æ¢…è¥¿ã€‚</p><p><a href="https://imgtu.com/i/fG09k4" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/10/fG09k4.jpg" alt="è°èƒ½æƒ³åˆ°ä»–ä»¬ä¼šåœ¨å·´é»åˆç›¸è§"></a></p><h2 id="æ‹‰ç‹—ï¼Œåæ­£ç°åœ¨å°±æ˜¯æƒ³è¿™ä¹ˆå«ä½ ï¼ŒçœŸæœ‰ä½ çš„æˆå…¨ï¼ï¼ï¼"><a href="#æ‹‰ç‹—ï¼Œåæ­£ç°åœ¨å°±æ˜¯æƒ³è¿™ä¹ˆå«ä½ ï¼ŒçœŸæœ‰ä½ çš„æˆå…¨ï¼ï¼ï¼" class="headerlink" title="æ‹‰ç‹—ï¼Œåæ­£ç°åœ¨å°±æ˜¯æƒ³è¿™ä¹ˆå«ä½ ï¼ŒçœŸæœ‰ä½ çš„æˆå…¨ï¼ï¼ï¼"></a>æ‹‰ç‹—ï¼Œåæ­£ç°åœ¨å°±æ˜¯æƒ³è¿™ä¹ˆå«ä½ ï¼ŒçœŸæœ‰ä½ çš„æˆå…¨ï¼ï¼ï¼</h2><hr><blockquote><p>è¿™æ¬¡å·´è¨è¿™ä½å°å¤©æ‰ä¸»å¸­ä¸»è¦çŠ¯äº†ä»¥ä¸‹è¿™å‡ ä¸ªé”™è¯¯ æˆ‘å¿…é¡»å¾—è¯´å‡ºæ¥ ä¸ç„¶å¿ƒé‡Œå¤ªéš¾å—äº†</p><p>1ã€ä¸èƒ½ç­¾è¯·æ—©è¯´ï¼ä¸ºä»€ä¹ˆéè¦æ‹–åˆ°è½¬ä¼šçª—å£è¿˜å‰©ä¸åˆ°ä¸€ä¸ªæœˆæ‰è¯´ï¼Ÿè€Œä¸”5å·è¿˜è®©æ¢…è¥¿é£å›æ¥ç­¾åˆåŒ 6å·å°±è¯´ç­¾ä¸äº†ï¼Ÿ</p><p>2ã€ç”¨æ¢…è¥¿ä¸ºå€Ÿå£ æ— è½¬ä¼šè´¹ç­¾äº†ä¸‰ä¸ªçƒå‘˜ åŒ…æ‹¬æœ€æƒ¨çš„é˜¿kun æœ¬æ¥äººå®¶åœ¨æ›¼åŸå¥½å¥½çš„æ‹¿ä¸ªé«˜è–ªè€å°†åˆåŒç­‰é€€å½¹äº† çœ‹æ¢…è¥¿é¢å­è¢«ä½ å¿½æ‚ æ¥äº† é™è–ª1000ä¸‡ ç„¶åæ¢…è¥¿èµ°äº†</p><p>é˜¿kunï¼šï¼Ÿ</p><p>3ã€æˆ‘çŸ¥é“ç°åœ¨æ˜¯ç–«æƒ… ä¿±ä¹éƒ¨ç»æµå›°éš¾ ä½†æ˜¯æ€»ä¸è‡³äºä¸€ä¸ªåƒæ ·çš„å‘Šåˆ«ä»ªå¼éƒ½åŠä¸èµ·äº†å§ï¼ŸçœŸå°±ä¸€ç‚¹é¢å­ä¸ç»™ï¼ŸåŠä¸ªæ–°é—»å‘å¸ƒä¼š æ¥çš„äººè¿˜æ²¡æœ‰è€æ¿çš„å¥–æ¯å¤šï¼Ÿ</p><p>4ã€å®˜å®£ä¹‹åç«é€Ÿæ”¾å‡ºè§†é¢‘ ä¸‹æ¶ç…§ç‰‡ å¬å¼€ç”©é”…å‘å¸ƒä¼š ä½†æ˜¯è¿˜åœ¨å–æ–°çƒè¡£ æŒ‰ç…§è¥¿ç­ç‰™äººçš„å·¥ä½œæ•ˆç‡ ä½ è·Ÿæˆ‘è¯´è¿™ä¸æ˜¯æå‰å‡†å¤‡å¥½çš„ï¼Ÿé¬¼éƒ½ä¸ä¿¡ æ—©å°±å¼€å§‹æå‰å‡†å¤‡äº† ç„¶è€Œä¸€ç›´ç’ç€å½“äº‹äººæ¢…è¥¿ï¼Ÿ</p><p>5ã€é€‰ä¸¾çš„æ—¶å€™å£å·å°±æ˜¯ç•™ä½æ¢…è¥¿ åˆæ‹è§†é¢‘åˆå¼€å‘å¸ƒä¼šçš„ ç„¶åæ¢…è¥¿è¢«æ¸…æ´—èµ°äº†ï¼Ÿä½ çš„æ‰¿è¯ºå‘¢ï¼Ÿä½ çš„æ‹…æ¶å‘¢ï¼Ÿ</p><p>6ã€åˆ°ç°åœ¨å·´è¨è¿˜åœ¨æ¬ æ¢…è¥¿å·¥èµ„â€¦â€¦æ‹œæ‰˜ äººéƒ½è¢«ä½ èµ¶èµ°äº†ï¼å·¥èµ„èƒ½ä¸èƒ½ç»“æ¸…äº†ï¼Ÿï¼ï¼ï¼</p><p>ä¸æ˜¯ä¸èƒ½æ¥å—è€æ¿çš„ç¦»å¼€ è€Œæ˜¯ä¸èƒ½æ¥å—è€æ¿è¿™æ ·çš„ç¦»å¼€ï¼è¿™tmå¯æ˜¯ä½ ç°å½¹çš„é˜Ÿå²ç¬¬ä¸€äººï¼ç¬¬ä¸€äººï¼ï¼ï¼</p><p>å•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šï¼ï¼ï¼æ°”æ­»æˆ‘äº†ï¼ï¼ï¼</p><p>è‡ªä»æ¶ˆæ¯çˆ†å‡ºæ¥å¼€å§‹æˆ‘å°±å¤©å¤©åˆ·æ¶ˆæ¯ å„ç§æ–°é—» å„ç§è®ºå› æ˜¨å¤©è¿˜çœ‹äº†å…¨ç¨‹çš„æ–°é—»å‘å¸ƒä¼šç›´æ’­ å¤ªæ°”äººäº†ï¼</p><p>çœŸçš„ è€æ¿çœŸå°±æ˜¯è„¾æ°”å¥½ é‡æƒ…ä¹‰ ä½ å°±èƒ½é€®ç€è€å®äººæ¬ºè´Ÿ è¿™è¦æ˜¯æ¢æˆå¥‰å…ˆï¼Ÿç›´æ¥æŠŠä½ äººéƒ½æ‹†äº†ï¼ï¼ï¼</p><p>æˆ‘å¯¹ä½ ä»˜å‡ºçš„é’æ˜¥è¿™ä¹ˆå¤šå¹´</p><p>æ¢æ¥äº†ä¸€å¥è°¢è°¢ä½ çš„æˆå…¨</p><p>æˆå…¨äº†ä½ çš„æ½‡æ´’ä¸å†’é™©</p><p>æˆå…¨äº†æˆ‘çš„ç¢§æµ·è“å¤©</p><p>å¥¹è®¸ä½ çš„æµ·èª“å±±ç›Ÿèœœè¯­ç”œè¨€</p><p>æˆ‘åªæœ‰ä¸€å¥ä¸åæ‚”çš„æˆå…¨</p><p>æˆå…¨äº†ä½ çš„ä»Šå¤©ä¸æ˜å¤©</p><p>æˆå…¨äº†æˆ‘çš„ä¸‹ä¸ªå¤å¤©</p><p><a href="https://imgtu.com/i/fG0A6x" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/10/fG0A6x.jpg" alt="æœ€å·…å³°çš„é‚£å‡ å¹´"></a></p><hr><p>å³ä½¿ä¿±ä¹éƒ¨å¯¹ä»–å†æ— æƒ…</p><p>æ— æƒ…åˆ°å…¨ä¸–ç•Œçš„çƒè¿·éƒ½åœ¨çœ‹åœ¨çœ¼é‡Œ è®°åœ¨å¿ƒä¸Š æ— å°½çš„æŒ‡è´£ æ— å°½çš„å’’éª‚</p><p>æ— æƒ…åˆ°å€ŸåŠ©ä»–çš„åå£°ä¸Šä½</p><p>å€ŸåŠ©ä»–çš„åå£°æ‹›æ½çƒå‘˜</p><p>å€ŸåŠ©ä»–çš„åå£°è®©é˜Ÿå‘˜é™è–ª</p><p>ä¸€ç›´æ‹–åˆ°è½¬ä¼šçª—å£å³å°†å…³é—­çš„æ—¶åˆ»</p><p>è®©ä»–é£å›æ¥ç­¾åˆåŒ</p><p>å½“ä»–å›æ¥çš„æ—¶å€™ å´è®©ä»–ç¦»å¼€</p><p>å·®ä¸€ç‚¹è®©ä»–æ— æ³•å†ç»§ç»­è‡ªå·±çš„èŒä¸šç”Ÿæ¶¯</p><p>å³ä½¿è¿™æ ·</p><p>ä»–å¯¹ä¿±ä¹éƒ¨æ²¡æœ‰åŠç‚¹æ€¨è¨€</p><p>æ²¡æœ‰å¯¹ä»»ä½•äººæœ‰åŠç‚¹æ€¨è¨€</p><p>è¿™æ›¾ç»æ˜¯ä»–çš„å®¶</p><p>ç°åœ¨è¿™ä¸ªå®¶ä¸è¦ä»–äº†</p><p>ä»–å“­å¾—åƒä¸€ä¸ªå­©å­</p><p><a href="https://imgtu.com/i/fG009s" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/10/fG009s.jpg" alt="å­©ç«¥æ—¶åˆ°æ¥ï¼Œå¹´è¿ˆæ—¶ç¦»å¼€"></a></p><p>ç•™ä¸‹äº†å¯¹è¿™ä¸ªå®¶æœ€ç¾å¥½çš„ç¥ç¦</p><p>ç„¶åè½¬èº«ç¦»å¼€</p><p>æ²¡æœ‰è¯ºåæ™®åä¸‡çƒè¿·çš„å±±å‘¼æµ·å•¸</p><p>æ²¡æœ‰å·´å¡ç½—é‚£æ¼«å±±éé‡çš„çº¢è“æˆ˜è¡£</p><p>ç”šè‡³æ²¡æœ‰ä¸€ä¸ªä½“é¢çš„å‘Šåˆ«ä»ªå¼</p><p>ä¸€ä¸ªç®€å•åˆ°ä¸èƒ½å†ç®€å•çš„æ–°é—»å‘å¸ƒä¼š</p><p>ç®€å•çš„èˆå° èŠèŠæ•°åäººè½åº§</p><p>åœ¨åº§çš„äººæ•°è¿˜ä¸åŠä»–æ‰€è·å¾—çš„å¥–æ¯æ•°é‡</p><p>è¿™å°±æ˜¯å·´è¨</p><p>è¿™ä¸ä»…ä»…æ˜¯ä¸€å®¶ä¿±ä¹éƒ¨</p><p>å®ƒå¯¹è‡ªå·±çš„é˜Ÿå²ç¬¬ä¸€åŠŸå‹‹</p><p>å¦‚æ­¤çš„å†·é…·æ— æƒ…</p><p>æœ€åæˆ‘æƒ³è¯´å¥æˆ‘çš„å¿ƒé‡Œè¯</p><p>æ¢…è¥¿</p><p>æ‹‰ç€å†…é©¬å°” æ‹‰è«æ–¯ å§†å·´ä½© è¿ªç›åˆ©äºš ä»¥åŠå·´é»çš„æ‰€æœ‰çƒå‘˜</p><p>è¡€æ´—è¯ºåæ™®å§ï¼</p></blockquote><h1 id="è«æ„å‰è·¯æ— çŸ¥å·±ï¼Œå¤©ä¸‹è°äººä¸è¯†å›ï¼"><a href="#è«æ„å‰è·¯æ— çŸ¥å·±ï¼Œå¤©ä¸‹è°äººä¸è¯†å›ï¼" class="headerlink" title="è«æ„å‰è·¯æ— çŸ¥å·±ï¼Œå¤©ä¸‹è°äººä¸è¯†å›ï¼"></a>è«æ„å‰è·¯æ— çŸ¥å·±ï¼Œå¤©ä¸‹è°äººä¸è¯†å›ï¼</h1><hr><p><a href="https://imgtu.com/i/fG0W4J" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/10/fG0W4J.jpg" alt></a></p>]]></content>
      
      
      <categories>
          
          <category> äººç‰© </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç”Ÿæ´»éšç¬” </tag>
            
            <tag> æ¢…è¥¿ </tag>
            
            <tag> è¿åŠ¨ </tag>
            
            <tag> åˆ«ç¦» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¸¸ç”¨Tensoræ“ä½œ</title>
      <link href="/2021/08/07/chang-yong-tensor-cao-zuo/"/>
      <url>/2021/08/07/chang-yong-tensor-cao-zuo/</url>
      
        <content type="html"><![CDATA[<p>å½“ç„¶è¿™é‡ŒåŸºæœ¬ä¸Šéƒ½æ˜¯æœ¬äººçš„ä»£ç ï¼Œè¿˜æ²¡æ¥å¾—åŠå¾ˆå…·ä½“çš„æ•´ç†ï¼Œæ‰€ä»¥æ¯”è¾ƒä¹±â€¦â€¦</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function<span class="token keyword">import</span> torch <span class="token keyword">as</span> tt<span class="token punctuation">.</span>__version__<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>&#39;1.8.1+cpu&#39;</code></pre><h2 id="Tensor"><a href="#Tensor" class="headerlink" title="Tensor"></a>Tensor</h2><p>Tensorï¼Œåˆåå¼ é‡ï¼Œè¯»è€…å¯èƒ½å¯¹è¿™ä¸ªåè¯ä¼¼æ›¾ç›¸è¯†ï¼Œå› å®ƒä¸ä»…åœ¨PyTorchä¸­å‡ºç°è¿‡ï¼Œå®ƒä¹Ÿæ˜¯Theanoã€TensorFlowã€<br>Torchå’ŒMxNetä¸­é‡è¦çš„æ•°æ®ç»“æ„ã€‚å…³äºå¼ é‡çš„æœ¬è´¨ä¸ä¹æ·±åº¦çš„å‰–æï¼Œä½†ä»å·¥ç¨‹è§’åº¦æ¥è®²ï¼Œå¯ç®€å•åœ°è®¤ä¸ºå®ƒå°±æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¸”æ”¯æŒé«˜æ•ˆçš„ç§‘å­¦è®¡ç®—ã€‚å®ƒå¯ä»¥æ˜¯ä¸€ä¸ªæ•°ï¼ˆæ ‡é‡ï¼‰ã€ä¸€ç»´æ•°ç»„ï¼ˆå‘é‡ï¼‰ã€äºŒç»´æ•°ç»„ï¼ˆçŸ©é˜µï¼‰å’Œæ›´é«˜ç»´çš„æ•°ç»„ï¼ˆé«˜é˜¶æ•°æ®ï¼‰ã€‚Tensorå’ŒNumpyçš„ndarraysç±»ä¼¼ï¼Œä½†PyTorchçš„tensoræ”¯æŒGPUåŠ é€Ÿã€‚</p><p><del>æœ¬èŠ‚å°†ç³»ç»Ÿè®²è§£tensorçš„ä½¿ç”¨ï¼ŒåŠ›æ±‚é¢é¢ä¿±åˆ°ï¼Œä½†ä¸ä¼šæ¶‰åŠæ¯ä¸ªå‡½æ•°</del>ã€‚å¯¹äºæ›´å¤šå‡½æ•°åŠå…¶ç”¨æ³•ï¼Œæˆ‘ä»¬å¯é€šè¿‡åœ¨IPython/Notebookä¸­ä½¿ç”¨å‡½æ•°ååŠ <code>?</code>æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£ï¼Œæˆ–æŸ¥é˜…PyTorchå®˜æ–¹æ–‡æ¡£<a href="http://docs.pytorch.org" target="_blank" rel="noopener">^1</a>ã€‚</p><h3 id="åŸºç¡€æ“ä½œ"><a href="#åŸºç¡€æ“ä½œ" class="headerlink" title="åŸºç¡€æ“ä½œ"></a>åŸºç¡€æ“ä½œ</h3><p>å­¦ä¹ è¿‡Numpyä¼šæ„Ÿåˆ°éå¸¸ç†Ÿæ‚‰ï¼Œå› tensorçš„æ¥å£æœ‰æ„è®¾è®¡æˆä¸Numpyç±»ä¼¼ï¼Œä»¥æ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨ã€‚</p><p>ä»æ¥å£çš„è§’åº¦æ¥è®²ï¼Œå¯¹tensorçš„æ“ä½œå¯åˆ†ä¸ºä¸¤ç±»ï¼š</p><ol><li><code>torch.function</code>ï¼Œå¦‚<code>torch.save</code>ç­‰ã€‚</li><li>å¦ä¸€ç±»æ˜¯<code>tensor.function</code>ï¼Œå¦‚<code>tensor.view</code>ç­‰ã€‚</li></ol><p>ä¸ºæ–¹ä¾¿ä½¿ç”¨ï¼Œå¯¹tensorçš„å¤§éƒ¨åˆ†æ“ä½œåŒæ—¶æ”¯æŒè¿™ä¸¤ç±»æ¥å£ï¼Œåœ¨æœ¬ä¹¦ä¸­ä¸åšå…·ä½“åŒºåˆ†ï¼Œå¦‚<code>torch.sum (torch.sum(a, b))</code>ä¸<code>tensor.sum (a.sum(b))</code>åŠŸèƒ½ç­‰ä»·ã€‚</p><p>è€Œä»å­˜å‚¨çš„è§’åº¦æ¥è®²ï¼Œå¯¹tensorçš„æ“ä½œåˆå¯åˆ†ä¸ºä¸¤ç±»ï¼š</p><ol><li>ä¸ä¼šä¿®æ”¹è‡ªèº«çš„æ•°æ®ï¼Œå¦‚ <code>a.add(b)</code>ï¼Œ åŠ æ³•çš„ç»“æœä¼šè¿”å›ä¸€ä¸ªæ–°çš„tensorã€‚</li><li>ä¼šä¿®æ”¹è‡ªèº«çš„æ•°æ®ï¼Œå¦‚ <code>a.add_(b)</code>ï¼Œ åŠ æ³•çš„ç»“æœä»å­˜å‚¨åœ¨aä¸­ï¼Œaè¢«ä¿®æ”¹äº†ã€‚</li></ol><p>å‡½æ•°åä»¥<code>_</code>ç»“å°¾çš„éƒ½æ˜¯inplaceæ–¹å¼, å³ä¼šä¿®æ”¹è°ƒç”¨è€…è‡ªå·±çš„æ•°æ®ï¼Œåœ¨å®é™…åº”ç”¨ä¸­éœ€åŠ ä»¥åŒºåˆ†ã€‚</p><h4 id="åˆ›å»ºTensor"><a href="#åˆ›å»ºTensor" class="headerlink" title="åˆ›å»ºTensor"></a>åˆ›å»ºTensor</h4><p>åœ¨PyTorchä¸­æ–°å»ºtensorçš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œå…·ä½“å¦‚è¡¨3-1æ‰€ç¤ºã€‚</p><p>è¡¨3-1: å¸¸è§æ–°å»ºtensorçš„æ–¹æ³•</p><table><thead><tr><th align="center">å‡½æ•°</th><th align="center">åŠŸèƒ½</th></tr></thead><tbody><tr><td align="center">Tensor(*sizes)</td><td align="center">åŸºç¡€æ„é€ å‡½æ•°</td></tr><tr><td align="center">tensor(data,)</td><td align="center">ç±»ä¼¼np.arrayçš„æ„é€ å‡½æ•°</td></tr><tr><td align="center">ones(*sizes)</td><td align="center">å…¨1Tensor</td></tr><tr><td align="center">zeros(*sizes)</td><td align="center">å…¨0Tensor</td></tr><tr><td align="center">eye(*sizes)</td><td align="center">å¯¹è§’çº¿ä¸º1ï¼Œå…¶ä»–ä¸º0</td></tr><tr><td align="center">arange(s,e,step</td><td align="center">ä»såˆ°eï¼Œæ­¥é•¿ä¸ºstep</td></tr><tr><td align="center">linspace(s,e,steps)</td><td align="center">ä»såˆ°eï¼Œå‡åŒ€åˆ‡åˆ†æˆstepsä»½</td></tr><tr><td align="center">rand/randn(*sizes)</td><td align="center">å‡åŒ€/æ ‡å‡†åˆ†å¸ƒ</td></tr><tr><td align="center">normal(mean,std)/uniform(from,to)</td><td align="center">æ­£æ€åˆ†å¸ƒ/å‡åŒ€åˆ†å¸ƒ</td></tr><tr><td align="center">randperm(m)</td><td align="center">éšæœºæ’åˆ—</td></tr></tbody></table><p>è¿™äº›åˆ›å»ºæ–¹æ³•éƒ½å¯ä»¥åœ¨åˆ›å»ºçš„æ—¶å€™æŒ‡å®šæ•°æ®ç±»å‹dtypeå’Œå­˜æ”¾device(cpu/gpu).</p><p>å…¶ä¸­ä½¿ç”¨<code>Tensor</code>å‡½æ•°æ–°å»ºtensoræ˜¯æœ€å¤æ‚å¤šå˜çš„æ–¹å¼ï¼Œå®ƒæ—¢å¯ä»¥æ¥æ”¶ä¸€ä¸ªlistï¼Œå¹¶æ ¹æ®listçš„æ•°æ®æ–°å»ºtensorï¼Œä¹Ÿèƒ½æ ¹æ®æŒ‡å®šçš„å½¢çŠ¶æ–°å»ºtensorï¼Œè¿˜èƒ½ä¼ å…¥å…¶ä»–çš„tensorï¼Œä¸‹é¢ä¸¾å‡ ä¸ªä¾‹å­ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># æŒ‡å®štensorå½¢çŠ¶</span>a <span class="token operator">=</span> t<span class="token punctuation">.</span>Tensor<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># æå‰åˆ†é…å¥½ç©ºé—´</span>a   <span class="token comment" spellcheck="true"># æ•°å€¼å–å†³äºå†…å­˜ç©ºé—´çš„çŠ¶æ€ï¼Œ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>tensor([[0., 0., 0.],        [0., 0., 0.]])</code></pre><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># ä½¿ç”¨listæ•°æ®åˆ›å»ºtensor</span>b <span class="token operator">=</span> t<span class="token punctuation">.</span>Tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>b<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>tensor([[1., 2., 3.],        [4., 5., 6.]])</code></pre><pre class="line-numbers language-python"><code class="language-python">b<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true"># å’Œnumpyçš„è½¬åŒ–ä½•å…¶ç›¸ä¼¼</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>[[1.0, 2.0, 3.0], [4.0, 5.0, 6.0]]</code></pre><p><code>tensor.size()</code>è¿”å›<code>torch.Size</code>å¯¹è±¡ï¼Œå®ƒæ˜¯tupleçš„å­ç±»ï¼Œä½†å…¶ä½¿ç”¨æ–¹å¼ä¸tupleç•¥æœ‰åŒºåˆ«</p><pre class="line-numbers language-python"><code class="language-python">b_size <span class="token operator">=</span> b<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span>b_size<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>torch.Size([2, 3])</code></pre><pre class="line-numbers language-python"><code class="language-python">b<span class="token punctuation">.</span>numel<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">#  bä¸­å…ƒç´ æ€»ä¸ªæ•°ï¼Œ2*3ï¼Œç­‰ä»·äºb.nelement()</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>6</code></pre><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># åˆ›å»ºä¸€ä¸ªä¸bå½¢çŠ¶ä¸€æ ·çš„tensor</span>c <span class="token operator">=</span> t<span class="token punctuation">.</span>Tensor<span class="token punctuation">(</span>b<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># åˆ›å»ºä¸€ä¸ªå…ƒç´ ä¸º2å’Œ3çš„tensor</span>d <span class="token operator">=</span> t<span class="token punctuation">.</span>Tensor<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true"># æ³¨æ„å’Œt.Tensor(2, 3)å®Œå…¨ä¸ä¸€æ ·ï¼</span>c<span class="token punctuation">,</span> d<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>(tensor([[0., 0., 0.],         [0., 0., 0.]]), tensor([2., 3.]))</code></pre><pre class="line-numbers language-python"><code class="language-python">c<span class="token punctuation">.</span>shape   <span class="token comment" spellcheck="true"># equal to c.size()</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>torch.Size([2, 3])</code></pre><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>t.Tensor(*sizes)</code>åˆ›å»ºtensoræ—¶ï¼Œç³»ç»Ÿä¸ä¼šé©¬ä¸Šåˆ†é…ç©ºé—´ï¼Œåªæ˜¯ä¼šè®¡ç®—å‰©ä½™çš„å†…å­˜æ˜¯å¦è¶³å¤Ÿä½¿ç”¨ï¼Œä½¿ç”¨åˆ°tensoræ—¶æ‰ä¼šåˆ†é…ï¼Œè€Œå…¶å®ƒæ“ä½œéƒ½æ˜¯åœ¨åˆ›å»ºå®Œtensorä¹‹åé©¬ä¸Šè¿›è¡Œç©ºé—´åˆ†é…ã€‚å…¶å®ƒå¸¸ç”¨çš„åˆ›å»ºtensorçš„æ–¹æ³•ä¸¾ä¾‹å¦‚ä¸‹ã€‚</p><pre class="line-numbers language-python"><code class="language-python">t<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>tensor([[1., 1., 1.],        [1., 1., 1.]])</code></pre><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">,</span> t<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>tensor([[0., 0., 0.],        [0., 0., 0.]])tensor([ 1,  5,  9, 13, 17])tensor([ 1.0000,  5.5000, 10.0000])  tensor([ 1.0000,  2.1250,  3.2500,  4.3750,  5.5000,  6.6250,  7.7500,  8.8750,        10.0000])</code></pre><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> device<span class="token operator">=</span>t<span class="token punctuation">.</span>device<span class="token punctuation">(</span><span class="token string">'cpu'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>tensor([[ 0.6485,  0.8807,  0.5077],        [-1.1991, -0.9738, -0.8757]])</code></pre><pre class="line-numbers language-python"><code class="language-python">t<span class="token punctuation">.</span>randperm<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># é•¿åº¦ä¸º5çš„éšæœºæ’åˆ—</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>tensor([1, 3, 2, 0, 4])</code></pre><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>eye<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>t<span class="token punctuation">.</span>int<span class="token punctuation">)</span><span class="token punctuation">)</span>t<span class="token punctuation">.</span>eye<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>t<span class="token punctuation">.</span>int<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># å¯¹è§’çº¿ä¸º1ï¼Œ ä¸è¦æ±‚è¡Œåˆ—æ•°ä¸€è‡´</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>tensor([[1, 0],        [0, 1],        [0, 0],        [0, 0]], dtype=torch.int32)tensor([[1, 0, 0],        [0, 1, 0]], dtype=torch.int32)</code></pre><p><code>torch.tensor</code>æ˜¯åœ¨0.4ç‰ˆæœ¬æ–°å¢åŠ çš„ä¸€ä¸ªæ–°ç‰ˆæœ¬çš„åˆ›å»ºtensoræ–¹æ³•ï¼Œä½¿ç”¨çš„æ–¹æ³•ï¼Œå’Œå‚æ•°å‡ ä¹å’Œ<code>np.array</code>å®Œå…¨ä¸€è‡´</p><pre class="line-numbers language-python"><code class="language-python">scalar <span class="token operator">=</span> t<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token number">3.14159</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'scalar: %s, shape of scalar: %s'</span> <span class="token operator">%</span><span class="token punctuation">(</span>scalar<span class="token punctuation">,</span> scalar<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># é›¶ç»´æ ‡é‡</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>scalar: tensor(3.1416), shape of scalar: torch.Size([])</code></pre><pre class="line-numbers language-python"><code class="language-python">vector <span class="token operator">=</span> t<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'vector: %s, shape of vector: %s'</span> <span class="token operator">%</span><span class="token punctuation">(</span>vector<span class="token punctuation">,</span> vector<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># å‘é‡</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>vector: tensor([1, 2]), shape of vector: torch.Size([2])</code></pre><pre class="line-numbers language-python"><code class="language-python">tensor <span class="token operator">=</span> t<span class="token punctuation">.</span>Tensor<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># æ³¨æ„ä¸t.tensor([1, 2])åŒºåˆ«</span>tensor<span class="token punctuation">.</span>shape<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>torch.Size([1, 2])</code></pre><pre class="line-numbers language-python"><code class="language-python">matrix <span class="token operator">=</span> t<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">1.2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2.2</span><span class="token punctuation">,</span> <span class="token number">3.1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4.9</span><span class="token punctuation">,</span> <span class="token number">5.2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>matrix<span class="token punctuation">,</span> matrix<span class="token punctuation">.</span>shape<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>(tensor([[0.1000, 1.2000],         [2.2000, 3.1000],         [4.9000, 5.2000]]), torch.Size([3, 2]))</code></pre><pre class="line-numbers language-python"><code class="language-python">empty_tensor <span class="token operator">=</span> t<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>empty_tensor<span class="token punctuation">.</span>shape<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>torch.Size([0])</code></pre><p>é€šè¿‡<code>tensor.view</code>æ–¹æ³•å¯ä»¥è°ƒæ•´tensorçš„å½¢çŠ¶ï¼Œä½†å¿…é¡»ä¿è¯è°ƒæ•´å‰åå…ƒç´ æ€»æ•°ä¸€è‡´ã€‚<code>view</code>ä¸ä¼šä¿®æ”¹è‡ªèº«çš„æ•°æ®ï¼Œè¿”å›çš„æ–°tensorä¸æºtensorå…±äº«å†…å­˜ï¼Œä¹Ÿå³æ›´æ”¹å…¶ä¸­çš„ä¸€ä¸ªï¼Œå¦å¤–ä¸€ä¸ªä¹Ÿä¼šè·Ÿç€æ”¹å˜ã€‚åœ¨å®é™…åº”ç”¨ä¸­å¯èƒ½ç»å¸¸éœ€è¦æ·»åŠ æˆ–å‡å°‘æŸä¸€ç»´åº¦ï¼Œè¿™æ—¶å€™<code>squeeze</code>å’Œ<code>unsqueeze</code>ä¸¤ä¸ªå‡½æ•°å°±æ´¾ä¸Šç”¨åœºäº†ã€‚</p><pre class="line-numbers language-python"><code class="language-python">a <span class="token operator">=</span> t<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>a<span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>tensor([[0, 1, 2],        [3, 4, 5]])</code></pre><pre class="line-numbers language-python"><code class="language-python">b <span class="token operator">=</span> a<span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>b<span class="token punctuation">.</span>shape<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>torch.Size([2, 3])</code></pre><pre class="line-numbers language-python"><code class="language-python">b<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># æ³¨æ„å½¢çŠ¶ï¼Œåœ¨ç¬¬1ç»´ï¼ˆä¸‹æ ‡ä»0å¼€å§‹ï¼‰ä¸Šå¢åŠ â€œ1â€</span><span class="token comment" spellcheck="true"># ç­‰ä»·äºb[, None]</span>b<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> None<span class="token punctuation">]</span><span class="token punctuation">.</span>shape<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>torch.Size([2, 1, 3])</code></pre><pre class="line-numbers language-python"><code class="language-python">b<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># -2è¡¨ç¤ºå€’æ•°ç¬¬äºŒä¸ªç»´åº¦</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>tensor([[[0, 1, 2]],        [[3, 4, 5]]])</code></pre><pre class="line-numbers language-python"><code class="language-python">c <span class="token operator">=</span> b<span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>c<span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># å‹ç¼©ç¬¬0ç»´çš„â€œ1â€</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>tensor([[[[0, 1, 2],          [3, 4, 5]]]])</code></pre><pre class="line-numbers language-python"><code class="language-python">c<span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># æŠŠæ‰€æœ‰ç»´åº¦ä¸ºâ€œ1â€çš„å‹ç¼©</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>tensor([[0, 1, 2],        [3, 4, 5]])</code></pre><pre class="line-numbers language-python"><code class="language-python">a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">100</span>b  <span class="token comment" spellcheck="true"># aä¿®æ”¹ï¼Œ bä½œä¸ºviewä¹‹åçš„ï¼Œä¹Ÿä¼šè·Ÿç€ä¿®æ”¹</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>tensor([[  0, 100,   2],        [  3,   4,   5]])</code></pre><pre class="line-numbers language-python"><code class="language-python">help<span class="token punctuation">(</span>t<span class="token punctuation">.</span>squeeze<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>Help on built-in function squeeze:squeeze(...)    squeeze(input, dim=None, *, out=None) -&gt; Tensor    Returns a tensor with all the dimensions of :attr:`input` of size `1` removed.    For example, if `input` is of shape:    :math:`(A \times 1 \times B \times C \times 1 \times D)` then the `out` tensor    will be of shape: :math:`(A \times B \times C \times D)`.    When :attr:`dim` is given, a squeeze operation is done only in the given    dimension. If `input` is of shape: :math:`(A \times 1 \times B)`,    ``squeeze(input, 0)`` leaves the tensor unchanged, but ``squeeze(input, 1)``    will squeeze the tensor to the shape :math:`(A \times B)`.    .. note:: The returned tensor shares the storage with the input tensor,              so changing the contents of one will change the contents of the other.    .. warning:: If the tensor has a batch dimension of size 1, then `squeeze(input)`              will also remove the batch dimension, which can lead to unexpected              errors.    Args:        input (Tensor): the input tensor.        dim (int, optional): if given, the input will be squeezed only in               this dimension    Keyword args:        out (Tensor, optional): the output tensor.    Example::        &gt;&gt;&gt; x = torch.zeros(2, 1, 2, 1, 2)        &gt;&gt;&gt; x.size()        torch.Size([2, 1, 2, 1, 2])        &gt;&gt;&gt; y = torch.squeeze(x)        &gt;&gt;&gt; y.size()        torch.Size([2, 2, 2])        &gt;&gt;&gt; y = torch.squeeze(x, 0)        &gt;&gt;&gt; y.size()        torch.Size([2, 1, 2, 1, 2])        &gt;&gt;&gt; y = torch.squeeze(x, 1)        &gt;&gt;&gt; y.size()        torch.Size([2, 2, 1, 2])</code></pre><p>â€‹    </p><pre class="line-numbers language-python"><code class="language-python"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> æŒ‡ä»¤é›† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> pytorch </tag>
            
            <tag> Tensor </tag>
            
            <tag> çŸ©é˜µ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeNetå®ç°CIFAR10åˆ†ç±»</title>
      <link href="/2021/08/07/lenet-shi-xian-cifar10-fen-lei/"/>
      <url>/2021/08/07/lenet-shi-xian-cifar10-fen-lei/</url>
      
        <content type="html"><![CDATA[<p>å­¦äº†é‚£ä¹ˆé•¿æ—¶é—´çš„ç¥ç»ç½‘ç»œä»¥åŠå„ä¸ªæœºå™¨å­¦ä¹ ç®—æ³•çš„æ‰‹åŠ¨numpyåº•å±‚å®ç°ï¼Œ ä¹Ÿæ‰äº†å¥½å¤šå¤´å‘ï¼Œç»ˆäºä¹Ÿç®—æ˜¯å¯¹è¿™äº›ç®—æ³•æœ‰äº†ç®—æ˜¯æ¯”è¾ƒæœ¬è´¨çš„ç†è§£ã€‚æ¥ä¸‹æ¥ç»ˆäºå¯ä»¥æ¥è§¦çœŸæ­£çš„æ·±åº¦å­¦ä¹ åº“äº†ã€‚è¿˜æ˜¯å¾ˆé«˜å…´çš„ï¼Œ <del>ç»ˆäºå¯ä»¥å½“è°ƒå‚ä¾ äº†ğŸ˜</del>ï¼</p><p>LeNetæ˜¯CNNçš„å¼€å±±ä¹‹ä½œï¼Œæˆ‘ä»¬æœ¬æ¬¡åˆ©ç”¨LeNetæ¥å®ç°CIFAR10æ•°æ®é›†çš„åˆ†ç±»ï¼Œå½“ç„¶è¿™ä¸ªåªæ˜¯ä¾›ç»ƒä¹ ä½¿ç”¨pytorchä½¿ç”¨ï¼Œå®é™…ä¸ŠæŠ€æœ¯å«é‡ä¸Šå¹¶ä¸é«˜ï¼Œæˆ‘ä¹Ÿåªæ˜¯ç®€å•è®°å½•ä¸€ä¸‹å­¦ä¹ æœ‰å…³è¿‡ç¨‹ä¸å†…å®¹ã€‚<del>çœŸçš„æ˜¯éå¸¸ç®€å•éšæ„çš„è®°å½•</del></p><h2 id="å¯¼å…¥æœ‰å…³åº“"><a href="#å¯¼å…¥æœ‰å…³åº“" class="headerlink" title="å¯¼å…¥æœ‰å…³åº“"></a>å¯¼å…¥æœ‰å…³åº“</h2><p>æˆ‘ä»¬ä¸»è¦è¿ç”¨çš„å°±æ˜¯torch/torchvisionåº“, å°±æ˜¯å¤§è‡´é…ä¸€ä¸‹å˜é‡åç½¢äº†</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> torch <span class="token keyword">as</span> t<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn      <span class="token comment" spellcheck="true"># nnåº“ï¼Œæœ‰ç€è®¸å¤šæˆ‘ä»¬éœ€è¦çš„å‡½æ•°å¦‚å·ç§¯conv1d\conv2d</span><span class="token keyword">import</span> torch<span class="token punctuation">.</span>optim <span class="token keyword">as</span> optim   <span class="token comment" spellcheck="true"># ä¼˜åŒ–å™¨</span><span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>functional <span class="token keyword">as</span> F  <span class="token comment" spellcheck="true"># ä¸»è¦æœ‰æ¿€æ´»å‡½æ•°</span><span class="token keyword">import</span> torchvision <span class="token keyword">as</span> tv   <span class="token comment" spellcheck="true"># torchvisionåº“ï¼Œæœºå™¨è§†è§‰åº“</span><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> torchvision<span class="token punctuation">.</span>transforms <span class="token keyword">as</span> transforms  <span class="token comment" spellcheck="true"># æ•°æ®é¢„å¤„ç†æ–¹å¼</span><span class="token keyword">from</span> torchvision<span class="token punctuation">.</span>transforms <span class="token keyword">import</span> ToPILImage  <span class="token comment" spellcheck="true"># ç”¨æ¥æ˜¾ç¤ºæˆ‘ä»¬çš„å›¾åƒ</span>show <span class="token operator">=</span> ToPILImage<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 1.8.1+cpu</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è¯»å–æ•°æ®"><a href="#è¯»å–æ•°æ®" class="headerlink" title="è¯»å–æ•°æ®"></a>è¯»å–æ•°æ®</h2><p>è¿™æ–¹é¢æœ¬äººåœ¨ä¸Šä¸€ç¯‡åšå®¢<a href="https://lry89757.github.io/2021/08/06/cifar10-shu-ju-ji-ji-du-qu/">Blog</a>ä¸­å·²ç»ä»‹ç»è¿‡äº†ã€‚æœ€åå¾—åˆ°çš„æ˜¯ä¸€ä¸ªdataloaderçš„è¿­ä»£å™¨ã€‚æˆ‘ä»¬æ¯æ¬¡è¿­ä»£éƒ½å¯ä»¥è·å–ä¸€ä¸ªå°æ‰¹é‡ï¼Œä¸€ä¸ªå°æ‰¹é‡æœ‰4ä¸ªæ ·æœ¬ã€‚æˆ‘ä»¬è¿™é‡Œå°±ä¸å†è®²è§£æ•°æ®é¢„å¤„ç†ç¯èŠ‚äº†ã€‚ç›´æ¥çœ‹ä»£ç ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># æ•°æ®é¢„å¤„ç†ï¼Œç›¸å½“äºæå‰å®šä¹‰äº†æ€ä¹ˆå¤„ç†æ•°æ®ï¼š</span><span class="token comment" spellcheck="true"># å› ä¸ºè¯»å…¥çš„æ•°æ®ä¸ºnumpyæ ¼å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å…ˆå°†å…¶è½¬æ¢ä¸ºtensoræ ¼å¼ï¼Œ</span><span class="token comment" spellcheck="true"># ç„¶åå¯¹å…¶è¿›è¡Œå½’ä¸€åŒ–ï¼Œæœ‰ä¸‰ä¸ªé€šé“éœ€è¦å½’ä¸€åŒ–ï¼Œè€Œç¬¬ä¸€ä¸ªä¸ºå‡å€¼ï¼Œç¬¬äºŒä¸ªä¸ºæ ‡å‡†å·®</span>transform <span class="token operator">=</span> transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span><span class="token punctuation">[</span>    transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># è½¬ä¸ºTensor</span>    transforms<span class="token punctuation">.</span>Normalize<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># è®­ç»ƒé›†</span>trainset <span class="token operator">=</span> tv<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>CIFAR10<span class="token punctuation">(</span>    root<span class="token operator">=</span><span class="token string">'/pytorch/Data/'</span><span class="token punctuation">,</span>    train<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>    download<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>    transform<span class="token operator">=</span>transform<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># è¿­ä»£å™¨</span>trainloader <span class="token operator">=</span> t<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>    trainset<span class="token punctuation">,</span>    batch_size<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>    shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>    num_workers<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># æµ‹è¯•é›†</span>testset <span class="token operator">=</span> tv<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>CIFAR10<span class="token punctuation">(</span>    root<span class="token operator">=</span><span class="token string">'/pytorch/Data/'</span><span class="token punctuation">,</span>    train<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>    download<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>    transform<span class="token operator">=</span>transform<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># è¿­ä»£å™¨</span>testloader <span class="token operator">=</span> t<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>    trainset<span class="token punctuation">,</span>    batch_size<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>    shuffle<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>    num_workers<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç¥ç»ç½‘ç»œé¢„å¤‡çŸ¥è¯†"><a href="#ç¥ç»ç½‘ç»œé¢„å¤‡çŸ¥è¯†" class="headerlink" title="ç¥ç»ç½‘ç»œé¢„å¤‡çŸ¥è¯†"></a>ç¥ç»ç½‘ç»œé¢„å¤‡çŸ¥è¯†</h2><p>Autogradå®ç°äº†åå‘ä¼ æ’­åŠŸèƒ½ï¼Œä½†æ˜¯ç›´æ¥ç”¨æ¥å†™æ·±åº¦å­¦ä¹ çš„ä»£ç åœ¨å¾ˆå¤šæƒ…å†µä¸‹è¿˜æ˜¯ç¨æ˜¾å¤æ‚ï¼Œtorch.nnæ˜¯ä¸“é—¨ä¸ºç¥ç»ç½‘ç»œè®¾è®¡çš„æ¨¡å—åŒ–æ¥å£ã€‚nnæ„å»ºäº Autogradä¹‹ä¸Šï¼Œå¯ç”¨æ¥å®šä¹‰å’Œè¿è¡Œç¥ç»ç½‘ç»œã€‚nn.Moduleæ˜¯nnä¸­æœ€é‡è¦çš„ç±»ï¼Œå¯æŠŠå®ƒçœ‹æˆæ˜¯ä¸€ä¸ªç½‘ç»œçš„å°è£…ï¼ŒåŒ…å«ç½‘ç»œå„å±‚å®šä¹‰ä»¥åŠforwardæ–¹æ³•ï¼Œè°ƒç”¨forward(input)æ–¹æ³•ï¼Œå¯è¿”å›å‰å‘ä¼ æ’­çš„ç»“æœã€‚ä¸‹é¢å°±ä»¥æœ€æ—©çš„å·ç§¯ç¥ç»ç½‘ç»œï¼šLeNetä¸ºä¾‹ï¼Œæ¥çœ‹çœ‹å¦‚ä½•ç”¨<code>nn.Module</code>å®ç°ã€‚LeNetçš„ç½‘ç»œç»“æ„å¦‚å›¾æ‰€ç¤ºã€‚</p><p><a href="https://imgtu.com/i/fK1XqS" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/07/fK1XqS.png" alt="LeNetç½‘ç»œç»“æ„"></a></p><p>è¿™æ˜¯ä¸€ä¸ªåŸºç¡€çš„å‰å‘ä¼ æ’­(feed-forward)ç½‘ç»œ: æ¥æ”¶è¾“å…¥ï¼Œç»è¿‡å±‚å±‚ä¼ é€’è¿ç®—ï¼Œå¾—åˆ°è¾“å‡ºã€‚</p><h4 id="å®šä¹‰ç½‘ç»œ"><a href="#å®šä¹‰ç½‘ç»œ" class="headerlink" title="å®šä¹‰ç½‘ç»œ"></a>å®šä¹‰ç½‘ç»œ</h4><p>å®šä¹‰ç½‘ç»œæ—¶ï¼Œéœ€è¦ç»§æ‰¿<code>nn.Module</code>ï¼Œå¹¶å®ç°å®ƒçš„forwardæ–¹æ³•ï¼ŒæŠŠç½‘ç»œä¸­å…·æœ‰å¯å­¦ä¹ å‚æ•°çš„å±‚æ”¾åœ¨æ„é€ å‡½æ•°<code>__init__</code>ä¸­ã€‚å¦‚æœæŸä¸€å±‚(å¦‚ReLU)ä¸å…·æœ‰å¯å­¦ä¹ çš„å‚æ•°ï¼Œåˆ™æ—¢å¯ä»¥æ”¾åœ¨æ„é€ å‡½æ•°ä¸­ï¼Œä¹Ÿå¯ä»¥ä¸æ”¾ï¼Œä½†å»ºè®®ä¸æ”¾åœ¨å…¶ä¸­ï¼Œè€Œåœ¨forwardä¸­ä½¿ç”¨<code>nn.functional</code>ä»£æ›¿ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>functional <span class="token keyword">as</span> F<span class="token keyword">class</span> <span class="token class-name">Net</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># nn.Moduleå­ç±»çš„å‡½æ•°å¿…é¡»åœ¨æ„é€ å‡½æ•°ä¸­æ‰§è¡Œçˆ¶ç±»çš„æ„é€ å‡½æ•°</span>        <span class="token comment" spellcheck="true"># ä¸‹å¼ç­‰ä»·äºnn.Module.__init__(self)</span>        super<span class="token punctuation">(</span>Net<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># å·ç§¯å±‚ '1'è¡¨ç¤ºè¾“å…¥å›¾ç‰‡ä¸ºå•é€šé“, '6'è¡¨ç¤ºè¾“å‡ºé€šé“æ•°ï¼Œ'5'è¡¨ç¤ºå·ç§¯æ ¸ä¸º5*5</span>        self<span class="token punctuation">.</span>conv1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>         <span class="token comment" spellcheck="true"># å·ç§¯å±‚</span>        self<span class="token punctuation">.</span>conv2 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>         <span class="token comment" spellcheck="true"># ä»¿å°„å±‚/å…¨è¿æ¥å±‚ï¼Œy = Wx + b</span>        self<span class="token punctuation">.</span>fc1   <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">16</span><span class="token operator">*</span><span class="token number">5</span><span class="token operator">*</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">)</span>         self<span class="token punctuation">.</span>fc2   <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>fc3   <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>         <span class="token comment" spellcheck="true"># å·ç§¯ -> æ¿€æ´» -> æ± åŒ– </span>        x <span class="token operator">=</span> F<span class="token punctuation">.</span>max_pool2d<span class="token punctuation">(</span>F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv1<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        x <span class="token operator">=</span> F<span class="token punctuation">.</span>max_pool2d<span class="token punctuation">(</span>F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv2<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>         <span class="token comment" spellcheck="true"># reshapeï¼Œâ€˜-1â€™è¡¨ç¤ºè‡ªé€‚åº”</span>        x <span class="token operator">=</span> x<span class="token punctuation">.</span>view<span class="token punctuation">(</span>x<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>         x <span class="token operator">=</span> F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>fc1<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>        x <span class="token operator">=</span> F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>fc2<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>        x <span class="token operator">=</span> self<span class="token punctuation">.</span>fc3<span class="token punctuation">(</span>x<span class="token punctuation">)</span>                <span class="token keyword">return</span> xnet <span class="token operator">=</span> Net<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>net<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥å¾—åˆ°ç»“æœï¼š</p><pre><code>Net(  (conv1): Conv2d(1, 6, kernel_size=(5, 5), stride=(1, 1))  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))  (fc1): Linear(in_features=400, out_features=120, bias=True)  (fc2): Linear(in_features=120, out_features=84, bias=True)  (fc3): Linear(in_features=84, out_features=10, bias=True))</code></pre><p>åªè¦åœ¨nn.Moduleçš„å­ç±»ä¸­å®šä¹‰äº†forwardå‡½æ•°ï¼Œbackwardå‡½æ•°å°±ä¼šè‡ªåŠ¨è¢«å®ç°(åˆ©ç”¨<code>autograd</code>)ã€‚åœ¨<code>forward</code> å‡½æ•°ä¸­å¯ä½¿ç”¨ä»»ä½•tensoræ”¯æŒçš„å‡½æ•°ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ifã€forå¾ªç¯ã€printã€logç­‰Pythonè¯­æ³•ï¼Œå†™æ³•å’Œæ ‡å‡†çš„Pythonå†™æ³•ä¸€è‡´ã€‚</p><p>ç½‘ç»œçš„å¯å­¦ä¹ å‚æ•°é€šè¿‡<code>net.parameters()</code>è¿”å›ï¼Œ<code>net.named_parameters</code>å¯åŒæ—¶è¿”å›å¯å­¦ä¹ çš„å‚æ•°åŠåç§°ã€‚</p><pre class="line-numbers language-python"><code class="language-python">params <span class="token operator">=</span> list<span class="token punctuation">(</span>net<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">for</span> name<span class="token punctuation">,</span>parameters <span class="token keyword">in</span> net<span class="token punctuation">.</span>named_parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span><span class="token string">':'</span><span class="token punctuation">,</span>parameters<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>forwardå‡½æ•°çš„è¾“å…¥å’Œè¾“å‡ºéƒ½æ˜¯Tensorã€‚input <span class="token operator">=</span> t<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span>out <span class="token operator">=</span> net<span class="token punctuation">(</span>input<span class="token punctuation">)</span>out<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span>net<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># æ‰€æœ‰å‚æ•°çš„æ¢¯åº¦æ¸…é›¶</span>out<span class="token punctuation">.</span>backward<span class="token punctuation">(</span>t<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># åå‘ä¼ æ’­</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œtorch.nnåªæ”¯æŒmini-batchesï¼Œä¸æ”¯æŒä¸€æ¬¡åªè¾“å…¥ä¸€ä¸ªæ ·æœ¬ï¼Œå³ä¸€æ¬¡å¿…é¡»æ˜¯ä¸€ä¸ªbatchã€‚ä½†å¦‚æœåªæƒ³è¾“å…¥ä¸€ä¸ªæ ·æœ¬ï¼Œåˆ™ç”¨ <code>input.unsqueeze(0)</code>å°†batch_sizeè®¾ä¸ºï¼‘ã€‚ä¾‹å¦‚ <code>nn.Conv2d</code> è¾“å…¥å¿…é¡»æ˜¯4ç»´çš„ï¼Œå½¢å¦‚$nSamples \times nChannels \times Height \times Width$ã€‚å¯å°†nSampleè®¾ä¸º1ï¼Œå³$1 \times nChannels \times Height \times Width$ã€‚</p><h4 id="æŸå¤±å‡½æ•°"><a href="#æŸå¤±å‡½æ•°" class="headerlink" title="æŸå¤±å‡½æ•°"></a>æŸå¤±å‡½æ•°</h4><p>nnå®ç°äº†ç¥ç»ç½‘ç»œä¸­å¤§å¤šæ•°çš„æŸå¤±å‡½æ•°ï¼Œä¾‹å¦‚nn.MSELossç”¨æ¥è®¡ç®—å‡æ–¹è¯¯å·®ï¼Œnn.CrossEntropyLossç”¨æ¥è®¡ç®—äº¤å‰ç†µæŸå¤±ã€‚</p><pre class="line-numbers language-python"><code class="language-python">output <span class="token operator">=</span> net<span class="token punctuation">(</span>input<span class="token punctuation">)</span>target <span class="token operator">=</span> t<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>float<span class="token punctuation">(</span><span class="token punctuation">)</span> criterion <span class="token operator">=</span> nn<span class="token punctuation">.</span>MSELoss<span class="token punctuation">(</span><span class="token punctuation">)</span>loss <span class="token operator">=</span> criterion<span class="token punctuation">(</span>output<span class="token punctuation">,</span> target<span class="token punctuation">)</span>loss <span class="token comment" spellcheck="true"># lossæ˜¯ä¸ªscalar</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœå¯¹lossè¿›è¡Œåå‘ä¼ æ’­æº¯æº(ä½¿ç”¨<code>gradfn</code>å±æ€§)ï¼Œå¯çœ‹åˆ°å®ƒçš„è®¡ç®—å›¾å¦‚ä¸‹ï¼š</p><pre><code>input -&gt; conv2d -&gt; relu -&gt; maxpool2d -&gt; conv2d -&gt; relu -&gt; maxpool2d        -&gt; view -&gt; linear -&gt; relu -&gt; linear -&gt; relu -&gt; linear       -&gt; MSELoss      -&gt; loss</code></pre><p>å½“è°ƒç”¨<code>loss.backward()</code>æ—¶ï¼Œè¯¥å›¾ä¼šåŠ¨æ€ç”Ÿæˆå¹¶è‡ªåŠ¨å¾®åˆ†ï¼Œä¹Ÿå³ä¼šè‡ªåŠ¨è®¡ç®—å›¾ä¸­å‚æ•°(Parameter)çš„å¯¼æ•°ã€‚</p><h4 id="è¿è¡Œ-backwardï¼Œè§‚å¯Ÿè°ƒç”¨ä¹‹å‰å’Œè°ƒç”¨ä¹‹åçš„grad"><a href="#è¿è¡Œ-backwardï¼Œè§‚å¯Ÿè°ƒç”¨ä¹‹å‰å’Œè°ƒç”¨ä¹‹åçš„grad" class="headerlink" title="è¿è¡Œ.backwardï¼Œè§‚å¯Ÿè°ƒç”¨ä¹‹å‰å’Œè°ƒç”¨ä¹‹åçš„grad"></a>è¿è¡Œ.backwardï¼Œè§‚å¯Ÿè°ƒç”¨ä¹‹å‰å’Œè°ƒç”¨ä¹‹åçš„grad</h4><pre class="line-numbers language-python"><code class="language-python">net<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># æŠŠnetä¸­æ‰€æœ‰å¯å­¦ä¹ å‚æ•°çš„æ¢¯åº¦æ¸…é›¶</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'åå‘ä¼ æ’­ä¹‹å‰ conv1.biasçš„æ¢¯åº¦'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>net<span class="token punctuation">.</span>conv1<span class="token punctuation">.</span>bias<span class="token punctuation">.</span>grad<span class="token punctuation">)</span>loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'åå‘ä¼ æ’­ä¹‹å conv1.biasçš„æ¢¯åº¦'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>net<span class="token punctuation">.</span>conv1<span class="token punctuation">.</span>bias<span class="token punctuation">.</span>grad<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»“æœï¼š</p><pre><code>åå‘ä¼ æ’­ä¹‹å‰ conv1.biasçš„æ¢¯åº¦tensor([0., 0., 0., 0., 0., 0.])åå‘ä¼ æ’­ä¹‹å conv1.biasçš„æ¢¯åº¦tensor([ 0.1366,  0.0885, -0.0036,  0.1410,  0.0144,  0.0562])</code></pre><h4 id="ä¼˜åŒ–å™¨"><a href="#ä¼˜åŒ–å™¨" class="headerlink" title="ä¼˜åŒ–å™¨"></a>ä¼˜åŒ–å™¨</h4><p>åœ¨åå‘ä¼ æ’­è®¡ç®—å®Œæ‰€æœ‰å‚æ•°çš„æ¢¯åº¦åï¼Œè¿˜éœ€è¦ä½¿ç”¨ä¼˜åŒ–æ–¹æ³•æ¥æ›´æ–°ç½‘ç»œçš„æƒé‡å’Œå‚æ•°ï¼Œä¾‹å¦‚éšæœºæ¢¯åº¦ä¸‹é™æ³•(SGD)çš„æ›´æ–°ç­–ç•¥å¦‚ä¸‹ï¼š</p><pre><code>weight = weight - learning_rate * gradient</code></pre><p>æ‰‹åŠ¨å®ç°å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">learning_rate <span class="token operator">=</span> <span class="token number">0.01</span><span class="token keyword">for</span> f <span class="token keyword">in</span> net<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    f<span class="token punctuation">.</span>data<span class="token punctuation">.</span>sub_<span class="token punctuation">(</span>f<span class="token punctuation">.</span>grad<span class="token punctuation">.</span>data <span class="token operator">*</span> learning_rate<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># inplace å‡æ³•</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><code>torch.optim</code>ä¸­å®ç°äº†æ·±åº¦å­¦ä¹ ä¸­ç»å¤§å¤šæ•°çš„ä¼˜åŒ–æ–¹æ³•ï¼Œä¾‹å¦‚RMSPropã€Adamã€SGDç­‰ï¼Œæ›´ä¾¿äºä½¿ç”¨ï¼Œå› æ­¤å¤§å¤šæ•°æ—¶å€™å¹¶ä¸éœ€è¦æ‰‹åŠ¨å†™ä¸Šè¿°ä»£ç ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> torch<span class="token punctuation">.</span>optim <span class="token keyword">as</span> optim<span class="token comment" spellcheck="true">#æ–°å»ºä¸€ä¸ªä¼˜åŒ–å™¨ï¼ŒæŒ‡å®šè¦è°ƒæ•´çš„å‚æ•°å’Œå­¦ä¹ ç‡</span>optimizer <span class="token operator">=</span> optim<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span>net<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr <span class="token operator">=</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="æ¢¯åº¦æ¸…é›¶-ä¸net-zero-grad-æ•ˆæœä¸€æ ·"><a href="#æ¢¯åº¦æ¸…é›¶-ä¸net-zero-grad-æ•ˆæœä¸€æ ·" class="headerlink" title="æ¢¯åº¦æ¸…é›¶(ä¸net.zero_grad()æ•ˆæœä¸€æ ·)"></a>æ¢¯åº¦æ¸…é›¶(ä¸net.zero_grad()æ•ˆæœä¸€æ ·)</h4><pre class="line-numbers language-python"><code class="language-python">optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span> <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="è®¡ç®—æŸå¤±"><a href="#è®¡ç®—æŸå¤±" class="headerlink" title="è®¡ç®—æŸå¤±"></a>è®¡ç®—æŸå¤±</h4><pre class="line-numbers language-python"><code class="language-python">output <span class="token operator">=</span> net<span class="token punctuation">(</span>input<span class="token punctuation">)</span>loss <span class="token operator">=</span> criterion<span class="token punctuation">(</span>output<span class="token punctuation">,</span> target<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#åå‘ä¼ æ’­</span>loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#æ›´æ–°å‚æ•°</span>optimizer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å®šä¹‰ç½‘ç»œ-1"><a href="#å®šä¹‰ç½‘ç»œ-1" class="headerlink" title="å®šä¹‰ç½‘ç»œ"></a>å®šä¹‰ç½‘ç»œ</h2><p>æ‹·è´ä¸Šé¢çš„LeNetç½‘ç»œï¼Œä¿®æ”¹self.conv1ç¬¬ä¸€ä¸ªå‚æ•°ä¸º3é€šé“ï¼Œå› CIFAR-10æ˜¯3é€šé“å½©å›¾ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Net</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> None<span class="token punctuation">:</span>        super<span class="token punctuation">(</span>Net<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>conv1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>conv2 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>fc1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>fc2 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>fc3 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>        x <span class="token operator">=</span> F<span class="token punctuation">.</span>max_pool2d<span class="token punctuation">(</span>F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv1<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        x <span class="token operator">=</span> F<span class="token punctuation">.</span>max_pool2d<span class="token punctuation">(</span>F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv2<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>        x <span class="token operator">=</span> x<span class="token punctuation">.</span>view<span class="token punctuation">(</span>x<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>        x <span class="token operator">=</span> F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>fc1<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>        x <span class="token operator">=</span> F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>fc2<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>        x <span class="token operator">=</span> self<span class="token punctuation">.</span>fc3<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        <span class="token keyword">return</span> xnet <span class="token operator">=</span> Net<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>net<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è¯¯å·®æŸå¤±ä¸ä¼˜åŒ–å™¨"><a href="#è¯¯å·®æŸå¤±ä¸ä¼˜åŒ–å™¨" class="headerlink" title="è¯¯å·®æŸå¤±ä¸ä¼˜åŒ–å™¨"></a>è¯¯å·®æŸå¤±ä¸ä¼˜åŒ–å™¨</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># è¯¯å·®</span>criterion <span class="token operator">=</span> nn<span class="token punctuation">.</span>CrossEntropyLoss<span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true"># é‡‡ç”¨äº¤å‰ç†µ</span><span class="token comment" spellcheck="true"># ä¼˜åŒ–å™¨</span>optimizer <span class="token operator">=</span> optim<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span>net<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">,</span> momentum<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true"># SGDä¼˜åŒ–ç®—æ³•</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è®­ç»ƒè¿‡ç¨‹"><a href="#è®­ç»ƒè¿‡ç¨‹" class="headerlink" title="è®­ç»ƒè¿‡ç¨‹"></a>è®­ç»ƒè¿‡ç¨‹</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># è®­ç»ƒç½‘ç»œ</span>epoches <span class="token operator">=</span> <span class="token number">3</span>t<span class="token punctuation">.</span>set_num_threads<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true"># è®¾ç½®pytorchå¤šçº¿ç¨‹è¿ç®—æ—¶å ç”¨çš„cpuçº¿ç¨‹æ•°</span><span class="token keyword">for</span> epoch <span class="token keyword">in</span> range<span class="token punctuation">(</span>epoches<span class="token punctuation">)</span><span class="token punctuation">:</span>    running_loss <span class="token operator">=</span> <span class="token number">0.0</span>    <span class="token keyword">for</span> i<span class="token punctuation">,</span> data <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>trainloader<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        images<span class="token punctuation">,</span> labels <span class="token operator">=</span> data        target <span class="token operator">=</span> net<span class="token punctuation">(</span>images<span class="token punctuation">)</span>        loss <span class="token operator">=</span> criterion<span class="token punctuation">(</span>target<span class="token punctuation">,</span> labels<span class="token punctuation">)</span>        loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>        optimizer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>        optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>        running_loss <span class="token operator">+=</span> loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> i <span class="token operator">%</span> <span class="token number">1999</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>f<span class="token string">'epoch: {epoch+1}   samples: {i/1999 * 2000} loss: {running_loss / 20000}'</span><span class="token punctuation">)</span>            running_loss <span class="token operator">=</span> <span class="token number">0.0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><a href="https://imgtu.com/i/fKcNk9" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/07/fKcNk9.png" alt></a></p><h2 id="è¯†åˆ«æ­£ç¡®ç‡"><a href="#è¯†åˆ«æ­£ç¡®ç‡" class="headerlink" title="è¯†åˆ«æ­£ç¡®ç‡"></a>è¯†åˆ«æ­£ç¡®ç‡</h2><p>æœ€ç»ˆè¯†åˆ«æ­£ç¡®ç‡å˜›â€¦â€¦ä¹Ÿä¸æ˜¯å¾ˆé«˜ï¼Œ58%ï¼Œæ²¡æœ‰å¾ˆé«˜,<del>ä¸è¿‡æ¯”éšä¾¿çŒœå¾—åˆ°çš„10%è¿˜æ˜¯å¥½å¾ˆå¤šçš„</del>ã€‚</p><pre class="line-numbers language-python"><code class="language-python">correct <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment" spellcheck="true"># é¢„æµ‹æ­£ç¡®çš„å›¾ç‰‡æ•°</span>total <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment" spellcheck="true"># æ€»å…±çš„å›¾ç‰‡æ•°</span><span class="token comment" spellcheck="true"># ç”±äºæµ‹è¯•çš„æ—¶å€™ä¸éœ€è¦æ±‚å¯¼ï¼Œå¯ä»¥æš‚æ—¶å…³é—­autogradï¼Œæé«˜é€Ÿåº¦ï¼ŒèŠ‚çº¦å†…å­˜</span><span class="token keyword">with</span> t<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> data <span class="token keyword">in</span> testloader<span class="token punctuation">:</span>        images<span class="token punctuation">,</span> labels <span class="token operator">=</span> data        outputs <span class="token operator">=</span> net<span class="token punctuation">(</span>images<span class="token punctuation">)</span>        _<span class="token punctuation">,</span> predicted <span class="token operator">=</span> t<span class="token punctuation">.</span>max<span class="token punctuation">(</span>outputs<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>        total <span class="token operator">+=</span> labels<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>        correct <span class="token operator">+=</span> <span class="token punctuation">(</span>predicted <span class="token operator">==</span> labels<span class="token punctuation">)</span><span class="token punctuation">.</span>sum<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'10000å¼ æµ‹è¯•é›†ä¸­çš„å‡†ç¡®ç‡ä¸º: %d %%'</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token number">100</span> <span class="token operator">*</span> correct <span class="token operator">/</span> total<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://imgtu.com/i/fKc46f" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/07/fKc46f.png" alt></a></p><p>å®Œç»“æ’’èŠ±â€â€â€â€â€â€â€â€â€â€â€ï¼</p>]]></content>
      
      
      <categories>
          
          <category> pytorch </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> pytorch </tag>
            
            <tag> ç¥ç»ç½‘ç»œ </tag>
            
            <tag> æœºå™¨å­¦ä¹  </tag>
            
            <tag> CNN </tag>
            
            <tag> CIFAR10 </tag>
            
            <tag> LeNet </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CIFAR10 dataset and reading</title>
      <link href="/2021/08/06/cifar10-shu-ju-ji-ji-du-qu/"/>
      <url>/2021/08/06/cifar10-shu-ju-ji-ji-du-qu/</url>
      
        <content type="html"><![CDATA[<h2 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h2><hr><p><em>I used the MNIST data set to practice before, and the most common python operation was used to read. This time I learned CNN and started to contact the DIFAR-10 data set and tried to use the framework pytorch to read data for classification.</em></p><p><em>ç”±äºå¤§å¤šæ•°è®ºæ–‡éƒ½æ˜¯è‹±æ–‡ï¼Œæ‰€ä»¥æœ¬æ–‡å°½é‡ä½¿ç”¨è‹±æ–‡æè¿°</em></p><p><em>Since most papers are in English, this article tries to use English descriptions as much as possible</em></p><h2 id="CIFAR-10Dataset"><a href="#CIFAR-10Dataset" class="headerlink" title="CIFAR-10Dataset"></a>CIFAR-10Dataset</h2><hr><p><a href="https://www.cs.toronto.edu/~kriz/cifar.html" target="_blank" rel="noopener">CIFAR-10</a>The CIFAR-10 dataset consists of 60000 32x32 colour images in 10 classes, with 6000 images per class. There are 50000 training images and 10000 test images.</p><p>The dataset is divided into five training batches and one test batch, each with 10000 images. The test batch contains exactly 1000 randomly-selected images from each class. The training batches contain the remaining images in random order, but some training batches may contain more images from one class than another. Between them, the training batches contain exactly 5000 images from each class.</p><p>Here are the classes in the dataset, as well as 10 random images from each:</p><table><thead><tr><th>airplane</th><th><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/airplane1.png" alt="img"></th><th><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/airplane2.png" alt="img"></th><th><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/airplane3.png" alt="img"></th><th><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/airplane4.png" alt="img"></th><th><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/airplane5.png" alt="img"></th><th><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/airplane6.png" alt="img"></th><th><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/airplane7.png" alt="img"></th><th><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/airplane8.png" alt="img"></th><th><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/airplane9.png" alt="img"></th><th><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/airplane10.png" alt="img"></th></tr></thead><tbody><tr><td>automobile</td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/automobile1.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/automobile2.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/automobile3.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/automobile4.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/automobile5.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/automobile6.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/automobile7.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/automobile8.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/automobile9.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/automobile10.png" alt="img"></td></tr><tr><td>bird</td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/bird1.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/bird2.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/bird3.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/bird4.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/bird5.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/bird6.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/bird7.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/bird8.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/bird9.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/bird10.png" alt="img"></td></tr><tr><td>cat</td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/cat1.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/cat2.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/cat3.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/cat4.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/cat5.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/cat6.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/cat7.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/cat8.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/cat9.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/cat10.png" alt="img"></td></tr><tr><td>deer</td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/deer1.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/deer2.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/deer3.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/deer4.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/deer5.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/deer6.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/deer7.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/deer8.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/deer9.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/deer10.png" alt="img"></td></tr><tr><td>dog</td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/dog1.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/dog2.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/dog3.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/dog4.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/dog5.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/dog6.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/dog7.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/dog8.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/dog9.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/dog10.png" alt="img"></td></tr><tr><td>frog</td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/frog1.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/frog2.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/frog3.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/frog4.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/frog5.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/frog6.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/frog7.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/frog8.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/frog9.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/frog10.png" alt="img"></td></tr><tr><td>horse</td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/horse1.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/horse2.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/horse3.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/horse4.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/horse5.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/horse6.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/horse7.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/horse8.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/horse9.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/horse10.png" alt="img"></td></tr><tr><td>ship</td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/ship1.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/ship2.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/ship3.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/ship4.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/ship5.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/ship6.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/ship7.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/ship8.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/ship9.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/ship10.png" alt="img"></td></tr><tr><td>truck</td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/truck1.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/truck2.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/truck3.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/truck4.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/truck5.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/truck6.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/truck7.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/truck8.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/truck9.png" alt="img"></td><td><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.cs.toronto.edu/~kriz/cifar-10-sample/truck10.png" alt="img"></td></tr></tbody></table><p>The classes are completely mutually exclusive(å®Œå…¨äº’æ–¥çš„ï¼‰. There is no overlapï¼ˆé‡å ï¼‰ between automobiles and trucks. â€œAutomobileâ€ includes sedans, SUVs, things of that sort. â€œTruckâ€ includes only big trucks. Neither includes pickup trucks.</p><p>There are three versions of this dataset for python, matlab and binary.</p><p>If you have downloaded the version for python,  you unzip the .zip file look like this:</p><p><a href="https://imgtu.com/i/fnvqf0" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/06/fnvqf0.png" alt></a></p><p>The archive contains the files data_batch_1, data_batch_2, â€¦, data_batch_5, as well as test_batch. Each of these files is a Python â€œpickledâ€ object produced with <a href="http://www.python.org/doc/2.5/lib/module-cPickle.html" target="_blank" rel="noopener">cPickle</a>. Here is a python3 routine which will open such a file and return a dictionary:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">unpickle</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">import</span> pickle    <span class="token keyword">with</span> open<span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fo<span class="token punctuation">:</span>        dict <span class="token operator">=</span> pickle<span class="token punctuation">.</span>load<span class="token punctuation">(</span>fo<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'bytes'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> dict<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Loaded in this way, each of the batch files contains a dictionary with the following elements:</p><ul><li><strong>data</strong> â€“ a 10000x3072 <a href="http://numpy.scipy.org/" target="_blank" rel="noopener">numpy</a> array of uint8s. Each row of the array stores a 32x32 colour image. The first 1024 entries contain the red channel values, the next 1024 the green, and the final 1024 the blue. The image is stored in row-major order, so that the first 32 entries of the array are the red channel values of the first row of the image.</li><li><strong>labels</strong> â€“ a list of 10000 numbers in the range 0-9. The number at index <em>i</em> indicates the label of the <em>i</em>th image in the array <strong>data</strong>.</li></ul><p>The dataset contains another file, called batches.meta. It too contains a Python dictionary object. It has the following entries:</p><ul><li><strong>label_names</strong> â€“ a 10-element list which gives meaningful names to the numeric labels in the <strong>labels</strong> array described above. For example, label_names[0] == â€œairplaneâ€, label_names[1] == â€œautomobileâ€, etc.</li></ul><p>The above is all the introduction of CIFAR-10.</p><h2 id="read-the-dataset-by-Pytorch"><a href="#read-the-dataset-by-Pytorch" class="headerlink" title="read the dataset by Pytorch"></a>read the dataset by Pytorch</h2><hr><h3 id="Preface-1"><a href="#Preface-1" class="headerlink" title="Preface"></a>Preface</h3><p>Before, I often use some simple python codes to read the dataset such as MNIST, sonar and so on. Today, I begin to learning pytorch, finding the torchvision.datasets, and the specific methods of reading datasets of pytorch. Itâ€™s amazing and simple. I will explore the use of it with all of you guys as follows.</p><p>All datasets are subclasses of <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" target="_blank" rel="noopener"><code>torch.utils.data.Dataset</code></a> i.e, they have <code>__getitem__</code> and <code>__len__</code> methods implemented. Hence, they can all be passed to a <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" target="_blank" rel="noopener"><code>torch.utils.data.DataLoader</code></a> which can load multiple samples in parallel using <code>torch.multiprocessing</code> workers. For example:</p><pre class="line-numbers language-python"><code class="language-python">imagenet_data <span class="token operator">=</span> torchvision<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>ImageNet<span class="token punctuation">(</span><span class="token string">'path/to/imagenet_root/'</span><span class="token punctuation">)</span>data_loader <span class="token operator">=</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>imagenet_data<span class="token punctuation">,</span>                                          batch_size<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>                                          shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                                          num_workers<span class="token operator">=</span>args<span class="token punctuation">.</span>nThreads<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>All the datasets have almost similar API. They all have two common arguments: <code>transform</code> and <code>target_transform</code> to transform the input and target respectively(è¿™ä¸¤ä¸ªæ˜¯å›¾ç‰‡å¢å¼º). We can also create our own datasets using the provided <a href="https://pytorch.org/vision/stable/datasets.html#base-classes-datasets" target="_blank" rel="noopener">base classes</a></p><h3 id="Transforms-Compose-about-data-preprocessing"><a href="#Transforms-Compose-about-data-preprocessing" class="headerlink" title="Transforms.Compose()   about data preprocessing"></a>Transforms.Compose()   about data preprocessing</h3><h4 id="In-this-case"><a href="#In-this-case" class="headerlink" title="In this case"></a>In this case</h4><p>Usually we use the torchvision.transforms.Compose() to preprocessing the data we need. There are few parameters about this function. In this case, we use this function like this:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> torchvision<span class="token punctuation">.</span>transforms <span class="token keyword">as</span> transforms<span class="token comment" spellcheck="true"># data preprocessing</span>transform <span class="token operator">=</span> transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span><span class="token punctuation">[</span>    transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">,</span>    trasforms<span class="token punctuation">.</span>Normalize<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true"># the fronter is the mean of normalize, the later is the standard deviation('æ ‡å‡†å·®' in Chinese)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="whatâ€™s-more"><a href="#whatâ€™s-more" class="headerlink" title="whatâ€™s more"></a>whatâ€™s more</h4><p>Whatâ€™s more, the function has many useful parameters, we could find the related examples in this <a href="https://www.programcreek.com/python/example/104832/torchvision.transforms.Compose" target="_blank" rel="noopener">website</a>. And as follows,  I will list some examples in this website:</p><h5 id="example-1"><a href="#example-1" class="headerlink" title="example 1"></a>example 1</h5><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">load_data</span><span class="token punctuation">(</span>root_path<span class="token punctuation">,</span> dir<span class="token punctuation">,</span> batch_size<span class="token punctuation">,</span> phase<span class="token punctuation">)</span><span class="token punctuation">:</span>    transform_dict <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">'src'</span><span class="token punctuation">:</span> transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span>        <span class="token punctuation">[</span>transforms<span class="token punctuation">.</span>RandomResizedCrop<span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">,</span>         transforms<span class="token punctuation">.</span>RandomHorizontalFlip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>         transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>         transforms<span class="token punctuation">.</span>Normalize<span class="token punctuation">(</span>mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.485</span><span class="token punctuation">,</span> <span class="token number">0.456</span><span class="token punctuation">,</span> <span class="token number">0.406</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                              std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.229</span><span class="token punctuation">,</span> <span class="token number">0.224</span><span class="token punctuation">,</span> <span class="token number">0.225</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>         <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        <span class="token string">'tar'</span><span class="token punctuation">:</span> transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span>        <span class="token punctuation">[</span>transforms<span class="token punctuation">.</span>Resize<span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">,</span>         transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>         transforms<span class="token punctuation">.</span>Normalize<span class="token punctuation">(</span>mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.485</span><span class="token punctuation">,</span> <span class="token number">0.456</span><span class="token punctuation">,</span> <span class="token number">0.406</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                              std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.229</span><span class="token punctuation">,</span> <span class="token number">0.224</span><span class="token punctuation">,</span> <span class="token number">0.225</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>         <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">}</span>    data <span class="token operator">=</span> datasets<span class="token punctuation">.</span>ImageFolder<span class="token punctuation">(</span>root<span class="token operator">=</span>root_path <span class="token operator">+</span> dir<span class="token punctuation">,</span> transform<span class="token operator">=</span>transform_dict<span class="token punctuation">[</span>phase<span class="token punctuation">]</span><span class="token punctuation">)</span>    data_loader <span class="token operator">=</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>data<span class="token punctuation">,</span> batch_size<span class="token operator">=</span>batch_size<span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> drop_last<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> num_workers<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> data_loader<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="example-2"><a href="#example-2" class="headerlink" title="example 2"></a>example 2</h5><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_data_loader</span><span class="token punctuation">(</span>opt<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token keyword">if</span> opt<span class="token punctuation">.</span>dset_name <span class="token operator">==</span> <span class="token string">'moving_mnist'</span><span class="token punctuation">:</span>    transform <span class="token operator">=</span> transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span><span class="token punctuation">[</span>vtransforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    dset <span class="token operator">=</span> MovingMNIST<span class="token punctuation">(</span>opt<span class="token punctuation">.</span>dset_path<span class="token punctuation">,</span> opt<span class="token punctuation">.</span>is_train<span class="token punctuation">,</span> opt<span class="token punctuation">.</span>n_frames_input<span class="token punctuation">,</span>                       opt<span class="token punctuation">.</span>n_frames_output<span class="token punctuation">,</span> opt<span class="token punctuation">.</span>num_objects<span class="token punctuation">,</span> transform<span class="token punctuation">)</span>  <span class="token keyword">elif</span> opt<span class="token punctuation">.</span>dset_name <span class="token operator">==</span> <span class="token string">'bouncing_balls'</span><span class="token punctuation">:</span>    transform <span class="token operator">=</span> transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span><span class="token punctuation">[</span>vtransforms<span class="token punctuation">.</span>Scale<span class="token punctuation">(</span>opt<span class="token punctuation">.</span>image_size<span class="token punctuation">)</span><span class="token punctuation">,</span>                                    vtransforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    dset <span class="token operator">=</span> BouncingBalls<span class="token punctuation">(</span>opt<span class="token punctuation">.</span>dset_path<span class="token punctuation">,</span> opt<span class="token punctuation">.</span>is_train<span class="token punctuation">,</span> opt<span class="token punctuation">.</span>n_frames_input<span class="token punctuation">,</span>                         opt<span class="token punctuation">.</span>n_frames_output<span class="token punctuation">,</span> opt<span class="token punctuation">.</span>image_size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> transform<span class="token punctuation">)</span>  <span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token keyword">raise</span> NotImplementedError  dloader <span class="token operator">=</span> data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>dset<span class="token punctuation">,</span> batch_size<span class="token operator">=</span>opt<span class="token punctuation">.</span>batch_size<span class="token punctuation">,</span> shuffle<span class="token operator">=</span>opt<span class="token punctuation">.</span>is_train<span class="token punctuation">,</span>                            num_workers<span class="token operator">=</span>opt<span class="token punctuation">.</span>n_workers<span class="token punctuation">,</span> pin_memory<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token keyword">return</span> dloader<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="example-3"><a href="#example-3" class="headerlink" title="example 3"></a>example 3</h5><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">transform_for_train</span><span class="token punctuation">(</span>fixed_scale <span class="token operator">=</span> <span class="token number">512</span><span class="token punctuation">,</span> rotate_prob <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    Options:    1.RandomCrop    2.CenterCrop    3.RandomHorizontalFlip    4.Normalize    5.ToTensor    6.FixedResize    7.RandomRotate    """</span>    transform_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>     <span class="token comment" spellcheck="true">#transform_list.append(FixedResize(size = (fixed_scale, fixed_scale)))</span>    transform_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>RandomSized<span class="token punctuation">(</span>fixed_scale<span class="token punctuation">)</span><span class="token punctuation">)</span>    transform_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>RandomRotate<span class="token punctuation">(</span>rotate_prob<span class="token punctuation">)</span><span class="token punctuation">)</span>    transform_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>RandomHorizontalFlip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#transform_list.append(Normalize(mean=(0.5, 0.5, 0.5), std=(0.5, 0.5, 0.5)))</span>    transform_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Normalize<span class="token punctuation">(</span>mean<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.485</span><span class="token punctuation">,</span> <span class="token number">0.456</span><span class="token punctuation">,</span> <span class="token number">0.406</span><span class="token punctuation">)</span><span class="token punctuation">,</span> std<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.229</span><span class="token punctuation">,</span> <span class="token number">0.224</span><span class="token punctuation">,</span> <span class="token number">0.225</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    transform_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span>transform_list<span class="token punctuation">)</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Then let us explore the DataLoader of pytorch.</p><h3 id="Get-the-data"><a href="#Get-the-data" class="headerlink" title="Get the data"></a>Get the data</h3><p>We simply use the torchvision.datasets.CIFAR10() to get the data. The torchvision.datasets contains the dataset of CIFAR10. If we havenâ€™t downloaded the datasets before, we even use this to download the dataset(Simply make the bool truth of <code>download</code> as True).</p><p><em>load data just like this:</em></p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> torchvision <span class="token keyword">as</span> tv<span class="token keyword">import</span> torch <span class="token keyword">as</span> t<span class="token comment" spellcheck="true"># trainset</span>trainset <span class="token operator">=</span> tv<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>CIFAR10<span class="token punctuation">(</span>    root<span class="token operator">=</span><span class="token string">'/pytorch/Data/'</span><span class="token punctuation">,</span>    train<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>    download<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>    transform<span class="token operator">=</span>transform<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># testset</span>testset <span class="token operator">=</span> tv<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>CIFAR10<span class="token punctuation">(</span>    root<span class="token operator">=</span><span class="token string">'/pytorch/Data/'</span><span class="token punctuation">,</span>    train<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>    download<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>    transform<span class="token operator">=</span>transform<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>It is very simple! donâ€™t it ?</p><h3 id="DataLoader"><a href="#DataLoader" class="headerlink" title="DataLoader"></a>DataLoader</h3><h4 id="official"><a href="#official" class="headerlink" title="official"></a>official</h4><p>The relatively official description: Dataloader is an iterable object that splices each piece of data returned by the dataset into a batch, and provides multi-threaded acceleration optimization(å¤šçº¿ç¨‹ä¼˜åŒ–åŠ é€Ÿ) and data scrambling operations(æ•°æ®æ‰“ä¹±æ“ä½œ). After the program traverses all the data of the dataset, it also completes an iteration of the Dataloader.</p><h4 id="my-eyes"><a href="#my-eyes" class="headerlink" title="my eyes"></a>my eyes</h4><p>In my opinions, it is just a generator to load the data. Compare to the cycle of <code>for</code>,  the use of generator is more pythonic and advanced. In this case, we use this to load data like this:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> torch <span class="token keyword">as</span> ttrainloader <span class="token operator">=</span> t<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>    trainset<span class="token punctuation">,</span>  <span class="token comment" spellcheck="true"># the trainset we get before</span>    batch_size<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>    shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>    num_workers<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>testloader <span class="token operator">=</span> t<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>    trainset<span class="token punctuation">,</span>  <span class="token comment" spellcheck="true"># as the same</span>    batch_size<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>    shuffle<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>    num_workers<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Type-of-annotation"><a href="#Type-of-annotation" class="headerlink" title="Type of annotation"></a>Type of annotation</h3><p>For convenience,  the label of each img is numbers, so we should make a tuple of varieties(list is also ok) to get the variety of each img. Actually, it make no effects on the dataset.</p><pre class="line-numbers language-python"><code class="language-python">classes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'plane'</span><span class="token punctuation">,</span> <span class="token string">'car'</span><span class="token punctuation">,</span> <span class="token string">'bird'</span><span class="token punctuation">,</span> <span class="token string">'cat'</span><span class="token punctuation">,</span> <span class="token string">'deer'</span><span class="token punctuation">,</span> <span class="token string">'dog'</span><span class="token punctuation">,</span> <span class="token string">'frog'</span><span class="token punctuation">,</span> <span class="token string">'horse'</span><span class="token punctuation">,</span> <span class="token string">'ship'</span><span class="token punctuation">,</span> <span class="token string">'truck'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="Try-to-show-a-picture"><a href="#Try-to-show-a-picture" class="headerlink" title="Try to show a picture"></a>Try to show a picture</h3><p>We could get one data to watch the image.</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> torchvision<span class="token punctuation">.</span>transforms <span class="token keyword">import</span> ToPILImageshow <span class="token operator">=</span> ToPILImage<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> label<span class="token punctuation">)</span> <span class="token operator">=</span> trainset<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># get the 100th data</span><span class="token keyword">print</span><span class="token punctuation">(</span>classes<span class="token punctuation">[</span>label<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># get the variety of this data</span><span class="token comment" spellcheck="true"># (data + 1) / 2 : Restore the normalized data</span>show<span class="token punctuation">(</span><span class="token punctuation">(</span>data <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># height:100, width:100</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>we can get the output:</p><p>ship<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/06/fusmEn.png" alt></p><p>Just like this, we get the batch of data like this:</p><pre class="line-numbers language-python"><code class="language-python">dataiter <span class="token operator">=</span> iter<span class="token punctuation">(</span>trainloader<span class="token punctuation">)</span>images<span class="token punctuation">,</span> labels <span class="token operator">=</span> dataiter<span class="token punctuation">.</span>next<span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true"># each batch has 4 images</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'       '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>classes<span class="token punctuation">[</span>labels<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>show<span class="token punctuation">(</span>tv<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>make_grid<span class="token punctuation">(</span><span class="token punctuation">(</span>images <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>the output as follows:</p><p>ship                  bird                  bird               truck</p><p><a href="https://imgtu.com/i/fuckjO" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/06/fuckjO.png" alt></a></p><p>OK, thatâ€™s all! Thank you for reading!</p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®é›† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> pytorch </tag>
            
            <tag> æ•°æ®é›† </tag>
            
            <tag> ç¥ç»ç½‘ç»œ </tag>
            
            <tag> æœºå™¨å­¦ä¹  </tag>
            
            <tag> CNN </tag>
            
            <tag> python </tag>
            
            <tag> CIFAR10 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®—æ³•åˆ·é¢˜ä¹‹æ ˆç³»åˆ—P5788 å•è°ƒæ ˆ</title>
      <link href="/2021/08/04/suan-fa-shua-ti-zhi-zhan-xi-lie-p5788-dan-diao-zhan/"/>
      <url>/2021/08/04/suan-fa-shua-ti-zhi-zhan-xi-lie-p5788-dan-diao-zhan/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a><a href="https://www.luogu.com.cn/problem/P5788" target="_blank" rel="noopener">é¢˜ç›®</a>æè¿°</h2><hr><p>ç»™å‡ºé¡¹æ•°ä¸º nçš„æ•´æ•°æ•°åˆ— $a_{1 â€¦ n}$ã€‚</p><p>å®šä¹‰å‡½æ•° <em>f</em>(<em>i</em>) ä»£è¡¨æ•°åˆ—ä¸­ç¬¬ i<em>i</em> ä¸ªå…ƒç´ ä¹‹åç¬¬ä¸€ä¸ªå¤§äº <em>a**i</em> çš„å…ƒç´ çš„<strong>ä¸‹æ ‡</strong>ï¼Œè‹¥ä¸å­˜åœ¨ï¼Œåˆ™ f(i)=0ã€‚</p><p>è¯•æ±‚å‡º f<em>(1â€¦</em>n)ã€‚</p><p><a href="https://imgtu.com/i/fV9nYV" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/05/fV9nYV.png" alt></a></p><h2 id="æ€è·¯è§£æ"><a href="#æ€è·¯è§£æ" class="headerlink" title="æ€è·¯è§£æ"></a>æ€è·¯è§£æ</h2><hr><p>å®é™…ä¸Šè¿™ä¸€é“é¢˜å’Œå‰é¢é‚£ä¸€é“<a href="https://lry89757.github.io/2021/08/04/suan-fa-shua-ti-zhi-zhan-xi-lie-p1165-ri-zhi-fen-xi/">æ—¥å¿—åˆ†æ</a>æ˜¯éå¸¸åƒçš„ï¼Œä¸è¿‡è¿™é‡Œè¿™ä¸ªéœ€è¦æˆ‘ä»¬å…ˆå°†æ‰€æœ‰çš„æ•°å­—éƒ½è¯»è¿›a[3000005]ï¼Œè¯»è¿›æ¥ä¹‹åä»åå¾€å‰å¼€å§‹ï¼Œå®šä¹‰ä¸€ä¸ªè¾…åŠ©æ•°ç»„b[3000005]ç”¨æ¥å­˜å‚¨ç›¸åŒä½ç½®çš„æ•°æ¯”ä»–å¤§çš„ç¬¬ä¸€ä¸ªæ•°çš„ç´¢å¼•å€¼ï¼Œä»æœ€åä¸€ä¸ªæ•°å¼€å§‹ï¼Œæœ€åä¸€ä¸ªæ•°ä¸º0ï¼Œç„¶åå¾€å‰ï¼Œéšæ„ä¸€ä¸ªæ•°a[i]å…ˆåˆ¤æ–­æ˜¯å¦å®ƒæ¯”åé¢ç¬¬ä¸€ä¸ªæ•°a[i+1]å¤§ï¼Œå¦‚æœæ¯”åé¢ç¬¬ä¸€ä¸ªæ•°a[i+1]å°ï¼Œé‚£ä¹ˆé‚£ä¸ªè¾…åŠ©æ•°ç»„åªéœ€åœ¨è¯¥ä½ç½®å­˜å‚¨è¯¥ä½ç½®çš„ç´¢å¼• i+1 å°±è¡Œï¼›å¦‚æœå®ƒæ¯”å®ƒåé¢ç¬¬ä¸€ä¸ªæ•°a[i+1]å¤§æˆ–æ˜¯ç›¸ç­‰ï¼Œé‚£ä¹ˆå°±æ‰¾æ¯”å®ƒåé¢é‚£ä¸ªæ•°a[i+1]è¿˜å¤§çš„æ•°a[b[i+1]],ç”±äºæ˜¯ä»åå¾€å‰è¿›è¡Œçš„ï¼Œè¿™ä¸ªb[i+1]å·²ç»æ±‚å‡ºæ¥äº†ï¼Œå¦‚æœæˆ‘ä»¬çš„a[b[i+1]]ï¼Œä»ç„¶ä¸æ¯”a[i]å¤§ï¼Œé‚£ä¹ˆå°±ç»§ç»­æ‰¾a[b[b[i+1]]], å“ˆå“ˆå“ˆï¼Œæœ‰ç‚¹å¥—å¨ƒçš„æ„Ÿè§‰äº†ï¼Œå®é™…ä¸Šå°±æ˜¯æ‰¾æ¯”a[b[i+1]]è¿˜å¤§çš„ç¬¬ä¸€ä¸ªæ•°ï¼Œè¿™ä¹ˆä¾æ¬¡æ‰¾ä¸‹å»ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªæ¯”a[i]å¤§çš„æ•°ï¼Œå°†å…¶ç´¢å¼•å­˜å‚¨åˆ°b[i]ä¸Šï¼Œ æˆ–è€…ç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªb[j]ä¸º0ï¼Œé‚£ä¹ˆè¯´æ˜a[i]æ˜¯ç›®å‰æœ€å¤§æ•°ï¼Œæ²¡æœ‰æ¯”å®ƒæ›´å¤§çš„æ•°ï¼Œé‚£ä¹ˆå¯¹åº”çš„b[i]å°±ä¸º0ã€‚</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><hr><pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> _CRT_SECURE_NO_WARNINGS</span><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">3000002</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">// ç”¨æ¥å­˜å‚¨æ•°æ®</span><span class="token keyword">int</span> b<span class="token punctuation">[</span><span class="token number">3000002</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">// ç”¨æ¥å­˜å‚¨æˆ‘ä»¬çš„ç­”æ¡ˆ</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> n<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// æ€»å…±çš„ä¸ªæ•°</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// è¯»å–æ•°æ®</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    b<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> a<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">// å¦‚æœåé¢çš„ç¬¬ä¸€ä¸ªæ•°æ­£å¥½æ¯”ä»–å¤§</span>            b<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>        <span class="token punctuation">{</span>            <span class="token keyword">int</span> next <span class="token operator">=</span> b<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">>=</span> a<span class="token punctuation">[</span>next<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> next <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">// // å¦‚æœåé¢ç¬¬ä¸€ä¸ªæ•°æ²¡æœ‰æ¯”ä»–æ›´å¤§çš„æ•°ï¼Œé‚£ä¹ˆç›´æ¥èµ‹å€¼ä¸º0,å¦åˆ™å°±ä¸€ç›´æ‰¾æ¥ä¸‹æ¥çš„ç´¢å¼•ç›´åˆ°æ‰¾åˆ°0æˆ–è€…æ‰¾åˆ°åˆé€‚çš„æ•°ä¸ºæ­¢</span>                next <span class="token operator">=</span> b<span class="token punctuation">[</span>next<span class="token punctuation">]</span><span class="token punctuation">;</span>            b<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> next<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³•é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C </tag>
            
            <tag> æ ˆ </tag>
            
            <tag> æ´›è°· </tag>
            
            <tag> ç®—æ³• </tag>
            
            <tag> æ¨¡æ¿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®—æ³•åˆ·é¢˜ä¹‹æ ˆç³»åˆ—P1165-æ—¥å¿—åˆ†æ</title>
      <link href="/2021/08/04/suan-fa-shua-ti-zhi-zhan-xi-lie-p1165-ri-zhi-fen-xi/"/>
      <url>/2021/08/04/suan-fa-shua-ti-zhi-zhan-xi-lie-p1165-ri-zhi-fen-xi/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°:"></a><a href="https://www.luogu.com.cn/problem/P1165" target="_blank" rel="noopener">é¢˜ç›®</a>æè¿°:</h2><p><em>M</em> æµ·è¿å…¬å¸æœ€è¿‘è¦å¯¹æ——ä¸‹ä»“åº“çš„è´§ç‰©è¿›å‡ºæƒ…å†µè¿›è¡Œç»Ÿè®¡ã€‚ç›®å‰ä»–ä»¬æ‰€æ‹¥æœ‰çš„å”¯ä¸€è®°å½•å°±æ˜¯ä¸€ä¸ªè®°å½•é›†è£…ç®±è¿›å‡ºæƒ…å†µçš„æ—¥å¿—ã€‚è¯¥æ—¥å¿—è®°å½•äº†ä¸¤ç±»æ“ä½œï¼šç¬¬ä¸€ç±»æ“ä½œä¸ºé›†è£…ç®±å…¥åº“æ“ä½œï¼Œä»¥åŠè¯¥æ¬¡å…¥åº“çš„é›†è£…ç®±é‡é‡ï¼›ç¬¬äºŒç±»æ“ä½œä¸ºé›†è£…ç®±çš„å‡ºåº“æ“ä½œã€‚è¿™äº›è®°å½•éƒ½ä¸¥æ ¼æŒ‰æ—¶é—´é¡ºåºæ’åˆ—ã€‚é›†è£…ç®±å…¥åº“å’Œå‡ºåº“çš„è§„åˆ™ä¸ºå…ˆè¿›åå‡ºï¼Œå³æ¯æ¬¡å‡ºåº“æ“ä½œå‡ºåº“çš„é›†è£…ç®±ä¸ºå½“å‰åœ¨ä»“åº“é‡Œæ‰€æœ‰é›†è£…ç®±ä¸­æœ€æ™šå…¥åº“çš„é›†è£…ç®±ã€‚</p><p>å‡ºäºåˆ†æç›®çš„ï¼Œåˆ†æäººå‘˜åœ¨æ—¥å¿—ä¸­éšæœºæ’å…¥äº†è‹¥å¹²ç¬¬ä¸‰ç±»æ“ä½œâ€•â€•æŸ¥è¯¢æ“ä½œã€‚åˆ†ææ—¥å¿—æ—¶ï¼Œæ¯é‡åˆ°ä¸€æ¬¡æŸ¥è¯¢æ“ä½œï¼Œéƒ½è¦æŠ¥å‘Šå‡ºå½“å‰ä»“åº“ä¸­æœ€å¤§é›†è£…ç®±çš„é‡é‡ã€‚</p><p><a href="https://imgtu.com/i/fEvvCD" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/04/fEvvCD.png" alt></a></p><h2 id="æ€è·¯è§£æ"><a href="#æ€è·¯è§£æ" class="headerlink" title="æ€è·¯è§£æ"></a>æ€è·¯è§£æ</h2><hr><p>é¦–å…ˆæˆ‘ä»¬çŸ¥é“è¦ä½¿ç”¨ä¸€ä¸ªæ ˆæ¥å­˜å‚¨è¾“å…¥çš„é‡é‡ï¼Œä½†æ˜¯ç”±äºè¿™é‡Œæœ‰ç€ä¸€ä¸ªæ‰€è°“çš„æœ€å¤§å€¼çš„é™åˆ¶ï¼Œæˆ‘ä»¬è¦èƒ½éšæ—¶æŸ¥è¯¢æœ€å¤§å€¼ï¼Œæ‰€ä»¥åŒæ—¶è¿˜éœ€è¦æœ‰ç€ä¸€ä¸ªè¾…åŠ©æ ˆæ¥<strong>åŒæ­¥</strong>å­˜å‚¨æˆ‘ä»¬çš„å½“å‰å…ƒç´ ä½œä¸ºæ ˆé¡¶æ—¶çš„æœ€å¤§å€¼ï¼Œè¿™ä¸ªæ˜¯å»ºç«‹æ ˆçš„åŒæ—¶å»ºç«‹çš„è¾…åŠ©æ ˆï¼Œæœ€åæˆ‘ä»¬åªéœ€è¦æŸ¥è¯¢æ—¶è¾“å‡ºæ ˆé¡¶ï¼Œå‡ºåº“æ—¶æŠŠä¸¤ä¸ªæ ˆé¡¶éƒ½å¼¹å‡ºæ¥å°±è¡Œã€‚</p><p>å¦å¤–å°±æ˜¯æ³¨æ„ä¸€ä¸‹è¿™é‡Œçš„ç©ºæ ˆæ—¶æŸ¥è¯¢è¾“å‡º0å°±è¡Œäº†</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><hr><pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> _CRT_SECURE_NO_WARNINGS</span><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span><span class="token comment" spellcheck="true">// ä¸€å…±éœ€è¦ä¸¤ä¸ªæ ˆï¼Œä¸€ä¸ªæ ˆç”¨æ¥è®°å½•ä¾æ¬¡è¿›å…¥çš„è´§å“è´¨é‡ï¼Œ</span><span class="token comment" spellcheck="true">//ä¸€ä¸ªæ ˆåœ¨å»ºç«‹å‰ä¸€ä¸ªæ ˆçš„æ—¶å€™è®°å½•å½“å‰æ ˆçš„æœ€å¤§å€¼</span><span class="token keyword">int</span> stack1<span class="token punctuation">[</span><span class="token number">200006</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// è®°å½•ä¾æ¬¡è¿›å…¥çš„è´§å“è´¨é‡</span><span class="token keyword">int</span> stack2<span class="token punctuation">[</span><span class="token number">200006</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// è®°å½•å»ºç«‹æ ˆçš„åŒæ—¶å½“å‰æ ˆçš„æœ€å¤§å€¼</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> n<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// æ‰€å«æ“ä½œæ€»æ•°</span>    <span class="token keyword">int</span> opera<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// è®°å½•æ¯æ¬¡çš„æ“ä½œ</span>    <span class="token keyword">int</span> weigh<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// è®°å½•æ¯æ¬¡çš„ç‰©å“è´¨é‡</span>    <span class="token keyword">int</span> top <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//è®°å½•æ ˆé¡¶ä½ç½®</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//è¯»å–æ•°æ®</span>    <span class="token comment" spellcheck="true">//scanf("%d%d", &amp;opera, &amp;weigh);  // å…ˆè¯»å–ä¸€æ¬¡ï¼Œä½¿æ ˆä¸­æœ‰æ•°</span>    <span class="token comment" spellcheck="true">//stack1[top++] = weigh;</span>    <span class="token comment" spellcheck="true">//stack2[top++] = weigh;  // ç”±äºæ ˆä¸­åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„å½“å‰æ ˆæœ€å¤§å€¼ä¸ºweigh</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">// å¾ªç¯næ¬¡</span>    <span class="token punctuation">{</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>opera<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">switch</span> <span class="token punctuation">(</span>opera<span class="token punctuation">)</span>        <span class="token punctuation">{</span>        <span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span>   <span class="token comment" spellcheck="true">// è¯»å–å…¥æ ˆ</span>        <span class="token punctuation">{</span>            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>weigh<span class="token punctuation">)</span><span class="token punctuation">;</span>            stack1<span class="token punctuation">[</span>top<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> weigh<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// å…¥æ ˆ</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>top <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">//æ ˆä¸­åªæœ‰ä¸€ä¸ªå…ƒç´ </span>                stack2<span class="token punctuation">[</span>top <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> weigh<span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>weigh <span class="token operator">></span> stack2<span class="token punctuation">[</span>top <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">// å¦‚æœæˆ‘ä»¬çš„è¯»å…¥æ•°æ®æ¯”ä¹‹å‰çš„æœ€å¤§å€¼è¿˜å¤§</span>                stack2<span class="token punctuation">[</span>top <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> weigh<span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">// å°±æ›´æ”¹æœ€å¤§å€¼</span>            <span class="token keyword">else</span>                stack2<span class="token punctuation">[</span>top <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> stack2<span class="token punctuation">[</span>top <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// å¦åˆ™å»¶ç»­ä¸Šæ¬¡çš„æœ€å¤§å€¼</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true">//å‡ºåº“</span>        <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>top <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">//å¦‚æœæ ˆä¸ç©º</span>                top<span class="token operator">--</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">// å‡ºæ ˆ</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true">// å¦‚æœæ ˆ</span>        <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>top <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">// æ ˆç©ºæ—¶è¾“å‡º0</span>                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"0\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span>                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> stack2<span class="token punctuation">[</span>top <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">default</span><span class="token punctuation">:</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³•é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C </tag>
            
            <tag> æ ˆ </tag>
            
            <tag> æ´›è°· </tag>
            
            <tag> ç®—æ³• </tag>
            
            <tag> æ•°å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®—æ³•åˆ·é¢˜ä¹‹æ ˆç³»åˆ—P1981 è¡¨è¾¾å¼æ±‚å€¼</title>
      <link href="/2021/08/04/suan-fa-shua-ti-zhi-zhan-xi-lie-p1981-biao-da-shi-qiu-zhi/"/>
      <url>/2021/08/04/suan-fa-shua-ti-zhi-zhan-xi-lie-p1981-biao-da-shi-qiu-zhi/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h2><hr><p><a href="https://www.luogu.com.cn/problem/P1981" target="_blank" rel="noopener">é¢˜ç›®</a>æè¿°ï¼šç»™å®šä¸€ä¸ªåªåŒ…å«åŠ æ³•å’Œä¹˜æ³•çš„ç®—æœ¯è¡¨è¾¾å¼ï¼Œè¯·ä½ ç¼–ç¨‹è®¡ç®—è¡¨è¾¾å¼çš„å€¼ã€‚</p><p><a href="https://imgtu.com/i/fEXFET" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/04/fEXFET.png" alt></a></p><h2 id="è§£ææ€è·¯"><a href="#è§£ææ€è·¯" class="headerlink" title="è§£ææ€è·¯"></a>è§£ææ€è·¯</h2><hr><p>å®é™…ä¸Šæœ¬é¢˜å’Œæ ˆçš„å…³ç³»ä¸æ˜¯ç‰¹åˆ«å¤§ï¼Œå› ä¸ºåªæœ‰ä¹˜å’ŒåŠ ä¸¤ç§è¿ç®—ï¼Œæˆ‘ä»¬åŸºæœ¬æ€è·¯ä¸ºæŠŠä¹˜çš„ä¹˜å‡ºæ¥åï¼ŒåŠ ä¸Šä¹‹å‰çš„å’Œå°±OKï¼Œæ²¡æœ‰å¿…è¦ä½¿ç”¨æ ˆè¿ç®—ã€‚</p><h2 id="ä»£ç åˆ†æ"><a href="#ä»£ç åˆ†æ" class="headerlink" title="ä»£ç åˆ†æ"></a>ä»£ç åˆ†æ</h2><hr><p>ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">#include <cstdio>const int mod = 10000;int x,s,t; //xæ˜¯å½“å‰çš„æ•°ï¼Œsæ˜¯å’Œï¼Œtæ˜¯å½“å‰æ®µçš„ä¹˜ç§¯char c;int main(){    scanf("%d",&t);//å…ˆè¯»å…¥ç¬¬ä¸€ä¸ªæ•°ï¼Œä¹‹åæ¯æ¬¡è¯»å…¥ä¸€ä¸ªç¬¦å·ä¸€ä¸ªæ•°    while(scanf("%c",&c) && c != '\n'){ //æœ€åä¼šè¯»åˆ°æ¢è¡Œç¬¦        scanf("%d",&x);        if(c == '*') t = t * x % mod; //æ˜¯ä¹˜å·å°±ç›¸ä¹˜        else s = (s + t) % mod,t = x;        //åŠ å·å°±åŠ ä¸Šä¸Šä¸€æ®µçš„ç§¯ï¼Œtå˜ä¸ºä¸‹ä¸€æ®µçš„ç¬¬ä¸€ä¸ªæ•°    }    printf("%d\n",(s + t) % mod); //åŠ ä¸Šæœ€åä¸€æ®µçš„ç§¯    return 0;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Pythonå®ç°ï¼ˆevalå‡½æ•°ï¼‰"><a href="#Pythonå®ç°ï¼ˆevalå‡½æ•°ï¼‰" class="headerlink" title="Pythonå®ç°ï¼ˆevalå‡½æ•°ï¼‰"></a>Pythonå®ç°ï¼ˆevalå‡½æ•°ï¼‰</h2><hr><p>å½“ç„¶ï¼Œè¿™é‡Œé¢æˆ‘ä»¬çš„è¿ç®—å¼å°±æ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬å¹³æ—¶è®¡ç®—çš„æ—¶å€™å¾€è®¡ç®—å™¨ä¸Šæ•²çš„æ ¼å¼ä¸€æ¨¡ä¸€æ ·ï¼Œæ‰€ä»¥æˆ‘ä»¬å®Œå…¨èƒ½æƒ³åˆ°pythonä¸­çš„evalå‡½æ•°ï¼Œå®ƒå¯ä»¥å°†æˆ‘ä»¬çš„è¾“å…¥çš„å­—ç¬¦ä¸²ä½œä¸ºpythonçš„ä»£ç ç¼–è¯‘å‡ºæ¥ï¼Œæ‰€ä»¥å¾ˆç†æ‰€åº”å½“çš„ï¼Œ<del>ä¸€è¡Œä»£ç ä¼˜é›…è§£å†³</del></p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>eval<span class="token punctuation">(</span>input<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">10000</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶è€Œç°å®å¾ˆæ®‹é…·â€¦â€¦</p><p><a href="https://imgtu.com/i/fEjTTf" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/04/fEjTTf.png" alt></a></p><p>æœ‰ä¸¤ä¸ªè¿è¡Œè¶…æ—¶äº†</p><p>åæ¥æ¢æˆäº†Pyhon2ï¼Œpython2æ‰æ˜¯å¯ä»¥ç›´æ¥è¿ç®—ä¸å€ŸåŠ©ä»»ä½•å‡½æ•°ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>input<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">10000</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><del>ç›´æ¥ACï¼</del></p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³•é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C </tag>
            
            <tag> python </tag>
            
            <tag> æ ˆ </tag>
            
            <tag> æ´›è°· </tag>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®—æ³•åˆ·é¢˜ä¹‹æ ˆç³»åˆ—P1449 åç¼€è¡¨è¾¾å¼</title>
      <link href="/2021/08/04/suan-fa-shua-ti-zhi-zhan-xi-lie-p1449-hou-zhui-biao-da-shi/"/>
      <url>/2021/08/04/suan-fa-shua-ti-zhi-zhan-xi-lie-p1449-hou-zhui-biao-da-shi/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a><a href="https://www.luogu.com.cn/problem/P1449" target="_blank" rel="noopener">é¢˜ç›®</a>æè¿°</h2><hr><p>æ‰€è°“åç¼€è¡¨è¾¾å¼æ˜¯æŒ‡è¿™æ ·çš„ä¸€ä¸ªè¡¨è¾¾å¼ï¼šå¼ä¸­ä¸å†å¼•ç”¨æ‹¬å·ï¼Œè¿ç®—ç¬¦å·æ”¾åœ¨ä¸¤ä¸ªè¿ç®—å¯¹è±¡ä¹‹åï¼Œæ‰€æœ‰è®¡ç®—æŒ‰è¿ç®—ç¬¦å·å‡ºç°çš„é¡ºåºï¼Œä¸¥æ ¼åœ°ç”±å·¦è€Œå³æ–°è¿›è¡Œï¼ˆä¸ç”¨è€ƒè™‘è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ï¼‰ã€‚</p><p>å¦‚ï¼š3<em>(5â€“2)+7å¯¹åº”çš„åç¼€è¡¨è¾¾å¼ä¸ºï¼š3ï¼5ï¼2ï¼-</em>7ï¼+@ã€‚â€™@â€™ä¸ºè¡¨è¾¾å¼çš„ç»“æŸç¬¦å·ã€‚â€˜.â€™ä¸ºæ“ä½œæ•°çš„ç»“æŸç¬¦å·ã€‚</p><p><a href="https://imgtu.com/i/fELUWd" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/04/fELUWd.png" alt></a></p><p>##è§£ææ€è·¯</p><hr><p>æœ¬é¢˜ä¹Ÿæ˜¯å¯¹äºæ ˆçš„è¾ƒä¸ºç›´æ¥çš„è€ƒå¯Ÿï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é€‰æ‹©å»ºç«‹ä¸€ä¸ªæ ˆæ¥å­˜å‚¨æˆ‘ä»¬çš„æ¯æ¬¡è¾“å…¥çš„æ•°å­—ï¼Œç„¶åé‡åˆ°ä¸€ä¸ªç¬¦å·å°±å¼¹å‡ºä¸¤ä¸ªæ•°æ¥è¿›è¡Œè¿ç®—ï¼Œè¿ç®—çš„ç»“æœå†å…¥æ ˆï¼Œæœ€åè¿ç®—ç»“æŸä¹‹åï¼Œæ ˆä¸­åªä¼šå‰©ä¸‹æœ€åä¸€ä¸ªæ•°ï¼Œå°±æ˜¯æˆ‘ä»¬çš„ç»“æœã€‚</p><p><strong>æ³¨æ„è¿™é‡Œé¢æˆ‘ä»¬è¯»å–æ•°å­—çš„æ—¶å€™æ˜¯ä»¥å­—ç¬¦ä¸²è¯»å–çš„ï¼Œæœ‰å¯èƒ½ä¼šè¯»å–å¤šä½æ•°æ¯”å¦‚13ã€122è¿™ç§ï¼Œæ‰€ä»¥éœ€è¦æ³¨æ„è¯»å–é—®é¢˜ï¼Œä¸è¿‡è¿™ä¸€é¢˜è¿˜ç®—ç®€å•ï¼Œæ²¡æœ‰è®©æˆ‘ä»¬è¯»å–è´Ÿæ•°</strong></p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><hr><p>ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> _CRT_SECURE_NO_WARNINGS</span><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> stack<span class="token punctuation">[</span><span class="token number">1000</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// ç”¨æ¥æ”¾ç½®ç›¸å…³æ•°å­—çš„æ ˆ</span>    <span class="token keyword">char</span> ch<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// è¯»å…¥å­—ç¬¦</span>    <span class="token keyword">int</span> top <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//è®°å½•æ ˆç›®å‰çš„æ ˆé¡¶ä½ç½®</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">'@'</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>ch <span class="token operator">&lt;=</span> <span class="token string">'9'</span> <span class="token operator">&amp;&amp;</span> ch <span class="token operator">>=</span> <span class="token string">'0'</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token keyword">int</span> num<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// ç”¨æ¥åšè¯»å–çš„æ¯ä¸€ä¸ªæ•°å­—</span>            num <span class="token operator">=</span> ch <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">'\.'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">// å¦‚æœæ˜¯æ•°å­—çš„è¯</span>            <span class="token punctuation">{</span>                num <span class="token operator">*</span><span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>                num <span class="token operator">+</span><span class="token operator">=</span> ch <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            stack<span class="token punctuation">[</span>top<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> num<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// å…¥æ ˆ</span>            <span class="token comment" spellcheck="true">// printf("%d", num);</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span>   <span class="token comment" spellcheck="true">// å¦‚æœæ˜¯è¿ç®—ç¬¦å°±å‡ºæ ˆè¿ç®—ç„¶åå…¥æ ˆ</span>        <span class="token punctuation">{</span>            <span class="token keyword">int</span> right <span class="token operator">=</span> stack<span class="token punctuation">[</span><span class="token operator">--</span>top<span class="token punctuation">]</span><span class="token punctuation">,</span> left <span class="token operator">=</span> stack<span class="token punctuation">[</span><span class="token operator">--</span>top<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// å¾—åˆ°å·¦å³æ“ä½œæ•°</span>            <span class="token keyword">switch</span> <span class="token punctuation">(</span>ch<span class="token punctuation">)</span>            <span class="token punctuation">{</span>            <span class="token keyword">case</span><span class="token string">'*'</span><span class="token punctuation">:</span> stack<span class="token punctuation">[</span>top<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> left <span class="token operator">*</span> right<span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span><span class="token string">'/'</span><span class="token punctuation">:</span> stack<span class="token punctuation">[</span>top<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> left <span class="token operator">/</span> right<span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span><span class="token string">'+'</span><span class="token punctuation">:</span> stack<span class="token punctuation">[</span>top<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> left <span class="token operator">+</span> right<span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span><span class="token string">'-'</span><span class="token punctuation">:</span> stack<span class="token punctuation">[</span>top<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> left <span class="token operator">-</span> right<span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">default</span><span class="token punctuation">:</span><span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">// printf("top : %d\n", stack[top - 1]);</span>    <span class="token punctuation">}</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> stack<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®é™…ä¸Šæ ¼å¼åŒ–ä¹‹åï¼Œå‘ç°æœ¬é¢˜éš¾åº¦å¹¶ä¸å¤§ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³•é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C </tag>
            
            <tag> æ ˆ </tag>
            
            <tag> æ´›è°· </tag>
            
            <tag> ç®—æ³• </tag>
            
            <tag> æ•°å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®—æ³•åˆ·é¢˜å…¨è®°å½•</title>
      <link href="/2021/08/04/suan-fa-shua-ti-quan-ji-lu/"/>
      <url>/2021/08/04/suan-fa-shua-ti-quan-ji-lu/</url>
      
        <content type="html"><![CDATA[<p><em>å­¦æ ¡è¦æ±‚æš‘å‡åˆ·ç®—æ³•é¢˜ï¼Œä¸Šä¸ªå¯’å‡åˆ·çš„é¢˜ï¼ˆ<del>æœ‰å¥½å¤šå¥½å¤šéƒ½æ˜¯ä¸ä¼šæŠ„çš„</del>ï¼‰å‡ ä¹ä¸Šéƒ½å¿«å¿˜å®Œäº†ï¼Œæ­£é€¢ä¸Šæˆ‘åˆ›å»ºä¸ªäººåšå®¢ï¼Œç®—æ˜¯æŠŠåˆ·è¿‡çš„é¢˜éƒ½åšä¸€ä¸ªè®°å½•ï¼Œä¹Ÿç®—æ˜¯ä¸ªè®°å½•æ•´ç†ä¸€ä¸‹æ€è·¯ï¼Œä»¥åå¿˜äº†è¿˜å¯ä»¥çœ‹çœ‹å½“æ—¶çš„æ€è·¯</em></p><p>å°±ä»¥è¿™ä¸€ä¸ªç³»åˆ—ä½œä¸ºå¼€ç¯‡ä½œï¼Œä»¥åæˆ‘ä¼šæ¯æ¬¡åˆ·ä¸€ä¸ªç³»åˆ—çš„é¢˜ï¼Œé¡ºä¾¿æ¥è¿›è¡Œä¸€ä¸ªå¤§çš„æ¯é“é¢˜çš„æ€»ç»“ã€‚</p><h2 id="æ ˆç³»åˆ—"><a href="#æ ˆç³»åˆ—" class="headerlink" title="æ ˆç³»åˆ—"></a>æ ˆç³»åˆ—</h2><hr><p>ç¬¬ä¸€ä¸ªç³»åˆ—çš„æ˜¯å…³äºæ ˆçš„äº”é“é¢˜ã€‚</p><p><a href="https://imgtu.com/i/fEHUWn" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/04/fEHUWn.png" alt></a></p><p>éš¾åº¦ä¸æ˜¯å¾ˆå¤§ï¼Œä¸è¿‡ä¹ŸèŠ±äº†ä¸€å®šçš„æ—¶é—´</p><p>äº”é“é¢˜åœ°å€ä¸è§£ç­”åšå®¢åœ°å€åœ¨è¿™é‡Œï¼š</p><p>ç¬¬ä¸€é“ï¼š<a href="https://www.luogu.com.cn/problem/P1044" target="_blank" rel="noopener">P1044å•è°ƒæ ˆ</a>       <a href="https://lry89757.github.io/2021/08/04/suan-fa-shua-ti-zhi-zhan-xi-lie-p1044-zhan/">ç®—æ³•åˆ·é¢˜ä¹‹æ ˆç³»åˆ—P1044æ ˆ</a></p><p>ç¬¬äºŒé“ï¼š<a href="https://www.luogu.com.cn/problem/P1449" target="_blank" rel="noopener">P1449åç¼€è¡¨è¾¾å¼</a>  <a href="https://lry89757.github.io/2021/08/04/suan-fa-shua-ti-zhi-zhan-xi-lie-p1449-hou-zhui-biao-da-shi/">ç®—æ³•åˆ·é¢˜ä¹‹æ ˆç³»åˆ—P1449åç¼€è¡¨è¾¾å¼</a></p><p>ç¬¬ä¸‰é“ï¼š<a href="https://www.luogu.com.cn/problem/P1981" target="_blank" rel="noopener">P1981è¡¨è¾¾å¼æ±‚å€¼</a>   <a href="https://lry89757.github.io/2021/08/04/suan-fa-shua-ti-zhi-zhan-xi-lie-p1981-biao-da-shi-qiu-zhi/">ç®—æ³•åˆ·é¢˜ä¹‹æ ˆç³»åˆ—P1981 è¡¨è¾¾å¼æ±‚å€¼</a></p><p>ç¬¬å››é“ï¼š<a href="https://www.luogu.com.cn/problem/P1165" target="_blank" rel="noopener">P1165æ—¥å¿—åˆ†æ</a>    <a href="https://lry89757.github.io/2021/08/04/suan-fa-shua-ti-zhi-zhan-xi-lie-p1165-ri-zhi-fen-xi/">ç®—æ³•åˆ·é¢˜ä¹‹æ ˆç³»åˆ—P1165-æ—¥å¿—åˆ†æ</a></p><p>ç¬¬äº”é“ï¼š<a href="https://www.luogu.com.cn/problem/P5788" target="_blank" rel="noopener">P5788å•è°ƒæ ˆ</a>   <a href="https://lry89757.github.io/2021/08/04/suan-fa-shua-ti-zhi-zhan-xi-lie-p5788-dan-diao-zhan/">ç®—æ³•åˆ·é¢˜ä¹‹æ ˆç³»åˆ—P5788 å•è°ƒæ ˆ</a></p><h2 id="é˜Ÿåˆ—ç³»åˆ—"><a href="#é˜Ÿåˆ—ç³»åˆ—" class="headerlink" title="é˜Ÿåˆ—ç³»åˆ—"></a>é˜Ÿåˆ—ç³»åˆ—</h2><hr><p>ç¬¬äºŒä¸ªç³»åˆ—æ˜¯æœ‰å…³äºé˜Ÿåˆ—ç³»åˆ—çš„3é“é¢˜ï¼š</p><p><a href="https://imgtu.com/i/fVnrn0" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/05/fVnrn0.png" alt></a></p><p>ç¬¬ä¸€é“ï¼š<a href="https://www.luogu.com.cn/problem/UVA540" target="_blank" rel="noopener">å›¢ä½“é˜Ÿåˆ—</a></p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³•é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C </tag>
            
            <tag> python </tag>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
            <tag> æ ˆ </tag>
            
            <tag> æ´›è°· </tag>
            
            <tag> ç®—æ³• </tag>
            
            <tag> æ•°å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®—æ³•åˆ·é¢˜ä¹‹æ ˆç³»åˆ—P1044 æ ˆ</title>
      <link href="/2021/08/04/suan-fa-shua-ti-zhi-zhan-xi-lie-p1044-zhan/"/>
      <url>/2021/08/04/suan-fa-shua-ti-zhi-zhan-xi-lie-p1044-zhan/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a><a href="https://www.luogu.com.cn/problem/P1044" target="_blank" rel="noopener">é¢˜ç›®</a>æè¿°</h2><hr><p>ä¸€ä¸ªåºåˆ—1ã€2ã€3ã€4ã€5ã€â€¦â€¦ã€nï¼ŒæŒ‰ç…§å¦‚æ­¤é¡ºåºå…¥æ ˆï¼Œå¯èƒ½çš„å‡ºæ ˆé¡ºåºæœ‰å¤šå°‘ç§ï¼Ÿ</p><p><a href="https://imgtu.com/i/fEbQh9" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://z3.ax1x.com/2021/08/04/fEbQh9.png" alt></a></p><h2 id="æ€è·¯è§£æ"><a href="#æ€è·¯è§£æ" class="headerlink" title="æ€è·¯è§£æ"></a>æ€è·¯è§£æ</h2><hr><p>è¿™ä¸€é“é¢˜å®é™…ä¸Šä½¿ç”¨äº†å¡ç‰¹å…°æ•°çš„å…¬å¼ï¼Œ</p><p>å»ºç«‹æ•°ç»„fã€‚f[i]è¡¨ç¤ºiä¸ªæ•°çš„å…¨éƒ¨å¯èƒ½æ€§ã€‚</p><p>f[0] = 1, f[1] = 1; //å½“ç„¶åªæœ‰ä¸€ä¸ª</p><p>è®¾ x ä¸ºå½“å‰å‡ºæ ˆåºåˆ—çš„æœ€åä¸€ä¸ªï¼Œåˆ™xæœ‰nç§å–å€¼</p><p>ç”±äºxæ˜¯æœ€åä¸€ä¸ªå‡ºæ ˆçš„ï¼Œæ‰€ä»¥å¯ä»¥å°†å·²ç»å‡ºæ ˆçš„æ•°åˆ†æˆä¸¤éƒ¨åˆ†</p><ol><li>æ¯”xå°</li><li>æ¯”xå¤§</li></ol><p>æ¯”xå°çš„æ•°æœ‰x-1ä¸ªï¼Œæ‰€ä»¥è¿™äº›æ•°çš„å…¨éƒ¨å‡ºæ ˆå¯èƒ½ä¸ºf[x-1]</p><p>æ¯”xå¤§çš„æ•°æœ‰n-xä¸ªï¼Œæ‰€ä»¥è¿™äº›æ•°çš„å…¨éƒ¨å‡ºæ ˆå¯èƒ½ä¸ºf[n-x]</p><p>è¿™ä¸¤éƒ¨åˆ†äº’ç›¸å½±å“ï¼Œæ‰€ä»¥ä¸€ä¸ªxçš„å–å€¼èƒ½å¤Ÿå¾—åˆ°çš„æ‰€æœ‰å¯èƒ½æ€§ä¸ºf[x-1] * f[n-x]</p><p>å¦å¤–ï¼Œç”±äºxæœ‰nä¸ªå–å€¼ï¼Œæ‰€ä»¥</p><p>ans = f[0]<em>f[n-1] + f[1]</em>f[n-2] + â€¦ + f[n-1]*f[0];</p><p>å½“ç„¶å¯ä»¥è¿™æ ·ä½¿ç”¨é€’å½’å¤„ç†ï¼Œä½†æ˜¯æˆ‘ä»¬å·²ç»æœ‰ç»“è®ºäº†ï¼šh(n)=c(2n,n)-c(2n,n-1) (n=0,1,2,â€¦)</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><hr><p>æ‰€ä»¥æˆ‘çš„ç­”æ¡ˆå°±å¾ˆâ€œç®€æ´â€äº†</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> math <span class="token keyword">import</span> factorialn <span class="token operator">=</span> int<span class="token punctuation">(</span>input<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>int<span class="token punctuation">(</span>factorial<span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> n<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>factorial<span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å½“ç„¶å¦‚æœä½ æƒ³è¦è¾ƒä¸ºâ€æ­£å¸¸â€œçš„å®Œæˆè¿™ä¸€é“é¢˜(æŠ„æŸä½å¤§ä½¬çš„)ï¼š</p><pre class="line-numbers language-c++"><code class="language-c++">#include<cstdio>#define siz 20using namespace std;int n;int c[siz*2][siz];int main(){    scanf("%d",&n);    for(int i=1;i<=2*n;i++) c[i][1]=c[i][i]=1;    for(int i=3;i<=2*n;i++)     for(int j=2;j<i;j++)      c[i][j]=c[i-1][j]+c[i-1][j-1];    printf("%d",c[2*n][n]-c[2*n][n-1]);    return 0;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><del>æ„‰å¿«AC</del></p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³•é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag> python </tag>
            
            <tag> æ ˆ </tag>
            
            <tag> æ´›è°· </tag>
            
            <tag> ç®—æ³• </tag>
            
            <tag> æ•°å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å›åˆ°é‚£ç‰‡çƒåœº8.3 2021</title>
      <link href="/2021/08/04/hui-dao-na-pian-qiu-chang-8-3-2021/"/>
      <url>/2021/08/04/hui-dao-na-pian-qiu-chang-8-3-2021/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="ä¼¼ä¹ä¸å¤ªæ­£ç¡®â€¦â€¦ç®—äº†å§ï¼Œæ²¡å•¥å¥½çœ‹çš„" data-whm="æŠ±æ­‰, è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹.">  <script id="hbeData" type="hbeData" data-hmacdigest="7cd66ceb702686a6e61e8fab002ebc58dc5b166530e0f6c2e820bc7a6d3ec9e3">5de89d89894dfc04df6c90fd52cc9dd07e5c4f0d52ff815f234f57e60c9b48a7</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-shrink">      <input class="hbe hbe-input-field hbe-input-field-shrink" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-shrink" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-shrink">Not IP of Mr.Lu ! enter some words to prove</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> å†™ç»™è‡ªå·±çš„æ•£æ–‡è¯— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç”Ÿæ´»éšç¬” </tag>
            
            <tag> å†™ç»™è‡ªå·±çš„æ•£æ–‡è¯— </tag>
            
            <tag> ç¾½æ¯›çƒ </tag>
            
            <tag> ä½“è‚²è¿åŠ¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Lier and Accuser for æ—ä¿Šæ°</title>
      <link href="/2021/08/03/lier-and-accuser-for-lin-jun-jie/"/>
      <url>/2021/08/03/lier-and-accuser-for-lin-jun-jie/</url>
      
        <content type="html"><![CDATA[<p>ç½‘ä¸Šæœ€è¿‘æµè¨€é£èµ·ï¼Œè¯´åˆ°æ—ä¿Šæ°****ï¼Œæˆ‘å®é™…ä¸Šæ˜¯æ¯”è¾ƒæ°”æ„¤çš„ï¼Œè‡³å°‘ç°åœ¨è¿˜æ²¡æœ‰çœŸç›¸å¤§ç™½ï¼Œç½‘ä¸Šçš„é”®ç›˜ä¾ ã€æ°´å†›ä»¬å·²ç»å¼€å§‹æ‹¼å‘½é»‘äº†ï¼Œæˆ‘æƒ³èµ·äº†JJ Linçš„ä¸€é¦–æ­Œï¼ŒLier and Accuser, é‡Œé¢å‡ å¥æ­Œè¯ï¼šThey donâ€™t even know meï¼ŒWith their tonguesï¼ˆé—²è¨€ç¢è¯­ï¼‰ they crucifyï¼ˆæŠ˜ç£¨ï¼‰ meï¼ŒWonâ€™t you vindicateï¼ˆè¯æ˜â€¦â€¦æ— è¾œçš„ï¼‰ meï¼ŒFendï¼ˆé˜²å¾¡ï¼‰ me from those false accusationsï¼ˆæŒ‡è´£ï¼‰ã€‚ä»–ä»¬éƒ½ä¸è®¤è¯†æˆ‘ï¼Œå°±å„å¤„é€ è°£ï¼Œä½ èƒ½è¯æ˜æˆ‘æ˜¯æ— è¾œçš„å¯¹å§ï¼Œå¿«å¸¦æˆ‘é€ƒç¦»è¿™ä¸å®çš„æŒ‡è´£ã€‚</p><p>çš„ç¡®ï¼Œç½‘ä¸Šå¥½æ—©å‰å°±æœ‰è¿‡å¥½å¤šå…³äºä»–çš„ypä¼ é—»ï¼Œä¼¼ä¹æ˜¯æ­£ç¡®çš„ï¼Œå°±ç®—æ˜¯æ­£ç¡®çš„æˆ‘ä¹Ÿä¸å¥‡æ€ªï¼Œçš„ç¡®å•Š40å¤šçš„è€ç”·äººäº†ï¼Œä»–ä¹Ÿæ²¡æœ‰æ‰€è°“çš„çº¯æƒ…äººè®¾ï¼Œæˆ‘åªæ˜¯åœ¨å¬ä»–çš„æ­Œã€æ¬£èµä»–çš„ä½œæ›²æ‰åã€æ¼”å”±èƒ½åŠ›è€Œå·²ã€‚ä¹Ÿå¯èƒ½åªæ˜¯è°£è¨€è€Œå·²ã€‚ä½†æ˜¯æœ€ä»¤æˆ‘æ°”æ„¤çš„æ˜¯ï¼Œå…³äºä»–çš„å¸æ¯’ï¼Ÿï¼Ÿï¼Ÿï¼Ÿæˆ‘æƒ³çŸ¥é“ï¼Œè¿™è¿˜æ˜¯äº’è”ç½‘å—ï¼Ÿä¸ºä»€ä¹ˆéƒ½åœ¨å…¨ç½‘é»‘ä»–ï¼Ÿç²‰ä¸çœŸçš„ç¨å¾®ç»´æŠ¤ä¸€ä¸‹éƒ½ä¼šè¢«éª‚ï¼Œç¨å¾®ç»´æŠ¤ä¸‹å°±ä¼šè¢«éª‚å’Œå´äº¦å‡¡ç²‰ä¸æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚æ—ä¿Šæ°è¿™ä»¶äº‹æƒ…ä¹‹å‰æ˜¯ä¸ºæ•°ä¸å¤šçš„å¨±ä¹åœˆé“å¾·æ¨¡èŒƒäº†å§ï¼Œè¿™ä»¶äº‹æƒ…ä¹‹åå¯èƒ½ç»§ç»­ä¼šæ˜¯ã€‚å‡ºé“è¿™ä¹ˆå¤šå¹´ï¼Œå‡ ä¹æ²¡æœ‰ä»€ä¹ˆé»‘æ–™ï¼Œæœ‰ä¸åº”è¯¥æ—©å°±æŒ–å‡ºæ¥äº†å—ï¼Ÿæœ‰çš„é»‘æ–™é‚£ç®—æ˜¯é‚£ä¸€ä¸¤ä¸ªè¢«æ•´å¤©å®£ä¼ ï¼Œäº‹å®ä¸Šæ˜¯è¿™æ ·å—ï¼Ÿä½ ä»¬çœ‹åç»­æŠ¥é“äº†å—ï¼Ÿæœ‰ä»€ä¹ˆçŸ³é”¤çš„è¯æ®å—ï¼Ÿä¼¼ä¹æ²¡æœ‰å§ï¼Ÿç°åœ¨å¾ˆå¤šäººçœŸæ˜¯çº¯å±ä¸ºäº†éª‚è€Œéª‚ã€‚å¥‰åŠä¸€å¥ï¼šçœ‹çœ‹æ—ä¿Šæ°å¾‹å¸ˆå‡½å§ã€‚å‘å®Œå‡½å¾®åšè´´å§çŸ¥ä¹é‚£ç¾¤é€ è°£çš„ï¼Œåˆ å¸–çš„åˆ å¸–ï¼Œé“æ­‰çš„é“æ­‰ï¼Œæ³¨é”€çš„æ³¨é”€ã€‚æ—ä¿Šæ°è€ç²‰çŸ¥é“è¿™äººå•¥æƒ…å†µï¼Œæœ‰é»‘æ–™ï¼Œå‡ºé“è¿™ä¹ˆå¤šå¹´ä¸€ç‚¹ç»¯é—»éƒ½æ²¡æœ‰ï¼Œä½ çªç„¶è·Ÿæˆ‘è¯´è¿™äººè‰¹ç²‰å¸æ¯’ã€‚</p><p>å¾‹å¸ˆå‡½æ¥äº†ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic2.zhimg.com/80/v2-cc49665bac3a39ceb04c30bcd79f9c41_1440w.jpg?source=1940ef5c" alt></p><p>çœ‹çœ‹å„ä½é€ è°£è€…çš„æ€‚æ ·å­ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic1.zhimg.com/80/v2-21a93e919c35cb5d49b67c382d78833f_1440w.jpg?source=1940ef5c" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic1.zhimg.com/80/v2-11cce240e88834da7b37a7bcb064187c_1440w.jpg?source=1940ef5c" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic3.zhimg.com/80/v2-7499d91ae7f4f149d0e0d08dc42861fd_1440w.jpg?source=1940ef5c" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic2.zhimg.com/80/v2-87cf0d5ed18c9625e6e12cd7887544ca_1440w.jpg?source=1940ef5c" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic3.zhimg.com/80/v2-4297ecbe4661de46d55b0143fb2d8a26_1440w.jpg?source=1940ef5c" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic2.zhimg.com/80/v2-415d13b25181adb82092e46bd92debc7_1440w.jpg?source=1940ef5c" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic3.zhimg.com/80/v2-7631e35a42a27f00ed22ca814abc286f_1440w.jpg?source=1940ef5c" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic1.zhimg.com/80/v2-a966b19464203807eb23acfa51c7ed33_1440w.jpg?source=1940ef5c" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic2.zhimg.com/80/v2-cf3cad0c0c3c295143a10cadc9bc0e33_1440w.jpg?source=1940ef5c" alt></p><p>ä½œä¸ºæ—ä¿Šæ°å¤šå¹´ç²‰ä¸äº†ï¼Œå½“ç„¶ï¼Œå¦‚æœä»–çœŸçš„å¸æ¯’äº†ï¼Œæˆ‘ä¹Ÿä¸ä¼šç»´æŠ¤ä»–ã€‚ä½†å¸æ¯’å…¨ç½‘æ­Œæ›²ä¸‹æ¶äº†æˆ‘ä»ç„¶ä¼šå¬ä»–çš„æ­Œï¼Œåæ­£ä¹‹å‰ä¸‹è½½è¿‡äº†ï¼Œæˆ‘å¯¹äºè‰ºäººçš„ç§å¾·å®¹å¿ç¨‹åº¦æ²¡æœ‰é‚£ä¹ˆé«˜ï¼ŒåŒæ—¶æˆ‘åŒæ ·è®¤ä¸ºï¼Œå¦‚æœæœ€ç»ˆå‡ºæ¥æ—ä¿Šæ°æ²¡æœ‰ç½ªï¼Œè¯·æŠŠé‚£äº›å‡ºæ¥é€ è°£çš„å…¨éƒ¨é€è¿›ç›‘ç‹±ï¼Œæ— è¯æ®é€ è°£è€…å¿…é¡»æ”¶åˆ°ç›¸åº”çš„å¤„ç½šã€‚</p><p>æˆ‘åªè¯´ä»–è¿™ä¸ªåœˆå­è¿™ä¸ªæ¡ä»¶çš„äººypå¯ä»¥ç†è§£ï¼Œæ²¡æœ‰è¯´æˆ‘æ¥å—ç”šè‡³èµåŒä»–ypã€‚</p><p>è€Œä¸”è¯´ä½œå“è¯´æˆ‘æ˜¯æ­Œè¿·ä¸æ˜¯ç²‰ä¸æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿä½œå“æœ¬å°±ä¸ä»£è¡¨äººå“ï¼Œæ›´ä¸ä»£è¡¨æœ‰äº†ä½œå“å°±å¯ä»¥é™ä½é“å¾·æ ‡å‡†å¯ä»¥çŠ¯é”™ã€‚</p><p>è€Œæ˜¯å“ªæ€•ä»–è¿æ³•è¢«æŠ“äº†ï¼Œæˆ‘ä¹Ÿèƒ½ä¸€è¾¹å¬ç€ä»–çš„æ­Œä¸€è¾¹åœ¨ç½‘ä¸Šåˆ·ä»–è½ç½‘çš„çƒ­ç‚¹ä¸€è¾¹è¿˜èƒ½åœ¨è¯„è®ºåŒºå˜´ä»–å‡ å¥ã€‚</p><p>å‡ºäº†æ­Œæˆ‘ä¹°æœ‰é’±ä¹°æ¼”å”±ä¼šæŠ¢å¾—åˆ°å°±å»ã€‚æ—ä¿Šæ°å¾®åšè¶…è¯æˆ‘ä¸å…³æ³¨ï¼Œå…¥é©»æŠ–éŸ³æˆ‘ä»æ¥ä¸çœ‹(æˆ‘ç”šè‡³æ²¡æŠ–éŸ³)ï¼Œç²‰ä¸æœ€è¿‘å’Œè°è°è°æ’•äº†æˆ‘ä¸æ¸…æ¥šï¼Œç”Ÿæ—¥æˆ‘è®°ä¸æ¸…ã€‚</p><p>ç§ç”Ÿæ´»ä¼ è¿™ä¹ˆä¹…ï¼Œä¸€å¼ çŸ³é”¤éƒ½æ²¡æœ‰ï¼Œä¸€ä¸ªå½“äº‹äººéƒ½æ²¡æœ‰ã€‚ä»æ²¡æœ‰é‚£ä¸ªå¥³ç”Ÿè·³å‡ºæ¥è¯´ï¼šâ€œæ²¡é”™ï¼æ—ä¿Šæ°å°±æ˜¯è·Ÿæˆ‘ç¡çš„ï¼â€</p><p><strong>ä½†æˆ‘å§‹ç»ˆæ˜¯ä»–çš„ç²‰ä¸</strong></p><p><strong>ä»æ¥æ²¡æœ‰ã€‚</strong></p><p>åå‡ å¹´äº†è¯¶ï¼Œä¸ç®¡æ˜¯æé€ è¿˜æ˜¯ç©ºç©´æ¥é£ï¼Œè¿ä¸€å¼ èƒ½æ”¯æ’‘è¿™ä¸ªè°£è¨€çš„ä¾æ®éƒ½æ²¡æœ‰ã€‚</p><p><strong>å´äº¦å‡¡ç²‰ä¸å¯ä»¥æœ‰åå‡ ä¸ªå«‚å­ï¼Œè€Œæ—ä¿Šæ°ç²‰ä¸ï¼Œä¸€ä¸ªå«‚å­éƒ½æ²¡è§ç€ã€‚</strong></p><p>å¦å¤–ç‚¹åä¸¤ä¸ªåœ°æ–¹ï¼šä¸€ä¸ªæ˜¯è´´å§ç‹—å§é‚£ä¸ªIDå«é›·å†›çš„ï¼Œç¬¬ä¸€æ—¶é—´å‘å¸–é€ è°£é»‘æ—ä¿Šæ°ï¼Œå‘å®Œå¾‹å¸ˆå‡½ååˆç«‹åˆ»åˆ å¸–é”€å·è·‘è·¯ï¼Œå¦‚æœè°ƒæŸ¥å®Œæ¯•åæ—ä¿Šæ°æ²¡æœ‰ç½ªï¼Œæˆ‘åšä¿¡è¿™ä¸ªäººå¿…é¡»æ”¶åˆ°ç›¸åº”çš„æƒ©ç½šã€‚ç¬¬äºŒä¸ªå°±æ˜¯å¾®åšè‡­åæ˜­è‘—çš„è¹­çƒ­åº¦çš„è°¢æ˜çš“ã€‚</p><p>å…¶ä½™çš„ä»¥ååœ¨æ›´æ–°ï¼Œæš‚æ—¶ä¸è¯´äº†ï¼Œå¿ƒçƒ¦é€é¡¶ã€‚</p><p>æœ¬äººä¹Ÿé™å¾…äº‹æƒ…ç»§ç»­å‘å±•ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> äººç‰© </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç”Ÿæ´»éšç¬” </tag>
            
            <tag> æ—ä¿Šæ° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€äº›æ„Ÿæƒ³2021.8.02</title>
      <link href="/2021/08/02/yi-xie-gan-xiang/"/>
      <url>/2021/08/02/yi-xie-gan-xiang/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="ä¼¼ä¹ä¸å¤ªæ­£ç¡®â€¦â€¦ç®—äº†å§ï¼Œæ²¡å•¥å¥½çœ‹çš„" data-whm="æŠ±æ­‰, è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹.">  <script id="hbeData" type="hbeData" data-hmacdigest="3f3e9958eca594c5b0bfb787fea65ac080eaf55c71312ad0761f75214afcbdc8">5de89d89894dfc04df6c90fd52cc9dd00610d1ea9fce7ba2cb06c84a46851c8bd1510e1fa7f1d7bf06374730a2c0ca7fda58b2ca76c6313e397a28e53312809b61a88d126d1c7d96f0df028d7bf6b0b0aca6aa9281ece6cecaced19d31fe13a8fea504f2cfdd125ee49808fc407e0890abed58ba82abedc61469ba80e61ca00d7772a1095afd76050d0c91b44b9fca054b195a7fa2b1ed816a987b79b140093ecea834524fadc97ea7fae67ce7765c5812d3bedff067b56e801167949fb853f8335e9808ff95b1f6d52eb3e5e93948cea70ca7d18cce67d35035c65a897bf0ea19d82224b0e97f72feab034520ef3d35ed5c02127d3c41591c5e00c21d016f34060ac7d554f73f8b40d5390b20fd9d60f7ee0fb4a08a127f0811535d89a57a441f85b58310c323e5c2b170f5da3114423b847cd75036b7df6fb352d220a3aca5bb6baf5a5ca42d8c6c5abae0c4b741d9412d75f25d8b9d76f9a24dae2587d183740e44b9d8761f8913103d04e9f7c98ef6640176c7b8534747d6a674e3eee90e0a577feca7d4e9fef8fd4059ef436b07f9b5eb53b161c956457b84537096ab51b588114aa9bca87c4b86253ffe86cd427cac1d64c306be1aad1a28908b2a86e4986d609a02fe90587c916c74a9c4ffff97653d26d12fd8a89904637f82604f8b76a902ac68672ccbbcd8669b3e851862b21fca69210b4e06fffa8b7f18d68d0ca9a26f3e7e08d8bb6381cca4c100fd076005de8ee67d03a0d5d059aea90a6a7b987d2539d5b5264b4b32b16c8c8fd41f6e46a5d50b018d80076ceee952b9aa8d52bf195a51e2b6a17a36172276c81b249c4a26e4ac9209f4aeb2547c2ff7408ccd03d90d9b93b8ea8ead2b2794eace769723d5bb8703e5a8b079f9b209ac8275c5f9a0f2a53b82b0398c02f267511d4d44ddf9c76593925d6cee8aa5b4a46b673530495bf1ed2b0ecf58782158fbe7927cdde161d61e10ddb3b2df9d646bdee5fc14ab02c9dc59921a13ec222a11af3880868ed54a6c95a1018cb55e2c981e702e3d0749646e192cf81ece2d6fe60422e4f66e9b6b41544574aa4ea0aa1672441782e20cecec6ed7077cef9a0d98a2fca18cc0f5bd58fc85dc8c8baa16d548dc8cc91e84fb0b6b6bb909c69aae62e286a26f20753e053a0532faa2698781c3a58a32dc71e0d15642da6c56dfcaff755f10316fa4c14835a73a6ed3067927485fef68d462aa45203fe3388d653cdfbe4a2c06f2025630c720eb33b339f42d2487a57191a02d72bdadb13556f4c0bec2964e8afd05c414ff65a4996335fc186f455debb37e1dc7351e4350ba11a7c2b055bf73b82ab817710309e2a8202a515debe2ae4232a9332c5793cf7e9271714aa221a7cc6dde098ee4357ad0cd27fccc9316675e982a86b82d7c925fe37e4e8085078a96ccf2ea8b38b92a833d54715567148966e1eb9dd5c198d6aa8271f7773141c2c0c41897758b11dba980ec487b355b4c1e8a40f253fd9e64a8eaea16717180bf6259b0822ea998584e35c93c489d03b34373213f6f4e18bade2ae30e014d8c8dfaf02ff449c318ab47095aa23a86f5a2dcf076be50320b3800165e84867c3a7272a96088c266d1ecfbfb54e0be9bc3cb4eee06a78745760874c65e9cf44dc4353ec392fce959751adbd53420f631e2341d6332d7378edba7373d291b7c4c6f8473d93ccdd5d436adfe1f4d32824b092dfb19670f146e84b9cc4cc4f01014d5f8814ce6b3bcdfc72bfe78084c85c384fca75d7df158ad321dd9fbfa28373b8409929d647bfed4d14c88d083d5ca566b362a2d76d3fd94bd7c5e3256c93d5970c47e23189623b9411690997b503753c93bc4ea1875fc309ce041584de714fbbf46066301a0c9dfc5278486a674c38769676fb8e38a3b179eff160bee9cd8aeef3080a733cec29e3de23a7c821b70e0aec26149c11c05ab3c1e354e56140381bb438f1d22db5b061654b4018bf4b31c78fab01b5ef66876190faa683ff7851e65b94527b665c2703fc6d309e9431944210a85f07fa39affb93753ee07b6cc3c0ba1241298fa4f1fd64feb5b2905c31e769dd499dca717c0e9162cb409df4aa02a5d75b059bc588b016fb3588945a512e5be74979188e4c3de5b87c9962ca352411adda54e1c2b2bc49760128bc1c3f06780689681743973d5267e4c66c39b547720e4694600b23678bd11ed685771c2bca636f82080bb234a3ee9977ae289a32453fa6bd9412abcc9894a607963b77b6ff59c612ff8ab551a44967f3fdee0b99f373086077025072c3490e2b8484c0680744254b31005db4ec3e9bb4db4e341ca828b5e8b6b59eeea429e8ce863ce26ca7bd5caaa077fc502736e738da2e3dc99a97ab0ec1ebca3d44c905c40b9828f53e059ca998de0e45297b51cfa166618e52f75c1653faa5e8c1dd7891dc1333d62a6ae562be0d4f6434047ac771f714c794aaa8df38f204cc7aa66deb2109a0d3066b381841d755a08166278cf51e145596c6daa6539071aaf168bf236598e671902e5b9d5677180fb1a2c8f188c9ff84d1ec67d0f953d224b13688b5ea5cebcc04b26f82f0b616ee7d28f2fd1ce9771391584334981eb2541a0f8dc00dbb9147db6860290149d021c29e3b5d546b19f27f73d1107e860127309b3dbc60aeffe5e556b2f2f0107ada6dd27453013f07b23d8b6cc067b342c2c2b14efe1bfe8b6deb584bd4108fb44cc7e88e86f95b4424825c8e6b76d122115ac408675848cfceca0b31e4385fe42ba048a5bd2d46765d4faa6b09d7afcde15d1479ec3ec2098fbaa7635a848c26a41a26b2bdb95c705b732082a5593a23d1287a7f39469ea368e471929ae6519698665d34931a98ac47adccf980a14cab9abc3d1294f0ca50eb71d9c9838bce786af112f19923cf326c57ab7d3721cfcfc6dadf410a2e129a410d45e285ca56437e01ab0f57079fb613e596cb8692834dc35147af0008d4f3271d98d44b4a9ebce3bc69d89344fe5029d567ab7a3535bcaf359d43960debb51fdfc4f5b35de6e67953b55afb12808d7df46a1d16bc94c72b64ced910ffe480078bd89b6b8584506ec4320418c680ee7c26ca10d0d13bf6340005248ee82cc24b55c176eb4bac716b264c85883cf57ae311df4af066e97b1a3b866d7921bccf9232c50237f94e04b1ec684da5870f0af8799c723ab42355471dbc17be5fd50a4ba1cc836e784be0e1f5db19bfcead3dac304f733c17598771f29d7c7f78c13102a781cf10fb6e34a7c0fec385d0ec73714460dbbf4bac101694b3d384a0741dd7e279920900fcb6d7f6df1ce3cf544488d80eff40005c4153870473345682ffbea8d7dd3942560306ca04706880c1e83e39313fdaa078de90748d9beb409b8ace91f693576f840e891087dcca5a7ec4a57439b56f1151d63247fd4e384b4992bd8d7796a9c9135632d0b3095910545bb99894143660a4a9969c7de2b339c031011299e2eecc81037dc65059ef591dd0bfb10c9b9cc0a0e882996c87a503c4202</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-shrink">      <input class="hbe hbe-input-field hbe-input-field-shrink" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-shrink" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-shrink">Not IP of Mr.Lu!  enter your password</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> å†™ç»™è‡ªå·±çš„æ•£æ–‡è¯— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç”Ÿæ´»éšç¬” </tag>
            
            <tag> å†™ç»™è‡ªå·±çš„æ•£æ–‡è¯— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¯»ã€Šåœ¨è·¯ä¸Šã€‹</title>
      <link href="/2021/08/02/du-zai-lu-shang/"/>
      <url>/2021/08/02/du-zai-lu-shang/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="ä¼¼ä¹ä¸å¤ªæ­£ç¡®â€¦â€¦ç®—äº†å§ï¼Œæ²¡å•¥å¥½çœ‹çš„" data-whm="æŠ±æ­‰, è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹.">  <script id="hbeData" type="hbeData" data-hmacdigest="6e8b7a38404d04abc36db8a353f2ce3062b204855862f3875e7f25c76c2dac71">5de89d89894dfc04df6c90fd52cc9dd0b3f8746dd64ae95603cc2a764f54fbe79b5ad1609005c87f89d9cba430f0bed7522647b431d7f6971bae8dd0b3b65b36ffff4d2c659870d5cab23a7244545c6cb656286921f2a5b316e3fa719c8987717869e456c3001f717180cc13df6abfa4711f2a29a88074f13ec9af5f275a33312b97ed55ec387dbcddb1dbfd560dedcf42ab8f8e68fef1204bb268741afde0cd0abab25819c684cce7fa797d2264f3b785221519160fda79f8ced9eb626215826c08177f3680319729dbe0f59cb7f85c5bf3d3085c514b29fa7337f9ad5d2818f794f43eb336b28216fd9295f820189cdbb76934fffcaccb1ccee3e731588993ba483bb7d2c6cdc0870ea39cc0849c356a98304e0172878beb23c68ed11c4ea8268494a31372585ed81a9dc4676f33dbe7b6825edcf290abc46fb291200f4f8e52b615726abf5b38f10a48fd6e943e9a26e9cb91e10cf07b1d03064d4386e270f182593deb36b88a864a5d5825be03ef4e2e96a75b50c4d61875ebf161aae8725082e9532a65e0f940f7b3e3b5cc4aee5d497ddb99e6d583135ec3b57c330a8695275db8112567bac5bf575c4f3c5d59ddaedd803d9c88061b9031a09dfe6d3b6394676517d5b136231bf9d29080556ab82494eccffb5f67a7fe6b4c9a3d1a856db64a7d26d818004835ea96a35b0524f5272bfa59f41a054bdc6716de1dbc139cd019451ff000f928c23531323b549d35b3d340c584a08ac694dd82eade23e82ea234d75020ed3fa1240abdd713a7fe39de8de05035ca65b19610010ef42ce023f7a042d4c4791db0c6f78b9022043241c943dba3382c12838357327350601b312ba07b05837991f1f8042fa52436d58cad078bfcccf80789bb8258d355e5a4f09285efc0ee4cb8b66ae1b858c39a142b9b8292511db6c7b701784ef9d99da55b1a736a12a5562474de1c23add7a0a89e8112bdf9cfa22901823d3d2c5ae4b9da49f1d42194e0c14c13a52aeed9f669772613a1095d95a19eeef24bd4c72a1a39d6c4b216dcea878e59f8e89d2ffd848bedfe5fc506b8fad576a2b496bad7087d216a7240adc6ca1f545372e9b710572d2945cf02a34fad0be48b18d6404e06a25d7d95f5d42e17f9fb7026d5df6a2daa2676e954cd059ccf14867c9b1a1d8d76025236c1acf8afd4dc4e3feb06b42078c9d4bd7d30ac95cb984a9f6bf5421159baff3914a18716760c4f94a170435eaaf10517c5b19ce6ae9efb948a3663a277dbd5b1b92df39751d871176c3f8f977ea79b9e7a7b573b86cd177440a9ec0f454eb63f3b0141aafb16c80f0b3e0b5b393fda4ac89dc77c1a65e655a0f2740dd609955796f987f284ad9f3cc3bb67454205432ba22966e31efed29dc87c656431650b6c3bb6939b1c5ef547199ea96c1b26373b9c94f843169628873b47e8406d02dd4f0a996564ef74d5193024e41abe6fc85c68e4e7aa75e513a27bd887ea967997f273a233ff8211d8bdfea58c647383b64a0a5435e5a8ca46b38a1a5ff79f259b1ef91de0b80bef9bb25e127f81bc299ac0fcf9358b8736547b98c69613157680fb2b3c2db5a9f2a75403660b9dccac18752c44abf4022466af4d1a982506b94425d8715e71b5a40690b4623503a4d896713188bd635d40adc76bef17d9f6d7afd8eecbeeb911df770605b4be1c242ab39529348fce4b248c8411b1006f38c4702bd60b6f8de59830739ce4b74569472fff8ebb3692a5fb0c6e053b0e08e446295f11a4a8c1b137c03c7a1b32eb68442dfffc9b87191d5a2ea7589737b7a80ce99c356a75a3250851b7bc822c6969b044ef75b3b755cbcba52d8cba3f0f8445a7c26780e11dcbf536bfaa8f9009fbfbb24e8e4a8a3cb039eb85e0e8a0a56f684a60b80409a1dcc976b7e66d0f497fb23264a72690a07a21109dd618c6589e0d2316069fed3462b7e4801612ce59883b03b96ad84285a522f43454b5e6e851908f3505d6dcf1aba123e23cbee53934e47beb1cf788b2b45f23afac4f2ae62d4e030ad6126d63f848a1dafcfad123d9c170ca52cb45b8f196dde72458fc79c7c2682c27aad666b698990c9f176f487be3343e7d2b7d40d3437b3fbae3214731fd040137d9ab22b2b8773e6060c440864c79b9890f1e71f45b54370d9101dc308d6529e14646c6970d2bdfa8ed7e7ee161a16f751555bb785c74c7a481b2a6612009249ec45c0907efb0169d312bea0bbdceaf9ed0c3866ab999d6847cce2c19e320355d673e81b24c524ed20f8a090664ef82b133fce1768148132af8623ba053e197560eecc88c2f395e361cd44e034116133afbd9be07ad9df57b1f0ae92b9d9944b0d2c7eda249807637de3b76be362138b9a8a82c28509cc9997843ea7a67e030b648b809e1b5d5857d8be863c220c287c4058eac6a007342fe8820d76c1ce32084141a82e7f675af2225bbfbcef0bf15d6da00d93f9cc5c2baf08927165be21c614f86ec9bd02072d4c86867e68b55a0121726543d7745085f01ae16b4e92252c46d38ab18312cd42366d215a2820e402a2f929d906896bb155f8e6b7b87f6f4093be6a8be23a0e1e78f60888d69eaf338cf2ca9ebe25986c8977fab0a3d21cca6ce86950cd0f523864f2ce5d9c6aa1c1e0d9c63ce214632fbaabf999c7c41ede5e540817dd1a7cac7a38e1c2ae3aed5eb686a4ae4b2d5ac8cdc9b3e4d18e82404cc23fe035733fef06319e814a9093d35f60c11ee70b9205d12fd4467cb996021c1bd5016826ab7c610eef0a34826ad7af2b22e12e4c0938326a79ade8ae8a88352e60b62d21b7a7362f659f600651af7f2ef1c1b8a26fe9527f413e6852d80f2721347dc66335941d2833de4bf3f9b79b94e7184c68b0a04c2dc89808c94a3e4246631d7fadb7e6e69d3cdb567d86c1c0f0f356cefbac0886feb0d1d022631134f6ad11433dff6609266daf1fde250bf7a8057142d72fdfe7d1f0bc250742d8dd2e6a8c5c2d4af99019a3485748809e9eb0f899f084bcbb2b412f6fa1a6df6085b357f3d9f234eb8db87b867d8c6cf1bc77a93a46721d290162662c7473ccdc7b9327546f90be28604cf47bac755b8fa5a7dab871bf7e755a6ee08322dada97037d21144bcc543fe4a95cfcedbcf8cff1e50239ebe7bca33f3f20908608bb5c86888551d84c5bf5a457232e85ba101644704fb3a52874189ba889e00d1ad83ffe6bada129670d587043244e09d5a72f8eba4504dfad939cf1938e2667cc004a1f290eb0f95c9be1e9c03682fbd8c17fd978d38d1280dbdd9846620172f5440ca587e75e0c6b6390189aab7c6b63bff0f601d42f7e13e119baef8d3c0c91fa2eb2fc91b215dd61ca33a514f89d87a74af4025df7e6c5d8db1e575da7698ce5b8cc513c9f72b87c8648c5a5f81a5b26242896b0ebe84f7dc66f2b57ad5de5404f0ab90b4b49a6374413094d880be39410a52968a382804b5b225bf61d44ab692f5a1d2d42f1117f52604735e43adc97003afea64d377d678a2ff9bf729daa001512bfec916c1703e94ba3779d8ba311f45826ffa86caa248760df2ce4ddb51896da89bbbb9af9d790eb10b2ff24d04e64940ede44ffa93ad612588c777273d09b10be48aa9433956ab3e2b96ab14c04be6e67f465b31a0e7eebac5ae01c39fd3d2fcaa2243ab4ab3ef632f0d2e5c0c99620341d4b3cb435a5e6c39bdf05d04f73c866568aa331707273a73593663a1541895a766f39ddbd7f375d98b1b47fd8ec6f51072b94c5586fce1fb43e7892d21c3b84eb76b446b77f57cdfca5400d1178fe3b7f5c93c2035e3eeae3b303fb7a5da2625eaa3609dabf898f410fdf4fd71f6524d20d57247cde5609815b5e13165d9b58a963588ac53885852a0dba95f91a07264cb73d79e7fef5f347385738f1389684cac06a5b2615e1e88dba0deedc3530a53730058cb152710f2d83c9485421328df205ab6b5a4a2c71e04d486acd8b676d1f9ccff3dffd0741f9c46df83e1cc135b44583702032d7cadea96052d96d14cf20e8bc35410533cf02d8a478a4c9911affb345dff3a7502756c33a013fbea0fe11c561e1d2be7f8d1678decf6a3c2d99f1a422cc86cf2b700c6c25bce6419f08f4a19f6bfa50e9fecee71f86cbe8a0396703d36e8eb314dcec13adbe0c5e77560a34f40ba5329671f723921cfedf6079b11cb6722d4e1bc7af7d7c53b712fd8521cd7d1c23e197c83930675d016cc39c55d94329d4e1723648c30a1924986a5e43c2db66d17f4c7a7b4c07ae39bb043ab99888a3c6b776f946182b28afc58327bef6560e73ab5e7cfa18fbf8ddf83d8600c43507586ef4b99a8d795254990d213e1d4b79c05c395f31d9279ef891f19136ddbcd2c891af42f0a5dc54054cbcc18ccaadf92eadb575c93773eb3a122915ba1d5debc226f670f5d41423012d3fccfab80cfc44a1e65bb55d43c80d2321062bf19791bd45671defa63ab1902a0d6531d460201434bb9e255f7aab5d3228deb6635df79ba6f992006625efcf704c348a7178ab593b1dd5fc4f444d76089a88da9310f62bc24ba9cfa08b0c7f4ac0f0afa7ef077f2ed6778aa808d01e575705b8479a4a2d869ee429888ccb609a4a7aa6648856071623be092e0d87b764d70d44ace9bef7452fed40c23e7bc7e719d9db9fc0a120b92904f3f86ae7ba78d2ae5997ab680f8e5d57065cbde6da7762c3ec58902c010941517905567b9cecaf86cc5f9052695ef9db5200cea10175507b5e22338c8118bfbf7b9d2fa00a3b89c425af168c37ead141f236684a73796de4a2d164db4e83d09e4643ec550072ae1f0aa11223083b178a7b56710d004b90989fedf871c656a16a0791fc0853372b390f40e7cc1368ece7df6ef35f08a52188f4e308045793e6bbf25c7ae6b0c9d1b188082f1ea6d7bf5d1b7db937489814a16c51e70bcd946dd3625320a9932e3523c3ceb4b39e51c49b59ca431bcb78b90a6a043890caefe845f9d</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-shrink">      <input class="hbe hbe-input-field hbe-input-field-shrink" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-shrink" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-shrink">Not IP of Mr.Lu ! enter some words to prove</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> ä¹¦è¯„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç”Ÿæ´»éšç¬” </tag>
            
            <tag> å†™ç»™è‡ªå·±çš„æ•£æ–‡è¯— </tag>
            
            <tag> ä¹¦è¯„ </tag>
            
            <tag> åœ¨è·¯ä¸Š </tag>
            
            <tag> Jack Kerouac </tag>
            
            <tag> èˆ’å›½æ²» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>git|nvm|npm|å‘½ä»¤è¡Œ|linux|jupyter notebookç­‰å„ç§ä¹±ä¸ƒå…«ç³Ÿçš„æŒ‡ä»¤å¤§ å…¨ï¼ˆæŒç»­æŒç»­ç¼“ç¼“æ›´æ–°ä¸­ï¼‰</title>
      <link href="/2021/08/02/git-nvm-npm-ming-ling-xing-linux-deng-ge-chong-luan-qi-ba-zao-de-zhi-ling-da-quan-chi-xu-chi-xu-huan-huan-geng-xin-zhong/"/>
      <url>/2021/08/02/git-nvm-npm-ming-ling-xing-linux-deng-ge-chong-luan-qi-ba-zao-de-zhi-ling-da-quan-chi-xu-chi-xu-huan-huan-geng-xin-zhong/</url>
      
        <content type="html"><![CDATA[<p>æœ¬åšå®¢æ›´æ–°ä¸å®šæœŸï¼ŒåŸºæœ¬ä¸Šæ˜¯æƒ³åˆ°å“ªé‡Œå°±å†™ä»€ä¹ˆï¼Œå°±æ˜¯ä¸€äº›å„ç§å¸¸è§çš„è„šæœ¬å‘½ä»¤ã€‚</p><h2 id="Anaconda"><a href="#Anaconda" class="headerlink" title="Anaconda"></a>Anaconda</h2><p>é‡åˆ°</p><blockquote><p>$ conda activate labelme</p><p>CommandNotFoundError: Your shell has not been properly configured to use â€˜conda activateâ€™.<br>If using â€˜conda activateâ€™ from a batch script, change your<br>invocation to â€˜CALL conda.bat activateâ€™.</p><p>To initialize your shell, run</p><pre><code>$ conda init &lt;SHELL_NAME&gt;</code></pre><p>Currently supported shells are:</p><ul><li>bash</li><li>cmd.exe</li><li>fish</li><li>tcsh</li><li>xonsh</li><li>zsh</li><li>powershell</li></ul><p>See â€˜conda init â€“helpâ€™ for more information and options.</p><p>IMPORTANT: You may need to close and restart your shell after running â€˜conda initâ€™.</p></blockquote><p>è¯·å‚è€ƒï¼š<a href="https://blog.csdn.net/weixin_42652125/article/details/87697902" target="_blank" rel="noopener">https://blog.csdn.net/weixin_42652125/article/details/87697902</a></p><blockquote><p>æ¿€æ´»ç¯å¢ƒï¼šsource activate</p><p>é€€å‡ºç¯å¢ƒï¼šsource deactivate</p></blockquote><h2 id="git"><a href="#git" class="headerlink" title="git"></a>git</h2><hr><h3 id="æœ¬åœ°ç»‘å®šgithubä»“åº“çš„æ›´æ”¹"><a href="#æœ¬åœ°ç»‘å®šgithubä»“åº“çš„æ›´æ”¹" class="headerlink" title="æœ¬åœ°ç»‘å®šgithubä»“åº“çš„æ›´æ”¹"></a>æœ¬åœ°ç»‘å®šgithubä»“åº“çš„æ›´æ”¹</h3><p>å½“ä½ ä»åˆ«äººçš„GitHubä»“åº“ä¸­cloneä¸‹æ¥ä¸€ä¸ªä»“åº“çš„æ—¶å€™ï¼Œgité»˜è®¤ä¼šç»‘å®šä¸€ä¸ªè¿œç«¯ä»“åº“ï¼Œè¿™ä¸ªä»“åº“å°±æ˜¯åˆ«äººçš„ä»“åº“ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬æƒ³è¦æ›´æ”¹ç»‘å®šçš„ä»“åº“çš„æ—¶å€™ï¼Œéœ€è¦æ›´æ”¹å…¶é…ç½®çš„æœ‰å…³æ–‡ä»¶ï¼Œå…·ä½“æ“ä½œå¯ä»¥å‚è€ƒä¸‹é¢è¿™ä¸€ç¯‡åšå®¢ï¼š<a href="https://blog.csdn.net/asdfsfsdgdfgh/article/details/54981823" target="_blank" rel="noopener">https://blog.csdn.net/asdfsfsdgdfgh/article/details/54981823</a></p><h3 id="å…³äºä¸Šä¼ æ–‡ä»¶è¿‡å¤§å¤±è´¥"><a href="#å…³äºä¸Šä¼ æ–‡ä»¶è¿‡å¤§å¤±è´¥" class="headerlink" title="å…³äºä¸Šä¼ æ–‡ä»¶è¿‡å¤§å¤±è´¥"></a>å…³äºä¸Šä¼ æ–‡ä»¶è¿‡å¤§å¤±è´¥</h3><p>é‡åˆ°ç±»ä¼¼è¿™ç±»æŠ¥é”™<code>fatal: The remote end hung up unexpectedly</code>å¾ˆæœ‰å¯èƒ½æ˜¯å› ä¸ºä¸Šä¼ çš„æ–‡ä»¶è¶…è¿‡äº† 50Mçš„é™åˆ¶ï¼Œå¦‚æœæˆ‘ä»¬æ‰§æ„è¦ä¸Šä¼ æˆ‘ä»¬å¯ä»¥é€‰æ‹©å‘½ä»¤<code>git config --global http.postBuffer 524288000</code>æ¥æå‡æœ€å¤§å®¹é‡ä¸º500MBï¼Œå‚è€ƒè‡ª<a href="https://stackoverflow.com/questions/15240815/git-fatal-the-remote-end-hung-up-unexpectedly" target="_blank" rel="noopener">Stackoverflow</a>ã€‚</p><p>å½“ç„¶å¦‚æœä½ è¦å–æ¶ˆä¸Šä¼ é‚£ä¸ªå¾ˆå¤§çš„æ–‡ä»¶ï¼Œé‚£åªèƒ½é€‰æ‹©ä»commitè¿‡çš„ ä¸œè¥¿é‡Œé¢åˆ æ‰ä»–ï¼Œä½†æ˜¯ç›®å‰æˆ‘è¿˜ä¸æ€ä¹ˆä¼šåˆ ï¼Œåˆ°æ—¶å€™å†è¯´å§ã€‚</p><h3 id="Linuxä¹Œç­å›¾ç³»ç»Ÿé€šè¿‡sshé“¾æ¥gitå¤±è´¥"><a href="#Linuxä¹Œç­å›¾ç³»ç»Ÿé€šè¿‡sshé“¾æ¥gitå¤±è´¥" class="headerlink" title="Linuxä¹Œç­å›¾ç³»ç»Ÿé€šè¿‡sshé“¾æ¥gitå¤±è´¥"></a>Linuxä¹Œç­å›¾ç³»ç»Ÿé€šè¿‡sshé“¾æ¥gitå¤±è´¥</h3><p>ç”±äºå½“æ—¶æœåŠ¡å™¨çš„å…å¯†é’¥ç™»å½•æ—¶å€™ç”¨åˆ°äº†id_rsa.pub,æˆ‘å¯¹gitè¿æ¥æˆ‘è‡ªå·±çš„GitHubçš„æ—¶å€™è¦æ–°åˆ›å»ºä¸€ä¸ªid_rsa,æˆ‘ä¸ºäº†é˜²æ­¢å…å¯†ç™»å½•å‡ºé—®é¢˜æ²¡æœ‰åˆ›å»ºåŒåçš„æ–‡ä»¶id_rsa.pubï¼ˆè¿™ä¹Ÿæ˜¯æœåŠ¡å™¨gité»˜è®¤çš„å…¬é’¥æ–‡ä»¶ï¼‰,è€Œæ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„æ–‡ä»¶å«åšid_rsaforgit.pub.è¿™å¯¼è‡´æ¯ä¸€æ¬¡ç™»å½•æœåŠ¡å™¨åä½¿ç”¨sshè®¿é—®GitHubéƒ½ä¼šå‡ºå·®é”™ã€‚<br>æ¯”å¦‚è¯´æˆ‘è¾“å…¥ä»¥ä¸‹æŒ‡ä»¤ï¼š</p><pre class="line-numbers language-python"><code class="language-python">ssh <span class="token operator">-</span>T git@github<span class="token punctuation">.</span>com<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ ·å°±ä¼šå‡ºé—®é¢˜æŠ¥é”™ï¼š</p><pre class="line-numbers language-python"><code class="language-python">git@github<span class="token punctuation">.</span>com<span class="token punctuation">:</span> Permission denied <span class="token punctuation">(</span>publickey<span class="token punctuation">)</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å› ä¸ºGitHubé»˜è®¤è®¤è¯çš„æ˜¯id_rsaè¿™ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯æˆ‘æ–°å»ºçš„æ–‡ä»¶åå­—å«åšid_rsaforgitï¼Œæ‰€ä»¥è¿™äº§ç”Ÿäº†å†²çªï¼Œå¯¼è‡´è¿æ¥GitHubå‡ºç°é—®é¢˜ï¼Œè¦è§£å†³è¿™ä¸ªé—®é¢˜å°±æ˜¯è¦æŠŠæ–‡ä»¶id_rsaforgitåŠ è¿›å»ï¼Œåªéœ€è¦ä¸‹é¢çš„æŒ‡ä»¤ï¼š</p><pre class="line-numbers language-python"><code class="language-python">eval $<span class="token punctuation">(</span>ssh<span class="token operator">-</span>agent <span class="token operator">-</span>s<span class="token punctuation">)</span>ssh<span class="token operator">-</span>add <span class="token operator">~</span><span class="token operator">/</span><span class="token punctuation">.</span>ssh<span class="token operator">/</span>id_rsaforgit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¿™æ ·å°±æˆåŠŸè¿æ¥GitHubäº†ã€‚å…·ä½“å¯å‚è€ƒï¼š<a href="https://stackoverflow.com/questions/2643502/git-how-to-solve-permission-denied-publickey-error-when-using-git" target="_blank" rel="noopener">https://stackoverflow.com/questions/2643502/git-how-to-solve-permission-denied-publickey-error-when-using-git</a> ã€‚</p><h3 id="å¤šäººç®¡ç†githubåˆ†æ”¯"><a href="#å¤šäººç®¡ç†githubåˆ†æ”¯" class="headerlink" title="å¤šäººç®¡ç†githubåˆ†æ”¯"></a>å¤šäººç®¡ç†githubåˆ†æ”¯</h3><p>çƒ½ç«é¡¹ç›®æˆ‘é¦–å…ˆæ˜¯gitcloneäº†mmdetectionçš„é¡¹ç›®ï¼Œç„¶ååœ¨æœ¬åœ°è¿›è¡Œäº†æœ‰å…³çš„ä¿®æ”¹è°ƒè¯•ï¼Œæœ€åè·‘å‡ºäº†ä¸€ä¸ªdemoã€‚æ¥ä¸‹æ¥ç”±äºè¦å›¢é˜Ÿåä½œå¯¹äºå·¥ä½œè¿›è¡Œç›¸å…³çš„ä¿®æ”¹ï¼Œæ‰€ä»¥éœ€è¦æˆ‘æ–°å»ºä¸€ä¸ªGitHubçš„ä»“åº“è¿›è¡Œåä½œï¼Œä½†æ˜¯å‡ºç°äº†ä»¥ä¸‹è¿™ä¹ˆäº›é—®é¢˜ï¼Œé¦–å…ˆå°±æ˜¯ç”±äºæˆ‘cloneçš„mmdetectionï¼Œè¿™ä¸ªé¡¹ç›®æœ¬èº«æŒ‡å‘çš„è¿œç¨‹ä»“åº“æ˜¯openmmlabå®˜æ–¹çš„ä»“åº“ï¼Œæ‰€ä»¥æˆ‘éœ€è¦è®©æœ¬åœ°çš„è¿™ä¸ªä»“åº“è¿æ¥åˆ°æˆ‘çš„ä¸€ä¸ªæ–°çš„ä»“åº“ä¸­ä»¥æ–¹ä¾¿æˆ‘è¿›è¡Œç›¸å…³çš„ä¿®æ”¹ã€‚å¦å¤–ä¸€ä¸ªé—®é¢˜å°±æ˜¯ç”±äºæˆ‘æ–°å»ºçš„ä»“åº“åŒæ ·æ˜¯forkçš„mmdetectionè¿™ä¸ªä»“åº“ï¼Œè¿™ä¸ªé¡¹ç›®æ˜¯æ–°forkçš„ï¼Œæ‰€ä»¥è¿™æœŸé—´è¯¥é¡¹ç›®openmmlabå®˜æ–¹å·²ç»å¯¹äºè¿™ä¸ªåšäº†è®¸è®¸å¤šå¤šçš„æ–°çš„pushä¿®æ”¹ï¼Œæ‰€ä»¥æˆ‘ä¸èƒ½ç®€å•åœ°ç›´æ¥è¿æ¥åˆ°æ–°forkçš„ä»“åº“ä¸­ï¼Œè¿™ä¼šäº§ç”Ÿå†²çªï¼Œæ‰€ä»¥æˆ‘å¿…é¡»é¦–å…ˆmergeä¸‹ï¼Œå‚è€ƒäº†å»–é›ªå³°çš„ä¸€äº›ç½‘ç«™ï¼Œä¸ªäººè®¤ä¸ºå¯¹äºè¿™ä¸ªè®²å¾—éå¸¸å¥½ï¼š</p><ul><li><a href="https://www.liaoxuefeng.com/wiki/896043488029600/900375748016320" target="_blank" rel="noopener">https://www.liaoxuefeng.com/wiki/896043488029600/900375748016320</a></li><li><a href="https://www.liaoxuefeng.com/wiki/896043488029600/900004111093344" target="_blank" rel="noopener">https://www.liaoxuefeng.com/wiki/896043488029600/900004111093344</a></li></ul><h3 id="ç‰ˆæœ¬å›é€€"><a href="#ç‰ˆæœ¬å›é€€" class="headerlink" title="ç‰ˆæœ¬å›é€€"></a>ç‰ˆæœ¬å›é€€</h3><p>å¦‚æœæˆ‘ç°åœ¨æœ‰ç€ä¸€ä¸ªcommitï¼Œä½†æ˜¯æˆ‘æƒ³å›é€€åˆ°æœ€åˆçš„ä¸€ä¸ªcommitä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆçœ‹ä¸€ä¸‹<code>git log</code>çœ‹ä¸€ä¸‹è‡ªå·±çš„git æ—¥å¿—ï¼š</p><pre class="line-numbers language-python"><code class="language-python">lry@ubuntu <span class="token operator">~</span><span class="token operator">/</span>projects<span class="token operator">/</span>mmdetection <span class="token operator">%</span> git logcommit <span class="token number">77c40047ced6f62a27559ab35ae18e10ea6aede0</span> <span class="token punctuation">(</span>HEAD <span class="token operator">-</span><span class="token operator">></span> master<span class="token punctuation">)</span>Author<span class="token punctuation">:</span> LRY89757 <span class="token operator">&lt;</span>lry89757@gmail<span class="token punctuation">.</span>com<span class="token operator">></span>Date<span class="token punctuation">:</span>   Sun Dec <span class="token number">5</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">04</span><span class="token punctuation">:</span><span class="token number">19</span> <span class="token number">2021</span> <span class="token operator">+</span><span class="token number">0800</span>    Classification Task finishedcommit fe5a1350d33e954d10052b88ef719dc779d61ec0Author<span class="token punctuation">:</span> LRY89757 <span class="token operator">&lt;</span>lry89757@gmail<span class="token punctuation">.</span>com<span class="token operator">></span>Date<span class="token punctuation">:</span>   Sat Dec <span class="token number">4</span> <span class="token number">23</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">:</span><span class="token number">33</span> <span class="token number">2021</span> <span class="token operator">+</span><span class="token number">0800</span>    Classification Task finishedcommit <span class="token number">1b6345c86eb268702bd7858dd8ba2ec8797662fd</span> <span class="token punctuation">(</span>origin<span class="token operator">/</span>master<span class="token punctuation">)</span>Author<span class="token punctuation">:</span> LRY89757 <span class="token operator">&lt;</span>lry89757@gmail<span class="token punctuation">.</span>com<span class="token operator">></span>Date<span class="token punctuation">:</span>   Thu Dec <span class="token number">2</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">26</span><span class="token punctuation">:</span><span class="token number">39</span> <span class="token number">2021</span> <span class="token operator">+</span><span class="token number">0800</span>    update the single device dataset <span class="token operator">and</span> write a naive dataloadercommit <span class="token number">8028ae36658d3a81f8bccdd3fbba54625dd02259</span>Author<span class="token punctuation">:</span> LRY89757 <span class="token operator">&lt;</span>lry89757@gmail<span class="token punctuation">.</span>com<span class="token operator">></span>Date<span class="token punctuation">:</span>   Wed Dec <span class="token number">1</span> <span class="token number">13</span><span class="token punctuation">:</span><span class="token number">09</span><span class="token punctuation">:</span><span class="token number">08</span> <span class="token number">2021</span> <span class="token operator">+</span><span class="token number">0800</span>    update the notes <span class="token operator">and</span> image processingcommit <span class="token number">748e20073068610b316f50f1638738c16e493d89</span>Merge<span class="token punctuation">:</span> <span class="token number">7ce44f5c</span> a7a16afbAuthor<span class="token punctuation">:</span> LRY89757 <span class="token operator">&lt;</span>lry89757@gmail<span class="token punctuation">.</span>com<span class="token operator">></span>Date<span class="token punctuation">:</span>   Mon Nov <span class="token number">29</span> <span class="token number">17</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">:</span><span class="token number">40</span> <span class="token number">2021</span> <span class="token operator">+</span><span class="token number">0800</span>    Merge branch <span class="token string">'master'</span> of github<span class="token punctuation">.</span>com<span class="token punctuation">:</span>LRY89757<span class="token operator">/</span>mmdetectioncommit <span class="token number">7ce44f5ce6c19ed0b752e43874ee880db4745553</span>Author<span class="token punctuation">:</span> LRY89757 <span class="token operator">&lt;</span>lry89757@gmail<span class="token punctuation">.</span>com<span class="token operator">></span>Date<span class="token punctuation">:</span>   Mon Nov <span class="token number">29</span> <span class="token number">17</span><span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token number">58</span> <span class="token number">2021</span> <span class="token operator">+</span><span class="token number">0800</span>    a simple demo of Instance Segmentationcommit a7a16afbf2a4bdb4d023094da73d325cb864838b <span class="token punctuation">(</span>origin<span class="token operator">/</span>dev<span class="token operator">-</span>v2<span class="token number">.20</span><span class="token punctuation">.</span><span class="token number">0</span><span class="token punctuation">,</span> origin<span class="token operator">/</span>dev<span class="token operator">-</span>v2<span class="token number">.19</span><span class="token punctuation">.</span><span class="token number">1</span><span class="token punctuation">)</span>Author<span class="token punctuation">:</span> Charlie Chang <span class="token operator">&lt;</span>s94040511s@gmail<span class="token punctuation">.</span>com<span class="token operator">></span>Date<span class="token punctuation">:</span>   Fri Nov <span class="token number">19</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">47</span> <span class="token number">2021</span> <span class="token operator">+</span><span class="token number">0800</span>    Clean unnecessary custom_imports <span class="token keyword">in</span> entrypoints <span class="token punctuation">(</span><span class="token comment" spellcheck="true">#6546)</span>commit c76ab0eb3c637b86c343d8454e07e00cfecc1b78 <span class="token punctuation">(</span>tag<span class="token punctuation">:</span> v2<span class="token number">.18</span><span class="token punctuation">.</span><span class="token number">1</span><span class="token punctuation">)</span>Author<span class="token punctuation">:</span> RangiLyu <span class="token operator">&lt;</span>lyuchqi@gmail<span class="token punctuation">.</span>com<span class="token operator">></span>Date<span class="token punctuation">:</span>   Mon Nov <span class="token number">15</span> <span class="token number">23</span><span class="token punctuation">:</span><span class="token number">55</span><span class="token punctuation">:</span><span class="token number">37</span> <span class="token number">2021</span> <span class="token operator">+</span><span class="token number">0800</span>    bump version to v2<span class="token number">.18</span><span class="token punctuation">.</span><span class="token number">1</span> <span class="token punctuation">(</span><span class="token comment" spellcheck="true">#6510)</span>    <span class="token operator">*</span> bump version to v2<span class="token number">.18</span><span class="token punctuation">.</span><span class="token number">1</span>    <span class="token operator">*</span> Update changelog<span class="token punctuation">.</span>mdcommit <span class="token number">2cc0fdb25bcd7341d084889aeeef515b17d08984</span>Author<span class="token punctuation">:</span> Andrea Panizza <span class="token operator">&lt;</span><span class="token number">8233615</span><span class="token operator">+</span>AndreaPi@users<span class="token punctuation">.</span>noreply<span class="token punctuation">.</span>github<span class="token punctuation">.</span>com<span class="token operator">></span>Date<span class="token punctuation">:</span>   Mon Nov <span class="token number">15</span> <span class="token number">12</span><span class="token punctuation">:</span><span class="token number">21</span><span class="token punctuation">:</span><span class="token number">02</span> <span class="token number">2021</span> <span class="token operator">+</span><span class="token number">0100</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è€Œåæˆ‘ä»¬å¦‚æœæƒ³è¦å›åˆ°ä¸Šé¢çš„ç¬¬ä¸‰ä¸ªcommitåœ°æ–¹çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å®ƒå‰é¢çš„commitçš„ç‰¹å®šå­—ç¬¦<code>1b6345</code>ï¼š</p><pre class="line-numbers language-python"><code class="language-python">lry@ubuntu <span class="token operator">~</span><span class="token operator">/</span>projects<span class="token operator">/</span>mmdetection <span class="token operator">%</span> git reset <span class="token operator">-</span>s <span class="token number">1b634</span>error<span class="token punctuation">:</span> unknown switch `s'usage<span class="token punctuation">:</span> git reset <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>mixed <span class="token operator">|</span> <span class="token operator">-</span><span class="token operator">-</span>soft <span class="token operator">|</span> <span class="token operator">-</span><span class="token operator">-</span>hard <span class="token operator">|</span> <span class="token operator">-</span><span class="token operator">-</span>merge <span class="token operator">|</span> <span class="token operator">-</span><span class="token operator">-</span>keep<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>q<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>commit<span class="token operator">></span><span class="token punctuation">]</span>   <span class="token operator">or</span><span class="token punctuation">:</span> git reset <span class="token punctuation">[</span><span class="token operator">-</span>q<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>tree<span class="token operator">-</span>ish<span class="token operator">></span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span>paths<span class="token operator">></span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>   <span class="token operator">or</span><span class="token punctuation">:</span> git reset <span class="token operator">-</span><span class="token operator">-</span>patch <span class="token punctuation">[</span><span class="token operator">&lt;</span>tree<span class="token operator">-</span>ish<span class="token operator">></span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>paths<span class="token operator">></span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å½“ç„¶è¿™é‡ŒæŠ¥é”™äº†ï¼Œæ­£å¸¸æ¥è¯´è¿™ä¹ˆåšæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†<code>-s</code>æ”¹ä¸º<code>--soft</code>, å°±æ²¡é—®é¢˜äº†:</p><pre class="line-numbers language-python"><code class="language-python">lry@ubuntu <span class="token operator">~</span><span class="token operator">/</span>projects<span class="token operator">/</span>mmdetection <span class="token operator">%</span> git reset <span class="token operator">-</span><span class="token operator">-</span>soft <span class="token number">1b634</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="æŒ‡ä»¤"><a href="#æŒ‡ä»¤" class="headerlink" title="æŒ‡ä»¤"></a>æŒ‡ä»¤</h3><pre class="line-numbers language-sh"><code class="language-sh">git clone sshåœ°å€   # é¡¹ç›®å…‹éš†åˆ°æœ¬åœ°git add .    # æäº¤åˆ°æš‚å­˜åŒºï¼Ÿå¥½åƒæ˜¯git commit -m""   # æäº¤åˆ°ä»“åº“git push origin main(master)# æäº¤åˆ°è¿œç¨‹ä»“åº“git clone ssh or http  # å…‹éš†åˆ°æœ¬åœ°<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æš‚æ—¶å°±è¿™ä¹ˆå¤š</p><h3 id="æœ¬åœ°ä»£ç ä¸Šä¼ åˆ°githubä»“åº“"><a href="#æœ¬åœ°ä»£ç ä¸Šä¼ åˆ°githubä»“åº“" class="headerlink" title="æœ¬åœ°ä»£ç ä¸Šä¼ åˆ°githubä»“åº“"></a>æœ¬åœ°ä»£ç ä¸Šä¼ åˆ°githubä»“åº“</h3><pre class="line-numbers language-shell"><code class="language-shell">git init  # å»ºç«‹gitä»“åº“ï¼Œcdåˆ°æœ¬åœ°é¡¹ç›®æ ¹ç›®å½•git add .  # å°†é¡¹ç›®æ‰€æœ‰æ–‡ä»¶æ·»åŠ åˆ°ä»“åº“ä¸­git commit -m"è¯´æ˜è¯­å¥"  # å°†æ–‡ä»¶commitåˆ°ä»“åº“# å»githubåˆ›å»ºè‡ªå·±çš„Repository<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://pic1.zhimg.com/80/v2-a4e249c5e85f6f5ca6c56fc916c150ac_1440w.jpg" alt></p><p>ç‚¹å‡»<strong>Clone or download</strong>æŒ‰é’®ï¼Œå¤åˆ¶å¼¹å‡ºçš„åœ°å€<strong><a href="mailto:git@github.com" target="_blank" rel="noopener">git@github.com</a>:\</strong>*/test.git**ï¼Œè®°å¾—è¦ç”¨SSHçš„åœ°å€ï¼Œå°½é‡ä¸è¦ç”¨HTTPSçš„åœ°å€ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤º</p><p><strong>å°†æœ¬åœ°çš„ä»“åº“å…³è”åˆ°githubä¸Šâ€”æŠŠä¸Šä¸€æ­¥å¤åˆ¶çš„åœ°å€æ”¾åˆ°ä¸‹é¢</strong></p><pre class="line-numbers language-shell"><code class="language-shell">git remote add origin git@github.com:***/***.git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸Šä¼ åˆ°githubä¹‹å‰ï¼Œå…ˆpullä¸€ä¸‹ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">git pull origin main(or master)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸Šä¼ åˆ°githubè¿œç¨‹ä»“åº“</p><pre class="line-numbers language-shell"><code class="language-shell">git push -u origin master<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="nvm"><a href="#nvm" class="headerlink" title="nvm"></a>nvm</h2><hr><h3 id="æŒ‡ä»¤-1"><a href="#æŒ‡ä»¤-1" class="headerlink" title="æŒ‡ä»¤"></a>æŒ‡ä»¤</h3><pre class="line-numbers language-shell"><code class="language-shell">nvm lsnvm list  # åˆ—å‡ºå½“å‰nodeåŒ…nvm -v  # åˆ—å‡ºnvmç‰ˆæœ¬nvm use ç‰ˆæœ¬å·  # ä½¿ç”¨å“ªä¸ªç‰ˆæœ¬nvm install ç‰ˆæœ¬å·  # ä¸‹è½½å“ªä¸ªç‰ˆæœ¬<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="åŠ é€Ÿæº"><a href="#åŠ é€Ÿæº" class="headerlink" title="åŠ é€Ÿæº"></a>åŠ é€Ÿæº</h3><p>åœ¨settings.txtåé¢åŠ ä¸Šæˆ‘ä»¬çš„è¿™ä¹ˆå‡ è¡Œä»£ç ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">proxy:node_mirror: https://npm.taobao.org/mirrors/node/npm_mirror: https://npm.taobao.org/mirrors/npm/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥åŠ é€Ÿæˆ‘ä»¬çš„ä¸‹è½½</p><h3 id="è®°å¾—æœ‰æ—¶å€™è¦æ›´æ”¹ç¯å¢ƒå˜é‡"><a href="#è®°å¾—æœ‰æ—¶å€™è¦æ›´æ”¹ç¯å¢ƒå˜é‡" class="headerlink" title="è®°å¾—æœ‰æ—¶å€™è¦æ›´æ”¹ç¯å¢ƒå˜é‡"></a>è®°å¾—æœ‰æ—¶å€™è¦æ›´æ”¹ç¯å¢ƒå˜é‡</h3><h2 id="npm"><a href="#npm" class="headerlink" title="npm"></a>npm</h2><hr><h3 id="æŒ‡ä»¤-2"><a href="#æŒ‡ä»¤-2" class="headerlink" title="æŒ‡ä»¤"></a>æŒ‡ä»¤</h3><pre class="line-numbers language-shell"><code class="language-shell">npm inpm install # éƒ½æ˜¯å®‰è£…å¯¹åº”åŒ…ï¼Œä½†æ˜¯å‰è€…ä¼šæ‰¾åˆ°æœ€æ–°çš„åŒ…ç»™ä½ å®‰è£…ï¼ˆä¼¼ä¹æ˜¯è¿™æ ·<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="shellå‘½ä»¤"><a href="#shellå‘½ä»¤" class="headerlink" title="shellå‘½ä»¤"></a>shellå‘½ä»¤</h2><hr><h2 id="hexo"><a href="#hexo" class="headerlink" title="hexo"></a>hexo</h2><hr><pre class="line-numbers language-shell"><code class="language-shell">hexo clean && hexo g && hexo dhexo clean && hexo g && hexo shexo -v<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="ä¼ ç»Ÿå»ºç«‹æ–‡ç« æ–¹å¼"><a href="#ä¼ ç»Ÿå»ºç«‹æ–‡ç« æ–¹å¼" class="headerlink" title="ä¼ ç»Ÿå»ºç«‹æ–‡ç« æ–¹å¼"></a>ä¼ ç»Ÿå»ºç«‹æ–‡ç« æ–¹å¼</h3><p>ä¸€èˆ¬æˆ‘ä»¬éƒ½ä¼šä½¿ç”¨ <code>hexo new &lt;title&gt;</code> æ¥å»ºç«‹æ–‡ç« ï¼Œè¿™ç§å»ºç«‹æ–¹æ³•ä¼šå°†æ–°æ–‡ç« å»ºç«‹åœ¨ <code>source/_posts</code> ç›®å½•ä¸‹ï¼Œå½“ä½¿ç”¨ <code>hexo generate</code> ç¼–è¯‘ markdown æ–‡ä»¶æ—¶ï¼Œä¼šå°†å…¶ HTML ç»“æœç¼–è¯‘åœ¨ <code>public</code> ç›®å½•ä¸‹ï¼Œä¹‹å <code>hexo deploy</code> å°†ä¼šæŠŠ <code>public</code> ç›®å½•ä¸‹æ‰€æœ‰æ–‡ç« éƒ¨ç½²åˆ° GitHubï¼Œè¿™æ˜¯æˆ‘ä»¬ç†Ÿæ‚‰çš„ Hexo æµç¨‹ã€‚</p><p>è¿™ç§å»ºç«‹æ–‡ç« æ–¹å¼çš„ç¼ºç‚¹æ˜¯ï¼šè‹¥æˆ‘ä»¬åŒæ—¶ç¼–è¾‘å¤šç¯‡æ–‡ç« ï¼Œåªè¦å…¶ä¸­ä¸€ç¯‡æ–‡ç« å°šæœªç¼–è¾‘å®Œæˆï¼Œä¹Ÿä¼šéšç€ <code>hexo deploy</code> ä¸€èµ·éƒ¨ç½²åˆ° GitHubï¼Œä¹Ÿå°±æ˜¯ GitHub å¯èƒ½ä¼šçœ‹åˆ°æˆ‘ä»¬å°šæœªå®Œæˆçš„æ–‡ç« ã€‚</p><h3 id="å»ºç«‹æ–‡ç« è‰ç¨¿"><a href="#å»ºç«‹æ–‡ç« è‰ç¨¿" class="headerlink" title="å»ºç«‹æ–‡ç« è‰ç¨¿"></a>å»ºç«‹æ–‡ç« è‰ç¨¿</h3><pre><code>$ hexo new draft &lt;title&gt;</code></pre><p>Hexo å¦å¤–æä¾› <code>draft</code> æœºåˆ¶ï¼Œå®ƒçš„åŸç†æ˜¯æ–°æ–‡ç« å°†å»ºç«‹åœ¨ <code>source/_drafts</code> ç›®å½•ä¸‹ï¼Œå› æ­¤ <code>hexo generate</code> å¹¶ä¸ä¼šå°†å…¶ç¼–è¯‘åˆ° <code>public</code> ç›®å½•ä¸‹ï¼Œæ‰€ä»¥ <code>hexo deploy</code> ä¹Ÿä¸ä¼šå°†å…¶éƒ¨ç½²åˆ° GitHubã€‚</p><h3 id="æœ¬æœºé¢„è§ˆè‰ç¨¿"><a href="#æœ¬æœºé¢„è§ˆè‰ç¨¿" class="headerlink" title="æœ¬æœºé¢„è§ˆè‰ç¨¿"></a>æœ¬æœºé¢„è§ˆè‰ç¨¿</h3><pre><code>$ hexo S --draft</code></pre><p>è™½ç„¶ <code>hexo generate</code> ä¸ä¼šç¼–è¯‘ <code>source/_drafts</code> ç›®å½•ä¸‹çš„æ–‡ç« ï¼Œä½† Hexo çš„ <code>Hexo server</code> å¦å¤–æä¾› <code>--draft</code> å‚æ•°ï¼Œè¿™è®©æˆ‘ä»¬åªè¦æ­é… <code>hexo-browsersync</code> pluginsï¼Œå°±å¯ä»¥è¾¾åˆ°ä¸€è¾¹ç¼–è¾‘ <code>markdown</code> æ–‡ç« ï¼Œä¸€è¾¹ä½¿ç”¨æµè§ˆå™¨é¢„è§ˆçš„ç›®çš„ã€‚</p><h3 id="å°†è‰ç¨¿å‘å¸ƒä¸ºæ­£å¼æ–‡ç« "><a href="#å°†è‰ç¨¿å‘å¸ƒä¸ºæ­£å¼æ–‡ç« " class="headerlink" title="å°†è‰ç¨¿å‘å¸ƒä¸ºæ­£å¼æ–‡ç« "></a>å°†è‰ç¨¿å‘å¸ƒä¸ºæ­£å¼æ–‡ç« </h3><pre><code>$ hexo P &lt;filename&gt;</code></pre><p>å…¶ä¸­ <code>&lt;filename&gt;</code> ä¸ºä¸åŒ…å« <code>md</code> åç¼€çš„æ–‡ç« åç§°ã€‚å®ƒçš„åŸç†åªæ˜¯å°†æ–‡ç« ä» <code>source/_drafts</code> ç§»åŠ¨åˆ° <code>source/_posts</code> è€Œå·²ã€‚</p><p>ä¹‹åçš„ <code>hexo generate</code> ä¸ <code>hexo deploy</code> çš„ç”¨æ³•å°±å®Œå…¨ä¸€æ ·äº†ã€‚</p><p>è‹¥æ—¥åæƒ³å°†æ­£å¼æ–‡ç« è½¬ä¸ºä¸ºè‰ç¨¿ï¼Œåªéœ€æ‰‹åŠ¨å°†æ–‡ç« ä» <code>source/_posts</code> ç›®å½•ç§»åŠ¨åˆ° <code>source/_drafts</code> ç›®å½•å³å¯ã€‚</p><h2 id="jupyter-notebook"><a href="#jupyter-notebook" class="headerlink" title="jupyter notebook"></a>jupyter notebook</h2><hr><p>.ipynbè½¬æ¢ä¸º.mdã€.pdfã€.texç­‰æ ¼å¼ï¼š<a href="https://blog.csdn.net/red_stone1/article/details/73380517" target="_blank" rel="noopener">https://blog.csdn.net/red_stone1/article/details/73380517</a></p><p><a href="https://blog.csdn.net/qq_35423500/article/details/79565146" target="_blank" rel="noopener">cellçš„markdownä¸codeæŒ‡ä»¤å¿«é€Ÿæ›´æ¢</a>:åœ¨vscodeä¸­å¯ä»¥é€‰æ‹©tab+y or tab+mè‡ªç”±åˆ‡æ¢ï¼Œè¿˜æœ‰ä¸€ç¯‡<a href="https://blog.csdn.net/wield_jjz/article/details/105607301?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-0.control&spm=1001.2101.3001.4242" target="_blank" rel="noopener">åšå®¢</a>è®²çš„ä¹ŸæŒºå¥½</p><h2 id="æ”¹ç¯å¢ƒå˜é‡"><a href="#æ”¹ç¯å¢ƒå˜é‡" class="headerlink" title="æ”¹ç¯å¢ƒå˜é‡"></a>æ”¹ç¯å¢ƒå˜é‡</h2><hr><p><code>Win + R</code> ï¼Œè¾“å…¥ï¼š<code>SystemPropertiesAdvanced.exe</code> ï¼Œå›è½¦ã€‚</p><p>ç„¶åç‚¹å‡» <code>ç¯å¢ƒå˜é‡</code> ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="git-nvm-npm-%E5%91%BD%E4%BB%A4%E8%A1%8C-linux%E7%AD%89%E5%90%84%E7%A7%8D%E4%B9%B1%E4%B8%83%E5%85%AB%E7%B3%9F%E7%9A%84%E6%8C%87%E4%BB%A4%E5%A4%A7-%E5%85%A8%EF%BC%88%E6%8C%81%E7%BB%AD%E6%8C%81%E7%BB%AD%E7%BC%93%E7%BC%93%E6%9B%B4%E6%96%B0%E4%B8%AD%EF%BC%89%5C1.png" alt="0"></p><p>æ‰¾åˆ° <code>ç”¨æˆ·å˜é‡</code> ä¸­çš„ <code>Path</code> ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="git-nvm-npm-%E5%91%BD%E4%BB%A4%E8%A1%8C-linux%E7%AD%89%E5%90%84%E7%A7%8D%E4%B9%B1%E4%B8%83%E5%85%AB%E7%B3%9F%E7%9A%84%E6%8C%87%E4%BB%A4%E5%A4%A7-%E5%85%A8%EF%BC%88%E6%8C%81%E7%BB%AD%E6%8C%81%E7%BB%AD%E7%BC%93%E7%BC%93%E6%9B%B4%E6%96%B0%E4%B8%AD%EF%BC%89%5C2.png" alt></p><p>ç„¶ååœ¨é‡Œé¢ä¿®æ”¹ä¸€ä¸‹ <code>npm</code> çš„è·¯å¾„ï¼Œæˆ‘çš„æ˜¯è¿™æ ·çš„ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="git-nvm-npm-%E5%91%BD%E4%BB%A4%E8%A1%8C-linux%E7%AD%89%E5%90%84%E7%A7%8D%E4%B9%B1%E4%B8%83%E5%85%AB%E7%B3%9F%E7%9A%84%E6%8C%87%E4%BB%A4%E5%A4%A7-%E5%85%A8%EF%BC%88%E6%8C%81%E7%BB%AD%E6%8C%81%E7%BB%AD%E7%BC%93%E7%BC%93%E6%9B%B4%E6%96%B0%E4%B8%AD%EF%BC%89%5C4.png" alt></p><p>ç‚¹å‡»ç¡®è®¤ä¹‹åï¼Œå†è¿›å…¥ <code>ç³»ç»Ÿå˜é‡</code> ï¼Œæ‰¾åˆ° <code>PATH</code> ï¼Œç‚¹å‡»ç¼–è¾‘ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="git-nvm-npm-%E5%91%BD%E4%BB%A4%E8%A1%8C-linux%E7%AD%89%E5%90%84%E7%A7%8D%E4%B9%B1%E4%B8%83%E5%85%AB%E7%B3%9F%E7%9A%84%E6%8C%87%E4%BB%A4%E5%A4%A7-%E5%85%A8%EF%BC%88%E6%8C%81%E7%BB%AD%E6%8C%81%E7%BB%AD%E7%BC%93%E7%BC%93%E6%9B%B4%E6%96%B0%E4%B8%AD%EF%BC%89%5C5.png" alt></p><p>ç„¶åä¿®æ”¹ <code>nodejs</code> çš„è·¯å¾„ï¼Œæˆ‘çš„æ˜¯è¿™æ ·çš„ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="git-nvm-npm-%E5%91%BD%E4%BB%A4%E8%A1%8C-linux%E7%AD%89%E5%90%84%E7%A7%8D%E4%B9%B1%E4%B8%83%E5%85%AB%E7%B3%9F%E7%9A%84%E6%8C%87%E4%BB%A4%E5%A4%A7-%E5%85%A8%EF%BC%88%E6%8C%81%E7%BB%AD%E6%8C%81%E7%BB%AD%E7%BC%93%E7%BC%93%E6%9B%B4%E6%96%B0%E4%B8%AD%EF%BC%89%5C6.png" alt></p><p>ç„¶åå°±å¯ä»¥æ­£å¸¸è¿è¡Œäº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æŒ‡ä»¤é›† </category>
          
          <category> shellå‘½ä»¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
            <tag> nvm </tag>
            
            <tag> npm </tag>
            
            <tag> linux </tag>
            
            <tag> å‘½ä»¤è¡Œ </tag>
            
            <tag> nodejs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€äº›å°çŸ¥è¯†</title>
      <link href="/2021/08/02/yi-xie-xiao-zhi-shi/"/>
      <url>/2021/08/02/yi-xie-xiao-zhi-shi/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="ä¼¼ä¹ä¸å¤ªæ­£ç¡®â€¦â€¦ç®—äº†å§ï¼Œæ²¡å•¥å¥½çœ‹çš„" data-whm="æŠ±æ­‰, è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹.">  <script id="hbeData" type="hbeData" data-hmacdigest="34cee35cb45aed522f9a889a2555c305fdfd781220ad239a0e38f2f27406735d">10d79030e8222445804370796b90fca19546fd7454b6ce835c19dd35fdfc5eb70066be35ece83facf975a45633f6c77bafee90d5af3d8e3ef70fff06e05766dfabce520ef766a86d4db753a1af8bb54108d1866d040fab1f020558624c5752905e36b020cf2d893ea43c3c7b65288e669b2179adb1b5b7854e7dd43029a0ce3db791988e0e00f669785575b4cc880c4a4285afe76b8ce751fa1665c75def274362966550914b6c8a03e456c777f5924925d8c3c787eb4c1b339b22d34eff8e3a0836cd46f1d9bc1b8aed1c0054a5efaa0e73bf6bb94bbc3acf0defd321f6ba48067512ac62cc6e472bd498185916a2a96de5b7d5e6d9f652531d7f26ea36d959d35729c5f94165c41c681427c5d445c47c62bbcbe1003b77f0c71c5fbd553aa66cbfb79b3104e1ec9827a0215835946e514632b2d1bf92a13f515c6eb1783b2d81dd91885d0c7cbcc52f2969ba4652d4</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-shrink">      <input class="hbe hbe-input-field hbe-input-field-shrink" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-shrink" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-shrink">Not IP of Mr.Lu ! enter some words to prove</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> æ•°ç çŸ¥è¯† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å°çŸ¥è¯† </tag>
            
            <tag> æ•°ç  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>readme</title>
      <link href="/2021/08/02/readme/"/>
      <url>/2021/08/02/readme/</url>
      
        <content type="html"><![CDATA[<h1 id="é€¯æ¶¦é›¨çš„åšå®¢"><a href="#é€¯æ¶¦é›¨çš„åšå®¢" class="headerlink" title="é€¯æ¶¦é›¨çš„åšå®¢"></a>é€¯æ¶¦é›¨çš„åšå®¢</h1><p>è¿™æ˜¯æˆ‘æœ¬äººçš„åšå®¢å¹³å°ï¼Œæ¬¢è¿å¤§å®¶å‰æ¥è®¿é—®ğŸ¥³<a href="https://lry89757.github.io/">https://lry89757.github.io/</a><br>åˆšå»ºæˆæ²¡å¤šä¹…ï¼Œæœ‰è®¸å¤šåŠŸèƒ½éƒ½ä¸æ˜¯å¾ˆå®Œå–„ï¼Œæˆ‘ä»¥åä¼šåœ¨readmeæ–‡æ¡£ä¸­è®°å½•æ›´æ–°åŠŸèƒ½ä¸ä¿®æ”¹BUGä¸æ–°çš„ç›¸å…³æ–‡ç« çš„ã€‚  </p><h2 id="11-3-æƒ³æ³•"><a href="#11-3-æƒ³æ³•" class="headerlink" title="11.3 æƒ³æ³•"></a>11.3 æƒ³æ³•</h2><hr><p>æˆ–è®¸ä»¥åä¸åº”è¯¥éƒ½åˆ†ç±»ä¸ºæ·±åº¦å­¦ä¹ ï¼Œåº”è¯¥åˆ†ç±»ä¸ºï¼š</p><p>æ·±åº¦å­¦ä¹ ï¼š{CVï¼š{ç›®æ ‡æ£€æµ‹ï¼š}, NLP:{Transformer}, è®ºæ–‡é˜…è¯»ï¼ŒMMLAB, æºç é˜…è¯» }</p><h2 id="9-16-13-21ç¬¬äºŒåä¸€æ¬¡æ›´æ–°"><a href="#9-16-13-21ç¬¬äºŒåä¸€æ¬¡æ›´æ–°" class="headerlink" title="9.16 13:21ç¬¬äºŒåä¸€æ¬¡æ›´æ–°"></a>9.16 13:21ç¬¬äºŒåä¸€æ¬¡æ›´æ–°</h2><hr><ol><li>æ›´æ–°äº†readmeæ–‡æ¡£</li><li>æ›´æ–°äº†å…³äºMIUIçš„ä¸€ä¸ªåæ§½çš„â€œå°ç±³åœ£ç»â€ã€‚è¿˜æœ‰ä¸€ä¸ªå…³äºç¼–è§£ç é—®é¢˜çš„è½¬è½½ï¼Œå¦å¤–å°±æ˜¯å…³äºä¸€ä¸ªæ·±åº¦å­¦ä¹ å¸¸è§åè¯çš„è®¨è®ºã€‚</li><li>å¾…å®Œæˆï¼šè¯„è®º+éŸ³ä¹å…¨å±€æ’­æ”¾ã€‚</li></ol><h2 id="9-11-10-05ç¬¬äºŒåæ¬¡æ›´æ–°"><a href="#9-11-10-05ç¬¬äºŒåæ¬¡æ›´æ–°" class="headerlink" title="9.11 10:05ç¬¬äºŒåæ¬¡æ›´æ–°"></a>9.11 10:05ç¬¬äºŒåæ¬¡æ›´æ–°</h2><hr><ol><li>æ›´æ–°äº†readmeæ–‡æ¡£</li><li>å‘å¸ƒäº†ä¸¤ç¯‡åšå®¢ï¼Œä¸€ç¯‡å…³äºpandasï¼Œå¦ä¸€ç¯‡æ˜¯ä¸€ç¯‡ä¹è¯„ï¼Œå…³äºæ—ä¿Šæ°çš„ä»¥åè¦åšçš„äº‹</li><li>å¾…å®Œæˆï¼šè¯„è®º+éŸ³ä¹å…¨å±€æ’­æ”¾</li></ol><h2 id="9-8-21-44ç¬¬åä¹æ¬¡æ›´æ–°"><a href="#9-8-21-44ç¬¬åä¹æ¬¡æ›´æ–°" class="headerlink" title="9.8 21:44ç¬¬åä¹æ¬¡æ›´æ–°"></a>9.8 21:44ç¬¬åä¹æ¬¡æ›´æ–°</h2><hr><ol><li>æ›´æ–°äº†readmeæ–‡æ¡£</li><li>å‘å¸ƒäº†ä¸€ç¯‡å…³äºDianå›¢é˜Ÿçš„åšå®¢ï¼Œç®—æ˜¯åˆä½“éªŒå§ã€‚</li><li>å‘å¸ƒäº†ä¹‹å‰é‡‡è®¿æˆ‘ä»¬å­¦é™¢è°­å‰¯é™¢é•¿çš„è®¿è°ˆè®°å½•ã€‚</li><li>å¾…å®Œæˆï¼šè¯„è®º+éŸ³ä¹å…¨å±€æ’­æ”¾ã€‚</li></ol><h2 id="9-6-13-13ç¬¬åå…«æ¬¡æ›´æ–°"><a href="#9-6-13-13ç¬¬åå…«æ¬¡æ›´æ–°" class="headerlink" title="9.6 13:13ç¬¬åå…«æ¬¡æ›´æ–°"></a>9.6 13:13ç¬¬åå…«æ¬¡æ›´æ–°</h2><hr><ol><li>æ›´æ–°äº†readmeæ–‡æ¡£ã€‚</li><li>AIpiç­”è¾©ç»ˆäºå®Œæˆ, å‘å¸ƒäº†æœ‰å…³ç›®æ ‡æ£€æµ‹çš„ç¬”è®°ã€FasterRCNNæºç è§£è¯»ç¬”è®°ä»¥åŠæ•°æ®å¢å¼ºç¬”è®°ä¸‰ç¯‡åšå®¢ã€‚</li><li>å‘å¸ƒäº†å¸¸ç”¨çš„Pytorch-Cookbookä»£ç ï¼Œè¿™æ˜¯è½¬è½½çš„ã€‚</li><li>å¾…å®Œæˆï¼šè¯„è®ºéƒ¨åˆ†ï¼ŒéŸ³ä¹å…¨å±€æ’­æ”¾ã€‚</li></ol><h2 id="8-26-11-22ç¬¬åä¸ƒæ¬¡æ›´æ–°"><a href="#8-26-11-22ç¬¬åä¸ƒæ¬¡æ›´æ–°" class="headerlink" title="8.26 11:22ç¬¬åä¸ƒæ¬¡æ›´æ–°"></a>8.26 11:22ç¬¬åä¸ƒæ¬¡æ›´æ–°</h2><hr><ol><li>æ›´æ–°äº†readmeæ–‡æ¡£</li><li>ç¨å¾®ä¼˜åŒ–äº†ä¸€äº›ä¸œè¥¿ï¼Œä½¿ç•Œé¢æ›´åŠ ç¾è§‚äº†</li><li>å¾…å®Œæˆï¼šè¯„è®ºéƒ¨åˆ†</li></ol><h2 id="8-25-15-30ç¬¬åå…­æ¬¡æ›´æ–°"><a href="#8-25-15-30ç¬¬åå…­æ¬¡æ›´æ–°" class="headerlink" title="8.25 15:30ç¬¬åå…­æ¬¡æ›´æ–°"></a>8.25 15:30ç¬¬åå…­æ¬¡æ›´æ–°</h2><hr><ol><li>æ›´æ–°äº†readmeæ–‡æ¡£</li><li>å¢åŠ äº†å‡ ç¯‡åšå®¢</li><li>å°è¯•äº†ä¸€ä¸‹è‹±æ–‡ç‰ˆ</li><li>å¢åŠ äº†ç•™è¨€æ¿ï¼Œä½†æ˜¯è¿˜æ²¡å¼€æ”¾è¯„è®º</li><li>å¾…å®Œæˆï¼šè¯„è®º</li></ol><h2 id="8-19-18-09ç¬¬åäº”æ¬¡æ›´æ–°"><a href="#8-19-18-09ç¬¬åäº”æ¬¡æ›´æ–°" class="headerlink" title="8.19 18:09ç¬¬åäº”æ¬¡æ›´æ–°"></a>8.19 18:09ç¬¬åäº”æ¬¡æ›´æ–°</h2><hr><ol><li>æ›´æ–°äº†readmeæ–‡æ¡£</li><li>å¢åŠ äº†å‡ ç¯‡åšå®¢</li><li>æ·»åŠ äº†å¼ å¤§ä½¬çš„åšå®¢å‹é“¾</li><li>é‡æ–°æ›´æ”¹å®Œå–„äº†ç®€å†</li><li>å¾…å®Œæˆï¼šä¾ç„¶æ˜¯è¯„è®º</li></ol><h2 id="8-12-12-11ç¬¬åå››æ¬¡æ›´æ–°"><a href="#8-12-12-11ç¬¬åå››æ¬¡æ›´æ–°" class="headerlink" title="8.12 12:11ç¬¬åå››æ¬¡æ›´æ–°"></a>8.12 12:11ç¬¬åå››æ¬¡æ›´æ–°</h2><hr><ol><li>æ›´æ–°äº†readmeæ–‡æ¡£</li><li>å¢åŠ äº†ä¸€ç¯‡çˆ¬è™«çˆ¬æ¥çš„åšå®¢ï¼Œå®Œå–„äº†ä¸€äº›æ–‡ç« </li><li>å¾…å®Œæˆï¼šè¯„è®º</li></ol><h2 id="8-10-12-03ç¬¬åä¸‰æ¬¡æ›´æ–°"><a href="#8-10-12-03ç¬¬åä¸‰æ¬¡æ›´æ–°" class="headerlink" title="8.10 12:03ç¬¬åä¸‰æ¬¡æ›´æ–°"></a>8.10 12:03ç¬¬åä¸‰æ¬¡æ›´æ–°</h2><hr><ol><li>æ›´æ–°äº†readmeæ–‡æ¡£</li><li>å¢åŠ äº†3ç¯‡å…³äºä»¥å¤ªåŠã€åæŒ–çŸ¿ç—…æ¯’çš„åšå®¢ï¼ˆè½¬ï¼‰</li><li>å¾…å®Œæˆï¼šè¯„è®º</li></ol><h2 id="8-10-0-00ç¬¬åäºŒæ¬¡æ›´æ–°"><a href="#8-10-0-00ç¬¬åäºŒæ¬¡æ›´æ–°" class="headerlink" title="8.10 0:00ç¬¬åäºŒæ¬¡æ›´æ–°"></a>8.10 0:00ç¬¬åäºŒæ¬¡æ›´æ–°</h2><hr><ol><li>æ›´æ–°äº†readmeæ–‡æ¡£</li><li>å¢åŠ äº†ä¸€ç¯‡åšå®¢ï¼Œå…³äºæ¢…è¥¿</li><li>åŠ äº†ä¸ªå‹é“¾</li><li>å¾…å®Œæˆï¼šè¯„è®º</li></ol><h2 id="8-7-14-13ç¬¬åä¸€æ¬¡æ›´æ–°"><a href="#8-7-14-13ç¬¬åä¸€æ¬¡æ›´æ–°" class="headerlink" title="8.7 14:13ç¬¬åä¸€æ¬¡æ›´æ–°"></a>8.7 14:13ç¬¬åä¸€æ¬¡æ›´æ–°</h2><hr><ol><li>æ›´æ–°äº†readmeæ–‡æ¡£</li><li>å¢åŠ äº†ä¸¤ç¯‡åšå®¢ï¼Œå…³äºLeNetåˆ†ç±»CIFAR10å’Œå¸¸ç”¨tensoræ“ä½œ</li><li>è§£å†³äº†é¦–é¡µå›¾ç‰‡åŠ è½½ä¸å‡ºæ¥çš„é—®é¢˜ <del>ï¼ˆæ¢ä¸ªå°ç‚¹å„¿çš„å›¾ç‰‡å°±è¡Œäº†ï¼‰</del></li><li>å¾…å®Œæˆï¼šè¯„è®º+å¤–é“¾</li></ol><h2 id="8-6-22-44ç¬¬åæ¬¡æ›´æ–°"><a href="#8-6-22-44ç¬¬åæ¬¡æ›´æ–°" class="headerlink" title="8.6 22:44ç¬¬åæ¬¡æ›´æ–°"></a>8.6 22:44ç¬¬åæ¬¡æ›´æ–°</h2><hr><ol><li>æ›´æ–°äº†readmeæ–‡æ¡£</li><li>å¢åŠ äº†ä¸€ä¸ªå…¨è‹±æ–‡çš„CIFAR-10æ•°æ®é›†çš„è¯¦è§£<del>ï¼ˆè‹±æ–‡æ°´å¹³å¤ªä½ï¼Œå†™äº†å¥½é•¿æ—¶é—´ğŸ¤ï¼‰</del></li><li>å¾…å®Œæˆï¼šè¯„è®º+éŸ³ä¹å¤–é“¾</li></ol><h2 id="8-6-12-33ç¬¬ä¹æ¬¡æ›´æ–°"><a href="#8-6-12-33ç¬¬ä¹æ¬¡æ›´æ–°" class="headerlink" title="8.6 12:33ç¬¬ä¹æ¬¡æ›´æ–°"></a>8.6 12:33ç¬¬ä¹æ¬¡æ›´æ–°</h2><hr><ol><li>æ›´æ–°äº†readmeæ–‡æ¡£</li><li>å¢åŠ äº†ä¸€ä¸ªé¡¹ç›®</li><li>æ›´æ–°äº†shellæŒ‡ä»¤çš„åšå®¢</li><li>è§£å†³äº†ä»£ç é«˜äº®</li><li>å¾…å®Œæˆï¼šéŸ³ä¹éƒ¨åˆ†ã€è¯„è®ºæ¨¡å—</li></ol><h2 id="8-5-23-48ç¬¬å…«æ¬¡æ›´æ–°"><a href="#8-5-23-48ç¬¬å…«æ¬¡æ›´æ–°" class="headerlink" title="8.5 23:48ç¬¬å…«æ¬¡æ›´æ–°"></a>8.5 23:48ç¬¬å…«æ¬¡æ›´æ–°</h2><hr><ol><li>æ›´æ–°äº†readmeæ–‡æ¡£</li><li>æŠŠç®—æ³•åˆ·é¢˜çš„æ ˆç³»åˆ—è§£æè‚å®Œäº†ï¼Œ ä¸€å…±å…­ç¯‡åšå®¢</li><li>å¾…å®Œæˆï¼šè§ç¬¬ä¸‰æ¬¡æ›´æ–°ï¼Œä¸è¿‡æœ€è¦ç´§çš„æ˜¯ä»£ç é«˜äº®å’ŒéŸ³ä¹éƒ¨åˆ†ã€‚</li></ol><h2 id="8-4-15-28ç¬¬ä¸ƒæ¬¡ç´§æ€¥æ›´æ–°ï¼"><a href="#8-4-15-28ç¬¬ä¸ƒæ¬¡ç´§æ€¥æ›´æ–°ï¼" class="headerlink" title="8.4 15:28ç¬¬ä¸ƒæ¬¡ç´§æ€¥æ›´æ–°ï¼"></a>8.4 15:28ç¬¬ä¸ƒæ¬¡ç´§æ€¥æ›´æ–°ï¼</h2><hr><p><strong>æ„Ÿè°¢å¸®å¿™æµ‹è¯•æœ‹å‹æå‡ºç›¸å…³æ„è§ï¼Œæˆ‘å…³åœäº†ç½‘ç«™å¯¹ä¸€äº›éšç§åšäº†ç´§æ€¥ä¿®æ”¹ï¼Œæ„Ÿè°¢å„ä½çš„å¸®åŠ©ï¼</strong></p><h2 id="8-4-11-40ç¬¬å…­æ¬¡æ›´æ–°"><a href="#8-4-11-40ç¬¬å…­æ¬¡æ›´æ–°" class="headerlink" title="8.4 11:40ç¬¬å…­æ¬¡æ›´æ–°"></a>8.4 11:40ç¬¬å…­æ¬¡æ›´æ–°</h2><hr><ol><li>æ›´æ–°äº†readmeæ–‡æ¡£</li><li>æ·»åŠ äº†è½¬è½½é™å®šè§„åˆ™æ¨¡å—é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å 4.0 å›½é™…è®¸å¯åè®®<del>ï¼ˆè™½ç„¶æˆ‘çš„æ–‡ç« ä¸å€¼å¾—è¢«è½¬è½½ï¼‰</del></li><li>å–æ¶ˆäº†è½®æ’­å›¾è‡ªåŠ¨è½®æ’­ï¼Œå»æ‰äº†æ²¡ç”¨çš„éŸ³ä¹å¤–é“¾</li><li>å¢åŠ äº†IPæ£€æµ‹ï¼ˆexcuse me ?)ğŸ¤£ğŸ˜…</li><li>å¾…å®Œæˆï¼šè§ç¬¬ä¸‰æ¬¡æ›´æ–°</li></ol><h2 id="8-3-15-39ç¬¬äº”æ¬¡æ›´æ–°"><a href="#8-3-15-39ç¬¬äº”æ¬¡æ›´æ–°" class="headerlink" title="8.3 15:39ç¬¬äº”æ¬¡æ›´æ–°"></a>8.3 15:39ç¬¬äº”æ¬¡æ›´æ–°</h2><hr><ol><li>æ›´æ–°äº†readmeæ–‡æ¡£</li><li>åšå®¢ï¼šå¯¹äºæ—ä¿Šæ°æœ€è¿‘äº‹æƒ…çš„çœ‹æ³•</li><li>åŠ å…¥äº†éŸ³ä¹æ’­æ”¾åŠŸèƒ½å“ˆå“ˆå“ˆå“ˆï¼ï¼ğŸ˜ğŸ˜å½“ç„¶ç›®å‰çš„éŸ³ä¹éƒ½æ˜¯æˆ‘çŸ¥é“èƒ½å¤Ÿå¤–é“¾æ’­æ”¾çš„ï¼ŒåæœŸä¼šç»§ç»­æ•´ä¿®çš„ï¼ˆæ²¡å‘ç°çš„æœ‹å‹å¯ä»¥çœ‹é¡µé¢å·¦ä¸‹è§’å“¦ï¼‰</li><li>å¾…å®Œæˆï¼šè§ç¬¬ä¸‰æ¬¡æ›´æ–°ğŸ˜¬</li></ol><h2 id="8-2-22-25ç¬¬å››æ¬¡æ›´æ–°"><a href="#8-2-22-25ç¬¬å››æ¬¡æ›´æ–°" class="headerlink" title="8.2 22:25ç¬¬å››æ¬¡æ›´æ–°"></a>8.2 22:25ç¬¬å››æ¬¡æ›´æ–°</h2><hr><ol><li>æ›´æ–°äº†readmeæ–‡æ¡£</li><li>å‹é“¾å¢åŠ äº†flyleeï¼ŒåŒç­å­¦éœ¸</li><li>åšå®¢ï¼šå†™äº†ä¸€äº›å¯¹ç”Ÿæ´»æ„Ÿæƒ³</li><li>è¿›ä¸€æ­¥ä¿®æ”¹äº†markdownæ•°å­¦å…¬å¼æ— æ³•æ˜¾ç¤ºé—®é¢˜ã€‚</li><li>å¾…å®Œæˆï¼šè§ç¬¬3æ¬¡æ›´æ–°ğŸ˜(æˆ‘ä¸å‚¬æˆ‘è‡ªå·±ï¼ï¼ï¼)</li></ol><h2 id="8-2-18-39ç¬¬ä¸‰æ¬¡æ›´æ–°"><a href="#8-2-18-39ç¬¬ä¸‰æ¬¡æ›´æ–°" class="headerlink" title="8.2 18:39ç¬¬ä¸‰æ¬¡æ›´æ–°"></a>8.2 18:39ç¬¬ä¸‰æ¬¡æ›´æ–°</h2><hr><p><del><em>çœ‹æ¥åˆšå»ºå¥½åšå®¢æ›´æ–°çš„å°±æ˜¯å¿«å•Šâ€¦â€¦å“ˆå“ˆå“ˆ</em></del></p><ol><li>æ›´æ–°äº†readmeæ–‡æ¡£ğŸ˜…</li><li>å‘å¸ƒäº†2ç¯‡åšå®¢ï¼Œä¸€ç¯‡æ˜¯è¯»ã€Šåœ¨è·¯ä¸Šã€‹åå¯¹ç”Ÿæ´»çš„æ„Ÿæƒ³æ€è€ƒï¼ˆæœ‰å…´è¶£é˜…è¯»çš„å¯ä»¥å’Œæˆ‘è”ç³»ç´¢è¦å¯†ç ï¼Œç ´è¯‘å‡ºå¯†ç çš„å¤§ä½¬è®°å¾—å’Œæˆ‘è”ç³»ğŸ¤©ï¼‰ï¼Œå¦ä¸€ç¯‡æ˜¯å¸¸ç”¨çš„shellå‘½ä»¤ï¼ˆgit/nodejs/nvm/npmï¼‰é›†</li><li>å®ç°äº†æ¨èç½®é¡¶åŠŸèƒ½</li><li>å¾…å®Œæˆï¼š<ul><li>äºŒçº§ç›®å½•</li><li>ç›¸å†Œ</li><li>ä»£ç é«˜äº®</li><li>è¯„è®º</li></ul></li></ol><h2 id="8-2-14-28ç¬¬äºŒæ¬¡æ›´æ–°"><a href="#8-2-14-28ç¬¬äºŒæ¬¡æ›´æ–°" class="headerlink" title="8.2 14:28ç¬¬äºŒæ¬¡æ›´æ–°"></a>8.2 14:28ç¬¬äºŒæ¬¡æ›´æ–°</h2><hr><ol><li><p>æ›´æ–°äº†å¯†ç åŠŸèƒ½ï¼Œå¯¹äºä¸€äº›æ–‡ç« å®ç°äº†åŠ å¯†ï¼Œ <em>å¦‚æœæœ‰å°ä¼™ä¼´ä»¬å¯¹åŠ å¯†æ–‡ç« æ„Ÿå…´è¶£ï¼Œæ¬¢è¿å‘é‚®ä»¶æˆ–æ˜¯é€šè¿‡å„ç§æ¸ é“è”ç³»æˆ‘è·å–å¯†ç ï¼Œé¡ºä¾¿äº¤ä¸ªæœ‹å‹ğŸ‘€</em>ï¼Œ æˆ–è€…æœ‰å…³å¤§ä½¬å¯ä»¥é€‰æ‹©ç›´æ¥å°è¯•ç ´è¯‘å“¦~é‚£å°±æ›´å¾—äº¤ä¸ªæœ‹å‹äº†ğŸ˜…</p></li><li><p>æ›´æ–°äº†readmeæ–‡æ¡£</p></li><li><p>å‘å¸ƒäº†ä¸€ç¯‡åšå®¢ï¼Œå…³äºä¸€äº›æ•°ç å°çŸ¥è¯†ï¼Œå¹¶æµ‹è¯•äº†å¯†ç åŠŸèƒ½ã€‚</p></li><li><p>å¾…å®Œæˆï¼š</p><ul><li>ä»£ç é«˜äº®åŠŸèƒ½</li><li>äºŒçº§ç›®å½•</li><li>è®°å½•nvmã€nodejsã€npmè¸©å‘å†å²çš„åšå®¢ã€‚</li><li>è¯„è®ºåŠŸèƒ½</li></ul></li></ol><h2 id="8-2-11-00-ç¬¬ä¸€æ¬¡æ›´æ–°"><a href="#8-2-11-00-ç¬¬ä¸€æ¬¡æ›´æ–°" class="headerlink" title="8.2  11:00 ç¬¬ä¸€æ¬¡æ›´æ–°"></a>8.2  11:00 ç¬¬ä¸€æ¬¡æ›´æ–°</h2><hr><ol><li>å‹é“¾ï¼šä¿®æ­£äº†éƒ¨åˆ†æ— æ³•æ˜¾ç¤ºé—®é¢˜ï¼Œ åŠ è¿›å»äº†æ›´å¤šå‹é“¾</li><li>å‘å¸ƒäº†3ç¯‡æ–°æ–‡ç« ï¼Œå…¨éƒ¨éƒ½æ˜¯å…³äºnumpyçš„å°çŸ¥è¯†</li><li>å¢åŠ mathjaxå·²è§£å†³æ— æ³•æ˜¾ç¤ºmarkdownæ•°å­¦å…¬å¼é—®é¢˜</li><li>æ›´æ–°äº†readmeæ–‡æ¡£</li><li>é¢„è®¡ä¼šè¿›ä¸€æ­¥ï¼š  <ul><li>äºŒçº§ç›®å½•</li><li>ä¸€ä¸ªåšå®¢è®°å½•nvmã€nodejsã€npmè¸©å‘å†å²ğŸ˜–</li><li>è¯„è®ºæ¨¡å—</li><li>æ–‡ç« å¯†ç é—®é¢˜</li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> åšå®¢å»ºç«™ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®°å½• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>numpyä¸­å¯¹äºtileçš„ç†è§£</title>
      <link href="/2021/08/02/numpy-zhong-dui-yu-tile-de-li-jie/"/>
      <url>/2021/08/02/numpy-zhong-dui-yu-tile-de-li-jie/</url>
      
        <content type="html"><![CDATA[<p>è¿‘äº›å¤©ä½¿ç”¨numpyçš„æ—¶å€™å‘ç°äº†è¿™ä¹ˆä¸€ä¸ªå‡½æ•°tileï¼Œæ„Ÿè§‰è¿™ä¸ªå‡½æ•°æ¯”è¾ƒæœ‰ç”¨ï¼Œå¯ä»¥å°†å‡å°‘å¾ªç¯ï¼Œç›´æ¥çŸ©é˜µè¿ç®—ä¼˜åŒ–è¿ç®—é€Ÿåº¦ã€‚åšä¸»è®¤ä¸ºå¾ˆæœ‰å¿…è¦è®¤çœŸè®¨è®ºä¸€ä¸‹è¿™ä¸ªå‡½æ•°çš„åŠŸèƒ½ã€‚</p><h1 id="å®˜ç½‘è§£é‡Š"><a href="#å®˜ç½‘è§£é‡Š" class="headerlink" title="å®˜ç½‘è§£é‡Š"></a>å®˜ç½‘è§£é‡Š</h1><p>è€ä¼ ç»Ÿï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹å®˜ç½‘æ˜¯æ€ä¹ˆè¯´çš„ï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210708233501849.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="np.tile"><br>ç›¸å½“äºæ˜¯ä¸€ä¸ªå¤åˆ¶å‡½æ•°ï¼Œæ‰©å……çŸ©é˜µçš„è§„æ¨¡å€¼ç›´è‡³åˆ°æˆ‘ä»¬æ»¡æ„çš„ä¸€ä¸ªå½¢çŠ¶ã€‚â€tileâ€åœ¨è‹±æ–‡ä¸­ä½œåŠ¨è¯ä¼šæœ‰â€œé“ºâ€çš„æ„æ€ï¼Œä¸extendæ˜¯åŒä¹‰è¯ã€‚<br>é€šè¿‡æä¾›çš„æ¬¡æ•°repsæ¥å†³å®šé‡å¤Açš„æ¬¡æ•°æ¥æ„é€ ä¸€ä¸ªarrayã€‚<br>å¦‚æœrepsçš„é•¿åº¦ä¸ºdï¼Œé‚£ä¹ˆç»™å‡ºç»“æœçš„ç»´åº¦å°±æ˜¯max(d, A.ndim).</p><p>å¦‚æœ A.ndim &lt; dï¼Œåˆ™é€šè¿‡æ·»åŠ æ–°è½´å°† A æå‡ä¸º d ç»´ã€‚ å› æ­¤ï¼Œå°†å½¢çŠ¶ (3,) æ•°ç»„æå‡ä¸º (1, 3) ä»¥è¿›è¡Œ 2-D å¤åˆ¶ï¼Œæˆ–å°†å½¢çŠ¶ (1, 1, 3) æå‡ä¸º (1, 1, 3) ä»¥è¿›è¡Œ 3-D å¤åˆ¶ã€‚ å¦‚æœè¿™ä¸æ˜¯æ‰€éœ€çš„è¡Œä¸ºï¼Œè¯·åœ¨è°ƒç”¨æ­¤å‡½æ•°ä¹‹å‰æ‰‹åŠ¨å°† A æå‡åˆ° d ç»´åº¦ã€‚</p><p>å¦‚æœ A.ndim &gt; dï¼Œä»£è¡¨é€šè¿‡åœ¨å®ƒå‰é¢æ·»åŠ  1 è¢«æå‡ä¸º A.ndimã€‚ å› æ­¤ï¼Œå¯¹äºå½¢çŠ¶ä¸º (2, 3, 4, 5) çš„ Aï¼Œ(2, 2) çš„é‡å¤æ¬¡æ•°è¢«è§†ä¸º (1, 1, 2, 2)ã€‚</p><p>æœ€åæ³¨æ„ä¸€ä¸‹ï¼šè¿™é‡Œç‰¹æ„æåˆ°äº†<strong>è™½ç„¶ tile å¯ä»¥ç”¨äºå¹¿æ’­ï¼Œä½†å¼ºçƒˆå»ºè®®ä½¿ç”¨ numpy çš„å¹¿æ’­æ“ä½œå’ŒåŠŸèƒ½ã€‚</strong></p><h1 id="è¯¦ç»†è§£æ"><a href="#è¯¦ç»†è§£æ" class="headerlink" title="è¯¦ç»†è§£æ"></a>è¯¦ç»†è§£æ</h1><p>æˆ‘ä»¬é¦–å…ˆæ¥çœ‹å‡ ä¸ªç®€å•ä¾‹å­ï¼š</p><pre class="line-numbers language-python"><code class="language-python">a <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>np<span class="token punctuation">.</span>tile<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>np<span class="token punctuation">.</span>tile<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>np<span class="token punctuation">.</span>tile<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚ä»£ç æ‰€ç¤ºï¼Œå¦‚æœrepsåªæ˜¯ä¸€ä¸ªæ ‡é‡çš„è¯ï¼Œæˆ‘ä»¬ä»…éœ€å°†å…¶åœ¨çŸ©é˜µå†…éƒ¨åŠ ä¸Šèµ‹å€¼repså€å³å¯ï¼Œè€Œå¦‚æœæ˜¯çŸ¢é‡çŸ©é˜µä¾‹å¦‚repsæ˜¯ï¼ˆa, b, cï¼‰çš„è¯ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å†…éƒ¨æ‰©å……cå€ä¹‹åï¼Œå°†è¿™ä¸€ä¸ªæ•´ä½“çŸ©é˜µçœ‹ä½œæ˜¯ä¸€ä¸ªAç„¶åä»–æ˜¯å½¢çŠ¶ä¸ºï¼ˆa,b)é‡Œé¢çš„ä¸€ä¸ªå…ƒç´ ï¼Œè¿™æ ·çš„è¯æˆ‘ä»¬å°±èƒ½å¤ŸæˆåŠŸç†è§£æœ‰å…³æ“ä½œäº†ã€‚æŒ‰ç…§è¿™ä¸ªæ€è·¯ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹æ›´åŠ å¤æ‚çš„ä¸€äº›æ“ä½œï¼š</p><pre class="line-numbers language-python"><code class="language-python">b <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>np<span class="token punctuation">.</span>tile<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>np<span class="token punctuation">.</span>tile<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>np<span class="token punctuation">.</span>tile<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>np<span class="token punctuation">.</span>tile<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®é™…ä¸Šæœ€åä¸€ä¸ªä¾¿æ˜¯æˆ‘ä»¬æ‰€è°“çš„å¹¿æ’­æ“ä½œï¼Œä½†æ˜¯numpyå®˜æ–¹å¹¶ä¸å¸Œæœ›æˆ‘ä»¬åˆ©ç”¨è¿™ä¸ªå‡½æ•°æ¥è¿›è¡Œå¹¿æ’­æ“ä½œã€‚<br>æœ€åä»ç„¶æ”¾ä¸€äº›å®ä¾‹å§ï¼š</p><pre class="line-numbers language-python"><code class="language-python">c <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>np<span class="token punctuation">.</span>tile<span class="token punctuation">(</span>c<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python"><code class="language-python">b <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">28</span> <span class="token number">20</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">27</span>  <span class="token number">8</span><span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token number">4</span> <span class="token number">22</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">23</span>  <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span>np<span class="token punctuation">.</span>tile<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h1><p><a href="https://numpy.org/doc/stable/reference/generated/numpy.tile.html" target="_blank" rel="noopener">https://numpy.org/doc/stable/reference/generated/numpy.tile.html</a></p>]]></content>
      
      
      <categories>
          
          <category> numpyçš„å°çŸ¥è¯† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> numpy </tag>
            
            <tag> çŸ©é˜µè¿ç®— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>numpyä¸­å¯¹äºaxisçš„ç†è§£</title>
      <link href="/2021/08/02/numpy-zhong-dui-yu-axis-de-li-jie/"/>
      <url>/2021/08/02/numpy-zhong-dui-yu-axis-de-li-jie/</url>
      
        <content type="html"><![CDATA[<h1 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h1><p>æˆ‘ä»¬çŸ¥é“axisè¿™ä¸ªä¸œè¥¿ç»å¸¸å‡ºç°åœ¨numpyçš„sumã€argsortç­‰ä¸€ç³»åˆ—æœ‰å…³äºæ•°ç»„çš„æ“ä½œä¸­ï¼Œnumpyä¸­çš„è½´axisæ˜¯å¾ˆé‡è¦çš„ï¼Œè®¸å¤šnumpyçš„æ“ä½œæ ¹æ®axisçš„å–å€¼ä¸åŒï¼Œä½œå‡ºçš„æ“ä½œä¹Ÿä¸ç›¸åŒã€‚å¯ä»¥è¯´ï¼Œaxisè®©numpyçš„å¤šç»´æ•°ç»„å˜çš„æ›´åŠ çµæ´»ï¼Œä½†ä¹Ÿè®©numpyå˜å¾—è¶Šå‘éš¾ä»¥ç†è§£ã€‚å› æ­¤ï¼Œå¼„æ¸…æ¥šaxisçš„ä½œç”¨æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚ä½œä¸ºä¸€ä¸ªå¾ˆåŸºæœ¬åŒæ—¶å¾ˆé‡è¦çš„æ¦‚å¿µï¼Œåšä¸»è§‰å¾—å¾ˆæœ‰å¿…è¦è¯¦ç»†æ·±å…¥äº†è§£ä¸€ä¸‹è¿™ä¸€åè¯ã€‚<br><em>ä¸‹é¢æŠŠåšä¸»çš„ä¸€äº›å‘ç°åˆ†äº«ç»™å¤§å®¶ã€‚</em></p><h1 id="ç®€å•äº†è§£axis"><a href="#ç®€å•äº†è§£axis" class="headerlink" title="ç®€å•äº†è§£axis"></a>ç®€å•äº†è§£axis</h1><hr><p>axis ä¸­æ–‡ç¿»è¯‘æŒ‡â€œè½´â€ã€â€œæ¢è½´â€ã€‚æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹<a href="https://numpy.org/doc/stable/user/quickstart.html#the-basics" target="_blank" rel="noopener">è‹±æ–‡å®˜ç½‘</a>çš„è§£é‡Š:</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210708104217716.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="å…³äºaxis"></p><p>NumPy çš„ä¸»è¦å¯¹è±¡æ˜¯åŒæ„å¤šç»´æ•°ç»„ã€‚ å®ƒæ˜¯ä¸€ä¸ªå…ƒç´ è¡¨ï¼ˆé€šå¸¸æ˜¯æ•°å­—ï¼‰ï¼Œæ‰€æœ‰ç±»å‹éƒ½ç›¸åŒï¼Œç”±éè´Ÿæ•´æ•°å…ƒç»„ç´¢å¼•ã€‚ åœ¨ NumPy ä¸­ï¼Œç»´åº¦ç§°ä¸ºè½´ã€‚</p><p>ä¾‹å¦‚ï¼Œ3D ç©ºé—´ [1, 2, 1] ä¸­ä¸€ä¸ªç‚¹çš„åæ ‡æœ‰ä¸€ä¸ªè½´ã€‚ è¯¥è½´æœ‰ 3 ä¸ªå…ƒç´ ï¼Œå› æ­¤æˆ‘ä»¬è¯´å®ƒçš„é•¿åº¦ä¸º 3ã€‚åœ¨ä¸‹å›¾ä¸­çš„ç¤ºä¾‹ä¸­ï¼Œè¯¥æ•°ç»„æœ‰ 2 ä¸ªè½´ã€‚ ç¬¬ä¸€ä¸ªè½´çš„é•¿åº¦ä¸º 2ï¼Œç¬¬äºŒä¸ªè½´çš„é•¿åº¦ä¸º 3ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å®é™…ä¸Šè¿™ä¸ªç»´åº¦ç§°ä¸ºè½´å¹¶ä¸æ˜¯å¾ˆå¥½ç†è§£ï¼Œå¿…é¡»<strong>è¯´æ˜è¿™é‡Œçš„è½´ç»´åº¦å’Œæˆ‘ä»¬æ•°å­¦ç‰©ç†ä¸Šé¢çš„æ˜¯æœ‰å¾ˆå¤§åŒºåˆ«çš„</strong>ã€‚</p><h1 id="ä¸æ•°å­¦ç‰©ç†æ–¹é¢çš„åŒºåˆ«"><a href="#ä¸æ•°å­¦ç‰©ç†æ–¹é¢çš„åŒºåˆ«" class="headerlink" title="ä¸æ•°å­¦ç‰©ç†æ–¹é¢çš„åŒºåˆ«"></a>ä¸æ•°å­¦ç‰©ç†æ–¹é¢çš„åŒºåˆ«</h1><hr><p>æˆ‘ä»¬ç°éšæœºå»ºç«‹ä¸€ä¸ª3Ã—3çš„æ•°ç»„ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token operator">>></span><span class="token operator">></span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.14828241</span><span class="token punctuation">,</span> <span class="token number">0.67698515</span><span class="token punctuation">,</span> <span class="token number">0.22729984</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">0.78760285</span><span class="token punctuation">,</span> <span class="token number">0.71820171</span><span class="token punctuation">,</span> <span class="token number">0.43459394</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">0.85447318</span><span class="token punctuation">,</span> <span class="token number">0.72708047</span><span class="token punctuation">,</span> <span class="token number">0.56316259</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¯¥çŸ©é˜µç”±äºå½¢çŠ¶æ˜¯3Ã—3çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨çº¿æ€§ä»£æ•°é‡Œé¢è®¤ä¸ºè¿™ä¸ªçŸ©é˜µç»´åº¦æ˜¯ä¸‰ï¼ˆç§©ä¸ºä¸‰ï¼‰ï¼Œä½†æ˜¯åœ¨numpyçš„æ•°ç»„ä¸­ï¼Œè¿™ä¸ªarrayçš„ç»´æ•°åªæœ‰2ï¼Œåˆ†åˆ«æœ‰axis=0,axis=1è¿™ä¸¤ä¸ªè½´ï¼Œè€Œaxis=0çš„è½´é•¿åº¦ä¸º3ï¼Œaxis=1çš„è½´é•¿åº¦ä¹Ÿä¸º3.æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬æ ¼å¤–æ³¨æ„ä¸€ä¸‹ã€‚</p><h1 id="è¿›ä¸€æ­¥ç†è§£"><a href="#è¿›ä¸€æ­¥ç†è§£" class="headerlink" title="è¿›ä¸€æ­¥ç†è§£"></a>è¿›ä¸€æ­¥ç†è§£</h1><hr><p>æˆ‘ä»¬è¿›è¡Œä¸€ä¸‹æœ‰å…³axisçš„æ“ä½œï¼Œä¾‹å¦‚æ±‚å’Œï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> c <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> carray<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> c<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> c<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œå¦‚æœæˆ‘ä»¬<strong>ä»¤axis=0,å®ƒä¼šæŒ‰ç…§åˆ—æ±‚å’Œå¾—åˆ°ä¸€ä¸ªå’ŒçŸ©é˜µï¼Œä»¤axis=1ä¼šå¾—åˆ°ä¸€ä¸ªæŒ‰ç…§è¡Œæ±‚å’Œçš„çŸ©é˜µ</strong>ã€‚é‚£ä¹ˆå¦‚æœæˆ‘ä»¬å°±è¿™ä¹ˆè®°çš„è¯æ˜¯ä¸æ˜¯å°±ä¸‡äº‹å¤§å‰äº†ï¼Ÿå½“ç„¶ä¸æ˜¯ï¼å› ä¸ºé€šå¸¸æ“ä½œä¸­ï¼Œæˆ‘ä»¬ä¼šæ“ä½œç»´æ•°æ›´é«˜çš„æ•°ç»„ï¼Œè¿™ä¹ˆçš„è¯ï¼Œå°±æ— æ³•ä½¿ç”¨0åˆ—1è¡Œçš„æ–¹æ³•å»æ“ä½œäº†ã€‚</p><p>å®é™…ä¸Šï¼Œæˆ‘ä»¬æœ‰ç€ä»¥ä¸‹çš„è§„å¾‹ï¼š</p><p><strong>è®¾axis=iï¼Œåˆ™Numpyæ²¿ç€ç¬¬iä¸ªä¸‹æ ‡å˜åŒ–çš„æ–¹å‘è¿›è¡Œæ“ä½œ</strong></p><p><em>å½“ç„¶è¿™é‡Œç¨å¾®è¡¥å……ä¸€ä¸‹å¦‚æœæ˜¯axis=-1çš„æƒ…å†µï¼Œé‚£ä¹ˆå°±æ˜¯æ²¿ç€å€’æ•°ç¬¬ä¸€ä¸ªä¸‹æ ‡å˜åŒ–çš„æ–¹å‘å¼€å§‹æ“ä½œ</em></p><p>è¿™é‡Œå¯ä»¥å¤šä¸¾å‡ ä¸ªä¾‹å­æ¥å¸®åŠ©æˆ‘ä»¬ç†è§£ä¸€ä¸‹ï¼š</p><p>ä»¥ä»¥ä¸‹ä¸‰ç»´æ•°ç»„ä¸ºä¾‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> d <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> darray<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol><li>è¿™æ˜¯ä¸€ä¸ªä¸‰ç»´æ•°ç»„ï¼Œè‹¥axis=0,é‚£ä¹ˆæˆ‘ä»¬å°±åº”è¯¥æŠŠd[0][i][j]+d[1][i][j]+d[2][i][j]åŠ èµ·æ¥ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªå½¢çŠ¶ä¸º2Ã—4çš„çŸ©é˜µ</li></ol><pre class="line-numbers language-python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> darray<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> d<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚å›¾æ‰€ç¤ºï¼Œç¡®å®å¾—åˆ°äº†ä¸€ä¸ª2Ã—4çš„çŸ©é˜µã€‚</p><ol start="2"><li>æ¥ç€æˆ‘ä»¬å°è¯•axis=1,é‚£ä¹ˆåº”è¯¥å¾—åˆ°äº†ä¸€ä¸ª3Ã—4çš„çŸ©é˜µ</li></ol><pre class="line-numbers language-python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> d <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> darray<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> d<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> d<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»“æœä¾¿æ˜¯å¦‚æ­¤ã€‚</p><p>å®é™…ä¸Šé™¤äº†sumå‡½æ•°ï¼Œè¿˜æœ‰ç€è®¸è®¸å¤šå¤šéœ€è¦ç”¨åˆ°è¿™æ–¹é¢çŸ¥è¯†çš„å‡½æ•°ï¼Œä¾‹å¦‚maxã€minã€averageã€argsortã€sortè¿™äº›å‡½æ•°ã€‚</p><p>ä¸¾å‡ ä¸ªæˆ‘ä»¬çœ‹ä¸€ä¸‹ï¼š</p><ul><li>sort</li></ul><pre class="line-numbers language-python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> e <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> e<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> earray<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> e<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> earray<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> e<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> earray<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>argsort</li></ul><pre class="line-numbers language-python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> f <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> farray<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> f_sort <span class="token operator">=</span> f<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> f_sortarray<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>int64<span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> f_sort0<span class="token operator">=</span>f<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> f_sort0array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>int64<span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> f_sort1<span class="token operator">=</span>f<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> f_sort1array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>int64<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‚è€ƒé“¾æ¥ï¼š</p><ul><li><p><a href="https://zhuanlan.zhihu.com/p/31275071" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/31275071</a></p></li><li><p><a href="https://blog.csdn.net/m0_37673307/article/details/82118030" target="_blank" rel="noopener">https://blog.csdn.net/m0_37673307/article/details/82118030</a></p></li><li><p><a href="https://stackoverflow.com/questions/19389910/in-python-numpy-what-is-a-dimension-and-axis#:~:text=In%20Numpy%20dimensions%20are%20called,has%20a%20length%20of%203" target="_blank" rel="noopener">https://stackoverflow.com/questions/19389910/in-python-numpy-what-is-a-dimension-and-axis#:~:text=In%20Numpy%20dimensions%20are%20called,has%20a%20length%20of%203</a>.</p></li><li><p><a href="https://numpy.org/doc/stable/user/quickstart.html#the-basics" target="_blank" rel="noopener">https://numpy.org/doc/stable/user/quickstart.html#the-basics</a></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> numpyçš„å°çŸ¥è¯† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> numpy </tag>
            
            <tag> çŸ©é˜µè®¡ç®— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>argsortå‡½æ•°çš„è¯¦è§£</title>
      <link href="/2021/08/02/argsort-han-shu-de-xiang-jie/"/>
      <url>/2021/08/02/argsort-han-shu-de-xiang-jie/</url>
      
        <content type="html"><![CDATA[<p>argsortå‡½æ•°ç»å¸¸ç”¨äºçŸ©é˜µçš„ä¸€äº›ä¸ç ´ååŸæœ‰æ•°ç»„çš„æƒ…å†µä¸‹å¾—åˆ°åŸæ•°ç»„çš„æœ‰åºåºåˆ—çš„æƒ…å†µã€‚</p><h1 id="å®˜ç½‘è§£é‡Š"><a href="#å®˜ç½‘è§£é‡Š" class="headerlink" title="å®˜ç½‘è§£é‡Š"></a>å®˜ç½‘è§£é‡Š</h1><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210708101432523.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="å®˜ç½‘ä»‹ç»"><br>ä½¿ç”¨ kind å…³é”®å­—æŒ‡å®šçš„ç®—æ³•æ²¿ç»™å®šè½´æ‰§è¡Œé—´æ¥æ’åºã€‚å®ƒä»¥æ’åºçš„é¡ºåºè¿”å›ä¸ç»™å®šè½´ä¸Šçš„ç´¢å¼•æ•°æ®å…·æœ‰ç›¸åŒå½¢çŠ¶çš„ç´¢å¼•æ•°ç»„ã€‚<br>axisint æˆ– Noneï¼Œå¯é€‰<br>æ’åºçš„è½´ã€‚é»˜è®¤å€¼ä¸º -1ï¼ˆæœ€åä¸€ä¸ªè½´ï¼‰ã€‚å¦‚æœæ²¡æœ‰ï¼Œåˆ™ä½¿ç”¨æ‰å¹³æ•°ç»„ã€‚</p><p>kind:{â€˜å¿«é€Ÿæ’åºâ€™ã€â€˜åˆå¹¶æ’åºâ€™ã€â€˜å †æ’åºâ€™ã€â€˜ç¨³å®šâ€™}ï¼Œæ’åºç®—æ³•ã€‚é»˜è®¤å€¼ä¸ºâ€œå¿«é€Ÿæ’åºâ€ã€‚è¯·æ³¨æ„ï¼Œâ€œstableâ€ä¸â€œmergesortâ€éƒ½åœ¨å¹•åä½¿ç”¨ timsortï¼Œé€šå¸¸ï¼Œå®é™…å®ç°ä¼šå› æ•°æ®ç±»å‹è€Œå¼‚ã€‚ä¿ç•™â€œåˆå¹¶æ’åºâ€é€‰é¡¹æ˜¯ä¸ºäº†å‘åå…¼å®¹ã€‚</p><p>åœ¨ 1.15.0 ç‰ˆæ›´æ”¹ã€‚ï¼šæ·»åŠ äº†â€œç¨³å®šâ€é€‰é¡¹ã€‚</p><p>orderstr æˆ– str åˆ—è¡¨ï¼Œå¯é€‰<br>å½“ a æ˜¯ä¸€ä¸ªå®šä¹‰äº†å­—æ®µçš„æ•°ç»„æ—¶ï¼Œè¿™ä¸ªå‚æ•°æŒ‡å®šè¦æ¯”è¾ƒå“ªäº›å­—æ®µï¼Œç¬¬ä¸€ä¸ªï¼Œç¬¬äºŒä¸ªç­‰ç­‰ã€‚ å•ä¸ªå­—æ®µå¯ä»¥æŒ‡å®šä¸ºå­—ç¬¦ä¸²ï¼Œä¸æ˜¯æ‰€æœ‰çš„å­—æ®µéƒ½éœ€è¦æŒ‡å®šï¼Œä½†ä»ç„¶ä¼šä½¿ç”¨æœªæŒ‡å®šçš„å­—æ®µï¼Œåœ¨å®ƒä»¬å‡ºç°åœ¨ dtype ä¸­çš„é¡ºåºï¼Œä»¥æ‰“ç ´è”ç³»ã€‚</p><h1 id="è¯¦è§£"><a href="#è¯¦è§£" class="headerlink" title="è¯¦è§£"></a>è¯¦è§£</h1><p>å®é™…ä¸Šå°±æ˜¯è¿”å›äº†ä¸€ä¸ªå‡åºçš„åºåˆ—ï¼Œé‡Œé¢æ¯ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯æ’åºå¥½åçš„å…ƒç´ åœ¨åŸåºåˆ—ä¸­çš„ç´¢å¼•ã€‚è¿™æ ·æ–¹ä¾¿æˆ‘ä»¬åœ¨åŸåºåˆ—ä¸­æ‰¾åˆ°æ¯ä¸€ä¸ªå…ƒç´ ã€‚è¿™ä¸€å¥è¯å¯èƒ½ä¸æ˜¯å¾ˆå¥½ç†è§£æˆ‘ä»¬ç»“åˆä¸€å®šçš„ä¾‹å­æ¥çœ‹ä¸€ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token operator">>></span><span class="token operator">></span> a <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> aarray<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> a<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span><span class="token punctuation">)</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>int64<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚ä»¥ä¸Šæ¥çœ‹ï¼ŒåŸåºåˆ—ä¸º[8, 1, 5, 6], æˆ‘ä»¬å…¶ä½¿ç”¨argsortå‡½æ•°ä¹‹åå¾—åˆ°åºåˆ—[1, 2, 3, 0],  é‚£ä¹ˆæˆ‘ä»¬ç›´æ¥ä½¿ç”¨a[1]å°±æ˜¯aä¸­æœ€å°çš„å…ƒç´ ï¼Œa[0]å°±æ˜¯aä¸­æœ€å¤§çš„å…ƒç´ ã€‚<br>æˆ‘ä»¬å¯ä»¥å¤šçœ‹å‡ ä¸ªç±»ä¼¼çš„ä¾‹å­, è¿™é‡Œå¯ä»¥çœ‹ä¸€ä¸‹äºŒç»´æ•°ç»„:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> b <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> barray<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> b<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span><span class="token punctuation">)</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>int64<span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> b<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>int64<span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> b<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>int64<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»ä»¥ä¸Šå¯ä»¥çœ‹å‡ºï¼Œå®é™…ä¸Šå¦‚æœæ˜¯äºŒç»´æ•°ç»„çš„è¯ï¼Œä¸ä»…ä»…æœ‰è¿™è¿™ä¹ˆä¸€ç§æ’åºçš„æ–¹æ³•ï¼Œä¸ä»…å¯ä»¥æŒ‰ç…§è¡Œæ¥æ’ï¼Œä¹Ÿå¯ä»¥æŒ‰ç…§åˆ—æ¥æ’åºã€‚è¿™é‡Œä»ç„¶æ˜¯é€šè¿‡axisè½´æ¥ç¡®å®šçš„æ’åºæ–¹å¼ï¼Œå‡½æ•°é»˜è®¤axis=-1ï¼Œè¿™é‡Œæˆ‘åœ¨ä¹‹å‰åšå®¢æœ‰æåˆ°è¿‡ï¼Œè¯»è€…å¦‚æœå¯¹äºaxiså‡½æ•°æ¯”è¾ƒé™Œç”Ÿçš„è¯å¯ä»¥çœ‹ä¸€ä¸‹<a href="https://blog.csdn.net/LRY89757/article/details/118570303?spm=1001.2014.3001.5501" target="_blank" rel="noopener">æˆ‘ä¹‹å‰çš„ä¸€ç¯‡åšå®¢</a>è¿™é‡Œè¯¦ç»†è§£é‡Šäº†axisçš„æœ‰å…³ç†è§£ã€‚<br>ä»¥ä¸‹å†ç»™å‡ºå®˜ç½‘å‡ ä¸ªä¾‹å­ï¼š</p><pre class="line-numbers language-python"><code class="language-python">ind <span class="token operator">=</span> np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>x<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># sorts along first axis (down)</span>indarray<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>np<span class="token punctuation">.</span>take_along_axis<span class="token punctuation">(</span>x<span class="token punctuation">,</span> ind<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># same as np.sort(x, axis=0)</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»¥åŠä¸å¸¸ç”¨çš„æ ¹æ®å…³é”®å­—ï¼š</p><pre class="line-numbers language-python"><code class="language-python">x <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token string">'&lt;i4'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">,</span> <span class="token string">'&lt;i4'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>xarray<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>      dtype<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token string">'&lt;i4'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">,</span> <span class="token string">'&lt;i4'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><em>å¤§å®¶å¦‚æœæœ‰å…´è¶£å¯ä»¥å»<a href="https://numpy.org/doc/stable/reference/generated/numpy.argsort.html" target="_blank" rel="noopener">å®˜ç½‘</a>çœ‹ä¸€ä¸‹ã€‚</em></p><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><p><a href="https://numpy.org/doc/stable/reference/generated/numpy.argsort.html" target="_blank" rel="noopener">https://numpy.org/doc/stable/reference/generated/numpy.argsort.html</a></p><p><a href="https://blog.csdn.net/LRY89757/article/details/118570303?spm=1001.2014.3001.5501" target="_blank" rel="noopener">https://blog.csdn.net/LRY89757/article/details/118570303?spm=1001.2014.3001.5501</a></p><p>ä»¥ä¸Šã€‚</p>]]></content>
      
      
      <categories>
          
          <category> numpyçš„å°çŸ¥è¯† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> numpy </tag>
            
            <tag> çŸ©é˜µè®¡ç®— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„å„ç±»æ’åºç®—æ³•è¯¦è§£+ä»£ç åˆ†æ</title>
      <link href="/2021/08/01/shu-ju-jie-gou-ge-lei-pai-xu-suan-fa-xiang-jie-dai-ma-fen-xi/"/>
      <url>/2021/08/01/shu-ju-jie-gou-ge-lei-pai-xu-suan-fa-xiang-jie-dai-ma-fen-xi/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¸çŸ¥ä¸è§‰ï¼Œæ•°æ®ç»“æ„å·²ç»å­¦å®Œäº†ï¼Œåšä¸»ä¹Ÿé©¬ä¸Šå¤§äºŒäº†ğŸ˜­æ—¶é—´è¿‡å¾—å¤ªå¿«äº†ğŸ˜±ï¼Œä½†æ˜¯æ•°æ®ç»“æ„å­¦å¾—ç¡®å®ä¸å¤ªå¥½ï¼Œæ¥¼ä¸»èŠ±äº†å°†è¿‘ä¸€å¤©çš„æ—¶é—´æ•´ç†äº†ä¸€ä¸‹æ’åºçš„æœ‰å…³ç®—æ³•ã€‚å¸Œæœ›å¯¹å¤§å®¶ä¹Ÿæœ‰æ‰€å¸®åŠ©ã€‚<br>@<a href="ç›®å½•">TOC</a></p><hr><h2 id="æ’å…¥æ’åº"><a href="#æ’å…¥æ’åº" class="headerlink" title="æ’å…¥æ’åº"></a>æ’å…¥æ’åº</h2><hr><h3 id="åŸºæœ¬æ€æƒ³"><a href="#åŸºæœ¬æ€æƒ³" class="headerlink" title="åŸºæœ¬æ€æƒ³"></a>åŸºæœ¬æ€æƒ³</h3><p>æ¯æ­¥å°†ä¸€ä¸ªå¾…æ’åºè®°å½•ï¼ŒæŒ‰å…¶å…³é”®ç å¤§å°ï¼Œæ’å…¥åˆ°å‰é¢å·²ç»æ’å¥½åºçš„ä¸€ç»„è®°å½•çš„é€‚å½“ä½ç½®ä¸Šï¼Œç›´åˆ°è®°å½•å…¨éƒ¨æ’å…¥ä¸ºæ­¢ã€‚</p><h3 id="ç›´æ¥æ’å…¥æ’åº"><a href="#ç›´æ¥æ’å…¥æ’åº" class="headerlink" title="ç›´æ¥æ’å…¥æ’åº"></a>ç›´æ¥æ’å…¥æ’åº</h3><hr><pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">InsertSort</span> <span class="token punctuation">(</span> SqList <span class="token operator">&amp;</span>L <span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//å¯¹é¡ºåºè¡¨Lä½œç›´æ¥æ’å…¥æ’åº</span><span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span>L<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span> i <span class="token punctuation">)</span><span class="token comment" spellcheck="true">//ç›´æ¥åœ¨åŸå§‹æ— åºè¡¨Lä¸­æ’åº</span><span class="token keyword">if</span> <span class="token punctuation">(</span>L<span class="token punctuation">.</span>r<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>key <span class="token operator">&lt;</span> L<span class="token punctuation">.</span>r<span class="token punctuation">[</span>i<span class="token number">-1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//è‹¥L.r[i]è¾ƒå°åˆ™æ’å…¥æœ‰åºå­è¡¨å†…</span><span class="token punctuation">{</span> L<span class="token punctuation">.</span>r<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span> L<span class="token punctuation">.</span>r<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//å…ˆå°†å¾…æ’å…¥çš„å…ƒç´ æ”¾å…¥â€œå“¨å…µâ€ä½ç½®</span>L<span class="token punctuation">.</span>r<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span> L<span class="token punctuation">.</span>r<span class="token punctuation">[</span>i<span class="token number">-1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//å­è¡¨å…ƒç´ å¼€å§‹åç§»</span><span class="token keyword">for</span> <span class="token punctuation">(</span> j<span class="token operator">=</span>i<span class="token number">-2</span><span class="token punctuation">;</span> L<span class="token punctuation">.</span>r<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>key <span class="token operator">&lt;</span> L<span class="token punctuation">.</span>r<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">;</span> <span class="token operator">--</span>j <span class="token punctuation">)</span> L<span class="token punctuation">.</span>r<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span> L<span class="token punctuation">.</span>r<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//åªè¦å­è¡¨å…ƒç´ æ¯”å“¨å…µå¤§å°±ä¸æ–­åç§»</span>L<span class="token punctuation">.</span>r<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span> L<span class="token punctuation">.</span>r<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//ç›´åˆ°å­è¡¨å…ƒç´ å°äºå“¨å…µï¼Œå°†å“¨å…µå€¼é€å…¥</span>        <span class="token comment" spellcheck="true">//å½“å‰è¦æ’å…¥çš„ä½ç½®ï¼ˆåŒ…æ‹¬æ’å…¥åˆ°è¡¨é¦–ï¼‰</span>     <span class="token punctuation">}</span> <span class="token comment" spellcheck="true">//if</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// InsertSort</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    </p><p><em>ä»ç¬¬äºŒä¸ªè®°å½•å¼€å§‹é€è¶Ÿå¼€å§‹æ’å…¥</em></p><h3 id="æŠ˜åŠæ’å…¥æ’åº"><a href="#æŠ˜åŠæ’å…¥æ’åº" class="headerlink" title="æŠ˜åŠæ’å…¥æ’åº"></a>æŠ˜åŠæ’å…¥æ’åº</h3><hr><p>è¿™ä¸ªç›¸å¯¹äºç›´æ¥æ’å…¥æ’åºï¼Œå‡å°‘äº†æ¯”è¾ƒçš„æ¬¡æ•°ï¼Œä½†æ˜¯æ²¡æœ‰å‡å°‘ç§»åŠ¨çš„æ¬¡æ•°ï¼š$$n^2$$ / 4æ¬¡</p><p>åªæ˜¯æˆ‘ä»¬æŸ¥æ‰¾æ’å…¥çš„ä½ç½®æ—¶ï¼Œä½¿ç”¨äº†æŠ˜åŠæŸ¥æ‰¾çš„æ–¹æ³•ã€‚</p><h3 id="äºŒè·¯æ’åº"><a href="#äºŒè·¯æ’åº" class="headerlink" title="äºŒè·¯æ’åº"></a>äºŒè·¯æ’åº</h3><hr><p>ç›¸æ¯”ä¹‹ä¸‹ï¼Œå‡å°‘äº†ç§»åŠ¨çš„æ¬¡æ•°ï¼Œçº¦ä¸º$$n^2$$ / 8æ¬¡</p><p><a href="http://data.biancheng.net/view/67.html" target="_blank" rel="noopener">äºŒè·¯æ’åº</a></p><pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> temp<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span>first<span class="token punctuation">,</span>final<span class="token punctuation">,</span>k<span class="token punctuation">;</span>    first <span class="token operator">=</span> final <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//åˆ†åˆ«è®°å½•tempæ•°ç»„ä¸­æœ€å¤§å€¼å’Œæœ€å°å€¼çš„ä½ç½®</span>    temp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// å¾…æ’å…¥å…ƒç´ æ¯”æœ€å°çš„å…ƒç´ å°</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> temp<span class="token punctuation">[</span>first<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            first <span class="token operator">=</span> <span class="token punctuation">(</span>first <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">+</span> n<span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token punctuation">;</span>            temp<span class="token punctuation">[</span>first<span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">// å¾…æ’å…¥å…ƒç´ æ¯”æœ€å¤§å…ƒç´ å¤§</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> temp<span class="token punctuation">[</span>final<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            final <span class="token operator">=</span> <span class="token punctuation">(</span>final <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> n<span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token punctuation">;</span>            temp<span class="token punctuation">[</span>final<span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">// æ’å…¥å…ƒç´ æ¯”æœ€å°å¤§ï¼Œæ¯”æœ€å¤§å°</span>        <span class="token keyword">else</span> <span class="token punctuation">{</span>            k <span class="token operator">=</span> <span class="token punctuation">(</span>final <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> n<span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//å½“æ’å…¥å€¼æ¯”å½“å‰å€¼å°æ—¶ï¼Œéœ€è¦ç§»åŠ¨å½“å‰å€¼çš„ä½ç½®</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>temp<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> n<span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token punctuation">]</span> <span class="token operator">></span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                temp<span class="token punctuation">[</span><span class="token punctuation">(</span>k <span class="token operator">+</span> n<span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token punctuation">]</span> <span class="token operator">=</span>temp<span class="token punctuation">[</span><span class="token punctuation">(</span>k <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">+</span> n<span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token punctuation">]</span><span class="token punctuation">;</span>                k <span class="token operator">=</span> <span class="token punctuation">(</span>k <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">+</span> n<span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token comment" spellcheck="true">//æ’å…¥è¯¥å€¼</span>            temp<span class="token punctuation">[</span><span class="token punctuation">(</span>k <span class="token operator">+</span> n<span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//å› ä¸ºæœ€å¤§å€¼çš„ä½ç½®æ”¹å˜ï¼Œæ‰€ä»¥éœ€è¦å®æ—¶æ›´æ–°finalçš„ä½ç½®</span>            final <span class="token operator">=</span> <span class="token punctuation">(</span>final <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> n<span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// å°†æ’åºè®°å½•å¤åˆ¶åˆ°åŸæ¥çš„é¡ºåºè¡¨é‡Œ</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> k <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        arr<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">[</span><span class="token punctuation">(</span>first <span class="token operator">+</span> k<span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> temp<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">insert</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>temp<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å¸Œå°”æ’åº"><a href="#å¸Œå°”æ’åº" class="headerlink" title="å¸Œå°”æ’åº"></a>å¸Œå°”æ’åº</h3><hr><p><em>å¸Œå°”æ’åºå°±æ˜¯æŒ‡å–å›ºå®šçš„ä¸€äº›å¢é‡åºåˆ—æ¥åˆ†åˆ«è¿›è¡Œç›´æ¥æ’å…¥æ’åºï¼Œæ¯”å¦‚å»dk = 5ï¼Œ 3ï¼Œ 1è¿™ç§ï¼Œåˆ°æœ€åå¯¹åŸºæœ¬æœ‰åºçš„å…¨ä½“åºåˆ—è¿›è¡Œä¸€æ¬¡ç›´æ¥æ’å…¥æ’åºæ³¨æ„å¢é‡åºåˆ—çš„ä¹‹ä¸­æ²¡æœ‰é™¤1ä¹‹å¤–çš„å…¬å› å­ï¼Œä¸”æœ€åä¸€ä¸ªå€¼å¿…å®šä¸º1.</em></p><p>ç®—æ³•æ€æƒ³ï¼š</p><p>å…ˆå°†æ•´ä¸ªå¾…æ’è®°å½•åºåˆ—åˆ†å‰²æˆè‹¥å¹²å­åºåˆ—åˆ†åˆ«è¿›è¡Œç›´æ¥æ’å…¥æ’åºï¼Œå¾…æ•´ä¸ªåºåˆ—ä¸­çš„è®°å½•åŸºæœ¬æœ‰åºæ—¶ï¼Œå†å¯¹å…¨ä½“è®°å½•è¿›è¡Œä¸€æ¬¡ç›´æ¥æ’å…¥æ’åºã€‚åˆ†ä¸ºå¤šä¸ªå­åºåˆ—çš„æ–¹æ³•:è®¾ç½®ä¸€ç³»åˆ—å¢é‡å€¼ï¼ˆdkå€¼ï¼‰ï¼Œå°†ç›¸éš”æŸä¸ªå¢é‡çš„è®°å½•ç»„æˆä¸€ä¸ªå­åºåˆ—ï¼Œå¦‚ç¬¬ä¸€è¶Ÿdk=5,åˆ™r1ï¼Œr6.ä¸ºä¸€ç»„ï¼Œr2ï¼Œr7ä¸ºä¸€ç»„ï¼Œç„¶åæ¯ä¸€ç»„è¿›è¡Œç›´æ¥æ’å…¥æ’åºã€‚ä»¥æ­¤ç±»æ¨ã€‚ä¸æ–­å‡å°dkçš„å€¼ï¼Œç›´åˆ°ä¸º1ï¼Œå†è¿›è¡Œç›´æ¥æ’å…¥æ’åºå°±èƒ½å®ç°å¯¹æ•´ä½“è®°å½•çš„æ’å…¥æ’åºäº†ã€‚</p><p>dkå€¼è¾ƒå¤§ï¼Œå­åºåˆ—ä¸­å¯¹è±¡è¾ƒå°‘ï¼Œé€Ÿåº¦è¾ƒå¿«ï¼›</p><p>dkå€¼é€æ¸å‡å°ï¼Œå­åºåˆ—ä¸­å¯¹è±¡å˜å¤šï¼Œä½†å¤§å¤šæ•°å¯¹è±¡å·²åŸºæœ¬æœ‰åºï¼Œæ‰€ä»¥æ’åºé€Ÿåº¦ä»ç„¶å¾ˆå¿«ã€‚</p><p>è¾“å…¥ï¼šå¢é‡çš„æ•°ç›®kï¼Œå„ä¸ªå¢é‡dkï¼Œ  é¡ºåºè¡¨çš„é•¿åº¦ï¼Œé¡ºåºè¡¨ä¸­å„ä¸ªå…ƒç´ ã€‚</p><p>è¾“å‡ºï¼šæ’å¥½åºçš„é¡ºåºè¡¨ä¸­å„ä¸ªå…ƒç´ ã€‚</p><p>ç®—æ³•å›¾è§£ï¼ˆè¿™æ˜¯ä»ç½‘ä¸Šçœ‹åˆ°çš„å›¾ï¼Œä¾µåˆ ï¼‰ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210630151121305.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70#pic_center" alt="å¸Œå°”æ’åº"></p><pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">ShellSort</span><span class="token punctuation">(</span>SqList <span class="token operator">&amp;</span>L<span class="token punctuation">,</span> <span class="token keyword">int</span> dlta<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> t<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//æŒ‰å¢é‡åºåˆ—dlta[0..t-1]å¯¹é¡ºåºè¡¨Låšå¸Œå°”æ’åºã€‚</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>k<span class="token operator">&lt;</span>t<span class="token punctuation">;</span><span class="token operator">++</span>k<span class="token punctuation">)</span>        <span class="token function">ShellInsert</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> dlta<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">//ä¸€è¶Ÿå¢é‡ä¸ºdlta[k]çš„æ’å…¥æ’åº</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">ShellInsert</span><span class="token punctuation">(</span>SqList <span class="token operator">&amp;</span>L<span class="token punctuation">,</span><span class="token keyword">int</span> dk<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//å¯¹é¡ºåºè¡¨è¿›è¡Œä¸€è¶Ÿå¢é‡ä¸ºdkçš„Shellæ’åºï¼Œdkä¸ºæ­¥é•¿å› å­</span>    <span class="token comment" spellcheck="true">//ç›¸å¯¹äºä¸€è¶Ÿæ’å…¥æ’åºç›¸æ¯”ï¼Œåšäº†å¦‚ä¸‹ä¿®æ”¹ï¼š</span>    <span class="token comment" spellcheck="true">//  1. å‰åè®°å½•ä½ç½®çš„å¢é‡æ˜¯dkï¼Œè€Œä¸æ˜¯1</span>    <span class="token comment" spellcheck="true">//  2. r[0]åªæ˜¯æš‚å­˜å•å…ƒï¼Œä¸æ˜¯å“¨å…µã€‚å½“j&lt;=0æ—¶ï¼Œæ’å…¥ä½ç½®å·²æ‰¾åˆ°ã€‚</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token operator">+</span>dk<span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>L<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//å¼€å§‹å°†r[i]æ’å…¥æœ‰åºå¢é‡å­è¡¨</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>L<span class="token punctuation">.</span>r<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token operator">&lt;</span>L<span class="token punctuation">.</span>r<span class="token punctuation">[</span>i<span class="token operator">-</span>dk<span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">)</span>    <span class="token punctuation">{</span>            <span class="token function">RedCopy</span><span class="token punctuation">(</span>L<span class="token punctuation">.</span>r<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>L<span class="token punctuation">.</span>r<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//æš‚å­˜åœ¨r[0]</span>            <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span>i<span class="token operator">-</span>dk<span class="token punctuation">;</span>j<span class="token operator">></span><span class="token number">0</span><span class="token operator">&amp;&amp;</span>L<span class="token punctuation">.</span>r<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token operator">&lt;</span>L<span class="token punctuation">.</span>r<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">;</span>j<span class="token operator">-</span><span class="token operator">=</span>dk<span class="token punctuation">)</span>                <span class="token function">RedCopy</span><span class="token punctuation">(</span>L<span class="token punctuation">.</span>r<span class="token punctuation">[</span>j<span class="token operator">+</span>dk<span class="token punctuation">]</span><span class="token punctuation">,</span>L<span class="token punctuation">.</span>r<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//å…³é”®å­—è¾ƒå¤§çš„è®°å½•åœ¨å­—è¡¨ä¸­åç§»</span>        <span class="token function">RedCopy</span><span class="token punctuation">(</span>L<span class="token punctuation">.</span>r<span class="token punctuation">[</span>j<span class="token operator">+</span>dk<span class="token punctuation">]</span><span class="token punctuation">,</span>L<span class="token punctuation">.</span>r<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//åœ¨æœ¬è¶Ÿç»“æŸæ—¶å°†r[i]æ’å…¥åˆ°æ­£ç¡®ä½ç½®</span>    <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å¿«é€Ÿæ’åº"><a href="#å¿«é€Ÿæ’åº" class="headerlink" title="å¿«é€Ÿæ’åº"></a>å¿«é€Ÿæ’åº</h2><hr><p><em>å°±æ˜¯å…ˆé€‰ç”¨ä¸€ä¸ªæ•°ï¼ˆå¯ä»¥éšæœºé€‰ä¹Ÿå¯ä»¥ç›´æ¥ç”¨ç¬¬ä¸€ä¸ªï¼‰ï¼Œä»¥ä»–ä¸ºåŸºå‡†ç„¶åæ¯”å®ƒå¤§çš„æ”¾åé¢ï¼Œæ¯”ä»–å°çš„æ”¾å‰é¢ï¼Œè¿™æ ·å½¢æˆä¸€ä¸ªå¤§è‡´å·¦è¾¹å¿…å®šæ¯”å³è¾¹å°çš„åºåˆ—åï¼Œå†æ¬¡å¯¹äºä¸¤è¾¹çš„è¿™äº›æ•°åˆ†æ®µè¿›è¡Œé€’å½’ç›¸åŒçš„æ“ä½œï¼Œä¸ç¨³å®š</em></p><p>ä¼˜ç‚¹ï¼šå¹³å‡æ€§èƒ½å¥½ï¼ŒO(nlog2n)ï¼Œ2ä¸ºä¸‹æ ‡</p><p>ç¼ºç‚¹ï¼šä¸ç¨³å®šï¼Œåˆå§‹åºåˆ—æœ‰åºæˆ–åŸºæœ¬æœ‰åºæ—¶ï¼Œæ—¶é—´å¤æ‚åº¦é™ä¸ºO(n^2)ã€‚</p><p>ç®—æ³•å›¾è§£ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210630150456865.gif#pic_center" alt="å¿«é€Ÿæ’åº"></p><p>å¿«æ’çš„ç®—æ³•è¯¦è§£ï¼š</p><p>ä¸€è¶Ÿå¿«é€Ÿæ’åºæˆ‘ä»¬æœ€åˆå®ç°çš„æ€æƒ³å°±æ˜¯è®¾ç½®ä¸¤ä¸ªæŒ‡é’ˆlowã€high,ä¸€ä¸ªæŒ‡å‘åŸºå‡†çš„å…ƒç´ ï¼Œä¸€ä¸ªæŒ‡å‘æœ«å°¾ï¼Œç„¶åæˆ‘ä»¬ä»æœ«å°¾å¼€å§‹å¾€å‰éå†ï¼Œå¦‚æœæˆ‘ä»¬çš„highå°äºåŸºå‡†äº†å¼€å§‹ï¼Œé‚£ä¹ˆå°±å’ŒlowæŒ‡å‘çš„åŸºå‡†äº¤æ¢ã€‚ç„¶åå¼€å§‹ä»lowå¼€å§‹å¾€åéå†ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªlowæ¯”åŸºå‡†å¤§çš„å…ƒç´ å’Œæ­¤æ—¶çš„highï¼ˆæŒ‡å‘çš„è¿˜æ˜¯åŸºå‡†ï¼‰äº¤æ¢ï¼Œç„¶åå†ä»highå¼€å§‹â€¦â€¦å¦‚æ­¤é‡å¤ç›´åˆ°æˆ‘ä»¬çš„low=high.</p><p>ä½†æ˜¯è¿™ä¹ˆç®—çš„è¯æ¯æ¬¡äº¤æ¢ä¸€å¯¹è®°å½•éœ€è¦è¿›è¡Œ3æ¬¡ç§»åŠ¨èµ‹å€¼æ“ä½œã€‚å®é™…ä¸Šæˆ‘ä»¬å¯¹äºåŸºå‡†çš„ç§»åŠ¨æ˜¯å¤šä½™çš„ï¼ŒåŸºå‡†å°±åœ¨æˆ‘ä»¬æœ€åå¾ªç¯ç»“æŸçš„low=highä½ç½®ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€‰æ‹©å°†åŸºå‡†æå‰æ”¾å¥½ï¼Œç„¶åæˆ‘ä»¬é€‰æ‹©è¯¥äº¤æ¢çš„æ—¶å€™ç›´æ¥èµ‹å€¼highå°äºåŸºå‡†åç›´æ¥èµ‹å€¼ç»™lowâ€¦â€¦ç›´åˆ°æˆ‘ä»¬low = highçš„æ—¶å€™å†å°†æ”¾å¥½çš„åŸºå‡†æ”¾åˆ°low(high)çš„ä½ç½®ã€‚</p><pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">Partition</span><span class="token punctuation">(</span>SqList <span class="token operator">&amp;</span>L<span class="token punctuation">,</span> <span class="token keyword">int</span> low<span class="token punctuation">,</span> <span class="token keyword">int</span> high<span class="token punctuation">)</span><span class="token punctuation">{</span>    L<span class="token punctuation">.</span>r<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> L<span class="token punctuation">.</span>r<span class="token punctuation">[</span>low<span class="token punctuation">]</span><span class="token punctuation">;</span>              <span class="token comment" spellcheck="true">//ç”¨å­è¡¨çš„ç¬¬ä¸€ä¸ªè®°å½•ä½œåŸºå‡†è®°å½•</span>    pivotkey <span class="token operator">=</span> L<span class="token punctuation">.</span>r<span class="token punctuation">[</span>low<span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">;</span>          <span class="token comment" spellcheck="true">//è®°å½•å…³é”®å­—</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>low <span class="token operator">&lt;</span> high<span class="token punctuation">)</span>                <span class="token comment" spellcheck="true">//ä»è¡¨çš„ä¸¤ç«¯äº¤æ›¿åœ°å‘ä¸­é—´æ‰«æ</span>    <span class="token punctuation">{</span>                                        <span class="token keyword">while</span><span class="token punctuation">(</span>low <span class="token operator">&lt;</span> high <span class="token operator">&amp;&amp;</span> L<span class="token punctuation">.</span>r<span class="token punctuation">[</span>high<span class="token punctuation">]</span><span class="token punctuation">.</span>key <span class="token operator">>=</span> pivotkey<span class="token punctuation">)</span><span class="token operator">--</span>high<span class="token punctuation">;</span>        L<span class="token punctuation">.</span>r<span class="token punctuation">[</span>low<span class="token punctuation">]</span> <span class="token operator">=</span> L<span class="token punctuation">.</span>r<span class="token punctuation">[</span>high<span class="token punctuation">]</span><span class="token punctuation">;</span>                  <span class="token comment" spellcheck="true">//å°†æ¯”åŸºå‡†å°çš„è®°å½•ç§»åˆ°ä½ç«¯</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>low <span class="token operator">&lt;</span> high <span class="token operator">&amp;&amp;</span> L<span class="token punctuation">.</span>r<span class="token punctuation">[</span>low<span class="token punctuation">]</span><span class="token punctuation">.</span>key <span class="token operator">&lt;=</span> pivotkey<span class="token punctuation">)</span><span class="token operator">++</span>low<span class="token punctuation">;</span>        L<span class="token punctuation">.</span>r<span class="token punctuation">[</span>high<span class="token punctuation">]</span> <span class="token operator">=</span> L<span class="token punctuation">.</span>r<span class="token punctuation">[</span>low<span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">//å°†æ¯”åŸºå‡†å¤§çš„è®°å½•ç§»åˆ°é«˜ç«¯</span>    <span class="token punctuation">}</span>    L<span class="token punctuation">.</span>r<span class="token punctuation">[</span>low<span class="token punctuation">]</span> <span class="token operator">=</span> L<span class="token punctuation">.</span>r<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> low<span class="token punctuation">;</span>                               <span class="token comment" spellcheck="true">//è¿”å›åŸºå‡†ä½ç½®</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">QSort</span><span class="token punctuation">(</span>SqList <span class="token operator">&amp;</span>L<span class="token punctuation">,</span> <span class="token keyword">int</span> low<span class="token punctuation">,</span> <span class="token keyword">int</span> high<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//å¯¹é¡ºåºè¡¨Lä¸­çš„å­åºåˆ—L.r[low..high]åšå¿«é€Ÿæ’åº</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>low <span class="token operator">>=</span> high<span class="token punctuation">)</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    pivotkey <span class="token operator">=</span> <span class="token function">Partition</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> low<span class="token punctuation">,</span> high<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">QSort</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> low<span class="token punctuation">,</span> pivotkey<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">QSort</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> pivotkey<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> high<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ—¶é—´æ•ˆç‡ï¼šO(nlog2n) â€”å› ä¸ºæ¯è¶Ÿç¡®å®šçš„å…ƒç´ å‘ˆæŒ‡æ•°å¢åŠ <br>ç©ºé—´æ•ˆç‡ï¼šOï¼ˆlog2nï¼‰â€”é€’å½’æ ˆ(å­˜æ¯å±‚lowï¼Œhighå’Œpivot)<br>ç¨³ å®š æ€§ï¼š ä¸ ç¨³ å®š â€”å› ä¸ºè·³è·ƒå¼äº¤æ¢ã€‚</p><h2 id="é€‰æ‹©æ’åº"><a href="#é€‰æ‹©æ’åº" class="headerlink" title="é€‰æ‹©æ’åº"></a>é€‰æ‹©æ’åº</h2><hr><h3 id="åŸºæœ¬æ€æƒ³-1"><a href="#åŸºæœ¬æ€æƒ³-1" class="headerlink" title="åŸºæœ¬æ€æƒ³"></a>åŸºæœ¬æ€æƒ³</h3><p>æ¯ä¸€è¶Ÿ(ç¬¬ i è¶Ÿ)åœ¨åé¢ n-i+1 ä¸ªå¾…æ’è®°å½•ä¸­é€‰å–å…³é”®å­—æœ€å°çš„è®°å½•ä½œä¸ºæœ‰åºåºåˆ—ä¸­çš„ç¬¬ i ä¸ªè®°å½•ã€‚</p><p><em>ä¹Ÿå°±æ˜¯å…ˆä»æ‰€æœ‰ä¸­é€‰å‡ºæœ€å°çš„ä½œä¸ºç¬¬ä¸€ä¸ªï¼Œå†ä»å‰©ä¸‹çš„é€‰å‡ºæœ€å°çš„ä½œä¸ºç¬¬äºŒä¸ªï¼Œâ€¦â€¦.</em></p><p>åˆ†ç±»ä¸»è¦æœ‰ç®€å•é€‰æ‹©æ’åºï¼Œé”¦æ ‡èµ›æ’åºï¼Œå †æ’åºã€‚</p><h3 id="ç®€å•é€‰æ‹©æ’åº"><a href="#ç®€å•é€‰æ‹©æ’åº" class="headerlink" title="ç®€å•é€‰æ‹©æ’åº"></a>ç®€å•é€‰æ‹©æ’åº</h3><hr><p>åŸºæœ¬æ€æƒ³ï¼šæ¯ç»è¿‡ä¸€è¶Ÿæ¯”è¾ƒå°±æ‰¾å‡ºä¸€ä¸ªæœ€å°å€¼ï¼Œä¸å¾…æ’åºåˆ—<br>æœ€å‰é¢çš„ä½ç½®äº’æ¢å³å¯ã€‚<br>â€”â€”é¦–å…ˆï¼Œåœ¨nä¸ªè®°å½•ä¸­é€‰æ‹©æœ€å°è€…æ”¾åˆ°r[1]ä½ç½®ï¼›ç„¶åï¼Œä»å‰©ä½™çš„n-1ä¸ª<br>è®°å½•ä¸­é€‰æ‹©æœ€å°è€…æ”¾åˆ°r[2]ä½ç½®ï¼›â€¦å¦‚æ­¤è¿›è¡Œä¸‹å»ï¼Œç›´åˆ°å…¨éƒ¨æœ‰åºä¸ºæ­¢ã€‚<br>ä¼˜ç‚¹ï¼šå®ç°ç®€å•<br>ç¼ºç‚¹ï¼šæ¯è¶Ÿåªèƒ½ç¡®å®šä¸€ä¸ªå…ƒç´ ï¼Œè¡¨é•¿ä¸ºnæ—¶éœ€è¦n-1è¶Ÿ<br>å‰æï¼šé¡ºåºå­˜å‚¨ç»“æ„</p><pre class="line-numbers language-c"><code class="language-c">Void <span class="token function">SelectSort</span><span class="token punctuation">(</span>SqList <span class="token operator">&amp;</span>L <span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>L<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>j <span class="token operator">=</span> <span class="token function">SelectMinKey</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span> i<span class="token operator">!=</span>j <span class="token punctuation">)</span> r<span class="token punctuation">[</span>i<span class="token punctuation">]</span> Â«r<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">//for</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">//SelectSort</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><em>æ˜¾ç„¶ç®€å•é€‰æ‹©æ’åºçš„ç¼ºç‚¹æ˜¯éå¸¸æ˜æ˜¾çš„ï¼Œç¬¬ä¸€æ¬¡æ¯”è¾ƒn-1æ¬¡ï¼Œç¬¬äºŒæ¬¡æ¯”è¾ƒn-2æ¬¡ï¼Œä»¥æ­¤ç±»æ¨ï¼Œå¦‚æœæˆ‘ä»¬è¦ä¼˜åŒ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦è€ƒè™‘<strong>æ˜¯å¦ç¬¬ä¸€è¶Ÿæ¯”è¾ƒn-1æ¬¡åç¬¬äºŒè¶Ÿè¿˜éœ€è¦æ¯”è¾ƒn-2æ¬¡</strong>ï¼Œè¿™ä¸ªæ˜¯å¾ˆé‡è¦çš„ã€‚æ‰€ä»¥æˆ‘ä»¬åº”è¯¥ä»å‡å°‘æ¯”è¾ƒä¸ªæ•°è¿™ä¸ªåœ°æ–¹å¼€å§‹ç€æ‰‹ä¼˜åŒ–</em></p><p>æˆ‘ä»¬å¯ä»¥å‚è€ƒæˆ‘ä»¬ä½“è‚²æ¯”èµ›ä¸­çš„é”¦æ ‡èµ›æ’åºï¼Œåœ¨8ä¸ªè¿åŠ¨å‘˜ä¸­é€‰æ‹©å‰3åæœ€å¤šåªéœ€è¦11åœºæ¯”èµ›ï¼Œè€Œä¸æ˜¯7+6+5åœºæ¯”èµ›ã€‚</p><p>è€Œè¿™å°±æ˜¯æˆ‘ä»¬çš„é”¦æ ‡èµ›æ’åºï¼š</p><h3 id="é”¦æ ‡èµ›æ’åº"><a href="#é”¦æ ‡èµ›æ’åº" class="headerlink" title="é”¦æ ‡èµ›æ’åº"></a>é”¦æ ‡èµ›æ’åº</h3><hr><p>åŸºæœ¬æ€æƒ³ï¼šä¸ä½“è‚²æ¯”èµ›æ—¶çš„æ·˜æ±°èµ›ç±»ä¼¼ã€‚<br>é¦–å…ˆå¯¹ n ä¸ªè®°å½•çš„å…³é”®å­—è¿›è¡Œä¸¤ä¸¤æ¯”è¾ƒï¼Œå¾—åˆ° [n/2] ä¸ª ä¼˜èƒœè€…(å…³é”®å­—å°è€…)ï¼Œä½œä¸ºç¬¬ä¸€æ­¥æ¯”è¾ƒçš„ç»“æœä¿ç•™ä¸‹æ¥ã€‚ç„¶ååœ¨è¿™ [n/2] ä¸ªè¾ƒå°è€…ä¹‹é—´å†è¿›è¡Œä¸¤ä¸¤æ¯”è¾ƒï¼Œâ€¦ï¼Œå¦‚æ­¤é‡å¤ï¼Œç›´åˆ°é€‰å‡ºæœ€å°å…³é”®å­—çš„è®°å½•ä¸ºæ­¢ã€‚<br>ä¼˜ç‚¹ï¼šå‡å°‘æ¯”è¾ƒæ¬¡æ•°ï¼ŒåŠ å¿«æ’åºé€Ÿåº¦<br>ç¼ºç‚¹ï¼šç©ºé—´æ•ˆç‡ä½</p><p>ç®—æ³•å›¾è§£ï¼š</p><p>ä»¥å…³é”®å­—åºåˆ—T= ï¼ˆ21ï¼Œ25ï¼Œ49ï¼Œ25*ï¼Œ16ï¼Œ08ï¼Œ63ï¼‰ä¸ºä¾‹</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210630164415761.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="é”¦æ ‡èµ›æ’åº"></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210630164647564.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="é”¦æ ‡èµ›æ’åº"></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210630164813897.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="é”¦æ ‡èµ›æ’åº"></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210630164859899.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="é”¦æ ‡èµ›æ’åº"></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210630164954897.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="é”¦æ ‡èµ›æ’åº"><br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210630165030443.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="é”¦æ ‡èµ›æ’åº"><br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210630165047263.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="é”¦æ ‡èµ›æ’åº"></p><p> é”¦æ ‡èµ›æ’åºæ„æˆçš„æ ‘æ˜¯å®Œå…¨(æ»¡ï¼‰äºŒå‰æ ‘ï¼Œå…¶æ·±åº¦[$log_{2}{n}$] +1ï¼Œå…¶ä¸­ n ä¸ºå¾…æ’åºå…ƒç´ (å¶å­ç»“ç‚¹)ä¸ªæ•°ã€‚<br>â€¢ æ—¶é—´å¤æ‚åº¦ï¼šO($nlog_{2}{n}$) â€”nä¸ªè®°å½•å„è‡ªæ¯”è¾ƒçº¦$log_{2}{n}$æ¬¡<br>â€¢ ç©ºé—´æ•ˆç‡ï¼š O(nï¼‰ â€”èƒœè€…æ ‘çš„é™„åŠ å†…ç»“ç‚¹å…±æœ‰n0-1ä¸ªï¼<br>â€¢ ç¨³å®šæ€§ï¼šç¨³å®š â€”å¯äº‹å…ˆçº¦å®šå·¦ç»“ç‚¹â€œå°â€</p><p>è¿™ç§æ’åºæ–¹æ³•çš„åŠ£åŠ¿å°±æ˜¯æ¶ˆè€—ç©ºé—´è¾ƒå¤§ï¼Œâ€œæœ€å¤§å€¼â€è¿›è¡Œå¤šä½™çš„æ¯”è¾ƒç­‰é—®é¢˜ã€‚ä¸ºäº†å¼¥è¡¥ï¼ŒJ.williomsåœ¨1964å¹´æå‡ºäº†å¦ä¸€ç§å½¢å¼çš„é€‰æ‹©æ’åºâ€”â€”å †æ’åºã€‚</p><h3 id="å †æ’åº"><a href="#å †æ’åº" class="headerlink" title="å †æ’åº"></a>å †æ’åº</h3><hr><p><a href="https://www.luogu.com.cn/blog/BlueHedgehog/solution-p2676" target="_blank" rel="noopener">è¿™é‡Œæœ‰ä¸€ä¸ªæœ‰å…³å †æ’åºè®²çš„å¾ˆå¥½çš„åšå®¢</a></p><hr><p>æˆ‘ä»¬éœ€è¦è§£å†³è¿™å‡ ä¸ªé—®é¢˜ï¼šä»€ä¹ˆæ˜¯å †ï¼Ÿæ€ä¹ˆå»ºå †ï¼Ÿæ€ä¹ˆå †æ’åºï¼Ÿ</p><h4 id="å †å®šä¹‰"><a href="#å †å®šä¹‰" class="headerlink" title="å †å®šä¹‰"></a>å †å®šä¹‰</h4><ol><li>å®Œå…¨äºŒå‰æ ‘</li><li>æ ‘ä¸­æ‰€æœ‰ç»“ç‚¹çš„å€¼å¿…é¡»å¤§äºï¼ˆæˆ–å°äºï¼‰å…¶å·¦å³å­©å­ï¼Œæ ‘çš„æ ¹ç»“ç‚¹å¿…å®šä¸ºæœ€å¤§å€¼ï¼ˆæˆ–æœ€å°å€¼ï¼‰ã€‚</li></ol><p>åˆ†ä¸ºå¤§æ ¹å †å’Œå°æ ¹å †ï¼Œè¿™ä¸ªå…¶å®å¦‚æœæ ¹èŠ‚ç‚¹æ˜¯æœ€å¤§å€¼ï¼Œé‚£å°±æ˜¯å¤§æ ¹å †ï¼Œåä¹‹å°±æ˜¯å°æ ¹å †ã€‚ä¾‹å­å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210630172615692.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="å †"></p><p>é‚£å¦‚ä½•å»ºå †å‘¢?</p><h4 id="å»ºå †"><a href="#å»ºå †" class="headerlink" title="å»ºå †"></a>å»ºå †</h4><p>åŸºæœ¬æ–¹å¼ï¼šä»æœ€åä¸€ä¸ªéç»ˆç«¯ç»“ç‚¹å¼€å§‹å¾€å‰é€æ­¥è°ƒæ•´ï¼Œè®©æ¯ä¸ªåŒäº²å¤§äºï¼ˆæˆ–å°äºï¼‰å­å¥³ï¼Œç›´åˆ°æ ¹ç»“ç‚¹ä¸ºæ­¢ã€‚</p><p><strong>å®Œå…¨äºŒå‰æ ‘çš„ç¬¬ä¸€ä¸ªéç»ˆç«¯ç»“ç‚¹ç¼–å·å¿…ä¸º[n/2].</strong></p><p><em>ç»ˆç«¯ç»“ç‚¹ï¼šå¶å­ç»“ç‚¹ï¼ˆæ‰€ä»¥ä¸éœ€è¦æˆ‘ä»¬å•ç‹¬è°ƒæ•´ï¼‰</em></p><p>è¿™é‡Œç»™å‡ºå›¾è§£ä¾‹å­ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/2021063020371080.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="å»ºå †"></p><p>æ³¨æ„ä»¥ä¸Šå»ºå †çš„è¿‡ç¨‹ä¸­æ˜¯ä»æœ€åä¸€ä¸ªéå¶å­ç»“ç‚¹å¼€å§‹æ¯æ¬¡æ¯”è¾ƒçš„éƒ½æ˜¯ç»“ç‚¹çš„å·¦å³å­©å­ï¼Œä¸å¿…å’Œçˆ¶èŠ‚ç‚¹æ¯”è¾ƒï¼Œç„¶åæˆ‘ä»¬æ¯”å®Œåä¸ç¬¦åˆçš„å°±äº¤æ¢(<strong>è¿™é‡Œå¦‚æœä¸¤ä¸ªå­å¥³éƒ½æ¯”çˆ¶èŠ‚ç‚¹å¤§é‚£ä¹ˆå°±é€‰å¤§çš„ä¸Šæµ®</strong>)ï¼Œæ³¨æ„äº¤æ¢è¿‡ä¹‹åè¦å†æ¯”ä¸€æ¬¡å·¦å³èŠ‚ç‚¹ï¼ˆ<strong>å³å°†çˆ¶æ¯ç»“ç‚¹ä¸‹ç§»ä¹‹åå¦‚æœè¿˜æœ‰å­èŠ‚ç‚¹è¿˜è¦ç»§ç»­ä¸‹ç§»åˆ¤æ–­ï¼</strong>ï¼‰ã€‚ç„¶åå†å¾€å‰æ‰¾åˆ°å€’æ•°ç¬¬äºŒä¸ªéå¶å­ç»“ç‚¹â€¦.ä»¥æ­¤ç±»æ¨ç›´åˆ°æ ¹ç»“ç‚¹ã€‚</p><h4 id="å †æ’åº-1"><a href="#å †æ’åº-1" class="headerlink" title="å †æ’åº"></a>å †æ’åº</h4><p><em>æˆ‘ä»¬çŸ¥é“ï¼Œå»ºæˆä¸€ä¸ªå †åï¼Œå †çš„æ ¹èŠ‚ç‚¹å°±æ˜¯æœ€å¤§å€¼ï¼ˆæœ€å°å€¼ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥è¾“å‡ºæ ¹èŠ‚ç‚¹ï¼Œé—®é¢˜åœ¨äºï¼Œæˆ‘ä»¬è¾“å‡ºæ ¹èŠ‚ç‚¹åè¿˜éœ€è¦å°†å‰©ä½™çš„ç¼ºä¹æ ¹èŠ‚ç‚¹çš„å †å†æ¬¡ç»´æŠ¤æˆä¸€ä¸ªå®Œæ•´çš„å †ç„¶åå†æ¬¡è¾“å‡ºæ ¹èŠ‚ç‚¹ä»¥è¾¾åˆ°å †æ’åºçš„ç›®çš„ã€‚</em></p><p>æ–¹æ³•ï¼šå°†å½“å‰é¡¶ç‚¹ä¸å †å°¾è®°å½•äº¤æ¢ï¼Œç„¶åä»¿å»ºå †åŠ¨ä½œé‡æ–°è°ƒæ•´ï¼Œå¦‚æ­¤åå¤ç›´è‡³æ’åºç»“æŸã€‚å°†ä»»åŠ¡è½¬åŒ–ä¸ºâ€”&gt;<br>H.r[iâ€¦m]ä¸­é™¤r[i]å¤–ï¼Œå…¶ä»–éƒ½å…·æœ‰å †ç‰¹å¾ã€‚ç°è°ƒæ•´r[i]çš„å€¼ ï¼Œä½¿H.r[iâ€¦m]ä¸ºå †ã€‚</p><p>è¿™å°±ç›¸å½“äºæˆ‘ä»¬æŠŠæ ¹èŠ‚ç‚¹å’Œæœ€æœ«å°¾çš„é‚£ä¸ªç»“ç‚¹äº¤æ¢äº†ä¸€ä¸‹ä½ç½®ç„¶åæ•°ç»„é•¿åº¦lengthâ€“ç›´æ¥åˆ é™¤äº†åŸæ¥æ ¹èŠ‚ç‚¹ï¼Œç„¶åç›®å‰å°±æ˜¯ä¸€ä¸ªæ ¹èŠ‚ç‚¹ä¸æ»¡è¶³å †å…¶ä»–ç‚¹éƒ½æ»¡è¶³å †çš„ä¸€ä¸ªâ€œå †â€ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥<strong>åªéœ€è¦ç»´æŠ¤è¿™ä¸€ä¸ªç‚¹</strong>å°±å¯ä»¥äº†ã€‚ä»¥æ­¤ç±»æ¨ï¼Œè¾¾åˆ°å †æ’åºç›®çš„ã€‚å³ï¼š</p><p>åŸºäºåˆå§‹å †è¿›è¡Œå †æ’åºçš„ç®—æ³•æ­¥éª¤ï¼š<br>å †çš„ç¬¬ä¸€ä¸ªå¯¹è±¡r[1]å…·æœ‰æœ€å¤§çš„å…³é”®ç ï¼Œå°†r[1]ä¸r[n]å¯¹è°ƒï¼ŒæŠŠå…·æœ‰æœ€å¤§å…³é”®ç çš„å¯¹è±¡äº¤æ¢åˆ°æœ€å;<br>å†å¯¹å‰é¢çš„n-1ä¸ªå¯¹è±¡ï¼Œä½¿ç”¨å †çš„è°ƒæ•´ç®—æ³•ï¼Œé‡æ–°å»ºç«‹å †ã€‚<br>ç»“æœå…·æœ‰æ¬¡æœ€å¤§å…³é”®ç çš„å¯¹è±¡åˆä¸Šæµ®åˆ°å †é¡¶ï¼Œå³r[1] ä½ç½®;<br>å†å¯¹è°ƒr[1]å’Œr[n-1]ï¼Œç„¶åå¯¹å‰n-2ä¸ªå¯¹è±¡é‡æ–°è°ƒæ•´ï¼Œâ€¦<br>å¦‚æ­¤åå¤ï¼Œæœ€åå¾—åˆ°å…¨éƒ¨æ’åºå¥½çš„å¯¹è±¡åºåˆ—ã€‚</p><p>å›¾è§£ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210630210532115.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="å †æ’åº"><br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210630210554583.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="å †æ’åº"><br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/2021063021061067.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="å †æ’åº"><br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210630210627725.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="å †æ’åº"><br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210630210644962.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="å †æ’åº"></p><h4 id="ç®—æ³•ä»£ç è§£æ"><a href="#ç®—æ³•ä»£ç è§£æ" class="headerlink" title="ç®—æ³•ä»£ç è§£æ"></a>ç®—æ³•ä»£ç è§£æ</h4><p>é¦–å…ˆæˆ‘ä»¬ç›´åˆ°ç”±äºæˆ‘ä»¬å»ºå †è¿‡ç¨‹ä¸­éœ€è¦æ¯”è¾ƒè°ƒæ•´ï¼Œæ‰€ä»¥éœ€è¦ç”¨åˆ°å †è°ƒæ•´å‡½æ•°HeapAdjustã€‚  </p><ol><li>HeapAdjustæ˜¯é’ˆå¯¹ç»“ç‚¹ i çš„å †è°ƒæ•´å‡½æ•°ï¼Œå…¶å«ä¹‰æ˜¯ï¼šä»ç»“ç‚¹iå¼€å§‹åˆ°å †å°¾ä¸ºæ­¢ï¼Œè‡ªä¸Šå‘ä¸‹æ¯”è¾ƒï¼Œå¦‚æœå­å¥³<br>çš„å€¼å¤§äºåŒäº²ç»“ç‚¹çš„å€¼ï¼Œåˆ™äº’ç›¸äº¤æ¢ï¼Œå³æŠŠå±€éƒ¨è°ƒæ•´ä¸ºå¤§æ ¹å †ã€‚è¿™ä¸€è¿‡ç¨‹ç§°ä¹‹ä¸ºç­›é€‰ã€‚</li></ol><pre class="line-numbers language-c"><code class="language-c"><span class="token function">HeapAdjust</span><span class="token punctuation">(</span>HeapType <span class="token operator">&amp;</span>H <span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> m <span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">/*ä»ç»“ç‚¹iå¼€å§‹åˆ°å½“å‰å †å°¾mä¸ºæ­¢ï¼Œè‡ªä¸Šå‘ä¸‹æ¯”è¾ƒï¼Œå¦‚æœå­å¥³çš„    å€¼å¤§äºåŒäº²ç»“ç‚¹çš„å€¼ï¼Œåˆ™äº’ç›¸äº¤æ¢ï¼Œå³æŠŠå±€éƒ¨è°ƒæ•´ä¸ºå¤§æ ¹å †ã€‚*/</span>    current<span class="token operator">=</span>i<span class="token punctuation">;</span> temp<span class="token operator">=</span>H<span class="token punctuation">.</span>r<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> child<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>i<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//tempæš‚å­˜ r[i]å€¼ï¼Œchildæ˜¯å…¶å·¦å­©å­</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>child<span class="token operator">&lt;=</span>m<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//æ£€æŸ¥æ˜¯å¦åˆ°è¾¾å½“å‰å †å°¾ï¼Œæœªåˆ°å°¾åˆ™æ•´ç†</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> child<span class="token operator">&lt;</span>m <span class="token operator">&amp;&amp;</span> H<span class="token punctuation">.</span>r<span class="token punctuation">[</span>child<span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token operator">&lt;</span>H<span class="token punctuation">.</span>r<span class="token punctuation">[</span>child<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>key <span class="token punctuation">)</span>        child<span class="token operator">=</span> child<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//è®©childæŒ‡å‘ä¸¤å­å¥³ä¸­çš„å¤§è€…ä½ç½®</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> temp<span class="token punctuation">.</span>key<span class="token operator">>=</span>H<span class="token punctuation">.</span>r<span class="token punctuation">[</span>child<span class="token punctuation">]</span><span class="token punctuation">.</span>key <span class="token punctuation">)</span> breack<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//æ ¹å¤§åˆ™ä¸å¿…è°ƒæ•´ï¼Œå‡½æ•°ç»“æŸ</span>    <span class="token keyword">else</span> <span class="token punctuation">{</span>         H<span class="token punctuation">.</span>r<span class="token punctuation">[</span>current<span class="token punctuation">]</span><span class="token operator">=</span>H<span class="token punctuation">.</span>r<span class="token punctuation">[</span>child<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//å¦åˆ™å­å¥³ä¸­çš„å¤§è€…ä¸Šç§»</span>        current<span class="token operator">=</span> child<span class="token punctuation">;</span> child<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span> child<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token comment" spellcheck="true">//å°†æ ¹ä¸‹ç§»åˆ°å­©å­ä½ç½®å¹¶ç»§ç»­å‘ä¸‹æ•´ç†ï¼(è¿™ä¸€ç‚¹å¾ˆå…³é”®)</span>    <span class="token punctuation">}</span><span class="token comment" spellcheck="true">// while</span>    H<span class="token punctuation">.</span>r<span class="token punctuation">[</span>current<span class="token punctuation">]</span><span class="token operator">=</span>temp<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//ç›´åˆ°è‡ªä¸‹è€Œä¸Šéƒ½æ»¡è¶³å †å®šä¹‰ï¼Œå†å®‰ç½®å…¥å£ç»“ç‚¹</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// HeapAdjust</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="2"><li>å»ºå †</li></ol><pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">HeapSort</span> <span class="token punctuation">(</span>HeapType <span class="token operator">&amp;</span>H <span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//Hæ˜¯é¡ºåºè¡¨ï¼Œå«æœ‰H.r[ ]å’ŒH.lengthä¸¤ä¸ªåˆ†é‡</span><span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> H<span class="token punctuation">.</span>length <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">></span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">-</span> <span class="token operator">-</span> i <span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//æŠŠr[1â€¦length]å»ºæˆå¤§æ ¹å †</span>    <span class="token function">HeapAdjust</span><span class="token punctuation">(</span>H<span class="token punctuation">.</span>r<span class="token punctuation">,</span> i<span class="token punctuation">,</span> H<span class="token punctuation">.</span>length <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//ä½¿r[iâ€¦length]æˆä¸ºå¤§æ ¹å †</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// HeapSort</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="3"><li><p>å †æ’åº</p><p>é‡å»ºæ—¶ï¼Œ2è‡³i-1å·ç»“ç‚¹å·²ç¬¦åˆå †çš„è¦æ±‚ï¼Œæ•…åªéœ€ä» 1å·ç»“ç‚¹å¼€å§‹è°ƒæ•´ã€‚å› æ¯æ¬¡ä»å †é¡¶å¼€å§‹è°ƒæ•´ï¼Œæ•…æ¯æ¬¡è°ƒç”¨è€—æ—¶<br>O(log2n).</p><p>â€¢ æ—¶é—´æ•ˆç‡ï¼š T(n) = O($nlog_{2}{n}$ï¼‰ã€‚å› ä¸ºæ•´ä¸ªæ’åºè¿‡ç¨‹ä¸­éœ€è¦è°ƒ<br>ç”¨n-1æ¬¡HeapAdjust( )ç®—æ³•ï¼Œè€Œæ­¤ç®—æ³•è€—æ—¶ä¸ºO($log_{2}{n}$)ï¼›<br>â€¢ æ³¨æ„ï¼šåˆå§‹å»ºå †çš„å…³é”®å­—æ¯”è¾ƒæ¬¡æ•°â‰¤4n,T(n)=Î˜(n)ã€‚<br>â€¢ ç©ºé—´æ•ˆç‡ï¼šO(1)ã€‚åœ¨forå¾ªç¯ä¸­äº¤æ¢è®°å½•æ—¶ç”¨åˆ°ä¸´æ—¶å˜é‡tempã€‚<br>â€¢ ç¨³å®šæ€§ï¼š ä¸ç¨³å®šã€‚<br>â€¢ ä¼˜ç‚¹ï¼šå¯¹å°æ–‡ä»¶æ•ˆæœä¸æ˜æ˜¾ï¼Œä½†å¯¹å¤§æ–‡ä»¶æœ‰æ•ˆã€‚</p></li></ol><pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">HeapSort</span> <span class="token punctuation">(</span>HeapType <span class="token operator">&amp;</span>H <span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//å¯¹é¡ºåºè¡¨Hè¿›è¡Œå †æ’åº</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> H<span class="token punctuation">.</span>length <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">></span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">-</span> <span class="token operator">-</span> i <span class="token punctuation">)</span>    <span class="token function">HeapAdjust</span><span class="token punctuation">(</span>H<span class="token punctuation">,</span>i<span class="token punctuation">,</span> H<span class="token punctuation">.</span>length <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//for,å»ºç«‹åˆå§‹å †</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> H<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">-</span> <span class="token operator">-</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>    H<span class="token punctuation">.</span>r<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> â†â†’ H<span class="token punctuation">.</span>r<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//äº¤æ¢ï¼Œè¦å€Ÿç”¨temp</span>    <span class="token function">HeapAdjust</span><span class="token punctuation">(</span> H<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>i<span class="token number">-1</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//é‡å»ºæœ€å¤§å †, m=i-1</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å½’å¹¶æ’åº"><a href="#å½’å¹¶æ’åº" class="headerlink" title="å½’å¹¶æ’åº"></a>å½’å¹¶æ’åº</h2><hr><p>åŸºæœ¬æ€æƒ³ï¼šå½’å¹¶å«ä¹‰å°±æ˜¯å°†ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„æœ‰åºè¡¨åˆæˆä¸€ä¸ªæ–°çš„æœ‰åºè¡¨ã€‚åˆ©ç”¨è¯¥æ€æƒ³å¯ä»¥å‡è®¾åˆšå¼€å§‹çš„æ— åºè¡¨æ˜¯ä¸€ä¸ªæœ‰nä¸ªé•¿åº¦ä¸º1çš„æœ‰åºè¡¨ï¼Œç„¶åä¸¤ä¸¤å½’å¹¶ï¼Œå¾—åˆ°[n/2]ä¸ªé•¿åº¦ä¸º2çš„æœ‰åºè¡¨ï¼Œå†æ¬¡å½’å¹¶å¾—åˆ°[n/4]ä¸ªé•¿åº¦ä¸º4çš„æœ‰åºè¡¨â€¦â€¦ä»¥æ­¤ç±»æ¨æœ€ç»ˆå¾—åˆ°é•¿åº¦ä¸ºnçš„æœ‰åºè¡¨ã€‚</p><p>ç®—æ³•å›¾è§£ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210630190556841.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="å½’å¹¶æ’åº"></p><p>å½’å¹¶æ’åºçš„ç®—æ³•è¿˜æ˜¯å¾ˆç®€å•çš„ï¼š</p><pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Merge</span> <span class="token punctuation">(</span>RcdType SR<span class="token punctuation">[</span> <span class="token punctuation">]</span>ï¼Œ RcdType <span class="token operator">&amp;</span>TR<span class="token punctuation">[</span> <span class="token punctuation">]</span>ï¼Œ<span class="token keyword">int</span> i<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">// å°†æœ‰åºçš„SR[iâ€¦m]å’ŒSR[m+1â€¦n]å½’å¹¶ä¸ºæœ‰åºçš„TR[iâ€¦n]</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>k<span class="token operator">=</span>i <span class="token punctuation">,</span> j<span class="token operator">=</span>m<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">&lt;=</span>m <span class="token operator">&amp;&amp;</span> j<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span> <span class="token operator">++</span>k <span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> SR<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token operator">&lt;=</span> SR<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>key <span class="token punctuation">)</span>TR<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">=</span>SR<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">else</span> TR<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">=</span>SR<span class="token punctuation">[</span>j<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å°†ä¸¤ä¸ªSRè®°å½•ç”±å°åˆ°å¤§å¹¶å…¥TR</span>    <span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// for</span><span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">)</span> TR<span class="token punctuation">[</span>kâ€¦n<span class="token punctuation">]</span><span class="token operator">=</span>SR<span class="token punctuation">[</span>iâ€¦m<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å°†å‰©ä½™çš„SR[iâ€¦m]å¤åˆ¶åˆ°TR</span><span class="token keyword">if</span> <span class="token punctuation">(</span>j<span class="token operator">&lt;=</span>n<span class="token punctuation">)</span> TR<span class="token punctuation">[</span>kâ€¦n<span class="token punctuation">]</span><span class="token operator">=</span>SR<span class="token punctuation">[</span>jâ€¦n<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å°†å‰©ä½™çš„SR[jâ€¦n]å¤åˆ¶åˆ°TR</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// Merge</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">MSort</span> <span class="token punctuation">(</span>RcdType SR<span class="token punctuation">[</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> RcdType <span class="token operator">&amp;</span>TR1<span class="token punctuation">[</span> <span class="token punctuation">]</span>ï¼Œ<span class="token keyword">int</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">// å°†æ— åºçš„SR[sâ€¦t]å½’å¹¶æ’åºä¸ºTR1[sâ€¦t]</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> s<span class="token operator">==</span>t <span class="token punctuation">)</span>TR1<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token operator">=</span>SR<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å½“len=1æ—¶è¿”å›</span>    <span class="token keyword">else</span> <span class="token punctuation">{</span>        m<span class="token operator">=</span><span class="token punctuation">(</span>s<span class="token operator">+</span>t<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å°†SR [sâ€¦t]å¹³åˆ†ä¸ºSR [sâ€¦m]å’ŒSR [m+1â€¦t]</span>        <span class="token function">MSort</span> <span class="token punctuation">(</span>SRï¼Œ<span class="token operator">&amp;</span>TR2ï¼Œs<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å°†SR ä¸€åˆ†ä¸ºäºŒ, 2åˆ†ä¸º4â€¦</span>        <span class="token comment" spellcheck="true">// é€’å½’åœ°å°†SR [sâ€¦m]å½’å¹¶ä¸ºæœ‰åºçš„TR2[sâ€¦m]</span>        <span class="token function">MSort</span> <span class="token punctuation">(</span>SRï¼Œ<span class="token operator">&amp;</span>TR2ï¼Œm<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> t <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// é€’å½’åœ°å°†SR [m+1â€¦t]å½’å¹¶ä¸ºæœ‰åºçš„TR2[m+1â€¦t]</span>        <span class="token function">Merge</span><span class="token punctuation">(</span>TR2ï¼Œ TR1ï¼Œ s<span class="token punctuation">,</span> m<span class="token punctuation">,</span> t <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// å°†TR2 [sâ€¦m]å’ŒTR2 [m+1â€¦t]å½’å¹¶åˆ°TR1 [sâ€¦t]</span>        <span class="token punctuation">}</span> <span class="token comment" spellcheck="true">//if</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// MSort</span><span class="token comment" spellcheck="true">//TR2åªæ˜¯ä¸€ä¸ªè¾…åŠ©æ•°ç»„</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬ä¸€ä¸ªå‡½æ•°ç”¨æ¥åˆå¹¶æœ‰åºçš„ä¸¤ä¸ªåºåˆ—ï¼Œè€Œç¬¬äºŒä¸ªå‡½æ•°ç”¨æ¥é€’å½’è¿›è¡Œå½’å¹¶ï¼Œè¿™é‡Œç”¨åˆ°äº†TR2è¿™ä¸ªè¾…åŠ©æ•°ç»„ã€‚é¦–å…ˆä¸æ–­é€’å½’è‡³nä¸ªé•¿åº¦ä¸º1çš„æœ‰åºæ•°ç»„åˆ°TR2ä¸­ï¼Œç„¶åå°†ä»–ä»¬ä¸¤ä¸¤Mergeå½’å¹¶èµ·æ¥åˆ°TR2ä¸­ï¼ˆ<strong>æ³¨æ„é™¤äº†ç¬¬ä¸€å±‚é€’å½’å¤–å…¶ä½™çš„æ‰€æœ‰é€’å½’è¿‡ç¨‹ä¸­è™½ç„¶Mergeè°ƒç”¨çš„çœ‹ç€å¥½åƒæ˜¯TR1ï¼Œä½†é‚£æ˜¯å½¢å‚ï¼Œå®é™…ä¸Šé‚£æ˜¯TR2ï¼ï¼ä¹Ÿå°±æ˜¯é‚£ä¸ªMergeå‡½æ•°å®é™…ä¸Šæ˜¯åœ¨è°ƒç”¨å½’å¹¶TR2çš„s..m and m+1..té¡¹åˆ°è‡ªå·±çš„æ•°ç»„ä¸­ï¼ï¼</strong>ï¼‰ï¼Œæ¥ç€ç›´åˆ°æˆ‘ä»¬é€’å½’å›æº¯è‡³æœ€åä¸€å±‚æ—¶ï¼Œä¹Ÿå°±æ˜¯å¼€å§‹çš„å‡½æ•°ï¼Œæˆ‘ä»¬è°ƒç”¨MergeæŠŠå°±å·®ä¸€æ­¥å°±æœ‰åºçš„TR2å½’å¹¶æ’å¥½æ”¾åˆ°TR1ä¸­ã€‚</p><h2 id="åŸºæ•°æ’åº"><a href="#åŸºæ•°æ’åº" class="headerlink" title="åŸºæ•°æ’åº"></a>åŸºæ•°æ’åº</h2><hr><p>åŸºæ•°æ’åºæ˜¯ä¸å‰é¢çš„æ’åºå®Œå…¨ä¸åŒï¼Œå‰é¢çš„æ’åºä¸»è¦æ˜¯é€šè¿‡å…³é”®å­—é—´çš„æ¯”è¾ƒå’Œç§»åŠ¨è®°å½•è¿™ä¸¤ç§æ“ä½œï¼Œè€Œå®ç°åŸºæ•°æ’åºä¸éœ€è¦è®°å½•å…³é”®å­—ä¹‹é—´çš„æ¯”è¾ƒã€‚å®ƒæ˜¯ä¸€ç§<strong>å€ŸåŠ©å¤šå…³é”®å­—æ’åºçš„æ€æƒ³å¯¹å•é€»è¾‘å…³é”®å­—è¿›è¡Œæ’åº</strong>çš„æ–¹æ³•ã€‚</p><p> å¤šå…³é”®å­—æ’åºï¼šnä¸ªå…ƒç´ çš„åºåˆ—{R1,R2,â€¦, Rn}ï¼Œæ¯ä¸ªå…ƒç´ Riæœ‰dä¸ªå…³é”®å­—(K0i, K1i,â€¦, Kd-1i)ï¼Œåˆ™åºåˆ—å¯¹å…³é”®å­—(K0i, K1i,â€¦, Kd-1i)æœ‰åºæ˜¯æŒ‡ï¼š<br>å¯¹äºåºåˆ—ä¸­ä»»æ„ä¸¤ä¸ªè®°å½•Riå’ŒRj(i&lt;j)è®°éƒ½æ»¡è¶³ä¸‹åˆ—æœ‰åºå…³ç³»ï¼š(K0i, K1i,â€¦, Kd-1i) &lt; (K0j, K1j,â€¦, Kd-1j)<br>å…¶ä¸­K0ç§°ä¸ºæœ€ä¸»ä½å…³é”®å­—ï¼ŒKd-1ç§°ä¸ºæœ€æ¬¡ä½å…³é”®å­—ã€‚</p><p>ä¸»è¦åˆ†ä¸ºä¸¤ç±»ï¼š</p><p>æœ€é«˜ä½ä¼˜å…ˆ(MSD):<br>å…ˆå¯¹æœ€ä¸»ä½å…³é”®å­—K0è¿›è¡Œæ’åº,å°†åºåˆ—åˆ†æˆè‹¥å¹²ä¸ªå­åºåˆ—ï¼Œæ¯ä¸ªå­åºåˆ—ä¸­çš„å…ƒç´ å…·æœ‰ç›¸åŒçš„K0å€¼ï¼Œç„¶ååˆ†åˆ«å°±æ¯ä¸ªå­åºåˆ—å¯¹å…³é”®å­—K1è¿›è¡Œæ’åºï¼ŒæŒ‰K1å€¼çš„ä¸åŒå†åˆ†æˆæ›´å°çš„å­åºåˆ—ï¼Œä¾æ¬¡é‡å¤ï¼Œç›´è‡³å¯¹Kd-2è¿›è¡Œæ’åºä¹‹åå¾—åˆ°çš„æ¯ä¸ªå­åºåˆ—ä¸­çš„å…ƒç´ éƒ½å…·æœ‰ç›¸åŒçš„(K0, K1,â€¦, Kd-2)ï¼Œè€Œååˆ†åˆ«ä¸ºæ¯ä¸ªå­åºåˆ—å¯¹Kd-1 è¿›è¡Œæ’åºï¼Œæœ€åå°†æ‰€æœ‰å­åºåˆ—ä¾æ¬¡è”æ¥æˆä¸ºä¸€ä¸ªæœ‰åºåºåˆ—ã€‚</p><p>æœ€ä½ä½ä¼˜å…ˆ(LSD) ï¼š                                                                                                                                                                 å…ˆå¯¹æœ€æ¬¡ä½å…³é”®å­—Kd-1è¿›è¡Œæ’åº,ç„¶åå¯¹Kd-2è¿›è¡Œæ’åºï¼Œä¾æ¬¡é‡å¤ï¼Œç›´è‡³å¯¹K0è¿›è¡Œæ’åºåä¾¿æˆä¸ºä¸€ä¸ªæœ‰åºåºåˆ—</p><p>é“¾å¼åŸºæ•°æ’åºï¼š</p><p>å¯¹äºæ•´å‹æˆ–å­—ç¬¦å‹çš„å•å…³é”®å­—ï¼Œå¯ä»¥çœ‹æˆæ˜¯ç”±å¤šä¸ªæ•°ä½æˆ–å¤šä¸ªå­—ç¬¦<br>æ„æˆçš„å¤šå…³é”®å­—ã€‚ä»…åˆ†æå…³é”®å­—è‡ªèº«æ¯ä½çš„å€¼ï¼Œé€šè¿‡åˆ†é…ã€æ”¶é›†è¿›è¡Œå¤„ç†ã€‚</p><ol><li>å¾…æ’åºè®°å½•ä»¥æŒ‡é’ˆç›¸é“¾ï¼Œæ„æˆä¸€ä¸ªé“¾è¡¨ï¼ˆé™æ€é“¾è¡¨ï¼‰ï¼›</li><li>â€œåˆ†é…â€æ—¶ï¼ŒæŒ‰å½“å‰â€œå…³é”®å­—ä½â€æ‰€å–å€¼ï¼Œå°†è®°å½•åˆ†é…åˆ°ä¸åŒçš„<br>â€œé“¾é˜Ÿåˆ—â€ä¸­ï¼Œæ¯ä¸ªé˜Ÿåˆ—ä¸­è®°å½•çš„ â€œå…³é”®å­—ä½â€ç›¸åŒï¼›</li><li>â€œæ”¶é›†â€æ—¶ï¼ŒæŒ‰å½“å‰å…³é”®å­—ä½å–å€¼ä»å°åˆ°å¤§å°†å„é˜Ÿåˆ—é¦–å°¾ç›¸é“¾æˆ<br>ä¸€ä¸ªé“¾è¡¨;</li><li>å¯¹æ¯ä¸ªå…³é”®å­—ä½å‡é‡å¤ 2) å’Œ 3) ä¸¤æ­¥ã€‚</li></ol><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210630221322610.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="åŸºæ•°æ’åº"><br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210630221343492.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="åŸºæ•°æ’åº"><br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210630221450530.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="åŸºæ•°æ’åº"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><hr><h3 id="æ’åºæ–¹æ³•æ¯”è¾ƒ"><a href="#æ’åºæ–¹æ³•æ¯”è¾ƒ" class="headerlink" title="æ’åºæ–¹æ³•æ¯”è¾ƒ"></a>æ’åºæ–¹æ³•æ¯”è¾ƒ</h3><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210630221719469.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="æ€»ç»“"></p><h3 id="æ–¹æ³•é€‰æ‹©"><a href="#æ–¹æ³•é€‰æ‹©" class="headerlink" title="æ–¹æ³•é€‰æ‹©"></a>æ–¹æ³•é€‰æ‹©</h3><p>åŸºæœ¬æœ‰åºæ—¶å¯é€‰ç”¨ç›´æ¥æ’å…¥ã€ç®€å•é€‰æ‹©ã€å †æ’åºã€é”¦æ ‡èµ›æ’åºã€å†’æ³¡æ’åºã€å½’å¹¶æ’åºã€(å¸Œå°”æ’åº)ç­‰æ–¹æ³•ï¼Œå…¶ä¸­æ’å…¥æ’åºå’Œå†’æ³¡åº”è¯¥æ˜¯æœ€å¿«çš„ã€‚å› ä¸»è¦æ˜¯æ¯”è¾ƒæ“ä½œï¼Œç§»åŠ¨å…ƒç´ å¾ˆå°‘ã€‚æ­¤æ—¶å¹³å‡æ—¶é—´å¤æ‚åº¦ä¸ºO(n)ã€‚<br>æ— åºçš„æƒ…å†µä¸‹æœ€å¥½é€‰ç”¨å¿«é€Ÿæ’åºã€å¸Œå°”æ’åºã€ç®€å•é€‰æ‹©æ’åºç­‰ï¼Œè¿™äº›ç®—æ³•çš„å…±åŒç‰¹ç‚¹æ˜¯ï¼Œé€šè¿‡â€œæŒ¯è¡â€è®©æ•°å€¼ç›¸å·®ä¸å¤§ä½†ä½ç½®å·®å¼‚å¾ˆå¤§çš„å…ƒç´ å°½å¿«åˆ°ä½ã€‚</p><h3 id="å†™åœ¨åé¢"><a href="#å†™åœ¨åé¢" class="headerlink" title="å†™åœ¨åé¢"></a>å†™åœ¨åé¢</h3><p>ç»ˆäºå†™å®Œäº†QAQï¼ŒçœŸæ˜¯ç´¯æ­»æˆ‘äº†ã€‚æ„Ÿè°¢å¤§å®¶çœ‹åˆ°è¿™é‡Œï¼Œçœ‹åˆ°è¿™é‡Œçš„æ˜¯çœŸğŸ¦ï¼Œä¹Ÿæ¬¢è¿å¤§å®¶ä¸€é”®ä¸‰è¿å“¦~</p><p>ä»¥ä¸Šã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C </tag>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
            <tag> æ’åº </tag>
            
            <tag> å›¾è§£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŠ¨æ€æŸ¥æ‰¾è¡¨ä¹‹äºŒå‰æ’åºæ ‘å’Œå¹³è¡¡äºŒå‰æ ‘ï¼ˆå›¾è§£+ä»£ç è¯¦è§£ï¼‰</title>
      <link href="/2021/08/01/dong-tai-cha-zhao-biao-zhi-er-cha-pai-xu-shu-he-ping-heng-er-cha-shu-tu-jie-dai-ma-xiang-jie/"/>
      <url>/2021/08/01/dong-tai-cha-zhao-biao-zhi-er-cha-pai-xu-shu-he-ping-heng-er-cha-shu-tu-jie-dai-ma-xiang-jie/</url>
      
        <content type="html"><![CDATA[<p><strong>åŠ¨æ€æŸ¥æ‰¾è¡¨</strong>ï¼šä¸é™æ€æŸ¥æ‰¾è¡¨ä¸åŒçš„æ˜¯ï¼ŒåŠ¨æ€æŸ¥æ‰¾è¡¨æ˜¯åœ¨æŸ¥æ‰¾è¿‡ç¨‹ä¸­åŠ¨æ€ç”Ÿæˆçš„ï¼Œå³å¯¹äºç»™å®šå€¼key, è‹¥è¡¨ä¸­å­˜åœ¨å…¶å…³é”®å­—ç­‰äºkeyçš„è®°å½•ï¼Œåˆ™æŸ¥æ‰¾æˆåŠŸè¿”å›ï¼Œå¦åˆ™æ’å…¥å…³é”®å­—ç­‰äºkeyçš„è®°å½•ã€‚</p><p>ä¸»è¦åˆ†ä¸ºï¼šäºŒå‰æ’åºæ ‘ã€å¹³è¡¡äºŒå‰æ ‘ã€B-å’ŒB+æ ‘ã€‚</p><p>æˆ‘ä»¬è¿™é‡Œä¸»è¦åˆ†æè®¨è®ºå‰ä¸¤ç§ã€‚</p><p>@<a href="ç›®å½•">TOC</a></p><h1 id="äºŒå‰æ’åºæ ‘"><a href="#äºŒå‰æ’åºæ ‘" class="headerlink" title="äºŒå‰æ’åºæ ‘"></a>äºŒå‰æ’åºæ ‘</h1><hr><h2 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h2><p><strong>å®šä¹‰</strong>ï¼šäºŒå‰æ’åºæ ‘ï¼Œåˆç§°äºŒå‰æŸ¥æ‰¾æ ‘ã€‚æˆ–è€…æ˜¯ä¸€é¢—ç©ºæ ‘ï¼Œæˆ–è€…æ˜¯æ»¡è¶³ä»¥ä¸‹æ€§è´¨çš„äºŒå‰æ ‘ï¼š</p><p>1)  è‹¥å…¶å·¦å­æ ‘ä¸ç©ºï¼Œåˆ™å·¦å­æ ‘ä¸Šæ‰€æœ‰ç»“ç‚¹çš„å€¼å‡å°äºå®ƒçš„æ ¹ç»“ç‚¹çš„å€¼ï¼›<br>2)  è‹¥å…¶å³å­æ ‘ä¸ç©ºï¼Œåˆ™å³å­æ ‘ä¸Šæ‰€æœ‰ç»“ç‚¹çš„å€¼å‡å¤§äºå®ƒçš„æ ¹ç»“ç‚¹çš„å€¼<br>3)  å…¶å·¦ã€å³å­æ ‘ä¹Ÿåˆ†åˆ«ä¸ºäºŒå‰æ’åºæ ‘</p><p><strong><em>ç‰¹ç‚¹ï¼š äºŒå‰æ’åºæ ‘çš„ä¸­åºéå†åºåˆ—ä¸€å®šæ˜¯é€’å¢æœ‰åºçš„</em></strong></p><p><strong>æ³¨æ„äºŒå‰æ’åºæ ‘å’ŒäºŒå‰åˆ¤å®šæ ‘ä¸è¦ææ··äº†ï¼Œè¿™ä¸¤ä¸ªåŒºåˆ«è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ï¼ŒäºŒå‰åˆ¤å®šæ ‘æ˜¯é™æ€æŸ¥æ‰¾çš„æŠ˜åŠæŸ¥æ‰¾æ—¶ç”¨åˆ°çš„ï¼Œéå†äº†æœç´¢çš„å¯èƒ½æ€§ï¼Œè€Œä¸”ç»“ç‚¹æ”¾ç½®çš„æ˜¯åºå·ã€‚</strong></p><h2 id="æ„é€ äºŒå‰æ’åºæ ‘"><a href="#æ„é€ äºŒå‰æ’åºæ ‘" class="headerlink" title="æ„é€ äºŒå‰æ’åºæ ‘"></a>æ„é€ äºŒå‰æ’åºæ ‘</h2><p>æˆ‘ä»¬å¯¹äºç»™å®šåºåˆ—ï¼Œå–å…¶ç¬¬ä¸€ä¸ªç‚¹ä¸ºæ ¹ç»“ç‚¹ï¼Œç„¶åä¾æ¬¡é€‰æ‹©åç»­èŠ‚ç‚¹è¾¹æ¯”è¾ƒè¾¹æ’å…¥ã€‚å¦‚æœæ¯”å½“å‰ç»“ç‚¹å°ï¼Œå¾€è¯¥èŠ‚ç‚¹å·¦å­æ ‘ç§»åŠ¨æ¯”è¾ƒï¼Œå¦‚æœæ¯”å½“å‰ç»“ç‚¹å¤§ï¼Œåˆ™å¾€è¯¥èŠ‚ç‚¹å³å­æ ‘ç§»åŠ¨æ¯”è¾ƒã€‚ç›´åˆ°åˆ°ä¸€ä¸ªå¾…æ¯”è¾ƒä½ç½®ä¸ºç©ºçš„ä½ç½®ï¼Œå°±æ˜¯è¯¥èŠ‚ç‚¹çš„æœ€ç»ˆä½ç½®ã€‚</p><p>æ–‡å­—è¿‡äºç”Ÿç¡¬ï¼Œå›¾è§£è¯´æ˜ä¸€ä¸‹ï¼š</p><p><em>è®¾è¾“å…¥åºåˆ—ä¸ºï¼šï¼ˆ30,11,18,4,55,19,15,70,58ï¼‰</em></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210703234753819.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="äºŒå‰æ’åºæ ‘æ„é€ "></p><p>å¦‚æ­¤ä¾¿æ„é€ æˆåŠŸäº†ä¸€ä¸ªäºŒå‰æ’åºæ ‘ã€‚</p><p>è¿™æ ·ä¸€æ¥æˆ‘ä»¬ä¹Ÿå¯ä»¥å¾ˆæ–¹ä¾¿çš„è®¡ç®—å‡ºå…¶å¹³å‡æŸ¥æ‰¾é•¿åº¦ï¼Œæ¯ä¸€å±‚çš„é«˜åº¦å°±æ˜¯æŸ¥æ‰¾æ‰€èŠ±è´¹çš„æ¬¡æ•°ï¼Œä¾‹å¦‚ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210703235103726.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="äºŒå‰æ’åºæ ‘"></p><h2 id="åŸºæœ¬æ“ä½œä»£ç è§£æ"><a href="#åŸºæœ¬æ“ä½œä»£ç è§£æ" class="headerlink" title="åŸºæœ¬æ“ä½œä»£ç è§£æ"></a>åŸºæœ¬æ“ä½œä»£ç è§£æ</h2><h3 id="å­˜å‚¨ç»“æ„"><a href="#å­˜å‚¨ç»“æ„" class="headerlink" title="å­˜å‚¨ç»“æ„"></a>å­˜å‚¨ç»“æ„</h3><p>é¦–å…ˆæˆ‘ä»¬é€‰æ‹©ä½¿ç”¨äºŒå‰é“¾è¡¨ä½œä¸ºå…¶å­˜å‚¨ç»“æ„ï¼š</p><pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> BiTNode <span class="token punctuation">{</span><span class="token comment" spellcheck="true">// ç»“ç‚¹ç»“æ„</span>    TElemType data<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// åŒ…å«key</span>    <span class="token keyword">struct</span> BiTNode <span class="token operator">*</span>lchild<span class="token punctuation">,</span> <span class="token operator">*</span>rchild<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å·¦å³å­©å­æŒ‡é’ˆ</span><span class="token punctuation">}</span> BiTNode<span class="token punctuation">,</span> <span class="token operator">*</span>BiTree<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æŸ¥æ‰¾æ“ä½œ"><a href="#æŸ¥æ‰¾æ“ä½œ" class="headerlink" title="æŸ¥æ‰¾æ“ä½œ"></a>æŸ¥æ‰¾æ“ä½œ</h3><h4 id="é€’å½’ç®—æ³•"><a href="#é€’å½’ç®—æ³•" class="headerlink" title="é€’å½’ç®—æ³•"></a>é€’å½’ç®—æ³•</h4><p>æ€è·¯å¾ˆç®€å•ï¼Œä»…éœ€è¦ä»æ ¹èŠ‚ç‚¹å¼€å§‹æ¯”è¾ƒå°±å¯ä»¥ï¼Œæ¯”å½“å‰ç»“ç‚¹å¤§å°±æ‰¾å·¦å­æ ‘ï¼Œå°å°±æ‰¾å³å­æ ‘ç›´åˆ°æ‰¾åˆ°ä¸ºæ­¢</p><pre class="line-numbers language-c"><code class="language-c">BiTree <span class="token function">SearchBST</span> <span class="token punctuation">(</span>BiTree Tï¼ŒKeyType key<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//åœ¨æ ¹æŒ‡é’ˆTæ‰€æŒ‡äºŒå‰æ’åºæ ‘ä¸­é€’å½’åœ°æŸ¥æ‰¾æŸå…³é”®å­—ç­‰äºkeyçš„æ•°æ®å…ƒç´ </span>    <span class="token comment" spellcheck="true">//è‹¥æŸ¥æ‰¾æˆåŠŸï¼Œåˆ™è¿”å›æŒ‡å‘è¯¥æ•°æ®å…ƒç´ ç»“ç‚¹çš„æŒ‡é’ˆï¼Œå¦åˆ™è¿”å›ç©ºæŒ‡é’ˆ</span>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token operator">!</span>T<span class="token punctuation">)</span><span class="token operator">||</span><span class="token function">EQ</span><span class="token punctuation">(</span>keyï¼ŒT<span class="token operator">-></span>data<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span>         <span class="token keyword">return</span> <span class="token punctuation">(</span>T<span class="token punctuation">)</span>ï¼› <span class="token comment" spellcheck="true">//æŸ¥æ‰¾ç»“æŸ</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token function">LT</span><span class="token punctuation">(</span>keyï¼ŒT<span class="token operator">-></span>data<span class="token punctuation">.</span>key<span class="token punctuation">)</span>        <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token function">SearchBST</span><span class="token punctuation">(</span>T<span class="token operator">-></span>lchildï¼Œkey<span class="token punctuation">)</span><span class="token punctuation">)</span>ï¼›    <span class="token comment" spellcheck="true">//åœ¨å·¦å­æ ‘ä¸­ç»§ç»­æŸ¥æ‰¾</span>    <span class="token keyword">else</span>         <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token function">SearchBST</span><span class="token punctuation">(</span>T<span class="token operator">-></span>rchildï¼Œkey<span class="token punctuation">)</span><span class="token punctuation">)</span>ï¼›    <span class="token comment" spellcheck="true">// åœ¨å³å­æ ‘ä¸­ç»§ç»­æŸ¥æ‰¾</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">//SearchBST</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="éé€’å½’ç®—æ³•"><a href="#éé€’å½’ç®—æ³•" class="headerlink" title="éé€’å½’ç®—æ³•"></a>éé€’å½’ç®—æ³•</h4><p>ç”±äºæˆ‘ä»¬è¿™ä¸ªä¸éœ€è¦å›æº¯ï¼Œå®é™…ä¸Šä¹Ÿå°±æ˜¯ä½¿ç”¨ä¸€ä¸ªwhileå¾ªç¯ä»£æ›¿é€’å½’çš„å·¥ä½œæ ˆï¼Œæ€è·¯å’Œé€’å½’ç®—æ³•å·®ä¸å¤šã€‚</p><pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">struct</span> BiTNode <span class="token operator">*</span><span class="token function">search_tree</span><span class="token punctuation">(</span><span class="token keyword">struct</span> BiTNode <span class="token operator">*</span>T<span class="token punctuation">,</span> keytype key<span class="token punctuation">)</span><span class="token comment" spellcheck="true">//è¿”å›å€¼</span>å¤±è´¥ï¼š<span class="token constant">NULL</span> æˆåŠŸï¼šé<span class="token constant">NULL</span>ï¼Œç»“ç‚¹æŒ‡é’ˆ<span class="token punctuation">{</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>T<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>key<span class="token operator">==</span>T<span class="token operator">-></span>data<span class="token punctuation">.</span>key<span class="token punctuation">)</span>        <span class="token keyword">return</span> Tï¼›        <span class="token comment" spellcheck="true">//æŸ¥æ‰¾æˆåŠŸ</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>key<span class="token operator">&lt;</span>T<span class="token operator">-></span>data<span class="token punctuation">.</span>key<span class="token punctuation">)</span>        T<span class="token operator">=</span>T<span class="token operator">-></span>lchildï¼› <span class="token comment" spellcheck="true">//æŸ¥å·¦å­æ ‘</span>    <span class="token keyword">else</span>        T<span class="token operator">=</span>T<span class="token operator">-></span>rchildï¼› <span class="token comment" spellcheck="true">//æŸ¥å³å­æ ‘</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> Tï¼›    <span class="token comment" spellcheck="true">//æŸ¥æ‰¾å¤±è´¥</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ’å…¥"><a href="#æ’å…¥" class="headerlink" title="æ’å…¥"></a>æ’å…¥</h3><p>æ’å…¥çš„æ€è·¯ç›¸å¯¹è€Œè¨€ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œä¸»è¦å€ŸåŠ©æŸ¥æ‰¾ï¼ŒæŠŠæ–°èŠ‚ç‚¹ä½œä¸ºå¶å­æ’å…¥ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-c"><code class="language-c">Status <span class="token function">InsertBST</span><span class="token punctuation">(</span>BiTree <span class="token operator">&amp;</span>T<span class="token punctuation">,</span> ElemType e<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//å½“äºŒå‰æ’åºæ ‘ä¸­ä¸å­˜åœ¨å…³é”®å­—ç­‰äºe.keyçš„æ•°æ®å…ƒç´ æ—¶ï¼Œ</span><span class="token comment" spellcheck="true">//æ’å…¥å…ƒç´ eå¹¶è¿”å›trueï¼Œå¦åˆ™è¿”å›false</span>    p <span class="token operator">=</span> T<span class="token punctuation">;</span> father <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>p <span class="token operator">&amp;&amp;</span> p<span class="token operator">-></span>data<span class="token punctuation">.</span>key<span class="token operator">!=</span>e<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>        father <span class="token operator">=</span> p<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>key<span class="token operator">></span>p<span class="token operator">-></span>data<span class="token punctuation">.</span>key<span class="token punctuation">)</span> p <span class="token operator">=</span> p<span class="token operator">-></span>rchild<span class="token punctuation">;</span>        <span class="token keyword">else</span> p <span class="token operator">=</span> p<span class="token operator">-></span>lchild<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token comment" spellcheck="true">//while</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token keyword">return</span> false<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//é”®å€¼ä¸ºe.keyçš„ç»“ç‚¹å·²ç»å­˜åœ¨</span>    s <span class="token operator">=</span> new BiTnode<span class="token punctuation">;</span> s<span class="token operator">-></span>data <span class="token operator">=</span> e<span class="token punctuation">;</span> s<span class="token operator">-></span>lchild <span class="token operator">=</span> s<span class="token operator">-></span>rchild <span class="token operator">=</span> null<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>father<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span> T <span class="token operator">=</span> s<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//ç©ºæ ‘æ’å…¥</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>key<span class="token operator">></span>father<span class="token operator">-></span>data<span class="token punctuation">.</span>key<span class="token punctuation">)</span> father<span class="token operator">-></span>rchild <span class="token operator">=</span> s<span class="token punctuation">;</span>    <span class="token keyword">else</span> father<span class="token operator">-></span>lchild <span class="token operator">=</span> s<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//InsertBST</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h3><p>åˆ é™¤æ“ä½œç›¸å¯¹äºå‰é¢çš„æŸ¥æ‰¾ä¸æ’å…¥å°±å¤æ‚ä¸€äº›äº†ã€‚åˆ é™¤æŸå…ƒç´ éœ€è¦ç»´æŠ¤äºŒå‰æ’åºæ ‘çš„å½¢çŠ¶ã€‚è¿™é‡Œå‡è®¾<em>pè¡¨ç¤ºå¾…åˆ é™¤ç»“ç‚¹çš„æŒ‡é’ˆï¼Œ$$P_L$$ å’Œ$$P_R$$ä»£è¡¨pçš„å·¦å³å­©å­æŒ‡é’ˆï¼Œfæ˜¯pçš„çˆ¶èŠ‚ç‚¹ï¼Œå¹¶å‡è®¾*</em>pæ˜¯fçš„å·¦å­©å­**ã€‚é‚£ä¹ˆæœ‰ä¸‰ç§æƒ…å†µéœ€è¦æˆ‘ä»¬è€ƒè™‘ï¼Œä¸€ç§æƒ…å†µæ˜¯pæ²¡æœ‰å·¦å³å­©å­ï¼Œé‚£åªéœ€æˆ‘ä»¬æ›´æ”¹ä¸€ä¸‹fçš„å·¦å­©å­æŒ‡é’ˆæŒ‡å‘ï¼ŒæŒ‡å‘ç©ºæŒ‡é’ˆå³å¯ï¼›ç¬¬äºŒç§æƒ…å†µä¾¿æ˜¯påªæœ‰ä¸€ä¸ªå­©å­ï¼Œé‚£ä¹ˆè¿™æ ·ä¹Ÿåªéœ€å°†fçš„å·¦å­©å­æŒ‡é’ˆæŒ‡å‘$$P_L$$ æˆ–$$P_R$$ï¼›ç¬¬ä¸‰ç§æƒ…å†µå°±æ˜¯pæœ‰ä¸¤ä¸ªå­©å­ï¼Œè¿™æ ·å°±éœ€è¦æˆ‘ä»¬åˆ†æä¸€ä¸‹äº†ï¼š</p><p>è®¾åˆ é™¤å‰çš„ä¸­åºéå†åºåˆ—ä¸ºï¼š     â€¦. $$P_L$$  s p $$P_R$$  f â€¦.<br>//pçš„ç›´æ¥å‰é©±æ˜¯s<br>//sæ˜¯<em>på·¦å­æ ‘æœ€å³ä¸‹æ–¹çš„ç»“ç‚¹<br>åˆ é™¤påï¼Œä½¿å…¶å®ƒå…ƒç´ çš„ç›¸å¯¹ä½ç½®ä¸å˜ã€‚æœ‰ä¸¤ç§è§£å†³æ–¹æ³•ï¼š<br>æ³•1ï¼šä»¤</em>pçš„å·¦å­æ ‘ä¸º <em>fçš„å·¦å­æ ‘ï¼Œ</em>pçš„å³å­æ ‘æ¥ä¸º<em>sçš„å³å­æ ‘ï¼›å³ $$f_L$$ =$$P_L$$  ; $$S_R$$ =$$P_R$$  ;<br>æ³•2ï¼šç›´æ¥ä»¤</em>sä»£æ›¿<em>på³   *sä¸º</em>på·¦å­æ ‘æœ€å³ä¸‹æ–¹çš„ç»“ç‚¹</p><p>å›¾è§£å¦‚ä¸‹ï¼š</p><p>å‡è®¾åˆ é™¤Pç‚¹ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210704001638163.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="åˆ é™¤ç»“ç‚¹"></p><p>åˆ é™¤å„ä¸ªç»“ç‚¹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210704001839117.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="åˆ é™¤ç»“ç‚¹"></p><p>ä»£ç æŒ‰ä»¥ä¸Šæ€æƒ³ç¼–å†™ï¼š</p><pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Delete_BST</span> <span class="token punctuation">(</span>BSTNode <span class="token operator">*</span>T <span class="token punctuation">,</span> KeyType key <span class="token punctuation">)</span><span class="token comment" spellcheck="true">/* åœ¨ä»¥Tä¸ºæ ¹ç»“ç‚¹çš„BSTæ ‘ä¸­åˆ é™¤å…³é”®å­—ä¸ºkeyçš„ç»“ç‚¹ */</span><span class="token punctuation">{</span> BSTNode <span class="token operator">*</span>p<span class="token operator">=</span>T <span class="token punctuation">,</span> <span class="token operator">*</span>f<span class="token operator">=</span><span class="token constant">NULL</span> <span class="token punctuation">,</span> <span class="token operator">*</span>q <span class="token punctuation">,</span> <span class="token operator">*</span>s <span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//qæŒ‡å‘åˆ é™¤ç»“ç‚¹çš„å­©å­</span><span class="token keyword">while</span> <span class="token punctuation">(</span> p<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span><span class="token function">EQ</span><span class="token punctuation">(</span>p<span class="token operator">-></span>key<span class="token punctuation">,</span> key<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// æŸ¥æ‰¾åˆ é™¤ç»“ç‚¹</span><span class="token punctuation">{</span> f<span class="token operator">=</span>p <span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">LT</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> p<span class="token operator">-></span>key<span class="token punctuation">)</span> <span class="token punctuation">)</span> p<span class="token operator">=</span>p<span class="token operator">-></span>Lchild <span class="token punctuation">;</span><span class="token comment" spellcheck="true">// æœç´¢å·¦å­æ ‘</span><span class="token keyword">else</span> p<span class="token operator">=</span>p<span class="token operator">-></span>Rchild <span class="token punctuation">;</span><span class="token comment" spellcheck="true">//æœç´¢å³å­æ ‘</span><span class="token punctuation">}</span><span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">;</span><span class="token comment" spellcheck="true">//æ²¡æœ‰è¦åˆ é™¤çš„ç»“ç‚¹</span> s<span class="token operator">=</span>p <span class="token punctuation">;</span><span class="token comment" spellcheck="true">//æ‰¾åˆ°äº†è¦åˆ é™¤çš„ç»“ç‚¹ä¸ºp ï¼Œå…ˆæ‰¾å…¶æ›¿ä»£ç»“ç‚¹s</span><span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token operator">-></span>Lchild<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token operator">&amp;&amp;</span> p<span class="token operator">-></span>Rchild<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// å·¦ã€å³å­æ ‘éƒ½ä¸ç©º</span><span class="token punctuation">{</span> f<span class="token operator">=</span>p <span class="token punctuation">;</span> s<span class="token operator">=</span>p<span class="token operator">-></span>Lchild <span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// ä»å·¦å­æ ‘å¼€å§‹æ‰¾</span><span class="token keyword">while</span> <span class="token punctuation">(</span>s<span class="token operator">-></span>Rchild<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span> f<span class="token operator">=</span>s <span class="token punctuation">;</span> s<span class="token operator">=</span>s<span class="token operator">-></span>Rchild <span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// æ‰¾å·¦å­æ ‘ä¸­æœ€å³è¾¹çš„ç»“ç‚¹</span>p<span class="token operator">-></span>key<span class="token operator">=</span>s<span class="token operator">-></span>key <span class="token punctuation">;</span> p<span class="token operator">-></span>otherinfo<span class="token operator">=</span>s<span class="token operator">-></span>otherinfo <span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ç”¨sæ›¿æ¢p</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">//ç¬¬3ç§æƒ…å†µç”¨æ–¹æ¡ˆ2å¤„ç†</span><span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token operator">-></span>Lchild<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span> q<span class="token operator">=</span>s<span class="token operator">-></span>Lchild <span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//è‹¥s,å³påªæœ‰å·¦å­æ ‘</span><span class="token keyword">else</span> q<span class="token operator">=</span>s<span class="token operator">-></span>Rchild <span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ç¬¬2,3ç§æƒ…å†µå½’ä¸€å¤„ç†</span><span class="token keyword">if</span> <span class="token punctuation">(</span>f<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span> T<span class="token operator">=</span>q <span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//pä¸ºæ ¹ç»“ç‚¹</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>f<span class="token operator">-></span>Lchild<span class="token operator">==</span>s<span class="token punctuation">)</span> f<span class="token operator">-></span>Lchild<span class="token operator">=</span>q <span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//pä¸ºå·¦å­©å­</span><span class="token keyword">else</span> f<span class="token operator">-></span>Rchild<span class="token operator">=</span>q <span class="token punctuation">;</span><span class="token comment" spellcheck="true">//pä¸ºå³å­©å­</span><span class="token function">free</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token comment" spellcheck="true">//åˆ é™¤p</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ—¶ç©ºå¤æ‚åº¦åˆ†æ"><a href="#æ—¶ç©ºå¤æ‚åº¦åˆ†æ" class="headerlink" title="æ—¶ç©ºå¤æ‚åº¦åˆ†æ"></a>æ—¶ç©ºå¤æ‚åº¦åˆ†æ</h2><p>è‹¥æŸ¥æ‰¾æˆåŠŸï¼Œåˆ™èµ°äº†ä¸€æ¡ä»æ ¹ç»“ç‚¹åˆ°æŸç»“ç‚¹çš„è·¯å¾„ï¼Œè‹¥æŸ¥æ‰¾å¤±è´¥ï¼Œåˆ™èµ°åˆ°ä¸€æ£µç©ºçš„å­æ ‘æ—¶ä¸ºæ­¢ã€‚</p><p>æœ€åæƒ…å†µä¸‹ï¼Œå…¶å¹³å‡æŸ¥æ‰¾é•¿åº¦ä¸ä¼šè¶…è¿‡æ ‘çš„é«˜åº¦ã€‚</p><p>å…·æœ‰nä¸ªç»“ç‚¹çš„äºŒå‰æ ‘çš„é«˜åº¦å–å†³äºå…¶å½¢æ€ã€‚<br>ç”±å…³é”®å­—åºåˆ— 1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5æ„é€ è€Œå¾—çš„äºŒå‰æ’åºæ ‘ï¼ŒASL =ï¼ˆ1+2+3+4+5ï¼‰/ 5 = 3<br>ç”±å…³é”®å­—åºåˆ— 3ï¼Œ1ï¼Œ2ï¼Œ5ï¼Œ4æ„é€ è€Œå¾—çš„äºŒå‰æ’åºæ ‘ï¼ŒASL =ï¼ˆ1+2+3+2+3ï¼‰/ 5 = 2.2</p><p>æœ€å¥½æƒ…å†µ(ä¸ºæ»¡äºŒå‰æ ‘ï¼‰<br>n+1<br>ASL=â€”log2(n+1)-1 = O(log2 n)<br>n<br>æœ€åæƒ…å†µ(ä¸ºå•ææ ‘):<br>ASL=(1+2+â€¦+n)/n=(n+1)/2<br>å¹³å‡å€¼:<br>ASLâ‰ˆO(log2 n)</p><h1 id="å¹³è¡¡äºŒå‰æ’åºæ ‘"><a href="#å¹³è¡¡äºŒå‰æ’åºæ ‘" class="headerlink" title="å¹³è¡¡äºŒå‰æ’åºæ ‘"></a>å¹³è¡¡äºŒå‰æ’åºæ ‘</h1><hr><h2 id="å®šä¹‰-1"><a href="#å®šä¹‰-1" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h2><p><strong>å¹³è¡¡äºŒå‰æ ‘</strong>ï¼šå¹³è¡¡äºŒå‰æ ‘ï¼Œåˆç§°AVLæ ‘ã€‚ å®ƒæˆ–è€…æ˜¯ä¸€é¢—ç©ºæ ‘ï¼Œæˆ–è€…æ˜¯å…·æœ‰ä»¥ä¸‹æ€§è´¨çš„äºŒå‰æ ‘ï¼šå®ƒçš„å·¦å­æ ‘å’Œå³å­æ ‘éƒ½æ˜¯å¹³è¡¡æ ‘ï¼Œä¸”å·¦å­æ ‘å’Œå³å­æ ‘çš„æ·±åº¦ä¹‹å·®çš„ç»å¯¹å€¼ä¸è¶…è¿‡1.</p><p><strong>å¹³è¡¡å› å­</strong>:åˆç§°BFï¼Œå®šä¹‰ä¸ºè¯¥èŠ‚ç‚¹çš„å·¦å­æ ‘çš„æ·±åº¦å‡å»å®ƒçš„å³å­æ ‘æ·±åº¦ã€‚åˆ™å¹³è¡¡äºŒå‰æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹çš„å¹³è¡¡å› å­åªå¯èƒ½æ˜¯-1ã€0ã€1.</p><p><em>åªè¦äºŒå‰æ ‘ä¸Šæœ‰ä¸€ä¸ªç»“ç‚¹çš„å¹³è¡¡å› å­BFç»å¯¹å€¼å¤§äº1ï¼Œé‚£ä¹ˆäºŒå‰æ ‘å°±æ˜¯ä¸å¹³è¡¡çš„</em></p><p>å¦‚ä¸‹ä¾¿æ˜¯å‡ ä¸ªäºŒå‰æ ‘ä¸­å„ç»“ç‚¹çš„å¹³è¡¡å› å­ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210705202047841.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="å¹³è¡¡äºŒå‰æ ‘"></p><p>æˆ‘ä»¬å¸Œæœ›ç”±ä»»ä½•åˆå§‹åºåˆ—æ„æˆçš„äºŒå‰æ’åºæ ‘éƒ½æ˜¯AVLæ ‘ã€‚å› ä¸ºAVLæ ‘ä¸Šä»»ä½•ç»“ç‚¹çš„å·¦å³å­æ ‘çš„æ·±åº¦ä¹‹å·®éƒ½ä¸è¶…è¿‡1.åˆ™å¯ä»¥è¯æ˜å¦‚æ­¤çš„è¯ä»–çš„å¹³å‡æŸ¥æ‰¾é•¿åº¦å’Œ$$log{n}$$åŒæ•°é‡çº§ã€‚</p><p>ä»¥ä¸‹å†æ”¾ä¸€å¼ å›¾å¯¹æ¯”ä¸€ä¸‹å¹³è¡¡äºŒå‰æ ‘ã€äºŒå‰æ’åºæ ‘ã€å¹³è¡¡äºŒå‰æ’åºæ ‘çš„åŒºåˆ«ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210705210414803.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="ä¸‰ç§æ ‘åŒºåˆ«"></p><h2 id="æ„é€ å¹³è¡¡äºŒå‰æ’åºæ ‘"><a href="#æ„é€ å¹³è¡¡äºŒå‰æ’åºæ ‘" class="headerlink" title="æ„é€ å¹³è¡¡äºŒå‰æ’åºæ ‘"></a>æ„é€ å¹³è¡¡äºŒå‰æ’åºæ ‘</h2><p>åŸºæœ¬åŸç†å°±æ˜¯æŒ‰ç…§äºŒå‰æ’åºæ ‘çš„æ€è·¯è¿›è¡Œæ’åºæ„é€ ï¼Œé‡åˆ°æŸä¸ªç»“ç‚¹çš„å¹³è¡¡å› å­ç»å¯¹å€¼å¤§äº1çš„æƒ…å†µçš„æ—¶å€™ï¼Œå°±è¿›è¡Œä¸€å®šçš„æ“ä½œå°†äºŒå‰æ ‘å˜ä¸ºå¹³è¡¡çš„ï¼Œä¸€æ­¥ä¸€æ­¥æŒ‰ç…§è¿™æ ·çš„æ–¹æ³•æœ€åæ„é€ æˆåŠŸã€‚</p><p>æ„é€ è¿‡ç¨‹ä¸­è°ƒæ•´äºŒå‰æ ‘çš„æ“ä½œå¯ä»¥å½’çº³ä¸ºä»¥ä¸‹4ç§æƒ…å†µï¼š</p><p><em>æˆ‘ä»¬å…ˆå‡è®¾æ•´ä¸ªäºŒå‰æ ‘åœ¨æ’å…¥æ–°ç»“ç‚¹ä¹‹åæ‰€å¾—åˆ°çš„ä¸å¹³è¡¡çš„æœ€å°å­æ ‘çš„æ ¹èŠ‚ç‚¹æŒ‡é’ˆä¸ºaï¼Œaå¹³è¡¡å› å­ç»å¯¹å€¼æ­¤æ—¶å¤§äº1.æ­¤æ—¶aæ˜¯ç¦»ç»“ç‚¹æœ€è¿‘çš„å¹³è¡¡å› å­ç»å¯¹å€¼å¤§äº1çš„ç¥–å…ˆèŠ‚ç‚¹</em></p><h3 id="LLå‹ï¼ˆå•å‘å³æ—‹å¹³è¡¡å¤„ç†ï¼‰"><a href="#LLå‹ï¼ˆå•å‘å³æ—‹å¹³è¡¡å¤„ç†ï¼‰" class="headerlink" title="LLå‹ï¼ˆå•å‘å³æ—‹å¹³è¡¡å¤„ç†ï¼‰"></a>LLå‹ï¼ˆå•å‘å³æ—‹å¹³è¡¡å¤„ç†ï¼‰</h3><p>æ­¤æ—¶å‘aç»“ç‚¹çš„å·¦å­æ ‘æ ¹èŠ‚ç‚¹çš„å·¦å­æ ‘ä¸Šæ’å…¥ç»“ç‚¹ï¼Œä½¿å¾—å·¦å­æ ‘çš„é«˜åº¦è¿‡é«˜ï¼Œè¿™æ ·ä¸€æ¥æˆ‘ä»¬éœ€è¦å°†aå·¦å­æ ‘çš„æ ¹èŠ‚ç‚¹æ›¿ä»£açš„ä½ç½®ï¼ŒåŸaå·¦å­æ ‘æ ¹èŠ‚ç‚¹çš„å³å­æ ‘å˜ä¸ºaç»“ç‚¹çš„å·¦å­æ ‘ã€‚è¿™æ ·ä¸€æ¥å°±æœ‰é‡æ–°å›åˆ°å¹³è¡¡ç›¸å½“äºå‘å³åšäº†ä¸€æ¬¡é¡ºæ—¶é’ˆæ—‹è½¬æ“ä½œã€‚å›¾ä¾‹å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210705213931705.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="LLå‹"></p><h3 id="LRå‹ï¼ˆåŒå‘æ—‹è½¬å…ˆå³åå·¦ï¼‰"><a href="#LRå‹ï¼ˆåŒå‘æ—‹è½¬å…ˆå³åå·¦ï¼‰" class="headerlink" title="LRå‹ï¼ˆåŒå‘æ—‹è½¬å…ˆå³åå·¦ï¼‰"></a>LRå‹ï¼ˆåŒå‘æ—‹è½¬å…ˆå³åå·¦ï¼‰</h3><p>æ­¤æ—¶ç”±äºaç»“ç‚¹çš„å·¦å­æ ‘æ ¹èŠ‚ç‚¹ï¼ˆè¿™é‡Œæš‚ç§°b)çš„å³å­æ ‘ï¼ˆå‡è®¾æ ¹èŠ‚ç‚¹ä¸ºcï¼‰æ’å…¥äº†æ–°èŠ‚ç‚¹ï¼Œä½¿å¾—æ•´ä½“å‡ºç°äº†ä¸å¹³è¡¡ï¼Œæˆ‘ä»¬æ­¤æ—¶éœ€è¦ç”¨cå–ä»£açš„ä½ç½®ï¼Œç„¶åcçš„åŸå·¦å­æ ‘ä½œä¸ºbçš„å³å­æ ‘ï¼Œcçš„ç°å·¦å­æ ‘å˜ä¸ºbä¸ºæ ¹çš„æ ‘ï¼Œcçš„åŸå³å­æ ‘å˜ä¸ºaçš„å·¦å­æ ‘ï¼Œcçš„ç°å³å­æ ‘å˜ä¸ºaä¸ºæ ¹çš„æ ‘ã€‚ç›¸å½“äºå…ˆå·¦æ—‹å¤„ç†ä¸€æ¬¡ç„¶åå³æ—‹å¤„ç†äº†ä¸€æ¬¡ã€‚å›¾è§£å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210705220039996.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="LRå‹"></p><h3 id="RRå‹ï¼ˆå•å‘å·¦æ—‹å¹³è¡¡å¤„ç†ï¼‰"><a href="#RRå‹ï¼ˆå•å‘å·¦æ—‹å¹³è¡¡å¤„ç†ï¼‰" class="headerlink" title="RRå‹ï¼ˆå•å‘å·¦æ—‹å¹³è¡¡å¤„ç†ï¼‰"></a>RRå‹ï¼ˆå•å‘å·¦æ—‹å¹³è¡¡å¤„ç†ï¼‰</h3><p>ä¸LLå‹æ¯”è¾ƒç±»ä¼¼ï¼Œè¿™æ¬¡æ˜¯aç»“ç‚¹çš„å³å­æ ‘çš„çš„æ ¹èŠ‚ç‚¹çš„å³å­æ ‘ä¸Šæ’å…¥äº†æ–°èŠ‚ç‚¹åå‘ç”Ÿäº†ä¸å¹³è¡¡çš„æƒ…å†µã€‚æ­¤æ—¶è§£å†³æ–¹æ³•æ˜¯ä½¿ç”¨açš„å³å­æ ‘æ ¹èŠ‚ç‚¹ç§»åˆ°açš„ä½ç½®ï¼Œå¹¶ä¸”å°†açš„åŸå³å­æ ‘çš„å·¦å­æ ‘å˜ä¸ºaçš„å³å­æ ‘ã€‚ç›¸å½“äºè¿›è¡Œäº†ä¸€æ¬¡å‘å·¦çš„é€†æ—¶é’ˆæ—‹è½¬æ“ä½œã€‚å›¾è§£å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210705214711828.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="RRå‹"></p><h3 id="RLå‹ï¼ˆåŒå‘å…ˆå·¦æ—‹åå³æ—‹ï¼‰"><a href="#RLå‹ï¼ˆåŒå‘å…ˆå·¦æ—‹åå³æ—‹ï¼‰" class="headerlink" title="RLå‹ï¼ˆåŒå‘å…ˆå·¦æ—‹åå³æ—‹ï¼‰"></a>RLå‹ï¼ˆåŒå‘å…ˆå·¦æ—‹åå³æ—‹ï¼‰</h3><p>è¿™ä¸ªå’ŒLRå‹æ¯”è¾ƒç±»ä¼¼ï¼Œå®é™…ä¸Šè¿™å››ç§ç±»å‹æ˜¯ä¸¤ä¸¤å¯¹ç§°çš„ã€‚è¿™ä¸ªæŒ‡çš„æ˜¯açš„å³å­æ ‘æ ¹èŠ‚ç‚¹ï¼ˆè®¾ä¸ºbï¼‰çš„å·¦å­æ ‘ï¼ˆè®¾å…¶æ ¹èŠ‚ç‚¹ä¸ºcï¼‰æ’å…¥äº†æ–°èŠ‚ç‚¹å¯¼è‡´äº†ä¸å¹³è¡¡ç°è±¡ã€‚æ­¤æ—¶æˆ‘ä»¬éœ€è¦å°†cä»£æ›¿açš„ä½ç½®ï¼Œcçš„åŸå·¦å­æ ‘ä½œä¸ºaçš„ç°å³å­æ ‘ï¼Œcçš„ç°å·¦å­æ ‘ä¸ºaä¸ºæ ¹èŠ‚ç‚¹çš„æ ‘ï¼Œcçš„åŸå³å­æ ‘ä¸ºbçš„ç°å·¦å­æ ‘ï¼Œcçš„ç°å³å­æ ‘ä¸ºbä¸ºæ ¹èŠ‚ç‚¹çš„æ ‘ã€‚å›¾è§£åŒæ ·å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210705220908967.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="RLå‹"></p><p>ä»¥ä¸‹ä¸¾ä¾‹å­è¯´æ˜ä¸€ä¸‹ï¼š</p><p>ä»¥åºåˆ—ï¼ˆ13ï¼Œ24ï¼Œ37ï¼Œ90ï¼Œ53ï¼‰ä¸ºä¾‹ï¼Œé¦–å…ˆç©ºæ ‘æ˜¯ä¸€ä¸ªå¹³è¡¡çš„ï¼Œç„¶åæŠŠ13åŠ è¿›å»ï¼ŒåŒæ ·å¹³è¡¡ï¼Œå†å°†24åŠ è¿›å»åŒæ ·å¹³è¡¡ã€‚æ¥ä¸‹æ¥åŠ è¿›å»37ï¼Œæ­¤æ—¶å°±å˜ä¸ºRRå‹ï¼Œæˆ‘ä»¬éœ€è¦å·¦æ—‹ï¼Œç”±äº24æ²¡æœ‰å·¦å­æ ‘ï¼Œæ‰€ä»¥åªéœ€è®©13ä¸ºæ ¹çš„æ ‘ä½œä¸º24çš„å·¦å­æ ‘ï¼Œä¸éœ€è¦å¾€13å³å­©å­åŠ ä¸œè¥¿ã€‚æ¥ä¸‹æ¥90ï¼Œä¿æŒå¹³è¡¡ã€‚ç›´åˆ°53ï¼Œå˜ä¸ºRRå‹ï¼Œæ­¤æ—¶37çš„å¹³è¡¡å› å­ç»å¯¹å€¼ä¸º-2ï¼Œå·¦æ—‹åå¾—åˆ°æœ€ç»ˆçš„å¹³è¡¡äºŒå‰æ’åºæ ‘ã€‚å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210705222106842.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="å¹³è¡¡äºŒå‰æ’åºæ ‘æœ€ç»ˆæ„é€ "></p><p>ä»¥ä¸Šã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C </tag>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
            <tag> æŸ¥æ‰¾è¡¨ </tag>
            
            <tag> äºŒå‰æ ‘ </tag>
            
            <tag> äºŒå‰æ’åºæ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Numpyå®ç°ä¸€ä¸ªç®€å•çš„æœºå™¨å­¦ä¹ æ¨¡å‹</title>
      <link href="/2021/08/01/numpy-shi-xian-yi-ge-jian-dan-de-ji-qi-xue-xi-mo-xing/"/>
      <url>/2021/08/01/numpy-shi-xian-yi-ge-jian-dan-de-ji-qi-xue-xi-mo-xing/</url>
      
        <content type="html"><![CDATA[<h1 id="Numpyå®ç°ä¸€ä¸ªç®€å•çš„æœºå™¨å­¦ä¹ æ¨¡å‹"><a href="#Numpyå®ç°ä¸€ä¸ªç®€å•çš„æœºå™¨å­¦ä¹ æ¨¡å‹" class="headerlink" title="Numpyå®ç°ä¸€ä¸ªç®€å•çš„æœºå™¨å­¦ä¹ æ¨¡å‹"></a>Numpyå®ç°ä¸€ä¸ªç®€å•çš„æœºå™¨å­¦ä¹ æ¨¡å‹</h1><p>mes que un codesfarmer è¶³çƒã€éŸ³ä¹ä¸ä»£ç ğŸ˜</p><h3 id="æœ¬å®ä¾‹ä½¿ç”¨numpyå®ç°æœºå™¨å­¦ä¹ ï¼Œç›¸å¯¹äºpytorchè¿™ç±»åŒ…è€Œè¨€éœ€è¦èŠ±è´¹çš„ä»£ç å¤šä¸€ç‚¹ï¼Œä½†æ˜¯æ¯ä¸€æ­¥éƒ½æ˜¯é€æ˜çš„ï¼Œæœ‰åˆ©äºç†è§£æ¯ä¸€æ­¥å·¥ä½œåŸç†"><a href="#æœ¬å®ä¾‹ä½¿ç”¨numpyå®ç°æœºå™¨å­¦ä¹ ï¼Œç›¸å¯¹äºpytorchè¿™ç±»åŒ…è€Œè¨€éœ€è¦èŠ±è´¹çš„ä»£ç å¤šä¸€ç‚¹ï¼Œä½†æ˜¯æ¯ä¸€æ­¥éƒ½æ˜¯é€æ˜çš„ï¼Œæœ‰åˆ©äºç†è§£æ¯ä¸€æ­¥å·¥ä½œåŸç†" class="headerlink" title="æœ¬å®ä¾‹ä½¿ç”¨numpyå®ç°æœºå™¨å­¦ä¹ ï¼Œç›¸å¯¹äºpytorchè¿™ç±»åŒ…è€Œè¨€éœ€è¦èŠ±è´¹çš„ä»£ç å¤šä¸€ç‚¹ï¼Œä½†æ˜¯æ¯ä¸€æ­¥éƒ½æ˜¯é€æ˜çš„ï¼Œæœ‰åˆ©äºç†è§£æ¯ä¸€æ­¥å·¥ä½œåŸç†."></a>æœ¬å®ä¾‹ä½¿ç”¨numpyå®ç°æœºå™¨å­¦ä¹ ï¼Œç›¸å¯¹äºpytorchè¿™ç±»åŒ…è€Œè¨€éœ€è¦èŠ±è´¹çš„ä»£ç å¤šä¸€ç‚¹ï¼Œä½†æ˜¯æ¯ä¸€æ­¥éƒ½æ˜¯é€æ˜çš„ï¼Œæœ‰åˆ©äºç†è§£æ¯ä¸€æ­¥å·¥ä½œåŸç†.</h3><h4 id="é¦–å…ˆæˆ‘ä»¬åº”è¯¥æ˜ç¡®åŸºæœ¬æ­¥éª¤ï¼š"><a href="#é¦–å…ˆæˆ‘ä»¬åº”è¯¥æ˜ç¡®åŸºæœ¬æ­¥éª¤ï¼š" class="headerlink" title="é¦–å…ˆæˆ‘ä»¬åº”è¯¥æ˜ç¡®åŸºæœ¬æ­¥éª¤ï¼š"></a>é¦–å…ˆæˆ‘ä»¬åº”è¯¥æ˜ç¡®åŸºæœ¬æ­¥éª¤ï¼š</h4><ol><li>åŸºäºå‡½æ•°å¼y = 3x ^ 2 + 2 å¾—åˆ°ä¸€äº›æ•°æ®ï¼Œå¦å¤–åŠ ä¸Šä¸€äº›å™ªéŸ³æ•°æ®åˆ°è¾¾å¦ä¸€ç»„æ•°æ®yã€‚</li><li>æ„å»ºä¸€ä¸ªæœºå™¨å­¦ä¹ æ¨¡å‹æ¥å­¦ä¹ è¡¨è¾¾å¼y =  wx^2 + b çš„ä¸¤ä¸ªå‚æ•°w ã€b .åˆ©ç”¨æ•°ç»„x, yçš„æ•°æ®ä¸ºè®­ç»ƒæ•°æ®ã€‚</li><li>é‡‡ç”¨æ¢¯åº¦ä¸‹é™æ³•æ¥é€šè¿‡å¤šæ¬¡è¿­ä»£å­¦ä¹ åˆ°wã€bçš„å€¼ã€‚</li></ol><p>@[TOC]</p><h3 id="å¯¼å…¥å¿…è¦åº“"><a href="#å¯¼å…¥å¿…è¦åº“" class="headerlink" title="å¯¼å…¥å¿…è¦åº“"></a>å¯¼å…¥å¿…è¦åº“</h3><pre><code>import numpy as np%matplotlib inline from matplotlib import pyplot as plt</code></pre><h4 id="ä»£ç åˆ†æï¼š"><a href="#ä»£ç åˆ†æï¼š" class="headerlink" title="ä»£ç åˆ†æï¼š"></a>ä»£ç åˆ†æï¼š</h4><p>%matplotlib inlineæ˜¯ä¸€ä¸ªé­”æ³•å‡½æ•°ï¼ˆMagic Functionsï¼‰ã€‚ä½¿ç”¨%matplotlibå‘½ä»¤å¯ä»¥å°†matplotlibçš„å›¾è¡¨ç›´æ¥åµŒå…¥åˆ°Notebookä¹‹ä¸­ï¼Œæˆ–è€…ä½¿ç”¨æŒ‡å®šçš„ç•Œé¢åº“æ˜¾ç¤ºå›¾è¡¨ï¼Œå®ƒæœ‰ä¸€ä¸ªå‚æ•°æŒ‡å®šmatplotlibå›¾è¡¨çš„æ˜¾ç¤ºæ–¹å¼ã€‚ inlineè¡¨ç¤ºå°†å›¾è¡¨åµŒå…¥åˆ°Notebookä¸­ã€‚</p><h3 id="ç”Ÿæˆæ•°æ®"><a href="#ç”Ÿæˆæ•°æ®" class="headerlink" title="ç”Ÿæˆæ•°æ®"></a>ç”Ÿæˆæ•°æ®</h3><pre><code>np.random.seed(100)x = np.linspace(-1, 1, 100).reshape(100, 1)y = 3 * np.power(x, 2) + 2 + 0.2 * np.random.rand(x.size).reshape(100, 1)</code></pre><h4 id="ä»£ç åˆ†æï¼š-1"><a href="#ä»£ç åˆ†æï¼š-1" class="headerlink" title="ä»£ç åˆ†æï¼š"></a>ä»£ç åˆ†æï¼š</h4><p>ç”Ÿæˆè¾“å…¥æ•°æ®xåŠç›®æ ‡æ•°æ®yï¼Œnp.random.seed(100)æ—¶è®¾ç½®éšæœºæ•°ç§å­ã€‚reshapeå‡½æ•°å°†çŸ©é˜µå½¢çŠ¶æ”¹ä¸ºåˆé€‚çš„å½¢çŠ¶æ–¹ä¾¿æ“ä½œã€‚è€Œånp.random.randæ˜¯ä¸ºäº†åŠ ä¸€äº›å™ªç‚¹ã€‚</p><h3 id="æŸ¥çœ‹xã€yæ•°æ®åˆ†å¸ƒæƒ…å†µ"><a href="#æŸ¥çœ‹xã€yæ•°æ®åˆ†å¸ƒæƒ…å†µ" class="headerlink" title="æŸ¥çœ‹xã€yæ•°æ®åˆ†å¸ƒæƒ…å†µ"></a>æŸ¥çœ‹xã€yæ•°æ®åˆ†å¸ƒæƒ…å†µ</h3><pre><code>plt.scatter(x, y, s=20, c=&#39;red&#39;)plt.show()</code></pre><p>è¿è¡Œç»“æœï¼š <img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210531214950572.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70#pic_center" alt="å‡½æ•°å›¾ç‰‡"></p><h3 id="éšæœºåˆå§‹åŒ–å‚æ•°"><a href="#éšæœºåˆå§‹åŒ–å‚æ•°" class="headerlink" title="éšæœºåˆå§‹åŒ–å‚æ•°"></a>éšæœºåˆå§‹åŒ–å‚æ•°</h3><pre><code>w1 = np.random.rand(1, 1)b1 = np.random.rand(1, 1)</code></pre><h4 id="ä»£ç åˆ†æï¼š-2"><a href="#ä»£ç åˆ†æï¼š-2" class="headerlink" title="ä»£ç åˆ†æï¼š"></a>ä»£ç åˆ†æï¼š</h4><p>éšæœºåˆå§‹åŒ–å‚æ•°w1ã€b1ï¼Œåé¢ä¼šè®¡ç®—æ¢¯åº¦é€æ¸æ¥è¿‘æœ€ä¼˜è§£ã€‚</p><h3 id="è®­ç»ƒæ¨¡å‹"><a href="#è®­ç»ƒæ¨¡å‹" class="headerlink" title="è®­ç»ƒæ¨¡å‹"></a>è®­ç»ƒæ¨¡å‹</h3><pre><code>lr = 0.001  # å­¦ä¹ ç‡for i in range(800):    # å‰å‘ä¼ æ’­    y_pred = np.power(x, 2) * w1 + b1    # å®šä¹‰æŸå¤±å‡½æ•°    loss = 0.5*(y_pred - y) ** 2    loss = loss.sum()    # è®¡ç®—æ¢¯åº¦    grad_w = np.sum((y_pred - y) * np.power(x, 2))    grad_b = np.sum((y_pred - y))    # ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•ï¼Œä½¿lossæœ€å°    w1 -= lr * grad_w    b1 -= lr * grad_b</code></pre><h4 id="ä»£ç åˆ†æï¼š-3"><a href="#ä»£ç åˆ†æï¼š-3" class="headerlink" title="ä»£ç åˆ†æï¼š"></a>ä»£ç åˆ†æï¼š</h4><p><strong>è¿™æ˜¯æˆ‘ä»¬ä»£ç æœ€æ ¸å¿ƒçš„ä¸€éƒ¨åˆ†äº†ã€‚</strong> ä¸€ä¸ªç®€å•çš„å‰å‘ä¼ æ’­ï¼Œy_predæ˜¯é¢„æµ‹å€¼ï¼Œyæ˜¯å®é™…å€¼ã€‚lossæ˜¯å‡æ–¹æŸå¤±å‡½æ•°ï¼Œè¿™é‡Œå‡æ–¹æŸå¤±å‡½æ•°ä¹˜ä»¥0.5æ˜¯ä¸ºäº†æ±‚å¯¼çš„æ—¶å€™å¹³æ–¹é¡¹æ­£å¥½æ¶ˆå»ï¼Œæ–¹ä¾¿åç»­æ•´ç†ï¼Œå®é™…ä¸Šä¹Ÿå¯ä»¥ä¸ä¹˜ï¼Œæ¢¯åº¦ä¸‹é™ç®—æ³•æœ€é‡è¦çš„æ˜¯æ–¹å‘ï¼Œå¤§å°æ˜¯æ¬¡è¦çš„ã€‚sumå‡½æ•°å¯¹æŸå¤±è¿›è¡Œæ±‚å’ŒåŒæ—¶æŠŠlosså‡½æ•°å˜ä¸ºæ ‡é‡ï¼Œå®é™…ä¸Šè¿™é‡Œé¢ç”±äºæˆ‘ä»¬ç›´æ¥åç»­è®¡ç®—æ¢¯åº¦ç›´æ¥æ±‚å‡ºäº†losså‡½æ•°çš„å¯¼æ•°ï¼Œæ‰€ä»¥è¿™é‡Œlosså‡½æ•°å®é™…ä¸Šæ²¡æœ‰åœ¨ä»£ç ä¸Šæ²¡æœ‰å¾ˆå¤§çš„ä½œç”¨ï¼Œå†™å‡ºæ¥æ˜¯ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬å»è§‚çœ‹ğŸ¤£ğŸ˜‹ã€‚è€Œè¿™é‡Œæˆ‘ä»¬æ¥ä¸‹æ¥å°±æ˜¯è®¡ç®—çš„grad_wã€grad_bå°±æ˜¯æ¥è¿›è¡Œæ¢¯åº¦çš„è®¡ç®—ï¼Œç„¶åæ›´æ–°æƒé‡w1å’Œå‚æ•°b1ã€‚</p><h3 id="å¯è§†åŒ–ç»“æœ"><a href="#å¯è§†åŒ–ç»“æœ" class="headerlink" title="å¯è§†åŒ–ç»“æœ"></a>å¯è§†åŒ–ç»“æœ</h3><p><em>æˆ‘ä»¬è®­ç»ƒç»“æœå¦‚ä½•å‘¢ï¼Ÿå…¶å®é™…æ‹Ÿåˆç¨‹åº¦å¦‚ä½•å‘¢ï¼Ÿæˆ‘ä»¬ç”»å›¾æ¥éªŒè¯ä¸€ä¸‹æ‹Ÿåˆçš„æ•ˆæœã€‚</em></p><pre><code>plt.plot(x, y_pred, &quot;r-&quot;, label=&#39;predict&#39;)plt.scatter(x, y, color=&#39;blue&#39;, marker=&#39;o&#39;, label=&#39;true&#39;)    # true dataplt.xlim(-1, 1)plt.ylim(2, 6)plt.legend()plt.show()print(w1, b1)</code></pre><p>è®­ç»ƒç»“æœï¼š <img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/2021053123433278.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70#pic_center" alt="å›¾åƒæ‹Ÿåˆæ•ˆæœ"> [[2.98941611]] [[2.09813123]]</p><h4 id="ä»£ç åˆ†æï¼š-4"><a href="#ä»£ç åˆ†æï¼š-4" class="headerlink" title="ä»£ç åˆ†æï¼š"></a>ä»£ç åˆ†æï¼š</h4><p>äº‹å®è¯æ˜ï¼Œç»è¿‡800æ¬¡è®­ç»ƒä¹‹åï¼Œæˆ‘ä»¬è®­ç»ƒå‡ºçš„æ¨¡å‹çš„æ‹Ÿåˆæ•ˆæœè¿˜æ˜¯ç›¸å½“ä¸é”™çš„ï¼Œwæ˜¯2.9894å·¦å³ï¼Œbæ˜¯2.0981å·¦å³ã€‚å’Œæˆ‘ä»¬åˆå§‹æ—¶è®¾å®šçš„3ã€2ç›¸å·®å¾ˆå°ã€‚</p><pre><code>BiTree GetSibling(BiTree T, KeyType e){    if (T == NULL)        return NULL;    if (T-&gt;lchild)    {        if (T-&gt;lchild-&gt;data.key == e)            return T-&gt;rchild; //å·¦å­©å­ç¬¦åˆæ¡ä»¶å°±è¿”å›å³å­©å­    }    else if (T-&gt;rchild)    {        if (T-&gt;rchild-&gt;data.key == e)            return T-&gt;lchild; //å³å­©å­ç¬¦åˆæ¡ä»¶å°±è¿”å›å·¦å­©å­    }    //å¦åˆ™é€’å½’æŸ¥æ‰¾ï¼Œå¦‚æœå·¦å­æ ‘é‡Œæœ‰å°±è¿”å›å·¦å­æ ‘é‡Œçš„ï¼Œå¦åˆ™è¿”å›å³å­æ ‘    return GetSibling(T-&gt;lchild, e) != NULL ? GetSibling(T-&gt;lchild, e) : GetSibling(T-&gt;rchild, e);}</code></pre>]]></content>
      
      
      <categories>
          
          <category> æœºå™¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æœºå™¨å­¦ä¹  </tag>
            
            <tag> matplotlib </tag>
            
            <tag> numpy </tag>
            
            <tag> math </tag>
            
            <tag> æ¢¯åº¦ä¸‹é™ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸Šæµ·äº¤å¤§æ¦‚ç‡è®ºæ•°ç†ç»Ÿè®¡å¤§ä½œä¸šä»£ç å®ç°è§£æ</title>
      <link href="/2021/08/01/shang-hai-jiao-da-gai-lu-lun-shu-li-tong-ji-da-zuo-ye-dai-ma-shi-xian-jie-xi/"/>
      <url>/2021/08/01/shang-hai-jiao-da-gai-lu-lun-shu-li-tong-ji-da-zuo-ye-dai-ma-shi-xian-jie-xi/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å‰äº›æ—¥å­æœ‰ä¸Šäº¤å°å§å§æ¦‚ç‡è®ºä¸æ•°ç†ç»Ÿè®¡è¯¾ç¨‹ç»“è¯¾äº†ï¼Œæœ‰ä¸€ä¸ªå¤§ä½œä¸šè¦åšï¼Œé¢˜ç›®è¦æ±‚ä½¿ç”¨matlabæˆ–è€…pythonç”»å›¾åˆ†æå¹¶ç»Ÿè®¡æœ‰å…³æ•°æ®ã€‚ä¸Šæµ·äº¤å¤§ä¸äºæ˜¯æˆ‘ä»¬è¿™ç§æ°‘åŠä¸‰æœ¬æ¯”ä¸äº†çš„ï¼ŒçœŸäººä¸Šäººï¼Œå°å§å§æ ¹æœ¬å°±æ²¡å­¦è¿‡ç¼–ç¨‹å¤§ä½œä¸šå°±è¦æ±‚å¼€å§‹å†™ä»£ç ç”»å›¾ã€‚åˆ«çœ‹åšä¸»ç°åœ¨è§‰å¾—è¿™é—¨ä½œä¸šæŒºæœ‰æ„æ€ï¼Œå¦‚æœè¿™æ˜¯åšä¸»çš„æ¦‚ç‡è®ºå¤§ä½œä¸šï¼Œåšä¸»ä¼°è®¡å°±å‘µå‘µäº†ã€‚äºæ˜¯â€”â€”å°å§å§å°±æƒ³èµ·äº†æˆ‘è¿™ä¸ªé«˜ä¸­ä¸ºæ•°ä¸å¤šçš„ç¨‹åºçŒ¿åŒå­¦ï¼ˆğŸ˜…è€å·¥å…·äººäº†ï¼‰ã€‚åç§‘çœŸäººä¸‹äººï¼Œåšä¸»æ¦‚ç‡è®ºæ‰åˆšå¼€è¯¾ï¼Œä¹Ÿä¸æ€ä¹ˆä¼šç”¨ä»£ç ç”»å›¾ã€‚ä½†æ˜¯æƒ³èµ·æˆ‘åœ¨å°å§å§å¿ƒç›®ä¸­çš„ä¼Ÿå²¸å½¢è±¡ğŸ™„ã€‚æ— æ‰€ç•æƒ§ï¼æ»¡å£ç­”åº”ä¸‹æ¥ã€‚</p><p><em>ä¸è¿‡è¿™æ¬¡ä½œä¸šçš„å®Œæˆåšä¸»è¿˜æ˜¯æ„Ÿè§¦é¢‡ä¸°çš„ï¼Œå­¦åˆ°äº†è®¸å¤šé“ç†ï¼Œä¸ä¼šçš„ä¸œè¥¿ä¸è¦ç­‰åˆ«äººæ•™ï¼Œæ­£å¦‚æˆ‘ä»¬åç§‘çš„é‚£å¥è¢«åæ§½å¥½å¤šçš„é‚£å¥â€œä½ èƒ½åšçš„ï¼Œèµ·æ­¢å¦‚æ­¤â€ï¼Œåšä¸»æ„Ÿè§‰å¾ˆæœ‰å¿…è¦æŠŠè¿™ä¸ªå­¦ä¹ è¿‡ç¨‹è®°ä¸‹æ¥ï¼Œäºæ˜¯æœ‰äº†è¿™ç¯‡åšå®¢ã€‚</em></p><hr><p>[TOC]</p><h1 id="ä½œä¸šé¢˜ç›®"><a href="#ä½œä¸šé¢˜ç›®" class="headerlink" title="ä½œä¸šé¢˜ç›®"></a>ä½œä¸šé¢˜ç›®</h1><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210603151333206.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70#pic_center" alt="äº¤å¤§æ¦‚ç‡ä½œä¸š"></p><h1 id="é¢˜ç›®è§£æ"><a href="#é¢˜ç›®è§£æ" class="headerlink" title="é¢˜ç›®è§£æ"></a>é¢˜ç›®è§£æ</h1><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>åˆå§‹æ—¶å°±æ˜¯æœ‰ä¸¤ä¸ªç‹¬ç«‹çš„æ»¡è¶³é«˜æ–¯åˆ†å¸ƒçš„éšæœºå˜é‡ï¼Œ ä½¿ç”¨bernoulliåˆ†å¸ƒæŠŠè¿™ä¸¤ä¸ªéšæœºåˆ†å¸ƒç»„åˆèµ·æ¥ï¼Œé€šä¿—è¯´å°±æ˜¯é«˜æ–¯åˆ†å¸ƒ+ä¼¯åŠªåˆ©åˆ†å¸ƒã€‚</p><h2 id="ä»»åŠ¡ä¸€"><a href="#ä»»åŠ¡ä¸€" class="headerlink" title="ä»»åŠ¡ä¸€"></a>ä»»åŠ¡ä¸€</h2><hr><h3 id="å‚æ•°ç”Ÿæˆéšæœºæ•°"><a href="#å‚æ•°ç”Ÿæˆéšæœºæ•°" class="headerlink" title="å‚æ•°ç”Ÿæˆéšæœºæ•°"></a>å‚æ•°ç”Ÿæˆéšæœºæ•°</h3><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210603152402661.png" alt="ç”Ÿæˆéšæœºæ•°"></p><h4 id="é«˜æ–¯å‡½æ•°éšæœºæ•°"><a href="#é«˜æ–¯å‡½æ•°éšæœºæ•°" class="headerlink" title="é«˜æ–¯å‡½æ•°éšæœºæ•°"></a>é«˜æ–¯å‡½æ•°éšæœºæ•°</h4><p>åšä¸»åˆšå¼€å§‹å†™çš„æ—¶å€™ï¼Œçœ‹åˆ°ç”Ÿæˆéšæœºæ•°ï¼Œä»¥ä¸ºéœ€è¦åšä¸»è‡ªå·±å®ç°ä»£ç çš„ç¼–å†™ï¼Œäºæ˜¯åšä¸»è‡ªå·±å°±å¼€å§‹å†™é«˜æ–¯åˆ†å¸ƒçš„ä»£ç ï¼Œå†™ç€å†™ç€åæ§½äº†ä¸€å¥åï¼Œå®¤å‹æé†’æ˜¯ä¸æ˜¯æœ‰å¯ä»¥ç°æˆçš„å‡½æ•°ã€‚äºæ˜¯æˆ‘æŸ¥äº†ä¸€ä¸‹ï¼Œæœç„¶æœ‰åˆ«äººå†™å¥½çš„è½®å­ï¼ˆåè¡€ï¼‰ã€‚è¿˜å¥½è¿˜å¥½ï¼ŒåŠæ—¶æ­¢æŸã€‚numpyä¸­çš„normalå‡½æ•°å°±æ˜¯ç”¨æ¥ç”Ÿæˆé«˜æ–¯åˆ†å¸ƒéšæœºæ•°çš„ã€‚<br>é«˜æ–¯åˆ†å¸ƒå‡½æ•°å¦‚ä¸‹:<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210603153849217.png" alt="é«˜æ–¯å‡½æ•°"><br>è€Œæˆ‘ä»¬çš„é«˜æ–¯éšæœºæ•°å‡½æ•°normalå‚æ•°å¦‚ä¸‹:<br>random.normal(loc=0.0, scale=1.0, size=None)<br>å®˜ç½‘è§£é‡Šå¦‚ä¸‹ï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210603154153716.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="å®˜ç½‘è§£é‡Šnormal"><br>å‚æ•°locå°±æ˜¯æˆ‘ä»¬çš„â€œä¸­ä½æ•°â€ï¼ˆmeanï¼‰ï¼Œå°±æ˜¯æˆ‘ä»¬å…¬å¼é‡Œçš„$\mu$,è¿™ä¸ªä¹Ÿæ˜¯æˆ‘ä»¬é«˜æ–¯åˆ†å¸ƒçš„æ•°å­¦æœŸæœ›ã€‚<br>å‚æ•°scaleå°±æ˜¯æˆ‘ä»¬çš„æ ‡å‡†å·®ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„$sigma$(markdownå¥½åƒæ˜¾ç¤ºä¸å‡ºæ¥è¿™ä¸ªç¬¦å·ï¼‰ã€‚<br>å‚æ•°sizeå°±æ˜¯æˆ‘ä»¬è¦ç”Ÿæˆçš„éšæœºæ•°çŸ©é˜µçš„sizeï¼Œæ¯”å¦‚1000ã€ï¼ˆ3ï¼Œ 4ï¼‰è¿™ç§ã€‚<br>è€Œå‡½æ•°è¿”å›å€¼å°±æ˜¯æˆ‘ä»¬ç”Ÿæˆçš„éšæœºæ•°çŸ©é˜µã€‚çŸ©é˜µç±»å‹æ˜¯numpyçš„ndarrayæ ¼å¼ï¼Œå¦‚æœåªç”Ÿæˆä¸€ä¸ªéšæœºæ•°å°±ç”Ÿæˆä¸€ä¸ªæ•°ã€‚</p><h4 id="Bernoulliå‡½æ•°éšæœºæ•°"><a href="#Bernoulliå‡½æ•°éšæœºæ•°" class="headerlink" title="Bernoulliå‡½æ•°éšæœºæ•°"></a>Bernoulliå‡½æ•°éšæœºæ•°</h4><p>Bernoulliå‡½æ•°ç”Ÿæˆéšæœºæ•°å˜›ï¼Œåšä¸»å°±è‡ªå·±å†™å‡½æ•°å•¦ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">bernoulli</span><span class="token punctuation">(</span>possi<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">:</span>    random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    ans1 <span class="token operator">=</span> list<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span>        ans1<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token number">1</span> <span class="token keyword">if</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> possi <span class="token keyword">else</span> <span class="token number">0</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> ans1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»£ç æœ¬èº«æ˜¯å¾ˆç®€å•çš„ï¼Œæœ€åç”Ÿæˆè¿”å›çš„æ˜¯ä¸€ä¸ªåˆ—è¡¨ã€‚</p><h4 id="æ··åˆé«˜æ–¯åˆ†å¸ƒéšæœºæ•°"><a href="#æ··åˆé«˜æ–¯åˆ†å¸ƒéšæœºæ•°" class="headerlink" title="æ··åˆé«˜æ–¯åˆ†å¸ƒéšæœºæ•°"></a>æ··åˆé«˜æ–¯åˆ†å¸ƒéšæœºæ•°</h4><p>æœ‰äº†å‰ä¸¤æ­¥çš„æ­¥éª¤åè¿™ä¸ªæ··åˆé«˜æ–¯åˆ†å¸ƒä»£ç å°±å¾ˆç®€å•äº†ï¼Œåªéœ€è¦æˆ‘ä»¬è°ƒç”¨ç”Ÿæˆéšæœºæ•°åæŠŠå‡ é¡¹ç®€å•åŠ å’Œä¸€ä¸‹å°±å¯ä»¥äº†ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">pict <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span>a<span class="token punctuation">,</span> c<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>multiply<span class="token punctuation">(</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span>b<span class="token punctuation">,</span> d<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>bernoulli<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="å‚æ•°çš„é€‰å–"><a href="#å‚æ•°çš„é€‰å–" class="headerlink" title="å‚æ•°çš„é€‰å–"></a>å‚æ•°çš„é€‰å–</h3><p>è¿™é‡Œé¢è¦æ±‚æœ‰$\mu1$ ã€$\mu2$ã€$sigma1$ã€$siama2$ã€pè¿™äº”ä¸ªå‚æ•°ã€‚æˆ‘ä»¬åº”è¯¥åˆç†çš„é€‰æ‹©èŒƒå›´ã€‚ä¸ºäº†æ›´åŠ æ­£è§„çš„å†™è¿™ä¸€é“é¢˜ï¼Œåšä¸»è¿™é‡Œé€‰æ‹©äº†ä¸€ä¸‹è¿™å‡ ç»„æ•°æ®ï¼š</p><pre class="line-numbers language-python"><code class="language-python">u1 <span class="token operator">=</span> list<span class="token punctuation">(</span>range<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>u2 <span class="token operator">=</span> u1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span>sigma1 <span class="token operator">=</span> list<span class="token punctuation">(</span>range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>sigma2 <span class="token operator">=</span> sigma1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span>p <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæœ€ååº”è¯¥ä¼šç”Ÿæˆ7$\times$ 7 $\times$ 9 $\times$ 9 $\times$ 6 = 23814ç»„æ•°æ®ï¼Œæ¯ç»„æ•°æ®æœ‰1000ä¸ªéšæœºæ•°ã€‚<br>å½“ç„¶ï¼ŒæŒ‰ç…§é¢˜ç›®æ¥è¯´æˆ‘ä»¬å®Œå…¨å¯ä»¥ç¼©å°æ•°æ®é›†ï¼Œé™ä½æ•°æ®è§„æ¨¡ã€‚å½“æ—¶æˆ‘ç»™å°å§å§æ—¶å°±æ˜¯æäº¤äº†50ç»„æ•°æ®çš„å›¾ç‰‡ã€‚ä¹Ÿé¡ºåˆ©çš„å®Œæˆäº†ä½œä¸šã€‚</p><h3 id="ç”Ÿæˆéšæœºæ•°å¹¶ç”»å›¾ä¿å­˜æ–‡ä»¶"><a href="#ç”Ÿæˆéšæœºæ•°å¹¶ç”»å›¾ä¿å­˜æ–‡ä»¶" class="headerlink" title="ç”Ÿæˆéšæœºæ•°å¹¶ç”»å›¾ä¿å­˜æ–‡ä»¶"></a>ç”Ÿæˆéšæœºæ•°å¹¶ç”»å›¾ä¿å­˜æ–‡ä»¶</h3><p>æ¥ä¸‹æ¥å°±æ˜¯æˆ‘ä»¬å†™å‡ºæœ‰å…³å¾ªç¯å®ç°æˆ‘ä»¬å‰æ–‡æåˆ°çš„ç”Ÿæˆæ··åˆé«˜æ–¯åˆ†å¸ƒéšæœºæ•°å’Œæˆ‘ä»¬çš„å¯¹åº”å›¾åƒçš„ç”Ÿæˆå¹¶ä¿å­˜ã€‚<br>ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">for</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> e <span class="token keyword">in</span> itertools<span class="token punctuation">.</span>product<span class="token punctuation">(</span>u1<span class="token punctuation">,</span> u2<span class="token punctuation">,</span> sigma1<span class="token punctuation">,</span> sigma2<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># print(a, b, c, d, e)</span>    pict <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span>a<span class="token punctuation">,</span> c<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>multiply<span class="token punctuation">(</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span>b<span class="token punctuation">,</span> d<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>bernoulli<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    fig<span class="token punctuation">,</span> <span class="token punctuation">(</span>ax0<span class="token punctuation">,</span> ax1<span class="token punctuation">)</span> <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>nrows<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># ç¬¬äºŒä¸ªå‚æ•°æ˜¯æŸ±å­å®½ä¸€äº›è¿˜æ˜¯çª„ä¸€äº›ï¼Œè¶Šå¤§è¶Šçª„è¶Šå¯†</span>    ax0<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>pict<span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> histtype<span class="token operator">=</span><span class="token string">'bar'</span><span class="token punctuation">,</span> facecolor<span class="token operator">=</span><span class="token string">'yellowgreen'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.75</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># pdf: æ¦‚ç‡åˆ†å¸ƒå›¾ï¼Œä¸€åƒä¸ªæ•°è½åœ¨æŸä¸ªåŒºé—´å†…çš„æ•°æœ‰å¤šå°‘ä¸ª</span>    ax0<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">'Frequency distribution graph'</span><span class="token punctuation">)</span>    ax1<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>pict<span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> histtype<span class="token operator">=</span><span class="token string">'bar'</span><span class="token punctuation">,</span> facecolor<span class="token operator">=</span><span class="token string">'pink'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.75</span><span class="token punctuation">,</span> cumulative<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> rwidth<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># cdf: ç´¯è®¡æ¦‚ç‡å‡½æ•°ï¼Œcumulativeç´¯è®¡ã€‚æ¯”å¦‚éœ€è¦ç»Ÿè®¡å°äº5çš„æ•°çš„æ¦‚ç‡</span>    ax1<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Cumulative probability function"</span><span class="token punctuation">)</span>    fig<span class="token punctuation">.</span>subplots_adjust<span class="token punctuation">(</span>hspace<span class="token operator">=</span><span class="token number">0.4</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span>r<span class="token string">"E:\results\test{}(u1 = {}, u2 = {}, sigma1 = {}, sigma2 = {}, p = {}).png"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>cnt <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># plt.show()</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ä»£ç åˆ†æï¼š"><a href="#ä»£ç åˆ†æï¼š" class="headerlink" title="ä»£ç åˆ†æï¼š"></a>ä»£ç åˆ†æï¼š</h4><p>å¾ªç¯ç»„åˆæˆ‘ä»¬æœ‰å…³çš„å‚æ•°ç»„åˆï¼Œè¿™é‡Œç”¨åˆ°äº†itertoolsä¸­çš„productå‡½æ•°ï¼Œç”¨æ¥ç”Ÿæˆä¸€ä¸ªç¬›å¡å°”ç§¯ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥ä½¿ç”¨histå‡½æ•°æ¥ç”»é¢‘ç‡åˆ†å¸ƒç›´æ–¹å›¾ï¼Œè¿™é‡Œæ³¨æ„ï¼Œé™¤äº†æˆ‘ä»¬é€šå¸¸æ„ä¹‰ä¸Šçš„é¢‘ç‡åˆ†å¸ƒç›´æ–¹å›¾å¤–ï¼Œåšä¸»é¢å¤–åŠ äº†ä¸€ä¸ªCumulative probability functionï¼Œç´¯è®¡æ¦‚ç‡ç»Ÿè®¡å‡½æ•°ï¼Œè¿™ä¸ªå¯ä»¥æ›´åŠ ç›´è§‚çœ‹å‡ºæˆ‘ä»¬ç´¯è®¡çš„æ¦‚ç‡é¢‘æ¬¡ã€‚<br>è€Œåå›¾åƒä½¿ç”¨savefigè¿›è¡Œä¿å­˜ï¼Œè¿™é‡Œæˆ‘ä»¬ä¿å­˜åˆ°Eç›˜çš„resultsæ–‡ä»¶å¤¹ä¸­ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬åªéœ€è¦ç›´æ¥SHIFT + F10è¿è¡Œä¸€ä¸‹ï¼Œç„¶åå†â€œç¨ç­‰ç‰‡åˆ»â€ï¼Œå›¾åƒå°±ç”ŸæˆæˆåŠŸäº† ï¼</p><h4 id="è¿è¡Œç»“æœï¼š"><a href="#è¿è¡Œç»“æœï¼š" class="headerlink" title="è¿è¡Œç»“æœï¼š"></a>è¿è¡Œç»“æœï¼š</h4><p>ä»¥ä¸‹å°±æ˜¯æˆ‘ä»¬ä»£ç çš„éƒ¨åˆ†è¿è¡Œç»“æœï¼ˆå›¾å¤ªå¤šä¸å®Œæ•´æ”¾äº†ï¼‰<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210603182119503.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="è¿è¡Œç»“æœ"></p><h2 id="ä»»åŠ¡äºŒ"><a href="#ä»»åŠ¡äºŒ" class="headerlink" title="ä»»åŠ¡äºŒ"></a>ä»»åŠ¡äºŒ</h2><hr><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210603182538952.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="ä»»åŠ¡äºŒ"></p><h3 id="æœŸæœ›æ–¹å·®æ•°å­¦å…¬å¼æ¨å¯¼"><a href="#æœŸæœ›æ–¹å·®æ•°å­¦å…¬å¼æ¨å¯¼" class="headerlink" title="æœŸæœ›æ–¹å·®æ•°å­¦å…¬å¼æ¨å¯¼"></a>æœŸæœ›æ–¹å·®æ•°å­¦å…¬å¼æ¨å¯¼</h3><p>è¯´åˆ°è¿™é‡Œæˆ‘å°±è¦åå˜ˆä¸€ä¸‹è¿™ä½å°å§å§äº†ğŸ˜­ï¼Œä¿ºè¿˜æ²¡å­¦åˆ°è¿™é‡Œå‘¢ã€‚å°å§å§è‡³å°‘å…ˆæŠŠè¿™äº›æ¨å¯¼ç»“æœå‘ç»™æˆ‘å§ï¼Œä½†æ˜¯åšä¸»å®³ç¾ï¼Œä¸å¥½æ„æ€å»é—®ï¼ˆå…¶å®åšä¸»çŸ¥é“å¥¹ä¹Ÿä¸ä¼šğŸ˜…ï¼‰ï¼Œå°±è‡ªå·±æ‰¾äº†ä¸€ä¸‹æ¦‚ç‡ç»Ÿè®¡è€å¸ˆï¼Œäººç¾å¿ƒå–„çš„æ¦‚ç‡è€å¸ˆæ•™ä¼šäº†åšä¸»æ€ä¹ˆæ¨å¯¼çš„å…¬å¼ï¼Œå¹¶ä¸”ä¸€çœ¼çœ‹å‡ºäº†ä»»åŠ¡äºŒæœ€ç»ˆçš„é¢‘ç‡éšnçš„çš„å˜åŒ–çš„é‚£ä¸ªæ›²çº¿ï¼ˆä¸æ„§æˆ‘ç§‘è€å¸ˆğŸ¤—ï¼‰ã€‚<br>ä¸ç»§ç»­åºŸè¯ï¼Œæ¥ç‚¹ç¡¬æ ¸å…¬å¼æ¨å¯¼ï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210603183748249.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70#pic_center" alt="å…¬å¼æ¨å¯¼"><br>åšä¸»å­—ç¡®å®æœ‰ç‚¹ä¸‘ï¼Œå¤§å®¶å°†å°±ç€çœ‹å§ğŸ˜‹ã€‚</p><h3 id="å…³äºn"><a href="#å…³äºn" class="headerlink" title="å…³äºn"></a>å…³äºn</h3><p>è¿™é‡Œé¢ä¸ä»»åŠ¡ä¸€ä¸ä¸€æ ·çš„å°±æ˜¯æˆ‘ä»¬ä»»åŠ¡ä¸€çš„äº”ä¸ªå‚æ•°åœ¨è¿™é‡Œé¢æ˜¯æ˜¯å¯ä»¥è‡ªå·±ç¡®å®šçš„ï¼Œè¿™é‡Œå”¯ä¸€çš„å˜é‡å°±æ˜¯æˆ‘ä»¬æ¯ç»„çš„éšæœºæ•°çš„æ•°ç›®ï¼Œä¸Šæ–‡å·²ç»æ¨å¯¼å‡ºäº†æˆ‘ä»¬çš„æœŸæœ›ä¸æ–¹å·®ï¼Œè¿™é‡Œé¢å°±åªå‰©æˆ‘ä»¬çš„Uéœ€è¦è‡ªå·±æ¥è®¾å®šè®¡ç®—ã€‚ä»»åŠ¡ä¸€çš„å¾ˆå¤šä»£ç å®Œå…¨å¯ä»¥é‡ç”¨ã€‚</p><h3 id="å‚æ•°è®¾ç½®"><a href="#å‚æ•°è®¾ç½®" class="headerlink" title="å‚æ•°è®¾ç½®"></a>å‚æ•°è®¾ç½®</h3><h4 id="è¾“å…¥å‚æ•°n"><a href="#è¾“å…¥å‚æ•°n" class="headerlink" title="è¾“å…¥å‚æ•°n"></a>è¾“å…¥å‚æ•°n</h4><pre class="line-numbers language-python"><code class="language-python">nn <span class="token operator">=</span> list<span class="token punctuation">(</span>map<span class="token punctuation">(</span>int<span class="token punctuation">,</span> input<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åšä¸»è§‰å¾—ä¸€æ¬¡ä¸€æ¬¡æ‰‹è¾“nå¤ªéº»çƒ¦äº†ï¼Œå¹²è„†ä¸€æ¬¡è¾“å®Œï¼Œä½¿ç”¨æˆ‘ä»¬åˆ—è¡¨å­˜å‚¨éœ€è¦çš„nå€¼ã€‚</p><h4 id="å„é¡¹å‚æ•°"><a href="#å„é¡¹å‚æ•°" class="headerlink" title="å„é¡¹å‚æ•°"></a>å„é¡¹å‚æ•°</h4><pre class="line-numbers language-python"><code class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>u1 <span class="token operator">=</span> <span class="token number">5</span>u2 <span class="token operator">=</span> <span class="token number">5</span>sigma1 <span class="token operator">=</span> <span class="token number">3</span>sigma2 <span class="token operator">=</span> <span class="token number">4</span>p <span class="token operator">=</span> <span class="token number">0.5</span>U <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>Ez <span class="token operator">=</span> u1 <span class="token operator">+</span> p <span class="token operator">*</span> u2Dz <span class="token operator">=</span> sigma1<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> sigma2<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> p<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>u2<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ˜¯æˆ‘ä»¬æœ‰å…³äºåˆ—åˆ°çš„æ··åˆé«˜æ–¯åˆ†å¸ƒçš„æœ‰å…³å„é¡¹å‚æ•°ã€‚</p><h3 id="ç”Ÿæˆéšæœºæ•°ç”»å›¾å¹¶ä¿å­˜"><a href="#ç”Ÿæˆéšæœºæ•°ç”»å›¾å¹¶ä¿å­˜" class="headerlink" title="ç”Ÿæˆéšæœºæ•°ç”»å›¾å¹¶ä¿å­˜"></a>ç”Ÿæˆéšæœºæ•°ç”»å›¾å¹¶ä¿å­˜</h3><p>å®é™…ä¸Šè¿™é‡Œé™¤äº†é¢å¤–åŠ äº†ä¸€ä¸ªæˆ‘ä»¬çš„nnæ•°ç»„å¾ªç¯ï¼Œç”¨æ¥å¾ªç¯è¿è¡Œæˆ‘ä»¬nçš„å€¼ï¼Œå…¶ä»–éƒ¨åˆ†å’Œæˆ‘ä»¬çš„ä»»åŠ¡ä¸€ä»£ç éƒ¨åˆ†éƒ½ä¸€æ ·ã€‚<br>ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">for</span> n <span class="token keyword">in</span> nn<span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        pict <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span>u1<span class="token punctuation">,</span> sigma1<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>multiply<span class="token punctuation">(</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span>u2<span class="token punctuation">,</span> sigma2<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                                                             np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>bernoulli<span class="token punctuation">(</span>p<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        res <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>n <span class="token operator">*</span> Dz<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>pict<span class="token punctuation">.</span>sum<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> n <span class="token operator">*</span> Ez<span class="token punctuation">)</span>        U <span class="token operator">=</span> np<span class="token punctuation">.</span>append<span class="token punctuation">(</span>U<span class="token punctuation">,</span> res<span class="token punctuation">)</span>    fig<span class="token punctuation">,</span> <span class="token punctuation">(</span>ax0<span class="token punctuation">,</span> ax1<span class="token punctuation">)</span> <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>nrows<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># ç¬¬äºŒä¸ªå‚æ•°æ˜¯æŸ±å­å®½ä¸€äº›è¿˜æ˜¯çª„ä¸€äº›ï¼Œè¶Šå¤§è¶Šçª„è¶Šå¯†</span>    ax0<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>U<span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> histtype<span class="token operator">=</span><span class="token string">'bar'</span><span class="token punctuation">,</span> facecolor<span class="token operator">=</span><span class="token string">'yellowgreen'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.75</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># # pdfæ¦‚ç‡åˆ†å¸ƒå›¾ï¼Œnä¸ªæ•°è½åœ¨æŸä¸ªåŒºé—´å†…çš„æ•°æœ‰å¤šå°‘ä¸ª</span>    ax0<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">'Frequency distribution graph for n={}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>    ax1<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>U<span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> histtype<span class="token operator">=</span><span class="token string">'bar'</span><span class="token punctuation">,</span> facecolor<span class="token operator">=</span><span class="token string">'pink'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.75</span><span class="token punctuation">,</span> cumulative<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> rwidth<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># cdfç´¯è®¡æ¦‚ç‡å‡½æ•°ï¼Œcumulativeç´¯è®¡ã€‚æ¯”å¦‚éœ€è¦ç»Ÿè®¡å°äº5çš„æ•°çš„æ¦‚ç‡</span>    ax1<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Cumulative probability function n={}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>    fig<span class="token punctuation">.</span>subplots_adjust<span class="token punctuation">(</span>hspace<span class="token operator">=</span><span class="token number">0.4</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span>r<span class="token string">"E:\result\homework2 u1 = 5 u2 = 5 sigma1 = 3 sigma2 = 4 p = 0.5\test n={}.png"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># plt.show()</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="è¿è¡Œç»“æœ"><a href="#è¿è¡Œç»“æœ" class="headerlink" title="è¿è¡Œç»“æœ"></a>è¿è¡Œç»“æœ</h4><p>æœ€ç»ˆè¿è¡Œç»“æœä¸ºï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210603203747134.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xSWTg5NzU3,size_16,color_FFFFFF,t_70" alt="ä»»åŠ¡äºŒè¿è¡Œç»“æœ"></p><h2 id="å†™åœ¨æœ€å"><a href="#å†™åœ¨æœ€å" class="headerlink" title="å†™åœ¨æœ€å"></a>å†™åœ¨æœ€å</h2><p>å†™è¿™ä¹ˆé•¿çš„åšå®¢ç´¯æ­»äº†QAQï¼Œä»£ç ä¹Ÿå†™æœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œæœ‰è®¸å¤šå½“åˆçš„ç»†èŠ‚éƒ½æœ‰äº›é—å¿˜äº†ï¼Œå†™åšå®¢è¿‡ç¨‹æœ¬èº«ä¹Ÿæ”¶è·äº†è®¸å¤šï¼ŒæŠŠä¹‹å‰å­¦åˆ°çš„çŸ¥è¯†è®¤çœŸæ•´ç†ä¸€ä¸‹ï¼ŒæŠŠå­¦ä¹ è¿‡ç¨‹è®°å½•ä¸‹æ¥æ”¾åˆ°ç½‘ä¸Šå’Œå¤§å®¶åˆ†äº«æœ¬èº«ä¹Ÿæ˜¯ä¸€ä»¶å¾ˆæœ‰æˆå°±æ„Ÿçš„äº‹æƒ…ã€‚<br>å¸Œæœ›è¿™ä¹Ÿèƒ½è®©å„ä½ä¹Ÿæœ‰æ‰€æ”¶è·ï¼Œåšä¸»ç å­—ä¸æ˜“ï¼Œä¹Ÿæ¬¢è¿å¤§å®¶ä¸€é”®ä¸‰è¿å“¦ğŸ˜˜ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åˆ†æ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> matplotlib </tag>
            
            <tag> numpy </tag>
            
            <tag> math </tag>
            
            <tag> æ¦‚ç‡è®ºä¸æ•°ç†ç»Ÿè®¡ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
